(function() {
   var availableDict = {"en-US":true,"ru-RU":true},
      langMatch = String(typeof document === 'undefined' ? '' : document.cookie).match(/lang=([A-z-]+)/),
      langName = langMatch ? langMatch[1] : 'ru-RU',
      langModule = 'text!Elektronnyj_dokumentooborot/lang/' + langName + '/' + langName + '.json';
   if (langName in availableDict) {
      define('Elektronnyj_dokumentooborot_localization', ['Core/i18n', langModule], function(i18n, data) {
         if (data){
            i18n.setDict(JSON.parse(data), langModule, langName);
         }
      });
   } else {
      define('Elektronnyj_dokumentooborot_localization', function() {});
   }
})();

(function() {
   var availableDict = {"en-US":true,"ru-RU":true},
      langMatch = String(typeof document === 'undefined' ? '' : document.cookie).match(/lang=([A-z-]+)/),
      langName = langMatch ? langMatch[1] : 'ru-RU',
      langModule = 'text!Bazovyj_komponent_dokument/lang/' + langName + '/' + langName + '.json';
   if (langName in availableDict) {
      define('Bazovyj_komponent_dokument_localization', ['Core/i18n', langModule], function(i18n, data) {
         if (data){
            i18n.setDict(JSON.parse(data), langModule, langName);
         }
      });
   } else {
      define('Bazovyj_komponent_dokument_localization', function() {});
   }
})();

(function() {
   var availableDict = {"en-US":true},
      langMatch = String(typeof document === 'undefined' ? '' : document.cookie).match(/lang=([A-z-]+)/),
      langName = langMatch ? langMatch[1] : 'ru-RU',
      langModule = 'text!CHastnye_litsa/lang/' + langName + '/' + langName + '.json';
   if (langName in availableDict) {
      define('CHastnye_litsa_localization', ['Core/i18n', langModule], function(i18n, data) {
         if (data){
            i18n.setDict(JSON.parse(data), langModule, langName);
         }
      });
   } else {
      define('CHastnye_litsa_localization', function() {});
   }
})();

(function() {
   var availableDict = {"en-US":true},
      langMatch = String(typeof document === 'undefined' ? '' : document.cookie).match(/lang=([A-z-]+)/),
      langName = langMatch ? langMatch[1] : 'ru-RU',
      langModule = 'text!AreaOfResponsibility/lang/' + langName + '/' + langName + '.json';
   if (langName in availableDict) {
      define('AreaOfResponsibility_localization', ['Core/i18n', langModule], function(i18n, data) {
         if (data){
            i18n.setDict(JSON.parse(data), langModule, langName);
         }
      });
   } else {
      define('AreaOfResponsibility_localization', function() {});
   }
})();

(function() {
   var availableDict = {"en-US":true},
      langMatch = String(typeof document === 'undefined' ? '' : document.cookie).match(/lang=([A-z-]+)/),
      langName = langMatch ? langMatch[1] : 'ru-RU',
      langModule = 'text!Raschet_sdelki/lang/' + langName + '/' + langName + '.json';
   if (langName in availableDict) {
      define('Raschet_sdelki_localization', ['Core/i18n', langModule], function(i18n, data) {
         if (data){
            i18n.setDict(JSON.parse(data), langModule, langName);
         }
      });
   } else {
      define('Raschet_sdelki_localization', function() {});
   }
})();

(function() {
   var availableDict = {"en-US":true,"ru-RU":true},
      langMatch = String(typeof document === 'undefined' ? '' : document.cookie).match(/lang=([A-z-]+)/),
      langName = langMatch ? langMatch[1] : 'ru-RU',
      langModule = 'text!Reglamenty/lang/' + langName + '/' + langName + '.json';
   if (langName in availableDict) {
      define('Reglamenty_localization', ['Core/i18n', langModule], function(i18n, data) {
         if (data){
            i18n.setDict(JSON.parse(data), langModule, langName);
         }
      });
   } else {
      define('Reglamenty_localization', function() {});
   }
})();

(function() {
   var availableDict = {"en-US":true,"ru-RU":true},
      langMatch = String(typeof document === 'undefined' ? '' : document.cookie).match(/lang=([A-z-]+)/),
      langName = langMatch ? langMatch[1] : 'ru-RU',
      langModule = 'text!Doverennosti/lang/' + langName + '/' + langName + '.json';
   if (langName in availableDict) {
      define('Doverennosti_localization', ['Core/i18n', langModule], function(i18n, data) {
         if (data){
            i18n.setDict(JSON.parse(data), langModule, langName);
         }
      });
   } else {
      define('Doverennosti_localization', function() {});
   }
})();

(function() {
   var availableDict = {"en-US":true},
      langMatch = String(typeof document === 'undefined' ? '' : document.cookie).match(/lang=([A-z-]+)/),
      langName = langMatch ? langMatch[1] : 'ru-RU',
      langModule = 'text!Delegirovanie_elektronnyh_podpisej/lang/' + langName + '/' + langName + '.json';
   if (langName in availableDict) {
      define('Delegirovanie_elektronnyh_podpisej_localization', ['Core/i18n', langModule], function(i18n, data) {
         if (data){
            i18n.setDict(JSON.parse(data), langModule, langName);
         }
      });
   } else {
      define('Delegirovanie_elektronnyh_podpisej_localization', function() {});
   }
})();

(function() {
   var availableDict = {"en-US":true},
      langMatch = String(typeof document === 'undefined' ? '' : document.cookie).match(/lang=([A-z-]+)/),
      langName = langMatch ? langMatch[1] : 'ru-RU',
      langModule = 'text!SbisDiskBase/lang/' + langName + '/' + langName + '.json';
   if (langName in availableDict) {
      define('SbisDiskBase_localization', ['Core/i18n', langModule], function(i18n, data) {
         if (data){
            i18n.setDict(JSON.parse(data), langModule, langName);
         }
      });
   } else {
      define('SbisDiskBase_localization', function() {});
   }
})();

(function() {
   var availableDict = {"en-US":true},
      langMatch = String(typeof document === 'undefined' ? '' : document.cookie).match(/lang=([A-z-]+)/),
      langName = langMatch ? langMatch[1] : 'ru-RU',
      langModule = 'text!Dokumentooborot/lang/' + langName + '/' + langName + '.json';
   if (langName in availableDict) {
      define('Dokumentooborot_localization', ['Core/i18n', langModule], function(i18n, data) {
         if (data){
            i18n.setDict(JSON.parse(data), langModule, langName);
         }
      });
   } else {
      define('Dokumentooborot_localization', function() {});
   }
})();

(function() {
   var availableDict = {"en-US":true},
      langMatch = String(typeof document === 'undefined' ? '' : document.cookie).match(/lang=([A-z-]+)/),
      langName = langMatch ? langMatch[1] : 'ru-RU',
      langModule = 'text!SbisDiskDocuments/lang/' + langName + '/' + langName + '.json';
   if (langName in availableDict) {
      define('SbisDiskDocuments_localization', ['Core/i18n', langModule], function(i18n, data) {
         if (data){
            i18n.setDict(JSON.parse(data), langModule, langName);
         }
      });
   } else {
      define('SbisDiskDocuments_localization', function() {});
   }
})();

(function() {
   var availableDict = {"en-US":true,"ru-RU":true},
      langMatch = String(typeof document === 'undefined' ? '' : document.cookie).match(/lang=([A-z-]+)/),
      langName = langMatch ? langMatch[1] : 'ru-RU',
      langModule = 'text!Lichnye_sertifikaty/lang/' + langName + '/' + langName + '.json';
   if (langName in availableDict) {
      define('Lichnye_sertifikaty_localization', ['Core/i18n', langModule], function(i18n, data) {
         if (data){
            i18n.setDict(JSON.parse(data), langModule, langName);
         }
      });
   } else {
      define('Lichnye_sertifikaty_localization', function() {});
   }
})();

(function() {
   var availableDict = {"en-US":true},
      langMatch = String(typeof document === 'undefined' ? '' : document.cookie).match(/lang=([A-z-]+)/),
      langName = langMatch ? langMatch[1] : 'ru-RU',
      langModule = 'text!OnControlDocs/lang/' + langName + '/' + langName + '.json';
   if (langName in availableDict) {
      define('OnControlDocs_localization', ['Core/i18n', langModule], function(i18n, data) {
         if (data){
            i18n.setDict(JSON.parse(data), langModule, langName);
         }
      });
   } else {
      define('OnControlDocs_localization', function() {});
   }
})();

(function() {
   var availableDict = {"en-US":true},
      langMatch = String(typeof document === 'undefined' ? '' : document.cookie).match(/lang=([A-z-]+)/),
      langName = langMatch ? langMatch[1] : 'ru-RU',
      langModule = 'text!Orders/lang/' + langName + '/' + langName + '.json';
   if (langName in availableDict) {
      define('Orders_localization', ['Core/i18n', langModule], function(i18n, data) {
         if (data){
            i18n.setDict(JSON.parse(data), langModule, langName);
         }
      });
   } else {
      define('Orders_localization', function() {});
   }
})();

(function() {
   var availableDict = {"en-US":true},
      langMatch = String(typeof document === 'undefined' ? '' : document.cookie).match(/lang=([A-z-]+)/),
      langName = langMatch ? langMatch[1] : 'ru-RU',
      langModule = 'text!online.sbis.ru/lang/' + langName + '/' + langName + '.json';
   if (langName in availableDict) {
      define('online.sbis.ru_localization', ['Core/i18n', langModule], function(i18n, data) {
         if (data){
            i18n.setDict(JSON.parse(data), langModule, langName);
         }
      });
   } else {
      define('online.sbis.ru_localization', function() {});
   }
})();

define("tmpl!SBIS3.EDO.ContractSelectorButton",["Core/tmpl/js/tclosure","js!SBIS3.CONTROLS/SelectorButton","js!SBIS3.EDO2.OpenDialogAction"],function(){var t=Array.prototype.slice.call(arguments),o=t[0],e={};e["js!SBIS3.CONTROLS/SelectorButton"]=t[1],e["js!SBIS3.EDO2.OpenDialogAction"]=t[2];var n=function t(n,r,i,a,c){function d(){}var p=0,l=void 0!==o&&o?o:arguments[arguments.length-1];void 0===l&&(eval("var thelpers = null;"),l=global.requirejs("View/Runner/tclosure"));var s={};c&&c.isSetts&&(s=c.fullContext||{});var m="string"==typeof i?i:"",u=void 0===e?void 0:e,S={id:[],def:void 0},g=l.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,n),O=this&&this.includedTemplates?this.includedTemplates:{},f=l.getMarkupGenerator(a);try{var N=f.joinElements([f.createTag("div",{class:"edo-ContractSelectorButton"},[f.createControl("wsControl","ws:SBIS3.CONTROLS/SelectorButton",{multiselect:!1,dataSource:{options:{binding:{query:"СписокДоговоровДляВыбора",format:"Список",read:"Прочитать"},idProperty:"@Документ",endpoint:"Документ"},module:"WS.Data/Source/SbisService",model:l.getter(n,["EdoModel"])},dictionaries:[{dialogOptions:{dataSource:{endpoint:{contract:"Документ"},binding:{query:"СписокДоговоровДляВыбора"},module:"WS.Data/Source/SbisService",model:l.getter(n,["EdoModel"])},filter:{"ФильтрТипыДокументов":void 0,"ФильтрЛицо1":l.getter(n,["contractorId"]),"ФильтрДокументНашаОрганизация":void 0},isStack:!1,showOnControlsReady:!0,animation:"off",autoHide:!1,pageSize:"10"},componentOptions:{docTypes:void 0,contractorId:l.getter(n,["contractorId"]),contractorName:l.getter(n,["contractorName"]),ourOrganization:void 0,ourOrganizationName:void 0},template:"js!SBIS3.EDO.ContractSelectorDialog",caption:"Договоры"}],name:"ContractSelectorButton",className:"ContractSelectorButton hidden",defaultCaption:"договор",displayProperty:"Номер",idProperty:"@Документ",useSelectorAction:!0,bindings:[{fieldName:"selectedKey",propName:"selectedKey",propPath:[],fullPropName:"selectedKey",propPathStr:"",oneWay:!1,direction:"fromContext",bindNonExistent:!1},{fieldName:"docTypes",propName:"dictionaries/0/dialogOptions/filter/ФильтрТипыДокументов",propPath:["0","dialogOptions","filter","ФильтрТипыДокументов"],fullPropName:"dictionaries/0/dialogOptions/filter/ФильтрТипыДокументов",propPathStr:"0/dialogOptions/filter/ФильтрТипыДокументов",oneWay:!0,direction:"fromContext",bindNonExistent:!1},{fieldName:"ourOrganization",propName:"dictionaries/0/dialogOptions/filter/ФильтрДокументНашаОрганизация",propPath:["0","dialogOptions","filter","ФильтрДокументНашаОрганизация"],fullPropName:"dictionaries/0/dialogOptions/filter/ФильтрДокументНашаОрганизация",propPathStr:"0/dialogOptions/filter/ФильтрДокументНашаОрганизация",oneWay:!0,direction:"fromContext",bindNonExistent:!1},{fieldName:"docTypes",propName:"dictionaries/0/componentOptions/docTypes",propPath:["0","componentOptions","docTypes"],fullPropName:"dictionaries/0/componentOptions/docTypes",propPathStr:"0/componentOptions/docTypes",oneWay:!0,direction:"fromContext",bindNonExistent:!1},{fieldName:"ourOrganization",propName:"dictionaries/0/componentOptions/ourOrganization",propPath:["0","componentOptions","ourOrganization"],fullPropName:"dictionaries/0/componentOptions/ourOrganization",propPathStr:"0/componentOptions/ourOrganization",oneWay:!0,direction:"fromContext",bindNonExistent:!1},{fieldName:"ourOrganizationName",propName:"dictionaries/0/componentOptions/ourOrganizationName",propPath:["0","componentOptions","ourOrganizationName"],fullPropName:"dictionaries/0/componentOptions/ourOrganizationName",propPathStr:"0/componentOptions/ourOrganizationName",oneWay:!0,direction:"fromContext",bindNonExistent:!1}],selectedKey:void 0,itemContentTpl:"tmpl!SBIS3.EDO.ContractSelectorButton/resources/template/itemTemplate",esc:!1},{name:"ContractSelectorButton",sbisname:"ContractSelectorButton"},{data:n,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:g,internal:{__dirtyCheckingVars_0:l.getter(n,["EdoModel"]),__dirtyCheckingVars_1:l.getter(n,["EdoModel"]),__dirtyCheckingVars_2:l.getter(n,["contractorId"]),__dirtyCheckingVars_6:l.getter(n,["contractorId"]),__dirtyCheckingVars_7:l.getter(n,["contractorName"])}},i,u,O,l.config,s),f.createControl("wsControl","ws:SBIS3.EDO2.OpenDialogAction",{name:"ContractSelectorButtonAction",editMode:"newFloatArea"},{name:"ContractSelectorButtonAction",sbisname:"ContractSelectorButtonAction"},{data:n,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:g},i,u,O,l.config,s)],r,S,this)],m,S);S.def&&(N=f.chain(N,S,r),S=void 0)}catch(t){l.templateError("resources/Elektronnyj_dokumentooborot/components/ContractSelectorButton/ContractSelectorButton.tmpl",t,n)}return N||""};return n.includedFunctions={},n.stable=!0,n.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.ContractSelectorButton"}},n});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.ContractSelectorButton", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-ContractSelectorButton .ContractSelectorButton{width:100%;color:#8991a9}.edo-ContractSelectorButton .hidden{display:none}.edo-ContractSelectorButton .hasSelectedItem{color:#333!important;text-decoration:none!important;margin-top:-1px;cursor:pointer}.edo-ContractSelectorButton .hasSelectedItem .controls-SelectorButton__text:hover{text-decoration:underline!important}.edo-ContractSelectorButton .hasSelectedItem .icon-disabled{color:#ccc!important}"));head.appendChild(style);});}
define("html!SBIS3.EDO.ContractSelectorDialog",function(){var o=function(o){var n=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;o.test(n);)n=n.replace(o,"&#123;&#123;$1&#125;&#125;");return n}}(),t=function(o){return o.join?o.join(""):o.toString()},e=function(o){return void 0===o?"":o&&"object"==typeof o?t(o):""+o},i="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="edo-ContractSelectorDialog" style="max-height:450px;"> <component data-component="SBIS3.CONTROLS/Action/Selector/SelectorWrapper" name="SelectorWrapper"> <opt name="content"> <div class="ws-window-titlebar-custom" data-lmchild="WindowTitle" style="font-size:0; padding-right:30px"> <component data-component="SBIS3.Contragents.ChoiceOurCompanyLink" class="ChoiceOurCompanyLink" name="ChoiceOurCompanyLink"> <opt name="multiselect" value="false"></opt> <opt name="defaultCaption" value="'+n(e(rk("Наша организация")))+'"></opt> <opt name="ShowAllCompany" value="false"></opt> <opt name="className" value="controls-SelectorButton__asLink"></opt> <opt name="enabled">'+n(e(o.ourOrgAllow))+'</opt> <opt name="allowChangeEnable">false</opt> <options name="componentOptions"> <option name="openCardCompany" value="');return o.ourOrganization&&(a+="true"),o.ourOrganization||(a+="false"),a+='"></option> <opt name="ShowInnerCompany" value="true"></opt> <opt name="ourCompany" value="false"></opt> <opt name="withAffiliates" value="true"></opt> </options> <opt name="idProperty" value="@Лицо"></opt> ',o.ourOrganization&&(a+=' <opts name="selectedItem"> <opt name="@Лицо">'+n(e(o.ourOrganization))+'</opt> <opt name="Название">'+n(e(o.ourOrganizationName))+"</opt> </opts> "),a+=" ",o.ourOrganization||(a+=' <opts name="selectedItem"> <opt name="@Лицо" bind="ФильтрДокументНашаОрганизация"></opt> <opt name="Название" bind="ФильтрДокументНашаОрганизацияТекст"></opt> </opts> '),a+=' </component> </div> <div class="label" style="margin-left: 15px; margin-bottom: 3px; margin-top: 6px;">'+n(e(rk("Номер")))+'</div> <component data-component="SBIS3.CONTROLS/SearchForm" class="searchForm" style="margin-left: 15px; margin-bottom:7px; width: 192px;"> <opt name="name">ФильтрПоМаске</opt> </component> <component data-component="SBIS3.CONTROLS/Button/IconButton" name="newContractVisibility" class="newContractVisibility"> <option name="icon">sprite:icon-24 icon-Expand icon-primary</option> </component> <component data-component="SBIS3.CONTROLS/Button" name="newContractButton" style="display:inline-block;"> <option name="caption">Создать</option> <option name="primary">true</option> </component> <div class="newContractComponentsArea" style="margin-left: 15px;margin-bottom: 9px;"> <div style="margin-bottom:5px;"> <span class="label">Дата</span> <span class="label" style="margin-left: 67px;">'+n(e(rk("Комментарий")))+'</span> </div> <div> <component data-component="SBIS3.CONTROLS/Date/Picker" name="datePicker"> </component> <component data-component="SBIS3.CONTROLS/TextBox" name="contractComment" style="margin-left: 10px;width:77%;"> </component> </div> </div> <component data-component="SBIS3.CONTROLS/ScrollContainer" name="ScrollContainer" style="max-height:300px;"> <option name="stickyContainer" value="true"></option> <option name="className" value="controls-ScrollContainer-flex"></option> <option name="content"> <component data-component="SBIS3.CONTROLS/DataGridView" name="ContractsList" class="controls-ListView__withoutMarker edo-Browser ContractsList controls-ListView__pagerNoSizePicker  controls-ListView__pagerHideEndButton controls-ListView__pagerNoAmount"> <options name="dataSource"> <option name="module" value="WS.Data/Source/SbisService"></option> <options name="options"> <option name="model" value="EdoModel"></option> <options name="endpoint"> <option name="contract" value="Документ"></option> </options> <options name="binding"> <option name="query" value="СписокДоговоровДляВыбора"></option> </options> <option name="idProperty" value="@Документ"></option> </options> </options> <options name="items" bind="items"></options> <option name="stickyHeader">false</option> <option name="idProperty" value="@Документ"></option> <option name="pageSize">10</option> <option name="infiniteScroll">down</option> <option name="infiniteScrollContainer">ScrollContainer</option> <option name="infiniteScrollPreloadOffset">0</option> <option name="multiselect">false</option> <option name="ignoreLocalPageSize">true</option> <option name="emptyHTML">'+n(e(rk("Нет договоров")))+'</option> <option name="showHead">false</option> <options name="filter"> <option name="ФильтрЛицо1">'+n(e(o.contractorId))+'</option> <option name="ФильтрТипыДокументов">'+n(e(o.docTypes))+'</option> <option name="ФильтрДокументНашаОрганизация">'+n(e(o.ourOrganization))+'</option> </options> <options name="itemsActions" type="array"></options> <options name="columns" type="array"> <options> <option name="cellTemplate">html!SBIS3.EDO.ContractSelectorButton/resources/columns/DateNumberColumn</option> <options name="includedTemplates"> <option name="DateNumberColumn">html!SBIS3.EDO2.Browser/resources/columns/DateNumberColumn</option> </options> <option name="className">dateColumn</option> <option name="fixedSize">true</option> <option name="width">15%</option> </options> <options> <option name="cellTemplate">html!SBIS3.EDO.ContractSelectorButton/resources/columns/TitleColumn</option> <options name="templateBinding"> ',o.ourOrganization&&(a+=' <option name="showOurOrg">false</option> '),a+=" ",o.ourOrganization||(a+=' <option name="showOurOrg">true</option> '),a+=' <option name="width">75%</option> </options> <option name="className">titleColumn</option> </options> ',o.showSumColumn&&(a+=' <options> <option name="cellTemplate">html!SBIS3.EDO.ContractSelectorButton/resources/columns/SumColumn</option> <option name="width">20%</option> <option name="showPenny">true</option> <option name="className">sumColumn</option> </options> '),a+=' </options> <option name="editingTemplate"></option> </component> </option> </component> </opt> <option name="linkedObjectName">ContractsList</option> </component> <component data-component="SBIS3.EDO2.OpenDialogAction" name="ContractSelectorButtonAction"> <option name="editMode">newFloatArea</option> </component> </div> ',(a=n(a))+(i&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.ContractSelectorDialog"}},o});
define("html!SBIS3.EDO.ContractSelectorButton/resources/columns/DateNumberColumn",function(){var e=function(e){var r=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(r){for(;e.test(r);)r=r.replace(e,"&#123;&#123;$1&#125;&#125;");return r}}(),t=function(e){return e.join?e.join(""):e.toString()},n=function(e){return void 0===e?"":e&&"object"==typeof e?t(e):""+e},o="undefined"!=typeof process,u=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,"");return e.startDateField="Дата",e.showNumber=!1,e.showTime=!1,u+=' <div style="margin-left:8px;">'+r(n(e.included.DateNumberColumn(e)))+"</div>",(u=r(u))+(o&&-1!==u.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.ContractSelectorButton/resources/columns/DateNumberColumn"}},e});
define("html!SBIS3.EDO.ContractSelectorButton/resources/columns/TitleColumn",function(){var t=function(t){var e=function(){var t={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},e=/&(?!#?\w+;)|<|>|"|'|\//g;return function(n){return n?n.toString().replace(e,function(e){return t[e]||e}):n}}(),n=function(){var t=/\{\{([\s\S]+?)\}\}/g;return function(e){for(;t.test(e);)e=e.replace(t,"&#123;&#123;$1&#125;&#125;");return e}}(),r=function(t){return t.join?t.join(""):t.toString()},o=function(t){return void 0===t?"":t&&"object"==typeof t?r(t):""+t},i="undefined"!=typeof process,l=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,""),s=t.item.get("Номер")||"б/н",u=t.item.has("ДокументРасширение.Название")&&t.item.get("ДокументРасширение.Название"),a=t.item.has("РП.Документ")&&t.item.get("РП.Документ").has("Регламент")&&t.item.get("РП.Документ").get("Регламент").has("Название")&&t.item.get("РП.Документ").get("Регламент").get("Название"),c=t.templateBinding.showOurOrg,d=c&&t.item.get("ДокументНашаОрганизация.Контрагент.Название")?t.item.get("ДокументНашаОрганизация.Контрагент.Название").replace(/"/g,"&quot;"):"";return l+=' <div class="main_column"> <div> ',s&&(l+='<div class="document_number text_overflow" title="№ '+n(o(e(s)))+'">№ '+n(o(e(s)))+"</div>"),l+='<div class="icon-16 icon-Forward icon-primary"></div> ',a&&(l+='<span class="regulation_title text_overflow" title="'+n(o(e(a)))+'">'+n(o(e(a)))+"</span>"),l+=" </div> <div> ",u&&(l+='<div class="document_comment text_overflow" style="width: ',c&&(l+="54%"),c||(l+="100%"),l+='" title="'+n(o(e(u)))+'">'+n(o(e(u)))+"</div>"),l+=" ",c&&(l+='<span class="our_org_title text_overflow" title="'+n(o(e(d)))+'" style="">'+n(o(e(d)))+"</span>"),l+=" </div> </div> ",(l=n(l))+(i&&-1!==l.indexOf("{{")?String.fromCharCode(8203,8203):"")};return t.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.ContractSelectorButton/resources/columns/TitleColumn"}},t});
define("html!SBIS3.EDO.ContractSelectorButton/resources/columns/SumColumn",function(){var e=function(e){var t=function(){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},t=/&(?!#?\w+;)|<|>|"|'|\//g;return function(o){return o?o.toString().replace(t,function(t){return e[t]||t}):o}}(),o=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;e.test(t);)t=t.replace(e,"&#123;&#123;$1&#125;&#125;");return t}}(),n=function(e){return e.join?e.join(""):e.toString()},s=function(e){return void 0===e?"":e&&"object"==typeof e?n(e):""+e},i="undefined"!=typeof process,m=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,""),r=e.item.has("$Сумма")&&e.item.get("$Сумма")&&0!==e.item.get("$Сумма")?e.item.get("$Сумма"):0,a=e.item.has("СуммаБезНДС")&&e.item.get("СуммаБезНДС")&&0!==e.item.get("СуммаБезНДС")?e.item.get("СуммаБезНДС"):0,r=parseFloat(r)+parseFloat(a);return summa1ToFixed=""!==r?parseInt(r,10).toString().replace(/(\d{1,3}(?=(\d{3})+(?:\.\d|\b)))/g,"$1 "):"",summa1Penny=""!==r?r.toFixed(2).slice(r.toFixed(2).indexOf(".")):"",summa1Title=summa1ToFixed?summa1ToFixed+summa1Penny:"",summa2ToFixed=""!==a?parseInt(a,10).toString().replace(/(\d{1,3}(?=(\d{3})+(?:\.\d|\b)))/g,"$1 "):"",summa2Penny=""!==a?a.toFixed(2).slice(a.toFixed(2).indexOf(".")):"",summa2Title=summa2ToFixed?"% "+summa2ToFixed+summa2Penny:"",0==summa1ToFixed&&r<0&&(summa1ToFixed="-"+summa1ToFixed,summa1Title="-"+summa1Title),0==summa2ToFixed&&a<0&&(summa2ToFixed="-"+summa2ToFixed,summa2Title="-"+summa2Title),m+=' <div class="sumColumn edo-Browser-sum" style="height:100%;"> ',r&&(m+=' <div class="edo-Browser-sum" style="width:100%;"> <div title="'+o(s(t(summa1Title)))+'" style="font-size:15px; color: #313E78; font-weight: bold; padding-top: 2px; overflow: hidden; white-space: nowrap; text-overflow: ellipsis;">'+o(s(t(summa1ToFixed)))+"<span class='edo-Browser-sum-penny small-text'>"+o(s(t(summa1Penny)))+"</span></div> ",0!==a&&(m+='<div title="'+o(s(t(summa2Title)))+'" style="font-size: 12px; color: #999999; line-height: 15px;"><span style="color:#CCCCCC;">'+o(s(rk("%")))+" </span>"+o(s(t(summa2ToFixed)))+"<span class='edo-Browser-sum-penny small-text'>"+o(s(t(summa2Penny)))+"</span></div>"),m+=" </div> "),m+=" </div> ",(m=o(m))+(i&&-1!==m.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.ContractSelectorButton/resources/columns/SumColumn"}},e});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.ContractSelectorDialog", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-ContractSelectorDialog .ChoiceOurCompanyLink .controls-SelectorButton__cross{display:none}.edo-ContractSelectorDialog .ChoiceOurCompanyLink{height:24px;left:105px;font-size:14px;font-weight:400;top:10px;overflow:hidden;text-overflow:ellipsis;max-width:75%;position:absolute;white-space:nowrap;max-width:370px}.edo-ContractSelectorDialog .label{color:#8991a9}.edo-ContractSelectorDialog .hasMoreLink{font-size:14px;margin-left:15px;bottom:5px}.edo-ContractSelectorDialog .sumColumn{width:auto;text-align:right;max-width:100px!important;padding-left:0}.edo-ContractSelectorDialog .sumColumn .edo-Browser-State__inner-state{padding-left:0}.edo-ContractSelectorDialog .titleColumn{vertical-align:top!important;text-align:left;margin-top:3px}.edo-ContractSelectorDialog .ws-float-area-title{padding-left:15px;padding-top:1px}.edo-ContractSelectorDialog .dateColumn,.edo-ContractSelectorDialog .sumColumn{vertical-align:top!important}.edo-ContractSelectorDialog .ContractsList{margin-bottom:10px}.edo-ContractSelectorDialog .ContractsList .controls-DataGridView__td{height:auto!important}.edo-ContractSelectorDialog .newContractVisibility{display:inline-block;margin:0 8px;top:-2px}.edo-ContractSelectorDialog .controls-ListView__EmptyData{padding-top:10px;padding-bottom:10px;color:#999}.edo-ContractSelectorDialog .controls-ListView__scrollPager{display:none}.edo-ContractSelectorDialog .edo-Browser-state-main-states{width:11px!important}.edo-ContractSelectorDialog .edo-Browser-State__additional-states-wrapper{display:none}.edo-ContractSelectorDialog .main_column{text-align:left;margin-top:3px;line-height:14px;color:#999}.edo-ContractSelectorDialog .document_number{max-width:calc(55% - 22px);color:#333;padding-top:1px}.edo-ContractSelectorDialog .regulation_title{font-size:12px;width:45%;float:right;color:#8991a9;padding-top:3px}.edo-ContractSelectorDialog .document_comment{font-size:14px;display:inline-block;padding-top:2px}.edo-ContractSelectorDialog .our_org_title{font-size:12px;width:45%;float:right}.edo-ContractSelectorDialog .text_overflow{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;display:inline-block}.edo-ContractSelectorDialog .main_column .icon-primary{visibility:hidden;margin-top:1px;margin-left:5px}.edo-ContractSelectorDialog .controls-ListView__hoveredItem .main_column .icon-primary{visibility:visible}.edo-ContractSelectorDialog .edo-Browser-sum-penny{font-size:12px;color:#ccc;font-weight:400}.edo-ContractSelectorDialog .controls-DataGridView__td .sumColumn{padding-right:4px}.edo-ContractSelectorDialog .controls-TextBox__wrapper{max-width:184px}"));head.appendChild(style);});}
define('js!SBIS3.EDO.ContractSelectorDialog',['SBIS3.CONTROLS/Action/Selector/SelectorController','html!SBIS3.EDO.ContractSelectorDialog','WS.Data/Source/SbisService','SBIS3.CONTROLS/ComponentBinder','Core/core-functions','Core/Deferred','SBIS3.CONTROLS/DataGridView','optional!js!SBIS3.Contragents.ChoiceOurCompanyLink','SBIS3.CONTROLS/SearchForm','SBIS3.CONTROLS/Link','SBIS3.CONTROLS/Button/IconButton','SBIS3.CONTROLS/Button','SBIS3.CONTROLS/Date/Picker','SBIS3.CONTROLS/TextBox','html!SBIS3.EDO.ContractSelectorButton/resources/columns/DateNumberColumn','html!SBIS3.EDO2.Browser/resources/columns/DateNumberColumn','html!SBIS3.EDO.ContractSelectorButton/resources/columns/TitleColumn','html!SBIS3.EDO.ContractSelectorButton/resources/columns/SumColumn','js!SBIS3.EDO2.OpenDialogAction','SBIS3.CONTROLS/SelectorButton','css!SBIS3.EDO.ContractSelectorDialog','SBIS3.CONTROLS/Action/Selector/SelectorWrapper','SBIS3.CONTROLS/ScrollContainer','Elektronnyj_dokumentooborot_localization'],function(t,e,o,n,i,a){var r;return r=t.extend({$protected:{_options:{allowCreateContract:false,ourOrgAllow:true}},_dotTplFn:e,_modifyOptions:function(t){for(var e=t.dataSet?t.dataSet:this.getLinkedContext().getValue('items'),o=false,n=0;n<e.getCount();n++)if(e.at(n).get('$Сумма'))o=true;return t['showSumColumn']=o,this.getLinkedContext().setValue('items',e),t;},init:function(){r.superclass.init.call(this);var t=this,e=t.getLinkedContext();if(t._dataGrid=this.getChildControlByName('ContractsList'),t._searchForm=this.getChildControlByName('ФильтрПоМаске'),t._newContractVisibility=this.getChildControlByName('newContractVisibility'),t._newContractButton=this.getChildControlByName('newContractButton'),t._newContractSwitchableArea=this.getContainer().find('div.newContractComponentsArea'),t._ChoiceOurCompanyLink=this.getChildControlByName('ChoiceOurCompanyLink'),t._datePicker=this.getChildControlByName('datePicker'),t._contractComment=this.getChildControlByName('contractComment'),t._ContractSelectorButtonAction=t.getChildControlByName('ContractSelectorButtonAction'),0===t.getLinkedContext().getValue('items').getCount()&&t._options.allowCreateContract)t._newContractButton.show(),t._newContractSwitchableArea.show(),t._newContractVisibility.setIcon('sprite:icon-24 icon-Curtail icon-primary'),t._emptyData=true;else t._emptyData=false,t._newContractButton.hide(),t._newContractSwitchableArea.hide();if(new n({view:t._dataGrid,searchForm:t._searchForm}).bindSearchGrid('ФильтрПоМаске'),t._dataGrid)t.subscribeTo(t._dataGrid,'onItemActivate',function(e,o){t.sendCommand('close',[this.getSelectedItem()]);});if(t.subscribeTo(t._dataGrid,'onDataLoad',function(e,o){if(this.setEmptyHTML(0===o.getCount()?this.getFilter()['ФильтрПоМаске']?rk('Не найдено договоров'):rk('Нет договоров'):rk('Нет договоров')),0===o.getCount()&&t._options.allowCreateContract)t._newContractButton.show(),t._newContractSwitchableArea.show(),t._newContractVisibility.setIcon('sprite:icon-24 icon-Curtail icon-primary');else{var n=false,a=i.clone(this.getColumns());if(2===a.length){for(var r=0;r<o.getCount();r++)if(o.at(r).get('$Сумма'))n=true;if(n){var c={width:'20%',showPenny:'true',className:'sumColumn',fixedSize:true,cellTemplate:'html!SBIS3.EDO.ContractSelectorButton/resources/columns/SumColumn'};this.setColumns(a.splice(2,0,c));}}}}),t.subscribeTo(t._dataGrid,'onItemClick',function(e,o,n,i){if($(i).hasClass('icon-primary')){t._ContractSelectorButtonAction._options.objectName=n.has('ТипДокумента.ТипДокумента')&&n.get('ТипДокумента.ТипДокумента');var a={item:n,id:o};t._ContractSelectorButtonAction.execute(a),e.setResult(false);}}),t.subscribeTo(t._ContractSelectorButtonAction,'onUpdateModel',function(e){t._dataGrid.reload();}),t.subscribeTo(t._ContractSelectorButtonAction,'onDestroyModel',function(e){t._dataGrid.reload();}),t.subscribeTo(t._newContractButton,'onActivated',function(e){var n=this,i=t._options.docTypes;if(t._options.allowCreateContract)if(t._options.ourOrganization){var r=new a();if(-1!==t._options.docTypes.indexOf('ДоговорИсх')||-1!==t._options.docTypes.indexOf('ДоговорВх'))new o({endpoint:'ГлобальныеПараметрыКлиента'}).call('ПолучитьЗначение',{'Путь':'unit_contracts_converted'}).addCallback(function(e){if('true'!==e.getRawData())r.callback(true);else i='ДоговорДок',new o({endpoint:'ДоговорДок'}).call('ПолучитьРегламентДляСоздания',{'ТипДокумента':t._options.docTypes}).addCallback(function(t){r.callback(t.getRawData());});});else r.callback(true);r.addCallback(function(e){var a=t._searchForm&&t._searchForm.getValue()?t._searchForm.getValue():null,r=new o({endpoint:i,binding:{read:'Прочитать',create:'Создать',format:'Список',query:'СписокХраним',update:'Записать'},idProperty:'@Документ'}),c=t._datePicker.getDate()?t._datePicker.getDate():new Date(),l=t._contractComment.getText()?t._contractComment.getText():null;n.setEnabled(false),r.create({'Лицо1':t._options.contractorId,'Дата':c,'Номер':a,'ИдРегламента':e&&true!==e?e:void 0,'ДокументНашаОрганизация':t._options.ourOrganization,'ДокументРасширение.Название':l}).addCallback(function(e){r.update(e).addCallback(function(){t.sendCommand('close',[e]);});});});}else t._ChoiceOurCompanyLink.markControl('Выберите нашу организацию!',true);}),t._options.allowCreateContract)t.subscribeTo(t._newContractVisibility,'onActivated',function(){if('sprite:icon-24 icon-Expand icon-primary'===this.getIcon())t._newContractSwitchableArea.show(),this.setIcon('sprite:icon-24 icon-Curtail icon-primary'),t._newContractButton.show();else t._newContractSwitchableArea.hide(),this.setIcon('sprite:icon-24 icon-Expand icon-primary'),t._newContractButton.hide();});else t._newContractVisibility.hide();t.subscribeTo(t._searchForm,'onTextChange',function(){if(t._options.allowCreateContract&&(t._searchForm.getText()||t._emptyData))t._newContractButton.show();else t._newContractButton.hide(),t._newContractSwitchableArea.hide(),t._newContractVisibility.setIcon('sprite:icon-24 icon-Expand icon-primary');});var c=t.getChildControlByName('SelectorWrapper').getLinkedContext();t.subscribeTo(c,'onFieldChange',function(e,o,n){if('ФильтрДокументНашаОрганизация'===o){t._options.ourOrganization=n;var i=t._dataGrid.getFilter();i[o]=n,t._dataGrid.setFilter(i);}if('ФильтрДокументНашаОрганизацияТекст'===o)t._options.ourOrganizationName=n;});}}),r.dimensions={title:'Договоры',width:'510',resizable:false,autoWidth:false},r;});
define("tmpl!SBIS3.EDO.ContractSelectorButton/resources/template/itemTemplate",["Core/tmpl/js/tclosure"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={},o=function e(o,n,l,i,a){function c(){}var s=0,u=void 0!==t&&t?t:arguments[arguments.length-1];void 0===u&&(eval("var thelpers = null;"),u=global.requirejs("View/Runner/tclosure"));var p={};a&&a.isSetts&&(p=a.fullContext||{});var d="string"==typeof l?l:"",m=void 0===r?void 0:r,f={id:[],def:void 0},v=u.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),h=this&&this.includedTemplates?this.includedTemplates:{},S=u.getMarkupGenerator(i);try{var g=S.joinElements([S.createTag("span",{title:"Договор № "+u.wrapUndef(u.utils.escape(u.getter(o,["item","Номер"])||"б/н"))},[S.createText(" № "+u.wrapUndef(u.utils.escape(u.getter(o,["item","Номер"])||"б/н"))+" ")],n,f,this)],d,f);f.def&&(g=S.chain(g,f,n),f=void 0)}catch(e){u.templateError("resources/Elektronnyj_dokumentooborot/components/ContractSelectorButton/resources/template/itemTemplate.tmpl",e,o)}return g||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.ContractSelectorButton/resources/template/itemTemplate"}},o});
define('js!SBIS3.EDO.ContractSelectorButton',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.ContractSelectorButton','WS.Data/Source/SbisService','WS.Data/Query/Query','js!SBIS3.EDO2.EdoModel','Core/ContextBinder','Core/core-functions','WS.Data/Entity/Model','optional!js!SBIS3.Contragents.OurOrgRightsManager','SBIS3.CONTROLS/SelectorButton','css!SBIS3.EDO.ContractSelectorButton','js!SBIS3.EDO2.OpenDialogAction','js!SBIS3.EDO.ContractSelectorDialog','tmpl!SBIS3.EDO.ContractSelectorButton/resources/template/itemTemplate','Elektronnyj_dokumentooborot_localization'],function(t,e,o,n,r,i,a,c,s){var l;return l=t.extend({$protected:{_options:{docTypes:null,contractorId:null,contractorName:null,ourOrganization:null,ourOrganizationName:null,selectedKey:null,caption:null,isRequired:false,EdoModel:r,visible:true,contractState:null,contextRestriction:'setget'}},_dotTplFn:e,$constructor:function(){var t=new i();t.defineBinding('selectedKey','selectedKey',false),t.defineBinding('caption','caption',false),t.defineBinding('docTypes','docTypes',false),t.defineBinding('ourOrganization','ourOrganization',false),t.defineBinding('ourOrganizationName','ourOrganizationName',false),t.defineBinding('contractState','contractState',false),t.bindControl(this,this.getContext()),this._publish('onDrawContract');},init:function(){this.setVisible(this._options.visible),l.superclass.init.call(this);var t=this,e=t.getLinkedContext();t._ContractSelectorButton=t.getChildControlByName('ContractSelectorButton');var i=t._ContractSelectorButton.getContainer();t._ContractSelectorButton.getDictionaries()[0].dialogOptions.target=t._ContractSelectorButton.getContainer(),t._ContractSelectorButton.getDictionaries()[0].dialogOptions.offset={x:0,y:20},t.subscribeTo(t,'onPropertyChanged',function(e,l){if('selectedKey'==l)if(t.getProperty(l))i.addClass('hasSelectedItem');else{if(i.removeClass('hasSelectedItem'),t.getProperty('caption'))t.setProperty('caption',null);if(t.getProperty('contractState'))t.setProperty('contractState',null);}if('docTypes'==l){if(!t.getProperty(l)||''===t.getProperty(l)||1!==t.getProperty(l).split(',').length)t._ContractSelectorButton.getDictionaries()[0].componentOptions.allowCreateContract=false;else if(t.getProperty(l)&&1===t.getProperty(l).split(',').length)(d=new o({endpoint:'ПроверкаПрав'})).call('ДоступностьМетода',{'ИмяМетода':t.getProperty(l)+'.Создать','ЧислоАргументов':2}).addCallback(function(e){if(t.isDestroyed())return;if(e)if(t._ContractSelectorButton&&t._ContractSelectorButton.getDictionaries()[0])t._ContractSelectorButton.getDictionaries()[0].componentOptions.allowCreateContract=e.getRawData();});if(!!t.getProperty('selectedKey')&&!t._ContractSelectorButton.getSelectedItem()){var u=new c({adapter:'adapter.sbis',format:[{name:'@Документ',type:'integer'},{name:'Номер',type:'string'}]});u.set('@Документ',t.getProperty('selectedKey')),u.set('Номер',t.getProperty('caption')),t._ContractSelectorButton.setSelectedItem(u);}}if('isRequired'===l&&t.getProperty(l)&&!t.getProperty('selectedKey')){var d=new o({endpoint:'Документ',model:r,binding:{read:'Прочитать',create:'Создать',format:'Список',query:'СписокДоговоровДляВыбора'},idProperty:'@Документ'}),p=new n();p.where({'ФильтрТипыДокументов':t._options.docTypes?t._options.docTypes:void 0,'ФильтрЛицо1':t._options.contractorId,'ФильтрДокументНашаОрганизация':t._options.ourOrganization?t._options.ourOrganization:void 0}),p.limit(10),d.query(p).addCallback(function(e){if(t.isDestroyed())return;if(!!t.getProperty('selectedKey'))return;if(1===e.getAll().getCount())t._ContractSelectorButton.setSelectedItem(e.getAll().at(0)),t._ContractSelectorButton.getContainer().removeClass('hidden');else{t._ContractSelectorButton.getContainer().removeClass('hidden');var o=a.clone(t._ContractSelectorButton.getDictionaries()[0]);if(o.dialogOptions.dataSource=null,o.componentOptions.dataSet=e.getAll(),t.isEnabled()&&!t.getProperty('selectedKey'))t._ContractSelectorButton.showSelector(o);}});}else t._ContractSelectorButton.getContainer().removeClass('hidden');if('ourOrganization'===l&&t.getProperty(l)&&s)t._ContractSelectorButton.getDictionaries()[0].componentOptions.ourOrgAllow=1===s.allow(t.getProperty(l));}),t._ContractSelectorButtonAction=t.getChildControlByName('ContractSelectorButtonAction'),t.subscribeTo(t._ContractSelectorButton,t._ContractSelectorButton.isEnabled()?'onChooserClick':'onItemActivate',function(e){if(this.getSelectedKey()){e.setResult(false),t._ContractSelectorButtonAction._options.objectName=this.getSelectedItem().get('ТипДокумента.ТипДокумента');var o={item:this.getSelectedItem(),id:this.getSelectedKey()};t._ContractSelectorButtonAction.execute(o);}}),t.subscribeTo(t._ContractSelectorButtonAction,'onDestroyModel',function(e){t.setCaption(null),t.setSelectedKey(null);}),t.subscribeTo(t._ContractSelectorButton,'onDrawItems',function(e){t._notify('onDrawContract');}),t._ContractSelectorButton.subscribe('onSelectedItemChange',function(e,o){if(t.isDestroyed())return;if(null!==o){if(this.getSelectedItem()){var n=this.getSelectedItem().get('Номер');if(t.getProperty('caption')!==n)t.setProperty('caption',n);}}else t.setProperty('caption',null);});},setSelectedKey:function(t){this._options.selectedKey=t,this._notifyOnPropertyChanged('selectedKey');},getSelectedKey:function(){return this._options.selectedKey;},setCaption:function(t){this._options.caption=t,this._notifyOnPropertyChanged('caption');},getCaption:function(){return this._options.caption;},setDocTypes:function(t){if('ДоговорВх'===t||'ДоговорИсх'===t)this._options.docTypes='ДоговорДок';else this._options.docTypes=t;this._notifyOnPropertyChanged('docTypes');},getDocTypes:function(){return this._options.docTypes;},setContractorId:function(t){this._options.contractorId=t,this._notifyOnPropertyChanged('contractorId');},getContractorId:function(){return this._options.contractorId;},setContractorName:function(t){this._options.contractorName=t;},getContractorName:function(){return this._options.contractorName;},setOurOrganization:function(t){this._options.ourOrganization=t,this._notifyOnPropertyChanged('ourOrganization');},getOurOrganizationName:function(){return this._options.ourOrganizationName;},setOurOrganizationName:function(t){this._options.ourOrganizationName=t,this._notifyOnPropertyChanged('ourOrganizationName');},setIsRequired:function(t){this._options.isRequired=t,this._notifyOnPropertyChanged('isRequired');},getIsRequired:function(){return this._options.isRequired;},setContractState:function(t){this._options.contractState=t,this._notifyOnPropertyChanged('contractState');},getContractState:function(){return this._options.contractState;}}),l;});
define('js!SBIS3.EDO.DocflowRulesHelpers',['WS.Data/Source/Memory','WS.Data/Entity/Model','js!SBIS3.EDO2.RemoteSourceMixin','Core/Deferred','Core/helpers/string-helpers','Bazovyj_komponent_dokument_localization'],function(e,t,r,o,n){var a;return a={getRulesList:function(e){var t=new o(),n=a.createFilterRecord(e);return r.getRemoteSource('RegulationNew').call('List',{'Фильтр':n}).addCallback(function(e){t.callback(e.getRow().get('Регламент'));}).addErrback(function(e){t.errback(e);}),t;},dataSetToStaticSource:function(t){var r=[],o=[],a,c,u,i;for(i=0;i<t.getCount();i++){if(a=t.at(i),c=a.get('ТипДокумента'),u=-1===a.get('Идентификатор')&&-1+', '+c.get('Тип')+c.get('ПодТип')||a.get('Идентификатор'),a.get('Избранный'))o.push(a.get('Идентификатор'));if(a.get('Избранный')||!($.inArray(a.get('Идентификатор'),o)>-1)||a.get('Раздел'))r.push({id:a.get('Избранный')&&a.get('Идентификатор')+', Избранный: true'||u,'@Регламент':a.get('@Регламент'),'Название':a.get('Название')?n.escapeHtml(a.get('Название')):'','Раздел':a.get('Раздел')?a.get('Раздел'):null,'Избранный':a.get('Избранный')?a.get('Избранный'):false,record:a});}return new e({data:r,idProperty:'id'});},ruleIsFolder:function(e){return!!(e&&e.get('Раздел@'));},createFilterRecord:function(e){for(var r=[],o=void 0===e.active?true:!!e.active,n=void 0===e.creationTypes?[0,2]:e.creationTypes,a=!!e.createDocWithoutRule,c=void 0===e.showFavorites?true:e.showFavorites,u=void 0===e.showTypes?true:e.showTypes,i,s,g,l=0,d=e.docTypes.length;l<d;l++){if(i=e.docTypes[l],s=[],'object'===typeof i)s.push(i.docType||null);if('object'===typeof i)s.push(i.docSubType||null);r.push(s);}return g={d:[o,n,{_type:'recordset',d:r,s:[{n:'Тип',t:'Строка'},{n:'ПодТип',t:'Строка'}]},a,true,c,true,u],s:[{n:'Действующий',t:'Логическое'},{n:'СпособыСоздания',t:{n:'Массив',t:'Число целое'}},{n:'ТипДокумента',t:'Выборка'},{n:'ПоказыватьПустыеПапки',t:'Логическое'},{n:'ПроверитьДоступ',t:'Логическое'},{n:'ПоказыватьИзбранные',t:'Логическое'},{n:'УпрощеннаяИерархия',t:'Логическое'},{n:'ПоказыватьТипы',t:'Логическое'}]},new t({rawData:g});}};});
define('js!SBIS3.EDO.Employee',['Core/moduleStubs','Core/IoC','js!SBIS3.ENGINE.MiniCard','css!Lib/Control/FloatArea/FloatArea','CHastnye_litsa_localization'],function(e,i,r){'use strict';i.resolve('ILogger').warn('SBIS3.EDO.Employee','Компонент устарел. Рекомендуется использовать SBIS3.ENGINE.MiniCard');var a;return a={initControl:function a(o,l){if(!o.facePk&&!o.profileServiceId)return void i.resolve('ILogger').log('SBIS3.EDO.Employee','Не задан идентификатор лица');if(!l.nameControl)return void i.resolve('ILogger').log('SBIS3.EDO.Employee','Не задан идентификатор элемента');var n=+new Date();(function i(){if(+new Date()-n>5000);else{var a=l.nameControl,t=l.jqElem?l.jqElem:$('#'+a);if(t.length>0)if(o.isBilling)if(l.onlyClick)e.requireModule('SBIS3.BILLING.MiniCard').addCallback(function(e){e[0].showCard(o.facePk,t);});else e.requireModule('SBIS3.BILLING.MiniCard').addCallback(function(e){t.attr('minicardid',e[0].initCard(o.facePk,{showByClick:false}));});else if(true===l.onlyClick)r._showCard({oid:o.facePk||o.profileServiceId,client:o.clientPk,template:'js!SBIS3.PersonalOffice.MiniCard'},t);else t.attr('data-minicard-template','js!SBIS3.PersonalOffice.MiniCard'),t.attr('data-minicard-oid',o.facePk||o.profileServiceId),t.attr('data-minicard-client',o.clientPk);else setTimeout(i,300);}}());},setUpdatePersonCardFlag:function(e){i.resolve('ILogger').error('SBIS3.EDO.Employee','Компонент устарел. Используйте SBIS3.ENGINE.MiniCard');}};});
define("html!SBIS3.EDO.FilterLimitationOverdue",function(){var o=function(o){var n=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;o.test(n);)n=n.replace(o,"&#123;&#123;$1&#125;&#125;");return n}}(),t=function(o){return o.join?o.join(""):o.toString()},e=function(o){return void 0===o?"":o&&"object"==typeof o?t(o):""+o},i="undefined"!=typeof process,r=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="edo-FilterLimitationOverdue"> <component data-component="SBIS3.CONTROLS/DropdownList" name="LimDropdown" class="controls-DropdownList__withoutArrow controls-DropdownList__linkStyle controls-DropdownList__withoutCross"> <options name="items" type="array"> <options> <option name="key" value="1"></option> <option name="title">'+n(e(rk("Срок")))+'</option> </options> <options> <option name="key" value="-1"></option> <option name="title">'+n(e(rk("Просроченные")))+'</option> </options> </options> <opt name="showSelectedInList">true</opt> <opt name="keyField" value="key"></opt> <opt name="displayField" value="title"></opt> <opt name="multiselect">false</opt> <option name="mode">click</option> <opt name="pickerClassName">controls-DropdownList__picker edo-DropdownFilter__picker</opt> <opts name="pickerConfig"> <opt name="closeByExternalOver">true</opt> </opts> </component> <component data-component="SBIS3.CONTROLS/Date/Picker" name="ФильтрСрокДата"> <option name="mask">DD.MM.YY</option> <option name="isCalendarIconShown">true</option> <option name="allowChangeEnable">true</option> </component> <component data-component="SBIS3.CONTROLS/Button/IconButton" name="btnClear" class="edo-LimDropdown__btnClear"> <opt name="icon">icon-16 icon-Close icon-disabled</opt> </component> </div>');return(r=n(r))+(i&&-1!==r.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.FilterLimitationOverdue"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.FilterLimitationOverdue", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-LimDropdown__btnClear{height:24px;margin-top:-2px;margin-left:-5px}.edo-FilterLimitationOverdue{height:24px;position:relative}.edo-FilterLimitationOverdue .controls-DatePicker{padding-left:5px;padding-right:5px}"));head.appendChild(style);});}
define('js!SBIS3.EDO.FilterLimitationOverdue',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.FilterLimitationOverdue','SBIS3.CONTROLS/Utils/DateUtil','css!SBIS3.EDO.FilterLimitationOverdue','SBIS3.CONTROLS/Date/Picker','SBIS3.CONTROLS/DropdownList','SBIS3.CONTROLS/Button/IconButton','i18n!SBIS3.EDO.FilterLimitationOverdue','Bazovyj_komponent_dokument_localization'],function(e,t,i){var n=e.extend({_dotTplFn:t,$protected:{_options:{name:'ФильтрСрок',valueLimitation:void 0,valueOverdue:void 0,stringValueLimitation:'',stringValueOverdue:'',filterType:void 0},_datePicker:void 0},$constructor:function(){this._publish('onValueClear');},getValueLimitation:function(){return this._options.valueLimitation;},getValueOverdue:function(){return this._options.valueOverdue;},getFilterType:function(){return this._options.filterType;},applyValue:function(e){var t=this,n=i.valueToDate(e);if(n&&t._datePicker)if(t.setFilterType(1),n)t._datePicker.setDate(n);else t._datePicker.setText('');else if(true===e)t.setFilterType(-1);else t.setFilterType(null);},setValueOverdue:function(e){var t=this;if(e!==t._options.valueOverdue){if(t._options.valueOverdue=e,e)t.setValueLimitation(null);t._notifyOnPropertyChanged('valueOverdue'),t.applyValue(e);}},setValueLimitation:function(e){var t=this;if(e!==t._options.valueLimitation){if(t._options.valueLimitation=e,e)t.setValueOverdue(null);t._notifyOnPropertyChanged('valueLimitation'),t.applyValue(e);}},setFilterType:function(e){var t=this;if(null==e)t._datePicker.setValue(null);if(e!==t._options.filterType){var i=t._options.filterType;if(t._options.filterType=e,t._notifyOnPropertyChanged('filterType'),null===e||void 0===e){if(t.hide(),-1==i)this.setValueOverdue(null);if(1==i)this.setValueLimitation(null);}else{if(t.show(),-1==e)this._limDropdown.setSelectedKeys([-1]),this.setValueOverdue(true);else this.setValueOverdue(null),this._limDropdown.setSelectedKeys([1]);if(1==e)t._datePicker.show();else t._datePicker.hide();}t._options.stringValueLimitation=t.getStringValueLimitation(),t._options.stringValueOverdue=t.getStringValueOverdue();}},getStringValueLimitation:function(){var e='';if(this._options.valueLimitation instanceof Date){var t=this._datePicker.getDate();if(t)e=rk('Срок до')+' '+t.strftime('%e %q %Y');}else e='';return e;},getStringValueOverdue:function(){if(true===this._options.valueOverdue)sValue=rk('Просроченные');else sValue='';return sValue;},init:function(){n.superclass.init.call(this);var e=this;if(this._datePicker=this.getChildControlByName('ФильтрСрокДата'),this._limDropdown=this.getChildControlByName('LimDropdown'),this._btnClear=this.getChildControlByName('btnClear'),this._datePicker)this._datePicker.subscribe('onDateChange',function(t){var i=this.getDate();e._options.valueLimitation=i,e._options.stringValueLimitation=e.getStringValueLimitation(),e._options.stringValueOverdue=e.getStringValueOverdue(),e._notifyOnPropertyChanged('valueLimitation'),e._notify('onValueChange',t,i);});if(this._limDropdown)this._limDropdown.subscribe('onSelectedItemsChange',function(t,i){if(i.length>0){if(e.setFilterType(i[0]),1==i[0])e._datePicker.setActive(true);}else e.setFilterType(void 0);});if(this._btnClear)this._btnClear.subscribe('onActivated',function(){return e.setFilterType(null),void e._notify('onValueClear');});if(e._options.valueOverdue)e.applyValue(e._options.valueOverdue);else e.applyValue(e._options.valueLimitation);}});return n;});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.BaseFiltersStyles", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-BaseFilter__flLabel{float:left;line-height:24px}.edo-BaseFilter__FieldLink{display:block!important;position:relative!important}.edo-BaseFilter_flbColumn_old{width:45%;float:left}.edo-BaseFilter__DropdownList .controls-DropdownList__textWrapper:hover{text-decoration:underline}.edo-BaseFilter__flContainer{display:flex;display:-ms-flexbox}.edo-BaseFilter__flLink{line-height:24px;margin-right:8px;white-space:nowrap;color:#05b!important}.edo-BaseFilter__flField{-ms-flex:1;width:100%;display:block!important;position:relative!important;min-width:0}.edo-twoColumnSelectors>.edo-BaseFilter_flbColumn{width:50%;float:left}.edo-BaseFilter__filterPicker{width:362px}.edo-BaseFilter__filterPicker:after{content:'';display:block;height:0;clear:both;visibility:hidden}.edo-BaseFilter__DropdownList .controls-DropdownList__value:hover{text-decoration:underline;color:#05b!important}.edo-BaseFilter__FilterMarksBtn.edo-MarksFilterView .controls-Button__text:hover{color:#05b!important}.edo-BaseFilter__flContainer~.edo-BaseFilter__HiddenChild>:not(.ws-hidden),.edo-BaseFilter__flContainer~.edo-BaseFilter__flContainer:not(.ws-hidden),.edo-BaseFilter__flContainer~.edo-BaseFilter__marginBottom:not(.ws-hidden),.edo-BaseFilter__marginBottom~.edo-BaseFilter__HiddenChild>:not(.ws-hidden),.edo-BaseFilter__marginBottom~.edo-BaseFilter__flContainer:not(.ws-hidden),.edo-BaseFilter__marginBottom~.edo-BaseFilter__marginBottom:not(.ws-hidden){margin-top:4px}"));head.appendChild(style);});}
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.TaskCol", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".rt_left{width:42px;display:inline-block;vertical-align:top}.rt_right{display:inline-block;vertical-align:top;width:100%;padding-left:5px}.rt_emptyname,.rt_username{position:relative;top:1px;color:#1f2c63;float:left;line-height:17px;font-size:15px;overflow:hidden;text-overflow:ellipsis;margin-right:7px}.rt_user_dept{position:relative;top:3px;color:#999;font-size:12px;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;line-height:16px;vertical-align:top}.rt_firstLine{display:block;position:relative;height:19px}.rt_regl_wrap{line-height:18px}.rt_regl{float:left;line-height:18px;font-size:14px;margin-right:3px}.rt_rightside{z-index:1;position:relative;background-color:#fff;float:right;white-space:nowrap;text-overflow:ellipsis;line-height:16px}.rt_rightside div{display:inline-block}.rt_milestone{z-index:1;background-color:#fff;position:relative;top:3px;color:#999;font-size:12px;padding-right:5px;max-width:25%;overflow:hidden;text-overflow:ellipsis;float:right;line-height:16px}.rt_datelimit{color:#999}.rt_datelimit .icon-16{margin-right:4px;position:relative;top:2px;padding-left:1px}.rt_datelimit .rt_term{position:relative}.rt_priopity{display:inline-block;margin-left:3px}.rt_priopity .icon-16{position:relative;top:3px}.rt_currcond,.rt_desc,.rt_prevcomment{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-right:56px;line-height:18px;font-size:14px}.rt_desc{max-height:18px}.rt_currcond a,.rt_prevcomment a{color:#999;font-size:13px}.rt_desc a{font-size:14px}.rt_face1{margin-right:56px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;color:#999!important;line-height:18px;display:table}.rt_face1:hover{text-decoration:underline}.rt_pad19{padding-left:19px}.rt_files{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-right:56px;color:#999;line-height:16px;position:relative;bottom:2px;clear:left}.rt_files .vd_item{font-size:14px;line-height:16px;color:#999}.rt_files .icon-Attach{position:relative;top:2px}.vd_item:hover{text-decoration:underline}.rt_right .icon-Attach,.rt_right .icon-EmptyMessage,.rt_right .icon-Handwrite2{font-size:16px!important;width:16px!important;height:16px!important;margin-right:3px;line-height:18px!important;top:-1px;position:relative;float:left}.rt_files span,.rt_files span a{color:#999}.rt_overtask{color:#8991a9;font-size:14px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;margin-right:56px;line-height:18px}.rt_overtask .overtask_icon{color:#8991a9;position:relative;top:2px;margin-top:-3px}.rt_currcond,.rt_prevcomment{color:#999;font-size:14px;margin-right:56px;clear:left}.rt_red{color:#ef463a!important}.rt_wrapper.unreaded *{font-weight:700}.rt_wrapper.unreaded .rt_files *{font-weight:400}.rt_folder_count{color:#999}.rt_folder_count_new{color:#ff7033}.rt_subtasks{cursor:pointer;font-size:14px;display:inline-block}.rt_subtasks_count{margin-left:0}.rt_subtasks:hover span:not(.icon-16),.rt_subtasks_count:hover{text-decoration:underline}.rt_subtasks .icon-16{vertical-align:text-bottom;color:#313e78!important;width:16px!important;height:16px!important;margin-left:-2px;padding-right:5px}.rt_desc p{margin:0}.controls-ListView__item-type-hidden .rt_subtasks .icon-16:before{content:\"\\e666\"}.controls-ListView__item-type-hidden .controls-TreeView__expand__open.rt_subtasks .icon-16:before{content:\"\\e692\"}.edo-BrowserWrapper-MainColumn__subtask-indent{margin-left:40px}.more_st{padding-left:19px}.rt_subtasks .icon-16.icon-primary.icon-subtask{color:#313e78!important}.edo-TaskCol_gradient{float:right;position:relative}.controls-ItemActions__activeItem .edo-TaskCol-date-number-mark-dot,.controls-ItemActions__activeItem .rt_milestone,.controls-ItemActions__activeItem .rt_rightside,.controls-ListView__hoveredItem .edo-TaskCol-date-number-mark-dot,.controls-ListView__hoveredItem .rt_milestone,.controls-ListView__hoveredItem .rt_rightside{background-color:#f0f5fb!important}.controls-ItemActions__activeItem .edo-TaskCol_gradient:after,.controls-ListView__hoveredItem .edo-TaskCol_gradient:after{background:-moz-linear-gradient(left,rgba(255,255,255,0) 0,#f0f5fb 100%);background:-webkit-gradient(linear,left top,right top,color-stop(0,rgba(255,255,255,0)),color-stop(100%,#f0f5fb));background:-webkit-linear-gradient(left,rgba(255,255,255,0) 0,#f0f5fb 100%);background:-o-linear-gradient(left,rgba(255,255,255,0) 0,#f0f5fb 100%);background:-ms-linear-gradient(left,rgba(255,255,255,0) 0,rgba(240,245,251,1) 100%);background:linear-gradient(to right,rgba(255,255,255,0) 0,rgba(240,245,251,1) 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#00ffffff', endColorstr='#F0F5FB', GradientType=1)}.edo-TaskCol_gradient:after{content:\"\\00a0\";box-sizing:content-box;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;position:absolute;width:64px;right:0;z-index:1;text-align:right;background-size:100% 100%;background:-moz-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,1) 100%);background:-webkit-gradient(linear,left top,right top,color-stop(0,rgba(255,255,255,0)),color-stop(100%,rgba(255,255,255,1)));background:-webkit-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,1) 100%);background:-o-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,1) 100%);background:-ms-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,1) 100%);background:linear-gradient(to right,rgba(255,255,255,0) 0,rgba(255,255,255,1) 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#00ffffff', endColorstr='#ffffff', GradientType=1)}.rt_title_prevcomm{left:-3px;position:relative}.controls-DataGridView__td.controls-DataGridView-cell-overflow-ellipsis .controls-TreeView__folderTitle>.rt_wrapper{padding-left:2px}.rt_wrapper .icon-Enter{vertical-align:text-bottom}.rt_block3{color:#999;clear:left}.rt_block3 .not_vd:first-child{margin-left:19px}.rt_subtasks_count{display:inline-block}.rt_subtasks_captions{margin-left:5px;display:inline-block;color:#999}.rt_block2.rt_float.rt_pad19,.rt_desc{margin-top:0}.rt_right .edo-TaskCol-date-number-mark-dot{position:absolute;margin-top:2px;background-color:#fff}.rt_block3 .emptyIconBlock{display:inline-block;margin-left:20px}.edo-BrowserWrapper .controls-dragndrop.controls-ListView__verticalDragNDrop .controls-DragNDrop__insertBefore:first-child,.edo-BrowserWrapper .controls-dragndrop.controls-ListView__verticalDragNDrop .controls-DragNDrop__insertBefore:first-child>td{border-top-width:2px!important}.edo-BrowserWrapper .rt_photo img{width:40px!important;height:40px!important}@media (max-width:1150px){.issubtask .rt_milestone,.issubtask .rt_rightside .rt_datelimit{display:none}}@media (max-width:1366px){.has-notice-center .issubtask .rt_milestone,.has-notice-center .issubtask .rt_rightside .rt_datelimit{display:none}}@media (min-width:1367px) and (max-width:1500px){.has-notice-center .issubtask .rt_milestone{display:none}}"));head.appendChild(style);});}
define("html!SBIS3.EDO.ERRORRERORT.DateMilestoneSelect",function(){var e=function(e){var o=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(o){for(;e.test(o);)o=o.replace(e,"&#123;&#123;$1&#125;&#125;");return o}}(),t=function(e){return e.join?e.join(""):e.toString()},n=function(e){return void 0===e?"":e&&"object"==typeof e?t(e):""+e},a="undefined"!=typeof process,p=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div style="max-width:265px;margin:8px;margin-bottom:0;"> <component data-component=\'SBIS3.CONTROLS/FieldLink/Link\' name="milestoneLink" class="ERRORRERORT_DateMilestoneSelect__milestoneLink"> <option name=\'caption\' value=\''+o(n(rk("Веха")))+'\'/> <option name="owner">fLinkMilestone</option> </component> <component data-component=\'SBIS3.CONTROLS/FieldLink\' name="fLinkMilestone" class="ERRORRERORT_DateMilestoneSelect__milestoneFLink"> <opt name="selectedKeys" bind="ФильтрВеха"></opt> <opt name=\'keyField\'>@Документ</opt> <opt name=\'displayField\'>ДокументРасширение.Название</opt> <opt name="autoShow" type="boolean">false</opt> <opt name="text" bind="suggestTextField"/> <opt name=\'textValue\' bind=\'ФильтрВехаТекст\' direction="fromProperty" oneWay="true" value=""/> <opt name="placeholder" value="'+o(n(rk("Укажите веху")))+'"/> <opt name=\'multiselect\' type=\'boolean\'>false</opt> <opt name=\'enabled\' type=\'boolean\'>true</opt> <opt name=\'allowChangeEnable\' type=\'boolean\'>false</opt> <opt name=\'selectRecordsMode\'>newFloatArea</opt> <opt name=\'oldViews\' type="boolean">false</opt> <opt name="useSelectorAction">true</opt> <opts name="dataSource"> <opt name="module" value="WS.Data/Source/SbisService"></opt> <opts name="options"> <opt name=\'endpoint\'>Веха</opt> <opt name=\'idProperty\'>@Документ</opt> <opts name="binding"> <opt name=\'query\'>СписокДляВыбора</opt> <opt name=\'format\'>Веха.Список</opt> </opts> </opts> </opts> <opts name="dictionaries" type="array"> <opts> <opt name="editMode">newFloatArea</opt> <opt name="name">Веха</opt> <opt name="objectName">Веха</opt> <opt name="template">js!SBIS3.Milestones.MilestoneSelectorDialog</opt> <opt name="keyField">@Документ</opt> <opts name="dialogOptions"> <opt name="className">ws-float-area__block-layout</opt> </opts> <opts name="componentOptions"> <opt name="searchString" bind="suggestTextField" oneWay="true" direction="fromContext"/> <opt name="fullFilter">true</opt> </opts> <opt name="selectionType">leaf</opt> </opts> </opts> <opts name="list"> <opt name="component" value="SBIS3.CONTROLS/DataGridView"/> <opts name="options"> <opt name="keyField">@Документ</opt> <opts name="itemsActions" type="array"/> <opt name=\'pageSize\'>5</opt> <opt name="ignoreLocalPageSize" value="true" type="boolean"/> <opts name="columns" type="array"> <opts> <opt name="title">Название</opt> <opt name="field">ДокументРасширение.Название</opt> </opts> </opts> <opt name="footerTpl" value="tmpl!SBIS3.EDO.BaseFiltersStyles/footerTpl"/> </opts> </opts> <options name="listFilter"> <option name="ФильтрПоМаске" bind="suggestTextField" oneWay="true"></option> <option name="ВидДерева">Только листья</option> <option name="ПолучитьПлоскийСписок">true</option> </options> </component> <div class="errorrerort-DateMilestoneSelect__to-hide ERRORRERORT_DateMilestoneSelect__display" style="margin:8px;width: 100%;"> <span style="float: left;line-height: 24px;color: #999;">'+o(n(rk("Дата выпуска")))+'</span> <component data-component="SBIS3.CONTROLS/Date/Picker" name="releaseDate" style="margin: 0 8px;position: absolute;left: 98px;"> <option name="mask">DD.MM.YY</option> <options name="validators" type="array"> <options> <option name="validator" type="function" value="SBIS3.CONTROLS/Utils/ControlsValidators:required"></option> <option name="errorMessage">'+o(n(rk("Введите дату выпуска")))+'</option> <option name="option">text</option> </options> </options> </component> </div> <div class="ERRORRERORT_DateMilestoneSelect__display" style="margin:0 8px;width: 100%;margin-top: -4px;"> <span style="float: left;line-height: 24px;color: #999;">'+o(n(rk("Период")))+'</span> <component data-component="SBIS3.CONTROLS/Date/Range" name="periodDate" style="float: right;margin-right: 16px;"> <option name="startDate" bind="DateFrom"></option> <option name="endDate" bind="DateTo"></option> <options name="validators" type="array"> <options> <option name="validator" type="function" value="js!SBIS3.EDO.ERRORRERORT.DateMilestoneSelect:prototype.checkDateToMilestoneDate"></option> <option name="errorMessage">'+o(n(rk("Дата конца не может быть меньше даты выпуска вехи")))+'</option> <option name="option">text</option> </options> <options> <option name="validator" type="function" value="js!SBIS3.EDO.ERRORRERORT.DateMilestoneSelect:prototype.checkRange"></option> <option name="errorMessage">'+o(n(rk("Введите период")))+'</option> <option name="option">text</option> </options> </options> </component> </div> <component data-component="SBIS3.CONTROLS/CheckBox" name="viaKPI" style="margin: 8px;display:none;"> <option name="caption">Построить по показателям KPI</option> <option name="checked">true</option> </component> <div style="margin-top:12px;margin-bottom: 16px;display:flex;"> <component data-component="SBIS3.CONTROLS/Button" name="buttonOK" class="ERRORRERORT_DateMilestoneSelect__buttonOk"> <option name="caption">'+o(n(rk("Применить")))+'</option> <option name="primary">true</option> </component> </div> </div>');return(p=o(p))+(a&&-1!==p.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.ERRORRERORT.DateMilestoneSelect"}},e});
define('js!SBIS3.EDO.ERRORRERORT.ErrorReport',['Core/EventBus','WS.Data/Source/SbisService','Core/constants','AreaOfResponsibility_localization'],function(e,o,t){return{onPrintErrorAnalyse:function(r){var i=r.getTopParent();i.WAid=r.workAreaId,i.period=i.getChildControlByName('periodDate'),i.period.dateFrom=i.period.getStartDate(),i.period.dateTo=i.period.getEndDate(),i.viaKPI=i.getChildControlByName('viaKPI').getProperty('checked'),new o({endpoint:'ВыпускВерсии'}).call('СгенерироватьОтчетОбОшибкахДопущенныхСотрудниками',{'ЗонаОтветственности':i.WAid,'ДатаНачала':i.period.dateFrom.toSQL(),'ДатаКонца':i.period.dateTo.toSQL(),'Показатели':i.viaKPI,'ПутьДоРесурсов':t.resourceRoot}).addCallback(function(){e.channel('LongOperations').notify('onOperationStarted');}),i.close();},onPrintErrorReport:function(r){var i=r.getTopParent();i.WAid=r.workAreaId,i.fLinkMilestone=i.getChildControlByName('fLinkMilestone'),i.milestoneId=i.fLinkMilestone.getSelectedKey(),i.milestoneRelease=i.getChildControlByName('releaseDate').getDate(),i.period=i.getChildControlByName('periodDate'),i.period.dateFrom=i.period.getStartDate(),i.period.dateTo=i.period.getEndDate(),i.viaKPI=i.getChildControlByName('viaKPI').getProperty('checked'),new o({endpoint:'ВыпускВерсии'}).call('СгенерироватьОтчетОбОшибкахПопавшихВРелиз',{'Веха':i.milestoneId,'ЗонаОтветственности':i.WAid,'ДатаНачала':i.period.dateFrom.toSQL(),'ДатаКонца':i.period.dateTo.toSQL(),'ДатаВыпуска':i.milestoneRelease.toSQL(),'ЧерезПоказатели':i.viaKPI,'ПутьДоРесурсов':t.resourceRoot}).addCallback(function(){e.channel('LongOperations').notify('onOperationStarted');}),i.close();}};});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.ERRORRERORT.DateMilestoneSelect", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".fix-field-link-align .ws-FieldLink__link{width:82px!important;text-align:left!important}.closer-label .ws-Label-title{margin-right:4px!important}.edo-DateMilestoneSelect__error-analyse{width:auto!important}.edo-DateMilestoneSelect__error-report{width:auto!important}.margin-left-8{margin-left:8px!important;margin-right:0!important}.analisys_errors{width:auto!important;margin-top:0!important}.ERRORRERORT_DateMilestoneSelect__milestoneLink{margin-left:8px;float:left;color:#999}.ERRORRERORT_DateMilestoneSelect__milestoneLink .controls-Link-link{float:left}.ERRORRERORT_DateMilestoneSelect__milestoneFLink{width:159px;margin:0 8px;float:right}.ERRORRERORT_DateMilestoneSelect__display{display:inline-block}.ERRORRERORT_DateMilestoneSelect__buttonOk{width:100px;margin:auto}"));head.appendChild(style);});}
define('js!SBIS3.EDO.ERRORRERORT.DateMilestoneSelect',['Core/UserConfig','SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.ERRORRERORT.DateMilestoneSelect','js!SBIS3.EDO.ERRORRERORT.ErrorReport','css!SBIS3.EDO.ERRORRERORT.DateMilestoneSelect','i18n!SBIS3.EDO.ERRORRERORT.DateMilestoneSelect','SBIS3.CONTROLS/FieldLink','SBIS3.CONTROLS/FieldLink/Link','SBIS3.CONTROLS/Date/Picker','SBIS3.CONTROLS/Date/Range','SBIS3.CONTROLS/Button','SBIS3.CONTROLS/CheckBox','SBIS3.CONTROLS/Utils/ControlsValidators','AreaOfResponsibility_localization'],function(e,t,a,i){var o='error-report-settings-dialog-parameters_new',r=t.extend({_dotTplFn:a,$protected:{_options:{}},$constructor:function(){this.getLinkedContext().setValue('ПолныйФильтр',true);},init:function(){r.superclass.init.call(this);var e=this;if(e.ok=this.getChildControlByName('buttonOK'),this.getTopParent()._options.isSaveParameters)this._loadParameters();this.getChildControlByName('fLinkMilestone').subscribe('onSelectedItemsChange',function(e,t,a){var i=this,o=this.getTopParent(),r;if(o.period=o.getChildControlByName('periodDate'),o.release=o.getChildControlByName('releaseDate'),i.getSelectedItem())if(!i._options.saveMilestone)mile_date=i.getSelectedItem().get('Веха.Дата'),mile_date_end=new Date(i.getSelectedItem().get('Веха.Дата')),o.release.setDate(mile_date),o.period.setStartDate(mile_date),mile_date_end.setDate(new Date(mile_date_end.getDate()+10)),o.period.setEndDate(mile_date_end);else i._options.saveMilestone=false;if(0===t.length)return void(r=null);}),e.ok.subscribe('onActivated',function(){var t=this.getTopParent(),a=t.getChildControlByName('releaseDate'),o=this.operationName;if(!t.validate())return;if(e.getTopParent()._options.isSaveParameters)e._saveParameters();i[o](this);});},_getParameters:function(){var e=this.getChildControlByName('fLinkMilestone'),t=this.getChildControlByName('releaseDate'),a=this.getChildControlByName('periodDate'),i={};return i[e.getName()]=e.getSelectedKey(),i[t.getName()]=t.getValue(),i[a.getName()+'Start']=a.getStartValue(),i[a.getName()+'End']=a.getEndValue(),i;},_setParameters:function(e){for(var t in e)if(e.hasOwnProperty(t))if('periodDateStart'==t)this.getChildControlByName('periodDate').setStartDate(e['periodDateStart']);else if('periodDateEnd'==t)this.getChildControlByName('periodDate').setEndDate(e['periodDateEnd']);else if('fLinkMilestone'==t){if(this.getChildControlByName('fLinkMilestone').setSelectedKey(e['fLinkMilestone']),e['fLinkMilestone'])this.getChildControlByName('fLinkMilestone')._options.saveMilestone=true;}else this.getChildControlByName(t).setValue(e[t]);},_saveParameters:function(){e.setParam(o,JSON.stringify(this._getParameters()));},_loadParameters:function(){var t=this;e.getParam(o).addCallback(function(e){t._setParameters(JSON.parse(e));});},checkRange:function(){var e=this.getTopParent();return e.period=e.getChildControlByName('periodDate'),e.period.dateFrom=e.period.getStartDate(),e.period.dateTo=e.period.getEndDate(),null!==e.period.dateFrom&&null!==e.period.dateTo;},checkDateToMilestoneDate:function(){var e=this.getTopParent();if(e.period=e.getChildControlByName('periodDate'),e.period.dateTo=e.period.getEndDate(),e.getChildControlByName('releaseDate').isVisible()){if(e.milestoneRelease=e.getChildControlByName('releaseDate').getDate(),!e.period.dateTo||!e.milestoneRelease)return true;return+e.period.dateTo>=+e.milestoneRelease;}else return true;}});return r;});
define("html!SBIS3.EDO.ERRORRERORT.ViewMode",function(){var o=function(o){var n=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;o.test(n);)n=n.replace(o,"&#123;&#123;$1&#125;&#125;");return n}}(),e=function(o){return o.join?o.join(""):o.toString()},t=function(o){return void 0===o?"":o&&"object"==typeof o?e(o):""+o},i="undefined"!=typeof process,r=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div> <component data-component="SBIS3.CONTROLS/Menu/MenuIcon" name="ViewModeMenu" class="errorReport-ViewMode__menuIcon"> <option name="caption">'+n(t(rk("Построить отчеты")))+'</option> <option name="tooltip">'+n(t(rk("Построить отчеты")))+'</option> <option name="icon">sprite:icon-24 icon-Report icon-primary</option> <option name="visible" bind="visibleReportButton" value="false"/> <options name="items" type="array"> <options> <option name="id">1</option> <option name="title">'+n(t(rk("Анализ ошибок, допущенных сотрудниками")))+'</option> </options> <options> <option name="id">2</option> <option name="title">'+n(t(rk("Отчет об ошибках, попавших в релиз")))+"</option> </options> </options> </component> </div>");return(r=n(r))+(i&&-1!==r.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.ERRORRERORT.ViewMode"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.ERRORRERORT.ViewMode", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".view-mode-user-title .ws-menu-item{height:32px}"));head.appendChild(style);});}
define('js!SBIS3.EDO.ERRORRERORT.ViewMode',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.ERRORRERORT.ViewMode','Lib/Control/Dialog/Dialog','Core/constants','SBIS3.CONTROLS/Menu/MenuIcon','css!SBIS3.EDO.ERRORRERORT.ViewMode','AreaOfResponsibility_localization'],function(e,t,o,n){var a=e.extend({_dotTplFn:t,$protected:{_options:{}},$constructor:function(){if('DevelopmentManagement'in n.modules)this.getLinkedContext().setValue('visibleReportButton',true);else this.getLinkedContext().setValue('visibleReportButton',false);},init:function(){a.superclass.init.call(this),this.getChildControlByName('ViewModeMenu').subscribe('onMenuItemActivate',function(e,t){if(!this.getTopParent().hasOwnProperty('id')){var n=[],a=this.getTopParent().getChildControlByName('browserView'),r=this.getTopParent().getChildControlByName('browserView').getSelectedItems()._$items;a.keys=this.getTopParent().getChildControlByName('browserView').getSelectedKeys(),r.forEach(function(e,t){n[t]=e.get('Название');}),a.names=n.join(', ');}else(a=this.getTopParent()).keys=[a.id],a.names=a.name;var i=a.hasChildControlByName('dateSliderWA')?a.getChildControlByName('dateSliderWA'):null,l=i?i.getStartValue():null,s=i?i.getEndValue():null;new o({name:'ViewModeSettings',resizable:false,template:'js!SBIS3.EDO.ERRORRERORT.DateMilestoneSelect',title:rk('Параметры'),opener:a,isSaveParameters:true,handlers:{onReady:function(){var e=this;switch(e.container=this.getContainer(),e.fLinkMilestone=e.getChildControlByName('fLinkMilestone'),e.linkMil=e.getChildControlByName('milestoneLink'),e.period=e.getChildControlByName('periodDate'),e.period.dateFrom=e.period.setStartDate(),e.period.dateTo=e.period.setEndDate(),e.release=e.getChildControlByName('releaseDate'),e.ok=e.getChildControlByName('buttonOK'),e.ok.workAreaId=a.keys,e.ok.workAreaName=a.names,t){case 1:e.container.addClass('edo-DateMilestoneSelect__error-analyse'),date=new Date(),firstDay=l&&s?l:new Date(date.getFullYear(),date.getMonth(),1),lastDay=l&&s?s:new Date(date.getFullYear(),date.getMonth()+1,0),e.period.setStartDate(firstDay),e.period.setEndDate(lastDay),e.period.getContainer().addClass('margin-left-8'),e.period.getContainer().parent().addClass('analisys_errors'),e.fLinkMilestone.hide(),e.linkMil.hide(),e.release.hide(),$('.errorrerort-DateMilestoneSelect__to-hide').hide(),e.ok.operationName='onPrintErrorAnalyse';break;case 2:e.container.addClass('edo-DateMilestoneSelect__error-report'),e.ok.operationName='onPrintErrorReport';}}}});});}});return a;});
define("html!SBIS3.EDO.TaskCol",function(){var e=function(e){function t(t,i){if("string"!=typeof t)return t;var r=t||"";return r=r.replace(/[\r\n]/g," "),r=o.escapeHtml(r),r=e.Sanitize(r),i=i||650,r.length>i&&(r=r.substr(0,i)+"..."),r=r.replace(/\n{2,}/g,"\n")}function i(t){var i=t||"";return i=i.replace(/<br>/g," "),i=i.replace(/<p>/g,""),i=i.replace(/<\/p>/g," "),i=i.replace(/<i>/g,""),i=i.replace(/<\/i>/g," "),i=i.replace(/<strong>/g,""),i=i.replace(/<\/strong>/g," "),i=i.replace(/<s>/g,""),i=i.replace(/<\/s>/g," "),i=i.replace(/<u>/g,""),i=i.replace(/<\/u>/g," "),i=i.replace(/<pre>/g,""),i=i.replace(/<\/pre>/g," "),i=i.replace(/<em>/g,""),i=i.replace(/<\/em>/g," "),i=i.replace(/&nbsp;/g," "),e.Sanitize(i,{validNodes:{iframe:!1,style:!1},validAttributes:{class:!1,style:!1}})}var r=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;e.test(t);)t=t.replace(e,"&#123;&#123;$1&#125;&#125;");return t}}(),a=function(e){return e.join?e.join(""):e.toString()},s=function(e){return void 0===e?"":e&&"object"==typeof e?a(e):""+e},n="undefined"!=typeof process,l=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,""),o=global.requirejs("Core/helpers/string-helpers");e.templateBinding&&(e.isNotCheckShortStateForPeriodRender=e.templateBinding.isNotCheckShortStateForPeriodRender,e.complexKeyField=e.templateBinding.complexKeyField,e.complexKeySubtaskField=e.templateBinding.complexKeySubtaskField,e.showSubtasks=e.templateBinding.showSubtasks,e.useFaceField=e.templateBinding.useFaceField,e.reverseDescriptionDefenition=e.templateBinding.reverseDescriptionDefenition,e.needCommentPrevStage=e.templateBinding.needCommentPrevStage);var c,d=e.isNode,g=function(e,t){return(t?"":e.getModelField("РП.Документ/Состояние/Обработка/ПоследнийЗначимыйЭтап/Комментарий"))||e.getModelField("РП.Документ/Состояние/Обработка/ПредыдущийЭтап/Комментарий")}(e.item,e.needCommentPrevStage),p=!(!g||""===g.replace(/\s+/g,"")),m=e.item.getModelField("РП.Документ/Состояние/Обработка/ТекущееСостояние/Комментарий"),u=(!m||!m.replace||m.replace(/\s+/g,""),!1===e.item.get("РП.Просмотрен")?"unreaded":""),v=function(e){var t,i,r="",a={},s="",n="";if(i=e.get("РП.ВехаДокумента")&&e.get("РП.ВехаДокумента").getCount()>0?e.get("РП.ВехаДокумента"):""){s=i.getCount()>1?i.getCount():"";var l=0;for(t=i.at(0).get("ДокументРасширение.Срок"),H=0;H<i.getCount();H++)n+=o.escapeHtml(i.at(H).get("ДокументРасширение.Название"))+", ",i.at(H).get("ДокументРасширение.Срок")<t&&(t=i.at(H).get("ДокументРасширение.Срок"),l=H);r=o.escapeHtml(i.at(l).get("ДокументРасширение.Название"))}return a.name=r,a.count=s,a.title=n.slice(0,-2),a}(e.item),f=6===e.item.get("РП.Документ/Состояние/Подписание/СостояниеКраткое")||2===e.item.get("РП.Документ/Состояние/Обработка/ПредыдущийЭтап/Действие/Статус")||2===e.item.get("РП.Документ/Состояние/Обработка/ПоследнийЗначимыйЭтап/Действие/Статус")||9===e.item.get("РП.Документ/Состояние/Подписание/СостояниеКраткое"),_=f?"rt_red":"";c=e.externalSrokObj?e.externalSrokObj:function(e){var t,i=e.get("РП.Срок"),r=e.get("ДокументРасширение.Срок")?e.get("ДокументРасширение.Срок"):"",a=e.has("ДокументРасширение.СостояниеКраткое")&&e.get("ДокументРасширение.СостояниеКраткое")?e.get("ДокументРасширение.СостояниеКраткое").get():-1,s=new Date,n="",l="",o="";if(i&&i.length>0){var c=i.indexOf("Срок#");c>-1&&("null"===(i=i.substring(c+5))&&(i=""),i&&i.length>0&&(i=Date.fromSQL(i)))}return(t=i||r)&&(n=[("0"+t.getDate()).slice(-2),("0"+(t.getMonth()+1)).slice(-2)].join("."),l=""==(o=t<s&&(7!=a||9!=a)?"rt_red":"")?"icon-16 icon-Time icon-disabled":"icon-16 icon-Time icon-error"),{srok:n,title:n,icon_class:l,srok_class:o}}(e.item),d&&(u=""),e.isNotCheckShortStateForPeriodRender||7!=f&&9!=f||(c="");var h=e.item.get("КоличествоВПапке")||"",k=h.replace(/[()]/g,"");h=""!==(h=2===(k=k.split("/")).length?parseInt(k[1],10)||parseInt(k[0],10)?parseInt(k[1],10)&&parseInt(k[0],10)?'<span class="rt_folder_count_new">'+k[1]+"</span><span>/"+k[0]+"</span>":parseInt(k[1],10)?'<span class="rt_folder_count_new">'+k[1]+"</span>":"<span>"+k[0]+"</span>":"":parseInt(k[0],10)?k[0]:"")?"("+h+")":"";var b,S=e.item.get("СписокИсполнителей"),y=rk("Исполнитель документа")+": ",C="",F="";if(e&&e.item&&e.item.get&&(C=e.item.get("Лицо.Название")||""),S&&S.getCount())if(b=S.at(0),S.getCount()>1){var x=S.getCount(),T=[];y=rk("Исполнители документа")+": ";for(H=0;H<x;H++)-1==Array.indexOf(T,S.at(H).get("Название"))&&T.push(t(S.at(H).get("Название")));C=T.length?T.join(", "):""}else b&&(C=b.get("Название"),F=b&&'"ЧастноеЛицо"'===b.get("Лицо_")?t(e.item.get("РП.ПодразделениеИсполнителя")):b.get("РуководительПодразделения")?"руководитель "+b.get("РуководительПодразделения"):"");y+=C;var B=e.item.get(e.complexKeyField||"ПапкаДокументов")&&e.item.get(e.complexKeyField||"ПапкаДокументов").indexOf&&-1!==e.item.get(e.complexKeyField||"ПапкаДокументов").indexOf(e.complexKeySubtaskField||"СвязьПапок")?"issubtask":"",w=function(t,i){if("string"!=typeof t)return t;var r=o.escapeHtml(t)||"";return r=e.Sanitize(r)||"",i=i||650,r.length>i&&(r=r.substr(0,i)+"..."),r}(g),P=t(e.item.getModelField("РП.Документ/Состояние/Обработка/ТекущееСостояние/Комментарий")),j=e.item.get("ИерархияНадзадачИПроектов")||[],D="",O="",I="",M=j.length>0;if(j.length>0){for(var H=j[0].length-1;H>=0;H--)D+=I=function(e){var r=rk("название не задано"),a=e["Тип"];return Array.indexOf(["Проект","Проверка","План работ"],a)>=0?a+=": ":a="",e["Название"]?r=e["Название"]:e["Информация"]&&(r=e["Информация"]),r=o.htmlToText(r),r=t(i(r)),a+r}(j[0][H]),O+=I,H>0&&(D+='<span class="overtask_icon icon-16 icon-size icon-DayForward"></span>',O+=" > ");O=o.escapeHtml(O)}var K=""===B?"js-controls-TreeView__expand":"";e.isSearch&&(K="",B=!0);e.item.has("Лицо1.Тип")&&e.item.get("Лицо1.Тип")&&e.item.get("Лицо1.Тип");var z=t(e.item.get("Название"));!0===e.useFaceField&&(C=e.item.get("Лицо.Название")||"",y=rk("Отправитель документа")+": "+C,F=t(e.item.get("РП.ПодразделенияСотрудника")),e.detalizationTitlePrefix&&(y=e.detalizationTitlePrefix+": "+C));var N="",E=0;try{N=e.item.get("РП.Документ").get("Регламент").get("Название"),E=e.item.get("РП.Документ").get("Регламент").get("Тип")}catch(t){N=e.item.get("Регламент.Название")}N=""===N?e.item.get("ТипДокумента.НазваниеКраткое"):N;var A="5869f4c8-a0a7-11e1-b04e-005056a63fed"===e.item.get("ИдРегламента")||E>0?null:N,R=parseInt(e.item.get("ДокументРасширение.ЧислоПодзадач")||e.item.get("ЧислоПодзадач"),10),L=function(e){if(null==e||0===e.length)return!0;for(var t=0;t<e.length;t++)if(" "!=e[t])return!1;return!0}(t(C)),$="";if(e.item.has("РП.ОсновнаяИнформация")&&e.item.get("РП.ОсновнаяИнформация")){var q=e.item.get("РП.ОсновнаяИнформация"),V="",J="";q.has("Комментарий1")&&q.get("Комментарий1")&&($=q.get("Комментарий1")),q.has("Заголовок1")&&q.get("Заголовок1")&&(V=t(q.get("Заголовок1").get("Название"))),q.has("Комментарий4")&&q.get("Комментарий4")&&(J=t(i(q.get("Комментарий4")))),V&&!$&&($=V,V=null),J&&!$&&($=J),$||($="")}if(e.item.has("РП.ДополнительнаяИнформация")&&e.item.get("РП.ДополнительнаяИнформация")){var Q,U=e.item.get("РП.ДополнительнаяИнформация"),G="",W=[],X=!0;if(U.getCount&&U.getCount())for(Q=U.getEnumerator();rec=Q.getNext();)if(rec.has("ИдО")&&!rec.get("ИдО")&&(X=!1),rec.has("Название")&&rec.get("Название")){var Y=rec.get("Название");rec.has("Сумма")&&null!==rec.get("Сумма")&&(Y+=" ="+rec.get("Сумма")),W.push("<span "+(X?'class="vd_item edo-Browser-attachment"':'class="not_vd"')+' id="'+rec.get("ИдО")+'" doctype="'+e.item.get("ТипДокумента.ТипДокумента")+'" vd_id="'+rec.get("ИдО")+'" doc_id="'+parseInt(e.item.get("@Документ"),10)+'">'+Y+"</span>")}G=W.length?W.join(", "):"",X&&W.length&&(G='<span class="icon-16 icon-Attach icon-disabled"></span>'+G)}var Z=function(e,t){return this.photoTpl?this.photoTpl({item:t,templateBinding:this.templateBinding}):""}.bind({photoTpl:e.included.photoTpl,templateBinding:e.templateBinding});return e.ladder.setConverter("docFacePhoto",Z),N==V&&(V=null),l+=' <div class="rt_rightside"> ',c.srok&&(l+=' <div class="rt_datelimit ',c.srok_class&&(l+=r(s(c.srok_class))+" "+r(s(u))),l+='" title="'+r(s(rk("Заголовок@@Срок")))+": "+r(s(c.title))+'">',c.icon_class&&(l+='<span class=" '+r(s(c.icon_class))+'"></span>'),l+='<span class="rt_term">'+r(s(c.srok))+"</span></div> "),l+=" </div> ",v.name&&(l+=' <div title="'+r(s(v.title))+'" class="rt_milestone rt_float"> ',v.count&&(l+=" ("+r(s(v.count))+") "),l+=" "+r(s(v.name))+" </div> "),l+=' <div class="edo-TaskCol_gradient"></div> <div class="rt_wrapper '+r(s(B))+'"> ',d?(l+=" "+r(s(z))+' <span class="rt_folder_count">'+r(s(h))+"</span> ",e.item.get("Условие")&&(l+='<span class="icon-16 icon-Enter icon-primary" title="'+r(s(rk("Папка с автораспределением задач")))+'"></span>'),l+=" ",e.item.get("Переназначение")&&(l+='<span class="icon-16 icon-Publish2 icon-primary" title="'+r(s(rk("Вы можете закрывать задачи за сотрудника")))+'"></span>'),l+=" "):(l+=' <div class="rt_left rt_float"> <div class="rt_photo rt_float"> '+r(s(e.ladder.isPrimary(e.item,"docFacePhoto")?Z(null,e.item):""))+' </div> </div> <div class="rt_right"> <div class="rt_firstLine"> ',L?(l+=" ",null!==A&&(l+=' <div class="rt_emptyname rt_float" title="'+r(s(t(y)))+'">'+r(s(e.decorators.apply(A)))+"</div> "),l+=" "):l+=' <div class="rt_username rt_float" title="'+r(s(t(y)))+'">'+r(s(e.decorators.apply(t(C))))+"</div> ",l+=' <div class="rt_user_dept rt_float">'+r(s(t(F?"&nbsp;/&nbsp;"+F:"")))+"</div> </div> ",B&&!0!==e.isSearch?l+=" ":(l+=" ",M&&!1!==e.showSubtasks&&(l+=' <div class="rt_overtask rt_float rt_pad19" title="'+r(s(t(O)))+'">'+r(s(D))+"</div> "),l+=" "),l+=" ",e.item.get("colorMarkState")&&e.item.get("colorMarkState").visible&&(l+=' <div> <span class="edo-TaskCol-date-number-mark-dot icon-16 icon-'+r(s(e.item.get("colorMarkState").icon))+'" title="'+r(s(e.item.get("colorMarkState").caption))+'"></span> </div> '),l+=' <div class="rt_regl_wrap rt_float rt_pad19"> ',!L&&A&&(l+=' <div class="rt_regl rt_float '+r(s(u))+'">'+r(s(e.decorators.apply(A))),""!==$&&(l+=":&nbsp;"),l+="</div>",""==$&&(l+="&nbsp;"),l+=" "),l+=' <div class="rt_desc rt_float '+r(s(u))+'" title="'+r(s(t(i(o.htmlToText($)))))+'"> '+r(s(e.decorators.apply(o.wrapURLs(i(o.htmlToText($))))))+" </div> </div> ",V&&(l+=' <div class="rt_block2 rt_float rt_pad19"> <div class="rt_desc rt_float" title="'+r(s(t(V)))+'"> '+r(s(V))+" </div> </div> "),l+=" ",G&&(l+=' <div class="rt_block3 rt_float"> <div class="rt_desc rt_float"> '+r(s(G))+" </div> </div> "),l+=" ",p&&(l+=' <div class="'+r(s(_))+' rt_prevcomment rt_float" title="'+r(s(w))+'"> <span class="'+r(s(_))+' icon-16 icon-EmptyMessage icon-disabled"></span> <span class="'+r(s(u))+' rt_title_prevcomm">'+r(s(w))+"</span> </div> "),l+=" ",m&&(l+=' <div class="rt_currcond rt_float" title="'+r(s(P))+'"><span class="icon-16 icon-Handwrite2 icon-disabled"></span><span class="rt_currcond_title">'+r(s(P))+"</span></div> "),l+=" ",R&&(l+=' <div class="rt_subtasks rt_float rt_pad16 '+r(s(K))+' has-child"><div class="rt_subtasks_count">',l+=""==B?'<span class="icon-16 icon-primary icon-subtask"></span>':'<span class="more_st">'+r(s(rk("есть")))+"</span> ",l+=r(s(R>1?R+" ":""))+r(s(rk("подзадача(-чи,-ч)",R)))+"</div> ",e.item.get("РП.ИсполнителиПодзадач")&&(l+='<div class="rt_subtasks_captions">'+r(s(e.item.get("РП.ИсполнителиПодзадач")))+"</div>"),l+=" </div> "),l+=" </div> "),l+=" </div> ",(l=r(l))+(n&&-1!==l.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.TaskCol"}},e});
define('js!SBIS3.EDO.TaskCol',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.PersonCore.Photo/photoCellTpl','html!SBIS3.EDO.TaskCol','css!SBIS3.EDO.TaskCol','Core/helpers/string-helpers','i18n!SBIS3.EDO.TaskCol','Elektronnyj_dokumentooborot_localization'],function(o,t){'use strict';var n=o.extend({_dotTplFn:t,$protected:{_options:{name:'TaskCol'}},$constructor:function(){},init:function(){var o=this;n.superclass.init.call(o);}});return n;});
define("html!SBIS3.EDO.DocDateCol",function(){var e=function(e){var t=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;e.test(t);)t=t.replace(e,"&#123;&#123;$1&#125;&#125;");return t}}(),n=function(e){return e.join?e.join(""):e.toString()},i=function(e){return void 0===e?"":e&&"object"==typeof e?n(e):""+e},o="undefined"!=typeof process,r=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,"");return e.templateBinding.only_date&&(r+=" ",e.only_date=!0,r+=" "),r+=" ",e.templateBinding.date_field&&(r+=" ",e.date_field=e.templateBinding.date_field,r+=" "),r+=" ",e.templateBinding.tasks&&(r+=" ",e.tasks=e.templateBinding.tasks,r+=" "),r+=" ",e.templateBinding.big_date&&(r+=" ",e.big_date=e.templateBinding.big_date,r+=" "),r+=" ",e.templateBinding.no_title&&(r+=" ",e.no_title=e.templateBinding.no_title,r+=" "),r+=" "+t(i(e.included.DateCol(e)))+" ",(r=t(r))+(o&&-1!==r.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.DocDateCol"}},e});
define("html!SBIS3.EDO.DateCol",function(){var e=function(e){var t=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;e.test(t);)t=t.replace(e,"&#123;&#123;$1&#125;&#125;");return t}}(),i=function(e){return e.join?e.join(""):e.toString()},r=function(e){return void 0===e?"":e&&"object"==typeof e?i(e):""+e},n="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,"");if(!0!==e.isNode){a+=" ";var o=function(t){var i,r=t?t.strftime(rk("%e %b")).toLowerCase():"";return r&&(r=t.strftime(rk("%e %b")).toLowerCase(),e.big_date&&(r=t?t.strftime("%d.%m.%y"):""),e.only_date&&(r=t.strftime(e.big_date?"%d.%m.%y":"%d.%m"))),e.big_date||(i=s(t)).length>0&&(r+=" "+i),r},s=function(t){var i="";if(!e.only_date&&t){var r=new Date;t.getFullYear()!==r.getFullYear()&&(i=t.strftime("%Y"))}return i},l=e.date_field||"Дата",d=o(e.item.get(l)),c=function(e){return e?e.strftime("%H:%M"):""}(e.item.get(l)),m=s(e.item.get(l)),u=e.item.get(l)?e.item.get(l).strftime("%d.%m.%y"):"",f="datecol_small",p="",_="";if(d){if(e.big_date&&e.item.has("ДокументРасширение.СостояниеКраткое"))try{20==parseInt(e.item.get("ДокументРасширение.СостояниеКраткое").get(),10)&&(_="removedByKontragent")}catch(e){}e.only_date?(f="datecol",p=!1===e.item.get("РП.Просмотрен")?"unreaded":""):u+=" "+c}e.templateBinding&&(e.show_priority_status=e.templateBinding.show_priority_status||!1,e.show_icon_unread=e.templateBinding.show_icon_unread||!1);var g=!1;if(e.item.has("ДокументРасширение.Приоритет")&&null!==e.item.get("ДокументРасширение.Приоритет")){var v=parseInt(e.item.get("ДокументРасширение.Приоритет").get(),10);1===v&&(g={icon:"icon-16 icon-Flag icon-hover",title:rk("Важно")}),2===v&&(g={icon:"icon-16 icon-Fire icon-error",title:rk("Критично")})}if(e.ladder.setConverter(l,o),a+=' <div class="'+t(r(f))+" "+t(r(p))+" "+t(r(_))+'" ',e.no_title||(a+=' title="',e.tasks?a+=t(r(rk("Дата документа"))):a+=t(r(rk("Получено"))),a+=" "+t(r(u))+'" '),a+="> ",e.big_date){a+=" ";var h='<span class="datecol_date">'+d+"<br/></span>";a+=" "+t(r(e.ladder.isPrimary(e.item,l)?h:""))+" ",!0!==e.only_date&&(a+=' <span class="datecol_time">'+t(r(c))+"</span> "),a+=" "}else a+=" ",m.length<=0?(a+=' <span class="datecol_date"> <span class="controls-ladder '+t(r(e.ladder.isPrimary(e.item,l)?"":"ws-invisible"))+'">'+t(r(d))+"</span> </span>  ",!0!==e.only_date&&(a+=' <span class="datecol_time">'+t(r(c))+"</span> "),a+=" "):a+=' <span class="datecol_date"> <span class="controls-ladder '+t(r(e.ladder.isPrimary(e.item,l)?"":"ws-invisible"))+'">'+t(r(d))+"</span> </span> ",a+=" ";a+="  ",e.show_icon_unread&&!1===e.item.get("РП.Просмотрен")&&(a+=' <span class="edo-DateCol_icon_unread icon-16 icon-Show icon-primary"></span> '),a+=" ",g&&e.show_priority_status&&(a+=" <br/><div title='"+t(r(g.title))+"' class=\""+t(r(g.icon))+'"></div> '),a+="       </div> "}return(a=t(a))+(n&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.DateCol"}},e});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.DateCol", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".datecol_small .datecol_date,.datecol_small .datecol_time{color:#999;font-size:12px}.controls-ListView__hoveredItem .datecol span.controls-ladder.ws-invisible,.controls-ListView__hoveredItem .datecol_small span.controls-ladder.ws-invisible{visibility:visible!important}.event_date{vertical-align:top!important;text-align:right!important;padding-right:8px!important}.unreaded{font-weight:700}.ws-invisible .datecol_date{display:none}.removedByKontragent{color:#ccc!important}.datecol_small .controls-ladder:not(.ws-invisible)~.datecol_time{display:block}.edo-DateCol_icon_unread{float:left;line-height:21px!important;margin-left:10px}"));head.appendChild(style);});}
define('js!SBIS3.EDO.DateCol',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.DateCol','css!SBIS3.EDO.DateCol','i18n!SBIS3.EDO.DateCol','Elektronnyj_dokumentooborot_localization'],function(t,n){'use strict';var o=t.extend({_dotTplFn:n,$protected:{_options:{name:'DateCol'}},$constructor:function(){},init:function(){var t=this;o.superclass.init.call(t);}});return o;});
define('js!SBIS3.EDO.DocDateCol',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.DocDateCol','js!SBIS3.EDO.DateCol','css!SBIS3.EDO.DateCol','Elektronnyj_dokumentooborot_localization'],function(t,o){'use strict';var n=t.extend({_dotTplFn:o,$protected:{_options:{name:'DocDateCol'}},$constructor:function(){},init:function(){var t=this;n.superclass.init.call(t);}});return n;});
define('js!SBIS3.EDO.OvertaskCrumbsHandlers',['Core/core-functions','Core/helpers/string-helpers','Core/helpers/fast-control-helpers','Core/Deferred','WS.Data/Source/SbisService','Core/RightsManager','Elektronnyj_dokumentooborot_localization'],function(e,n,a,r,t,l){'use strict';var i;return i={OvertaskClick:function(e,n){var a=e['Тип'],r=false;if(a&&Array.indexOf(['Проект','Этап'],a)>=0){if(e['Название'])r=true;}else r=true;if(r){var t={id:e['@Документ']};if(n.hasChildControlByName('OvertaskAction'))n.getChildControlByName('OvertaskAction').execute(t);else require(['js!SBIS3.EDO2.OpenDialogAction'],function(e){new e().execute({id:t.id,openMode:4});});}},getOvertaskCaption:function(e){var a='название не задано',r=e['Тип'];if(Array.indexOf(['Проект','План работ'],r)>=0)r+=': ';else r='';if(e['Название'])a=e['Название'];else if(e['Информация'])a=e['Информация'];return a=n.htmlToText(a),r+a.replace(/\n{2,}/g,'\n');},makeDelParams:function(e,n,a,r){var t={},l=0;if(r)l=n[a].length-1;if(n[a]&&n[a].length>0)t['@Документ']=e,t['Раздел']=n[a][l]['@Документ'],t['ТипРаздела']=n[a][l]['Тип'];return t;},dropRelation:function(n,i){var c=new r();return a.question(rk('Удалить связь?'),{name:'qOvertaskDropRelation'}).addCallback(function(a){if(true===a){var r=n['ТипРаздела'];if(r&&Array.indexOf(['Проект','Этап'],r)>=0)(o=new t({endpoint:'СлужЗап'})).call('УдалитьИзПроекта',{'ИдЗадачи':n['@Документ'],'ИдПроекта':n['Раздел']}).addCallback(function(e){c.callback();});else if(r&&Array.indexOf(['План работ','Пункт плана'],r)>=0)(o=new t({endpoint:'Документ'})).call('РазрешеноЛиРедактироватьДокументВФазе',{'ключДокумента':n['Раздел'],'Супервизор':false}).addCallback(function(a){if(false===a.getScalar())e.alert('План закрыт для редактирования','Удаление работ невозможно','info').addCallback(function(e){c.callback();});else(o=new t({endpoint:'ПланРабот'})).call('DellTaskInPlan',{'ИдО':n['Раздел'],'ИдЗадачи':n['@Документ']}).addCallback(function(e){c.callback();});});else if(r&&Array.indexOf(['Совещание','СовещаниеСервис','Видеосовещание','Вебинар'],r)>=0)if(!(l.getRights(['Совещания'])['Совещания']&&l.WRITE_MASK))e.alert('У вас недостаточно прав на выполнение данного действия','','info').addCallback(function(e){c.callback();});else(o=new t({endpoint:'Meeting'})).call('DelTaskInMeet',{'ИдСовещания':n['Раздел'],'ИдЗадачи':n['@Документ']}).addCallback(function(e){c.callback();});else if('TenderCard'==r)(o=new t({endpoint:'Документ'})).call('УдалитьСвязь',{'ДокументСледствие':n['@Документ'],'ДокументОснование':n['Раздел'],'ВидСвязи':1,'ВидСвязиДокумента':null}).addCallback(function(e){c.callback();});else{var o=new t({endpoint:'Документ'});o.call('УдалитьСвязьСНадзадачей',{'Документ':n['@Документ'],'БазовыйДокумент':n['Раздел']}).addCallback(function(e){var n=i.getLinkedContext(),a=i.getLinkedContext().getValue('record'),r=false;if(a)r=a.isChanged();if(i.getLinkedContext().removeValue('record/РазличныеДокументы.БазовыйДокумент'),a&&!r)a.acceptChanges();c.callback();});}}}),c;},getOvertaskHierLists:function(e,n){var a=function(e){var n=[];if(e)for(var a in e)if(e.hasOwnProperty(a)){var r=e[a];if(r)for(var t in r)if(r.hasOwnProperty(t)){var l=r[t];if(l&&'СлужЗап'===l['Тип']&&-1===n.indexOf(l['@Документ']))n.push(l['@Документ']);}}return n;};return{old:a(e&&e.get('ИерархияНадзадачИПроектов')),new:a(n&&n.get('ИерархияНадзадачИПроектов'))};},getOvertaskFace:function(e,n){if(!e||!n)return;var a=e.getAll().getRecordById(n);if(!a||!a.get('Лицо')||!a.get('Имя'))a=null;return a;}};});
define("html!SBIS3.EDO.OvertaskCrumbs",function(){var o=function(o){var e=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(e){for(;o.test(e);)e=e.replace(o,"&#123;&#123;$1&#125;&#125;");return e}}(),n=function(o){return o.join?o.join(""):o.toString()},t=function(o){return void 0===o?"":o&&"object"==typeof o?n(o):""+o},r="undefined"!=typeof process,a=("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),i=function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,s="",p=global.requirejs("Core/core-functions"),l=global.requirejs("WS.Data/Chain"),m=o.data,u=parseInt(o.docID,10),d=!!u&&!!m;if(d){var c=3,v=[];4!=(v=m instanceof Array?m:function(o,e){function n(o,e,a){var i=r[o];if(i){var s=i["Разделы"],l=p.clone(e);l.push(i);var m=p.clone(a);if(m.push(i["@Документ"]),s&&s.length>0)for(var u in s)s.hasOwnProperty(u)&&(-1===m.indexOf(s[u])?n(s[u],l,m):t.push(l));else t.push(l),e=[],a=[];e=[],a=[]}else e&&e.length>0&&t.push(e),e=[],a=[]}for(var t=[],r={},a=0;a<e.getCount();a++){var i={};i=new l(e.at(a)).toObject(),r[i["@Документ"]]=i}var s=[];r[o]&&(s=r[o]["Разделы"]);for(var a in s)s.hasOwnProperty(a)&&n(s[a],[],[]);return t}(u,m)).length&&4!=o.overtasksCount||(c=4);var f=p.clone(v.slice(0,c)),C=v.length,b=f.length,h=C>c,k=!0;o.overtasksCount&&(b!=o.overtasksCount&&(k=!1),o.overtasksCount>c?(b=c,h=!0):b=o.overtasksCount);var _="overtasks__rows-1";switch(b){case 1:_="overtasks__rows-1";break;case 2:_="overtasks__rows-2";break;case 3:_="overtasks__rows-3";break;case 4:_="overtasks__rows-4"}}if(s+=" <div class='edo-OvertaskCrumbs'> ",d&&f&&f.length>0){if(s+=' <style>  .ws-is-mobile-safari.ws-is-touch.ws-is-mobile-platform .edo-Dialog_header-firstLine + .controls-Panel { max-height: none; } </style> <div class=" '+e(t(_))+" ",o.fullMode?s+="edo-OvertaskCrumbs__mainContainer":s+="edo-OvertaskCrumbs__mainContainerDisabled",s+=" ",h&&o.fullMode&&(s+=" edo-OvertaskCrumbs__mainContainer_withTreeBtn"),s+='"> ',k){s+=" ";var O=f;if(O)for(var S,y=-1,g=O.length-1;y<g;){s+=" ",(S=O[y+=1]).reverse(),s+=' <div class="edo-OvertaskCrumbs__CrumbsContainer" style="position: relative;"> <component data-component="SBIS3.CONTROLS/BreadCrumbs" name="BreadCrumbs'+e(t(y))+'" class="edo-OvertaskCrumbs__BreadCrumbs ',o.fullMode?s+="edo-OvertaskCrumbs__BreadCrumbsEnabled ":s+="edo-OvertaskCrumbs__BreadCrumbsDisabled",s+='"> <option name="allowChangeEnable" type="boolean">false</option> <option name="dataArr" type="ref">'+e(t(function(o,e){var n=a.randomId();return o[n]=e,n}(i,v)))+'</option> <option name="doc_id">'+e(t(u))+'</option> <options name="items" type="array"> ';var w=S;if(w)for(var D,I=-1,B=w.length-1;I<B;)D=w[I+=1],s+=' <options> <option name="id">'+e(t(I))+'</option> <option name="title">'+e(t(o.getOvertaskCaption(D)))+"</option> </options> ";s+=' </options> <option name="paramsObj" type="ref">'+e(t(function(o,e){var n=a.randomId();return o[n]=e,n}(i,S)))+"</option> ",(o.fullMode||o.allowClick)&&(s+=' <options name="handlers"> <option name="onItemClick" type="function">js!SBIS3.EDO.OvertaskCrumbs:prototype.onCrumbClick</option> </options> '),s+=" </component> ",o.fullMode&&(s+=' <component data-component="SBIS3.CONTROLS/Link" name="btnDropRelation'+e(t(y))+'" class="edo-OvertaskCrumbs__btnDropRelation icon-16"> <option name="allowChangeEnable">false</option> <option name="icon">sprite: icon-16 icon-Close icon-primary</option> <option name="tooltip">'+e(t(rk("Удалить связь")))+'</option> <option name="paramsObj" type="ref">'+e(t(function(o,e){var n=a.randomId();return o[n]=e,n}(i,o.makeDelParams(o.docID,v,y))))+'</option> <options name="handlers"> <option name="onActivated" type="function">js!SBIS3.EDO.OvertaskCrumbs:prototype.onBtnDropRelationClick</option> </options> </component> '),s+=" </div> "}s+=' <component data-component="SBIS3.CONTROLS/Link" name="btnShowTree" class="edo-OvertaskCrumbs__btnShowTree" ',h&&o.fullMode||(s+=' style="visibility: hidden" '),s+='> <option name="allowChangeEnable">false</option> <option name="icon">sprite:icon-16 icon-TreeView icon-primary</option> <option name="caption">ещё&nbsp;'+e(t(C-c))+'</option> <option name="tooltip">'+e(t(rk("Показать дерево иерархии связанных документов")))+'</option> <option name="dataArr" type="ref">'+e(t(function(o,e){var n=a.randomId();return o[n]=e,n}(i,v)))+'</option> <option name="doc_id">'+e(t(u))+"</option> </component> "}s+=" </div> "}return s+=" </div> ",(s=e(s))+(r&&-1!==s.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.OvertaskCrumbs"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.OvertaskCrumbs", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-OvertaskCrumbs{min-height:4px;position:relative}.edo-OvertaskCrumbs .controls-BreadCrumbs__title,.edo-OvertaskCrumbs .controls-ButtonBase .controls-Button__text,.edo-OvertaskCrumbs .icon-primary{color:#8991a9}.ws-is-desktop-platform .edo-OvertaskCrumbs .controls-Link:not(.ws-disabled):not(.controls-Click__active):not(.controls-Link__disabledHover):hover .controls-Button__icon.icon-primary{color:#8991a9!important}.edo-OvertaskCrumbs .controls-BreadCrumbs .controls-BreadCrumbs__dots .controls-BreadCrumbs__arrow.icon-16.icon-DayForward.icon-primary.action-hover:hover,.edo-OvertaskCrumbs .controls-BreadCrumbs .controls-BreadCrumbs__dots:hover .controls-BreadCrumbs__arrow{color:#ff7033!important}.has-comment .edo-OvertaskCrumbs{min-height:0;padding-bottom:0}.edo-OvertaskCrumbs__mainContainer{padding-right:12px;padding-bottom:2px}.edo-OvertaskCrumbs__mainContainer_withTreeBtn{margin-right:68px!important}.edo-OvertaskCrumbs__mainContainer .controls-Link{line-height:18px!important}.edo-OvertaskCrumbs__CrumbsContainer{height:26px}.edo-OvertaskCrumbs__BreadCrumbs .controls-BreadCrumbs__crumb-home{display:none}.edo-OvertaskCrumbs__BreadCrumbsEnabled{display:block}.edo-OvertaskCrumbs__BreadCrumbs{display:block;margin-left:-3px}.edo-OvertaskCrumbs__btnDropRelation{margin-left:-12px;position:absolute;top:4px;left:-50px;display:none;height:16px}.ws-is-ie .edo-OvertaskCrumbs__btnDropRelation{top:2px}.edo-OvertaskCrumbs__btnDropRelation .controls-Button__icon{color:#999!important}.edo-OvertaskCrumbs__btnDropRelation:hover{color:#ff7033!important;text-decoration:none}.edo-OvertaskCrumbs__btnDropRelation.ws-hover-target:hover{text-decoration:none!important}.edo-OvertaskCrumbs__btnShowTree{margin-left:-100px;line-height:24px!important;height:26px;padding-top:1px;display:none}.edo-OvertaskCrumbs__BreadCrumbsDisabled .controls-BreadCrumbs__title{color:#8991a9!important}.edo-OvertaskCrumbs__BreadCrumbsDisabled .controls-BreadCrumbs__title.ws-hover-target{color:#8991a9!important}.edo-OvertaskCrumbs__BreadCrumbsDisabled .controls-BreadCrumbs__crumb:hover .icon-16{color:#8991a9!important}.edo-OvertaskCrumbs__BreadCrumbsDisabled .controls-BreadCrumbs__crumb .icon-16{color:#8991a9!important}.edo-OvertaskCrumbs__BreadCrumbsDisabled.controls-BreadCrumbs .controls-BreadCrumbs__dots .controls-BreadCrumbs__arrow.icon-16.icon-DayForward.icon-primary.action-hover:hover{color:#8991a9!important}.overtasks__rows-1{height:26px}.overtasks__rows-2{height:52px}.overtasks__rows-3{height:78px}.overtasks__rows-3.edo-OvertaskCrumbs__mainContainer_withTreeBtn,.overtasks__rows-4{height:103px}"));head.appendChild(style);});}
define("html!SBIS3.EDO.OvertaskTree",function(){var e=function(e){var o=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(o){for(;e.test(o);)o=o.replace(e,"&#123;&#123;$1&#125;&#125;");return o}}(),t=function(e){return e.join?e.join(""):e.toString()},n=function(e){return void 0===e?"":e&&"object"==typeof e?t(e):""+e},r="undefined"!=typeof process,a=("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),s=function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,i='<div class="edo-OvertaskTree"> <component data-component="SBIS3.CONTROLS/ScrollContainer" class="edo-OvertaskTree__mainContainer"> <opt name="content" type="string"> ';if(e.dataArr){i+=" ";var d=e.dataArr;if(d)for(var p,c=-1,v=d.length-1;c<v;){i+=" <div> ",(p=d[c+=1]).reverse(),i+=" ";var l=p;if(l)for(var m,O=-1,_=l.length-1;O<_;){m=l[O+=1],i+=" ";var f=0,k=!0;O>0&&(k=!1,f=26*O);var u=e.getOvertaskFace(e.dataFaces,m["@Документ"]);i+=' <div class="controls-MenuItem edo-OvertaskTree__overtaskLine ',0==O&&(i+="edo-OvertaskTree__overtaskLineHead"),i+=' " data-indexpath="'+o(n(c))+'" data-index="'+o(n(O))+'"> ',i+=k?'<div class="icon-16 icon-TFDocument icon-disabled action-hover edo-OvertaskTree__headPic"></div>':' <div class="icon-16 icon-MarkLeftBold icon-primary edo-OvertaskTree__brunchPic" style="margin-left:'+o(n(f))+'px"></div>',i+='<div class="edo-OvertaskTree__itemOvertask',k&&(i+=" edo-OvertaskTree__itemHead"),i+='">'+o(n(e.getOvertaskCaption(m)))+"</div> ",k&&(i+=' <component data-component="SBIS3.CONTROLS/Link" name="btnDropRelation'+o(n(c))+'" class="edo-OvertaskTree__btnDropRelation icon-16 icon-Close"> <option name="allowChangeEnable">false</option> <option name="tooltip">'+o(n(rk("Удалить связь")))+'</option> <option name="paramsObj" type="ref">'+o(n(function(e,o){var t=a.randomId();return e[t]=o,t}(s,e.makeDelParams(e.doc_id,e.dataArr,c,!0))))+'</option> <options name="handlers"> <option name="onActivated" type="function"> js!SBIS3.EDO.OvertaskTree:prototype.onDropRelationClick </option> </options> </component> ',u&&(i+=' <div class="edo-OvertaskTree__personData"> <component data-component="SBIS3.Person.PersonPhoto" class="edo-OvertaskTree__personPhoto"> <options name="data"> <opt name="personId">'+o(n(u.get("Лицо")))+'</opt> <opt name="photoId">'+o(n(u.get("Фото")))+'</opt> </options> <opts name="settingsView"> <opt name="size">32</opt> </opts> </component> <span class="edo-OvertaskTree__personName edo-OvertaskTree__personText">'+o(n(u.get("Имя")))+'</span> <span class="edo-OvertaskTree__personSubdivision edo-OvertaskTree__personText">'+o(n(u.get("Подразделение")?u.get("Подразделение"):""))+"</span> </div> "),i+=" "),i+=" </div> "}i+=" </div> "}i+=" "}return i+=" </opt> </component> </div>",(i=o(i))+(r&&-1!==i.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.OvertaskTree"}},e});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.OvertaskTree", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-OvertaskTree__mainContainer{min-width:300px;margin-bottom:4px;max-height:500px;padding-top:4px}.edo-OvertaskTree__itemOvertask{display:inline;font:15px TensorFont,sans-serif}.edo-OvertaskTree__itemHead{font-weight:700;height:32px}.edo-OvertaskTree__brunchPic{transform:rotate(-45deg);display:inline-block;width:16px;height:16px;padding:5px}.edo-OvertaskTree__headPic{padding:6px 5px 4px 5px}.edo-OvertaskTree__btnDropRelation{color:#999!important;position:absolute;top:13px;left:-16px;height:16px}.edo-OvertaskTree__btnDropRelation.ws-hover-target{color:#ff7033;text-decoration:none}.edo-OvertaskTree__overtaskLine{height:28px;line-height:28px;padding-right:30px;padding-left:0;display:block;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.edo-OvertaskTree__overtaskLineHead{padding-top:4px;padding-right:258px!important;height:36px;line-height:32px;display:block;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.edo-OvertaskTree__personPhoto{display:inline-block;float:left;margin-right:6px}.edo-OvertaskTree__personData{display:block;position:absolute;right:36px;top:2px;width:200px;text-align:right;float:right}.edo-OvertaskTree__personText{display:block;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;text-align:left}.edo-OvertaskTree__personName{font-size:14px;font-weight:700;color:#313e78;height:18px;line-height:18px}.edo-OvertaskTree__personSubdivision{height:16px;line-height:16px;color:#999;font-size:12px}"));head.appendChild(style);});}
define('js!SBIS3.EDO.OvertaskTree',['SBIS3.CONTROLS/CompoundControl','js!SBIS3.EDO.OvertaskCrumbsHandlers','html!SBIS3.EDO.OvertaskTree','SBIS3.CONTROLS/ScrollContainer','css!SBIS3.EDO.OvertaskTree','i18n!SBIS3.EDO.OvertaskTree','js!SBIS3.Person.PersonPhoto','Elektronnyj_dokumentooborot_localization'],function(e,t,r){'use strict';var a=e.extend({_dotTplFn:r,$protected:{_options:{enabled:false,name:'OvertaskTree',autoWidth:true,autoHeight:true,getOvertaskCaption:t.getOvertaskCaption,makeDelParams:t.makeDelParams,getOvertaskFace:t.getOvertaskFace,parentCrumbs:void 0}},$constructor:function(){var e=this;$('.edo-OvertaskTree__overtaskLine').click(function(){if(!e._options.enabled)return;var r=$(this).data().indexpath,a=$(this).data().index;t.OvertaskClick(e._options.dataArr[r][a],e._options.parentBrw),e.getParent().hide();});},init:function(){a.superclass.init.call(this);var e=this,t=e.getParent().getOpener();if(t){var r=t.getContainer().width();e.getContainer().css('max-width',r-1+'px');}},redrawBtns:function(){var e=this,t=e.getContainer().width()-256;$('.edo-OvertaskTree__overtaskLine',e.getContainer()).each(function(){var e=$('.edo-OvertaskTree__itemHead',$(this)).width()+16,r=Math.min(e+14,t);$('.edo-OvertaskTree__btnDropRelation',$(this)).css({left:r});}),e._options.enabled=true;},onDropRelationClick:function(){var e=this.getParentByClass('SBIS3.EDO.OvertaskTree');if(!e._options.enabled)return;if(this._options.paramsObj&&e._options.parentCrumbs)e._options.parentCrumbs.dropRelation(this._options.paramsObj);}});return a;});
define('js!SBIS3.EDO.OvertaskCrumbs',['Core/core-instance','Core/helpers/fast-control-helpers','Core/Deferred','SBIS3.CONTROLS/CompoundControl','js!SBIS3.EDO.OvertaskCrumbsHandlers','WS.Data/Source/SbisService','Core/EventBus','html!SBIS3.EDO.OvertaskCrumbs','css!SBIS3.EDO.OvertaskCrumbs','js!SBIS3.EDO.OvertaskTree','SBIS3.CONTROLS/Link','SBIS3.CONTROLS/BreadCrumbs','Core/core-functions','i18n!SBIS3.EDO.OvertaskCrumbs','Elektronnyj_dokumentooborot_localization'],function(t,e,o,r,a,n,i,s){'use strict';var l=r.extend({_dotTplFn:s,$protected:{_options:{data:void 0,docID:void 0,reloadMethodName:'',overtasksCount:void 0,getOvertaskCaption:a.getOvertaskCaption,makeDelParams:a.makeDelParams,fullMode:true,allowClick:false},_docObj:void 0,_brw:void 0,_treeFloatArea:void 0,CRUMB_COUNT:3},$constructor:function(){this._publish('onDropOverdocRelation');},init:function(){l.superclass.init.call(this);var t=this;t._brw=t.getTopParent(),t.subscribe('onAfterShow',function(){t.redrawBtns();}),t.subscribe('onResize',function(){t.redrawBtns();}),t.waitChildControlByName('btnShowTree').addCallback(function(e){if(e.subscribe('onActivated',function(){t.showTreeFloatArea();}),$(e.getContainer()).hover(function(){t.tryCreateHoverShowTree();}),e._options.dataArr.length>t.CRUMB_COUNT)t.loadFacesData(e._options.dataArr,e);}),t.replaceDotsClickHandlers();},reloadData:function(){var t=this,e=new o(),r='Документ',a='ПолучитьИерархиюНадзадачИПроектов';if(t._options.reloadMethodName){var i=t._options.reloadMethodName.split('.');if(2==i.length&&i[0]&&i[1])r=i[0],a=i[1];}return new n({endpoint:r}).call(a,{'Задачи':[t._options.docID],ready_RS:null}).addCallback(function(o){e.callback(t.setData(o.getAll()));}),e;},replaceDotsClickHandlers:function(){for(var e=this,o=e.getChildControls(),r=0;r<o.length;r++)if(t.instanceOfModule(o[r],'SBIS3.CONTROLS/BreadCrumbs'))(function(t){t._dotsClickHandler=function(){if(e._options.fullMode)e.showTreeFloatArea(t);};}(o[r]));},tryRedrawAll:function(){if(this._options.docID&&this._options.data)this.redrawAll();},redrawAll:function(){if(this._treeFloatArea)this._treeFloatArea.destroy(),this._treeFloatArea=void 0;if(this.rebuildMarkup(),!this.isVisible())this.show();this.redrawBtns(),this.replaceDotsClickHandlers();var t=this;t.waitChildControlByName('btnShowTree').addCallback(function(e){if(e.subscribe('onActivated',function(){t.showTreeFloatArea();}),$(e.getContainer()).hover(function(){t.tryCreateHoverShowTree();}),e._options.dataArr.length>t.CRUMB_COUNT)t.loadFacesData(e._options.dataArr,e);});},redrawBtns:function(){var t=this,e=this._options.fullMode?68:0;if(t._options.docID&&t._options.data){var o=$(t.getContainer()).width()-e;if(o>0)$.each($('.edo-OvertaskCrumbs__CrumbsContainer',t.getContainer()),function(t,e){var r=$('.controls-BreadCrumbs',e);r.width(o);var a=r.wsControl();if(a)a.redraw();var n=$('.controls-BreadCrumbs__itemsContainer',e).width();$('.edo-OvertaskCrumbs__btnDropRelation',e).css({left:n+16,display:'inline-block'});}),$('.edo-OvertaskCrumbs__btnShowTree',t.getContainer()).css({'margin-left':0,display:'inline-block'});}},setData:function(t){this._options.data=t,this._options.overtasksCount=void 0;var e=this.getLinkedContext().getValue('record'),o=e?e.isChanged():void 0;if(this._notifyOnPropertyChanged('data'),e&&!o)e.acceptChanges();this.tryRedrawAll();},getData:function(){return this._options.data;},setDocID:function(t){this._options.docID=t,this.tryRedrawAll();},getDocID:function(){return this._options.docID;},setOvertasksCount:function(t){this._options.overtasksCount=t;},getOvertasksCount:function(){return this._options.overtasksCount;},onCrumbClick:function(t,e){var o=this.getParentByClass('SBIS3.EDO.OvertaskCrumbs');if(this._options.paramsObj[e])a.OvertaskClick(this._options.paramsObj[e],o._brw);},onBtnDropRelationClick:function(t){var e=this.getParentByClass('SBIS3.EDO.OvertaskCrumbs');if(this._options.paramsObj)e.dropRelation(this._options.paramsObj);},dropRelation:function(t){var e=this;a.dropRelation(t,e).addCallback(function(){if(e._notify('onAfterDropOverdocRelation',t),e.hasChildControlByName('btnShowTree')){var o=e.getChildControlByName('btnShowTree')._options.caption;if(!o||o&&1==o)e.hide();}else e.hide();e.reloadData().addCallback(function(){if(!e.isVisible())e.show();e._notify('onDropOverdocRelation');var o=t['@Документ'],r=t['Раздел'];i.channel('OvertaskCrumbs').notify('onDropOverdocRelation',o,r),e.getTopParent()._resizeChilds();});});},showTreeFloatArea:function(){var t=this;if(t.tryCreateHoverShowTree(),t._treeFloatArea)t._treeFloatArea.show();},tryCreateHoverShowTree:function(){if(!this._treeFloatArea)this.setHoverShowTree();},setHoverShowTree:function(){var t=this;if(t.hasChildControlByName('btnShowTree')){var o=t.getChildControlByName('btnShowTree');e.showHoverFloatArea(o.getContainer(),false,{template:'js!SBIS3.EDO.OvertaskTree',componentOptions:{name:'OvertaskTree',dataArr:o._options.dataArr,doc_id:o._options.doc_id,dataFaces:o._options.dataFaces,parentBrw:t._brw,parentCrumbs:t},target:t.getTopParent().getContainer(),parent:t,opener:t.getTopParent(),showDelay:1000,autoShow:true,autoCloseOnHide:false,animation:'fade',side:'left',offset:{x:0,y:-3},verticalAlign:'top'}).addCallback(function(e){t._treeFloatArea=e,e.show(),e.once('onAfterShow',function(){var t=e.getChildControlByName('OvertaskTree');if(t)t.redrawBtns();});});}},loadFacesData:function(t,e){for(var o={},r=0;r<t.length;r++){var a=t[r][t[r].length-1],i=a['@Документ'],s=a['Тип'];if(o.hasOwnProperty(s))o[s].push(i);else o[s]=[i];}new n({endpoint:'Документ'}).call('ПолучитьЛицаДляИерархии',{types_lists:o}).addCallback(function(t){e._options.dataFaces=t;});}});return l;});
define("html!SBIS3.EDO.FilterLinkButtonCtx",function(){var t=function(t){var n=function(){var t=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;t.test(n);)n=n.replace(t,"&#123;&#123;$1&#125;&#125;");return n}}(),e=function(t){return t.join?t.join(""):t.toString()},o=function(t){return void 0===t?"":t&&"object"==typeof t?e(t):""+t},r="undefined"!=typeof process,i=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="edo-FilterLinkButtonCtx_mainContainer" style="height:24px;width:auto;"> <component data-component="SBIS3.CONTROLS/Link" name="FilterSelector"> <option name="caption">'+n(o(t.fText))+"</option> </component> </div>");return(i=n(i))+(r&&-1!==i.indexOf("{{")?String.fromCharCode(8203,8203):"")};return t.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.FilterLinkButtonCtx"}},t});
define('js!SBIS3.EDO.FilterLinkButtonCtx',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.FilterLinkButtonCtx','SBIS3.CONTROLS/Link','Bazovyj_komponent_dokument_localization'],function(e,t){var i=e.extend({_dotTplFn:t,$protected:{_options:{tabindex:0,value:void 0,fValue:void 0,fText:'',fTooltip:'',defaultValue:null,excludedFilters:[]}},$constructor:function(){},init:function(){i.superclass.init.call(this);var e=this;e._btn=e.getChildControlByName('FilterSelector'),e.setFTooltip(this._options.fTooltip),e._btn.subscribe('onActivated',function(){e.setValue(e._options.fValue);}),e._options.value=e._options.defaultValue;},setFTooltip:function(e){this._btn.setTooltip(e);},setValue:function(e){var t=this;if(t._options.value!==e)if(t._options.value=e,t.setVisibility(),t._notifyOnPropertyChanged('value'),e&&e!=t._options.defaultValue)for(var i in t._options.excludedFilters)if(t._options.excludedFilters.hasOwnProperty(i)){var n=t._options.excludedFilters[i],o=null,l=[],r=n.toString().split(':');if(r.length>1)n=r[0],l=r[1].toString().split(',');if(t.getLinkedContext().getValue(n)){var s=t.getLinkedContext().getValue(n).toString().split(','),a=false;if(l.length>0){for(var i=0;i<s.length;i++)if(Array.indexOf(l,s[i])>=0){a=true;break;}}else a=true;if(a){if(Array.indexOf(['FilterState','FilterShortState'],n)>=0)o=-1;if(Array.indexOf(['FilterAuthorOrResponsibleMe','FilterOwner'],n)>=0)o='Все';if(Array.indexOf(['FilterFace1','FilterResponsibleFace','FilterAuthorOrResponsible','FilterEventPerformer','FilterListDispatch','FilterAuthor','FilterSender','FilterSubdivision','FilterMilestone','FilterReceiver'],n)>=0)o=[];if(t.getLinkedContext().setValue(n,o),t.getLinkedContext().getValue(n+'Show'))t.getLinkedContext().setValue(n+'Show',false);}}else if(t.getLinkedContext().getValue(n+'Show'))t.getLinkedContext().setValue(n+'Show',false);}},getValue:function(){return this._options.value;},setVisibility:function(){var e=this;if(e._options.value==e._options.fValue)e.getContainer().addClass('ws-hidden');else e.getContainer().removeClass('ws-hidden');}});return i;});
define('js!SBIS3.EDO.EdoOperationsCommon',['Core/core-functions','Transport/BLObject','Core/helpers/fast-control-helpers','Core/Indicator','Core/Deferred','WS.Data/Format/StringField','WS.Data/Chain','WS.Data/Collection/Factory/RecordSet','WS.Data/Adapter/Sbis','i18n!SBIS3.EDO.EdoOperationsCommon','Elektronnyj_dokumentooborot_localization'],function(e,t,i,l,r,a,n,f,d){'use strict';var o={processSelectedPageSizeCommon:function(e,t,a){var s=t._getView().getItems(),u=s.getCount(),c=0,g=t;if(e)if(e>u)i.question(rk('Операция займет продолжительное время. Провести операцию?'),{},g).addCallback(function(t){if(t)l.show(),o._filterDataUnload(g,false),g._getView()._callQuery(g._getView().getFilter(),g._getView().getSorting(),0,e).addCallback(function(e){l.hide(),g._applyOperation(e),o._filterDataUnload(g,true);});});else{if(e<u)c=0,s=new n(g._getView().getItems()).filter(function(t){if(!t.get((g._getView().getParentProperty&&g._getView().getParentProperty())+'@'))return c++<e;else return false;}).value(f,{adapter:new d()});g._applyOperation(s);}else{l.show();var p=a?null:1000,m=function(e){if(e.getCount()==p)return i.message('Отмечено '+p+' записей, максимально допустимое количество, обрабатываемое системой СБИС.');else{var t=new r();return t.callback(),t;}};o._filterDataUnload(g,false),t._loadFullData(p).addCallback(function(e){l.hide(),m(e).addCallback(function(){g._applyOperation(e),o._filterDataUnload(g,true);});}).addErrback(function(e){return l.hide(),o._filterDataUnload(g,true),e;});}},_filterDataUnload:function(e,t){var i={},l=e._getView();if(i=l.getFilter(),!t)i['ФильтрВыгрузкаДанных']=true;else delete i['ФильтрВыгрузкаДанных'];l.setFilter(i,true);},documentsPrepareExport:function(e){var t=['ДокументРасширение.СостояниеКраткоеПечать','ДокументРасширение.СостояниеКраткоеЗначение','РП.КомментарийПоследнейФазы'],i=e.getEnumerator(),l=i.getNext(),r;for(r=0;r<t.length;r++)if(-1===e.getFormat().getFieldIndex(t[r]))e.addField(new a({name:t[r]}));while(l){for(r=0;r<t.length;r++)if(void 0===l.get(t[r]))l.set(t[r],'');if(l.has('ДокументРасширение.Название')){var n=l.get('ДокументРасширение.Название');if(n)if(n.length>255)l.set('ДокументРасширение.Название',o.strip_html_tags(n.substr(0,255)+'...'));else l.set('ДокументРасширение.Название',o.strip_html_tags(n));}if(l.has('ЗначимыйКомментарий')){var f=l.get('ЗначимыйКомментарий');if(f)if(l.set('ЗначимыйКомментарий',o.strip_html_tags(f)),f.length>255)l.set('ЗначимыйКомментарий',f.substr(0,255)+'...');}if(l.has('РП.КомментарийПоследнейФазы')){var d=l.get('РП.КомментарийПоследнейФазы')||l.get('prevPhase')&&l.get('prevPhase').comment.text;if(l.set('РП.КомментарийПоследнейФазы',o.strip_html_tags(d)),!!d&&d.length>255)l.set('РП.КомментарийПоследнейФазы',d.substr(0,255)+'...');}var s=l.get('ДокументРасширение.СостояниеКраткое'),u=s&&s.get();s&&s.each(function(e,t){if(t==u){if('ВОбработке'==e)e='В обработке';return l.set('ДокументРасширение.СостояниеКраткоеЗначение',t),void l.set('ДокументРасширение.СостояниеКраткоеПечать',e);}});var c=e.getIndexByValue('@Документ',l.get('@Документ'));if(-1!=c)e.replace(l,c);l=i.getNext();}},documentsPrepareExportColumns:function(e,t,i){var l=null;if('PDF'==this._getCurrentItem().get('id'))l=[{field:'ДатаПечать',title:'Дата'},{field:'Номер',title:'Номер'},{field:'КонтрагентИННКПППечать',title:'Контрагент'},{field:'ОрганизацияИННКПППечать',title:'Организация'},{field:'ЛицоНазваниеПечать',title:'Описание'},{field:'ВДНазваниеПечать',title:'Тип документа'},{field:'НомерВД',title:'Номер'},{field:'ДатаИзНазванияВД',title:'Дата'},{field:'ДокСумма',title:'Сумма'},{field:'ДокСуммаНДС',title:'НДС'},{field:'СтатусПечать',title:'Состояние'},{field:'Сотрудник.Название',title:'Ответственный'},{field:'РП.НазваниеПодразделения',title:'Подразделение'}];else l=[{field:'ДатаПечать',title:'Дата'},{field:'Номер',title:'Номер'},{field:'ДокСумма',title:'Сумма'},{field:'СтатусПечать',title:'Статус'},{field:'ПустаяСтрока',title:'Примечание'},{field:'СборныйКомментарий',title:'Комментарий'},{field:'ЛицоНазваниеПечать',title:'Контрагент'},{field:'КонтрагентИННКПППечать',title:'ИНН/КПП'},{field:'ДокументНашаОрганизация.Контрагент.Название',title:'Организация'},{field:'ОрганизацияИННКПППечать',title:'ИНН/КПП'},{field:'ВДНазваниеПечать',title:'Тип документа'},{field:'ВДИмяФайлаПечать',title:'Имя файла'},{field:'ДатаИзНазванияВД',title:'Дата'},{field:'НомерВД',title:'Номер'},{field:'ДокСумма',title:'Сумма'},{field:'ДокСуммаНДС',title:'Сумма НДС'},{field:'Сотрудник.Название',title:'Ответственный'},{field:'РП.НазваниеПодразделения',title:'Подразделение'},{field:'КодПодразделения',title:'Код'},{field:'ДатаПечать',title:'Дата'},{field:'ВремяПечать',title:'Время'},{field:'ТипДокумента.ТипДокумента',title:'Тип пакета'},{field:'ИдентификаторПакета',title:'Идентификатор пакета'},{field:'ДатаОтправки',title:'Запущено в обработку'},{field:'ДатаПолучения',title:'Получено контрагентом'},{field:'ДатаУтверждения',title:'Завершено'},{field:'ДокСуммаУвеличение',title:'Увеличение суммы'},{field:'ДокСуммаУвеличениеНДС',title:'НДС'},{field:'ДокСуммаУменьшение',title:'Уменьшение суммы'},{field:'ДокСуммаУменьшениеНДС',title:'НДС'}];e.setResult(l);},documentsPreparePrintColumns:function(e,t,i){var l=[{field:'Дата',title:'Дата'},{field:'Номер',title:'Номер'},{field:'ДокументРасширение.СостояниеКраткоеПечать',title:'ДокументРасширение.СостояниеКраткоеПечать'},{field:'ДокументРасширение.СостояниеКраткоеЗначение',title:'ДокументРасширение.СостояниеКраткоеЗначение'},{field:'Лицо1.Название',title:'Лицо1.Название'},{field:'Контрагент.ИНН',title:'ИНН'},{field:'Контрагент.КПП',title:'КПП'},{field:'РП.НОИНН',title:'ИНН'},{field:'НашаОрганизация.КПП',title:'КПП'},{field:'Сотрудник.Название',title:'Ответственный'},{field:'РП.НазваниеПодразделения',title:'Подразделение'},{field:'КодПодразделения',title:'Код'},{field:'РП.ВнешниеДокументы',title:'РП.ВнешниеДокументы'},{field:'ЗначимыйКомментарий',title:'ЗначимыйКомментарий'},{field:'РП.РазделТипаДокумента',title:'РП.РазделТипаДокумента'},{field:'РП.КомментарийПоследнейФазы',title:'РП.КомментарийПоследнейФазы'}];e.setResult(l);},printDocsReportOperation:function(i,r){var a=[];if(l.setMessage('Подготовка к печати отчета'),l.show(),!!i){var n=!!i?i.getEnumerator():null,f=!!n?n.getNext():null;while(f)a.push(parseInt(f.get('@Документ'),10)),f=n.getNext();}new t('ОтчетОПодписании').call('ПолучитьФайлОтчетаDWC',{'Фильтр':JSON.stringify(r),'Документы':a},t.RETURN_TYPE_ASIS).addErrback(function(t){l.hide(),e.alert(t.message,t.details,'error');}),l.hide();},printSelectedDocsOperation:function(e,t,i,l,r){require(['js!SBIS3.EDO2.PrintableMixin','WS.Data/Collection/RecordSet'],function(a,f){var d=new f({adapter:'adapter.sbis',rawData:{_type:'recordset',d:n(e).map(function(e){return[parseInt(e.get('@Документ'),10),parseInt(e.get('Раздел'),10)];}).value(),s:[{n:'ИдО',t:'Число целое'},{n:'Раздел',t:'Число целое'}]}});a.print.call(this,d,{isPdfServiceFormat:true,object:l?l:'ПечатьДокументов',method:r?r:'СписокДляМассовойПечати',fileName:i||'Документы',autoprint:t||false,massPrint:true});}.bind(this));},strip_html_tags:function(e){var t=document.createElement('DIV');return t.innerHTML=e,t.textContent||t.innerText||'';}};return o;});
define('js!SBIS3.EDO.OperationUnload',['Deprecated/helpers/fast-control-helpers','Core/helpers/fast-control-helpers','SBIS3.CONTROLS/OperationsPanel/Unload','SBIS3.CONTROLS/Utils/DataProcessor','js!SBIS3.EDO.EdoOperationsCommon','WS.Data/Chain','WS.Data/Collection/Factory/RecordSet','WS.Data/Adapter/Sbis','Elektronnyj_dokumentooborot_localization'],function(e,t,i,s,r,o,n,a){'use strict';var l=i.extend({$constructor:function(){},_applyMassOperation:function(e){if(0===e.getCount())return void t.alert(rk('Отсутствуют документы для сохранения'),{},opener);l.superclass._applyMassOperation.call(this,e);},_menuItemActivated:function(e,t){if('saveExtDocs2PDF'==t)if(null===(s=this._getView().getSelectedItems())||!(s.getCount()>0))this._currentItem=t,this._prepareOperation(rk('Что сохранить в PDF'));else r.printSelectedDocsOperation(s,false,this._options.fileName,this._options.customObjectName,this._options.customMethodName);else if('id_setting'==t.substr(0,10)||'itemIntSys'==t.substr(0,10)){var i=e.getTarget().getItems().getRecordById(t);if(i.has('handlers'))(0,i.get('handlers').onActivated)(t,this);}else if('billSignReport'==t){var s=this._getView().getSelectedItems(),o;if(!s||!(s.getCount()>0))this._currentItem=t,this._prepareOperation(rk('Что распечатать'));else o=this.getViewFilter(),r.printDocsReportOperation(s,o);}else l.superclass._menuItemActivated.call(this,e,t);},getViewFilter:function(){var e=this._options.linkedView.getDataSource(),t=this._options.linkedView.getFilter(),i=e._buildRecord(t);return i=e.getAdapter().serialize(i),i;},applyOperation:function(e){var t=this._options.linkedView,i=this._options&&!!this._options.exportDocuments?e.dataSet:o(e.dataSet).filter(function(e){return!e.get((t.getParentProperty&&t.getParentProperty())+'@');}).value(n,{adapter:new a()});if('saveExtDocs2PDF'===this._currentItem)return void r.printSelectedDocsOperation(e.dataSet,false,this._options.fileName,this._options.customObjectName,this._options.customMethodName);else if('billSignReport'===this._currentItem){var p=this.getViewFilter();return void r.printDocsReportOperation(e.dataSet,p);}if(!!this._options.exportDocuments)return void l.superclass.applyOperation.call(this,e);else{if(!i.getCount())return;var c=[];if(i.at(0).has('РазличныеДокументы.Информация'))c.push('РазличныеДокументы.Информация');if(i.at(0).has('ДокументРасширение.Название'))c.push('ДокументРасширение.Название');if(c.length)i.each(function(e){for(var t={},i=0;i<c.length;i++)t[c[i]]=l.prototype.RemoveTags(e.get(c[i]));e.set(t);});}e.dataSet=i;var u=new s(e),h=this._getPDFPageOrient();u.exportDataSet(this._getUnloadFileName(),this._currentItem,void 0,h);},processSelectedPageSize:function(t){if('billSignReport'===this._currentItem&&0==t){var i=this.getViewFilter();r.printDocsReportOperation(null,i);}else if(!this._options.exportDocuments||'saveExtDocs2PDF'===this._currentItem)return r.processSelectedPageSizeCommon(t,this);else if('Договоры'==this._options.registryName)return r.processSelectedPageSizeCommon(t,this);else{var s=this;if(!this._isClientUnload()&&t&&t>this._options.linkedView.getItems().getCount())e.question(rk('Операция займет продолжительное время. Провести операцию?'),{},s).addCallback(function(e){if(e)return l.superclass.processSelectedPageSize.call(s,t);});else return l.superclass.processSelectedPageSize.call(this,t);}},RemoveTags:function(e){var t=document.createElement('DIV');return t.innerHTML=e,t.textContent||t.innerText||'';}});return l;});
define('js!SBIS3.EDO.BaseFiltersStyles',['css!SBIS3.EDO.BaseFiltersStyles','tmpl!SBIS3.EDO.BaseFiltersStyles/footerTpl','Bazovyj_komponent_dokument_localization'],function(){return;});
define("html!SBIS3.EDO.DropdownFilter",function(){var o=function(o){var e=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(e){for(;o.test(e);)e=e.replace(o,"&#123;&#123;$1&#125;&#125;");return e}}(),t=function(o){return o.join?o.join(""):o.toString()},n=function(o){return void 0===o?"":o&&"object"==typeof o?t(o):""+o},r="undefined"!=typeof process,i=("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),p=function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,a='<div class="edo-DropdownFilter__mainContainer"> <component data-component="SBIS3.CONTROLS/DropdownList" name="filterDropdown" class="edo-DropdownFilter__DropdownList controls-DropdownList__withoutArrow controls-DropdownList__linkStyle controls-DropdownList__withoutCross '+e(n(o.innerClassName))+'"> <option name="items" type="ref"> '+e(n(function(o,e){var t=i.randomId();return o[t]=e,t}(p,o.items)))+" </option> ";return o.itemTemplate&&(a+=' <opt name="itemTemplate" type="function" value="'+e(n(o.itemTemplate))+'"/> '),a+=" ",o.itemTpl&&(a+=' <opt name="itemTpl">'+e(n(o.itemTpl))+"</opt> "),a+=" ",o.showSelectedInList&&(a+=' <opt name="showSelectedInList">'+e(n(o.showSelectedInList))+"</opt> "),a+=' <opt name="idProperty" value="key"></opt> <opt name="displayProperty" value="title"></opt> <opt name="multiselect">false</opt> <option name="mode">click</option> <opt name="pickerClassName">controls-DropdownList__picker edo-DropdownFilter__picker</opt> <opts name="pickerConfig"> <opt name="closeByExternalOver">true</opt> </opts> </component> <component data-component="SBIS3.CONTROLS/Button/IconButton" name="btnSetDefault" class=\'edo-DropdownFilter__btnSetDefault\'> <option name="icon">sprite:icon-16 icon-Close icon-disabled</option> </component> </div>',(a=e(a))+(r&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.DropdownFilter"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.DropdownFilter", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-DropdownFilter__mainContainer{height:24px;line-height:24px}.edo-DropdownFilter__DropdownList{display:block;float:left;padding-top:0}.edo-DropdownFilter__btnSetDefault{height:18px}.edo-DropdownFilter__btnSetDefault:hover{color:#ccc!important}.edo-DropdownFilter__btnSetDefault{display:none}.edo-DropdownFilter__mainContainer:hover .edo-DropdownFilter__btnSetDefault{display:inline-block}.edo-DropdownFilter__DropdownList .controls-DropdownList__textWrapper:hover{text-decoration:underline;color:#05b!important}"));head.appendChild(style);});}
define('js!SBIS3.EDO.DropdownFilter',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.DropdownFilter','css!SBIS3.EDO.DropdownFilter','SBIS3.CONTROLS/DropdownList','SBIS3.CONTROLS/Button/IconButton','Bazovyj_komponent_dokument_localization'],function(t,e){var n=t.extend({_dotTplFn:e,$protected:{_options:{items:[],value:void 0,stringValue:void 0,defaultValue:null,innerClassName:''}},$constructor:function(){},init:function(){n.superclass.init.call(this);var t=this;if(t._btnSetDefault=t.getChildControlByName('btnSetDefault'),t._filterDropdown=t.getChildControlByName('filterDropdown'),t._btnSetDefault.subscribe('onActivated',function(){t.setDefault();}),t._filterDropdown.once('onPickerOpen',function(){t._filterDropdown.getPicker().subscribe('onClick',function(){var e=t._filterDropdown.getSelectedKeys();if(e.length>0)t.setValue(e[0]);});}),t.setVisibility(),void 0!==t._options.value&&t._options.value!==t._options.defaultValue)t._filterDropdown.setSelectedKeys([t._options.value]),t.setStringValue(t._filterDropdown.getText());},setValue:function(t){var e=this;if(t!=e._options.value){if(e._options.value=t,e._options.value||e._options.value!=e._options.defaultValue)e._filterDropdown.setSelectedKeys([t]),e.setStringValue(e._filterDropdown.getText());else e.setStringValue('');e.setVisibility(),e._notifyOnPropertyChanged('value');}},getValue:function(){return this._options.value;},getStringValue:function(){return this._options.stringValue;},setStringValue:function(t){this._options.stringValue=t,this._notifyOnPropertyChanged('stringValue');},setDefault:function(){var t=this;t.setValue(t._options.defaultValue);},setVisibility:function(){var t=this;if(void 0===t._options.value||t._options.value==t._options.defaultValue)t.getContainer().addClass('ws-hidden');else t.getContainer().removeClass('ws-hidden');}});return n;});
define("html!SBIS3.EDO.DropdownSelector",function(){var e=function(e){var o=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(o){for(;e.test(o);)o=o.replace(e,"&#123;&#123;$1&#125;&#125;");return o}}(),t=function(e){return e.join?e.join(""):e.toString()},n=function(e){return void 0===e?"":e&&"object"==typeof e?t(e):""+e},r="undefined"!=typeof process,i=("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),p='<div class="edo-DropdownSelector__mainContainer  ws-hidden"> <component data-component="SBIS3.CONTROLS/DropdownList" name="FilterSelector" class="edo-DropdownSelector__DropdownList controls-DropdownList__withoutArrow controls-DropdownList__linkStyle controls-DropdownList__withoutCross "> <option name="items" type="ref"> '+o(n(function(e,o){var t=i.randomId();return e[t]=o,t}(function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,e.items)))+" </option> ";return e.itemTemplate&&(p+=' <opt name="itemTemplate" type="function" value="'+o(n(e.itemTemplate))+'"/> '),p+=" ",e.itemTpl&&(p+=' <opt name="itemTpl">'+o(n(e.itemTpl))+"</opt> "),p+=" ",e.showSelectedInList&&(p+=' <opt name="showSelectedInList">'+o(n(e.showSelectedInList))+"</opt> "),p+=' <opt name="idProperty" value="key"></opt> <opt name="displayProperty" value="title"></opt> <opt name="multiselect">false</opt> <option name="mode">click</option> <opt name="pickerClassName">controls-DropdownList__picker edo-DropdownSelector__picker</opt> <opts name="pickerConfig"> <opt name="closeByExternalOver">true</opt> </opts> </component> </div>',(p=o(p))+(r&&-1!==p.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.DropdownSelector"}},e});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.DropdownSelector", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-DropdownSelector__mainContainer{line-height:24px;height:24px}.edo-DropdownSelector__mainContainer .controls-DropdownList__textWrapper{color:#313e78!important}.edo-DropdownSelector__DropdownList .controls-DropdownList__textWrapper:hover{text-decoration:underline;color:#313e78!important}"));head.appendChild(style);});}
define('js!SBIS3.EDO.DropdownSelector',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.DropdownSelector','css!SBIS3.EDO.DropdownSelector','SBIS3.CONTROLS/DropdownList','Bazovyj_komponent_dokument_localization'],function(e,t){var o=e.extend({_dotTplFn:t,$protected:{_options:{tabindex:0,items:[],value:void 0,defaultValue:null},_btn:void 0},$constructor:function(){},init:function(){o.superclass.init.call(this);var e=this;e._btn=e.getChildControlByName('FilterSelector'),e._filterDropdown=e.getChildControlByName('FilterSelector'),e._filterDropdown.once('onPickerOpen',function(){e._filterDropdown.getPicker().subscribe('onClick',function(){var t=e._filterDropdown.getSelectedKeys();if(t.length>0)e.setValue(t[0]);});}),e.setVisibility();},setValue:function(e){var t=this;if(e!=t._options.value){if(t._options.value=e,!t._options.value||t._options.value!=t._options.defaultValue)if(t._options.items)t._btn.setSelectedKeys([t._options.items[0].key]);t.setVisibility(),t._notifyOnPropertyChanged('value');}},getValue:function(){return this._options.value;},setVisibility:function(){var e=this;if(void 0===e._options.value||e._options.value==e._options.defaultValue)e.getContainer().removeClass('ws-hidden');else e.getContainer().addClass('ws-hidden');}});return o;});
define("html!SBIS3.EDO.FilterLimitationCtx",function(){var t=function(t){var e=function(){var t=/\{\{([\s\S]+?)\}\}/g;return function(e){for(;t.test(e);)e=e.replace(t,"&#123;&#123;$1&#125;&#125;");return e}}(),n=function(t){return t.join?t.join(""):t.toString()},o=function(t){return void 0===t?"":t&&"object"==typeof t?n(t):""+t},i="undefined"!=typeof process,r=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div style="height:32px;"> <div style="float:left;height:24px;line-height:24px;margin-right:8px;text-align:right;"> '+e(o(rk("Срок выполнения")))+' </div> <component data-component="SBIS3.CONTROLS/Date/Picker" name="ФильтрСрокДата" style="float:left;height:24px;"> <option name="mask">DD.MM.YY</option> <option name="isCalendarIconShown">true</option> <option name="allowChangeEnable">true</option> </component> </div>');return(r=e(r))+(i&&-1!==r.indexOf("{{")?String.fromCharCode(8203,8203):"")};return t.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.FilterLimitationCtx"}},t});
define('js!SBIS3.EDO.FilterLimitationCtx',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.FilterLimitationCtx','SBIS3.CONTROLS/Utils/DateUtil','SBIS3.CONTROLS/Date/Picker','Deprecated/Controls/FieldDate/FieldDate','i18n!SBIS3.EDO.FilterLimitationCtx','Bazovyj_komponent_dokument_localization'],function(t,e,i){var a=t.extend({_dotTplFn:e,$protected:{_options:{name:'ФильтрСрок',value:void 0,stringValue:''},_datePicker:void 0},$constructor:function(){},getValue:function(){return this._options.value;},_applyValue:function(t){var e=this;if(e._datePicker){var a=i.valueToDate(t);if(a)e._datePicker.setDate(a);else e._datePicker.setText('');}e._options.stringValue=e.getStringValue();},setValue:function(t){var e=this;if(t!==e._options.value)e._options.value=t,e._notifyOnPropertyChanged('value'),e._applyValue(t);},getDefaultValue1:function(){},getStringValue:function(){var t=this._datePicker.getDate(),e='';if(t)e=t.strftime('%e %q %Y');return e;},setActive:function(t){this._datePicker.setActive(t);},init:function(){a.superclass.init.call(this);var t=this;if(this._datePicker=this.getChildControlByName('ФильтрСрокДата'),this._datePicker)this._datePicker.subscribe('onDateChange',function(e){var i=this.getDate();t._options.value=i,t._options.stringValue=t.getStringValue(),t._notifyOnPropertyChanged('value'),t._notify('onValueChange',e,i);});t._applyValue(t._options.value);}});return a;});
define("html!SBIS3.EDO.FilterText",function(){var e=function(e){var n=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;e.test(n);)n=n.replace(e,"&#123;&#123;$1&#125;&#125;");return n}}(),t="undefined"!=typeof process,o=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,"<div class='edo-FilterText_mainContainer ws-hidden'> <div class='edo-FilterText_textContainer'> </div> <component data-component=\"SBIS3.CONTROLS/Link\" name=\"btnSetDefault\" class='edo-FilterText_btnSetDefault'> <option name=\"icon\">sprite:icon-16 icon-Close icon-disabled</option> </component> </div>");return(o=n(o))+(t&&-1!==o.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.FilterText"}},e});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.FilterText", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-FilterText_textContainer{display:inline-block;line-height:24px}.edo-FilterText_btnSetDefault{display:inline-block;margin-top:-7px;margin-left:-5px}.edo-FilterText_mainContainer{height:24px;margin-bottom:4px}"));head.appendChild(style);});}
define('js!SBIS3.EDO.FilterText',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.FilterText','css!SBIS3.EDO.FilterText','SBIS3.CONTROLS/Link','Bazovyj_komponent_dokument_localization'],function(t,e){var n=t.extend({_dotTplFn:e,$protected:{_options:{textValues:{},tooltips:{},value:void 0,stringValue:'',fName:'',resetValue:null},_btnSetDefault:void 0,_textContainer:void 0},$constructor:function(){this._publish('onValueChange');},init:function(){n.superclass.init.call(this);var t=this;t._btnSetDefault=t.getChildControlByName('btnSetDefault'),t._textContainer=t.getContainer()[0].querySelector('.edo-FilterText_textContainer'),t._btnSetDefault.subscribe('onActivated',function(){t.setResetValue();}),t.setValue(t._options.value);},setValue:function(t){var e=this;if(e._options.value!==t&&e._options.resetValue!==t){if(e._options.value=t,e._options.textValues.hasOwnProperty(t))e.setStringValue(e._options.textValues[t]),e._showText(e._options.stringValue);if(e._notifyOnPropertyChanged('value'),e._notify('onValueChange',t),e._options.tooltips.hasOwnProperty(t))e._setTooltip(e._options.tooltips[t]);e.getContainer().removeClass('ws-hidden');}else e._options.value=e._options.resetValue,e.setStringValue(''),e._notifyOnPropertyChanged('value'),e._showText(''),e.getContainer().addClass('ws-hidden');},getValue:function(){return this._options.value;},getStringValue:function(){return this._options.stringValue;},setStringValue:function(t){this._options.stringValue=t,this._notifyOnPropertyChanged('stringValue');},setResetValue:function(){var t=this;t.setValue(t._options.resetValue);},_showText:function(t){this._textContainer.innerText=t;},_setTooltip:function(t){this._textContainer.setAttribute('title',t);}});return n;});
define("html!SBIS3.EDO.HideContainer",function(){var e=function(e){var n=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;e.test(n);)n=n.replace(e,"&#123;&#123;$1&#125;&#125;");return n}}(),r=function(e){return e.join?e.join(""):e.toString()},t=function(e){return void 0===e?"":e&&"object"==typeof e?r(e):""+e},o="undefined"!=typeof process,i=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,"<div>"+n(t(e.content))+"</div>");return(i=n(i))+(o&&-1!==i.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.HideContainer"}},e});
define('js!SBIS3.EDO.HideContainer',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.HideContainer','Bazovyj_komponent_dokument_localization'],function(i,e){var n=i.extend({_dotTplFn:e,$protected:{_options:{visibility:false,value:null,bindingChildName:'',childEmptyItem:void 0},_bindedChild:void 0,_nullFromChild:false},$constructor:function(){},init:function(){n.superclass.init.call(this);var i=this;if(i.hasChildControlByName(i._options.bindingChildName))i._bindedChild=i.getChildControlByName(i._options.bindingChildName);if(i._bindedChild)i._bindedChild.subscribe('onValueChange',function(e,n){if(!i.isVisible()&&n&&n!=i._options.childEmptyItem)i._options.value=true,i.show(),i._notifyOnPropertyChanged('value');}),i._bindedChild.subscribe('onSelectedItemChange',function(e,n){if('ИдРегламента'==i._options.bindingChildName)n=n[1];if(!i.isVisible()&&n&&n!=i._options.childEmptyItem)i._options.value=true,i.show(),i._notifyOnPropertyChanged('value');}),i._bindedChild.subscribe('onSelectedItemsChange',function(e,n){if(!i.isVisible())if(!Array.isArray(n)&&n||Array.isArray(n)&&n.length>0&&null!=n[0]&&n[0]!=i._options.childEmptyItem)i._options.value=true,i.show(),i._notifyOnPropertyChanged('value');});},setValue:function(i){var e=this;if(e._options.value!=i){e._options.value=i,e._notifyOnPropertyChanged('value');var n=null;if(e._bindedChild&&e._bindedChild._options.hasOwnProperty('defaultValue'))n=e._bindedChild._options.defaultValue;if(!i||i===n)e.hide();else if(e.show(),e._bindedChild.setActive)e._bindedChild.setActive(true);}},getValue:function(){return this._options.value;}});return n;});
define("tmpl!SBIS3.EDO.DocumentParamsForDK",["Core/tmpl/js/tclosure","js!SBIS3.Engine.ToggleHeader","js!SBIS3.CONTROLS/DataGridView","js!SBIS3.CONTROLS/TextBox"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.Engine.ToggleHeader"]=e[1],r["js!SBIS3.CONTROLS/DataGridView"]=e[2],r["js!SBIS3.CONTROLS/TextBox"]=e[3];var a=function e(a,o,i,n,s){function l(){}var c=0,d=void 0!==t&&t?t:arguments[arguments.length-1];void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure"));var m={};s&&s.isSetts&&(m=s.fullContext||{});var u="string"==typeof i?i:"",p=void 0===r?void 0:r,v={id:[],def:void 0},g=d.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,a),h=this&&this.includedTemplates?this.includedTemplates:{},f=d.getMarkupGenerator(n);try{var w=f.joinElements([void(h.valueTemplate=function(e,t){this&&this.includedTemplates&&this.includedTemplates;var r=d.getMarkupGenerator(n);try{var a=r.joinElements([r.createTag("div",{class:"ws-ellipsis"},[d.getter(e,["row","СтароеЗначение"])&&d.getter(e,["row","СтароеЗначение"])!=d.getter(e,["row","Значение"])?[r.createTag("div",{class:"icon-16 icon-ListboxrRflection icon-hover action-hover document-params-for-dk__icon-change"},[],{},v,this)]:r.createText(""),r.createTag("div",{},[r.createText(""+d.wrapUndef(d.Sanitize.apply(void 0,[+d.getter(e,["row","Значение"])==d.getter(e,["row","Значение"])?d.getDecorators().money.apply(void 0,[d.getter(e,["row","Значение"])]):d.getter(e,["row","Значение"])])))],{},v,this)],t,v,this)],u,v);v.def&&(a=r.chain(a,v,t),v=void 0)}catch(t){d.templateError("resources/Raschet_sdelki/Controls/DocumentParams/DocumentParamsForDK.tmpl",t,e)}return a||""}.bind({includedTemplates:h})),f.createTag("div",{class:"doc-param-indent-on-index ws-sticky-header__parent"},[f.createTag("div",{class:"ws-sticky-header__block title_accounting_dk"},[f.createControl("wsControl","ws:SBIS3.Engine.ToggleHeader",{name:"ToggleHeader",caption:d.getter(a,["title"]),checked:!0,allowChangeEnable:!1},{name:"ToggleHeader",sbisname:"ToggleHeader"},{data:a,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:g},i,p,h,d.config,m)],{},v,this),f.createControl("wsControl","ws:SBIS3.CONTROLS/DataGridView",{columns:[{field:"Название",class:"ws-ellipsis",width:"229"},{cellTemplate:d.createDataArray([(new function(){var e=Object.create(a),t=function e(t,r,a,o,i){if(void 0===a)var a=arguments[2];var n=0,s="cellTemplate";if(void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure")),i&&i.isSetts)var l=i.fullContext||{};t=d.isolateScope(Object.create(this),t,s);var c="string"==typeof a?a:"",m={id:[],def:void 0},u=this&&this.includedTemplates?this.includedTemplates:{},p=d.getMarkupGenerator(o);try{var v=p.joinElements([function(e,t){d.prepareAttrsForFocus(t,e,"0");this&&this.includedTemplates&&this.includedTemplates;var r=d.getMarkupGenerator(o);try{var a=r.joinElements([r.createTag("div",{class:"ws-ellipsis"},[d.getter(e,["row","СтароеЗначение"])&&d.getter(e,["row","СтароеЗначение"])!=d.getter(e,["row","Значение"])?[r.createTag("div",{class:"icon-16 icon-ListboxrRflection icon-hover action-hover document-params-for-dk__icon-change"},[],{},m,this)]:r.createText(""),r.createTag("div",{},[r.createText(""+d.wrapUndef(d.Sanitize.apply(void 0,[+d.getter(e,["row","Значение"])==d.getter(e,["row","Значение"])?d.getDecorators().money.apply(void 0,[d.getter(e,["row","Значение"])]):d.getter(e,["row","Значение"])])))],{},m,this)],t,m,this)],c,m);m.def&&(a=r.chain(a,m,t),m=void 0)}catch(t){d.templateError("resources/Raschet_sdelki/Controls/DocumentParams/DocumentParamsForDK.tmpl",t,e)}return a||""}(d.calculateScope({row:d.getter(t,["cellTemplate","item"])},d.plainMerge),d.plainMerge(r,{}))],c,m);m.def&&(v=p.chain(v,m,r),m=void 0)}catch(e){d.templateError("resources/Raschet_sdelki/Controls/DocumentParams/DocumentParamsForDK.tmpl",e,t)}return v||""};this.func=d.makeFunctionSerializable(t,e)}).func]),editor:(new function(){var e=Object.create(a),t=function e(t,r,a,o,i){if(void 0===a)var a=arguments[2];var n=0,s="editor";void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure"));var l=this&&this.includedTemplates?this.includedTemplates:{},c=d.getMarkupGenerator(o);try{var h=c.joinElements([c.createControl("wsControl","ws:SBIS3.CONTROLS/TextBox",{validators:[{validator:d.getter(t,["validatorFunction"]),errorMessage:"Введите значение параметра",option:"text"}],name:"ParamValueEditor",bindings:[{fieldName:"Значение",propName:"text",propPath:[],fullPropName:"text",propPathStr:"",oneWay:!1,direction:"fromContext",bindNonExistent:!1}],text:void 0,trim:!0,selectOnClick:!0,esc:!1},d.plainMerge(r,{class:"document-params-for-dk__value_editor",name:"ParamValueEditor",sbisname:"ParamValueEditor"}),{data:t,ctx:this,pName:void 0!==s?s:void 0,viewController:g},a,p,l,d.config,m)],u,v);v.def&&(h=c.chain(h,v,r),v=void 0)}catch(e){d.templateError("resources/Raschet_sdelki/Controls/DocumentParams/DocumentParamsForDK.tmpl",e,t)}return h||""};this.func=d.makeFunctionSerializable(t,e)}).func(Object.create(a),null,i),field:"Значение"}],name:"ПараметрыДокумента",showHead:!1,itemsActions:d.getter(a,["itemsActions"]),idProperty:"Название",bindings:[{fieldName:"paramDocumentFilter",propName:"filter",propPath:[],fullPropName:"filter",propPathStr:"",oneWay:!0,direction:"fromContext",bindNonExistent:!1}],filter:void 0,itemsDragNDrop:!1,editMode:"click|toolbar",esc:!1},{class:"document-params-for-dk__data-grid controls-DataGridView__overflow-ellipsis",name:"ПараметрыДокумента",sbisname:"ПараметрыДокумента","data-access":"Параметры документа"},{data:a,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:g},i,p,h,d.config,m)],o,v,this)],u,v);v.def&&(w=f.chain(w,v,o),v=void 0)}catch(e){d.templateError("resources/Raschet_sdelki/Controls/DocumentParams/DocumentParamsForDK.tmpl",e,a)}return w||""};return a.includedFunctions={},a.stable=!0,a.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.DocumentParamsForDK"}},a});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.DocumentParamsForDK", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".document-params-for-dk__data-grid{margin-bottom:24px}.document-params-for-dk__icon-change{position:absolute;left:2px;top:1px}.document-params-for-dk__reset-change{cursor:pointer}.controls-editInPlace__editing .document-params-for-dk__icon-change{display:none}.document-params-for-dk__value_editor{width:248px}.document-params-for-dk__data-grid.controls-DataGridView .controls-DataGridView__table .controls-DataGridView__td{line-height:16px;height:24px}.document-params-for-dk__data-grid.controls-DataGridView .controls-DataGridView__td.controls-DataGridView__firstContentCell{padding-left:24px}.document-params-for-dk__data-grid.controls-DataGridView .controls-DataGridView__td:last-child{padding-right:24px}"));head.appendChild(style);});}
define('js!SBIS3.EDO.DocumentParamsForDK',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.DocumentParamsForDK','WS.Data/Source/SbisService','SBIS3.CONTROLS/Utils/ControlsValidators','Core/EventBus','Lib/Control/Infobox/Infobox','Transport/RPCJSON','Core/helpers/string-helpers','js!SBIS3.Engine.ToggleHeader','SBIS3.CONTROLS/DataGridView','SBIS3.CONTROLS/TextBox','css!SBIS3.EDO.DocumentParamsForDK','Raschet_sdelki_localization'],function(e,t,n,o,i,a,r,s){'use strict';function c(e,t){i.channel('DocumentParams').notify('onChange',e,t);}var l=e.extend({_dotTplFn:t,$protected:{_brow:null,_header:null,_options:{name:'ПараметрыДокумента',title:'Показатели',document:void 0,itemsActions:[],autoHeight:true,visible:false,validatorFunction:o.required}},$constructor:function(){if(void 0!==this._options.document)this._setDocument(this._options.document);},init:function(){l.superclass.init.call(this);var e=this;if(this.hasChildControlByName('ПараметрыДокумента')){if(e._brow=e.getChildControlByName('ПараметрыДокумента'),e._brow.setDataSource(new n({endpoint:'DocumentParams',binding:{query:'СписокПараметров',update:'ЗаписатьПараметр'},idProperty:'Название'})),this.hasChildControlByName('ToggleHeader'))e._header=e.getChildControlByName('ToggleHeader'),e._header.subscribe('onCheckedChange',function(){e._brow.toggle();});e._brow.subscribe('onDataLoad',function(t,n){e.toggle(n.getCount()>0);}),e._brow.subscribe('onBeginEdit',function(e,t){if(!t.get('СтароеЗначение'))t.set('СтароеЗначение',t.get('Значение'));}),e._brow.subscribe('onAfterEndEdit',function(e,t,n,o){if(o)c(t.get('Документ'),t.get('Название'));}),e._brow.subscribe('onItemClick',function(t,n,o,i){if($(i).hasClass('action-hover document-params-for-dk__icon-change'))e._brow.sendCommand('cancelEdit',o),e.iconChangeHandler(o,$(i));}),e._brow.subscribe('onChangeHoveredItem',function(t,n){if(!n.container)return;setTimeout(function(){var t=n.container.find('.document-params-for-dk__icon-change'),o=n.record;if(t.length&&t.is(':hover')&&0===t.closest('.controls-editInPlace__editing').length&&t.closest('.controls-DataGridView__hoveredColumn__cell').length)e.iconChangeHandler(o,t);},300);});}},setDocument:function(e){this._options.document=e,this._setDocument(e);},_setDocument:function(e){this.getLinkedContext().setValueSelf('paramDocumentFilter',{'Документ':e});},getDocument:function(){return this._options.document;},iconChangeHandler:function(e,t){var n=this._brow.isEnabled(),o=e.get('СтароеЗначение'),i='</br>',l=function(t){var n=e.get('Документ'),i=e.get('Название');if(i===$(this).data('param-name'))new r().callMethod('DocumentParams.ОтменитьИзмененияПараметра',{'Документ':n,'Параметр':i}).addCallback(function(){e.set('Значение',o),e.set('СтароеЗначение',null),e.acceptChanges(),c(n,i);});return t.stopPropagation(),t.preventDefault(),false;};if(n)i=' <a class="icon-rewrite document-params-for-dk__reset-change" data-param-name="'+s.escapeHtml(e.get('Название'))+'">отменить</br></a>';var u={control:t,offset:40,message:'Параметр отредактирован вручную'+i+' <span class="ws-color-gray"> Старое значение ',width:290,hideDelay:5000};u.message+=s.escapeHtml(e.get('СтароеЗначение'))+'</span>',a.once('onShow',function(){$('a.icon-rewrite.document-params-for-dk__reset-change').click(l);}),a.show(u);},reload:function(){if(this._brow)this._brow.reload();}});return l;});
define('js!SBIS3.EDO.RegistryRoutes',['SBIS3.CONTROLS/CompoundControl','i18n!SBIS3.EDO.RegistryRoutes','Bazovyj_komponent_dokument_localization'],function(e){return e.extend({$protected:{_options:{record:null}}});});
define("html!SBIS3.EDO.TransferTasksButton",function(){var e=function(e){var o=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(o){for(;e.test(o);)o=o.replace(e,"&#123;&#123;$1&#125;&#125;");return o}}(),n=function(e){return e.join?e.join(""):e.toString()},t=function(e){return void 0===e?"":e&&"object"==typeof e?n(e):""+e},a="undefined"!=typeof process,i=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div style="overflow: visible; cursor: pointer; white-space: nowrap;" class="transfer-button"> <div class="asLink" style="color: #999999; display: none; float: left; padding-right: 4px; margin-top: 3px;" id="transfer_task_counter"></div> <component data-component="SBIS3.CONTROLS/SelectorButton" style="max-width: 200px; vertical-align: top;" data-minicard-template=\'js!SBIS3.PersonalOffice.MiniCard\' data-minicard-mode=\'hover\'> <options name="dictionaries" type="array"> <options> <option name="name">ЧастноеЛицо</option> <option name="template" value="js!SBIS3.Staff.Choice.List"/> <option name="readOnly" type="boolean" value="true"/> <option name="selectionType" value="leaf"/> </options> </options> <option name="useSelectorAction" type="boolean" value="true"></option> <option name="idProperty" value="ИДЛицо"/> <option name="displayProperty" value="ФамилияИО"/> <option name="chooserMode" value="floatArea"></option> <option name="icon" value="'+o(t(e.icon?e.icon:"sprite:icon-16 icon-Publish2 icon-primary action-hover"))+'"></option> <option name="multiselect" type="boolean" value="false"></option> <option name="name" value="transfer_employee_field"></option> <option name="tooltip" value="'+o(t(rk("Разрешить закрытие задач другому сотруднику")))+'"></option> <options name="handlers"> <option name="onChooserClick" type="function" value="js!SBIS3.EDO.TransferTasksButtonHandlers:onBeforeDictionaryOpen"></option> <option name="onReady" type="function" value="js!SBIS3.EDO.TransferTasksButtonHandlers:onFieldLinkReady"></option> <option name="onSelectedItemsChange" type="function" value="js!SBIS3.EDO.TransferTasksButtonHandlers:onSelectedItemsChange"></option> </options> </component> </div>');return(i=o(i))+(a&&-1!==i.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.TransferTasksButton"}},e});
define('js!SBIS3.EDO.TransferTasksButtonHandlers',['SBIS3.CONTROLS/Utils/InformationPopupManager','WS.Data/Source/SbisService','i18n!SBIS3.EDO.TransferTasksButtonHandlers','Elektronnyj_dokumentooborot_localization'],function(e,t){'use strict';var a;return a={onBeforeDictionaryOpen:function(t){var a=!!this.getUserData('data_ready')&&this.getSelectedKeys().length<1;if(a&&this._parent._hasBind&&!this._parent._options.faceBind)a=false,e.showMessageDialog({message:rk('Не указан сотрудник!'),status:'error'});t.setResult(a);},onBeforeLinkRemove:function(e,a){if(!e.getUserData('re_init'))new t({endpoint:'СвязьПапок'}).call('ОтменитьПереназначениеЗадач',{'ОтСотрудника':(e._parent._hasBind?e._parent._options.faceBind:null)||null,'Сотрудник':a});else e.setUserData('re_init',false);if(!e._parent._showCounter||!e._parent._hasBind||!e._parent._options.faceBind)e.getTopParent().getContainer().find('#transfer_task_counter').css('display','none');e.setTooltip(rk('Разрешить закрытие задач другому сотруднику'));},onLinkActivated:function(n,i){var r=function(e){if(e.isDestroyed())return;var t=e._parent._hasBind?rk('Задачи')+' ':rk('Мои задачи')+' ';e.setTooltip(t+rk('может закрывать')+' '+e.getCaption());};if(n.getUserData('transfer_initialization'))return n.setUserData('transfer_initialization',false),void r(n);if(n.getUserData('bind_initialization'))return n.setUserData('bind_initialization',false),void r(n);new t({endpoint:'СвязьПапок'}).call('ПереназначитьЗадачи',{'ОтСотрудника':(n._parent._hasBind?n._parent._options.faceBind:null)||null,'Сотрудник':i}).addCallback(function(t){if(!t.getScalar())r(n);else e.showMessageDialog({message:t.getScalar(),status:'error'}),a.initControl(n);}).addErrback(function(t){n.clearSelectedItems(),e.showMessageDialog({message:t.message,status:'error'});});},initControl:function(e){var a=e;new t({endpoint:'СвязьПапок'}).call('ЕстьСвязьПользователя',{'Лицо':(a._parent._hasBind?a._parent._options.faceBind:null)||null}).addCallback(function(e){if(e.getScalar()){if(a._parent._showCounter&&a._parent._hasBind)if(a._parent._options.faceBind)new t({endpoint:'СлужЗап'}).call('КоличествоЗадачПоСотруднику',{'ИДЛица':a._parent._options.faceBind,'Переназначенные':false,'ПроверкаПрав':false}).addCallback(function(e){var t=a.getTopParent().getContainer().find('#transfer_task_counter')[0],n='',i='';if(e.getScalar())n=e.getScalar()>1000?'999+':String(e.getScalar()),i=e.getScalar()>1000?' '+rk('задач'):' '+rk('задача(-чи,-ч)',e.getScalar()),t.textContent=rk('На сотруднике')+' '+n+i;else t.textContent=rk('На сотруднике нет задач');t.style.display='inline';});else a.setUserData('re_init',true),a.clearSelectedItems(),a.setUserData('re_init',false);if(a._parent._hasBind&&a._parent._options.faceBind||!a._parent._hasBind)new t({endpoint:'СвязьПапок'}).call('ПолучитьПереназначенноеЛицо',{'Лицо':(a._parent._hasBind?a._parent._options.faceBind:null)||null}).addCallback(function(e){if(a.setUserData('data_ready',true),a.getContainer().attr('data-minicard-oid',e.getScalar()),e.getScalar()<0)a.setEnabled(false);else if(null!==e.getScalar())a.setUserData('transfer_initialization',true),a.setSelectedKeys([e.getScalar()]);else if(null===e.getScalar())a.setUserData('re_init',true),a.clearSelectedItems(),a.setUserData('re_init',false),a.setUserData('bind_initialization',false);});}else a.setEnabled(false),a.setTooltip('Сотрудник не имеет доступа в систему, делегирование задач невозможно');});},onFieldLinkReady:function(){a.initControl(this),this._parent._options['transfer_control']=this;},onCounterClick:function(e){require(['Core/Context','Core/helpers/fast-control-helpers'],function(t,n){var i=new t();i.setValue('ЛицоСотрудника',e._options.faceBind),i.setValue('ОтображатьНепрочтенныеВРеестре',true),i.setValue('SaveFiltersTemplateName','Реестр-Мои-окно'),n.showFloatArea({name:'qUserTasks',isStack:true,side:'right',autoHide:false,minWidth:1000,className:'ws-float-area__block-layout edo-UserTasks__floatArea',template:'js!SBIS3.EDO.UserTasks',opener:e.getTopParent(),autoCloseOnHide:true,context:i,componentOptions:{display:{readOnly:true},transfer_faceField:'ЛицоСотрудника'},caption:rk('Задачи сотрудника'),handlers:{onClose:function(){a.initControl(e.getChildControlByName('transfer_employee_field'));}}});});},onSelectedItemsChange:function(e,t,n){if(n.removed.length>0)a.onBeforeLinkRemove(this,n.removed[0]);else if(t.length>0)a.onLinkActivated(this,t[0]);}};});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.TransferTasksButton", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-transfer-link .ws-FieldLink__link a{color:#000;text-decoration:none!important}.edo-UserTasks__floatArea{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-moz-flex-direction:column;-ms-flex-direction:column;flex-direction:column;height:100%}.edo-UserTasks__floatArea .ws-float-area>.ws-float-area-stack-panel-shadow>.ws-templatedArea{height:calc(100% - 40px)}"));head.appendChild(style);});}
define('js!SBIS3.EDO.TransferTasksButton',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.TransferTasksButton','WS.Data/Source/SbisService','js!SBIS3.EDO.TransferFaceModel','js!SBIS3.EDO.TransferTasksButtonHandlers','css!SBIS3.EDO.TransferTasksButton','SBIS3.CONTROLS/SelectorButton','i18n!SBIS3.EDO.TransferTasksButton','Elektronnyj_dokumentooborot_localization'],function(n,t,e,s,o){'use strict';var i=n.extend({_dotTplFn:t,$protected:{_options:{_allowChangeEnable:true,faceBind:null}},setFaceBind:function(n){this._options.faceBind=n,this._options.transfer_control.setUserData('bind_initialization',true),o.initControl(this._options.transfer_control);},$constructor:function(n){if(this._hasBind=n.bindings&&!!n.bindings.length,this._showCounter=n.showCounter||false,n.allowChangeEnable)this._options._allowChangeEnable=false===n.allowChangeEnable?false:true;},init:function(){i.superclass.init.call(this);var n=new e({endpoint:{contract:'Лицо'},binding:{query:'Список',read:'Прочитать',format:'Лицо.Список'},model:s});this.getChildControlByName('transfer_employee_field').setDataSource(n,true);var t=this;if(this._showCounter)this.getContainer().find('#transfer_task_counter').bind('click',function(){o.onCounterClick(t);});}});return i;});
define('js!SBIS3.EDO.RulesConfigurator',['Reglamenty_localization'],function(){return{createRulesAccordion:function(t){var e={},a,i,o,r,n,l;if(!t)return e;if(1===t.length){if(e.regulations={title:rk('Операции'),event:'regulations',initModule:'js!SBIS3.EDO.RegulationsConfigHandler',order:100,rights:['Регламенты'],data:{'ТипДокумента':t[0].docType,'ПодТипДокумента':t[0].docSubType?t[0].docSubType:null,'НазваниеТипаДокумента':t[0].Name,dataSource:t[0].dataSource,tabTitle:t[0].tabTitle,configuration:{template:'js!SBIS3.RightNavigationTemplate'}}},!t[0].hideNumberSettings);}else if(t.length>1){for(a={},l=0;l<t.length;l++)i=t[l],a[l+'_type']={title:i.Name,event:'regulations_'+l,order:101+l,rights:['Регламенты'],data:{'ТипДокумента':i.docType,'ПодТипДокумента':i.docSubType?i.docSubType:null,'НазваниеТипаДокумента':i.Name,dataSource:i.dataSource,tabTitle:i.tabTitle,configuration:{template:'js!SBIS3.RightNavigationTemplate'}}};e.regulations={title:rk('Операции'),order:100,rights:['Регламенты'],initModule:'js!SBIS3.EDO.RegulationsConfigHandler',items:a,data:{dataSource:t[0].dataSource,configuration:{template:'js!SBIS3.RightNavigationTemplate'}}};}for(o=[],l=0;l<t.length;l++)if(!t[l].hideNumberSettings)o.push(t[l]);if(1===o.length)e.settings={title:rk('Настройки'),event:'dt_number_settings',order:200,rights:['Регламенты'],data:{'ТипДокумента':o[0].docType,'ПодТипДокумента':o[0].docSubType?o[0].docSubType:null,'НазваниеТипаДокумента':o[0].Name,dataSource:o[0].dataSource,tabTitle:o[0].tabTitle,configuration:{template:'js!SBIS3.RightNavigationTemplate'}}};else if(o.length>1){for(r={},l=0;l<o.length;l++)i=o[l],r[l+'_type']={title:i.Name,event:'dt_number_settings_'+l,order:201+l,rights:['Регламенты'],data:{'ТипДокумента':i.docType,'ПодТипДокумента':i.docSubType?i.docSubType:null,'НазваниеТипаДокумента':i.Name,dataSource:i.dataSource,tabTitle:i.tabTitle,configuration:{template:'js!SBIS3.RightNavigationTemplate'}}};e.settings={title:'Шаблон номера',order:200,rights:['Регламенты'],items:r,data:{dataSource:o[0].dataSource,configuration:{template:'js!SBIS3.RightNavigationTemplate'}}};}if(1===t.length)n=t[0].tabTitle;return e.func_roles={title:rk('Роли'),event:'func_roles',rights:['Регламенты'],order:300,data:{dataSource:t[0].dataSource,tabTitle:n,configuration:{template:'js!SBIS3.RightNavigationTemplate'}}},e;}};});
define("html!SBIS3.EDO.FromMeTasksCounter",function(){var o=function(o){var n=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;o.test(n);)n=n.replace(o,"&#123;&#123;$1&#125;&#125;");return n}}(),e=function(o){return o.join?o.join(""):o.toString()},t=function(o){return void 0===o?"":o&&"object"==typeof o?e(o):""+o},i="undefined"!=typeof process,r=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="edo-FromMeTasksCounter"> <component data-component="SBIS3.CONTROLS/Link"> <option name="name" value="fromMeTasksLink"></option> <option name="icon" value="icon-24 icon-TFTask icon-primary"></option> <option name="tooltip" value="'+n(t(o.linkTooltip))+'"></option> <option name="caption" value="'+n(t(o.linkCaption))+'"></option> <options name="handlers"> <option name="onActivated" type="function" value="js!SBIS3.EDO.FromMeTasksCounter:prototype.onOpenTasksDialog"></option> </options> </component> </div> ');return(r=n(r))+(i&&-1!==r.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.FromMeTasksCounter"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.FromMeTasksCounter", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-FromMeTasksCounter .controls-Link .controls-Link__icon+.controls-Link__field{margin:0}"));head.appendChild(style);});}
define('js!SBIS3.EDO.FromMeTasksCounter',['WS.Data/Source/SbisService','Core/helpers/fast-control-helpers','Core/UserInfo','SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.FromMeTasksCounter','SBIS3.CONTROLS/Link','css!SBIS3.EDO.FromMeTasksCounter','SBIS3.CONTROLS/Button/IconButton','Elektronnyj_dokumentooborot_localization'],function(t,e,i,a,o){'use strict';var n=a.extend({_dotTplFn:o,$protected:{_options:{linkCaption:'',face:false,faceName:false,linkTooltip:rk('Количество задач от меня в обработке')}},$constructor:function(){},init:function(){n.superclass.init.call(this),this._setLinkCaptionWithParams({face:this.getFace(),caption:this.getLinkCaption()});},setFace:function(t){this._options.face=t,this._setLinkCaptionWithParams({face:t,caption:this.getLinkCaption()});},getFace:function(){return this._options.face;},setFaceName:function(t){this._options.faceName=t;},getFaceName:function(){return this._options.faceName;},setLinkCaption:function(t){this._options.linkCaption=t,this._setLinkCaptionWithParams({face:this.getFace(),caption:t});},getLinkCaption:function(){return this._options.linkCaption;},getLinkTooltip:function(){return this._options.linkTooltip;},_setLinkCaptionWithParams:function(e){var i=this.getChildControlByName('fromMeTasksLink'),a=this;if(e.caption)i.setCaption(e.caption),i.setTooltip(a.getLinkTooltip()+' '+e.caption);else if(e.face)new t({endpoint:'СлужЗап'}).call('КоличествоЗадачОтМеняПоСотруднику',{'Лицо':e.face}).addCallback(function(t){if(t.getRawData())i.setCaption(t.getRawData());else i.setCaption('0');i.setTooltip(a.getLinkTooltip()+' '+i.getCaption());});else i.setCaption('0');},onOpenTasksDialog:function(){if(i.get('ИдентификаторПользователя')!=i.get('ИдентификаторКлиента'))e.showFloatArea({maxWidth:1050,autoSize:true,name:'fromMeTasks',isStack:true,side:'right',autoHide:false,minWidth:890,template:'js!SBIS3.EDO.FTasksFromMeTapeTab',autoCloseOnHide:true,className:'ws-float-area__block-layout',componentOptions:{showReturnTask:false,filterFace:this.getParent().getFace(),filterFaceName:this.getParent().getFaceName(),isFloatMode:true,doNotUseHistoryId:true,showHead:true,headTemplateDate:true,headTemplateDateCreate:true},handlers:{onInit:function(){var t=this,e='FromMe',i='FromMeAction';t.waitChildControlByName(e).addCallback(function(e){t.waitChildControlByName(i).addCallback(function(t){e.subscribe('onEdit',function(e,i){t.execute(i);});});});}}});}});return n;});
define("html!SBIS3.EDO.AllowedToSign",function(){var o=function(o){var n=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;o.test(n);)n=n.replace(o,"&#123;&#123;$1&#125;&#125;");return n}}(),e=function(o){return o.join?o.join(""):o.toString()},t=function(o){return void 0===o?"":o&&"object"==typeof o?e(o):""+o},i="undefined"!=typeof process,p=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,"<div class='edo-AllowedToSign'> <div class='edo-AllowedToSign_caption'> <span>"+n(t(rk("Разрешено подписывать")))+"</span> <span class='edo-AllowedToSign_caption_allTypes ws-hidden'>"+n(t(rk("все документы и отчетность")))+"</span> <component data-component='SBIS3.CONTROLS/Link' name='linkView' class='edo-AllowedToSign_caption_linkView'> <option name='icon'>sprite:icon-24 icon-Expand icon-primary</option> <options name='handlers'> <option name='onActivated' type='function'>js!SBIS3.EDO.AllowedToSign:prototype.onActivatedLinkView</option> </options> <option name='enabled'>true</option> <option name='visible'>false</option> <option name='allowChangeEnable'>false</option> </component> </div> <div class='edo-AllowedToSign_content'> "+n(t(o.content))+" </div> <div class='edo-AllowedToSign_list ws-hidden'> <component data-component='SBIS3.CONTROLS/Tree/DataGridView' name='listAllowedSign' class='edo-AllowedToSign_list_allowedSign controls-ListView__withoutMarker'> <option name='itemsDragNDrop' value=''></option> <option name='editArrow'>false</option> <option name='allowEnterToFolder'>false</option> <option name='displayProperty'>Имя</option> <option name='ignoreLocalPageSize'>true</option> <option name='parentProperty'>Раздел</option> <option name='idProperty'>@ТипДоверия</option> <option name='expand'>false</option> <options name='columns' type='array'> <options> <option name='title'>"+n(t(rk("Название")))+"</option> <option name='cellTemplate'>html!SBIS3.EDO.AllowedToSign/resources/nameCellTemplate</option> </options> <options> <option name='title'>"+n(t(rk("Разрешение")))+"</option> <option name='cellTemplate'>html!SBIS3.EDO.AllowedToSign/resources/resolutionCellTemplate</option> <option name='width'>");return o.useReportTemplate?p+="280":p+="170",p+="</option> ",o.useReportTemplate&&(p+=" <options name='includedTemplates'> <option name='reportTpl'>html!SBIS3.EDO.AllowedToSign/resources/reportCellTemplate</option> </options> "),p+=" <option name='className'>controls-DataGridView__td__textAlignRight</option> </options> </options> <option name='emptyHTML'>"+n(t(rk("Нет записей")))+"</option> <option name='multiselect'>true</option> <options name='itemsActions' type='array'> </options> <option name='paging'>no</option> <option name='showHead'>false</option> <options name='validators' type='array'> <options> <option name='validator' type='function'>js!SBIS3.EDO.AllowedToSign:prototype.validatorAllowedSign</option> </options> </options> <options name='handlers'> <option name='onInit' type='function'>js!SBIS3.EDO.AllowedToSign:prototype.onInitAllowedSign</option> <option name='onSelectedItemsChange' type='function'>js!SBIS3.EDO.AllowedToSign:prototype.onSelectedItemsChangeAllowedSign</option> <option name='onNodeCollapse' type='function'>js!SBIS3.EDO.AllowedToSign:prototype.onNodeCollapseAllowedSign</option> </options> </component> </div> </div>",(p=n(p))+(i&&-1!==p.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.AllowedToSign"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.AllowedToSign", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-AllowedToSign{width:100%}.edo-AllowedToSign_caption{font-size:18px;color:#313e78;white-space:nowrap;font-weight:700;height:32px;line-height:32px;padding:0 8px}.edo-AllowedToSign_caption_linkView{margin:4px 0;height:24px;width:24px}.edo-AllowedToSign_content{padding:0 8px}.edo-AllowedToSign_list{padding-top:12px;width:100%}.edo-AllowedToSign_list_allowedSign{border-width:1px;border-style:solid;border-color:transparent}.edo-AllowedToSign_list_allowedSign.ws-validation-error{border-color:#ff302b!important}.edo-AllowedToSign_list_allowedSign .controls-TreeView__columnValue{line-height:22px}.edo-AllowedToSign_list_allowedSign .controls-DataGridView__tr.controls-ListView__item__multiSelected:not(.controls-ListView__hoveredItem).controls-ListView__item{background-color:transparent!important}.edo-AllowedToSign_list_allowedSign .controls-DataGridView__tr.controls-ListView__item__multiSelected:not(.controls-ListView__hoveredItem) .controls-DataGridView__td{background-color:transparent!important}.edo-AllowedToSign_rowName{line-height:24px}.edo-AllowedToSign_rowResolution{height:24px}.edo-AllowedToSign_rowResolution_dropdown_list{width:130px!important}.edo-AllowedToSign_rowResolution_dropdown_list .controls-DropdownList__text{font-size:14px}.edo-AllowedToSign_rowResolution_dropdown_list .controls-DropdownList__text:hover{text-decoration:underline}.edo-AllowedToSign_rowResolution_dropdown_list .controls-DropdownList__selectedItem .controls-DropdownList__textWrapper{width:100%!important;padding:0 5px 0 5px!important}.edo-AllowedToSign_rowResolution_dropdown_picker .controls-DropdownList__selectedItem{text-align:right;padding-right:2px!important}.edo-AllowedToSign_rowResolution_dropdown_picker .controls-DropdownList__selectedItem .controls-DropdownList__textWrapper{padding-top:2px}.edo-AllowedToSign_rowResolution_dropdown_picker .controls-DropdownList__item{white-space:nowrap}.edo-AllowedToSign_rowResolution_dropdown_picker .controls-DropdownList__body .controls-DropdownList__list{text-align:right}.edo-AllowedToSign_rowResolution_dropdown_picker .controls-DropdownList__text{text-decoration:none!important;font-size:15px!important}.edo-AllowedToSign_rowReport_link{margin-right:9px;line-height:23px}.edo-AllowedToSign_rowReport_regNumber{font-size:14px;color:#999;text-align:right}.edo-AllowedToSign_rowReport_regNumber_field{width:90px;display:inline-block}"));head.appendChild(style);});}
define("html!SBIS3.EDO.AllowedToSign/resources/nameCellTemplate",function(){var e=function(e){var n=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;e.test(n);)n=n.replace(e,"&#123;&#123;$1&#125;&#125;");return n}}(),r=function(e){return e.join?e.join(""):e.toString()},o=function(e){return void 0===e?"":e&&"object"==typeof e?r(e):""+e},t="undefined"!=typeof process,i=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,"<span class='edo-AllowedToSign_rowName'> "+n(o(e.item.get("Имя")))+" </span>");return(i=n(i))+(t&&-1!==i.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.AllowedToSign/resources/nameCellTemplate"}},e});
define("html!SBIS3.EDO.AllowedToSign/resources/reportCellTemplate",function(){var o=function(o){var e=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(e){for(;o.test(e);)e=e.replace(o,"&#123;&#123;$1&#125;&#125;");return e}}(),n=function(o){return o.join?o.join(""):o.toString()},t=function(o){return void 0===o?"":o&&"object"==typeof o?n(o):""+o},i="undefined"!=typeof process,r=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,"<div class='edo-AllowedToSign_rowReport'> "),a=!o.item.get("Флаг");return r+=" ",1===o.item.get("@ТипДоверия")&&(r+=" <component data-component='SBIS3.CONTROLS/Action/SelectorAction' name='SelectorAction'> <option name='template'>js!SBIS3.EDO2.PowersDialog</option> <option name='mode'>floatArea</option> </component> <component data-component='SBIS3.CONTROLS/Link' name='linkAuthority' class='edo-AllowedToSign_rowReport_link'> <option name='caption' value=''></option> <options name='handlers'> <option name='onInit' type='function' value='js!SBIS3.EDO.AllowedToSign:prototype.onInitLinkAuthority'></option> <option name='onActivated' type='function' value='js!SBIS3.EDO.AllowedToSign:prototype._onActivatedLinkAuthority'></option> </options> <option name='visible' value='",r+=a?"false":"true",r+="'></option> </component> "),r+=" ",3===o.item.get("@ТипДоверия")&&(r+=" <span class='edo-AllowedToSign_rowReport_regNumber ",a&&(r+="ws-hidden"),r+="'>"+e(t(rk("Рег.номер доверителя")))+"</span> <component data-component='SBIS3.CONTROLS/TextBox' name='tbRegNumber' class='edo-AllowedToSign_rowReport_regNumber_field'> <option name='maxLength' value='10'></option> <option name='inputRegExp' value='\\d'></option> <option name='text' bind='record/КонтрагентРасширение.РегНомерФСС' nonexistent=''></option> <options name='validators' type='array'> <options> <option name='validator' type='function' value='js!SBIS3.EDO.AllowedToSign:prototype.validatorRegNumber'></option> </options> </options> <option name='visible' value='",r+=a?"false":"true",r+="'></option> </component> "),r+=" </div>",(r=e(r))+(i&&-1!==r.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.AllowedToSign/resources/reportCellTemplate"}},o});
define("html!SBIS3.EDO.AllowedToSign/resources/resolutionCellTemplate",function(){var o=function(o){var e=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(e){for(;o.test(e);)e=e.replace(o,"&#123;&#123;$1&#125;&#125;");return e}}(),n=function(o){return o.join?o.join(""):o.toString()},t=function(o){return void 0===o?"":o&&"object"==typeof o?n(o):""+o},i="undefined"!=typeof process,r=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,"<div class='edo-AllowedToSign_rowResolution'> ");if(o.item.get("ПоказатьРазрешение")){r+=" ";var p="DLResolution_"+o.item.get("@ТипДоверия"),l=o.item.get("Список")||"Все";r+=" <component data-component='SBIS3.CONTROLS/DropdownList' name='"+e(t(p))+"' class='controls-DropdownList__linkStyle controls-DropdownList__withoutArrow controls-DropdownList__withoutCross'> <option name='idProperty'>key</option> <option name='displayProperty'>title</option> <options name='items' type='array'> <options> <option name='key'>Отклонение</option> <option name='title'>"+e(t(rk("Только отклонение")))+"</option> </options> <options> <option name='key'>Все</option> <option name='title'>"+e(t(rk("Без ограничений")))+"</option> </options> </options> <options name='selectedKeys' type='array'> <option>"+e(t(l))+"</option> </options> <option name='type'>simple</option> <option name='editable'>false</option> <option name='allowEmptySelection'>false</option> <option name='selectOnClick'>true</option> <option name='mode'>click</option> <option name='multiselect'>false</option> <option name='className'>edo-AllowedToSign_rowResolution_dropdown_list</option> <option name='pickerClassName'>edo-AllowedToSign_rowResolution_dropdown_picker controls-DropdownList__picker</option> <option name='visible'>"+e(t(!!o.item.get("Флаг")))+"</option> <options name='handlers'> <option name='onSelectedItemsChange' type='function'>js!SBIS3.EDO.AllowedToSign:prototype.onSelectedItemsChangeDLResolution</option> </options> </component> "}else r+=" ",o.included&&o.included.reportTpl&&(r+=" "+e(t(o.included.reportTpl(o)))+" "),r+=" ";return r+=" </div>",(r=e(r))+(i&&-1!==r.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.AllowedToSign/resources/resolutionCellTemplate"}},o});
define('js!SBIS3.EDO.AllowedToSign',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.AllowedToSign','WS.Data/Source/Memory','WS.Data/Relation/Hierarchy','css!SBIS3.EDO.AllowedToSign','SBIS3.CONTROLS/Link','html!SBIS3.EDO.AllowedToSign/resources/nameCellTemplate','html!SBIS3.EDO.AllowedToSign/resources/reportCellTemplate','html!SBIS3.EDO.AllowedToSign/resources/resolutionCellTemplate','SBIS3.CONTROLS/Tree/DataGridView','SBIS3.CONTROLS/DropdownList','SBIS3.CONTROLS/TextBox','SBIS3.CONTROLS/Action/SelectorAction','Doverennosti_localization'],function(e,t,n,o){var r=e.extend({_dotTplFn:t,$protected:{_options:{content:'',useReportTemplate:false,key_name:'@Документ'}},_controls:{},_showAllowedSign:false,init:function(){r.superclass.init.call(this);var e=this,t=e.getLinkedContext(),o=function(){var o=new n({data:t.getValue('record/МассивРазрешений'),idProperty:'@ТипДоверия'});if(e._controls.browser.setDataSource(o),e._controls.browser.setSelectedKeys(t.getValue('record/ВыбранныеРазрешения')),t.getValue('record/МассивРазрешений').length===t.getValue('record/ВыбранныеРазрешения').length)e._showAllowedSign=false,e._controls.caption.removeClass('ws-hidden'),e._controls.linkView.show(),e._controls.linkView.setIcon('sprite:icon-24 icon-Expand icon-primary'),e._controls.container.addClass('ws-hidden');else e._controls.caption.addClass('ws-hidden'),e._controls.linkView.hide(),e._controls.linkView.setIcon('sprite:icon-24 icon-Curtail icon-primary'),e._controls.container.removeClass('ws-hidden');},i=e._options.key_name;if(e._controls={browser:e.getChildControlByName('listAllowedSign'),container:e.getContainer().find('.edo-AllowedToSign_list'),linkView:e.getChildControlByName('linkView'),caption:e.getContainer().find('.edo-AllowedToSign_caption_allTypes')},t.getValue('record/'+i))o();else t.subscribeTo(t,'onFieldChange',function e(n,r,i,l){if('record'===r&&t.getValue('record'))t.unsubscribeFrom(t,'onFieldChange',e),o();});},onActivatedLinkView:function(){this.getParent().changeView();},changeView:function(e){var t=this;if(t._showAllowedSign=void 0!==e?e:!t._showAllowedSign,t._showAllowedSign)t._controls.linkView.setIcon('sprite:icon-24 icon-Curtail icon-primary'),t._controls.container.removeClass('ws-hidden');else t._controls.linkView.setIcon('sprite:icon-24 icon-Expand icon-primary'),t._controls.container.addClass('ws-hidden');},onInitAllowedSign:function(e){var t=this;t._prevRemPar=null;var n=t._onCheckBoxClick;t._onCheckBoxClick=function(e){if(t.isEnabled())n.call(t,e);};},onSelectedItemsChangeAllowedSign:function(e,t,n){for(var r=this,i=r.getParent(),l=r.getItems(),a=r.getLinkedContext(),s=a.getValue('record/МассивРазрешений'),d=s.length,c=t.length,g='Раздел',u=[],f=new o({idProperty:l.getIdProperty(),parentProperty:g,nodeProperty:g+'@'}),h=a.getValue('record/ВыбранныеРазрешения'),S=h.length,C={},p=true,w=0;w<c;w++){if('number'===typeof t[w]&&p)p=false;u.push(String(t[w]));}if(!p)t=u;for(var v=0;v<S;v++)C[h[v]]=true;if(S!==c)p=false;else for(var m=0;m<c;m++)if(true!==C[t[m]])p=false;if(!p)a.setValue('record/ВыбранныеРазрешения',t);if(l){for(var _=0;_<d;_++){var k=s[_],I=k['@ТипДоверия'],V=t.indexOf(I)>=0||t.indexOf(I+'')>=0;if(k['Флаг']!==V)k['Флаг']=V,l.at(_).set('Флаг',V);}var x=n.added,y=x.length,b=n.removed,B=b.length,T=[],A=[],O=this.getParentProperty();if(c===l.getCount())i._controls.caption.removeClass('ws-hidden'),i._controls.linkView.show(),i._showAllowedSign=true;else i._controls.caption.addClass('ws-hidden'),i._controls.linkView.hide(),i._showAllowedSign=false;if(y>0){for(var N=0;N<y;N++){for(var R=parseInt(x[N],10),L=f.getChildren(R,l),P=L.length,D=0;D<P;D++){var E=L[D].get('@ТипДоверия');if(-1===T.indexOf(E)&&-1===x.indexOf(E))T.push(String(E));}var F=l.getRecordById(R).get(O);if(5!==R&&7!==R)if(null!==F){for(var W=f.getChildren(F,l),j=W.length,G=true,H=0;H<j;H++){var K=W[H].get('@ТипДоверия');if(-1===t.indexOf(String(K)))G=false;}if(G)T.push(String(F));}}if(T.length>0)r.addItemsSelection(T);}var M=false;if(B>0){for(var $=0;$<B;$++){var q=parseInt(b[$],10),z=f.getChildren(q,l),J=z.length;if(r._prevRemPar!==q)for(var Q=0;Q<J;Q++){var U=z[Q].get('@ТипДоверия');if(-1===A.indexOf(U)&&-1===b.indexOf(U))A.push(U);}var X=l.getRecordById(q).get(O);if(null!==X)r._prevRemPar=X,M=true,A.push(X);}if(A.length>0)r.removeItemsSelection(A);}if(!M)r._prevRemPar=null;}},onNodeCollapseAllowedSign:function(e,t,n){var o=this.getParentByClass('SBIS3.EDO.AllowedToSign');if(0==t&&o._options.useReportTemplate){var r=this.getLinkedContext().getValue('record/КонтрагентРасширение.РегНомерФСС'),i=o.validRegNumber(r);if(true!==i)this.expandNode(0).addCallback(function(){this.waitChildControlByName('tbRegNumber').addCallback(function(e){e.subscribeOnceTo(e,'onTextChange',function(t){e.markControl(i,true);});});}.bind(this,i));}},validatorAllowedSign:function(e){var t=this,n=t.getParentByClass('SBIS3.EDO.AllowedToSign'),o=t.getLinkedContext(),r=o.getValue('record/ВыбранныеРазрешения'),i=o.getValue('record/КонтрагентРасширение.РегНомерФСС'),l=n.validRegNumber(i);if(r.length<=0)return rk('Не выбрано ни одного права на подпись');else if(true!==l)t.expandNode(0).addCallback(function(){t.waitChildControlByName('tbRegNumber').addCallback(function(e){e.subscribeOnceTo(e,'onTextChange',function(t){e.markControl(l,true);});});}.bind(this,l));return true;},onSelectedItemsChangeDLResolution:function(e,t,n){for(var o=this,r=o.getLinkedContext(),i=o.getName(),l='DLResolution_',a=parseInt(i.substr(l.length),10),s=r.getValue('record/МассивРазрешений'),d=s.length,c=0;c<d;c++){var g=s[c];if(a===g['@ТипДоверия'])if(g['Список']!==t[0]){r.setValue('record/МассивРазрешений/'+a+'/Список',t[0]);break;}}},onInitLinkAuthority:function(e){var t=this,n=t.getParent().getLinkedContext().getValue('record/Доверенность.ФлагиПолномочия'),o=rk('Все полномочия');if(!n.get('99'))o=rk('Ограниченные полномочия');t.setCaption(o);},_onActivatedLinkAuthority:function(){var e=this,t=e.getParent().getParent(),n=e.getParent().getChildControlByName('SelectorAction'),o=t.getLinkedContext(),r=o.getValue('record/Доверенность.ФлагиПолномочия'),i=r.getByIndex(19),l=[];r.each(function(e,t){var n=Number(t);if((i||r.getByIndex(n))&&19!==n)l.push(n);}),n.execute({componentOptions:{selPowers:l,powerList:o.getValue('record/МассивФлаговПолномочий')}}),n.once('onExecuted',function(t,n,r){var i=[],l=o.getValue('record/Доверенность.ФлагиПолномочия');if(r)if(l.setFalseAll(),o.getValue('record/МассивФлаговПолномочий').length===r.getCount())e.setCaption(rk('Все полномочия')),l.setByIndex(19,true);else r.each(function(e){var t=e.get('Полномочие');i.push(Number(t)),l.setByIndex(t,true);}),e.setCaption(rk('Ограниченные полномочия'));});},validRegNumber:function(e){var t=e?e.length:0,n=this.getLinkedContext().getValue('record/СтатусДоверенности');if(1===n||2===n||3===n)if(10!==t)return rk('Номер в ФСС должен состоять из 10 цифр');else return true;else if(t>0&&10!==t)return rk('Номер в ФСС должен состоять из 10 цифр');else return true;},validatorRegNumber:function(){var e=this.getParentByClass('SBIS3.EDO.AllowedToSign'),t=this.getText();return e.validRegNumber(t);}});return r;});
define("tmpl!SBIS3.EDO.TrustSignDialog",["Core/tmpl/js/tclosure","js!SBIS3.CONTROLS/Button","js!SBIS3.CONTROLS/Link","js!SBIS3.Staff.Choice","js!SBIS3.CONTROLS/Date/Picker","js!SBIS3.EDO.AllowedToSign"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],a={};a["js!SBIS3.CONTROLS/Button"]=e[1],a["js!SBIS3.CONTROLS/Link"]=e[2],a["js!SBIS3.Staff.Choice"]=e[3],a["js!SBIS3.CONTROLS/Date/Picker"]=e[4],a["js!SBIS3.EDO.AllowedToSign"]=e[5];var r=function e(r,o,i,s,n){function l(){}var c=0,g=void 0!==t&&t?t:arguments[arguments.length-1];void 0===g&&(eval("var thelpers = null;"),g=global.requirejs("View/Runner/tclosure"));var d={};n&&n.isSetts&&(d=n.fullContext||{});var p="string"==typeof i?i:"",S=void 0===a?void 0:a,u={id:[],def:void 0},T=g.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,r),h=this&&this.includedTemplates?this.includedTemplates:{},m=g.getMarkupGenerator(s);try{var y=m.joinElements([m.createTag("div",{class:"edo-TrustSignDialog"},[m.createTag("div",{class:"edo-TrustSignDialog_caption"},[m.createTag("div",{class:"edo-TrustSignDialog_title"},[m.createText(" "+global.rk("Доверить электронную подпись")+" "),m.createTag("span",{class:"edo-TrustSignDialog_titleCopy"},[m.createText(" "+global.rk("копия")+" ")],{},u,this)],{},u,this),m.createControl("wsControl","ws:SBIS3.CONTROLS/Button",{handlers:{onActivated:g.getTypeFunc("js!SBIS3.EDO.TrustSignDialog:prototype.onActivatedBtnSave",{})},name:"btnSave",caption:global.rk("Сохранить"),primary:!0,tabindex:1,esc:!1},{class:"edo-TrustSignDialog_btnSave",name:"btnSave",sbisname:"btnSave"},{data:r,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:T},i,S,h,g.config,d),!1===g.getter(r,["multiselectUsers"])?[m.createControl("wsControl","ws:SBIS3.CONTROLS/Link",{handlers:{onActivated:g.getTypeFunc("js!SBIS3.EDO.TrustSignDialog:prototype.onActivatedLinkCopy",{})},name:"linkCopy",icon:"icon-16 icon-Copy icon-primary",tabindex:2,tooltip:global.rk("Копировать доверие"),esc:!1},{class:"edo-TrustSignDialog_linkCopy",name:"linkCopy",sbisname:"linkCopy"},{data:r,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:T},i,S,h,g.config,d)]:m.createText("")],{},u,this),m.createTag("div",{class:"edo-TrustSignDialog_readMode ws-hidden"},[m.createTag("span",{},[m.createText(" "+global.rk("Редактирование недоступно - есть подписанные по доверию документы.")),m.createTag("br",{},[],{},u,this),m.createText(" "+global.rk("Вы можете")+" ")],{},u,this),m.createControl("wsControl","ws:SBIS3.CONTROLS/Link",{handlers:{onActivated:g.getTypeFunc("js!SBIS3.EDO.TrustSignDialog:prototype.onActivatedLinkAbort",{})},name:"linkAbort",allowChangeEnable:!1,enabled:!0,caption:global.rk("прекратить доверие"),esc:!1},{class:"edo-TrustSignDialog_readMode_link",name:"linkAbort",sbisname:"linkAbort"},{data:r,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:T},i,S,h,g.config,d),m.createTag("span",{},[m.createText(" "+global.rk("(перестанет действовать со следующего дня) и оформить новое.")+" ")],{},u,this)],{},u,this),m.createTag("div",{class:"edo-TrustSignDialog_main"},[m.createTag("div",{class:"edo-TrustSignDialog_owner"},[m.createTag("span",{},[m.createText(" "+global.rk("по организации")+" ")],{},u,this),m.createTag("span",{class:"edo-TrustSignDialog_owner_name",title:""+global.rk("")+global.rk("")+global.rk(""),"data-bind":"html: record/Контрагент.Название, attr: {title: record/Контрагент.Название}"},[],{},u,this)],{},u,this),m.createTag("div",{class:"edo-TrustSignDialog_assignee"},[m.createTag("div",{class:"edo-TrustSignDialog_assignee_linkCell"},[m.createControl("wsControl","ws:SBIS3.CONTROLS/Link",{handlers:{onActivated:g.getTypeFunc("js!SBIS3.EDO.TrustSignDialog:prototype.onActivatedLinkSelectUser",{})},name:"linkSelectUser",caption:global.rk("Кому"),defaultButton:!1,tabindex:3,esc:!1},{class:"edo-TrustSignDialog_assignee_link",name:"linkSelectUser",sbisname:"linkSelectUser"},{data:r,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:T},i,S,h,g.config,d)],{},u,this),m.createTag("div",{class:"edo-TrustSignDialog_assignee_userCell"},[m.createControl("wsControl","ws:SBIS3.Staff.Choice",{selectedKeys:[Number()],handlers:{onInit:g.getTypeFunc("js!SBIS3.EDO.TrustSignDialog:prototype.onInitSCUser",{}),onReady:g.getTypeFunc("js!SBIS3.EDO.TrustSignDialog:prototype.onReadySCUser",{}),onSelectedItemsChange:g.getTypeFunc("js!SBIS3.EDO.TrustSignDialog:prototype.onSelectedItemsChangeSCUser",{})},name:"scUser",entityType:"Пользователь",selectionType:"leaf",showOtherEmployees:!0,placeholder:global.rk("Введите ФИО или выберите из справочника"),tabindex:4,pickerClassName:"edo-TrustSignDialog_assignee_user_picker",multiselect:g.getter(r,["multiselectUsers"]),withAccess:!0,esc:!1,bindings:[{fieldName:""+g.getter(r,["recordField"]),propName:"selectedKeys/0",propPath:["0"],fullPropName:"selectedKeys/0",propPathStr:"0",oneWay:!1,direction:"fromContext",bindNonExistent:!1}]},{class:"edo-TrustSignDialog_assignee_user",name:"scUser",sbisname:"scUser"},{data:r,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:T},i,S,h,g.config,d)],{},u,this)],{},u,this),m.createTag("div",{class:"edo-TrustSignDialog_period"},[m.createTag("div",{class:"edo-TrustSignDialog_dateTo_caption"},[m.createText(" "+global.rk("Дата@@по")+" ")],{},u,this),m.createControl("wsControl","ws:SBIS3.CONTROLS/Date/Picker",{validators:[{validator:g.getTypeFunc(" js!SBIS3.EDO.TrustSignDialog:prototype.validatorDateTo ",{})}],handlers:{onDateChange:g.getTypeFunc("js!SBIS3.EDO.TrustSignDialog:prototype.onDateChangeFdDateTo",{})},name:"fdDateTo",bindings:[{fieldName:"record/ПериодПо",propName:"date",propPath:[],fullPropName:"date",propPathStr:"",oneWay:!1,direction:"fromContext",bindNonExistent:!1}],date:void 0,mask:"DD.MM.YY",isCalendarIconShown:!0,tabindex:5,esc:!1},{class:"edo-TrustSignDialog_dateTo",name:"fdDateTo",sbisname:"fdDateTo"},{data:r,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:T},i,S,h,g.config,d)],{},u,this),g.getter(r,["showELOCheckbox"])?[m.createTag("div",{class:"edo-TrustSignDialog_allowedSign"},[m.createControl("wsControl","ws:SBIS3.EDO.AllowedToSign",{name:"tdList",key_name:"@ДовериеПодписей"},{class:"edo-TrustSignDialog_allowedSign_table",name:"tdList",sbisname:"tdList"},{data:r,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:T},i,S,h,g.config,d)],{},u,this)]:m.createText("")],{},u,this),m.createTag("div",{class:"edo-TrustSignDialog_bot"},[],{},u,this),m.createTag("div",{class:"edo-TrustSignDialog_author"},[m.createTag("div",{class:"edo-TrustSignDialog_author_caption"},[m.createTag("div",{class:"edo-TrustSignDialog_author_title"},[m.createText(" "+global.rk("Оформил")+" ")],{},u,this),m.createTag("div",{class:"edo-TrustSignDialog_author_title edo-TrustSignDialog_author_name edo-TrustSignDialog_author_date"},[m.createText(" "+g.wrapUndef(g.utils.escape(g.getDecorators().strftime.apply(void 0,[g.getter(r,["record","get"]).apply(g.getter(r,["record"]),["ПериодС"]),"%d.%m.%y"])))+" ")],{},u,this)],{},u,this),m.createTag("div",{class:"edo-TrustSignDialog_author_photo"},[],{},u,this),m.createTag("div",{class:"edo-TrustSignDialog_author_user"},[m.createTag("div",{class:"edo-TrustSignDialog_author_post"},[m.createTag("span",{class:"edo-TrustSignDialog_author_name asLink",title:""+g.wrapUndef(g.utils.escape(g.getter(r,["record","get"]).apply(g.getter(r,["record"]),["ФИОАвтора"])))},[m.createText(" "+g.wrapUndef(g.utils.escape(g.getter(r,["record","get"]).apply(g.getter(r,["record"]),["ФИОАвтора"])))+" ")],{},u,this)],{},u,this),m.createTag("div",{class:"edo-TrustSignDialog_author_post"},[m.createTag("span",{title:""+g.wrapUndef(g.utils.escape(g.getter(r,["record","get"]).apply(g.getter(r,["record"]),["ДолжностьАвтора"])))},[m.createText(" "+g.wrapUndef(g.utils.escape(g.getter(r,["record","get"]).apply(g.getter(r,["record"]),["ДолжностьАвтора"])))+" ")],{},u,this)],{},u,this)],{},u,this)],{},u,this)],o,u,this)],p,u);u.def&&(y=m.chain(y,u,o),u=void 0)}catch(e){g.templateError("resources/Delegirovanie_elektronnyh_podpisej/components/TrustSignDialog/TrustSignDialog.tmpl",e,r)}return y||""};return r.includedFunctions={},r.stable=!0,r.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.TrustSignDialog"}},r});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.TrustSignDialog", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-TrustSignDialog{width:100%}.edo-TrustSignDialog_caption{width:100%;height:40px}.edo-TrustSignDialog_title{float:left;margin:10px 0 0 8px;height:24px;font-size:18px;font-weight:700}.edo-TrustSignDialog_titleCopy{color:#ef463a;margin-left:4px;display:none}.edo-TrustSignDialog_btnSave{float:right;margin:8px 48px 0 0;width:110px}.edo-TrustSignDialog_linkCopy{float:right;width:24px;height:24px;margin:8px 8px 0 0}.edo-TrustSignDialog_readMode{width:100%;padding:8px 8px 0 8px;font-size:13px;color:#999}.edo-TrustSignDialog_readMode_link{font-size:13px}.edo-TrustSignDialog_main{width:100%}.edo-TrustSignDialog_owner{margin:8px 8px 0 8px;font-size:14px;height:24px;line-height:24px;text-align:left;white-space:nowrap;text-overflow:ellipsis;-o-text-overflow:ellipsis;overflow:hidden}.edo-TrustSignDialog_owner_name{font-weight:700}.edo-TrustSignDialog_assignee{padding:8px 8px 0 8px;height:24px;display:table}.edo-TrustSignDialog_assignee_linkCell{float:left;width:40px}.edo-TrustSignDialog_assignee_link{float:left;margin-right:8px;color:#999}.edo-TrustSignDialog_assignee_userCell{float:left}.edo-TrustSignDialog_assignee_user{float:left;width:520px}.edo-TrustSignDialog_assignee_user_picker{width:522px!important}.edo-TrustSignDialog_period{margin:8px 8px 0 8px;height:24px}.edo-TrustSignDialog_dateTo_caption{color:#999;width:32px;float:left;padding-right:8px;text-align:right}.edo-TrustSignDialog_bot{height:60px;width:100%}.edo-TrustSignDialog_author{position:absolute;bottom:0;height:52px;width:100%;font-size:14px}.edo-TrustSignDialog_author_caption{float:left;color:#999;padding:0 8px}.edo-TrustSignDialog_author_title{padding-right:4px}.edo-TrustSignDialog_author_dateFrom{font-size:12px;text-align:right}.edo-TrustSignDialog_author_dateFrom_field{height:18px;line-height:12px}.edo-TrustSignDialog_author_dateFrom_field .controls-FormattedTextBox .controls-FormattedTextBox__fieldWrapper{padding:0!important}.edo-TrustSignDialog_author_photo{float:left}.edo-TrustSignDialog_author_user{float:left;padding:0 8px}.edo-TrustSignDialog_author_name{color:#000}.edo-TrustSignDialog_author_post{font-size:12px;color:#999;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:448px}.edo-TrustSignDialog_author_date{float:right}"));head.appendChild(style);});}
define('js!SBIS3.EDO.TrustSignDialog',['WS.Data/Source/SbisService','Core/Indicator','SBIS3.CONTROLS/FormController','tmpl!SBIS3.EDO.TrustSignDialog','js!SBIS3.Employee.ListEmployees','js!SBIS3.Staff.Employee','WS.Data/Entity/Record','SBIS3.CONTROLS/Utils/InformationPopupManager','optional!js!SBIS3.EDO.AllowedToSign','css!SBIS3.EDO.TrustSignDialog','SBIS3.CONTROLS/Button','SBIS3.CONTROLS/Link','js!SBIS3.Staff.Choice','SBIS3.CONTROLS/Date/Picker','Delegirovanie_elektronnyh_podpisej_localization'],function(e,t,a,n,r,s,o,i,l){var d=a.extend({_dotTplFn:n,$protected:{_options:{multiselectUsers:false,dataSource:{endpoint:'ДовериеПодписей',binding:{query:'Прочитать',format:'ДовериеПодписей.Формат',create:'Создать',read:'Прочитать',save:'Записать',destroy:'Удалить'}},showELOCheckbox:true,recordField:this.multiselectUsers?'record/Пользователи':'record/КомуДоверяет'}},$constructor:function(){},_modifyOptions:function(e){return e.showELOCheckbox=l?true:false,e;},init:function(){d.superclass.init.call(this);var e=this,t=e.getLinkedContext(),a=e.getContainer(),n=new Date(),i=t.getValue('record/ПериодПо')?new Date(t.getValue('record/ПериодПо')):null,l=t.getValue('record/ЛицоАвтора');if(a.find('.edo-TrustSignDialog_author_photo').html(r.createDivPhoto(e,t.getValue('record/Автор'),l)),a.find('.edo-TrustSignDialog_author_name').click(function(){s.editByFace(l,e,{});}),e._options.multiselectUsers){var u=new o({format:[{name:'Пользователи',type:'array',kind:'integer'}]}).getFormat().at(0);t.getValue('record').addField(u,null,[]);var g=t.getValue('record').getChanged();if(g&&1===g.length&&'Пользователи'===g[0])t.getValue('record').acceptChanges();}if(i)i.setMilliseconds(999);if(e.isEnabled())if(i&&i<n.setHours(23,59,59,999))e.setEnabled(false);else if(t.getValue('record/Использовано'))e.setEnabled(false),e.getChildControlByName('btnSave').setEnabled(true),e.getChildControlByName('fdDateTo').setEnabled(true),a.find('.edo-TrustSignDialog_readMode').removeClass('ws-hidden');},onActivatedBtnSave:function(e){this.sendCommand('update',{closePanelAfterSubmit:true,hideErrorDialog:false});},onActivatedLinkCopy:function(a){var n=this,r=n.getParent(),s=r.getLinkedContext(),o=function(){t.setMessage('Сохранение'),new e({endpoint:'ДовериеПодписей'}).call('Копировать',{'ИдО':s.getValue('record/@ДовериеПодписей'),'ИмяМетода':'ДовериеПодписей.Формат'}).addCallback(function(e){e=e.getRow();var a=n.getTopParent().getOpener().getChildControlByName('trustSignOpener_mass');t.hide(),s.getValue('record').acceptChanges(),r.getParent().close(),a.execute({id:e.get('@ДовериеПодписей')});}).addErrback(function(e){t.hide();});};if(s.getValue('record').isChanged())i.showConfirmDialog({message:rk('Сохранить изменения перед копированием?'),status:'default',hasCancelButton:false},function(){t.setMessage(rk('Сохранение')),n.sendCommand('update',{closePanelAfterSubmit:false,hideErrorDialog:false}).addCallback(function(e){o();}).addErrback(function(e){t.hide();});},function(){o();});else o();},onActivatedLinkSelectUser:function(e){this.getParent().getChildControlByName('scUser').sendCommand('showSelector');},onInitSCUser:function(e){this._showInvalidUserMessage=true;},onReadySCUser:function(e){var t=[{validator:function(){var e=this.getSelectedKeys().filter(function(e){return null!==e;});return(e.length>0?e[0]:null)?true:rk('Поле обязательно для заполнения');}}];this.getChildControlByName('StaffChoice__fieldLink').setValidators(t);},onSelectedItemsChangeSCUser:function(e,t,a){var n=this,r=n.getLinkedContext(),s=n.getSelectedItems(),o=n.getParent();if(s)if(s.getCount()>0)if(o._options.multiselectUsers){for(var l=[],d=[],u='',g=0;g<s.getCount();g++){var c=s.at(g),f=c.get('Лицо'),h=c.get('Пользователь');if(h){if(-1!==t.indexOf(h)&&-1===l.indexOf(h)&&-1===d.indexOf(f))l.push(h);}else if(-1===d.indexOf(f)){var S=c.get('Название')||'';d.push(f),u=u+(u&&S?', ':'')+S;}}if(d.length>0)if(n._showInvalidUserMessage)u=(1===d.length?rk('пользователя'):rk('пользователей'))+(u?': '+u:''),i.showMessageDialog({message:rk('Невозможно выбрать')+' '+u+'.\n'+(1===d.length?rk('Он не имеет'):rk('Они не имеют'))+' '+rk('доступа в систему.'),status:'error',opener:n}),n._showInvalidUserMessage=false;else n._showInvalidUserMessage=true;if(t.length!==l.length)r.setValue('record/Пользователи',l);}else{var C=s.at(0).get('Пользователь'),m=': '+s.at(0).get('Название')||'';if(!C)if(n._showInvalidUserMessage)i.showMessageDialog({message:rk('Невозможно выбрать пользователя')+m+'.\n'+rk('Он не имеет доступа в систему.'),status:'error',opener:n}),r.setValue('record/КомуДоверяет',null),n.removeItemsSelectionAll(),n.validate(),n._showInvalidUserMessage=false;else n._showInvalidUserMessage=true;}else n._showInvalidUserMessage=true;else n._showInvalidUserMessage=true;},validatorDateTo:function(e){var t=this.getDate(),a=new Date();if(!!t)if(a>t.setHours(23,59,59,999))return rk('Дата окончания действия доверия должна быть позже или равна текущей дате.');return true;},onDateChangeFdDateTo:function(e,t){if(t){var a=new Date(t);if(a.setHours(23,59,59,999),t.valueOf()!==a.valueOf())this.setDate(a);}},onActivatedLinkAbort:function(e){var a=this,n=a.getParent();i.showConfirmDialog({message:rk('Прекратить действие доверия?'),status:'warning',hasCancelButton:false},function(){t.setMessage(rk('Сохранение'));var e=n.getLinkedContext(),r=new Date();r.setHours(23,59,59,999),e.setValue('record/ПериодПо',r),a.sendCommand('update',{closePanelAfterSubmit:false,hideErrorDialog:false}).addCallback(function(e){t.hide();}).addErrback(function(e){t.hide();});});}});return d.dimensions={minWidth:'580px',width:'580px',height:'auto'},d;});
define('js!SBIS3.EDO.TrustSignDialogMassUsers',['js!SBIS3.EDO.TrustSignDialog','Delegirovanie_elektronnyh_podpisej_localization'],function(t){var i=t.extend({$protected:{_options:{multiselectUsers:true}},$constructor:function(){},init:function(){i.superclass.init.call(this);}});return i.dimensions={minWidth:'580px',width:'580px',height:'auto'},i;});
define("tmpl!SBIS3.EDO.TrustSignList",["Core/tmpl/js/tclosure","js!SBIS3.CONTROLS/Link","js!SBIS3.CONTROLS/SearchForm","js!SBIS3.CONTROLS/Switcher/Double","js!SBIS3.CONTROLS/DataGridView","js!SBIS3.CONTROLS/Date/Picker","js!SBIS3.CONTROLS/Action/List/OpenEditDialog"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.CONTROLS/Link"]=e[1],r["js!SBIS3.CONTROLS/SearchForm"]=e[2],r["js!SBIS3.CONTROLS/Switcher/Double"]=e[3],r["js!SBIS3.CONTROLS/DataGridView"]=e[4],r["js!SBIS3.CONTROLS/Date/Picker"]=e[5],r["js!SBIS3.CONTROLS/Action/List/OpenEditDialog"]=e[6];var i=function e(i,o,a,n,s){function l(){}var d=0,c=void 0!==t&&t?t:arguments[arguments.length-1];void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure"));var p={};s&&s.isSetts&&(p=s.fullContext||{});var S="string"==typeof a?a:"",g=void 0===r?void 0:r,u={id:[],def:void 0},m=c.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,i),T=this&&this.includedTemplates?this.includedTemplates:{},v=c.getMarkupGenerator(n);try{var h=v.joinElements([v.createTag("div",{class:"edo-TrustSignList"},[v.createTag("div",{class:"edo-TrustSignList_title"},[v.createTag("div",{class:"edo-TrustSignList_title_top"},[v.createTag("div",{class:"edo-TrustSignList_caption"},[v.createText(" "+global.rk("Кому доверена электронная подпись")+" ")],{},u,this),v.createControl("wsControl","ws:SBIS3.CONTROLS/Link",{handlers:{onActivated:c.getTypeFunc("js!SBIS3.EDO.TrustSignList:prototype.onActivatedLinkAddTrust",{})},name:"linkAddTrust",icon:"icon-24 icon-AddButton icon-primary action-hover",tabindex:2,esc:!1},{class:"edo-TrustSignList_linkAddTrust",name:"linkAddTrust",sbisname:"linkAddTrust"},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,g,T,c.config,p)],{},u,this),v.createTag("div",{class:"controls-Browser__search-small"},[v.createControl("wsControl","ws:SBIS3.CONTROLS/SearchForm",{name:"sfUserFilter",tabindex:3,placeholder:"Введите ФИО",maxLength:256},{class:"edo-TrustSignList_sfUserFilter controls-Browser__search",name:"sfUserFilter",sbisname:"sfUserFilter"},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,g,T,c.config,p),v.createControl("wsControl","ws:SBIS3.CONTROLS/Switcher/Double",{name:"sdValidFilter",tabindex:4,state:"on",bindings:[{fieldName:""+c.getter(i,["filterActive"]),propName:"checked",propPath:[],fullPropName:"checked",propPathStr:"",oneWay:!1,direction:"fromContext",bindNonExistent:!1}],checked:void 0,stateOff:"Все",stateOn:"Действующие"},{class:"edo-TrustSignList_sdValidFilter",name:"sdValidFilter",sbisname:"sdValidFilter"},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,g,T,c.config,p)],{},u,this)],{},u,this),v.createTag("div",{class:"edo-TrustSignList_content"},[v.createControl("wsControl","ws:SBIS3.CONTROLS/DataGridView",{dataSource:{options:{endpoint:{idProperty:"@ДовериеПодписей",contract:"ДовериеПодписей"},binding:{query:"СписокДляРеестра",format:"ДовериеПодписей.Формат",read:"Прочитать",destroy:"Удалить",create:"Создать",update:"Записать"}},module:"WS.Data/Source/SbisService"},filter:{"Контрагент":void 0,"Владелец":void 0,"Действующие":void 0},itemsActions:[{onActivated:c.getTypeFunc("js!SBIS3.EDO.TrustSignList:prototype.actionAbortTrust",{}),name:"abort",icon:"icon-16 icon-Erase icon-error",tooltip:"Прекратить",isMainAction:"true"}],columns:[{includedTemplates:{photoTpl:"tmpl!SBIS3.Person.PersonPhoto/resources/personPhoto"},templateBinding:{photoFldName:"userPhotoData",cssClass:"person-photo-mini-large"},title:"Фото",cellTemplate:"tmpl!SBIS3.EDO.TrustSignList/resources/photoCellTemplate",width:48},{templateBinding:{isExpiredTrust:c.getter(i,["isExpiredTrust"]),delim:c.getter(i,["delim"])},title:"Пользователь и срок",cellTemplate:"tmpl!SBIS3.EDO.TrustSignList/resources/mainCellTemplate"}],editingTemplate:c.createDataArray([(new function(){var e=Object.create(i),t=function e(t,r,i,o,a){if(void 0===i)var i=arguments[2];var n=0,s="editingTemplate";if(void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure")),a&&a.isSetts)var l=a.fullContext||{};t=c.isolateScope(Object.create(this),t,s);var d="string"==typeof i?i:"",p={id:[],def:void 0},S=this&&this.includedTemplates?this.includedTemplates:{},u=c.getMarkupGenerator(o);try{var T=u.joinElements([u.createTag("div",{class:"edo-TrustSignDialog_rowEdit"},[u.createTag("div",{class:"edo-TrustSignDialog_rowEdit_main"},[u.createTag("div",{class:"edo-TrustSignDialog_rowEdit_area"},[u.createTag("span",{class:"edo-TrustSignDialog_rowEdit_name","data-bind":"html: КомуДоверяет.Имя, attr: {title: КомуДоверяет.Имя}"},[],{},p,this),u.createTag("div",{class:"edo-TrustSignDialog_rowEdit_dates"},[u.createTag("span",{},[u.createText(" "+global.rk("с конкретной даты@@c")+" ")],{},p,this),u.createControl("wsControl","ws:SBIS3.CONTROLS/Date/Picker",{name:"dp_DateFrom",date:c.getter(t,["record"])/c.getter(t,["ПериодС"]),mask:"DD.MM.YY",isCalendarIconShown:!1,enabled:!1,allowChangeEnable:!1},{class:"edo-TrustSignDialog_rowEdit_dateFrom",name:"dp_DateFrom",sbisname:"dp_DateFrom"},{data:t,ctx:this,pName:void 0!==s?s:void 0,viewController:m},i,g,S,c.config,l),u.createTag("span",{},[u.createText(" "+global.rk("по")+" ")],{},p,this),u.createControl("wsControl","ws:SBIS3.CONTROLS/Date/Picker",{validators:[{validator:c.getTypeFunc("js!SBIS3.EDO.TrustSignList:prototype.validatorDateTo",{}),option:"text",name:"validator"}],name:"dp_DateTo",date:c.getter(t,["record"])/c.getter(t,["ПериодПо"]),mask:"DD.MM.YY",isCalendarIconShown:!0,esc:!1},{class:"edo-TrustSignDialog_rowEdit_dateTo",name:"dp_DateTo",sbisname:"dp_DateTo"},{data:t,ctx:this,pName:void 0!==s?s:void 0,viewController:m},i,g,S,c.config,l)],{},p,this)],{},p,this)],{},p,this)],r,p,this)],d,p);p.def&&(T=u.chain(T,p,r),p=void 0)}catch(e){c.templateError("resources/Delegirovanie_elektronnyh_podpisej/components/TrustSignList/TrustSignList.tmpl",e,t)}return T||""};this.func=c.makeFunctionSerializable(t,e)}).func]),handlers:{onInit:c.getTypeFunc("js!SBIS3.EDO.TrustSignList:prototype.onInitDgvList",{}),onItemActivate:c.getTypeFunc("js!SBIS3.EDO.TrustSignList:prototype.onItemActivateDgvList",{}),onAfterBeginEdit:c.getTypeFunc("js!SBIS3.EDO.TrustSignList:prototype.onAfterBeginEditDgvList",{}),onEndEdit:c.getTypeFunc("js!SBIS3.EDO.TrustSignList:prototype.onEndEditDgvList",{}),onDataLoad:c.getTypeFunc("js!SBIS3.EDO.TrustSignList:prototype.onDataLoadDgvList",{})},name:"dgvList",displayProperty:"Название",editMode:"toolbar|single",ignoreLocalPageSize:!1,showHead:!1,multiselect:!1,infiniteScroll:"down",emptyHTML:"Нет данных",tabindex:1,esc:!1,bindings:[{fieldName:"Контрагент",propName:"filter/Контрагент",propPath:["Контрагент"],fullPropName:"filter/Контрагент",propPathStr:"Контрагент",oneWay:!0,direction:"fromContext",bindNonExistent:!1},{fieldName:"Владелец",propName:"filter/Владелец",propPath:["Владелец"],fullPropName:"filter/Владелец",propPathStr:"Владелец",oneWay:!0,direction:"fromContext",bindNonExistent:!1},{fieldName:""+c.getter(i,["filterActive"]),propName:"filter/Действующие",propPath:["Действующие"],fullPropName:"filter/Действующие",propPathStr:"Действующие",oneWay:!0,direction:"fromContext",bindNonExistent:!1}]},{class:"edo-TrustSignList_list controls-ListView__withoutMarker controls-DataGridView__hasSeparator",name:"dgvList",sbisname:"dgvList"},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m,internal:{__dirtyCheckingVars_1:c.getter(i,["isExpiredTrust"]),__dirtyCheckingVars_2:c.getter(i,["delim"]),__dirtyCheckingVars_4:c.getter(i,["record"])/c.getter(i,["ПериодС"]),__dirtyCheckingVars_9:c.getter(i,["record"])/c.getter(i,["ПериодПо"])}},a,g,T,c.config,p),v.createControl("wsControl","ws:SBIS3.CONTROLS/Action/List/OpenEditDialog",{name:"trustSignOpener",dialogComponent:"js!SBIS3.EDO.TrustSignDialog",mode:"floatArea"},{name:"trustSignOpener",sbisname:"trustSignOpener"},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,g,T,c.config,p),v.createControl("wsControl","ws:SBIS3.CONTROLS/Action/List/OpenEditDialog",{name:"trustSignOpener_mass",dialogComponent:"js!SBIS3.EDO.TrustSignDialogMassUsers",mode:"floatArea"},{name:"trustSignOpener_mass",sbisname:"trustSignOpener_mass"},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,g,T,c.config,p)],{},u,this)],o,u,this)],S,u);u.def&&(h=v.chain(h,u,o),u=void 0)}catch(e){c.templateError("resources/Delegirovanie_elektronnyh_podpisej/components/TrustSignList/TrustSignList.tmpl",e,i)}return h||""};return i.includedFunctions={},i.stable=!0,i.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.TrustSignList"}},i});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.TrustSignList", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-TrustSignList{width:100%}.edo-TrustSignList_title{width:100%;height:74px}.edo-TrustSignList_title_top{height:35px}.edo-TrustSignList_caption{float:left;margin:10px 0 0 8px;height:24px;font-size:18px;font-weight:700}.edo-TrustSignList_linkAddTrust{float:left;margin:10px 0 0 8px;height:24px}.edo-TrustSignList_sfUserFilter{float:left;margin:8px 0 0 8px}.edo-TrustSignList_sdValidFilter{float:right;margin:8px 8px 0 8px!important}.edo-TrustSignList_content{width:100%;height:auto;margin-bottom:8px}.edo-TrustSignList_list_emptyHtml{text-align:center;font-size:14px;color:#999}.edo-TrustSignList_mainRow{height:40px;color:#000}.edo-TrustSignList_mainRow_disabled{color:#ccc!important}.edo-TrustSignList_mainRow_top{height:24px;line-height:23px;white-space:nowrap;padding-right:140px}.edo-TrustSignList_mainRow_name{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;float:left;max-width:100%}.edo-TrustSignList_mainRow_date{padding-left:4px;margin-right:-144px;color:#999;width:140px;display:inline-block}.edo-TrustSignList_mainRow_post{height:16px;line-height:16px;font-size:12px!important;color:#999;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.edo-TrustSignDialog_mainRow_dateTo{display:inline-block;position:relative}.edo-TrustSignDialog_mainRow_editAtPlace{display:inline-block;background:0 0!important;height:20px;position:absolute;top:-8px;color:#999}.edo-TrustSignDialog_mainRow_editAtPlace .controls-EditAtPlace__fieldWrapper{margin-top:5px;margin-left:12px}.edo-TrustSignDialog_mainRow_editAtPlace .controls-EditAtPlace__fieldWrapper .controls-EditAtPlace__textField{border-style:none!important}.edo-TrustSignDialog_mainRow_editAtPlace_picker{margin-right:0}.edo-TrustSignDialog_mainRow_editAtPlace_picker .controls-DatePicker{margin-right:4px}.edo-TrustSignDialog__row_lightGray{color:#ccc!important}.edo-TrustSignDialog_rowEdit{background-color:transparent;height:40px}.edo-TrustSignDialog_rowEdit_main{padding-left:51px;height:24px}.edo-TrustSignDialog_rowEdit_area{background-color:#f3f3f3;padding-right:244px;line-height:24px}.edo-TrustSignDialog_rowEdit_name{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;float:left;max-width:100%}.edo-TrustSignDialog_rowEdit_dates{color:#999;margin-right:-174px;display:inline-block;padding-left:4px}.edo-TrustSignDialog_rowEdit_dateFrom .controls-DatePicker__fieldWrapper{padding:0!important}"));head.appendChild(style);});}
define("tmpl!SBIS3.EDO.TrustSignList/resources/photoCellTemplate",["Core/tmpl/js/tclosure","js!SBIS3.Person.PersonPhoto"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.Person.PersonPhoto"]=e[1];var o=function e(o,n,i,s,l){function a(){}var p=0,u=void 0!==t&&t?t:arguments[arguments.length-1];void 0===u&&(eval("var thelpers = null;"),u=global.requirejs("View/Runner/tclosure"));var c={};l&&l.isSetts&&(c=l.fullContext||{});var d="string"==typeof i?i:"",m=void 0===r?void 0:r,v={id:[],def:void 0},h=u.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),g=this&&this.includedTemplates?this.includedTemplates:{},f=u.getMarkupGenerator(s);try{var P=f.joinElements([f.createTag("div",{},[f.createControl("wsControl","ws:SBIS3.Person.PersonPhoto",{data:{personId:u.getter(o,["item","get"]).apply(u.getter(o,["item"]),["Лицо"]),photoId:u.getter(o,["item","get"]).apply(u.getter(o,["item"]),["Лицо.PhotoId"])},settings:{size:32}},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:h},i,m,g,u.config,c)],n,v,this)],d,v);v.def&&(P=f.chain(P,v,n),v=void 0)}catch(e){u.templateError("resources/Delegirovanie_elektronnyh_podpisej/components/TrustSignList/resources/photoCellTemplate.tmpl",e,o)}return P||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.TrustSignList/resources/photoCellTemplate"}},o});
define("tmpl!SBIS3.EDO.TrustSignList/resources/mainCellTemplate",["Core/tmpl/js/tclosure"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],i={},r=function e(r,a,g,l,p){function s(){}var n=0,m=void 0!==t&&t?t:arguments[arguments.length-1];void 0===m&&(eval("var thelpers = null;"),m=global.requirejs("View/Runner/tclosure"));var o={};p&&p.isSetts&&(o=p.fullContext||{});var d="string"==typeof g?g:"",c=void 0===i?void 0:i,u={id:[],def:void 0},y=m.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,r),T=this&&this.includedTemplates?this.includedTemplates:{},f=m.getMarkupGenerator(l);try{var v=f.joinElements([f.createTag("div",{class:"edo-TrustSignList_mainRow"},[f.createTag("div",{class:"edo-TrustSignList_mainRow_top "+m.wrapUndef(m.utils.escape(m.getter(r,["templateBinding","isExpiredTrust"]).apply(m.getter(r,["templateBinding"]),[m.getter(r,["item","get"]).apply(m.getter(r,["item"]),["ПериодС"]),m.getter(r,["item","get"]).apply(m.getter(r,["item"]),["ПериодПо"])])?"":"edo-TrustSignDialog__row_lightGray"))},[f.createTag("span",{class:"edo-TrustSignList_mainRow_name"},[f.createText(" "+m.wrapUndef(m.utils.escape(m.getter(r,["item","get"]).apply(m.getter(r,["item"]),["КомуДоверяет.Имя"])))+" ")],{},u,this),f.createTag("div",{class:"edo-TrustSignList_mainRow_date "+m.wrapUndef(m.utils.escape(m.getter(r,["templateBinding","isExpiredTrust"]).apply(m.getter(r,["templateBinding"]),[m.getter(r,["item","get"]).apply(m.getter(r,["item"]),["ПериодС"]),m.getter(r,["item","get"]).apply(m.getter(r,["item"]),["ПериодПо"])])?"":"edo-TrustSignDialog__row_lightGray"))},[m.getter(r,["item","get"]).apply(m.getter(r,["item"]),["ПериодС"])?[f.createTag("span",{},[f.createText(" "+global.rk("с конкретной даты@@c")+" "+m.wrapUndef(m.utils.escape(m.getter(m.getter(r,["item","get"]).apply(m.getter(r,["item"]),["ПериодС"]),["strftime"]).apply(m.getter(r,["item","get"]).apply(m.getter(r,["item"]),["ПериодС"]),["%d.%m.%y"])))+" ")],{},u,this)]:f.createText(""),m.getter(r,["item","get"]).apply(m.getter(r,["item"]),["ПериодПо"])?[f.createTag("span",{},[f.createText(" "+global.rk("по")+" "+m.wrapUndef(m.utils.escape(m.getter(m.getter(r,["item","get"]).apply(m.getter(r,["item"]),["ПериодПо"]),["strftime"]).apply(m.getter(r,["item","get"]).apply(m.getter(r,["item"]),["ПериодПо"]),["%d.%m.%y"])))+" ")],{},u,this)]:f.createText("")],{},u,this)],{},u,this),f.createTag("div",{class:"edo-TrustSignList_mainRow_post "+m.wrapUndef(m.utils.escape(m.getter(r,["templateBinding","isExpiredTrust"]).apply(m.getter(r,["templateBinding"]),[m.getter(r,["item","get"]).apply(m.getter(r,["item"]),["ПериодС"]),m.getter(r,["item","get"]).apply(m.getter(r,["item"]),["ПериодПо"])])?"":"edo-TrustSignDialog__row_lightGray"))},[f.createText(" "+m.wrapUndef(m.utils.escape(m.getter(r,["templateBinding","delim"]).apply(m.getter(r,["templateBinding"]),[m.getter(r,["item","get"]).apply(m.getter(r,["item"]),["КомуДоверяет.ДолжностьНазвание"]),m.getter(r,["item","get"]).apply(m.getter(r,["item"]),["КомуДоверяет.СтруктураНазвание"])])))+" ")],{},u,this)],a,u,this)],d,u);u.def&&(v=f.chain(v,u,a),u=void 0)}catch(e){m.templateError("resources/Delegirovanie_elektronnyh_podpisej/components/TrustSignList/resources/mainCellTemplate.tmpl",e,r)}return v||""};return r.includedFunctions={},r.stable=!0,r.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.TrustSignList/resources/mainCellTemplate"}},r});
define('js!SBIS3.EDO.TrustSignList',['WS.Data/Source/SbisService','SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.TrustSignList','SBIS3.CONTROLS/Utils/InformationPopupManager','SBIS3.CONTROLS/ComponentBinder','css!SBIS3.EDO.TrustSignList','SBIS3.CONTROLS/Link','SBIS3.CONTROLS/Switcher/Double','SBIS3.CONTROLS/DataGridView','tmpl!SBIS3.EDO.TrustSignList/resources/photoCellTemplate','tmpl!SBIS3.Person.PersonPhoto/resources/personPhoto','tmpl!SBIS3.EDO.TrustSignList/resources/mainCellTemplate','SBIS3.CONTROLS/Action/List/OpenEditDialog','SBIS3.CONTROLS/Date/Picker','SBIS3.CONTROLS/SearchForm','Delegirovanie_elektronnyh_podpisej_localization'],function(t,e,n,i,s){var r=e.extend({_dotTplFn:n,$protected:{_options:{reloadOpener:false,isExpiredTrust:function(t,e){return new Date()>new Date(t)&&(null===e||new Date(e)>new Date());},delim:function(t,e){return(t?t:'')+(t&&e?' / ':'')+(e?e:'');},filterActive:true}},_controls:{},$constructor:function(){},init:function(){r.superclass.init.call(this);var t=this;t._controls={list:t.getChildControlByName('dgvList'),opener:t.getChildControlByName('trustSignOpener'),opener_mass:t.getChildControlByName('trustSignOpener_mass'),search:t.getChildControlByName('sfUserFilter')},t._controls.opener.subscribe('onUpdateModel',function(e,n,i){t._controls.list.reload(),t.reloadOpener();}),t._controls.opener_mass.subscribe('onUpdateModel',function(e,n,i){t._controls.list.reload(),t.reloadOpener();}),new s({view:t._controls.list}).bindSearchComposite('СтрокаПоиска',void 0,t._controls.search);},reloadOpener:function(){if(this._options.reloadOpener)this.getParent().getOpener().reload();},addTrustWithMassUser:function(){var t=this,e=t.getLinkedContext();t._controls.opener_mass.execute({filter:{'Контрагент':e.getValue('Контрагент'),'Владелец':e.getValue('Владелец'),'ВызовИзБраузера':true}});},onActivatedLinkAddTrust:function(){this.getParent().addTrustWithMassUser();},onInitDgvList:function(t,e){this._emptyHTMLinstalled=false;},onItemActivateDgvList:function(t,e){this.getParent()._controls.opener.execute({id:e.id});},onAfterBeginEditDgvList:function(t,e){this._getItemsToolbar().hideItemsActions();},onEndEditDgvList:function(t,e,n){if(n){var i=e.get('ПериодПо'),s=i?new Date(i):null;if(s)s.setHours(23,59,59,999),e.set('ПериодПо',s);}},onDataLoadDgvList:function(t,e){if(!this._emptyHTMLinstalled)if(0===e.getCount()){var n=this.getParent();this._emptyHTMLinstalled=true,this.setEmptyHTML('<div class="edo-TrustSignList_list_emptyHtml">'+'<div>'+'<div>'+rk('Сейчас данной подписью')+'</div>'+'<div>'+rk('может пользоваться только её владелец.')+'</div>'+'<br/>'+'<div>'+'<span>'+rk('Вы можете')+' </span>'+'<a class="asLink edo-TrustSignList_list_emptyHtml_linkAdd">'+rk('доверить использование')+'</a>'+'</div>'+'<div>'+rk('этой подписи другому сотруднику.')+'</div>'+'<br/>'+'<div>'+'<a class="asLink" href="http://help.sbis.ru/exchange/delegate/transfer_of_rights" target="_blank">'+rk('Читать полностью')+'...</a>'+'</div>'+'</div>'+'</div>'),this.getContainer().find('.edo-TrustSignList_list_emptyHtml_linkAdd').click(function(){n.addTrustWithMassUser();});}else this._emptyHTMLinstalled=true,this.setEmptyHTML(rk('Нет данных'));},actionAbortTrust:function(e,n,s){var r=this,o=r.getParent(),a=s;if(s.get('Использовано'))i.showConfirmDialog({message:rk('Доверие использовано! Хотите изменить дату окончания действия доверия?'),status:'default',hasCancelButton:false},function(){r.sendCommand('beginEdit',a);});else i.showConfirmDialog({message:rk('Отозвать доверие на подпись?'),status:'default',hasCancelButton:false},function(){new t({endpoint:'ДовериеПодписей'}).call('Удалить',{'ИдО':s.getId()}).addCallback(function(){r.reload(),o.reloadOpener();});});},validatorDateTo:function(t){var e=this.getDate(),n=e?new Date(e):null,i=new Date();if(n)if(n.setHours(23,59,59,999),i>n)return rk('Дата окончания действия доверия должна быть позже или равна текущей дате.');return true;}});return r;});
define("html!SBIS3.EDO.AutocompleteHandlers/resources/AutocompleteTemplate",function(){var o=function(o){var n=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;o.test(n);)n=n.replace(o,"&#123;&#123;$1&#125;&#125;");return n}}(),t=function(o){return o.join?o.join(""):o.toString()},e=function(o){return void 0===o?"":o&&"object"==typeof o?t(o):""+o},i="undefined"!=typeof process,p=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<option name="placeholder">'+n(e(rk("Найти...")))+'</option> <option name="searchDelay">600</option> <option name="trim">true</option> <option name="usePicker">true</option> <option name="text" bind="searchFormField"></option> <option name="searchParam">Реквизиты</option> <options name="handlers"> <options name="onListItemSelect" type="array"> <option type="function">js!SBIS3.EDO.AutocompleteHandlers:onListItemSelect</option> </options> <options name="onSearch" type="array"> <option type="function">js!SBIS3.EDO.AutocompleteHandlers:onSearch</option> </options> <options name="onReset" type="array"> <option type="function">js!SBIS3.EDO.AutocompleteHandlers:onReset</option> </options> </options> <options name="resultBindings" type="array"> <options> <option name="contextField">searchFormField</option> <option name="itemField">@Лицо</option> </options> </options> <options name="list"> <option name="component">SBIS3.CONTROLS/Suggest/SuggestView</option> <options name="options"> <option name="displayProperty" value="title"></option> <option name="idProperty" value="id"></option> <option name="selectedKey" value="DialogCompaniesTab"></option> <options name="items" type="array"> <options> <option name="id">DialogCompaniesTab</option> <option name="title">'+n(e(rk("Компании")))+'</option> <option name="align">left</option> <option name="searchParam">Реквизиты</option> <option name="content"> <component data-component="SBIS3.CONTROLS/DataGridView" name="view"> <options name="columns" type="array"> <options> <option name="cellTemplate">html!SBIS3.EDO.CompaniesTemplate</option> </options> </options> <option name="showHead">false</option> <option name="idProperty">@Лицо</option> <options name="itemsActions" type="array"></options> <options name="dataSource"> <option name="firstLoad" value="false"></option> <option name="module" value="WS.Data/Source/SbisService"></option> <options name="options"> <option name="endpoint" value="Контрагент"></option> <options name="binding"> <option name="query" value="АвтодополнениеОбщее"></option> </options> <option name="idProperty" value="@Лицо"></option> </options> </options> <options name="handlers"> <options name="onBeforeDataLoad" type="array"> <option type="function">js!SBIS3.EDO.AutocompleteHandlers:onBeforeDataLoadCompaniesTab</option> </options> </options> <option name="pageSize">5</option> <option name="emptyHTML">'+n(e(rk("Не найдено.")))+'</option> <option name="footerTpl"> <component data-component="SBIS3.CONTROLS/Link" name="showAllButton"> <option name="caption">'+n(e(rk("Показать все")))+'</option> </component> </option> </component> </option> </options> <options> <option name="id">DialogPeopleTab</option> <option name="title">'+n(e(rk("Люди")))+'</option> <option name="align">left</option> <option name="searchParam">поиск</option> <option name="content"> <component data-component="SBIS3.CONTROLS/DataGridView" name="view"> <options name="columns" type="array"> <options> <option name="cellTemplate">html!SBIS3.EDO.PeopleTemplate</option> </options> </options> <option name="showHead">false</option> <option name="idProperty">@Лицо</option> <options name="itemsActions" type="array"></options> <options name="dataSource"> <option name="firstLoad" value="false"></option> <option name="module" value="WS.Data/Source/SbisService"></option> <options name="options"> <option name="endpoint" value="Люди"></option> <options name="binding"> <option name="query" value="СписокПоиск"></option> </options> <option name="idProperty" value="@Лицо"></option> </options> </options> <options name="handlers"> <options name="onBeforeDataLoad" type="array"> <option type="function">js!SBIS3.EDO.AutocompleteHandlers:onBeforeDataLoadPeopleTab</option> </options> </options> <option name="pageSize">5</option> <option name="emptyHTML">'+n(e(rk("Не найдено.")))+'</option> <option name="footerTpl"> <component data-component="SBIS3.CONTROLS/Link" name="showAllButton"> <option name="caption">'+n(e(rk("Показать все")))+"</option> </component> </option> </component> </option> </options> </options> </options> </options>");return(p=n(p))+(i&&-1!==p.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.AutocompleteHandlers/resources/AutocompleteTemplate"}},o});
define("html!SBIS3.EDO.CompaniesTemplate",function(){var e=function(e){var t=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;e.test(t);)t=t.replace(e,"&#123;&#123;$1&#125;&#125;");return t}}(),i=function(e){return e.join?e.join(""):e.toString()},s=function(e){return void 0===e?"":e&&"object"==typeof e?i(e):""+e},n="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,""),m=global.requirejs("Core/helpers/string-helpers"),r=e.item.get("ИНН")||"",l=e.item.get("КПП")||"",o=l||r?"":"edo-CompaniesTemplate_width0";return a+=' <div class="',0===parseInt(e.item.get("Состояние"))&&(a+="edo-CompaniesTemplate_ctrg-deceased"),a+='" title="'+t(s(m.escapeHtml(e.item.get("НазваниеТултип"))))+'"> <div class="edo-CompaniesTemplate_kpp '+t(s(o))+'" title="'+t(s(e.item.get("КПП")||""))+'">'+t(s(e.decorators.applyOnly(l,{highlight:!0})))+'</div> <div class="edo-CompaniesTemplate_inn" title="'+t(s(e.item.get("ИНН")||""))+'">'+t(s(e.decorators.applyOnly(r,{highlight:!0})))+"</div> ",(e.item.get("Название")||e.item.get("Регион"))&&(a+=' <div class="ws-ellipsis"> ',e.item.get("Название")&&(a+=" <span>"+t(s(m.escapeHtml(e.item.get("Название"))))+"</span> "),a+=" ",e.item.get("Регион")&&(a+=' <span class="edo-CompaniesTemplate_region">'+t(s(m.escapeHtml(e.item.get("Регион"))))+"</span> "),a+=" </div> "),a+=" ",e.item.get("НазваниеГоловы")&&(a+=' <div class="ws-ellipsis edo-CompaniesTemplate_line2"> <span class="edo-CompaniesTemplate_branchOf">(Филиал '+t(s(m.escapeHtml(e.item.get("НазваниеГоловы"))))+")</span> </div> "),a+=" ",(e.item.get("ИНН")&&10===String(e.item.get("ИНН")).length&&e.item.get("Директор.Фамилия")&&e.item.get("Директор.Имя")&&e.item.get("Директор.Отчество")||e.category)&&(a+=' <div class="ws-ellipsis edo-CompaniesTemplate_line3"> ',e.item.get("ИНН")&&10===String(e.item.get("ИНН")).length&&e.item.get("Директор.Фамилия")&&e.item.get("Директор.Имя")&&e.item.get("Директор.Отчество")&&(a+=' <span class="edo-CompaniesTemplate_director">'+t(s(m.escapeHtml(e.item.get("Директор.Фамилия"))))+" "+t(s(String(e.item.get("Директор.Имя")).substr(0,1)))+". "+t(s(String(e.item.get("Директор.Отчество")).substr(0,1)))+".</span> "),a+=" ",e.item.get("Категория")&&(a+=' <span class="edo-CompaniesTemplate_activityCategory">'+t(s(m.escapeHtml(e.item.get("Категория"))))+"</span> "),a+=" </div> "),a+=" </div>",(a=t(a))+(n&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.CompaniesTemplate"}},e});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.CompaniesTemplate", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-CompaniesTemplate_inn{float:right;color:#999}.edo-CompaniesTemplate_kpp{float:right;color:#999;width:77px;height:20px;padding-left:5px;text-overflow:ellipsis;overflow:hidden}.edo-CompaniesTemplate_width0{width:0!important}.edo-CompaniesTemplate_region{color:#999;font-size:12px;padding-left:6px}.edo-CompaniesTemplate_director{color:#8991a9;margin-right:6px;font-size:14px}.edo-CompaniesTemplate_activityCategory{color:#999;font-size:12px}.edo-CompaniesTemplate_line2,.edo-CompaniesTemplate_line3{margin-left:12px}.edo-CompaniesTemplate_branchOf{color:#999;font-size:12px}.edo-CompaniesTemplate_ctrg-deceased{color:#bbb!important}"));head.appendChild(style);});}
define('js!SBIS3.EDO.CompaniesTemplate',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.CompaniesTemplate','Core/helpers/string-helpers','css!SBIS3.EDO.CompaniesTemplate','Elektronnyj_dokumentooborot_localization'],function(e,t){'use strict';var n=e.extend({_dotTplFn:t,$protected:{_options:{name:'CompaniesTemplate'}},$constructor:function(){},init:function(){n.superclass.init.call(this);}});return n;});
define("html!SBIS3.EDO.PeopleTemplate",function(){var e=function(e){var t=function(){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},t=/&(?!#?\w+;)|<|>|"|'|\//g;return function(n){return n?n.toString().replace(t,function(t){return e[t]||t}):n}}(),n=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;e.test(t);)t=t.replace(e,"&#123;&#123;$1&#125;&#125;");return t}}(),r=function(e){return e.join?e.join(""):e.toString()},o=function(e){return void 0===e?"":e&&"object"==typeof e?r(e):""+e},i="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,"<div> "),l=e.item,p=global.requirejs("Core/helpers/transport-helpers"),s=l.get("Персона")?p.prepareGetRPCInvocationURL("Персона","ФотоПерсоны",{"Персона":l.get("Персона"),"МинСторона":40}):p.prepareGetRPCInvocationURL("ЧастноеЛицо","ПолучитьФото_mini",{"ИдО":l.get("@Лицо")}),d=l.get("Фамилия")+" "+l.get("Имя")+" "+l.get("Отчество"),u=l.get("Название").trim()||"[Отсутсвтует имя]",c=l.get("ИНН"),f=l.get("Должность"),g=l.get("Персона")?l.get("Подразделение"):"(отсутствует доступ в систему)";return a+=' <img class="edo-PeopleTemplate_photo" src="'+n(o(s))+'"/> <div> <div> <span class="edo-PeopleTemplate_name" title="'+n(o(t(d)))+'">'+n(o(t(u)))+'</span> <span class="edo-PeopleTemplate_post" title="'+n(o(t(f)))+'">'+n(o(t(f)))+"</span> ",c&&(a+=' <div class="edo-PeopleTemplate_inn" title="'+n(o(c))+'"> <span>'+n(o(c))+"</span> </div> "),a+=' </div> <div> <div class="edo-PeopleTemplate_department" title="'+n(o(t(g)))+'">'+n(o(t(g)))+"</div> </div> </div> </div>",(a=n(a))+(i&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.PeopleTemplate"}},e});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.PeopleTemplate", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-PeopleTemplate_department{font-size:12px;color:#999;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.edo-PeopleTemplate_name{white-space:nowrap;max-width:58%;text-overflow:ellipsis;overflow:hidden}.edo-PeopleTemplate_inn{float:right;font-size:12px;color:#999;margin-right:8px}.edo-PeopleTemplate_post{font-size:12px;color:#999;margin-left:8px;white-space:nowrap;max-width:28%;text-overflow:ellipsis;overflow:hidden}.edo-PeopleTemplate_photo{float:left;margin-right:4px}"));head.appendChild(style);});}
define('js!SBIS3.EDO.PeopleTemplate',['SBIS3.CONTROLS/CompoundControl','Core/helpers/transport-helpers','html!SBIS3.EDO.PeopleTemplate','css!SBIS3.EDO.PeopleTemplate','Elektronnyj_dokumentooborot_localization'],function(e,t){'use strict';var o=e.extend({_dotTplFn:t,$protected:{_options:{name:'PeopleTemplate'}},$constructor:function(){},init:function(){o.superclass.init.call(this);}});return o;});
define('js!SBIS3.EDO.AutocompleteHandlers',['html!SBIS3.EDO.AutocompleteHandlers/resources/AutocompleteTemplate','Core/ContextBinder','SBIS3.CONTROLS/Suggest/SuggestView','js!SBIS3.EDO.CompaniesTemplate','js!SBIS3.EDO.PeopleTemplate','SBIS3.CONTROLS/DataGridView','SBIS3.CONTROLS/Link','Elektronnyj_dokumentooborot_localization'],function(e,t){'use strict';var o,n=null,i=null,r=false,l='',s='ФильтрИзСписка';return o={autocompleteTemplate:e,setProcessingAutocompletion:function(e,o,r){if(n=e.getChildControlByName('browserSearch'),i=e.getChildControlByName('browserView'),s=o||'ФильтрИзСписка',r){var l=new t();l.defineBinding('text','searchFormField','','fromContext'),l.bindControl(n,e.getLinkedContext(),'syncControl');}},onListItemSelect:function(e,t,o){r=true,l=t.get('Название');},onSearch:function(e,t){var o=i.getFilter();if(r){if(o[s]='Да',i.setFilter(o,true),r=false,l)n.setText(l),i.setHighlightText(l);}else o[s]='Нет',i.setFilter(o,true);},onReset:function(e){var t=i.getFilter();r=false,t[s]='Нет',i.setFilter(t,true);},onBeforeDataLoadCompaniesTab:function(e,t){if(t.usePages)t['Источник']=1,t['ShowLiquid']=true;},onBeforeDataLoadPeopleTab:function(e,t){if(t.usePages)t['сущности']=['сотрудники','физлица'];}};});
define('js!SBIS3.EDO.MarkHandlers',['WS.Data/Chain','WS.Data/Collection/Factory/List','Elektronnyj_dokumentooborot_localization'],function(e,t){'use strict';return{onSelectedItemsChange:function(e,t,r){var n=e._options.linkedView,a=n.getSelectedItems(),u;if(r.length)u=a.getCount()?a:n.getItems();if(u&&u.getCount())t.call(e,n,u);},getSelectedItems:function(e){var t=e.getSelectedKeys(),r=e.getDataSet(),n=[];for(var a in t)if(t.hasOwnProperty(a))n.push(r.getRecordByKey(t[a]));return n;},hasLeafInSelected:function(e,t){if(!t&&e.getCount())return true;for(var r=0;r<e.getCount();r++)if(!e.at(r).get(t+'@'))return true;return false;},hasFolderInSelected:function(e,t){if(!t)return false;for(var r=0;r<e.getCount();r++)if(e.at(r).get(t+'@'))return true;return false;},hasDelegatedFolderInSelected:function(e){for(var t=0;t<e.getCount();t++)if(e.at(t).get('Переназначение')||!e.at(t).get('МояПапка'))return true;return false;},hasNotDelegatedInSelected:function(e){for(var t=0;t<e.getCount();t++)if(!e.at(t).get('Переназначение')&&e.at(t).get('МояПапка'))return true;return false;},checkRight:function(e){for(var t=false,r=0;r<e.getCount();r++){try{t=e.at(r).get('РП.Документ').get('РазрешенныеДействия').get('Удаление');}catch(e){t=false;}if(t)break;}return t;},hasRemovedInSelected:function(e,t){for(var r=false,n=0;n<e.getCount();n++)if(r=!e.at(n).get(t+'@')&&e.at(n).get('Удален')?true:r,r)break;return r;},hasUnreadedInSelected:function(e){for(var t=0;t<e.getCount();t++)if(false===e.at(t).get('РП.Просмотрен'))return true;return false;},getFirstGoodPassage:function(e,t){for(var r,n,a,u,o=0;o<e.getCount();o++)if(u=e.at(o),!u.get(t+'@')&&u.get('РП.Переходы')&&u.get('РП.Переходы').getCount()>0){a=u.get('РП.Переходы');for(var f=0;f<a.getCount();f++)if(n=a.at(f).get('ДляМассовыхОпераций'),n){r=a.at(f).get('Название');break;}if(r)break;}return r;},hasPostingDocTypesInSelection:function(e,t){for(var r=false,n=0;n<e.getCount();++n){if(e.at(n).get(t+'@'))continue;if(e.at(n).get('ТипДокумента.ФлагиТипаДокумента')){if(e.at(n).get('ТипДокумента.ФлагиТипаДокумента').get('ПроводитьДокументы'))r=true;break;}}return r;},getFirstDocTypeInSelection:function(e){for(var t,r=0;r<e.getCount();r++){if(e.at(r).get('ТипДокумента.ТипДокумента'))if(t={},t.docType=e.at(r).get('ТипДокумента.ТипДокумента'),t.docSubType=null,e.at(r).get('ТипДокумента.ПодТипДокумента'))t.docSubType=e.at(r).get('ТипДокумента.ПодТипДокумента')||null;if(t)break;}return t;},excludeLeaf:function(r,n){return e(r).filter(function(e){return e.get(n+'@');}).value(t);},excludeFolder:function(r,n){return e(r).filter(function(e){return!e.get(n+'@');}).value(t);},toArray:function(t){return e(t).toArray();}};});
define('js!SBIS3.EDO.OperationMassAccounting',['WS.Data/Source/SbisService','WS.Data/Entity/Record','Core/Indicator','Core/EventBus','Core/ParallelDeferred','Core/Deferred','SBIS3.CONTROLS/Menu/MenuLink','Deprecated/Controls/DialogAlert/DialogAlert','js!SBIS3.EDO.MarkHandlers','WS.Data/Collection/RecordSet','i18n!SBIS3.EDO.OperationMassAccounting','Elektronnyj_dokumentooborot_localization'],function(e,t,n,a,i,r,o,s,c,l){'use strict';var u=o.extend({$protected:{_options:{name:'massAccounting',caption:rk('Проводки'),hierField:'parent',items:[{id:'post',name:'btnPost',title:rk('Провести'),icon:'sprite:icon-24 icon-Successful icon-primary'},{id:'cancelPost',name:'btnCancelPost',title:rk('Отменить проведение'),icon:'sprite:icon-24 icon-Undo2 icon-primary'},{id:'changeOper',name:'btnChangeOperation',title:rk('Сменить операцию'),icon:'sprite:icon-24 icon-DK icon-primary'}]},_docTypeInfo:{},_accountingMenu:null,_isAccountingOn:false,_hasMarkPlusRights:false,_hasCloseChangesRigths:false},$constructor:function(){this.subscribe('onMenuItemActivate',this._onMenuItemActivate.bind(this)),this.changeSelectionHandlerDebounce=this._changeSelectionHandler.debounce(100,true);},init:function(){u.superclass.init.call(this),this._checkIfAccountingOn(),this._getMarksRights().addCallback(function(e){this._hasCloseChangesRigths=e.close,this._hasMarkPlusRights=e.plus;}.bind(this));},onSelectedItemsChange:function(e){c.onSelectedItemsChange(this,this.changeSelectionHandlerDebounce,e);},_onMenuItemActivate:function(e,t){if(this[t])this[t].apply(this);else if(-1!==t.indexOf('_rule'))this._changeOperationForSelectedDocs(t);},_getMarksRights:function(t){return new i({steps:[new e({endpoint:'ПроверкаПрав'}).call('НаличиеДействия',{'Действие':'Закрытие документов от изменений'}),new e({endpoint:'ПроверкаПрав'}).call('НаличиеДействия',{'Действие':'Пометка документов плюсом'})]}).done().getResult().addCallback(function(e){return{close:2===e[0].getScalar(),plus:2===e[1].getScalar()};});},post:function(){var r=this,o=r._options.linkedView,c=o.getSelectedItems(),l=new i();n.setMessage(rk('Проведение...')),n.show();for(var u=0,d=0,g=0,f=0,p=0,h=0,k=[],b=[],y=[],_='',v=[],I=[],C=c.getCount()-1;C>=0;C--){if(c.at(C).get((o.getParentProperty&&o.getParentProperty())+'@')){I.push(c.at(C).getId());continue;}if(c.at(C).get('Удален')){h++,I.push(c.at(C).getId());continue;}var S=false;if(c.at(C).get('ТипДокумента.ФлагиТипаДокумента'))S=c.at(C).get('ТипДокумента.ФлагиТипаДокумента').get('ПроводитьДокументы')||false;if(!S){g++;continue;}if(c.at(C).get('ДокументРасширение.Состояние')){var w=c.at(C).get('ДокументРасширение.Состояние').get('Проведен'),m=c.at(C).get('ДокументРасширение.Состояние').get('ЗакрытОтИзменений'),R=c.at(C).get('ДокументРасширение.Состояние').get('ОтметкаПлюсом'),P=parseInt(c.at(C).get('@Документ'),10),M=c.at(C).getId(),D=c.at(C).get('Регламент')?c.at(C).get('Регламент'):null;if(m&&!r._hasCloseChangesRigths){f++;continue;}if(R&&!r._hasMarkPlusRights){p++;continue;}if(!w){var O={};O.pkDoc=P,O.rowkey=M,O.pkRule=D,y.push(O);}else k.push(P),b.push(M);}}if(y&&y.length>0){for(var T=function(n,a,i){var r=new t({rawData:{_type:'record',d:[parseInt(n,10)],s:[{n:'@Документ',t:'Число целое'}]},adapter:'adapter.sbis'});return new e({endpoint:'Документ'}).call('Провести',{'Документ':r,'Событие':null}).addCallback(function(e){if(e.getScalar())u++,I.push(a),v.push(n);else d++;}).addErrback(function(e){if(!_)_=e.message;d++;});},A=function(e,t){var n=e.createDependent();return n.addBoth(function(){return T(t.pkDoc,t.rowkey,t.pkRule);}),n;},E=[],B=0;B<y.length;++B){var V=y[B];if(!V.pkDoc||!parseInt(V.pkDoc,10))continue;if(0===B){var F=T(V.pkDoc,V.rowkey,V.pkRule);E.push(F);}else{var H=A(E[B-1],V);E.push(H);}}if(E&&E.length>0)l.push(E[E.length-1]);}if(k&&k.length>0){var j=function(t,n){return new e({endpoint:'Документ'}).call('ПерепровестиДокументы',{'Документы':t}).addCallback(function(e){if(o.removeItemsSelection(n),u+=e.getRow().get('Успешно'),d+=e.getRow().get('Ошибки'),!_&&e.getRow().get('ТекстПервойОшибки'))_=e.getRow().get('ТекстПервойОшибки');return e.getRow();}).addErrback(function(){d+=t.length;});};l.push(j(k,b));}return l.done().getResult().addCallback(function(){o.removeItemsSelection(I);var e=o.getTopParent();if(e&&e.hasChildControlByName('PartialReloader'))a.channel('EdoPartialReloader').notify('onChangePostState',{id:o.getId(),docsPosted:v,docsReposted:k,postState:true});else o.reload();n.hide();var t=rk('Проведено')+': '+u,i;if(d||g||f||p||h){if(t+='</br/>'+rk('Не проведено')+': '+(d+g+f+p+h),i=rk('По причине')+':',d)i+='<br/>'+rk('Ошибка при проведении')+': '+d;if(g)i+='<br/>'+rk('Тип документа не проводится')+': '+g;if(f)i+='<br/>'+rk('Закрыты от изменений')+': '+f;if(p)i+='<br/>'+rk('Помечены плюсом')+': '+p;if(h)i+='<br/>'+rk('Удалены')+': '+h;if(d&&_)i+='<br/><span style="color:#ff0000;">'+_+'</span>';}return new s({type:'info',message:t,detail:i}).show(),u;});},cancelPost:function(){var r=this,o=r._options.linkedView,c=o.getSelectedItems(),l=new i(),u=function(n,a){var i=new t({rawData:{_type:'record',d:[parseInt(n,10)],s:[{n:'@Документ',t:'Число целое'}]},adapter:'adapter.sbis'});return new e({endpoint:'Документ'}).call('ОтменитьПроведение',{'Документ':i,'Событие':null}).addCallback(function(e){if(e.getScalar())g++,y.push(n),_.push(a);else f++;}).addErrback(function(e){if(!b)b=e.message;f++;});},d=function(e,t,n){var a=e.createDependent();return a.addBoth(function(){return u(t,n);}),a;};n.setMessage(rk('Отмена проведения...')),n.show();for(var g=0,f=0,p=0,h=0,k=0,b,y=[],_=[],v=[],I=0,C=0;C<c.getCount();C++){if(c.at(C).get((o.getParentProperty&&o.getParentProperty())+'@')){_.push(c.at(C).getId());continue;}if(c.at(C).get('ДокументРасширение.Состояние')){var S=c.at(C).get('ДокументРасширение.Состояние').get('Проведен'),w=c.at(C).get('ДокументРасширение.Состояние').get('ЗакрытОтИзменений'),m=c.at(C).get('ДокументРасширение.Состояние').get('ОтметкаПлюсом');if(w&&!r._hasCloseChangesRigths){h++;continue;}if(m&&!r._hasMarkPlusRights){k++;continue;}if(S){var R=parseInt(c.at(C).get('@Документ'),10);if(0===I){var P=u(R,c.at(C).getId());v.push(P);}else{var M=d(v[I-1],R,c.at(C).getId());v.push(M);}I++;}else p++,_.push(c.at(C).getId());}}if(v&&v.length>0)l.push(v[v.length-1]);return l.done().getResult().addCallback(function(){o.removeItemsSelection(_);var e=o.getTopParent();if(e&&e.hasChildControlByName('PartialReloader'))a.channel('EdoPartialReloader').notify('onChangePostState',{id:o.getId(),docs:y,postState:false});else o.reload();n.hide();var t=rk('Проведение отменено')+': '+g,i;if(f||p||h||k){if(t+='</br/>'+rk('Проведение не отменено')+': '+(f+p+h+k),i=rk('По причине')+':',p)i+='<br/>'+rk('Не проведены')+': '+p;if(f)i+='<br/>'+rk('С ошибками')+': '+f;if(h)i+='<br/>'+rk('Закрыты от изменений')+': '+h;if(k)i+='<br/>'+rk('Помечены плюсом')+': '+k;if(f&&b)i+='<br/><span style="color:#ff0000;">'+b+'</span>';}return new s({type:'info',message:t,detail:i}).show(),g;});},_changeSelectionHandler:function(e,t){if(this._isAccountingOn)if(c.hasPostingDocTypesInSelection(t,e.getParentProperty&&e.getParentProperty())){this.show();var n=c.getFirstDocTypeInSelection(t);if(n)if(!this._docTypeInfo||n.docType!==this._docTypeInfo.docType||n.docSubType!==this._docTypeInfo.docSubType)this._docTypeInfo=n,this._fillRulesMassMenu();}else this.hide();else this.hide();},_checkIfAccountingOn:function(){var t=this;new e({endpoint:'ПараметрыДокументооборота'}).call('ВедетсяУчет',{}).addCallback(function(n){if(!n.getScalar())t._isAccountingOn=n.getScalar();else new e({endpoint:'ПроверкаПрав'}).call('НаличиеДействия',{'Действие':'Проведение документов'}).addCallback(function(e){t._isAccountingOn=2===e.getScalar();}).addErrback(function(){t._isAccountingOn=false;});}).addErrback(function(){t._isAccountingOn=false;});},_fillRulesMassMenu:function(){var t=this,n=new r();if(!t._docTypeInfo||!t._docTypeInfo.docType)return void t._setChangeOperationVisibility(false);var a=t.createFilterRecord([],[{docType:t._docTypeInfo.docType,docSubType:t._docTypeInfo.docSubType||null}]),i;new e({endpoint:'Regulation'}).call('List',{'Фильтр':a}).addCallback(function(e){if(e.getRow().get('Регламент'))i=e.getRow().get('Регламент'),n.callback();}).addErrback(function(){n.callback();}),n.addCallback(function(){if(!i||0===i.getCount())return void t._setChangeOperationVisibility(false);var e=t._createRulesMenu(i,null),n=[{id:'post',name:'btnPost',title:rk('Провести'),icon:'sprite:icon-24 icon-Successful icon-primary'},{id:'cancelPost',name:'btnCancelPost',title:rk('Отменить проведение'),icon:'sprite:icon-24 icon-Undo2 icon-primary'},{id:'changeOper',name:'btnChangeOperation',title:rk('Сменить операцию'),icon:'sprite:icon-24 icon-DK icon-primary'}];t.setItems(n.concat(e)),t._setChangeOperationVisibility(true);});},_setChangeOperationVisibility:function(e){var t=this;try{if(!e)t._getAccountingMenu()['changeOper'].hide();else t._getAccountingMenu()['changeOper'].show();}catch(e){}},_getAccountingMenu:function(){var e=this;if(e._accountingMenu)return e._accountingMenu;return e._accountingMenu=e.getItemsInstances(),e._accountingMenu;},_createRulesMenu:function(e,t){for(var n=this,a=[],i=0;i<e.getCount();++i){var r=e.at(i),o=r.get('Раздел'),s=r.get('Раздел@')||false;if(o!==t)continue;var c={},l=r.get('Идентификатор')+'_rule';if(c.id=l,c.name=l,c.title=r.get('Название'),c.tooltip='',c.parent='changeOper',s){var u=r.get('Идентификатор'),d=n._createRulesMenu(e,u);if(c.id=u,d&&d.length>0)for(var g=0;g<d.length;g++)d[g].parent=c.id,a.push(d[g]);}a.push(c);}return a;},_changeOperationForSelectedDocs:function(t){var r=this,o=r._options.linkedView,c=o.getSelectedItems(),l=t.split('_')[0],u=new i(),d=[],g=[],f=0;if(!l)return;n.setMessage(rk('Смена операции...')),n.show();for(var p=0,h=0,k=0,b=0,y=0,_=0,v=[],I='',C=function(t,n,a){return new e({endpoint:'Документ'}).call('ChangeRule',{'Документ':t.getRawData(),'ИдРегламента':l,'МассоваяСмена':true}).addCallback(function(e){p++,g.push(a),v.push(n);}).addErrback(function(e){if(h++,!I)I=e.message;});},S=function(e,t,n,a){var i=e.createDependent();return i.addBoth(function(){return C(t,n,a);}),i;},w=0;w<c.getCount();w++){var m=c.at(w);if(c.at(w).get((o.getParentProperty&&o.getParentProperty())+'@')){g.push(c.at(w).getId());continue;}if(c.at(w).get('ДокументРасширение.Состояние')){if(c.at(w).get('ДокументРасширение.Состояние').get('Входящий')){b++;continue;}var R=c.at(w).get('ДокументРасширение.Состояние').get('ЗакрытОтИзменений'),P=c.at(w).get('ДокументРасширение.Состояние').get('ОтметкаПлюсом');if(R&&!r._hasCloseChangesRigths){y++;continue;}if(P&&!r._hasMarkPlusRights){_++;continue;}}var M,D;if(c.at(w).get('ТипДокумента.ТипДокумента'))M=c.at(w).get('ТипДокумента.ТипДокумента');if(D=c.at(w).get('ТипДокумента.ПодТипДокумента')?c.at(w).get('ТипДокумента.ПодТипДокумента'):null,r._docTypeInfo.docType!==M||r._docTypeInfo.docSubType!==D){k++;continue;}var O=parseInt(c.at(w).get('@Документ'),10);if(0===f){var T=C(m,O,c.at(w).getId());d.push(T);}else{var A=S(d[f-1],m,O,c.at(w).getId());d.push(A);}f++;}if(d&&d.length>0)u.push(d[d.length-1]);return u.done().getResult().addCallback(function(){o.removeItemsSelection(g);var e=o.getTopParent();if(e&&e.hasChildControlByName('PartialReloader'))a.channel('EdoPartialReloader').notify('onChangeOperation',{id:o.getId(),docs:v});else o.reload();n.hide();var t=rk('Изменено')+': '+p,i;if(h||k||b||y||_){if(t+='</br/>'+rk('Не изменено')+': '+(h+k+b+y+_),i=rk('По причине')+':',h)i+='<br/>'+rk('С ошибками')+': '+h;if(k)i+='<br/>'+rk('Операция не соответствует типу документа')+': '+k;if(b)i+='<br/>'+rk('Нельзя изменить операцию для документов, поступивших в электронном виде')+': '+b;if(y)i+='<br/>'+rk('Закрыты от изменений')+': '+y;if(_)i+='<br/>'+rk('Помечены плюсом')+': '+_;if(h&&I)i+='<br/><span style="color:#ff0000;">'+I+'</span>';}return new s({type:'info',message:t,detail:i}).show(),p;});},_menuItemActivated:function(e,t){this._currentItem=t,massAccounting._getAccountingMenu();},createFilterRecord:function(e,n){var a=new t({rawData:{_type:'record',d:[],s:[{n:'Действующий',t:'Логическое'},{n:'СпособыСоздания',t:{n:'Массив',t:'Число целое'}},{n:'ТипДокумента',t:'Выборка'},{n:'КлючиТиповДокументов',t:{n:'Массив',t:'Число целое'}},{n:'ПоказыватьПустыеПапки',t:'Логическое'},{n:'ПроверитьДоступ',t:'Логическое'}]},adapter:'adapter.sbis'});if(a.set('Действующий',true),a.set('СпособыСоздания',[0,2]),a.set('ПоказыватьПустыеПапки',false),a.set('ПроверитьДоступ',true),e&&e instanceof Array)a.set('КлючиТиповДокументов',e);var i=new l({adapter:'adapter.sbis'});if(n)for(var r=0,o=n.length;r<o;r++){var s=n[r],c=new t({rawData:{_type:'record',d:[],s:[{n:'Тип',t:'Строка'},{n:'ПодТип',t:'Строка'}]},adapter:'adapter.sbis'});if('object'===typeof s)c.set('Тип',s['docType']||null);if('object'===typeof s)c.set('ПодТип',s['docSubType']||null);i.add(c);}return a.set('ТипДокумента',i),a;}});return u;});
define('js!SBIS3.EDO.OperationDelete',['Core/core-attach','WS.Data/Source/SbisService','Core/helpers/fast-control-helpers','Core/Indicator','Core/EventBus','Core/ParallelDeferred','SBIS3.CONTROLS/Link','js!SBIS3.EDO.MarkHandlers','i18n!SBIS3.EDO.OperationDelete','Elektronnyj_dokumentooborot_localization'],function(e,t,r,o,n,i,a,s){'use strict';var l=a.extend({$protected:{_options:{name:'delete',icon:'sprite:icon-24 icon-Erase icon-error',caption:rk('Удалить'),tooltip:rk('Удалить отмеченные'),fromCart:false,onlyFolder:false,onlyLeaf:false,destFolderName:''}},$constructor:function(){this.changeSelectionHandlerDebounce=this._changeSelectionHandler.debounce(100,true);},init:function(){l.superclass.init.call(this);},onSelectedItemsChange:function(e){s.onSelectedItemsChange(this,this.changeSelectionHandlerDebounce,e);},_changeSelectionHandler:function(e,t){if(!s.checkRight(t))this.hide();},_clickHandler:function(){var e=this._options.linkedView,t=e.getParentProperty&&e.getParentProperty();if(s.hasRemovedInSelected(e.getSelectedItems(),t)||e.getFilter()['ФильтрУдаленные'])this.eraseFromCart();else this.moveToTrash();},moveToTrash:function(){var e=this,t=e._options.linkedView,r=t.getSelectedItems(),o=t.getParentProperty&&t.getParentProperty();if('events'==e._options.registryMode)require(['js!SBIS3.EDO.EdoOperationsCommon'],function(o){o.deleteToTrash(t,r,{destFolderName:e._options.destFolderName});});else require(['js!SBIS3.EDO.EdoRecOptionsMini'],function(o){o.deleteToTrash(t,r,{destFolderName:e._options.destFolderName,countRecords:r.getCount()});});},eraseSelectedDocs:function(a,s){var l=new i();e.attachInstance('Deprecated/Controls/DialogConfirm/DialogConfirm',{resizable:false,message:rk('Восстановление документов будет невозможно. Продолжить?'),handlers:{onConfirm:function(e,i){if(true===i){var c=s.getEnumerator(),d=c.getNext(),u=s.getCount(),h=function(e){return new t({endpoint:e.get('ТипДокумента.ТипДокумента')}).call('Удалить',{'ИдО':[parseInt(e.get('@Документ'),10)]}).addCallback(function(t){if(t.getScalar())S.push(e.getId()),m.push(parseInt(e.get('@Документ'),10)),g++;}).addErrback(function(e){p.push(rk('Ошибка при удалении документа')+': '+e.message),f++;});},g=0,f=0,p=[],S=[],m=[];o.setMessage(rk('Удаление из корзины...')),o.show();while(d){if(d.get('@Документ')&&(d.get('Удален')||a.getFilter()['ФильтрУдаленные'])&&d.get('ТипДокумента.ТипДокумента')&&d.get('ТипДокумента.ТипДокумента').length>0)l.push(h(d));d=c.getNext();}return l.done().getResult().addCallback(function(){var e=a.getTopParent(),t=e&&e.hasChildControlByName('PartialReloader');if(o.hide(),a.removeItemsSelection(S),t)n.channel('EdoPartialReloader').notify('onDeleteFromTrash',{id:a.getId(),docs:m});else a.reload();if(f)r.openErrorsReportDialog({numSelected:u,numSuccess:g,errors:p,title:rk('Итоги операции')+': "'+rk('Удаление документов из корзины')+'"'});});}}}});},eraseFromCart:function(){var e=this._options.linkedView,t=e.getSelectedItems(),r=e.getParentProperty&&e.getParentProperty();if('events'==this._options.registryMode)require(['js!SBIS3.EDO.EdoOperationsCommon'],function(r){r.deleteToTrash(e,t,{eraseFromCart:true});});else this.eraseSelectedDocs(e,t);}});return l;});
define('js!SBIS3.EDO.OperationRestore',['SBIS3.CONTROLS/Link','js!SBIS3.EDO.MarkHandlers','i18n!SBIS3.EDO.OperationRestore','Elektronnyj_dokumentooborot_localization'],function(e,t){'use strict';var n=e.extend({$protected:{_options:{name:'restore',icon:'sprite:icon-24 icon-Restore icon-done icon-restore-docs',tooltip:rk('Восстановить документы'),caption:rk('Восстановить')}},$constructor:function(){this.changeSelectionHandlerDebounce=this._changeSelectionHandler.debounce(100,true);},init:function(){n.superclass.init.call(this);},onSelectedItemsChange:function(e){t.onSelectedItemsChange(this,this.changeSelectionHandlerDebounce,e);},_changeSelectionHandler:function(e,n){if(t.checkRight(n)&&(t.hasRemovedInSelected(n,e.getParentProperty&&e.getParentProperty())||e.getFilter()['ФильтрУдаленные']))this.show();else this.hide();},_clickHandler:function(){var e=this;require(['WS.Data/Source/SbisService','Core/Indicator','Core/EventBus','Core/ParallelDeferred'],function(t,n,r,o){var i=e._options.linkedView,a=i.getFilter()['ФильтрУдаленные'],s=new o(),c=i.getSelectedItems(),l=c.getCount(),d=c.getEnumerator(),g=d.getNext(),u=function(e){var n={'ключДокумента':parseInt(e.get('ИдРедакции')?e.get('ИдРедакции'):e.get('@Документ'),10)},r=e.get('МетодВосстановления')&&e.get('@Событие'),o=r?e.get('МетодВосстановления'):'Восстановить',i=r?g.get('@Событие'):null,a=e.get('@Документ');if(i)n['идСобытия']=i;return new t({endpoint:'Документ'}).call(o,n).addCallback(function(t){if(t.getScalar()&&t.getScalar().length>0)p.push(rk('Не удалось восстановить документ \u2116')+e.get('Номер')+': '+t.getScalar()),S++;else k.push(parseInt(a,10)),f.push(e.getId()),h++;}).addErrback(function(t){p.push(rk('Не удалось восстановить документ \u2116')+e.get('Номер')+': '+t.message),S++;});},h=0,S=0,p=[],f=[],k=[];n.setMessage(rk('Восстановление...')),n.show();while(g){if(g.get('@Документ')&&(g.get('Удален')||a))s.push(u(g));g=d.getNext();}return s.done().getResult().addCallback(function(){var e=i.getTopParent(),t=e&&e.hasChildControlByName('PartialReloader');if(n.hide(),i.removeItemsSelection(f),t)r.channel('EdoPartialReloader').notify('onRestoreFromTrash',{id:i.getId(),docs:k});else i.reload();if(S)require(['Core/helpers/fast-control-helpers'],function(e){e.openErrorsReportDialog({numSelected:l,numSuccess:h,errors:p,title:rk('Итоги операции')+': "'+rk('Восстановление документов')+'"'});});r.channel('DeleteChannel').notify('restoreFromTrash',f);});});}});return n;});
define("html!SBIS3.EDO.OperationAddMark",function(){var o=function(o){var n=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;o.test(n);)n=n.replace(o,"&#123;&#123;$1&#125;&#125;");return n}}(),t=function(o){return o.join?o.join(""):o.toString()},e=function(o){return void 0===o?"":o&&"object"==typeof o?t(o):""+o},r="undefined"!=typeof process,p=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="edo-OperationAddMark');return o.onlyMarks&&(p+=" onlyMarks"),p+='"> <component data-component="SBIS3.CONTROLS/Menu/MenuLink"> <opt name="name">edoLockButton</opt> <opt name="idProperty">id</opt> <opt name="visible">'+n(e(!o.onlyMarks))+'</opt> <opt name="icon">sprite:icon-16 icon-Successful icon-disabled</opt> <opt name="caption">'+n(e(rk("Закрыть / открыть")))+'</opt> <opts name="items" type="array"> <opts> <opt name="id">lock</opt> <opt name="icon">sprite:icon-16 icon-Successful icon-disabled</opt> <opt name="title">'+n(e(rk("Закрыть от изменений")))+'</opt> <opt name="command">edoLockDocs</opt> </opts> <opts> <opt name="id">unlock</opt> <opt name="icon">sprite:icon-16 icon-Redo2 icon-primary</opt> <opt name="title">'+n(e(rk("Открыть для изменений")))+'</opt> <opt name="command">edoUnlockDocs</opt> </opts> </opts> </component> <component data-component="SBIS3.CONTROLS/Link" class="edo-MarksButton"> <opt name="name">edoMarksButton</opt> <opt name="icon">sprite:icon-16 icon-Remark icon-primary</opt> <opt name="caption">'+n(e(rk("Пометить")))+'</opt> <opt name="command">edoShowSelectMarksDialog</opt> </component> </div>',(p=n(p))+(r&&-1!==p.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.OperationAddMark"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.OperationAddMark", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-OperationAddMark{display:inline-block}.edo-OperationAddMark:not(.onlyMarks) .edo-MarksButton{margin-left:8px}"));head.appendChild(style);});}
define('js!SBIS3.EDO.OperationAddMark',['Lib/Control/FloatArea/FloatArea','SBIS3.CONTROLS/CompoundControl','Core/core-extend','Core/Indicator','Core/EventBus','Core/ParallelDeferred','Core/Deferred','Core/CommandDispatcher','Core/ClientsGlobalConfig','html!SBIS3.EDO.OperationAddMark','SBIS3.CONTROLS/Utils/InformationPopupManager','WS.Data/Source/SbisService','WS.Data/Adapter/Sbis','SBIS3.CONTROLS/Menu/MenuLink','SBIS3.CONTROLS/Link','css!SBIS3.EDO.OperationAddMark','i18n!SBIS3.EDO.OperationAddMark','Elektronnyj_dokumentooborot_localization'],function(e,t,n,a,o,r,i,s,l,d,c,u,h){'use strict';return n(t,[],{_dotTplFn:d,$protected:{_options:{name:'addMark',eventsReestr:false,onlyMarks:false,linkedView:void 0,visible:false},_rights:{plus:null,lock:null},_controls:{lockButton:null,marksButton:null},_marksNames:{checked:false,value:null}},$constructor:function(){s.declareCommand(this,'edoShowSelectMarksDialog',this._showSelectMarksDialog),s.declareCommand(this,'edoLockDocs',function(){this.setLockStatus(true);}),s.declareCommand(this,'edoUnlockDocs',function(){this.setLockStatus(false);}),this._getRights().addCallback(function(e){if(this._rights=e,this._controls.lockButton=this.getChildControlByName('edoLockButton'),this._controls.marksButton=this.getChildControlByName('edoMarksButton'),!e.lock)this._controls.lockButton.hide();}.bind(this)),this.changeSelectionHandlerDebounce=this._changeSelectionHandler.debounce(100,true);},onSelectedItemsChange:function(e){this.changeSelectionHandlerDebounce();},_changeSelectionHandler:function(){var e=this._options.linkedView,t=e.getSelectedItems(),n='hide';if(t&&t.getCount())if(this._filterList(t,function(t){return!Boolean(t.get((e.getParentProperty&&e.getParentProperty())+'@'));}).length)n='show';this[n]();},_filterList:function(e,t){return e.toArray().filter(t);},_showSelectMarksDialog:function(){var t=this._options.linkedView,n=t.getSelectedItems(),r=n.toArray(),s=r.filter(function(e){return e.get((t.getParentProperty&&t.getParentProperty())+'@');});if(s.length)t.removeItemsSelection(s.map(function(e){return e.getId();})),n=t.getSelectedItems(),r=n.toArray();for(var d=n.toArray().map(function(e){return+(e.get('РП.Документ')&&e.get('РП.Документ').get('ИдО')||e.get('@Документ')||e.get('Документ'));}),c=r.map(function(e){return e.getId();}),f=r.map(function(e){return e.get('Пометки')&&e.get('Пометки').slice(1)||[];}),g=[],k=0;k<6;k++){g[k]=Boolean(f[0][k]);for(var m=1;m<f.length;m++)if(Boolean(f[m][k])!==g[k]){g[k]=null;break;}}(function(e){if(e||this._marksNames.checked)return new i().callback(this._marksNames.value);else{var t=r[0].get('ТипДокумента.ТипДокумента');return l.getParam(['ПометкиНаДокументахДляРеестра',t].join('-')).addCallback(function(e){var t=null;if(e)t=JSON.parse(e).d.map(function(e){return e[1];});return this._marksNames.value=t,this._marksNames.checked=true,t;}.bind(this));}}.bind(this)(this._options.eventsReestr).addCallback(function(n){new e({template:'js!SBIS3.EDO2.MarksChoicePanel',name:'MarksChoicePanel',target:this.getChildControlByName('edoMarksButton').getContainer(),parent:this,offset:{x:0,y:-3},autoHeight:true,animation:'fade',autoCloseOnHide:true,isStack:false,autoHide:false,componentOptions:{plusRights:this._rights.plus,marksNames:n,marksStates:g,callback:function(e){a.setMessage('Устанавливаем пометки...'),new u({adapter:new h(),endpoint:'Документ'}).call('ЗаписатьПометкиДляСписка',{'Документы':d,'Пометки':e}).addCallback(function(){var e=t.getTopParent();if(e&&e.hasChildControlByName('PartialReloader'))a.hide(),o.channel('EdoPartialReloader').notify('onChangeWriteMode',{id:t.getId(),docs:c,writeMode:false});else t.reload().addCallback(function(){a.hide();});t.removeItemsSelection(c);}.bind(this)).addErrback(this._handleError);}.bind(this)}});}.bind(this)));},_getRights:function(){return new r({steps:[new u({endpoint:'ПроверкаПрав'}).call('НаличиеДействия',{'Действие':'Закрытие документов от изменений'}).addCallback(function(e){return 2===e.getScalar();}),new u({endpoint:'ПроверкаПрав'}).call('НаличиеДействия',{'Действие':'Пометка документов плюсом'}).addCallback(function(e){return 2===e.getScalar();})]}).done().getResult().addCallback(function(e){return{lock:e['0'],plus:e['1']};});},setLockStatus:function(e){var t=this._options.linkedView,n=t.getSelectedItems().toArray().map(function(e){return parseInt(e.get('@Документ'),10);});return a.setMessage(e?'Закрытие от изменений...':'Открытие для изменений...'),a.show(),new u({endpoint:'Документ'}).call('УстановитьСтатусЗакрытияОтИзмененийСписок',{Status:e,Ids:n}).addCallback(function(){var r=t.getTopParent();if(r&&r.hasChildControlByName('PartialReloader'))o.channel('EdoPartialReloader').notify('onChangeWriteMode',{id:t.getId(),docs:n,writeMode:false});else t.reload();a.hide(),c.showNotification({status:'success',caption:e?'Документы закрыты от изменений':'Документы открыты для изменений'});}).addErrback(this._handleError);},_handleError:function(e){return a.hide(),c.showMessageDialog({status:'error',message:e.message}),e;}});});
define('js!SBIS3.EDO.CD.AbstractUploader',['Core/Abstract','SbisDiskBase_localization'],function(e){'use strict';function t(){throw new Error('Abstract method not implemented.');}var r=e.extend({$protected:{_cache:{}},init:function(){r.superclass.init.call(this),this._publish('Progress','Complete','Error','TopFolderCreate');},destroy:function(){this._clearCache(),r.superclass.destroy.call(this);},upload:t,cancel:t,cancelAll:t,_notifyProgress:function(e,t){this._notify('Progress',e,t);},_notifyComplete:function(e,t){this._notify('Complete',e,t);},_notifyError:function(e,t){this._notify('Error',e,t);},_notifyTopFolderCreate:function(e,t,r){this._notify('TopFolderCreate',e,t,r);},_clearCache:function(e){if(e)this._cache[e]=null;else this._cache={};},_addToCache:function(e,t){this._cache[e]=t;},_getCache:function(e){return this._cache[e];},_parseSuccessResponse:function(e){var t,r={url:null,id:null,versionId:null};try{t=JSON.parse(e),r.url=t?t.href:null,r.id=t?t.fileid:null,r.versionId=t?t.versionid:null;}catch(e){}return r;},_parseErrorResponse:function(e,t){var r;try{r=JSON.parse(e);}catch(i){var n='';if(503===t)n=rk('Сервис СБИС.Диск недоступен, попробуйте выполнить операцию позже');else if(window.navigator&&false===window.navigator.onLine)n=rk('Отсутствует подключение к сети');else n=e||rk('Неизвестная ошибка');r={message:rk('Ошибка при загрузке файла средствами браузера'),details:n,status:t};}return r;}});return r;});
define('js!SBIS3.EDO.CD.BrowserUploader',['Core/core-functions','Core/helpers/collection-helpers','Core/Deferred','js!SBIS3.EDO.CD.AbstractUploader','SbisDiskBase_localization'],function(e,t,n,r){'use strict';return r.extend({upload:function(t,r){var o=new n(),s=this,a=this._options.remoteUrl,i,l,c;if(r)i=e.shallowClone(r),this._addToCache(t,i);else if(i=this._getCache(t),!i)return o.cancel();if(l=i.xhr=new XMLHttpRequest(),i.fileId)a+=i.fileId,c='PUT';else a+=i.folder,c='POST';function f(){if(l.readyState===XMLHttpRequest.DONE)if('POST'===c&&201===l.status||'PUT'===c&&200===l.status)s._clearCache(t),s._notifyComplete(t,s._parseSuccessResponse(l.responseText));else if(i.xhr)i.xhr=null,s._notifyError(t,s._parseErrorResponse(l.responseText,l.status));}function h(e){if(e.lengthComputable){var n=Math.min(99,Math.floor(100*e.loaded/e.total));s._notifyProgress(t,n);}}try{if(l.open(c,a,true),l.onreadystatechange=f,l.upload.addEventListener('progress',h,false),l.setRequestHeader('Content-Disposition','attachment; filename*=UTF-8\'\''+encodeURIComponent(i.fileName||i.file.name)),l.setRequestHeader('Content-Type',i.file.type||'application/octet-stream'),i.isFolder)l.setRequestHeader('X-OBJECT-FOLDER','true');l.send(window.File&&(i.file instanceof window.File||i.file instanceof window.Blob)?i.file:i.file.content),o.callback(t);}catch(e){o.errback(e);}return o;},cancel:function(e){var t=this._getCache(e),n=t&&t.xhr;if(n)t.xhr=null,n.abort();},cancelAll:function(){this._clearCache();},_clearCache:function(e){if(e)this._cache[e]=null;else t.forEach(this._cache,function(e){var t=e&&e.xhr;if(t)e.xhr=null,t.abort();}),this._cache={};}});});
define('js!SBIS3.EDO.CD.BigFileBrowserUploader',['Core/core-functions','Core/helpers/collection-helpers','Core/Deferred','js!SBIS3.EDO.CD.AbstractUploader','SbisDiskBase_localization'],function(e,r,t,n){'use strict';return n.extend({_partSize:10485760,_partSizeBig:78643200,_sendErrorLimit:5,_timeoutSendFileWithoutPlugin:10000,upload:function(r,n){var i=new t(),o=this,s=this._options.remoteUrl,a='',c,l,u;if(n)(c=e.shallowClone(n)).needStop=false,this._addToCache(r,c);else if(c=this._getCache(r),c.needStop=false,!c)return i.cancel();if(c.fileId)a=s+c.fileId,u='PUT';else a=s+c.folder,u='POST';var f=c.file.size>1073741824?o._partSizeBig:o._partSize;function d(){return o._httpRequest({url:s+'upload',requestType:'POST',successCode:200,errorLimit:o._sendErrorLimit,errorTimeOut:o._timeoutSendFileWithoutPlugin,headerObj:{'Content-Disposition':'attachment; filename*=UTF-8\'\''+encodeURIComponent(c.fileName||c.file.name),'X-Upload-Content-Type':c.file.type||'application/octet-stream','X-Upload-Content-Length':c.file.size,'Content-Type':'application/json;charset=utf-8'},sendBody:JSON.stringify({href:'https://'+location.hostname+a})});}function p(e,r){return o._httpRequest({url:r+'&part=new',requestType:'PUT',successCode:200,errorLimit:o._sendErrorLimit,errorTimeOut:o._timeoutSendFileWithoutPlugin,headerObj:{},sendBody:c.file.slice(e,e+f)});}function h(e){return o._httpRequest({url:e,requestType:u,successCode:200,errorLimit:o._sendErrorLimit,errorTimeOut:o._timeoutSendFileWithoutPlugin,headerObj:{}});}return d().addCallback(function(e){try{e=JSON.parse(e);}catch(t){o._notifyError(r,o._parseErrorResponse(e,200));}var t=e.href,n=0;(function e(){if(n<=c.file.size){var i=Math.min(99,Math.floor(100*n/c.file.size));if(o._notifyProgress(r,i),c.needStop)return;p(n,t).addCallbacks(e,function(e){o._notifyError(r,o._parseErrorResponse(e.message));}),n+=f;}else{if(c.needStop)return;h(t).addCallback(function(e){o._notifyComplete(r,o._parseSuccessResponse(e));}).addErrback(function(e){o._notifyError(r,o._parseErrorResponse(e.message));});}}());}).addErrback(function(e){o._notifyError(r,o._parseErrorResponse(e.message));}),i.callback(r),i;},cancel:function(e){var r=this._getCache(e),t=r&&r.xhr;if(t)r.xhr=null,t.abort();r.needStop=true;},cancelAll:function(){this._clearCache();},_clearCache:function(e){if(e)this._cache[e]=null;else r.forEach(this._cache,function(e){var r=e&&e.xhr;if(r)e.xhr=null,r.abort();e.needStop=true;}),this._cache={};},_httpRequest:function(e){var r=new t(),n=0;return i(),r;function i(){var t=new XMLHttpRequest();if(t.open(e.requestType,e.url,true),t.onreadystatechange=function(){if(t.readyState===t.DONE)if(t.status==e.successCode)r.callback(t.responseText);else if(n>=e.errorLimit)r.errback(t.responseText||rk('Непредвиденная ошибка при загрузке.'));else n++,setTimeout(i,e.errorTimeOut);},e.headerObj instanceof Object)for(var o in e.headerObj)if(e.headerObj.hasOwnProperty(o))t.setRequestHeader(o,e.headerObj[o]);t.send(e.sendBody);}}});});
define('js!SBIS3.EDO.CD.PluginUploader',['Core/helpers/collection-helpers','js!SBIS3.EDO.CD.AbstractUploader','js!SBIS3.BL.FileSD','Core/EventBus','Core/Deferred','browser!js!SBIS3.Plugin/Source/Helper/Helper','SbisDiskBase_localization'],function(i,e,t,o,a,s){'use strict';var l=e.extend({$protected:{_options:{checkProgressPeriod:1000},_actualGuids:{},rootId:null},init:function(){l.superclass.init.call(this);var i=o.channel('SbisPluginEvent');this.subscribeTo(i,'uploadToSbisDiskCompleteEvent',this._onUploadToSbisDiskCompleteEvent.bind(this)),this.subscribeTo(i,'uploadedChunkEvent',this._onUploadedChunkEvent.bind(this)),this.subscribeTo(i,'uploadToSbisDiskTopFolderCreatedEvent',this._onUploadToSbisDiskTopFolderCreatedEvent.bind(this)),this.subscribeTo(i,'uploadToSbisDiskErrorEvent',this._onUploadToSbisDiskErrorEvent.bind(this)),this.subscribeTo(i,'uploadToSbisDiskFatalErrorEvent',this._onUploadToSbisDiskFatalErrorEvent.bind(this));},destroy:function(){var i=this['_plugin'];function e(i){i.call('destroy',{});}if(i instanceof a)i.addCallback(e);else if(i&&!(i instanceof Error))e(i);this['_plugin']=null,l.superclass.destroy.call(this);},upload:function(i,e){var t=this,o=new a();if(e)this._addToCache(i,e);else if(e=this._getCache(i),!e)return o.cancel();function l(a){var l=location.protocol+'//'+location.host+t._options.remoteUrl+(e.fileId||e.folder),n=JSON.stringify({fileName:e.path,targetURL:l,AccountID:s.getAccountId(),newFileName:e.fileName,removeAfterUpload:!!e.removeAfterUpload});function r(e){t._setActualFileGuid(i,e),o.callback(i);}function d(i){o.errback(i);}if(e.folder)if(e.isFolder)a.call('uploadFolderToSbisDisk',{requestParams:n}).addCallbacks(r,d);else a.call('uploadToSbisDisk',{requestParams:n}).addCallbacks(r,d);else a.call('updateToSbisDisk',{requestParams:n}).addCallbacks(r,d);}function n(i){o.errback(i);}return this._getPlugin().addCallbacks(l,n),o;},cancel:function(i){var e=this;if(this._getCache(i))this._getPlugin().addCallback(function(o){var a=this._getActualFileGuid(i);if(o.call('cancelUploadToSbisDisk',{uploadGuid:a}),e._options.rootId)t.DeletePermanently(e._options.rootId);}.bind(this));},cancelAll:function(){var e=this;this._getPlugin().addCallback(function(o){if(i.forEach(e._cache,function(i,t){var a=e._getActualFileGuid(t);o.call('cancelUploadToSbisDisk',{uploadGuid:a});}),e._options.rootId)t.DeletePermanently(e._options.rootId);e._clearCache();});},_getPlugin:function(){var i='FileLoader',e='0.0.0.22',t='_plugin',o=this[t],s=this;if(o&&o.getState()===o.readyState.OPEN)return a.success(o);else{var l=new a();return require(['js!SBIS3.Plugin.Source.LocalService'],function(o){var a=new o({endpoint:{address:i+'-'+e,contract:i},options:{mode:'always'}});a.isReady().addCallbacks(function(){s[t]=a,l.callback(a);},function(i){s[t]=null,l.errback(i);});}),l;}},_checkUploadingProgress:function(e){var t=this;function o(){e.call('uploadToSbisDiskInfo',{}).addCallback(a);}function a(e){try{e=JSON.parse(e);}catch(i){return;}if(e&&e.length)i.forEach(e,function(i){var e=t._getOriginalFileGuid(i.uploadGuid);if(e===i.uploadGuid)return;t._notifyProgress(e,i.uploadPercent);});else clearInterval(t._progressInterval),t._progressInterval=null;}if(!this._progressInterval)this._progressInterval=setInterval(o,this._options.checkProgressPeriod);},_getActualFileGuid:function(i){return this._actualGuids[i]||i;},_getOriginalFileGuid:function(e){var t=e;return i.find(this._actualGuids,function(i,o){if(i===e)return t=o,true;}),t;},_setActualFileGuid:function(i,e){this._actualGuids[i]=e;},_onUploadToSbisDiskCompleteEvent:function(i,e){var t=this._getOriginalFileGuid(e.UploadGuid);if(t===e.UploadGuid)return;this._clearCache(t);var o=this._parseSuccessResponse(e.UploadJson);if(!o.id)o.id=this._options.rootId;this._notifyComplete(t,o),this._options.rootId=null;},_onUploadedChunkEvent:function(i,e){var t=this._getOriginalFileGuid(e.uploadId);if(t===e.uploadId)return;this._notifyProgress(t,0<=e.uploadPercent?e.uploadPercent:0<e.totalSize&&0<=e.uploadSize?e.uploadSize/e.totalSize:0);},_onUploadToSbisDiskTopFolderCreatedEvent:function(i,e){var t=this._getOriginalFileGuid(e.UploadGuid);if(t===e.UploadGuid)return;if(e.UploadSize)this._notifyTopFolderCreate(t,e.UploadHref,e.UploadSize);var o=e.UploadHref.split('/');this._options.rootId=o[o.length-1];},_onUploadToSbisDiskErrorEvent:function(i,e){},_onUploadToSbisDiskFatalErrorEvent:function(i,e){var o=this._getOriginalFileGuid(e.UploadGuid);if(o===e.UploadGuid)return;var a=e.Response;if(!a)a={message:e.Message,details:e.Message};if(this._notifyError(o,a),this.cancel(o),this._options.rootId)t.DeletePermanently(this._options.rootId);}});return l;});
define('js!SBIS3.EDO.CD.UploadManager',['Core/helpers/random-helpers','Core/helpers/collection-helpers','Core/Abstract','js!SBIS3.EDO.CD.BrowserUploader','js!SBIS3.EDO.CD.BigFileBrowserUploader','js!SBIS3.EDO.CD.PluginUploader','js!SBIS3.BL.FileSD','SbisDiskBase_localization'],function(e,t,i,o,r,s,l){'use strict';function n(){this._queue=[];}n.prototype.push=function(t,i){var o={id:e.createGUID(),method:t,data:i,active:null};return this._queue.unshift(o),o;},n.prototype.remove=function(e){for(var t=0,i=this._queue.length;t<i;t++)if(this._queue[t].id===e)return void this._queue.splice(t,1);},n.prototype.getNext=function(){for(var e,t=this._queue.length-1;t>=0;t--)if(e=this._queue[t],null==e.active)return e;},n.prototype.get=function(e){for(var t=0,i=this._queue.length,o;t<i;t++)if(o=this._queue[t],o.id===e)return o;},n.prototype.getActiveCount=function(){for(var e=0,t=0,i=this._queue.length;t<i;t++)e+=this._queue[t].active;return e;},n.prototype.clear=function(){this._queue=[];},n.prototype.getCount=function(){for(var e=0,t=0,i=this._queue.length;t<i;t++)if(false!==this._queue[t].active)e+=1;return e;};var a=i.extend({$protected:{_options:{remoteUrl:'',maxUploads:1},_uploaders:{},_queue:null},$constructor:function(){this._publish('Start','Progress','Complete','Error','Cancel','CancelFolder','TopFolderCreate'),this._queue=new n();},destroy:function(){t.forEach(this._uploaders,function(e){e.destroy();}),this._uploaders=this._queue=null,a.superclass.destroy.call(this);},_getUploader:function(e){var t=this._uploaders[e];if(!t){switch(e){case a.UPLOAD_METHOD_BROWSER:t=new o({remoteUrl:this._options.remoteUrl});break;case a.UPLOAD_METHOD_PLUGIN:t=new s({remoteUrl:this._options.remoteUrl});break;case a.UPLOAD_METHOD_BROWSER_BIG_FILE:t=new r({remoteUrl:this._options.remoteUrl});break;default:throw new Error('Unknown upload method "'+e+'".');}this._uploaders[e]=t,this.subscribeTo(t,'Progress',this._onUploadProgress.bind(this)),this.subscribeTo(t,'Complete',this._onUploadComplete.bind(this)),this.subscribeTo(t,'Error',this._onUploadError.bind(this)),this.subscribeTo(t,'TopFolderCreate',this._onTopFolderCreate.bind(this));}return t;},upload:function(e,t,i,o){this._notify('Start',{id:this._queue.push(e,o).id,name:t,size:i||null,isFolder:!!o.isFolder,rootFolder:o.folder,data:o}),this._tryUploadNext();},reupload:function(e){var t=this._queue.get(e);if(t&&false===t.active)t.active=null,this._tryUploadNext();},cancel:function(e){var t=this._queue.get(e);if(t)if(t.active)t.active=false,this._notify(t.data&&t.data.isFolder?'CancelFolder':'Cancel',e,'cancel'),this._getUploader(t.method).cancel(e),this._tryUploadNext();else t.active=false;},cancelAll:function(){t.forEach(this._uploaders,function(e){e.cancelAll();}),this._notify('CancelFolder','','cancelAll'),this._queue.clear();},getQueueCount:function(){return this._queue.getCount();},_tryUploadNext:function(){var e,t=this;if(this._queue.getActiveCount()<this._options.maxUploads)if(e=this._queue.getNext(),e)if(e.active=true,e.data&&e.data.file&&e.data.file.isFolder)this._uploadFolder(e.id,e);else this._getUploader(e.method).upload(e.id,e.data).addCallbacks(function i(){e.data=null,t._notify('Progress',e.id,0);},function i(o){e.data=null,t._onUploadError(void 0,e.id,o);});},_onUploadProgress:function(e,t,i){if(this._queue.get(t))this._notify('Progress',t,i);},_onUploadError:function(e,t,i){var o=this._queue.get(t);if(o)this._notify('Error',t,i);if(!this.isDestroyed()){if(o)o.active=false;this._tryUploadNext();}},_onTopFolderCreate:function(e,t,i,o){this._notify('TopFolderCreate',t,i,o);},_onUploadComplete:function(e,t,i){if(this._queue.get(t))this._notify('Complete',t,i);if(!this.isDestroyed())this._queue.remove(t),this._tryUploadNext();},_uploadFolder:function(t,i){var r=new o({remoteUrl:this._options.remoteUrl}),s=this;function n(e,t,i,o,r,s,l){this.id=e,this.method=t,this.active=i,this.data=new a(o,r,s,l);}function a(e,t,i,o){this.isFolder=e,this.file=t,this.parent=i,this.folder=o;}var u=[];u.cancel=false;var d=i.data.file,f=0,h=0;u.push(new n(null,'browser',true,i.data.file.isFolder,i.data.file,null,i.data.folder));var c=0,p=[],_=0;g(d,u[0]);function g(e,t){var i;for(i=0;i<e.files.length;i++)f+=e.files[i].size,u.push(new n(null,'browser',true,false,e.files[i],t,null)),c++;for(i=0;i<e.folders.length;i++)u.push(new n(null,'browser',true,true,e.folders[i],t,null)),c++,g(e.folders[i],u[c]);}m(u[_]);var U=0,b=0,v=0,C=0;function m(i){U=e.createGUID(),r.upload(U,i.data).addCallbacks(function e(){if(0===_)s._notify('Progress',t,0);},function e(t){if(i[_].data.isFolder){for(var o=_+1;o<i.length;o++)if(i[o].data.parent===i[_])if(_<i.length-1)_++;}else if(_<i.length-1)_++;p.push(t.message);});}function y(e,t,i){if('cancelAll'===i)u.cancel=true;if(r.cancel(t),C.id)l.DeletePermanently(C.id);_=u.length-1,this.unsubscribe('CancelFolder',y),r.unsubscribe('Complete',q),r.unsubscribe('Progress',E),r.unsubscribe('Error',D);}function q(e,i,o){if(0===_)C=o;if(b++,u[_].data.isFolder)for(var r=_;r<u.length;r++){if(0===r&&u.length>1)r++;if(u[r].data.parent===u[_])u[r].data.folder=o.id;}else h+=100*u[_].data.file.size/f;if(_===u.length-1&&!u.cancel)s._onUploadComplete('',t,C),C=0;else if(_<u.length-1)m(u[++_]);}function E(e,i,o){var r=h;if(!u[_].data.isFolder)r+=Math.min(99,u[_].data.file.size*o/f);if(r>1&&!u.cancel)s._onUploadProgress('',t,Math.floor(r));}function D(e,i,o){if(0!==_)if(u[_].data.isFolder){var r=u[_];if(_<u.length-1)_++;for(var n=_;n<u.length;n++)if(u[n].data.parent===r)if(_<u.length-1)_++;}else h+=100*u[_].data.file.size/f,_++;if(v++,p.push(o),0===b&&v===u.length||0===_||_===u.length){if(s._onUploadError('',t,rk('Не удалось загрузить папку')+': '+o.message),C.id)l.DeletePermanently(C.id);}else if(_<u.length)m(u[_]);}this.subscribeTo(r,'Complete',q),this.subscribeTo(r,'Progress',E),this.subscribeTo(r,'Error',D),this.subscribeTo(this,'CancelFolder',y);}});return a.UPLOAD_METHOD_BROWSER='browser',a.UPLOAD_METHOD_BROWSER_BIG_FILE='browser_big_file',a.UPLOAD_METHOD_PLUGIN='plugin',a;});
define('js!SBIS3.EDO.CD.CommonDocsHelpers',['Core/core-functions','Deprecated/BLObject','Deprecated/Record','Deprecated/RecordSetStatic','Core/helpers/string-helpers','Core/helpers/collection-helpers','Core/UserInfo','Core/RightsManager','Core/Indicator','Core/Deferred','Core/constants','js!SBIS3.BL.FileSD','js!SBIS3.EDO.CD.UploadManager','SBIS3.CONTROLS/Utils/InformationPopupManager','WS.Data/Chain','SbisDiskBase_localization'],function(e,t,r,o,n,a,i,l,s,c,d,u,f,R,g){'use strict';var O={_fileChooserPlugin:null,_fileLoaderPlugin:null,_fileChooser:null,getFileIconByType:function(e){switch(e){case 1:return'<div class="cd__file-icon" style="color:#999999">\uE738</div>';case 2:return'<div class="cd__file-icon" style="color:#587AB0">\uE736</div>';case 3:return'<div class="cd__file-icon" style="color:#72BE44">\uE737</div>';case 4:return'<div class="cd__file-icon" style="color:#EF463A">\uE733</div>';case 5:return'<div class="cd__file-icon" style="color:#FEC63F">\uE72A</div>';case 6:return'<div class="cd__file-icon" style="color:#EF463A">\uE734</div>';case 7:return'<div class="cd__file-icon" style="color:#000000">\uE732</div>';case 8:return'<div class="cd__file-icon" style="color:#999999">\uE749</div>';case 9:return'<div class="cd__file-icon" style="color:#999999">\uE73D</div>';case 10:return'<div class="cd__file-icon" style="color:#999999">\uE73C</div>';case 11:return'<div class="cd__file-icon" style="color:#999999">\uE6A7</div>';}return'<div class="cd__file-icon" style="color:#999999">\uE735</div>';},downloadFiles:function(e,t){var r=$('body'),o=$('.cd-upload-form'),n=$('.cd-upload-iframe');if(!t)t='/disk/api/v1/download';if(!o.length&&!n.length)r.append(o=$('<form target="cd-upload-iframe" '+'action="'+t+'" method="POST" class="cd-upload-form ws-hidden">'+'<input type="hidden" name="ReqJson"></form>')),r.append(n=$('<iframe class="cd-upload-iframe ws-hidden" name="cd-upload-iframe"></iframe>'));o.find('[name=ReqJson]').val(JSON.stringify({href:e})),o.submit();},getFileChooser:function(){if(this._fileChooser)return c.success(this._fileChooser);},uploadFile:function(e,t,r){var o=this;O.getFileChooser().addCallback(function(e){if(r=r||{},!r.hasOwnProperty('canUploadFolder'))r.canUploadFolder=true;r.handlers={onChoose:function(e,r){if(r.length>100)s.setMessage(rk('Чтение файлов')+'...');setTimeout(function(){var e=1;a.forEach(r,function(r){setTimeout(function(){if(!d.browser.isIE8&&!d.browser.isIE9&&r.file instanceof File)if(r=r.file,r.size>104857600)o.uploader.upload(f.UPLOAD_METHOD_BROWSER_BIG_FILE,r.name,r.size,{file:r,folder:t});else{var n=r.name;if(d.browser.isMobileIOS&&'image'===O.parseFileName(r.name).name)n=O.generateIOSImageName(r.name,e),e++;o.uploader.upload(f.UPLOAD_METHOD_BROWSER,n,r.size,{file:r,fileName:n,folder:t});}else o.uploader.upload(f.UPLOAD_METHOD_PLUGIN,r.name,r.size,{path:r.path,folder:t,isFolder:'folder'===r.type});},50);}),s.hide();},100);}},e.choose(r);});},getRootName:function(e){switch(e){case O.ROOT_FOLDER_COMMON:return rk('Общие документы');case O.ROOT_FOLDER_LOADS:return rk('Загрузки');case O.ROOT_FOLDER_MY:return rk('Мои документы');case O.ROOT_FOLDER_SHARED:return rk('Со мной поделились');case O.ROOT_FOLDER_SIGNED:return rk('Я подписал');case O.ROOT_FOLDER_COMMON_TRASH:return rk('Корзина общих');case O.ROOT_FOLDER_MY_TRASH:return rk('Корзина моих');}return rk('Документы');},getCurrentFolderIdFromViewer:function(e){return e.getCurrentRoot();},getRootNameFromViewer:function(e){return e.getLinkedContext().getValue('listFilters').catalogId;},getCurrentFolderFromViewer:function(e){var t=e?e.getMetaData():null,r=t?t.path:null;if(r=r?g(r).toArray():[],!r.length)return null;return g(r[r.length-1]).toObject();},getRecordForPath:function(e){var t=new r();return t.addColumn('folder',r.FIELD_TYPE_STRING),t.addColumn('folder@',r.FIELD_TYPE_BOOLEAN),t.addColumn('folder$',r.FIELD_TYPE_BOOLEAN),t.addColumn('attachId',r.FIELD_TYPE_STRING),t.addColumn('Id',r.FIELD_TYPE_STRING),t.addColumn('Name',r.FIELD_TYPE_STRING),t.addColumn('title',r.FIELD_TYPE_STRING),t.addColumn('Owner',r.FIELD_TYPE_STRING),t.addColumn('OwnerName',r.FIELD_TYPE_STRING),t.addColumn('Type',r.FIELD_TYPE_INTEGER),t.set('folder',e.get('folder')),t.set('folder@',e.get('folder@')),t.set('folder$',e.get('folder$')),t.set('attachId',e.get('attachId')),t.set('Id',e.get('attachId')),t.set('Name',e.get('Name')),t.set('title',e.get('title')),t.set('Owner',e.get('Owner')),t.set('OwnerName',e.get('OwnerName')),t.set('Type',e.get('Type')),t;},getCurrentPathFromViewer:function(e){var t=e?e.getMetaData():null,r=t?t.path:null;if(r=r?g(r).toArray():[],!r.length)return null;var n=new o();return n.addRecords(a.map(r,function(e){return O.getRecordForPath(e);})),n;},getFullPathFromTreeView:function(e,t){var r=O.getCurrentPathFromViewer(e.getItems());if(!r)r=new o();var n=[],a=e.getItems().getRecordById(t),i;while((i=a.get('folder'))&&(a=e.getItems().getRecordById(i)))n.unshift(O.getRecordForPath(a));return r.addRecords(n),r;},currentFolderIsArchive:function(e){return e&&'Archive'===e._options.mainOptions.objectName;},getSharedServiceURL:function(){return'/shared/service/';},getDiskServiceURL:function(){return'/disk/api/v1/service/';},getDiskRestServiceURL:function(){return'/disk/api/v1/';},getPublicDiskRestServiceURL:function(){return'/disksharedrest/';},getSharedServiceURLForEDO:function(){return'/shared/';},getPluralForm:function(e,t,r,o){return e%10===1&&e%100!==11?t:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?r:o;},getPrettyFileSize:function(e){if(!e)return'-';var t=1024,r=[rk('байт'),rk('КБ'),rk('МБ'),rk('ГБ'),rk('ТБ')];if(0===e)return rk('0 байт');var o=parseInt(Math.floor(Math.log(e)/Math.log(t)),10);if(r[o]===rk('байт')||r[o]===rk('КБ'))return(e/Math.pow(t,o)).toFixed(0)+' '+r[o];else if(r[o]===rk('МБ'))return((e/Math.pow(t,o)).toFixed(1)+' '+r[o]).replace(/\.0+ /,' ');else if(r[o]===rk('ГБ')||r[o]===rk('ТБ'))return((e/Math.pow(t,o)).toFixed(2)+' '+r[o]).replace(/\.0+ /,' ');},getPrettyFileSizeForQuota:function(e){if(!e)return'0';var t=1024,r=[rk('байт'),rk('КБ'),rk('МБ'),rk('ГБ'),rk('ТБ')];if(0===e)return rk('0 байт');var o=parseInt(Math.floor(Math.log(e)/Math.log(t)),10);if(r[o]===rk('байт')||r[o]===rk('КБ'))return rk('1 МБ');else if(r[o]===rk('МБ'))if((e/Math.pow(t,o)).toFixed(0)<600)return((e/Math.pow(t,o)).toFixed(0)+' '+r[o]).replace(/\.0+ /,' ');else return(Math.floor(e/Math.pow(t,o+1)*10)/10+' '+r[o+1]).replace(/\.0+ /,' ');else if(r[o]===rk('ГБ')||r[o]===rk('ТБ'))return((e/Math.pow(t,o)).toFixed(1)+' '+r[o]).replace(/\.0+ /,' ');},startDownloadFile:function(e){var t=navigator.appVersion.toLowerCase(),r=false;if(t.indexOf('ipad')>-1||t.indexOf('iphone')>-1)r=true;if(!r){var o=$('body').find('.commonDocsDownload')[0];if(!o)o=$('<iframe class="commonDocsDownload" src="'+e+'" style="display:none;" ></iframe>'),$('body').append(o);else o.src=e;if(window.navigator.userAgent.indexOf('Chrome')>-1)o.load();}else var n=window.open(e);},getUrlByObject:function(e){var t=new c();return u.ReadByObject(e).addCallbacks(function(e){u.GetPublicAccessRight(e.get('Id')).addCallbacks(function(e){t.callback(e.get('HRef'));},function(e){t.errback(e);});},function(e){t.errback(e);}),t;},getFileUrl:function(e,t){var r=t?O.getPublicDiskRestServiceURL():O.getDiskRestServiceURL();return window.location.protocol+'//'+window.location.host+r+encodeURI(e);},openDocumentViewer:function(e,t,r){require(['js!SBIS3.EDO.CD.DiskOperations'],function(t){t.openDocument(e);});},parseFileName:function(e){function t(e){return e=e||{},(e.before||'')+(e.beforeName||'')+n.escapeHtml(this.name)+(e.afterName||'')+(this.ext?(e.beforeExt||'')+'.'+n.escapeHtml(this.ext)+(e.afterExt||''):'')+(e.after||'');}var r=e||'',o=r.lastIndexOf('.'),a='';if(o>0)a=r.substring(o+1),r=r.substring(0,o);return{name:r,ext:a,render:t};},generateIOSImageName:function(e,t){var r=rk('IMG $cnt$s$ от $date$t$%d.%m.%y, %H-%M-%S$.$ext$s$'),o=e.split('.').pop(),a=new Date();return n.format({date:a,cnt:t,ext:o},r);},onFilterChangeRootBrowser:function(e,t){var r=this.getRecordSet();if(!t['Раздел'])t['ParentId']=t['RootName'];else if(r.getRecordIndexByPrimaryKey(t['Раздел'])>=0)t['ParentId']=r.getRecordByPrimaryKey(t['Раздел']).get('Id');else if(r.getWay()&&r.getWay().getRecordIndexByPrimaryKey(t['Раздел'])>=0)t['ParentId']=r.getWay().getRecordByPrimaryKey(t['Раздел']).get('Id');},showErrorNotification:function(e,t){O._showPlatformNotification(e,t,'error');},showErrorDialog:function(e,t){R.showMessageDialog({status:'error',message:e,opener:t});},showSuccessNotification:function(e,t){O._showNotification(e,t,'success',10000);},_showPlatformNotification:function(e,t,r){requirejs(['js!SBIS3.EDO.CD.Notification'],function(o){R.showNotification({caption:e,footerTemplate:function(){return'<div class="commonDocs-notification__footer"><div class="commonDocs-notification__footer-text">'+n.escapeHtml(t)+'</div></div>';},status:r});});},_showNotification:function(e,t,r,o){requirejs(['js!SBIS3.EDO.CD.Notification'],function(a){var i=new a.Message();i.addText(n.escapeHtml(t)),a.show(e,i,{cancellable:false,style:r,timeout:o});});},showNotificationWithoutBody:function(e,t,r){R.showNotification({status:t||'success',caption:e});},canChangeOnbject:function(e){var t=new c();return u.AccessRightData(e).addCallbacks(function(e){e=e.getRecords()[0],t.callback({canChange:e.get('Rights')>=2,isDemo:e.get('IsDemo'),err:null});},function(e){t.callback({canChange:false,isDemo:false,err:e});}),t;},hasCommonDocsZoneRights:function(){return l.getRights(['Общие'])['Общие']&l.ALLOW_MASK;},idUserIsEqualIdClient:function(){return i.get('ИдентификаторПользователя')===i.get('ИдентификаторКлиента');},isPersonalAccount:function(){if(window&&window.userInfo&&window.userInfo['КлассПользователя'])return new c().callback('__сбис__физики'===window.userInfo['КлассПользователя']);else{var e=new c();return new t({name:'Пользователь',serviceUrl:'/service/'}).call('GetPublicUserInfo',{},t.RETURN_TYPE_RECORD).addCallbacks(function(t){try{window.userInfo['КлассПользователя']=t.get('Class');}catch(e){}e.callback('__сбис__физики'===t.get('Class'));},function(t){e.callback(false);}),e;}},NOT_ACCESS_ERROR_MESSAGE:rk('Вам запрещен доступ к папке, содержащей данный объект'),setListFilter:function(e,t){var r=function(e,t,r,o){if(t||0===t)e[o]=t;else if(r||0===r)e[o]=r;return e;},o=e.getValue('listFilters')||{},n={},a=t.folder&&e.getValue('listRoot')!=t.folder;if(n=r(n,t.catalogId,o.catalogId,'catalogId'),n=r(n,t.folder,o.folder,'folder'),n=r(n,t.onlyDeleted,o.OnlyDeleted,'OnlyDeleted'),n=r(n,t.sortBy,o.SortBy,'SortBy'),n=r(n,t.Path,o.Path,'Path'),n=r(n,t.InitialRootId,o.InitialRootId,'InitialRootId'),n=r(n,t.IsRootFolder,o.IsRootFolder,'IsRootFolder'),n=r(n,t['Разворот'],'Без разворота','Разворот'),n=r(n,t['ВидДерева'],o['ВидДерева'],'ВидДерева'),n=r(n,t['ФильтрДатаПериод'],o['ФильтрДатаПериод'],'ФильтрДатаПериод'),n=r(n,t['ФильтрДатаС'],o['ФильтрДатаС'],'ФильтрДатаС'),n=r(n,t['ФильтрДатаП'],o['ФильтрДатаП'],'ФильтрДатаП'),n=r(n,t.SearchString,t.clearSearch?null:o.SearchString,'SearchString'),t.clearSearch)n.SearchString=null;if(t.clearPath)n.Path=null;if(n['FoldersFirst']=!(n['catalogId']==O.ROOT_FOLDER_SHARED&&'SortByDateCreate'==n['SortBy']),e.setValue('listFilters',n),a)e.setValue('listRoot',t.catalogId||t.folder);},setListFilterForFind:function(t,r){var o=function(e,t,r,o){if(t||0===t)e[o]=t;else if(r||0===r)e[o]=r;return e;},n=t.getValue('listFilters')||{},a={},i=r.folder&&t.getValue('listRootFindName')!=r.folder;if(a=o(a,r.catalogId,n.catalogId,'catalogId'),a=o(a,r.folder,n.folder,'folder'),a=o(a,r.onlyDeleted,n.OnlyDeleted,'OnlyDeleted'),a=o(a,r.sortBy,n.SortBy,'SortBy'),a=o(a,r.Path,n.Path,'Path'),a=o(a,r.InitialRootId,n.InitialRootId,'InitialRootId'),a=o(a,r.IsRootFolder,n.IsRootFolder,'IsRootFolder'),a=o(a,r['Разворот'],'Без разворота','Разворот'),a=o(a,r['ФильтрДатаПериод'],n['ФильтрДатаПериод'],'ФильтрДатаПериод'),a=o(a,r['ФильтрДатаС'],n['ФильтрДатаС'],'ФильтрДатаС'),a=o(a,r['ФильтрДатаП'],n['ФильтрДатаП'],'ФильтрДатаП'),a=o(a,r.SearchString,r.clearSearch?null:n.SearchString,'SearchString'),r.clearSearch)a.SearchString=null;a['FoldersFirst']=!(a['catalogId']==O.ROOT_FOLDER_SHARED&&'SortByDateCreate'==a['SortBy']),a['LocationSearch']=1,t.setValue('listFiltersFindName',a);var l=e.clone(a);if(l['LocationSearch']=2,t.setValue('listFiltersFindBody',l),i)t.setValue('listRootFindName',r.root||r.folder),t.setValue('listRootFindBody',r.root||r.folder);},getSearchStringPlaceholder:function(e){var t;switch(e){case O.ROOT_FOLDER_COMMON:t=rk('Найти в Общих документах')+'...';break;case O.ROOT_FOLDER_MY:t=rk('Найти в Моих документах')+'...';break;case O.ROOT_FOLDER_LOADS:t=rk('Найти в Загрузках')+'...';break;case O.ROOT_FOLDER_SHARED:t=rk('Найти в Со мной поделились')+'...';break;case O.ROOT_FOLDER_SIGNED:t=rk('Найти в Я подписал')+'...';break;case O.ROOT_FOLDER_MY_TRASH:t=rk('Найти в Корзине моих документов')+'...';break;case O.ROOT_FOLDER_COMMON_TRASH:t=rk('Найти в Корзине общих документов')+'...';break;default:t=rk('Найти')+'...';}return t;},signCommandIsAvailable:function(e,t){return true===t.isDisk&&!e.get('folder@')&&('list'===t.place||'mas'===t.place)&&!t.isArchive;},createWebLinkFile:function(e,t,r){var o=new c(),a='[DEFAULT]\n'+'BASEURL=$link$s$\n'+'TARGET=\'_blank\'\n'+'[InternetShortcut]\n'+'URL=$link$s$\n',i=e,l=n.format({link:t},a),s=new XMLHttpRequest(),t=O.getDiskRestServiceURL()+r;if('.url'!==i.substr(i.length-4))i=(i+='.url').replace('..','.');function d(){if(s.readyState===XMLHttpRequest.DONE)if(201===s.status)o.callback(s.responseText);else o.errback(s.responseText);}try{s.open('POST',t,true),s.onreadystatechange=d,s.setRequestHeader('Content-Disposition','attachment; filename*=UTF-8\'\''+encodeURIComponent(i)),s.setRequestHeader('Content-Type','application/octet-stream'),s.send(l);}catch(e){o.errback(e);}return o;},getFolderForUpload:function(e){var t=e.getItems()?e.getItems().getMetaData():null,r=t?t.path:null,o=e.getSelectedItem(),n=e.getOpenedPath(),a=(r=r?g(r).toArray():[]).length?g(r[r.length-1]).toObject():{attachId:e.getFilter().catalogId||e.getFilter().folder,Name:O.getRootName(e.getFilter().catalogId)};if(!o)return a;var i=e.getItems().getRecordById(o.get('folder'));if(!o.get('folder@'))return i?g(i).toObject():a;if(n[o.get('attachId')])return g(o).toObject();else return i?g(i).toObject():a;},webLinkInfo:function(e){if(0===e.indexOf(window.location.protocol+'//'+window.location.hostname+'/shared/disk/'))return{inDisk:true,objectId:e.split('/disk/')[1]};else return{inDisk:false,objectId:void 0};},loadFileChooser:function(){if(this._fileChooser)return;var e=this;require(['js!SBIS3.FL.FileChooser'],function(t){e._fileChooser=t;});},ROOT_FOLDER_MY:'mydocs',ROOT_FOLDER_COMMON:'commondocs',ROOT_FOLDER_LOADS:'loads',ROOT_FOLDER_SHARED:'sharedmedocs',ROOT_FOLDER_SIGNED:'signedmedocs',ROOT_FOLDER_MY_TRASH:'mytrash',ROOT_FOLDER_COMMON_TRASH:'commontrash',ROOT_FOLDER_MY_RECENT:'myrecent',ROOT_FOLDER_COMMON_RECENT:'commonrecent',ROOT_FOLDER_RECENT:'recent',ROOT_FOLDER_FAVORITES:'favorites'};return O.uploader=new f({remoteUrl:O.getDiskRestServiceURL()}),O;});
define('js!SBIS3.EDO.IntEngine',['Lib/Control/Control','js!SBIS3.Plugin/Source/Helper/Helper','Core/core-functions','Core/core-attach','Core/core-instance','Deprecated/BLObject','WS.Data/Adapter/Sbis','WS.Data/Entity/Record','WS.Data/Collection/RecordSet','Core/helpers/string-helpers','Core/helpers/random-helpers','Deprecated/helpers/collection-helpers','Core/helpers/collection-helpers','Core/WindowManager','Core/moduleStubs','Core/Indicator','Core/Context','Core/IoC','Core/EventBus','Deprecated/base64','Core/ParallelDeferred','Core/Deferred','Core/detection','WS.Data/Di','i18n!SBIS3.MyArea.MyComponent','Dokumentooborot_localization'],function(e,n,t,r,o,i,a,s,c,u,l,d,f,m,g,p,C,h,v,S,b,w,k,y){'use strict';var I=[],P=null,D={},_={},E='',M={},O=null,A=null;v.channel('navigation').subscribe('onBeforeNavigate',function(){_={};});var N={paramModule:{IntEngineCom1S77:{service:'Com1C77',countFlows:1,nameSystem:'1C 7.7',namePlugin:'ExtCom1C-1.0.0.0',iconSystem:'icon-1c',nameTemplate:'IntEngineCom1S82',shortNameSystem:'1C'},IntEngineCom1S82:{service:'Com1C82',nameSystem:'1C 8.2',namePlugin:'ExtCom1C-1.0.0.0',iconSystem:'icon-1c',countFlows:1,nameTemplate:'IntEngineCom1S82',shortNameSystem:'1C'},IntEngineCom1S83:{service:'Com1C83',service4Config:'Com1C82',nameSystem:'1C 8.3',namePlugin:'ExtCom1C-1.0.0.0',iconSystem:'icon-1c',countFlows:1,nameTemplate:'IntEngineCom1S82',shortNameSystem:'1C'},IntEngineWeb1S83:{service:'Web1C83',nameSystem:'1C 8.3',namePlugin:'ExtWeb1C-1.0.0.0',iconSystem:'icon-1c',countFlows:10,nameTemplate:'IntEngineCom1S82',shortNameSystem:'1C'},IntEngineComSAPNC3:{service:'SAP',nameSystem:'SAP',namePlugin:'ExtSap-1.0.0.0',iconSystem:'icon-SAP',countFlows:10,nameTemplate:'IntEngineComSAPNC3',shortNameSystem:'SAP'},IntEngineComSAPBN1:{service:'SAP',nameSystem:'SAP',namePlugin:'ExtSap-1.0.0.0',iconSystem:'icon-SAP',countFlows:10,nameTemplate:'IntEngineComSAPNC3',shortNameSystem:'SAP'},IntEngineComStoreHouse4:{service:'StoreHouse',nameSystem:'Store House',namePlugin:'ExtStoreHouse-1.0.0.0',iconSystem:'icon-Ship',countFlows:1,nameTemplate:'IntEngineComStoreHouse4',shortNameSystem:'Store House'}},leadTime:{unloadDocumentsPackage:[],'ПолучитьПакет':[],setDocumentPackage:[],getDocumentPackage:[],'ЗагрузитьПакет':[],showListDocuments:[],getListDocument:[]},nameFunction:{'ЗагрузитьПакет':'БЛ.ЗагрузитьПакет','ПолучитьПакет':'БЛ.ПолучитьПакет',getDocumentPackage:'Формирование пакета',setDocumentPackage:'Создание документов',unloadDocumentsPackage:'Инициализация',showListDocuments:'Показать список документов',getListDocument:'Плагин.ПолучитьСписокДокументов'},debug:false,errors:{},deleteActiveButton:function(e){for(var n in _){if(!_.hasOwnProperty(n))continue;if(n.indexOf(e)>-1)delete _[n];}},getListReestrsSystem:function(e){return function(){if(O&&0!==d.countOfProperties(O))return new w().callback(O);else return N.readConnectionList().addCallback(function(e){return O=false===e?{}:e,e;});}().addCallback(function(n){if(!n)return{};var t={},r='Месяц',o=new Date(),i=new Date(),a=0;if(e.indexOf('Отчет')>-1)i.setFullYear(i.getFullYear()-1),r='Год';else i.setMonth(i.getMonth()-1);for(var s in O){if(!O.hasOwnProperty(s))continue;var c=0,u=[],l={},d=O[s],f=d['service'],m=d['menu'];if(!m||!m[e])continue;for(var g in m[e]){if(!m[e].hasOwnProperty(g))continue;if(l[g])continue;var p=m[e][g],C=e+a+'_'+c;p['filter']={'ДатаНачала':i,'ДатаКонца':o,'Период':r},p['reestr']=g,p['idConnection']=s,l[g]=g;var h={id:C,title:p['name'],params:p};u.push(h),c++;}if(u.length)t[s]=u,a++;}return t;});},getSupportedRegistries:function(e){var n=function(n){if(!e)return n;for(var t={},r=0,o=e.length;r<o;r++)if(n[e[r]])t[e[r]]=n[e[r]];return t;};if(A)return new w().callback(n(A));else return new i('Интеграция').call('GetSupportedRegistries',{},i.RETURN_TYPE_ASIS).addCallbacks(function(e){return A=e,n(e);},function(e){new w().errback(e);});},createMenuReadDocument:function(e){if(k.IOSVersion||k.isMobileAndroid||k.isMobileSafari||k.isMacOSDesktop)return new w().callback([]);var n,t,r='',o,i,a='',s;if(e['record']){var n=e['record'];o=Boolean(n.getModelField('РП.Документ/Состояние/Подписание/Входящий'))?'InBoxDoc':'OutBoxDoc',t=n.getModelField('РП.Документ/ТипДокумента/ТипДокумента'),i=n.getModelField('РП.Документ/ИдО'),a=i.toString().replace(new RegExp('-','g'),''),s=e['reloadMenu'];}else o=e['direction'],t=e['docType'];if(e['idButton'])r=e['idButton'];var c=o+'Read'+t;return N.getSupportedRegistries(e.filterIS?e.filterIS:void 0).addCallback(function(o){if(!o||o['1C']&&!o['1C'][c]&&o['SAP']&&!o['SAP'][c])return new w().callback([]);if(e.reloadMenu||e.view){var i=c+a+r;if(!_[i])_[i]={};_[i]['reloadMenu']=e.reloadMenu,_[i]['view']=e.view;}return N.getListReestrsSystem(c).addCallback(function(r){var i=0,u=[],l=d.countOfProperties(O),f=d.countOfProperties(r);if(0===l){if(!o||o&&o['1C']&&o['1C'][c])u.push({id:'id_setting1c',title:rk('из')+' 1С',icon:'sprite:icon-24 icon-1c icon-primary',onActivated:function(){N.showExtConnectionWizard({moduleNameWizard:'IntEngineCom1S82',typeDocument:t,record:n,nameButton:c,updateFormDocument:s});}});if(o&&o['SAP']&&o['SAP'][c])u.push({id:'id_settingSAP',title:rk('из')+' SAP',icon:'sprite:icon-24 icon-SAP icon-primary',onActivated:function(){N.showExtConnectionWizard({moduleNameWizard:'IntEngineComSAPNC3',typeDocument:t,record:n,nameButton:c,updateFormDocument:s});}});if(o&&o['StoreHouse']&&o['StoreHouse'][c])u.push({id:'id_settingStoreHouse',title:rk('из')+' Store House',icon:'sprite:icon-24 icon-Ship icon-primary',onActivated:function(){N.showExtConnectionWizard({moduleNameWizard:'IntEngineComStoreHouse4',typeDocument:t,record:n,nameButton:c,updateFormDocument:s});}});}else if(0!==f){for(var m in r){if(!r.hasOwnProperty(m))continue;var g=r[m],p=d.countOfProperties(g),C=O[m].name_connection.length>100?O[m].name_connection.substring(0,100)+'...':O[m].name_connection;if(1!==f&&1!==p){var h={id:c+a+i,title:C},v=O[m].paramsConnection;if(v&&v['nameModule'])h['icon']='sprite:icon-24 '+N.paramModule[v.nameModule]['iconSystem']+' icon-primary';u.push(h);}else if(1===p);for(var S=0,b=g.length;S<b;S++){var w=c+a+i+'_'+S,h={id:w,title:1===p?'из '+C:g[S].title};if('Сотрудники'===t||'Склад'===t||'Контрагенты'===t)h['onActivated']=N.showListItems;else h['onActivated']=N.showListDocuments;if(1!==f&&1!==p)h['parent']=c+i;else h['icon']='sprite:icon-24 '+N.paramModule[O[m]['paramsConnection'].nameModule]['iconSystem']+' icon-primary';if(u.push(h),g[S].params['type_doc']=t,n)g[S].params['record']=n,g[S].params['updateFormDocument']=e['updateFormDocument']?e['updateFormDocument']:e['reloadMenu'];g[S].params['nameButton']=c,D[w]=g[S].params;}i++;}u.push({id:'id_setting',title:'Настройка подключений к информационным системам',icon:'sprite:icon-24 icon-Admin icon-primary',onActivated:N.showListUserSettings});}return u;});});},createMenuWriteDocument:function(e){if(k.IOSVersion||k.isMobileAndroid||k.isMobileSafari||k.isMacOSDesktop)return new w().callback([]);var n,t,r='',o,i,a='',s;if(e['record']){var n=e['record'];o=Boolean(n.getModelField('РП.Документ/Состояние/Подписание/Входящий'))?'InBoxDoc':'OutBoxDoc',t=n.getModelField('РП.Документ/ТипДокумента/ТипДокумента'),i=n.getModelField('РП.Документ/ИдО'),a=i.toString().replace(new RegExp('-','g'),''),s=e['reloadMenu'];}else o=e['direction'],t=e['docType'];var c=o+'Write'+t;return N.getSupportedRegistries(e.filterIS?e.filterIS:void 0).addCallback(function(o){if(!o||o['1C']&&!o['1C'][c]&&o['SAP']&&!o['SAP'][c])return[];if(e.reloadMenu||e.view){var i=c+a+r;if(!_[i])_[i]={};_[i]['reloadMenu']=e.reloadMenu,_[i]['view']=e.view;}return N.getListReestrsSystem(c).addCallback(function(r){var i=0,a=[];if(0===d.countOfProperties(O)){if(!o||o&&o['1C']&&o['1C'][c])a.push({id:'id_setting1c',title:rk('в','куда выгрузить')+' 1С',icon:'sprite:icon-24 icon-1c icon-primary',onActivated:function(){N.showExtConnectionWizard({moduleNameWizard:'IntEngineCom1S82',typeDocument:t,record:n,nameButton:c,updateFormDocument:s});}});if(o&&o['SAP']&&o['SAP'][c])a.push({id:'id_settingSAP',title:rk('в','куда выгрузить')+' SAP',icon:'sprite:icon-24 icon-SAP icon-primary',onActivated:function(){N.showExtConnectionWizard({moduleNameWizard:'IntEngineComSAPNC3',typeDocument:t,record:n,nameButton:c,updateFormDocument:s});}});if(o&&o['StoreHouse']&&o['StoreHouse'][c])a.push({id:'id_settingStoreHouse',title:rk('в','куда выгрузить')+' Store House',icon:'sprite:icon-24 icon-Ship icon-primary',onActivated:function(){N.showExtConnectionWizard({moduleNameWizard:'IntEngineComStoreHouse4',typeDocument:t,record:n,nameButton:c,updateFormDocument:s});}});}else if(0!==d.countOfProperties(r)){for(var u in r){if(!r.hasOwnProperty(u))continue;var l=N.getParamModule(u),f=O[u].name_connection.length>100?O[u].name_connection.substring(0,100)+'...':O[u].name_connection,m={id:c+i,title:rk('в','куда выгрузить')+' '+l.shortNameSystem+': '+f,icon:'sprite:icon-24 '+l['iconSystem']+' icon-primary',onActivated:N.unloadDocumentsPackage};a.push(m),D[c+i]={idConnection:u,type_doc:e['docType'],nameButton:c},i++;}a.push({id:'id_setting',title:'Настройка подключений к информационным системам',icon:'sprite:icon-24 icon-Admin icon-primary',onActivated:N.showListUserSettings});}return a;});});},createMenu:function(n){if(k.IOSVersion||k.isMobileAndroid||k.isMobileSafari||k.isMacOSDesktop)return;if(!n)n=C.global.getValue('paramMenu');else C.global.setValue('paramMenu',n);var r=n['Раздел'],i=n['ТипДокумента'],a=n['ИмяМеню'],s=n['EDO.Browser'];if(true===r)r='Входящие';else if(false===r)r='Исходящие';if(!i)i=r;if(n['Меню'])var c=n['Меню'];else{if(!a||!e.ControlStorage.containsByName(a))return;var c=e.ControlStorage.getByName(a);}var u='MenuButton';if(o.instanceOfModule(c,'SBIS3.CONTROLS/Menu/MenuLink'))u='MenuLink';var l=[];if('MenuButton'===u||'MenuLink'===u){var m=c.getDataSource();if(m&&m._$data)if(s)l=m._$data;else l=t.clone(m._$data);}var g=function(){for(var t=l.length-1;t>=0;t--){var r=l[t];if('itemIntSys'===r.id.substring(0,10)||'id_setting'===r.id||'id_setting1c'===r.id||'id_settingSAP'===r.id||'id_settingStoreHouse'===r.id)l.splice(t,1);}if(!n['Меню']){var o=e.ControlStorage.containsByName('ПанельОперацийЭДО')?e.ControlStorage.getByName('ПанельОперацийЭДО'):null,i=o?o.getButtonByType('save','selected'):null;if(a=i?i.getMenuControl():null)for(var t=(s=a.getData()).length-1;t>=0;t--)if('itemIntSys'===(c=s[t]).id.substring(0,10)||'id_setting'===c.id||'id_setting1c'===c.id||'id_settingSAP'===c.id||'id_settingStoreHouse'===c.id)a.removeItem(c.id);}else{var a=n['Меню'];if(a){var s=a.getItems();if(s)for(var t=s.length-1;t>=0;t--){var c=s[t];if('itemIntSys'===c.id.substring(0,10)||'id_setting'===c.id||'id_setting1c'===c.id||'id_settingSAP'===c.id||'id_settingStoreHouse'===c.id)a.removeItem(c.id);}}}},p=function(t){if(('MenuButton'===u||'MenuLink'===u)&&'Входящие'!==r)c.setItems(t);else if(!n['Меню'])for(var o=e.ControlStorage.containsByName('ПанельОперацийЭДО')?e.ControlStorage.getByName('ПанельОперацийЭДО'):null,i=o?o.getButtonByType('save','selected'):null,a=i?i.getMenuControl():null,s=0,l=t.length;s<l;s++){if('fromFile'===(d=t[s]).id)continue;d['caption']=d.title,a.addItem(d),a.setItemIcon(d.id,d.icon);}else for(var a=n['Меню'],s=0,l=t.length;s<l;s++){var d=t[s];if('fromFile'===d.id)continue;d['caption']=d.title,a.addItem(d);}};g(),l.push({id:'id_setting1c',title:'Входящие'===r||0===i.indexOf('OutBoxWrite')?rk('В')+' 1С':rk('Из')+' 1С',icon:'Входящие'===r||'MenuLink'===u||0===i.indexOf('OutBoxWrite')?'sprite:icon-24 icon-1c icon-primary':'sprite:icon-24 icon-1c icon-primary',handlers:{onActivated:function(){N.showExtConnectionWizard({moduleNameWizard:'IntEngineCom1S82',typeDocument:i,record:record,nameButton:nameButton,updateFormDocument:updateFormDocument});}}}),l.push({id:'id_settingSAP',title:'Входящие'===r||0===i.indexOf('OutBoxWrite')?rk('В')+' SAP':rk('Из')+' SAP',icon:'Входящие'===r||'MenuLink'===u||0===i.indexOf('OutBoxWrite')?'sprite:icon-24 icon-SAP icon-primary':'sprite:icon-24 icon-SAP icon-primary',handlers:{onActivated:function(){N.showExtConnectionWizard({moduleNameWizard:'IntEngineComSAPNC3',typeDocument:'Входящие'!==r?i:''});}}}),l.push({id:'id_settingStoreHouse',title:'Входящие'===r||0===i.indexOf('OutBoxWrite')?rk('В')+' Store House':rk('Из')+' Store House',icon:'Входящие'===r||'MenuLink'===u||0===i.indexOf('OutBoxWrite')?'sprite:icon-24 icon-Ship icon-primary':'sprite:icon-24 icon-Ship icon-primary',handlers:{onActivated:function(){N.showExtConnectionWizard({moduleNameWizard:'IntEngineComStoreHouse4',typeDocument:'Входящие'!==r?i:''});}}}),p(l),g(),function(){if(N.userConfig())return new w().callback(N.userConfig());else return N.readConnectionList(true,true).addCallbacks(function(e){return e;},function(e){return new w().errback(e);});}().addCallback(function(t){if(!t)t={};if(n['Меню'])var o=n['Меню'];else{if(!e.ControlStorage.containsByName(a))return;o=e.ControlStorage.getByName(a);}var c={};for(var m in O)if(O.hasOwnProperty(m))c[m]=O[m].connection;O=t;var g=n.Меню&&n.Меню._options&&n.Меню._options.externalSystemsDocType?n.Меню._options.externalSystemsDocType:i;g='OutBoxRead'+g;var C=0,h={};for(var v in O){if(!O.hasOwnProperty(v))continue;for(var S in O[v].menu)if(S===g){C++;for(var b in O[v].menu[S]){if(!O[v].menu[S].hasOwnProperty(b))continue;var w=O[v].menu[S][b];if(!h[b])h[b]=true;}}}var k=d.countOfProperties(h);if('Входящие'===r)if(!n['Меню'])var y=e.ControlStorage.containsByName('ПанельОперацийЭДО')?e.ControlStorage.getByName('ПанельОперацийЭДО'):null,I=y?y.getButtonByType('save','selected'):null,P=I?I.getMenuControl():null;else var P=n['Меню'];var _=new Date(),E=new Date();if('Отчетность'===r)E.setFullYear(E.getFullYear()-1);else E.setMonth(E.getMonth()-1);var M=0;for(var v in O){if(!O.hasOwnProperty(v))continue;var A=O[v].name_connection.length>100?O[v].name_connection.substring(0,100)+'...':O[v].name_connection;if(c[v])O[v].connection=c[v],O[v].connected=true;var B=[],R=0;for(var x in O[v].menu)if(x===g&&O[v].menu[x])for(var b in O[v].menu[x]){if(!O[v].menu[x].hasOwnProperty(b))continue;var T='itemIntSys'+M+'_'+R,L=O[v].menu[x][b];if(L['filter']={},L['typeDoc']=g,L['reestr']=b,L['idConnection']=v,E)L.filter['ДатаНачала']=E;if(_)L.filter['ДатаКонца']=_;if(1==d.countOfProperties(O[v].menu[x]))var F=(0===i.indexOf('OutBoxWrite')?rk('в'):rk('из'))+' '+A;else var F=O[v].menu[x][b]['name'];var U={id:T,title:F,params:L};if(D[T]=U['params'],1===C||'Входящие'===r)U['icon']=('Входящие'===r||'MenuLink'===u?'sprite:icon-24 ':'sprite:icon-24 ')+N.paramModule[O[v].paramsConnection.nameModule]['iconSystem']+' icon-primary';if('Входящие'===r||i.indexOf('Write')>-1)U.handlers={onActivated:function(e){var n=[];if(y){var t=y.getCurrentView().getSelection();for(var r in t)if(t.hasOwnProperty(r))n.push({'Идентификатор':t[r].get('@Документ'),'Контрагент':t[r].get('Лицо1.Название'),'Дата':t[r].get('Дата')});}else{var i=o.getParent().getParent().getView().getSelectedItems();if(i)i.each(function(e){n.push({'Идентификатор':e.get('@Документ'),'Контрагент':e.get('Лицо1.Название'),'Дата':e.get('Дата')});});}N.unloadDocumentsPackage(e,n);}};else if('Склад'===r||'Сотрудники'===r||'Контрагенты'===r)U.handlers={onActivated:function(e){N.showListItems(e);}};else U.handlers={onActivated:function(e){N.showListDocuments(e);}};if(B.push(U),R++,'Входящие'===r)break;}if(B.length){if(1===B.length)B[0]['icon']=('Входящие'===r||'MenuLink'===u?'sprite:icon-24 ':'sprite:icon-24 ')+N.paramModule[O[v].paramsConnection.nameModule]['iconSystem']+' icon-primary',B[0]['title']='Входящие'===r?rk('В')+' '+N.paramModule[O[v].paramsConnection.nameModule]['shortNameSystem']+': '+A:B[0].title+(1===C||1==k?'':' ('+A+')'),l.push(B[0]);else{if(1!==C){var U={id:'itemIntSys'+v,title:A,icon:'sprite:icon-24 '+N.paramModule[O[v].paramsConnection.nameModule]['iconSystem']+' icon-primary'};l.push(U);}for(var W=0,H=B.length;W<H;W++){if(U=B[W],1!==C)U['parent']='itemIntSys'+v;l.push(U);}}B=[],R=0;}M++;}if(!C){var U={id:'id_setting1c',title:'Входящие'===r||0===i.indexOf('OutBoxWrite')?rk('В')+' 1С':rk('Из')+' 1С',icon:'Входящие'===r||'MenuLink'===u||0===i.indexOf('OutBoxWrite')?'sprite:icon-24 icon-1c icon-primary':'sprite:icon-24 icon-1c icon-primary',handlers:{onActivated:function(){N.showExtConnectionWizard({moduleNameWizard:'IntEngineCom1S82',typeDocument:'Входящие'!==r?i:''});}}};l.push(U);var U={id:'id_settingSAP',title:'Входящие'===r||0===i.indexOf('OutBoxWrite')?rk('В')+' SAP':rk('Из')+' SAP',icon:'Входящие'===r||'MenuLink'===u||0===i.indexOf('OutBoxWrite')?'sprite:icon-24 icon-SAP icon-primary':'sprite:icon-24 icon-SAP icon-primary',handlers:{onActivated:function(){N.showExtConnectionWizard({moduleNameWizard:'IntEngineComSAPNC3',typeDocument:'Входящие'!==r?i:''});}}};l.push(U);var U={id:'id_settingStoreHouse',title:'Входящие'===r||0===i.indexOf('OutBoxWrite')?rk('В')+' Store House':rk('Из')+' Store House',icon:'Входящие'===r||'MenuLink'===u||0===i.indexOf('OutBoxWrite')?'sprite:icon-24 icon-Ship icon-primary':'sprite:icon-24 icon-Ship icon-primary',handlers:{onActivated:function(){N.showExtConnectionWizard({moduleNameWizard:'IntEngineComStoreHouse4',typeDocument:'Входящие'!==r?i:''});}}};l.push(U);}else{var U={id:'id_setting',title:'Настройка подключений к информационным системам',icon:'Входящие'===r||'MenuLink'===u?'sprite:icon-24 icon-Admin icon-primary':'sprite:icon-24 icon-Admin icon-primary',handlers:{onActivated:N.showListUserSettings}};l.push(U);}p(l);var z=function(e,n){var t=f.find(l,function(e){if(e&&e.id===n)return true;else return false;});if(t&&t.handlers&&t.handlers.onActivated)t.handlers.onActivated(n,this);};if('Входящие'!=r||!s){if(o.hasEventHandlers('onMenuItemActivate'))o.unsubscribe('onMenuItemActivate',o.getEventHandlers('onMenuItemActivate')[0]);o.subscribe('onMenuItemActivate',z);}}).addErrback(function(e){c.subscribe('onMenuItemActivate',function(e,n){var t=f.find(l,function(e){if(e&&e.id===n)return true;else return false;});if(t&&t.handlers&&t.handlers.onActivated)t.handlers.onActivated(n,this);});});},updateMenu:function(e,n){if(!e)for(var t in _){if(!_.hasOwnProperty(t))continue;if(!_[t].reloadMenu(n))delete _[t];}else if(_[e])_[e].reloadMenu(n);},getService:function(e,n){var t=N.getUserConfig(e),r=N.paramModule[t.paramsConnection.nameModule].namePlugin,o=r.split('-')[0],i=function(e){if(n)return e.isRunning().addCallbacks(function(e){return e;},function(e){return false;});else return new w().callback(true);};if(!M[o])return g.requireModule('SBIS3.Plugin.Source.LocalService').addCallbacks(function(e){var n=new e[0]({endpoint:{address:r,contract:o},options:{mode:'always',queryTimeout:600000}});return i(n).addCallbacks(function(e){if(e)return n.isReady().addCallbacks(function(){return M[o]=n,n;},function(e){return new w().errback(e.message);});else return M[o]=false,false;},function(e){return new w().errback(e.message);});},function(e){return new w().errback(e.message);});else if(n)return i(M[o]).addCallbacks(function(e){if(e)return M[o];else return M[o]=false,false;},function(e){return new w().errback(e.message);});else return new w().callback(M[o]);},setSystemInfo:function(e,n){var t=N.getUserConfig(e);return n.call('setSystemInfo',{}).addCallbacks(function(e){if(e.error)return new w().errback(e.error);else if(e.result)e=e.result;if(t.connection.systemInfo=e,t.subsystem=e.subsystem,e.nameSubsystem)t.paramsConnection.nameSubsystem=e.nameSubsystem;if(!t.name_connection)t.name_connection=e.confName;return t.version=e.version,t.connected=true,true;},function(e){return new w().errback(e);});},getPlugin:function(e,n){var t=N.getUserConfig(e);if(!t.connection)t.connection={};if(!t.connection.plugin)return N.getService(e).addCallbacks(function(r){return r.call('getConnection',{param:n}).addCallbacks(function(r){return N.getVersionOnline().addCallbacks(function(o){return n.versionOnline=o,r.call('setConnectionInfo',{param:n}).addCallbacks(function(n){if(t.connection.plugin=r,n.idSession&&''!==n.idSession)return t.connected=true,N.setSystemInfo(e,r).addCallbacks(function(e){return r;},function(e){return new w().errback(e.message);});else return r;},function(e){return new w().errback(e.message);});},function(e){return new w().errback(e.message);});},function(e){return new w().errback(e.message);});},function(e){return new w().errback(e.message);});else return new w().callback(t['connection']['plugin']);},authorization:function(e,n){var t=N.getUserConfig(e),r={savePassword:t.paramsConnection['savePassword'],login:t.paramsConnection['login'],password:t.paramsConnection['password'],title:'Вход в '+t.name_connection};if(n&&!r['savePassword'])return function(){var n=SBIS3.EDO[t.paramsConnection.nameModule];if(n&&n.System&&n.System['getListUser'])return n.System.getListUser(e).addCallbacks(function(e){return new w().callback(e);},function(e){return new w().errback(e);});else return new w().callback();}().addCallbacks(function(n){return g.requireModule('SBIS3.EDO.ExtAuthorizationDialog').addCallback(function(){if(n)r['users']=n;return SBIS3.EDO.ExtAuthorizationDialog.showAuthorizationDialog(r).addCallback(function(n){if(n)if(n.savePassword||n.login!=t.paramsConnection['login'])return N.readConnection(e).addCallbacks(function(r){if(r)if(r.paramsConnection.savePassword!==n.savePassword||r.paramsConnection.password!==n.password||r.paramsConnection.login!==n.login){if(r.paramsConnection.savePassword=n.savePassword,!n.savePassword)r.paramsConnection.password='';else r.paramsConnection.password=n.password;return r.paramsConnection.login=n.login,r.connected=t.connected,r.connection=t.connection,O[e]=r,N.writeConnection(e).addCallbacks(function(){return n;},function(e){return new w().errback(e);});}else return n;else return n;},function(e){return new w().errback(e);});else return n;else return false;});});},function(e){return new w().errback(e);});else return new w().callback(r);},createConnection:function(e,n){var t=N.getUserConfig(e);if(!t.paramsConnection||!t.paramsConnection.nameModule)return new w().errback('Недостаточно параметров для подключения');else return N.initializeModule(t.paramsConnection.nameModule).addCallbacks(function(t){if(t.System&&t.System.createConnection)return t.System.createConnection(e,n).addCallbacks(function(e){return e;});else return N.showIndicator('Подключение к '+N.getParamModule(e).shortNameSystem+'...').addCallback(function(){return N.defaultCreateConnection(e,n,{}).addCallbacks(function(e){return N.hideIndicator(),e;},function(e){return N.hideIndicator(),new w().errback(e);});});},function(e){return new w().errback(e);});},defaultCreateConnection:function(e,t,r){var o=N.getUserConfig(e),i=SBIS3.EDO[o.paramsConnection['nameModule']],a=N.getPlugin,s=location.hostname,c=n.getAccountId();if(r['url']=o['url'],r['host']='https://'+s,r['AccountID']=c,r['id']=e,r['type']=o.paramsConnection['nameModule'],i&&i.System&&i.System.getPlugin)a=i.System.getPlugin;return a(e,r).addCallbacks(function(n){if(n)if(o.connected)return true;else return N.authorization(e,t).addCallback(function(t){if(t){if(o.paramsConnection['login']=t['login'],o.paramsConnection['savePassword']=t['savePassword'],t['savePassword'])o.paramsConnection['password']=t['password'];try{return n.call('login',{login:t.login?t.login:'',password:t.password?t.password:''}).addCallbacks(function(t){if('object'===typeof t&&t['error']){if('{'===t.error.substr(0,1))return new w().errback(t.error);}else return N.setSystemInfo(e,n).addCallbacks(function(e){return e;},function(e){return new w().errback(e);});},function(e){return o['connection']['plugin']='',new w().errback(e.message);});}catch(e){return o.connected=false,false;}}else return o.connected=false,false;});},function(e){return new w().errback(e.message);});},showListDocuments:function(e){var n=new Date(),t=e;if(D[e])var t=D[e];var o=t.filter;if(t['record']){var i=t['record'],a=i.getModelField('Контрагент.ИНН'),s=i.getModelField('Контрагент.КПП'),c=i.getModelField('ДокументНашаОрганизация.Контрагент.ИНН'),u=i.getModelField('ДокументНашаОрганизация.Контрагент.КПП');if(a)o['Контрагент']={'Название':i.getModelField('Лицо1.Название'),id:i.getModelField('Лицо1')};if(c)o['Организация']={'Название':i.getModelField('ДокументНашаОрганизация.Контрагент.Название'),id:i.getModelField('ДокументНашаОрганизация')};}if(t['ТекущиеДокументы']={},t['Страница']=1,o)t['filter']=jQuery.extend(t['filter'],o);var l=t['idConnection'],d=N.getUserConfig(l);return N.showIndicator('Подготовка данных...').addCallback(function(){return N.createConnection(l,true).addCallbacks(function(e){if(e){var n='ListDocuments',o='loadDocumentsPackage';if(t['СБИС_ИмяШаблона'])n=t['СБИС_ИмяШаблона'];if(t['СБИС_МетодЗагрузки'])o=t['СБИС_МетодЗагрузки'];t['nameTemplate']=n,t['methodLoad']=o;var i=900,a=1200;if('ListDocuments'!==n)i=750,a=750;N.hideIndicator(),r.attachInstance('Lib/Control/FloatArea/FloatArea',{modal:true,width:'930',height:0,autoWidth:false,autoHeight:true,autoHide:true,resizable:true,autoShow:true,catchScroll:true,side:'right',controlsSide:'right',autoCloseOnHide:true,verticalAlign:'top',isStack:true,keepSize:true,closeButton:false,minWidth:i,maxWidth:a,template:'js!SBIS3.EDO.ExtSysListDocuments',opener:m.getActiveWindow(),componentOptions:{params:t}});}else N.hideIndicator();},function(e){N.hideIndicator(),N.sendErrorReport(l,'Загрузка документов',t.reestr,e.message);});});},showListItems:function(e){if(D[e])var n=D[e];else var n=e;n['ТекущиеДокументы']={},n['Страница']=1;var t=n['idConnection'];N.createConnection(t,true).addCallbacks(function(e){if(e)p.hide(),r.attachInstance('Lib/Control/FloatArea/FloatArea',{caption:n.name,modal:true,width:'930',height:0,autoWidth:false,autoHeight:true,autoHide:true,resizable:true,autoShow:true,catchScroll:true,side:'right',controlsSide:'right',autoCloseOnHide:true,verticalAlign:'top',isStack:true,keepSize:true,closeButton:false,minWidth:908,maxWidth:1000,template:'js!SBIS3.EDO.IntListItems',opener:m.getActiveWindow(),handlers:{onAfterShow:function(){n['Страница']=1;var e=n['idConnection'];N.showIndicator('Получение списка элементов...').addCallback(function(){N.getListItems(n).addCallback(function(e){if(e)SBIS3.EDO.IntListItems.prototype.setListItems(e);N.hideIndicator();});});}},componentOptions:{params:n}});else N.hideIndicator();},function(e){N.hideIndicator(),N.sendErrorReport(t,'Загрузка справочников',n.reestr,e.message);});},showListUserSettings:function(){g.requireModule('SBIS3.EDO.ExtListUserSettings').addCallbacks(function(){r.attachInstance('Lib/Control/FloatArea/FloatArea',{target:$('body'),template:'js!SBIS3.EDO.ExtListUserSettings',height:0,autoWidth:false,autoHeight:true,modal:true,autoHide:true,autoShow:true,catchScroll:true,side:'right',controlsSide:'right',autoCloseOnHide:true,verticalAlign:'top',isStack:true,keepSize:true,minWidth:800,maxWidth:800});},function(e){N.hideIndicator(),N.sendErrorReport(idConnection,'Мастер подключения','',e.message);});},showExtConnectionWizard:function(e){if(k.isMacOSDesktop||k.isMobilePlatform)return;(function(){var n=l.createGUID(),t={subsystem:'',moduleNameWizard:e.moduleNameWizard,idConnection:n,paramsConnection:{}};if(N.userConfig()[n]&&N.userConfig()[n].connection)t.connection=N.userConfig()[n].connection,t.connected=N.userConfig()[n].connected;N.userConfig()[n]=t,r.attachInstance('Source:Dialog',{modal:true,width:'540',height:'325',autoHeight:false,resizable:false,closeButton:true,template:'js!SBIS3.EDO.ExtConnectionWizard',opener:m.getActiveWindow(),componentOptions:{params:e,idConnection:n}});}());},checkConnection:function(e){return N.getService(e,true).addCallback(function(n){if(n)return n.isRunning().addCallbacks(function(t){if(t)return n.isReady().addCallbacks(function(){return n.call('checkConnection',{idConnection:e.toString()}).addCallbacks(function(e){return e;},function(e){return false;});},function(){return false;});else return false;},function(){return false;});else return false;});},destroyConnection:function(e){var n=N.getUserConfig(e);return N.getService(e,true).addCallbacks(function(t){if(t)return t.call('removeConnection',{idConnection:e.toString()}).addCallbacks(function(e){return delete n.connected,delete n.connection,e;},function(e){return new w().errback(e);});},function(e){return new w().errback(e);});},writeConnection:function(e){var n=N.getUserConfig(e),t=N.getParamModule(e),r=n.service;if(t['service4Config'])r=t['service4Config'];if(!n.paramsConnection.savePassword)delete n.paramsConnection.savePassword,delete n.paramsConnection.password;n.paramsConnection['Service4Config']=r;var o={service:n.service,subsystem:n.subsystem,name_connection:n.name_connection,url:n.url,version:n.version,update_date:new Date(),json_connection:n.paramsConnection};if(n['@IntegrationConnection'])o['id']=n['@IntegrationConnection'];var a=new i({name:'IntegrationConnection',serviceUrl:'/integration_config/service/sbis-rpc-service300.dll'});return N.showIndicator('Сохранение подключения...').addCallback(function(){return a.call('WriteConnection_v2',{param:o},i.RETURN_TYPE_ASIS).addCallbacks(function(t){return n['@IntegrationConnection']=t,N.readConnection(t).addCallbacks(function(r){if(r['connected']=n.connected,r['connection']=n.connection,e!=t)return N.getService(e).addCallbacks(function(n){return n.call('setIdConnection',{idConnection:e.toString(),newIdConnection:t.toString()}).addCallbacks(function(n){if(N.hideIndicator(),n)return N.userConfig()[t]=r,delete N.userConfig()[e],t;else return false;},function(e){return N.hideIndicator(),new w().errback(e);});},function(e){return N.hideIndicator(),new w().errback(e.details?e.details:e);});else return O[e]=r,N.hideIndicator(),t;},function(e){return N.hideIndicator(),new w().errback(e);});},function(e){return N.hideIndicator(),new w().errback(e);});});},readConnection:function(e){if('string'==typeof e&&-1!=e.indexOf('-'))return new w().callback(false);var n={id:e,ini_array:[{ini_type:'Меню'}]};return new i({name:'IntegrationConnection',serviceUrl:'/integration_config/service/sbis-rpc-service300.dll'}).call('ReadConnection_v2',{param:n},i.RETURN_TYPE_RECORD).addCallbacks(function(e){return N.recordConnectionToJSON(e);},function(e){return new w().errback(e.details?e.details:e);});},readConnectionList:function(e,n){return new i({name:'IntegrationConnection',serviceUrl:'/integration_config/service/sbis-rpc-service300.dll'}).call('ReadConnectionList_v2',{param:{ini_array:[{ini_type:'Меню'}]}},i.RETURN_TYPE_RECORDSET).addCallbacks(function(e){var n={},t=N.userConfig();if(e){if(e.each(function(e){var t=N.recordConnectionToJSON(e);n[t['@IntegrationConnection']]=t;}),t)for(var r in n){if(!n.hasOwnProperty(r))continue;if(t[r]){if(t[r].connection)n[r].connection=t[r].connection;if(t[r].connected)n[r].connected=t[r].connected;}}return O=n,n;}else return false;},function(e){return false;});},setConnectionParam:function(e,n){var t=N.getParamModule(e).nameTemplate,r=N.getUserConfig(e);return g.requireModule('SBIS3.EDO.'+t+'_Step3').addCallbacks(function(t){var o=true;if(t[0].prototype.prepareConnectionSettings)o=t[0].prototype.prepareConnectionSettings(e,n);if(o){if(n.hasChildControlByName('nameConnection'))r.name_connection=n.getChildControlByName('nameConnection').getText();if(n.hasChildControlByName('user'))r.paramsConnection.login=n.getChildControlByName('user').getText(),r.paramsConnection.password=n.getChildControlByName('password').getText(),r.paramsConnection.savePassword=n.getChildControlByName('savePassword').isChecked();}return o;},function(n){N.sendErrorReport(e,'Мастер подключения','',n.message);});},getListItems:function(e){var n=e['idConnection'];return N.getUserConfig(n).connection.plugin.call('getListItems',{iniName:e.reestr,filter:e}).addCallbacks(function(e){var n=[],t={};for(var r in e)if(e.hasOwnProperty(r))if(!t[e[r].id]){if(!e[r]['parent@'])e[r]['parent@']=null;if(!e[r].parent)e[r]['parent']=null;n.push(e[r]),t[e[r].id]=e[r].id;}return n;},function(t){return N.sendErrorReport(n,'Загрузка справочников',e.reestr,t.message),N.hideIndicator(),false;});},setDocumentPackage:function(e,n){var t=new Date(),r=new Date();return N.getUserConfig(e).connection.plugin.call('setDocument',{jsonPackage:n}).addCallbacks(function(e){var n=new Date();if(N.debug){var o=(new Date()-t)/1000,i=(n-r)/1000;N.leadTime.setDocumentPackage.push({cleanTime:o-i,uncleanTime:o});}return e;},function(t){var r=N.errorHandler(t),o=t.message.substr(0,100);if(r['detail'])o=r['detail'].substr(0,100);N.errors[S.encode(o,'UTF-8')]={idConnection:e,action_name:'Выгрузка документов',action_param:n['Тип'],error:r['message']};var i='Контрагент не указан';if(n['Контрагент'])if(n['Контрагент']['СвЮЛ'])i=n['Контрагент']['СвЮЛ'].Название;else if(i=n['Контрагент']['СвФЛ'].Название,!i){i='';var a=n['Контрагент']['СвФЛ'];if(a['Фамилия'])i=i+a['Фамилия']+' ';if(a['Имя'])i=i+a['Имя']+' ';if(a['Отчество'])i+=a['Отчество'];}return{ID:n['Идентификатор'],Partner:i,Date:n['Дата'],Time:n['ДатаВремяСоздания'].substr(11,5),Attachments:[{Error:r.message,Name:n['Название']}]};});},unloadDocumentsPackage:function(e,n){if(N.errors=[],0===n.length)return;var t=new Date(),r=D[e],o=h.resolve('ILogger'),a=r.idConnection,s=N.getUserConfig(a),c=SBIS3.EDO[s.paramsConnection.nameModule];o.log('unloadDocumentsPackage','Старт '+new Date());var l=function(e){g.require(['js!SBIS3.EDO.IntResultUnload']).addCallback(function(){SBIS3.EDO.IntResultUnload.showUnloadResultDialog(e);});};N.createConnection(a,true).addCallbacks(function(e){if(e){var o=[];N.showIndicator('Идёт выгрузка, пожалуйста, подождите...',n.length>3?true:false).addCallback(function(){var e=Math.round(o.length/n.length*100);P.setProgress(e);var s=new Date();(function(){var e=new b();e._options.maxRunningCount=N.getParamModule(a).countFlows;for(var t=function(e){return function(){var t=e.Идентификатор.toString(),s=t.indexOf(',');if(s>-1)t=t.substring(0,s);return new i('ОсновнойРедактируемыйДокумент').call('Сгенерировать',{'ключДокумента':t},i.RETURN_TYPE_ASIS).addCallbacks(function(s){return new i('Интеграция').call('ПолучитьПакет',{'Идентификатор':t},i.RETURN_TYPE_ASIS).addCallbacks(function(i){if(i['Ошибка']){var s=i['Ошибка'].substr(0,100),c=JSON.stringify({code:i['code_error'],message:i['Ошибка'],stack:[{methodName:i['methodName']}],dump:{}});N.errors[S.encode(s,'UTF-8')]={idConnection:a,action_name:'Выгрузка документов',error:c,action_params:r.type_doc};var l=e['Дата'];return{ID:e.Идентификатор.toString(),Partner:e.Контрагент.toString(),Date:u.format({date:l},'$date$t$%d.%m$'),Time:u.format({date:l},'$date$t$%H:%M$'),Attachments:[{Error:'Ошибка при получении данных',Name:''}]};}else{if(i['СБИСТип']=r.type_doc,i['СБИСИдМеню']=r.nameButton,N.debug)N.leadTime.ПолучитьПакет.push({uncleanTime:i['uncleanTime'],cleanTime:i['cleanTime']});return N.setDocumentPackage(a,i).addCallback(function(e){e['ID']=t,e['type']=i.Тип,o.push(e);var r=Math.round(o.length/n.length*100);if(P)P.setProgress(r);return e;});}},function(n){var t=n.message.substr(0,100);N.errors[S.encode(t,'UTF-8')]={idConnection:a,action_name:'Выгрузка документов',error:n.message+'; '+n.details,action_params:r.type_doc};var o=e['Дата'];return{ID:e.Идентификатор.toString(),Partner:e.Контрагент.toString(),Date:u.format({date:o},'$date$t$%d.%m$'),Time:u.format({date:o},'$date$t$%H:%M$'),Attachments:[{Error:'Ошибка при получении данных',Name:''}]};});},function(n){var t=n.message.substr(0,100);N.errors[S.encode(t,'UTF-8')]={idConnection:a,action_name:'Выгрузка документов',error:n.message+'; '+n.details,action_params:params.reestr};var r=e['Дата'];return{ID:e.Идентификатор.toString(),Partner:e.Контрагент.toString(),Date:u.format({date:r},'$date$t$%d.%m$'),Time:u.format({date:r},'$date$t$%H:%M$'),Attachments:[{Error:objectError.Сообщение,Name:''}]};});};},s=0;s<n.length;s++)e.push(t(n[s]));return e.done().getResult().addCallbacks(function(e){return e;},function(e){return new w().errback(e);});}().addCallbacks(function(e){var n=new Date();if(!e)return;var r={};if(e.constructor===Object){var o=[];for(var i in e){if(e.hasOwnProperty(i)&&e[i])o.push(e[i]);if(e[i].Attachments){var c=e[i].Attachments,u=false;for(var d in c){if(!c.hasOwnProperty(d))continue;if(!c[d].Error){u=true;break;}}if(u)if(r[e[i]['type']])r[e[i]['type']]=r[e[i]['type']]+1;else r[e[i]['type']]=1;}}e=o;}if(0===e.length)return;for(var f in r){if(!r.hasOwnProperty(f))continue;N.addIntegrationUse(a,'Выгрузка документов',f,r[f]);}var m=N.errors;for(var g in m){if(!m.hasOwnProperty(g))continue;N.sendErrorReport(m[g].idConnection,m[g].action_name,m[g].action_params,m[g].error,true);}if(N.errors={},N.hideIndicator(),N.debug){var p=(new Date()-t)/1000,C=(n-s)/1000;N.leadTime.unloadDocumentsPackage.push({cleanTime:p-C,uncleanTime:p}),N.showDifferenceTime();}return h.resolve('ILogger').log('unloadDocumentsPackage','Финиш '+new Date()),l(e);},function(e){N.hideIndicator(),N.sendErrorReport(a,'Выгрузка документов','',e.message);}));});}},function(e){N.hideIndicator(),N.sendErrorReport(a,'Выгрузка документов','',e.message);});},loadReportingPackage:function(t,r){var o=t.reestr,i=t['idConnection'],u=new b(),l=N.getUserConfig(i),d=[],f=new c({idProperty:'PK'}),m=new c({idProperty:'PK'});u._options.maxRunningCount=N.getParamModule(i).countFlows,N.showIndicator('Идёт загрузка, пожалуйста, подождите...',r.length>3?true:false).addCallback(function(){require(['js!SBIS3.FL.FileResult','js!SBIS3.CORE.ServerEventBus','js!SBIS3.Plugin.Source.LocalService','js!WS.Data/Source/SbisService'],function(t,g,p,C){var h=new p({endpoint:{address:'FileLoader-0.0.0.26',contract:'FileLoader'},options:{mode:'always',queryTimeout:600000}});h.isReady().addCallbacks(function(){var p=function(e){return l.connection.plugin.call('getDocumentPackageTax',{nameRegistry:o,jsonRecordFromListDocuments:e.getRawData()}).addCallbacks(function(e){var n=[];for(var t in e['Вложение']){if(!e['Вложение'].hasOwnProperty(t))continue;for(var r in e['Вложение'][t]){if(!e['Вложение'][t].hasOwnProperty(r))continue;var o=e['Вложение'][t][r];if(0===o['Ошибки'].length)n.push(o);else f.add(new s({rawData:{PK:21,Name:o.name,Msg:o['Ошибки'][0],UserMsg:o['Ошибки'][0],Code:42000,Parameters:new s(),Info:null}}));}}return n;},function(e){return new w().errback(e);});},S=function(e){var t=function(e){var t={fileName:e.path,newFileName:e.name,targetURL:'https://'+location.hostname+'/disk/api/v1/temp',AccountID:n.getAccountId(),removeAfterUpload:true};return function(){var n=new w(),r=function(t,o){v.channel('SbisPluginEvent').unsubscribe('uploadToSbisDiskCompleteEvent',r);var i=JSON.parse(o.UploadJson);e['fileid']=i.fileid,e['versionid']=i.versionid,n.callback(e);};return h.call('uploadToSbisDisk',{requestParams:JSON.stringify(t)}).addCallbacks(function(e){},function(e){return new w().errback(e);}),v.channel('SbisPluginEvent').subscribe('uploadToSbisDiskCompleteEvent',r),n;};};return function(){var n=new w();return p(e).addCallbacks(function(e){if(e.length){var o=new b();o._options.maxRunningCount=N.getParamModule(i).countFlows;for(var u=0;u<e.length;u++)o.push(t(e[u]));o.done().getResult().addCallbacks(function(e){var t=new C({endpoint:{address:'/fileloader-facade/service/',contract:'Uploading'}}),o={d:[0,false],s:[{n:'Source',t:'Число целое'},{n:'LRS',t:'Логическое'}],_type:'record'},i=[];for(var u in e){if(!e.hasOwnProperty(u))continue;i.push([e[u].name,e[u].size,{d:[e[u].fileid,e[u].versionid],s:[{n:'ИдентификаторДискДокумент',t:'UUID'},{n:'ИдентификаторДискВерсияДокумента',t:'Строка'}],_type:'record'}]);}var l=new c(i),f={Settings:o,Files:{d:i,s:[{n:'Name',t:'Строка'},{n:'Size',t:'Число целое'},{n:'Parameters',t:'Запись'}]}},m=function(e,o){g.serverChannel('fileloader.uploaded').unsubscribe('onMessage',m);var i=new s({rawData:o.getRawData(),adapter:new a()});t.call('GetResult',{ID:i.get('ID')}).addCallback(function(e){d.push(e);var t=Math.round(d.length/r.length*100);if(P)P.setProgress(t);n.callback(e);});};t.call('Create',f).addCallbacks(function(e){},function(e){return new w().errback(e.message);}),g.serverChannel('fileloader.uploaded').subscribe('onMessage',m);},function(e){return new w().errback(e.message);});}else{d.push(null);var l=Math.round(d.length/r.length*100);if(P)P.setProgress(l);n.callback(null);}},function(e){return new w().errback(e.message);}),n;};};for(var k in r){if(!r.hasOwnProperty(k))continue;u.push(S(r[k]));}u.done().getResult().addCallbacks(function(n){for(var r in n){if(!n.hasOwnProperty(r))continue;if(!n[r])continue;var c=new s({rawData:n[r].getRawData(),adapter:new a()}),u=c.get('LoadedFiles'),l=c.get('FailedFiles');u.each(function(e){m.add(new s({rawData:e.toObject()}));}),l.each(function(e){f.add(new s({rawData:e.toObject()}));});}if(n.length)N.addIntegrationUse(i,'Загрузка отчетности',o,n.length);e.ControlStorage.getByName('DataGridView').getTopParent().close(),N.hideIndicator();var d=new s({rawData:{PK:1707992,Status:4,Error:null,LoadedFiles:m,FailedFiles:f}});t.show({record:d});},function(e){N.hideIndicator(),N.sendErrorReport(i,'Загрузка отчетности',o,e.message);});},function(e){N.hideIndicator(),N.sendErrorReport(i,'Загрузка отчетности',o,e.message);});},function(e){N.hideIndicator(),N.sendErrorReport(i,'Загрузка отчетности',o,e.message);});});},getDocumentPackage:function(e,n,t,r,o){var i=new Date(),a=new Date(),c=N.getUserConfig(e).connection.plugin,u='writeDocument',l;if(r){u='loadAttachment';var d=r.getRawData();l={nameRegistry:n,jsonRecordFromListDocuments:t.getRawData(),stringRecordDocument:JSON.stringify(d),typeDocument:o};}else l={nameRegistry:n,jsonRecordFromListDocuments:t.getRawData()};var f=function(r){var o=N.errorHandler(r),i=r.message.substr(0,100);if(o['detail'])i=o['detail'].substr(0,100);N.errors[S.encode(i,'UTF-8')]={idConnection:e,action_name:'Загрузка документов',action_param:n,error:JSON.stringify(o)};var a=t.get('Вложения').getCount()>0?t.get('Вложения').at(0).get('Название'):'';return{'Ошибка':{PK:o['code'],Name:a,Msg:o['message'],UserMsg:o['message'],Code:42000,Parameters:new s(),Info:null}};};return c.call(u,l).addCallbacks(function(e){var n=new Date();if(e['error'])return f({message:e['error']});else if(e['result'])return e['result'];else return e;},function(e){return new w().callback(f(e));});},loadDocumentsPackage:function(n,t){if(0==t.length)return;N.errors={};var r=new Date(),o=n['idConnection'],i=n.reestr,u=n['record'],l=n['idDocument'],d=n['type_doc'];h.resolve('ILogger').log('loadDocumentsPackage','Старт '+new Date()),N.createConnection(o,true).addCallbacks(function(){var r=[],l=function(){var e=new b();e._options.maxRunningCount=N.getParamModule(o).countFlows;var n=function(e){return function(){return N.getDocumentPackage(o,i,e,u,d).addCallbacks(function(e){if(N.debug)N.leadTime.ЗагрузитьПакет.push({uncleanTime:e['uncleanTime'],cleanTime:e['cleanTime']});r.push(e);var n=Math.round(r.length/t.length*100);if(P)P.setProgress(n);return e;},function(e){return new w().errback(e);});};};for(var a in t){if(!t.hasOwnProperty(a))continue;e.push(n(t[a]));}return e.done().getResult().addCallbacks(function(e){return new w().callback(e);},function(e){return new w().errback(e);});};p.hide(),N.showIndicator('Идёт загрузка, пожалуйста, подождите...',t.length>3?true:false).addCallback(function(){var d=Math.round(r.length/t.length*100);P.setProgress(d),l().addCallbacks(function(t){if(!t)return;var r=0;if(t.constructor===Object){var l=[];for(var d in t)if(t.hasOwnProperty(d)&&t[d])if(l.push(t[d]),!t[d].error)r++;t=l;}if(0===t.length)return;if(r){var f=i.split('_');N.addIntegrationUse(o,'Загрузка документов',f.length>1?f[1]:i,r);}var m=N.errors;for(var p in m){if(!m.hasOwnProperty(p))continue;N.sendErrorReport(m[p].idConnection,m[p].action_name,m[p].action_param,m[p].error,true);}if(N.errors={},!u)g.require(['js!SBIS3.FL.FileResult']).addCallbacks(function(){for(var e=[],r=[],o=0;o<t.length;o++){if(!t[o])continue;if(t[o]['Ошибка'])if('object'===typeof t[o].Ошибка)e.push(t[o]['Ошибка']);else{var i={PK:t[o]['code_error'],Name:t[o]['Название'],Msg:t[o]['Ошибка'],UserMsg:t[o]['Ошибка'],Code:42000,Parameters:new s(),Info:null};if(t[o]['ИдО'])i['PK']='ИдО'+t[o]['ИдО'];e.push(i);}else r.push({PK:t[o]['ИдО'],Document:t[o]['ИдО'],DocName:t[o]['Название'],DocType:'',DocSubType:'',Name:t[o]['Название'],Info:new s({rawData:{'РП.ОсновнаяИнформация':new s({rawData:JSON.parse(t[o]['ОсновнаяИнформация']),adapter:new a()}),'РП.ДополнительнаяИнформация':new c({rawData:JSON.parse(t[o]['ДополнительнаяИнформация']),adapter:new a()}),OpenMode:4,'ИдентификаторДиск':t[o]['Идентификатор'],'Дата':new Date(t[o]['Дата']),'Номер':t[o]['Номер'],DocTypeCaption:t[o]['Регламент']}})});}var u={PK:1707992,Status:4,Error:null,LoadedFiles:new c({rawData:r,idProperty:'PK'}),FailedFiles:new c({rawData:e,idProperty:'PK'})},l={record:new s({rawData:u}),handlers:{onErrorBrowserClick:function(e,t){if(t.get('isNode'))return;var r=t.get('loadKey');if(r&&'string'===typeof r&&'ИдО'===r.substr(0,3))r=r.substr(3),g.requireModule('SBIS3.EDO2.OpenDialogAction').addCallback(function(e){new e[0]().execute({id:r,openMode:4,isNewRecord:true,linkedObject:_[n.nameButton].view});});},onBeforeOpenDoc:function(e,n){if(n.get('isNode'))return;var t=n.get('loadKey');if(t&&'string'===typeof t&&'ИдО'===t.substr(0,3))t=t.substr(3),g.requireModule('SBIS3.EDO2.OpenDialogAction').addCallback(function(e){new e[0]().execute({id:t});});return false;}}};SBIS3.FL.FileResult.show(l),N.hideIndicator();},function(e){N.sendErrorReport(o,'Загрузка документов',i,e.message);});var C=e.ControlStorage.getByName('DataGridView').getTopParent(),v='';if(!v){var S=C.getOpener().getTopParent();if(S.hasChildControlByName('browserView'))v=S.getChildControlByName('browserView');}if(C.close(),v&&v.reload)v.reload();if(n['updateFormDocument'])n['updateFormDocument'](true);if(N.hideIndicator(),h.resolve('ILogger').log('loadDocumentsPackage','Финиш '+new Date()),N.debug)N.showDifferenceTime();},function(e){N.sendErrorReport(o,'Загрузка документов',i,e.message);});});},function(e){N.sendErrorReport(o,'Загрузка документов',i,e.message);});},loadItems:function(n,r){if(null==r)return;var o=n['idConnection'],i=N.getUserConfig(o),a=n['СБИС_МетодЗагрузки'],s=h.resolve('ILogger'),c=n.reestr,u=r.length,l=0,f=[],m=[];s.log('loadItems','Старт '+new Date());var g=function(){var e=new b(),n=true;e._options.maxRunningCount=N.getParamModule(o).countFlows;var t=function(e){return function(){return i.connection.plugin.call('getItem',{nameRegistry:c,item:e}).addCallbacks(function(t){if(t.error)f.push(t.error);if(t.result){var r=t.result;if(void 0!==e['parent'])r['parent']=e['parent'];if(void 0!==e['parent@'])r['parent@']=e['parent@'];if(a)return i.connection.plugin.call(a,{item:r}).addCallbacks(function(e){if(e.result)m.push(e.result);if(e.error)f.push(e.error);var n=Math.round(m.length/u*100);return P.setProgress(n),r;},function(e){return n=false,new w().errback(e);});else{m.push(r);var o=Math.round(m.length/u*100);return P.setProgress(o),r;}}else return null;},function(e){return n=false,new w().errback(e);});};};for(var s in r){if(!r.hasOwnProperty(s))continue;if(!n)break;var l=r[s];e.push(t(l));}return e.done().getResult().addCallbacks(function(e){return e;},function(e){return new w().errback(e);});};N.showIndicator('Идёт получение данных, пожалуйста, подождите...',r.length>3?true:false).addCallback(function(){var a=Math.round(m.length/r.length*100);P.setProgress(a),g().addCallbacks(function(a){return function(e){var t=n['СБИС_МетодПослеЗагрузки'];if(t){N.hideIndicator();var o=function(e,n){P.setProgress(Math.round(n['progress']/r.length*100));};return v.channel('SbisPluginEvent').subscribe('extLoadItems',o),N.showIndicator('Идёт загрузка данных, пожалуйста, подождите...',e.length>3?true:false).addCallback(function(){return i.connection.plugin.call(t,{iniName:c,items:m}).addCallbacks(function(e){if(l=e['result'].countLoadItems,e.error)if('[object Array]'==Object.prototype.toString.call(e.error))f=f.concat(f,e.error);else f.push(e.error);return e;},function(e){return new w().errback(e);});});}else return l=d.countOfProperties(e),new w().callback();}(a).addCallbacks(function(n){if(e.ControlStorage.containsByName('ListItems'))e.ControlStorage.getByName('ListItems').getTopParent().close();if(0!=f.length)for(var r=0;r<f.length;r++)N.sendErrorReport(o,'Загрузка справочников',c,f[r],true);if(N.hideIndicator(),t.alert('Загрузка закончена','Загружено '+l+' из '+u,'success'),e.ControlStorage.containsByName('browserView'))e.ControlStorage.getByName('browserView').reload();},function(e){N.hideIndicator(),N.sendErrorReport(o,'Загрузка справочников',c,e.message);});},function(e){N.hideIndicator(),N.sendErrorReport(o,'Загрузка справочников',c,e.message);});});},loadItemsNomenclature:function(n,t){var r=N.getUserConfig(n),o=new w();return N.showIndicator('Идёт загрузка данных, пожалуйста, подождите...',false).addCallback(function(){r.connection.plugin.call('getCatalog',{}).addCallbacks(function(t){new i('NomenclatureImport').call('impotrCMLFromBase64',{source:S.encode(t,'utf-8')},i.RETURN_TYPE_ASIS).addCallbacks(function(n){if(e.ControlStorage.containsByName('ListItems'))e.ControlStorage.getByName('ListItems').getTopParent().close();if(e.ControlStorage.containsByName('browserView'))e.ControlStorage.getByName('browserView').reload();o.callback(n);},function(e){N.sendErrorReport(n,'Загрузка справочников','Номенклатура',e.message,true),o.callback(false);});},function(e){N.sendErrorReport(n,'Загрузка справочников','Номенклатура',e.message,true),o.callback(false);});}),o;},getVersionOnline:function(){if(E)return new w().callback(E);else return new i('Платформа').call('Версия',{},i.RETURN_TYPE_ASIS).addCallbacks(function(e){return E=e,e;},function(e){return new w().errback(e);});},showDifferenceTime:function(){var e=h.resolve('ILogger');for(var n in N.leadTime){if(!N.leadTime.hasOwnProperty(n))continue;for(var t=N.leadTime[n],r=0,o=0,i=0;i<t.length;i++)if('object'===typeof t[i])r+=t[i]['cleanTime'],o+=t[i]['uncleanTime'];else o+=t[i];if(0!==t.length)if(e.log(N.nameFunction[n],'Общее время: грязное: '+o.toFixed(2)+'c., чистое: '+r.toFixed(2)+'c. на '+t.length+' замеров.'),1!=t.length)e.log(N.nameFunction[n],'Среднее время: грязное: '+(o/t.length).toFixed(2)+'c., чистое: '+(r/t.length).toFixed(2)+'c. на '+t.length+' замеров.');}N.leadTime={'ЗагрузитьПакет':[],'ПолучитьПакет':[],getDocumentPackage:[],setDocumentPackage:[],unloadDocumentsPackage:[],showListDocuments:[],getListDocument:[]};},initializeModule:function(e){if(SBIS3.EDO[e]){var n=SBIS3.EDO[e];return new w().callback(n);}else return N.showIndicator('Загрузка модуля подсистемы...').addCallback(function(){return g.requireModule('SBIS3.EDO.'+e).addCallbacks(function(n){var t=SBIS3.EDO[e];return N.hideIndicator(),t;},function(n){if(N.hideIndicator(),-1!==n.message.indexOf('is not defined'))t.alert('Модуль '+e+' не найден.');return new w().errback(n);});});},recordConnectionToJSON:function(e){var n={},t={},r=e.toObject(),o={},i=r['data'],a=r['json_connection'];if(a&&'{'===a.substr(0,1))o=JSON.parse(a);if(i&&'{'===i.substr(0,1))if(n=JSON.parse(i),n['сбисМеню'])t=n['сбисМеню']['data'];if(delete r['json_connection'],delete r['data'],!o['nameModule'])for(var s in N.paramModule)if(N.paramModule[s].service===r.service){o['nameModule']=s;break;}return r['paramsConnection']=o,r['menu']=t,r;},readListRecords:function(e){var n=e['idConnection'];return N.getUserConfig(n).connection.plugin.call('ReadListRecords',{iniName:e.reestr,filter:e}).addCallbacks(function(e){return e;},function(e){return new w().errback(e);});},readPredefinedObject:function(e,n){var t=e['idConnection'];return N.getUserConfig(t).connection.plugin.call('ReadPredefinedObject',{param:e,iniParam:n}).addCallbacks(function(e){return e;},function(e){return new w().errback(e);});},createRecord:function(e){var n=e['idConnection'];return N.getUserConfig(n).connection.plugin.call('getItem',{nameRegistry:e.reestr,item:e.item}).addCallbacks(function(e){return e;},function(e){return new w().errback(e);});},getUserConfig:function(e){return O[e];},userConfig:function(e){if(void 0!==e)O=e;return O;},showIndicator:function(e,n){if(P)return P.setMessage(e),I.push(e),new w().callback();return r.attachInstance('Control/LoadingIndicator',{message:e?e:'Пожалуйста, подождите...',showInWindow:true,showPercent:true,progressBar:n?true:false}).addCallback(function(n){P=n,I.push(e),setTimeout(function(){return;},100);});},hideIndicator:function(){if(1==I.length&&P)P.hide(),P.destroy(),P=null,I=[];else if(I.length>1){I.splice(I.length-1);var e=I[I.length-1];P.setMessage(e);}},getParamModule:function(e){var n=N.getUserConfig(e);if(n.paramsConnection&&n.paramsConnection.nameModule&&N.paramModule[n.paramsConnection.nameModule])return N.paramModule[n.paramsConnection.nameModule];else return{};},addIntegrationUse:function(e,n,t,r){try{var o='extExch',a=N.getUserConfig(e)['subsystem'],s={service:o,module:N.getParamModule(e).service,subsystem:a,action_name:n,action_param:t,connection_id:e,count:r};new i({name:'IntegrationStat',serviceUrl:'/integration_config/service/sbis-rpc-service300.dll'}).call('Write',{param:JSON.stringify(s)},i.RETURN_TYPE_ASIS);}catch(e){}},getCodeClientError:function(e){var n={401:'Не удалось получить ответ за разумное время',402:'Не удается подключиться к хосту',403:'Очередь на обработку заполнена',404:'Не удалось запустить NPAPI плагин',405:'не может быть получено с сервера обновлений',406:'Не удалось запустить AcitveX компонент',407:'Отсутствует сертификат',408:'Расширение ExtCom1C не найдено',409:'Отправка команды после destroy',410:['СБИС Плагин закрыл соединение','Подключение к СБИС Плагин закрылось'],411:'Не найдена функция соотвествующая параметрам',412:'Не удалось подключиться к СБИС Плагин'};for(var t in n)if('[object Array]'==Object.prototype.toString.call(n[t])){for(var r=0,o=n[t].length;r<o;r++)if(-1!=e.indexOf(n[t][r]))return t;}else if(-1!=e.indexOf(n[t]))return t;return 400;},getDescriptionError:function(e){var n={102:{message:'Нам не удалось найти 1С на вашем ПК',link:'https://help.sbis.ru/help/integration/1C_set/err_config/'},103:{message:'Нам не удалось найти 1С на вашем ПК',link:'https://help.sbis.ru/help/integration/1C_set/64bit/'},400:{message:'Неизвестная ошибка СБИС Плагина'},401:{message:'Не удалось получить ответ за разумное время',link:'https://help.sbis.ru/help/integration/1C_set/problems_window1C/'},402:{message:'Не удается подключиться к хосту',link:''},403:{message:'Очередь на обработку заполнена',link:''},404:{message:'Не удалось запустить NPAPI плагин',link:''},405:{message:'Расширение не может быть получено с сервера обновлений',link:''},406:{message:'Не удалось запустить AcitveX компонент',link:''},407:{message:'Отсутствует сертификат',link:''},408:{message:'Расширение ExtCom1C не найдено',link:''},409:{message:'Сеанс с учетной системой завершен. Обновите страницу',link:''},410:{message:'Подключение к СБИС Плагин закрылось. Проверьте, что он включен и ничего не блокирует его работу',link:''},412:{message:'Не удалось подключиться к СБИС Плагин. Проверьте, что он включен и ничего не блокирует его работу',link:''},604:{message:'Ошибка получения данных из ИС',link:'https://help.sbis.ru/help/integration/1C_set/problems_data1C/'},701:{message:'Существуют активные сеансы работы с данной базой, использующие платформу другой версии',link:'https://help.sbis.ru/help/integration/1C_set/data_base/'},703:{message:'Ошибка создания подключения к 1С',link:'https://help.sbis.ru/help/integration/1C_set/err_config_app/'},704:{message:'Указанному пользователю не дано право на запуск 1С:Предприятие через OLE Automation',link:'https://help.sbis.ru/help/integration/1C_set/low/'},705:{message:'Информационная база не обнаружена',link:'https://help.sbis.ru/help/integration/1C_set/problems_base1C/'},706:{message:'Конфигурация не поддерживается',link:'https://help.sbis.ru/help/integration/1C_set/problems_config1C/'},707:{message:'Попытка чтения или записи в защищенную память',link:'https://help.sbis.ru/help/integration/1C_set/problems_hasp/'},708:{message:'Не обнаружено свободной лицензии 1С',link:'https://help.sbis.ru/help/integration/1C_set/problems_licence1C/'},709:{message:'Ошибка в ограничении доступа к данным',link:'https://help.sbis.ru/help/integration/1C_set/base_limited/'},710:{message:'Ошибка блокировки данных',link:'https://help.sbis.ru/help/integration/1C_set/split_access/'},711:{message:'Несоответствие версий клиента и сервера',link:'https://help.sbis.ru/help/integration/1C_set/err_var/'},712:{message:'Неверно указан URL-адрес информационной базы',link:'https://help.sbis.ru/help/integration/1C_set/problems_url/'},713:{message:'Внешнее соединение не разрешено для указанного пользователя 1С:Предприятие',link:'https://help.sbis.ru/help/integration/1C_set/ext_con/'},714:{message:'На вашем компьютере не найдено установленного Store House',link:'https://help.sbis.ru/help/integration/StoreHouse/questions/lost/'},715:{message:'При создании новой редакции документа не допускается смена типа документа',link:''},716:{message:'Платформа не поддерживается. Используйте версию выше текущей',link:'https://help.sbis.ru/help/integration/1C_set/problems_platform/'}};if(n[e])return n[e];return{message:'Неизвестная ошибка системы'};},getNameBrowser:function(e){var n='';for(var t in e)if(e.hasOwnProperty(t)&&true===e[t])n=n+(''===n)?t:', '+t;return n;},errorHandler:function(e){var n={};if(e.message&&e.message.length>0&&'{'===e.message.substr(0,1))n=JSON.parse(e.message);else n['code']=N.getCodeClientError(e.message,'Ошибка при получении данных из '+N.paramModule[connSettings.paramsConnection.nameModule].shortNameSystem),n['message']=N.getDescriptionError(n['code']);return n;},sendErrorReport:function(e,n,r,o,a){var s=N.getUserConfig(e),c=h.resolve('ILogger'),u=s.paramsConnection.nameModule,l=s.name_connection,d={};if(o&&'{'===o.substr(0,1)){d=JSON.parse(o);var f=N.getDescriptionError(d.code);if(!f.link)f=null;c.log(n,d['methodName']+': '+d['message']+'('+d['detail']+')');}else{var m=N.getCodeClientError(o);d={code:m,message:N.getDescriptionError(m).message,detail:o},c.log(n,o);}var g=f?f.message:d.message;if(d.code>700)g=d.detail?d.detail:d.message;if(u)l=N.paramModule[s.paramsConnection.nameModule].shortNameSystem;if(!a)if(f||d.detail)t.alert(g,f&&f.link?'<a target="_blank" href="'+f.link+'"> Подробнее...</a>':'','error');else t.alert('Ошибка при получении данных из '+l,d.message?d.message:o,'error');if(702===d['code'])return;var p='',C='extExch',v='';if(s['subsystem'])v=s['subsystem'];if(s['service'])p=s['service'];var S={service:C,module:p,subsystem:v,action_name:n,action_param:r?r:'',error_name:f?f.message:d.message,error_detail:d.detail?d.detail:d.message,stack:d.stack?d.stack:{},code:d.code,count:1},b={};if(s['connection']&&s['connection']['systemInfo'])b=s['connection']['systemInfo'];if(b['browser']=N.getNameBrowser(k),S['systemInfo']=b,S['error_name']){var w=new i({name:'IntegrationError',serviceUrl:'/integration_config/service/sbis-rpc-service300.dll'}),y=JSON.stringify({service:S['service'],module:S['module'],subsystem:S['subsystem'],action_name:S['action_name'],action_param:S['action_param'],error_name:S['error_name'],error_detail:S['error_detail'],data:JSON.stringify(S),code:S['code'],connection_id:0,count:S['count']});w.call('Write',{param:y},i.RETURN_TYPE_ASIS);}}};if(!y.isRegistered('IntEngine'))y.register('IntEngine',N,{instantiate:false});return N;});
define("html!SBIS3.EDO.ExtAuthorization",function(){var t=function(t){var o=function(){var t=/\{\{([\s\S]+?)\}\}/g;return function(o){for(;t.test(o);)o=o.replace(t,"&#123;&#123;$1&#125;&#125;");return o}}(),n=function(t){return t.join?t.join(""):t.toString()},e=function(t){return void 0===t?"":t&&"object"==typeof t?n(t):""+t},i="undefined"!=typeof process,r=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div> <table style="width: 100%;"> <tr> <td style="width: '+o(e(t.widthTitle))+'; vertical-align: top;"> <div style="color: #8991A9; padding-top: 3px;">'+o(e(rk("Пользователь")))+'</div> </td> <td style="width:auto;"> <component data-component="SBIS3.CONTROLS/TextBox" name="user" class="position" style="width: '+o(e(t.widthField))+'; margin-bottom: 8px;"> <option name="placeholder">Введите имя пользователя</option> <option name="tabindex">1</option> </component> <component data-component="SBIS3.CONTROLS/ComboBox" name="listUsers" style="width: 270px; margin-bottom: 8px;"> <option name="visible">false</option> <option name="idProperty">key</option> <option name="displayProperty">title</option> <option name="isEditable">true</option> <option name="setEmptyHTML"></option> <option name="pickerClassName">listUser</option> </component> </td> </tr> <tr> <td style="width: 100px; vertical-align: top;"> <div style="color: #8991A9; padding-top: 3px;">'+o(e(rk("Пароль")))+'</div> </td> <td> <component data-component="SBIS3.CONTROLS/PasswordTextBox" name="password" class="position" style="width: '+o(e(t.widthField))+'; margin-bottom: 2px;"> <option name="placeholder">Введите пароль</option> </component> </td> </tr> <tr> <td></td> <td> <component data-component="SBIS3.CONTROLS/CheckBox" name="savePassword" style="text-align: left; margin-left: -5px;"> <option name="caption">запомнить пароль</option> </component> </td> </tr> </table> </div>');return(r=o(r))+(i&&-1!==r.indexOf("{{")?String.fromCharCode(8203,8203):"")};return t.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.ExtAuthorization"}},t});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.ExtAuthorization", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".ws-window-titlebar-custom .ws-window-title{position:absolute}.controls-ComboBox__picker .controls-ComboBox__itemRow{font-size:14px!important}"));head.appendChild(style);});}
define('js!SBIS3.EDO.ExtAuthorization',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.ExtAuthorization','css!SBIS3.EDO.ExtAuthorization','SBIS3.CONTROLS/PasswordTextBox','SBIS3.CONTROLS/ComboBox','SBIS3.CONTROLS/CheckBox','SBIS3.CONTROLS/TextBox','Dokumentooborot_localization'],function(t,e){var s=t.extend({_dotTplFn:e,$protected:{_options:{widthTitle:'100px',widthField:'270px',minHeight:0,maximize:false}},$constructor:function(){},init:function(){s.superclass.init.call(this);var t=this._options['params'];if('string'==typeof t)t=JSON.parse(t);if(!t)return;var e=this.getChildControlByName('user'),i=this.getChildControlByName('password'),o=this.getChildControlByName('listUsers'),r=this.getChildControlByName('savePassword');if(t['users']&&t['users'].length){e.hide(),o.show();var n=t['login']?t['login']:t['users'][0].title;o.setItems(t['users']),o.setText(n),e.setText(n),o.subscribe('onTextChange',function(){var t=this.getTopParent(),s=o.getText();e.setText(s);});}else if(e.show(),o.hide(),t['login'])e.setText(t['login']),i.setActive(true,true);if(i.setText(t['password']),r.setChecked(t['savePassword']),false===t['showSavePassword'])r.hide();else r.show();}});return s.title='Вход в систему',s;});
define("html!SBIS3.EDO.ExtAuthorizationDialog",function(){var t=function(t){var o=function(){var t=/\{\{([\s\S]+?)\}\}/g;return function(o){for(;t.test(o);)o=o.replace(t,"&#123;&#123;$1&#125;&#125;");return o}}(),n=function(t){return t.join?t.join(""):t.toString()},i=function(t){return void 0===t?"":t&&"object"==typeof t?n(t):""+t},e="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div data-lmtype="Dialog"> <div class="ws-window-titlebar-custom" data-lmchild="WindowTitle" style="font-size:0; padding-right:30px"></div> <component data-component="SBIS3.EDO.ExtAuthorization" name="extAuthorization" style="padding-left: 12px; padding-right: 12px; padding-top: 8px;"> <option name="params">'+o(i(JSON.stringify(t.params)))+'</option> </component> <div id="textMessage" style="color: #EF463A; text-align: center;">'+o(i(t.params.message))+'</div> <div style="height:32px; position:static; padding-top: 8px;"> <component data-component="SBIS3.CONTROLS/Button" name="buttonCancel" style="margin-right: 12px; float:right;"> <option name="caption">Отмена</option> <option name="visible">true</option> <option name="primary">false</option> </component> <component data-component="SBIS3.CONTROLS/Button" name="buttonOK" style="margin-right: 12px; float:right;"> <option name="caption">ОК</option> <option name="visible">true</option> <option name="primary">true</option> </component> </div> </div>');return(a=o(a))+(e&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return t.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.ExtAuthorizationDialog"}},t});
define('js!SBIS3.EDO.ExtAuthorizationDialog',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.ExtAuthorizationDialog','Core/core-attach','Core/WindowManager','Core/Deferred','js!SBIS3.EDO.ExtAuthorization','SBIS3.CONTROLS/Button','Dokumentooborot_localization'],function(t,e,o,i,n){var a=t.extend({_dotTplFn:e,$protected:{_options:{_options:{}}},$constructor:function(){},init:function(){a.superclass.init.call(this),this.getParent().subscribe('onBeforeClose',function(t,e){if(true!==e)t.setResult(false);}),this.getChildControlByName('buttonOK').subscribe('onActivated',function(t){var e=this.getTopParent(),o=e.getChildControlByName('user'),i=e.getChildControlByName('password'),n={savePassword:e.getChildControlByName('savePassword').isChecked(),password:i.getText(),login:o.getText()};e.close(true),defAuth.callback(n);}),this.getChildControlByName('buttonCancel').subscribe('onActivated',function(t){this.getTopParent().close(true),defAuth.callback(false);});}});return a.showAuthorizationDialog=function(t){return defAuth=new n(),o.attachInstance('Source:Dialog',{modal:true,width:'330',height:'130',autoWidth:true,autoHeight:false,resizable:false,title:t['title'],disableActions:true,closeButton:false,template:'js!SBIS3.EDO.ExtAuthorizationDialog',opener:i.getActiveWindow(),componentOptions:{params:t}}),defAuth;},a;});
define("html!SBIS3.EDO.ExtConnectionWizard",function(){var o=function(o){var t=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;o.test(t);)t=t.replace(o,"&#123;&#123;$1&#125;&#125;");return t}}(),n=function(o){return o.join?o.join(""):o.toString()},e=function(o){return void 0===o?"":o&&"object"==typeof o?n(o):""+o},i="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div> <component data-component="SBIS3.CONTROLS/SwitchableArea" name="contentWizard" style="height: 269px"> <options name="items" type="array"> <options> <option name="content">js!SBIS3.EDO.'+t(e(o.params.moduleNameWizard))+'_Step1</option> <option name="id">'+t(e(o.params.moduleNameWizard))+'_Step1</option> <option name="visible">true</option> </options> <options> <component data-component="SBIS3.EDO.'+t(e(o.params.moduleNameWizard))+'_Step2"> <option name="nameModule" bind="nameModule">'+t(e(o.params.nameModule))+'</option> <option name="idConnection">'+t(e(o.idConnection))+'</option> </component> <option name="id">'+t(e(o.params.moduleNameWizard))+'_Step2</option> <option name="visible">true</option> </options> <options> <component data-component="SBIS3.EDO.'+t(e(o.params.moduleNameWizard))+'_Step3"> <option name="idConnection">'+t(e(o.idConnection))+'</option> </component> <option name="id">'+t(e(o.params.moduleNameWizard))+'_Step3</option> <option name="visible">true</option> </options> </options> </component> <div style="background-color: #c0c0c0; bottom: 0; left: 0; position: absolute; right: 0; bottom: 56px; height: 1px;"></div> <div style="background: #F7F4F0;height: 56px"> <table style="width: 100%; height: 100%;"> <tr style="vertical-align: middle;"> <td style="width: 100%"> </td> <td style="width: 100%;"> <component data-component="SBIS3.CONTROLS/Button" name="buttonPrevious" style="margin-right: 12px;"> <option name="caption">Назад</option> <option name="primary">false</option> <option name="visible">false</option> </component> </td> <td style="width: auto;"> <component data-component="SBIS3.CONTROLS/Button" name="buttonNext" style="margin-right: 12px;"> <option name="caption">Далее</option> <option name="primary">true</option> </component> </td> <td style="width: auto;"> <component data-component="SBIS3.CONTROLS/Button" name="buttonReady" style="margin-right: 12px;"> <option name="caption">Готово</option> <option name="visible">false</option> <option name="primary">true</option> </component> </td> </tr> </table> </div> </div>');return(a=t(a))+(i&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.ExtConnectionWizard"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.ExtConnectionWizard", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".extConnectionWizard__header{background:#f7f4f0;color:#d94700;font-family:'TensorFont ����������',TensorFont;font-weight:700;font-style:normal;font-size:15px;float:left;padding:10px}"));head.appendChild(style);});}
define('js!SBIS3.EDO.ExtConnectionWizard',['js!SBIS3.EDO.IntEngine','Deprecated/helpers/fast-control-helpers','Deprecated/helpers/collection-helpers','Core/moduleStubs','Core/Context','SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.ExtConnectionWizard','Lib/Control/Control','css!SBIS3.EDO.ExtConnectionWizard','SBIS3.CONTROLS/Button','SBIS3.CONTROLS/SwitchableArea','Dokumentooborot_localization'],function(e,t,n,o,a,i,s,r){var l=i.extend({_dotTplFn:s,$protected:{_options:{_options:{}}},$constructor:function(){},init:function(){l.superclass.init.call(this);var n=this,i=1,s=n.getTopParent(),c=n.getChildControlByName('contentWizard'),d=n._options['idConnection'],u=e.getUserConfig(d),f=u['moduleNameWizard'],m=n.getChildControlByName('buttonPrevious'),C=n.getChildControlByName('buttonNext'),p=n.getChildControlByName('buttonReady'),g=function(){if(2===i&&u.paramsConnection)u.paramsConnection={nameModule:u.paramsConnection.nameModule};else if(3===i)e.destroyConnection(d);i-=1,C.setEnabled(true),b();},S=function(){o.requireModule('SBIS3.EDO.'+u['moduleNameWizard']+'_Step'+(i+1)).addCallback(function(t){if(1===i){if(i++,f=n.getChildControlByName('selectedModule').getSelectedKey(),u)if(u.paramsConnection.nameModule!==f)delete u.connection,delete u.connected;u.paramsConnection.nameModule=f,u.service=e.paramModule[f].service,e.initializeModule(f).addCallback(function(t){if(!t)return void i--;var o=u['moduleNameWizard']+'_Step'+i,a=c.getItemById(o);a.getContext().setValue('nameModule',f),c.setAreaContent(o,a.getContent()),b(),n.getChildControlByName('user').setText(u.paramsConnection.login),n.getChildControlByName('password').setText(u.paramsConnection.password),n.getChildControlByName('savePassword').setChecked(u.paramsConnection.savePassword),u.paramsConnection.nameSystem=e.paramModule[u.paramsConnection['nameModule']].nameSystem;});}else if(2===i)e.setConnectionParam(d,n.getChildControlById(u['moduleNameWizard']+'_Step'+i)).addCallbacks(function(t){if(t){var o=function(){e.createConnection(d,false).addCallbacks(function(e){if(e)i++;if(b(),n.hasChildControlByName('nameConnection'))n.getChildControlByName('nameConnection').setText(u.name_connection);},function(t){n._activateFirstCtrl(),e.sendErrorReport(d,'Мастер подключения','',t.message);});};if(u.connected)o();else{if(u.connection)delete u.connection;o();}}},function(t){e.sendErrorReport(d,'Мастер подключения','',t.message);});});},h=function(){var t=true;if(n.hasChildControlByName('nameConnection')){var o=n.getChildControlByName('nameConnection');if(u.name_connection=o.getText(),0===o._options.validators.length)o.setValidators([{validator:function(){return!this.getText().trim()?false:true;},errorMessage:'Введите название подключения',noFailOnError:false}]);t=o.validate();}if(t)e.writeConnection(d).addCallbacks(function(t){if(t){if(r.ControlStorage.containsByName('settingList'))SBIS3.EDO.ExtListUserSettings.prototype.updateList(r.ControlStorage.getByName('settingList'));if(a.global.getValue('paramMenu'))e.createMenu();if(e.updateMenu(),e.addIntegrationUse(d,'Мастер подключения','',1),s.close(true),n._options.params['nameButton']&&n._options.params['typeDocument'])l.showDefaultRegistry(n._options.params['nameButton'],n._options.params['typeDocument'],n._options.params['record'],t,n._options.params['updateFormDocument']);}else e.sendErrorReport(d,'Мастер подключения','',error.message),s.close(false);},function(t){e.sendErrorReport(d,'Мастер подключения','',t.message);});},b=function(){n['step']=i;var t=e.paramModule[f].shortNameSystem;if(s.setTitle('Настройка соединения с '+t+'. Шаг '+i+' из 3'),c.setActiveArea(u['moduleNameWizard']+'_Step'+i),1===i)m.setVisible(false);else m.setVisible(true);if(3===i)C.setVisible(false),p.setDefaultButton(true),p.setVisible(true);else C.setDefaultButton(true),C.setVisible(true),p.setVisible(false);},B=function(n,o){if(true!==o){var a=function(){var t=e.userConfig();if(t[d])delete t[d];};n.setResult(false),t.question('Прервать настройку соединения?').addCallbacks(function(t){if(t)if(u.connected)e.destroyConnection(d).addCallback(function(){a(d),s.close(true);});else if(a(),s)s.close(true);},function(e){if(s)s.close(true);a(d);});}};C.subscribe('onActivated',S),m.subscribe('onActivated',g),p.subscribe('onActivated',h),s.subscribe('onBeforeClose',B),c.subscribe('onAfterShow',function(e){o.requireModule('SBIS3.EDO.'+u['moduleNameWizard']+'_Step1').addCallback(function(){b();});});}});return l.showDefaultRegistry=function(t,o,a,i,s){var r=e.getUserConfig(i).menu[t],l=false,c;if(1===n.countOfProperties(r))l=true;for(var d in r)if(r.hasOwnProperty(d))if('1'===r[d].default||l){c=r[d];break;}if(c){var u=new Date(),f='Месяц',m=new Date();if(t.indexOf('Отчет')>-1)m.setFullYear(m.getFullYear()-1),f='Год';else m.setMonth(m.getMonth()-1);if(c['filter']={'ДатаНачала':m,'ДатаКонца':u,'Период':f},'Номенклатура'===o||'Сотрудники'===o||'Контрагенты'===o)e.showListItems(c);else e.showListDocuments(c);}},l;});
define("tmpl!SBIS3.EDO.IntEngineCom1S82_Step1/resources/IntEngineCom1S82_Step1",["Core/tmpl/js/tclosure"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],i={},n=function e(n,a,r,o,s){function c(){}var l=0,p=void 0!==t&&t?t:arguments[arguments.length-1];void 0===p&&(eval("var thelpers = null;"),p=global.requirejs("View/Runner/tclosure"));var g={};s&&s.isSetts&&(g=s.fullContext||{});var d="string"==typeof r?r:"",m=void 0===i?void 0:i,h={id:[],def:void 0},u=p.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,n),T=this&&this.includedTemplates?this.includedTemplates:{},x=p.getMarkupGenerator(o);try{var y=x.joinElements([x.createTag("div",{},[x.createTag("div",{style:"padding-left:12px; padding-right:12px; padding-top:8px; text-align:justify; font-size: 14px;"},[x.createText(global.rk("После прохождения мастера вы сможете загружать и выгружать документы, справочники и электронную отчетность.")+" ")],{},h,this),x.createTag("br",{},[],{},h,this),x.createTag("div",{style:"margin-left:12px;margin-right:12px;text-align:justify;"},[x.createText(global.rk("Какая у вас версия 1С?")+" "),x.createTag("a",{target:"_blank",href:"https://help.sbis.ru/help/integration/1C_set/modul/config_1C/"},[x.createTag("div",{class:"icon-16 icon-Question2 icon-disabled action-hover"},[],{},h,this)],{},h,this)],{},h,this),x.createTag("component",{"data-component":"SBIS3.CONTROLS/Radio/Group",name:"selectedModule",class:"ws-Label-content  controls-ButtonGroup__vertical",style:"margin-left:34px;margin-right:12px; margin-top: 12px;"},[x.createTag("option",{name:"selectedKey",type:"string"},[x.createText("1")],{},h,this),x.createTag("option",{name:"idProperty"},[x.createText("id")],{},h,this),x.createTag("option",{name:"displayProperty"},[x.createText("title")],{},h,this),x.createTag("option",{name:"selectedKey"},[x.createText("IntEngineCom1S83")],{},h,this),x.createTag("options",{name:"items",type:"array"},[x.createTag("options",{},[x.createTag("option",{name:"id",type:"string"},[x.createText("IntEngineCom1S82")],{},h,this),x.createTag("option",{name:"title"},[x.createText("8.2")],{},h,this)],{},h,this),x.createTag("options",{},[x.createTag("option",{name:"id",type:"string"},[x.createText("IntEngineCom1S83")],{},h,this),x.createTag("option",{name:"title"},[x.createText("8.3")],{},h,this)],{},h,this),x.createTag("options",{},[x.createTag("option",{name:"id",type:"string"},[x.createText("IntEngineWeb1S83")],{},h,this),x.createTag("option",{name:"title"},[x.createText("Fresh")],{},h,this)],{},h,this)],{},h,this)],{},h,this),x.createTag("div",{id:"infoBottom",style:"position: absolute; bottom: 20px;"},[x.createTag("a",{style:"padding-left: 12px;",target:"_blank",href:"https://help.sbis.ru/help/integration/1C_set/"},[x.createText(""+global.rk("Другие варианты соединения"))],{},h,this)],{},h,this)],a,h,this)],d,h);h.def&&(y=x.chain(y,h,a),h=void 0)}catch(e){p.templateError("resources/Dokumentooborot/IntegrationSystem/ExtConnectionWizard/IntEngineCom1S82/resources/IntEngineCom1S82_Step1.tmpl",e,n)}return y||""};return n.includedFunctions={},n.stable=!0,n.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.IntEngineCom1S82_Step1/resources/IntEngineCom1S82_Step1"}},n});
define('js!SBIS3.EDO.IntEngineCom1S82_Step1',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.IntEngineCom1S82_Step1/resources/IntEngineCom1S82_Step1','SBIS3.CONTROLS/Radio/Group','Dokumentooborot_localization'],function(n,t){var o=n.extend({_dotTplFn:t,$protected:{_options:{}},$constructor:function(){},init:function(){o.superclass.init.call(this);}});return o;});
define("tmpl!SBIS3.EDO.IntEngineCom1S82_Step2/resources/IntEngineCom1S82_Step2",["Core/tmpl/js/tclosure"],function(){var t=Array.prototype.slice.call(arguments),e=t[0],a={},i=function t(i,o,n,r,s){function c(){}var p=0,d=void 0!==e&&e?e:arguments[arguments.length-1];void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure"));var l={};s&&s.isSetts&&(l=s.fullContext||{});var g="string"==typeof n?n:"",m=void 0===a?void 0:a,h={id:[],def:void 0},u=d.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,i),x=this&&this.includedTemplates?this.includedTemplates:{},T=d.getMarkupGenerator(r);try{var S=T.joinElements([T.createTag("div",{},[T.createTag("table",{style:"padding-left: 12px; padding-right: 12px; width: 100%; padding-top: 8px;",id:"dataConfigurations"},[T.createTag("tr",{},["IntEngineWeb1S83"===d.getter(i,["nameModule"])?[T.createTag("td",{style:"width: 100px; vertical-align: top; padding-top: 3px;"},[T.createTag("div",{style:"color: #8991A9;"},[T.createText(""+global.rk("URL"))],{},h,this)],{},h,this),T.createTag("td",{style:"width: auto;"},[T.createTag("component",{"data-component":"SBIS3.CONTROLS/TextBox",name:"url",style:"width: 100%; margin-bottom: 8px; max-width: 416px;"},[T.createTag("option",{name:"placeholder"},[T.createText("Например: http://platform.demo.1c.ru/demo83")],{},h,this)],{},h,this)],{},h,this)]:[T.createTag("td",{style:"width: 100px; vertical-align: top; padding-top: 3px;"},[T.createTag("div",{style:"color: #8991A9;"},[T.createText(""+global.rk("База"))],{},h,this)],{},h,this),T.createTag("td",{style:"width: auto; max-width: 500px;"},[T.createTag("component",{"data-component":"SBIS3.CONTROLS/ComboBox",name:"listConfigurations",class:"position",style:"width: 100%;font-size: 14px; max-width: 416px;"},[T.createTag("option",{name:"selectOnClick"},[T.createText("true")],{},h,this),T.createTag("option",{name:"idProperty"},[T.createText("key")],{},h,this),T.createTag("option",{name:"displayProperty"},[T.createText("title")],{},h,this),T.createTag("option",{name:"allowEmptySelection"},[T.createText("true")],{},h,this),T.createTag("option",{name:"selectedKey"},[T.createText("1")],{},h,this),T.createTag("option",{name:"editable"},[T.createText("false")],{},h,this),T.createTag("option",{name:"pickerClassName"},[T.createText("controls-ComboBox__markDefaultItem")],{},h,this),T.createTag("option",{name:"text"},[],{},h,this)],{},h,this),T.createTag("div",{style:"padding-top: 5px; margin-bottom: 10px; padding-left: 2px;",id:"url_config_1s"},[],{},h,this)],{},h,this)]],{},h,this),T.createTag("tr",{},[T.createTag("td",{colspan:"2"},[T.createTag("component",{"data-component":"SBIS3.EDO.ExtAuthorization",name:"authorization",class:"position"},[],{},h,this)],{},h,this)],{},h,this)],{},h,this),T.createTag("div",{style:"padding-left: 12px; padding-right: 12px; width: auto; padding-top: 8px;",id:"textError"},[],{},h,this)],o,h,this)],g,h);h.def&&(S=T.chain(S,h,o),h=void 0)}catch(t){d.templateError("resources/Dokumentooborot/IntegrationSystem/ExtConnectionWizard/IntEngineCom1S82/resources/IntEngineCom1S82_Step2.tmpl",t,i)}return S||""};return i.includedFunctions={},i.stable=!0,i.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.IntEngineCom1S82_Step2/resources/IntEngineCom1S82_Step2"}},i});
define('js!SBIS3.EDO.IntEngineCom1S82_Step2',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.IntEngineCom1S82_Step2/resources/IntEngineCom1S82_Step2','js!SBIS3.EDO.IntEngine','Core/Deferred','js!SBIS3.Plugin/Source/Helper/Helper','js!SBIS3.EDO.ExtAuthorization','SBIS3.CONTROLS/ComboBox','Dokumentooborot_localization'],function(e,t,n,i,r){var o=e.extend({_dotTplFn:t,$protected:{_options:{}},$constructor:function(){},init:function(){o.superclass.init.call(this);var e=this,t=false,s=false,l=this._options.idConnection,a=n.getUserConfig(l),u=a.paramsConnection.nameModule,d=SBIS3.EDO[u];if('IntEngineWeb1S83'===a.paramsConnection['nameModule']){var c=e.getChildControlByName('url');if(0===c._options.validators.length)c.setValidators([{validator:function(){return c.getText()?c.getText().trim()?true:false:false;},errorMessage:'Не введен URL-адрес информационной базы',noFailOnError:false}]);}else{var f=function(e){var t=n.getUserConfig(e),o={host:'https://'+location.hostname,AccountID:r.getAccountId(),id:e,type:t.paramsConnection['nameModule'],url:t['url']};return n.getPlugin(e,o).addCallbacks(function(t){if(t)return t.call('getListConfigs',{}).addCallbacks(function(e){return e;},function(t){return n.sendErrorReport(e,'Мастер подключения','',t.message),false;});else return false;},function(e){return new i().errback(e);});},g=e.getChildControlByName('listConfigurations'),h=[],C={},m;g.subscribe('onSelectedItemChange',function(){var e=g.getSelectedKey(),t=g.getText(),n=C[e];if(t&&t.length)document.getElementById('url_config_1s').innerHTML='<div style="color: #8991A9; text-align: left;font-size: 12px">'+n+'</div>';}),n.showIndicator('Получение списка конфигураций...').addCallback(function(){f(l,'Мастер подключения').addCallbacks(function(t){n.hideIndicator();for(var i=0;t&&i<t.length;i++){h.push({key:i,title:t[i]['Name']});var r=t[i]['Connect'];while(~r.indexOf('\\'))r=r.replace('\\','/');while(~r.indexOf('"'))r=r.replace('"','\'');if(a&&a.url&&a.url===r)m=i;C[i]=t[i]['Connect'];}if(d['listConfigurations']=C,g.setItems(h),t&&t.length)g.setSelectedKey(m?m:0);else g.setSelectedKey(0);if(h.length)document.getElementById('dataConfigurations').hidden=false,document.getElementById('textError').innerHTML='';else document.getElementById('dataConfigurations').hidden=true,document.getElementById('textError').innerHTML='<div style="padding-right: 12px; text-align: justify;font-size: 14px">Нам не удалось найти 1С на вашем ПК. Скорее всего, она не была установлена из дистрибутива. Ознакомьтесь с <a target="_blank" href="http://help.sbis.ru/help/integration/1C_set/err_config/">инструкцией</a> для устранения данной проблемы.</div>';if(t&&t.length&&document.getElementById('url_config_1s'))document.getElementById('url_config_1s').innerHTML='<div style="color: #8991A9; text-align: left; font-size: 12px">'+t[m?m:0]['Connect']+'</div>';if(e.getTopParent().hasChildControlByName('buttonNext')){var o=e.getTopParent().getChildControlByName('buttonNext');if(t.length)o.setEnabled(true);else o.setEnabled(false);}if(e.getTopParent().hasChildControlByName('authorization')){var s=e.getTopParent().getChildControlByName('authorization');if(t.length)s.setVisible(true);else s.setVisible(false);}n.hideIndicator();},function(t){if(document.getElementById('dataConfigurations').hidden=true,document.getElementById('textError').innerHTML='<div style="padding-right: 12px; text-align: justify;font-size: 14px">'+t.message+'</div>',n.hideIndicator(),n.sendErrorReport(l,'Мастер подключения','',t.message),e.getTopParent().hasChildControlByName('buttonNext'))e.getTopParent().getChildControlByName('buttonNext').setEnabled(false);});});}this.subscribe('onBeforeShow',function(e){var i=this.getChildControlByName('user'),r=this.getChildControlByName('listUsers'),o=n.getUserConfig(l);if('IntEngineWeb1S83'===o.paramsConnection['nameModule']){var a=this.getChildControlByName('url');a.subscribe('onTextChange',function(e){t=true;}),r.subscribe('onTextChange',function(e,t){i.setText(t);}),r.subscribe('onSelectedItemChange',function(e){i.setText(r.getText());});var u=function(e){var t=e&&e.length?true:false;i.setVisible(!t),r.setVisible(t);};i.subscribe('onActivate',function(e,t,n){var i=1;}),i.subscribe('onFocusIn',function(e,t,n){var i=1;}),a.subscribe('onFocusOut',function(e,n,i){if(i){var d=i.getName();if(t&&''!=a.getText()&&!s&&d&&-1==='buttonPrevious,buttonNext,contentWizard'.indexOf(d))if(s=true,SBIS3.EDO.IntEngineWeb1S83.System.prepareConnectionSettings(l,this.getTopParent()))return a.setText(o.url),SBIS3.EDO.IntEngineWeb1S83.System.getListUser(l).addCallbacks(function(e){if(r.setItems(e),u(e),('listUsers'===d||'user'===d)&&e&&0!=e.length)r.showPicker();return r.setSelectedKey(0),t=false,s=false,true;},function(e){return s=false,u(),false;});else return s=false,t=false,false;else return true;}else return true;});}else i.setVisible(true),r.setVisible(false);});}});return o;});
define("tmpl!SBIS3.EDO.IntEngineCom1S82_Step3/resources/IntEngineCom1S82_Step3",["Core/tmpl/js/tclosure"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],n={},o=function e(o,i,a,r,s){function c(){}var p=0,d=void 0!==t&&t?t:arguments[arguments.length-1];void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure"));var l={};s&&s.isSetts&&(l=s.fullContext||{});var g="string"==typeof a?a:"",m=void 0===n?void 0:n,u={id:[],def:void 0},S=d.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),h=this&&this.includedTemplates?this.includedTemplates:{},f=d.getMarkupGenerator(r);try{var v=f.joinElements([f.createTag("div",{style:"padding-left: 12px; padding-right: 12px; padding-top: 8px;"},[f.createTag("div",{style:"font-size: 14px;"},[f.createText(" "+global.rk("Название подключения:")+" ")],{},u,this),f.createTag("div",{style:"padding-bottom: 4px; padding-top:4px; font-size: 14px;"},[f.createTag("component",{"data-component":"SBIS3.CONTROLS/TextBox",name:"nameConnection",style:"width: 100%;"},[f.createTag("option",{name:"maxLength"},[f.createText("255")],{},u,this)],{},u,this)],{},u,this),f.createTag("div",{id:"textHappyEnd",style:"text-align:justify; overflow: hidden;"},[],{},u,this),f.createText(" "+d.wrapUndef(d.utils.escape(d.getter(o,["SBIS3","EDO","IntEngine","debug"])))+" "),f.createTag("div",{id:"infoBottom",style:"position: absolute; bottom: 16px;"},[f.createTag("component",{"data-component":"SBIS3.CONTROLS/Button",name:"buttonSynchro",style:"margin-left: 12px;"},[f.createTag("option",{name:"caption"},[f.createText("Настроить синхронизацию")],{},u,this),f.createTag("option",{name:"visible"},[f.createText("true")],{},u,this),f.createTag("option",{name:"primary"},[f.createText("false")],{},u,this)],{},u,this)],{},u,this)],i,u,this)],g,u);u.def&&(v=f.chain(v,u,i),u=void 0)}catch(e){d.templateError("resources/Dokumentooborot/IntegrationSystem/ExtConnectionWizard/IntEngineCom1S82/resources/IntEngineCom1S82_Step3.tmpl",e,o)}return v||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.IntEngineCom1S82_Step3/resources/IntEngineCom1S82_Step3"}},o});
define('js!SBIS3.EDO.IntEngineCom1S82_Step3',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.IntEngineCom1S82_Step3/resources/IntEngineCom1S82_Step3','js!SBIS3.EDO.IntEngine','Core/core-attach','Dokumentooborot_localization'],function(e,t,n,o){var i=e.extend({_dotTplFn:t,$protected:{_options:{}},$constructor:function(){},init:function(){i.superclass.init.call(this);var e=this,t=this._options['idConnection'];this.getChildControlByName('buttonSynchro').subscribe('onActivated',function(i){n.writeConnection(t).addCallbacks(function(t){if(t)o.attachInstance('Lib/Control/FloatArea/FloatArea',{target:$('body'),template:'js!SBIS3.IntegrationConfig.ExtConfiguration',autoWidth:false,autoHeight:true,modal:false,autoHide:true,autoShow:true,catchScroll:false,resizable:false,side:'right',controlsSide:'right',autoCloseOnHide:true,verticalAlign:'middle',isStack:true,keepSize:false,width:1000,direction:'left',componentOptions:{idConnection:t,idItem:2}}),e.getTopParent().close(true);},function(e){n.sendErrorReport(t,'Мастер подключения','',e.message);});}),this.subscribe('onBeforeShow',function(e){if(this.hasChildControlByName('buttonSynchro'))this.getChildControlByName('buttonSynchro').setVisible(n.debug);var t=this.getTopParent()._options.componentOptions.idConnection,o=n.getUserConfig(t);document.getElementById('textHappyEnd').innerHTML='Соединение с '+o.paramsConnection.nameSystem+' '+o.name_connection+' установлено успешно. <br/> '+'Ознакомиться с тем, как загружать и выгружать документы, справочники и электронную отчетность, вы сможете '+'<a target="_blank" href="https://help.sbis.ru/help/integration/1C_set/1C_sbis/">здесь</a>.';});},prepareConnectionSettings:function(e,t){var o=n.userConfig()[e],i=SBIS3.EDO[o.paramsConnection.nameModule];if('IntEngineWeb1S83'==o.paramsConnection.nameModule)return SBIS3.EDO.IntEngineWeb1S83.System.prepareConnectionSettings(e,t);else{var r=t.getChildControlByName('listConfigurations'),a=i['listConfigurations'][r.getSelectedKey()];if(!a)return false;while(~a.indexOf('\\'))a=a.replace('\\','/');while(~a.indexOf('"'))a=a.replace('"','\'');if(o['url']&&o['url']!=a)o['connected']=false,delete o['connection'];if(o['url']!==a)o['name_connection']=r.getText();return o['url']=a,true;}}});return i;});
define("tmpl!SBIS3.EDO.IntEngineComSAPNC3_Step1/resources/IntEngineComSAPNC3_Step1",["Core/tmpl/js/tclosure"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],n={},i=function e(i,r,a,o,s){function c(){}var p=0,l=void 0!==t&&t?t:arguments[arguments.length-1];void 0===l&&(eval("var thelpers = null;"),l=global.requirejs("View/Runner/tclosure"));var g={};s&&s.isSetts&&(g=s.fullContext||{});var d="string"==typeof a?a:"",m=void 0===n?void 0:n,u={id:[],def:void 0},T=l.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,i),S=this&&this.includedTemplates?this.includedTemplates:{},h=l.getMarkupGenerator(o);try{var x=h.joinElements([h.createTag("div",{},[h.createTag("div",{style:"padding-left:12px; padding-right:12px; padding-top:8px; text-align:justify; font-size: 14px;"},[h.createText(" "+global.rk("После прохождения мастера вы сможете выгружать документы из SAP в СБИС.")+" ")],{},u,this),h.createTag("br",{},[],{},u,this),h.createTag("div",{style:"margin-left:12px;margin-right:12px;text-align:justify;"},[h.createText(global.rk("Какая у вас версия SAP?")+" ")],{},u,this),h.createTag("component",{"data-component":"SBIS3.CONTROLS/Radio/Group",name:"selectedModule",class:"ws-Label-content  controls-ButtonGroup__vertical",style:"margin-left:34px;margin-right:12px; margin-top: 12px;"},[h.createTag("option",{name:"selectedKey",type:"string"},[h.createText("1")],{},u,this),h.createTag("option",{name:"idProperty"},[h.createText("id")],{},u,this),h.createTag("option",{name:"displayProperty"},[h.createText("title")],{},u,this),h.createTag("option",{name:"selectedKey"},[h.createText("IntEngineCom1S83")],{},u,this),h.createTag("options",{name:"items",type:"array"},[h.createTag("options",{},[h.createTag("option",{name:"id",type:"string"},[h.createText("IntEngineComSAPNC3")],{},u,this),h.createTag("option",{name:"title"},[h.createText("SAP ERP")],{},u,this)],{},u,this),h.createTag("options",{},[h.createTag("option",{name:"id",type:"string"},[h.createText("IntEngineComSAPBN1")],{},u,this),h.createTag("option",{name:"title"},[h.createText("SAP Business One")],{},u,this)],{},u,this)],{},u,this)],{},u,this)],r,u,this)],d,u);u.def&&(x=h.chain(x,u,r),u=void 0)}catch(e){l.templateError("resources/Dokumentooborot/IntegrationSystem/ExtConnectionWizard/IntEngineComSAPNC3/resources/IntEngineComSAPNC3_Step1.tmpl",e,i)}return x||""};return i.includedFunctions={},i.stable=!0,i.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.IntEngineComSAPNC3_Step1/resources/IntEngineComSAPNC3_Step1"}},i});
define('js!SBIS3.EDO.IntEngineComSAPNC3_Step1',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.IntEngineComSAPNC3_Step1/resources/IntEngineComSAPNC3_Step1','SBIS3.CONTROLS/Radio/Group','Dokumentooborot_localization'],function(n,t){var o=n.extend({_dotTplFn:t,$protected:{_options:{}},$constructor:function(){},init:function(){o.superclass.init.call(this);}});return o;});
define("tmpl!SBIS3.EDO.IntEngineComSAPNC3_Step2/resources/IntEngineComSAPNC3_Step2",["Core/tmpl/js/tclosure"],function(){var t=Array.prototype.slice.call(arguments),e=t[0],a={},o=function t(o,i,n,r,c){function p(){}var l=0,s=void 0!==e&&e?e:arguments[arguments.length-1];void 0===s&&(eval("var thelpers = null;"),s=global.requirejs("View/Runner/tclosure"));var d={};c&&c.isSetts&&(d=c.fullContext||{});var g="string"==typeof n?n:"",T=void 0===a?void 0:a,h={id:[],def:void 0},m=s.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),x=this&&this.includedTemplates?this.includedTemplates:{},S=s.getMarkupGenerator(r);try{var u=S.joinElements([S.createTag("div",{},[S.createTag("div",{style:"padding-left:12px; padding-right:12px; padding-top:8px; text-align:justify; font-size: 14px;"},[S.createText(global.rk("Заполните параметры подключения к системе:")+" ")],{},h,this),S.createTag("table",{style:"padding-left: 12px; padding-right: 12px; width: 100%; padding-top: 8px;"},[S.createTag("tr",{},[S.createTag("td",{style:"color: #8991A9; width: 135px; vertical-align: top; padding-top: 3px;"},[S.createText(" "+global.rk("Сервер приложений")+" ")],{},h,this),S.createTag("td",{colspan:"3"},[S.createTag("component",{"data-component":"SBIS3.CONTROLS/TextBox",name:"applicationServer",style:"width: 100%; margin-bottom: 8px;"},[S.createTag("option",{name:"tooltip"},[S.createText("IP адрес или FQDN сервера, где установлена система SAP")],{},h,this)],{},h,this)],{},h,this)],{},h,this),S.createTag("tr",{},[S.createTag("td",{style:"color: #8991A9; vertical-align: top; padding-top: 3px;"},[S.createText(" "+global.rk("Номер инстанции")+" ")],{},h,this),S.createTag("td",{},[S.createTag("component",{"data-component":"SBIS3.CONTROLS/TextBox",name:"systemNumber",style:"width: 100%; margin-bottom: 8px;"},[S.createTag("option",{name:"tooltip"},[S.createText("Номер инстанции, фактически номер сервера приложений, который обрабатывает запрос")],{},h,this)],{},h,this)],{},h,this),S.createTag("td",{style:"width: 80px; padding-left: 8px; color: #8991A9; vertical-align: top; padding-top: 3px;"},[S.createText(" "+global.rk("Ид системы")+" ")],{},h,this),S.createTag("td",{style:"vertical-align: top;"},[S.createTag("component",{"data-component":"SBIS3.CONTROLS/TextBox",name:"systemId",style:"width: 100%;"},[S.createTag("option",{name:"tooltip"},[S.createText("Ид системы в SAP")],{},h,this)],{},h,this)],{},h,this)],{},h,this),S.createTag("tr",{},[S.createTag("td",{style:"color: #8991A9; vertical-align: top; padding-top: 3px;"},[S.createText(" "+global.rk("Мандант")+" ")],{},h,this),S.createTag("td",{},[S.createTag("component",{"data-component":"SBIS3.CONTROLS/TextBox",name:"client",style:"width: 100%; margin-bottom: 8px;"},[S.createTag("option",{name:"tooltip"},[S.createText("Мандант, в котором работает пользователь(например, 800 - работа, 200, 140 - разработка)")],{},h,this)],{},h,this)],{},h,this),S.createTag("td",{style:"width: 80px; padding-left: 8px; color: #8991A9; vertical-align: top; padding-top: 3px;"},[S.createText(" "+global.rk("Язык")+" ")],{},h,this),S.createTag("td",{style:"vertical-align: top;"},[S.createTag("component",{"data-component":"SBIS3.CONTROLS/TextBox",name:"language",style:"width: 100%;"},[S.createTag("option",{name:"tooltip"},[S.createText("Язык локали, к которой происходит подключение")],{},h,this)],{},h,this)],{},h,this)],{},h,this),S.createTag("tr",{},[S.createTag("td",{colspan:"4"},[S.createTag("component",{"data-component":"SBIS3.EDO.ExtAuthorization",name:"authorization",class:"position"},[S.createTag("option",{name:"widthTitle"},[S.createText("135px")],{},h,this)],{},h,this)],{},h,this)],{},h,this)],{},h,this)],i,h,this)],g,h);h.def&&(u=S.chain(u,h,i),h=void 0)}catch(t){s.templateError("resources/Dokumentooborot/IntegrationSystem/ExtConnectionWizard/IntEngineComSAPNC3/resources/IntEngineComSAPNC3_Step2.tmpl",t,o)}return u||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.IntEngineComSAPNC3_Step2/resources/IntEngineComSAPNC3_Step2"}},o});
define('js!SBIS3.EDO.IntEngineComSAPNC3_Step2',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.IntEngineComSAPNC3_Step2/resources/IntEngineComSAPNC3_Step2','js!SBIS3.EDO.IntEngine','js!SBIS3.EDO.ExtAuthorization','SBIS3.CONTROLS/ComboBox','Dokumentooborot_localization'],function(e,n,t){var o=e.extend({_dotTplFn:n,$protected:{_options:{}},$constructor:function(){},init:function(){o.superclass.init.call(this);for(var e=this._options.idConnection,n=t.getUserConfig(e),s=[{name:'applicationServer',message:'Не введен IP адрес'},{name:'client',message:'Не указан мандант'},{name:'language',message:'Не указан язык локали'},{name:'systemNumber',message:'Не указан номер инстанции'},{name:'systemId',message:'Не указано имя системы'}],a=0;a<s.length;a++){var i=s[a]['name'],r=this.getChildControlByName(i);if(r.setValue(n.paramsConnection[i]),0===r._options.validators.length)r.setValidators([{validator:function(e){return n.paramsConnection[e]=this.getText(),this.getText()?true:false;},errorMessage:s[a]['message'],noFailOnError:false,option:'name'}]);}}});return o;});
define("tmpl!SBIS3.EDO.IntEngineComSAPNC3_Step3/resources/IntEngineComSAPNC3_Step3",["Core/tmpl/js/tclosure"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],n={},o=function e(o,i,r,a,s){function c(){}var l=0,p=void 0!==t&&t?t:arguments[arguments.length-1];void 0===p&&(eval("var thelpers = null;"),p=global.requirejs("View/Runner/tclosure"));var d={};s&&s.isSetts&&(d=s.fullContext||{});var u="string"==typeof r?r:"",m=void 0===n?void 0:n,g={id:[],def:void 0},S=p.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),f=this&&this.includedTemplates?this.includedTemplates:{},v=p.getMarkupGenerator(a);try{var h=v.joinElements([v.createTag("div",{},[v.createTag("div",{id:"textHappyEnd",style:"padding-left:12px; padding-right:12px; padding-top:8px; text-align:justify; font-size: 14px; overflow: hidden;"},[],{},g,this),v.createTag("div",{id:"infoBottom",style:"position: absolute; bottom: 16px;"},[v.createTag("component",{"data-component":"SBIS3.CONTROLS/Button",name:"buttonSynchro",style:"margin-left: 12px;"},[v.createTag("option",{name:"caption"},[v.createText("Настроить синхронизацию")],{},g,this),v.createTag("option",{name:"visible"},[v.createText("true")],{},g,this),v.createTag("option",{name:"primary"},[v.createText("false")],{},g,this)],{},g,this)],{},g,this)],i,g,this)],u,g);g.def&&(h=v.chain(h,g,i),g=void 0)}catch(e){p.templateError("resources/Dokumentooborot/IntegrationSystem/ExtConnectionWizard/IntEngineComSAPNC3/resources/IntEngineComSAPNC3_Step3.tmpl",e,o)}return h||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.IntEngineComSAPNC3_Step3/resources/IntEngineComSAPNC3_Step3"}},o});
define('js!SBIS3.EDO.IntEngineComSAPNC3_Step3',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.IntEngineComSAPNC3_Step3/resources/IntEngineComSAPNC3_Step3','js!SBIS3.EDO.IntEngine','Dokumentooborot_localization'],function(n,e,t){var o=n.extend({_dotTplFn:e,$protected:{_options:{}},$constructor:function(){},init:function(){o.superclass.init.call(this),this.subscribe('onActivate',function(n){var e=this.getTopParent()._options.componentOptions.idConnection,t=SBIS3.EDO.IntEngine.getUserConfig(e);document.getElementById('textHappyEnd').innerHTML='Соединение с '+t.paramsConnection.nameSystem+' '+t.name_connection+' установлено успешно. <br/> '+'Ознакомиться с тем, как загружать и выгружать документы, вы сможете '+'<a target="_blank" href="https://help.sbis.ru/help/integration/saprfc/">здесь</a>.';});},prepareConnectionSettings:function(n,e){for(var o=true,i=t.getUserConfig(n),r=['applicationServer','client','language','systemNumber','systemId'],a=0;a<r.length;a++){var s=r[a],c=e.getChildControlByName(s);if(c.validate())i[s]=c.getText();else o=false;}return i.url=i.paramsConnection['applicationServer'],i['name_connection']=i.url,o;}});return o;});
define("tmpl!SBIS3.EDO.IntEngineComStoreHouse4_Step1/resources/IntEngineComStoreHouse4_Step1",["Core/tmpl/js/tclosure"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={},o=function e(o,n,i,a,s){function c(){}var l=0,p=void 0!==t&&t?t:arguments[arguments.length-1];void 0===p&&(eval("var thelpers = null;"),p=global.requirejs("View/Runner/tclosure"));var g={};s&&s.isSetts&&(g=s.fullContext||{});var u="string"==typeof i?i:"",d=void 0===r?void 0:r,m={id:[],def:void 0},S=p.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),h=this&&this.includedTemplates?this.includedTemplates:{},T=p.getMarkupGenerator(a);try{var y=T.joinElements([T.createTag("div",{},[T.createTag("div",{style:"padding-left:12px; padding-right:12px; padding-top:8px; text-align:justify; font-size: 14px;"},[T.createText(global.rk("После прохождения мастера вы сможете выгружать документы и загружать справочники.")+" ")],{},m,this),T.createTag("br",{},[],{},m,this),T.createTag("div",{style:"margin-left:12px;margin-right:12px;text-align:justify;"},[T.createText(""+global.rk("Какая у вас версия Store House?"))],{},m,this),T.createTag("component",{"data-component":"SBIS3.CONTROLS/Radio/Group",name:"selectedModule",class:"ws-Label-content  controls-ButtonGroup__vertical",style:"margin-left:34px;margin-right:12px; margin-top: 12px;"},[T.createTag("option",{name:"selectedKey",type:"string"},[T.createText("1")],{},m,this),T.createTag("option",{name:"idProperty"},[T.createText("id")],{},m,this),T.createTag("option",{name:"displayProperty"},[T.createText("title")],{},m,this),T.createTag("option",{name:"selectedKey"},[T.createText("IntEngineComStoreHouse4")],{},m,this),T.createTag("options",{name:"items",type:"array"},[T.createTag("options",{},[T.createTag("option",{name:"id",type:"string"},[T.createText("IntEngineComStoreHouse4")],{},m,this),T.createTag("option",{name:"title"},[T.createText("Store House 4")],{},m,this)],{},m,this)],{},m,this)],{},m,this)],n,m,this)],u,m);m.def&&(y=T.chain(y,m,n),m=void 0)}catch(e){p.templateError("resources/Dokumentooborot/IntegrationSystem/ExtConnectionWizard/IntEngineComStoreHouse4/resources/IntEngineComStoreHouse4_Step1.tmpl",e,o)}return y||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.IntEngineComStoreHouse4_Step1/resources/IntEngineComStoreHouse4_Step1"}},o});
define('js!SBIS3.EDO.IntEngineComStoreHouse4_Step1',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.IntEngineComStoreHouse4_Step1/resources/IntEngineComStoreHouse4_Step1','SBIS3.CONTROLS/Radio/Group','Dokumentooborot_localization'],function(n,o){var t=n.extend({_dotTplFn:o,$protected:{_options:{}},$constructor:function(){},init:function(){t.superclass.init.call(this);}});return t;});
define("tmpl!SBIS3.EDO.IntEngineComStoreHouse4_Step2/resources/IntEngineComStoreHouse4_Step2",["Core/tmpl/js/tclosure"],function(){var t=Array.prototype.slice.call(arguments),e=t[0],o={},n=function t(n,r,i,a,s){function c(){}var l=0,p=void 0!==e&&e?e:arguments[arguments.length-1];void 0===p&&(eval("var thelpers = null;"),p=global.requirejs("View/Runner/tclosure"));var d={};s&&s.isSetts&&(d=s.fullContext||{});var u="string"==typeof i?i:"",g=void 0===o?void 0:o,m={id:[],def:void 0},h=p.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,n),S=this&&this.includedTemplates?this.includedTemplates:{},v=p.getMarkupGenerator(a);try{var T=v.joinElements([v.createTag("div",{},[v.createTag("table",{style:"padding-left:12px; padding-right:12px; padding-top:8px; text-align:justify; font-size: 14px;"},[v.createTag("tr",{},[v.createTag("td",{style:"width: 100px; vertical-align: top; padding-top: 3px;"},[v.createTag("div",{style:"color: #8991A9;"},[v.createText(""+global.rk("URL"))],{},m,this)],{},m,this),v.createTag("td",{style:"width: auto;"},[v.createTag("component",{"data-component":"SBIS3.CONTROLS/TextBox",name:"url",style:"width: 100%; margin-bottom: 8px;"},[v.createTag("option",{name:"placeholder"},[v.createText("Например: 192.168.0.82:pTa9001t2000")],{},m,this)],{},m,this)],{},m,this)],{},m,this),v.createTag("tr",{},[v.createTag("td",{colspan:"2"},[v.createTag("component",{"data-component":"SBIS3.EDO.ExtAuthorization",name:"authorization",class:"position"},[],{},m,this)],{},m,this)],{},m,this)],{},m,this)],r,m,this)],u,m);m.def&&(T=v.chain(T,m,r),m=void 0)}catch(t){p.templateError("resources/Dokumentooborot/IntegrationSystem/ExtConnectionWizard/IntEngineComStoreHouse4/resources/IntEngineComStoreHouse4_Step2.tmpl",t,n)}return T||""};return n.includedFunctions={},n.stable=!0,n.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.IntEngineComStoreHouse4_Step2/resources/IntEngineComStoreHouse4_Step2"}},n});
define('js!SBIS3.EDO.IntEngineComStoreHouse4_Step2',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.IntEngineComStoreHouse4_Step2/resources/IntEngineComStoreHouse4_Step2','js!SBIS3.EDO.IntEngine','js!SBIS3.EDO.ExtAuthorization','SBIS3.CONTROLS/ComboBox','Dokumentooborot_localization'],function(t,o,n){var e=t.extend({_dotTplFn:o,$protected:{_options:{}},$constructor:function(){},init:function(){e.superclass.init.call(this);var t=this,o=this._options.idConnection,i=n.getUserConfig(o),r=t.getChildControlByName('url');if(0===r._options.validators.length)r.setValidators([{validator:function(){return r.getText()?true:false;},errorMessage:'Не введен URL-адрес информационной базы',noFailOnError:false}]);}});return e;});
define("tmpl!SBIS3.EDO.IntEngineComStoreHouse4_Step3/resources/IntEngineComStoreHouse4_Step3",["Core/tmpl/js/tclosure"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],o={},n=function e(n,r,i,a,s){function d(){}var p=0,l=void 0!==t&&t?t:arguments[arguments.length-1];void 0===l&&(eval("var thelpers = null;"),l=global.requirejs("View/Runner/tclosure"));var c={};s&&s.isSetts&&(c=s.fullContext||{});var u="string"==typeof i?i:"",g=void 0===o?void 0:o,m={id:[],def:void 0},S=l.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,n),v=this&&this.includedTemplates?this.includedTemplates:{},f=l.getMarkupGenerator(a);try{var x=f.joinElements([f.createTag("div",{},[f.createTag("div",{style:"padding-left:12px; padding-right:12px; padding-top:8px; font-size: 14px; overflow: hidden;"},[f.createText(" "+global.rk("Соединение с учетной системой Store House 4 установлено успешно.")+" "),f.createTag("div",{style:"padding-top:4px; font-size: 14px;"},[f.createText(" "+global.rk("Название подключения:")+" ")],{},m,this),f.createTag("div",{style:"padding-bottom: 8px; padding-top:4px; font-size: 14px;"},[f.createTag("component",{"data-component":"SBIS3.CONTROLS/TextBox",name:"nameConnection",style:"width: 100%;"},[f.createTag("option",{name:"maxLength"},[f.createText("255")],{},m,this)],{},m,this)],{},m,this),f.createTag("div",{id:"textHappyEnd",style:"text-align:justify; font-size: 14px;"},[],{},m,this)],{},m,this)],r,m,this)],u,m);m.def&&(x=f.chain(x,m,r),m=void 0)}catch(e){l.templateError("resources/Dokumentooborot/IntegrationSystem/ExtConnectionWizard/IntEngineComStoreHouse4/resources/IntEngineComStoreHouse4_Step3.tmpl",e,n)}return x||""};return n.includedFunctions={},n.stable=!0,n.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.IntEngineComStoreHouse4_Step3/resources/IntEngineComStoreHouse4_Step3"}},n});
define('js!SBIS3.EDO.IntEngineComStoreHouse4_Step3',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.IntEngineComStoreHouse4_Step3/resources/IntEngineComStoreHouse4_Step3','js!SBIS3.EDO.IntEngine','js!SBIS3.EDO.ExtAuthorization','SBIS3.CONTROLS/ComboBox','Dokumentooborot_localization'],function(n,t,e){var o=n.extend({_dotTplFn:t,$protected:{_options:{}},$constructor:function(){},init:function(){o.superclass.init.call(this);var n=this,t=this._options['idConnection'];this.subscribe('onBeforeShow',function(n){var t=this.getTopParent()._options.componentOptions.idConnection,o=e.getUserConfig(t);document.getElementById('textHappyEnd').innerHTML='Ознакомиться с тем, как выгружать документы и загружать справочники, вы сможете '+'<a target="_blank" href="https://help.sbis.ru/help/integration/StoreHouse/">здесь</a>.';});},prepareConnectionSettings:function(n,t){return SBIS3.EDO.IntEngineComStoreHouse4.System.prepareConnectionSettings(n,t);}});return o;});
define("html!SBIS3.EDO.ExtListUserSettings",function(){var o=function(o){var n=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;o.test(n);)n=n.replace(o,"&#123;&#123;$1&#125;&#125;");return n}}(),t=function(o){return o.join?o.join(""):o.toString()},i=function(o){return void 0===o?"":o&&"object"==typeof o?t(o):""+o},e="undefined"!=typeof process,p=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div> <div class="ws-window-titlebar-custom" data-lmchild="WindowTitle" style="font-size: 18px; background: #F7F4F0;font-weight: 700;font-style: normal;"> <span style="margin-top: 9px;margin-left: 12px;margin-right: 12px">'+n(i(rk("Информационные системы")))+'</span> <component data-component="SBIS3.CONTROLS/Menu/MenuButton" name="addConnection" class="controls-Button__withoutCaption" style="margin-top: 9px;"> <option name="caption">Добавить</option> <option name="icon">icon-24 icon-AddButtonNew icon-primary normaltext-color</option> <option name="primary">true</option> <options name="items" type="array"> <options> <option name="id">IntEngineCom1S82</option> <option name="icon">icon-24 icon-1c icon-primary</option> <option name="title">1С</option> </options> <options> <option name="id">IntEngineComSAPNC3</option> <option name="icon">icon-24 icon-SAP icon-primary</option> <option name="title">SAP</option> </options> <options> <option name="id">IntEngineComStoreHouse4</option> <option name="icon">icon-24 icon-Ship icon-primary</option> <option name="title">Store House</option> </options> </options> </component> </div> <hr align="center" width="100%" size="1" color="#DFDFDF"/> <div> <component data-component="SBIS3.CONTROLS/DataGridView" name="settingList" class="controls-DataGridView__hasSeparator ExtListUserSettings-Toolbar"> <option name="idProperty">@IntegrationConnection</option> <options name="columns" type="array"> <options> <option name="title"></option> <option name="width">50px</option> <option name="field">service</option> <option name="cellTemplate">tmpl!SBIS3.EDO.ExtListUserSettings/resources/servIconTempl</option> </options> <options> <option name="title"></option> <option name="width">100%</option> <option name="cellTemplate">tmpl!SBIS3.EDO.ExtListUserSettings/resources/nameConnection</option> <option name="className">controls-DataGridView-cell-overflow-ellipsis controls-DataGridView-cell-verticalAlignTop </option> </options> <options> <option name="title"></option> <option name="width">30px</option> <option name="field">@IntegrationConnection</option> <option name="cellTemplate">tmpl!SBIS3.EDO.ExtListUserSettings/resources/connToSystem</option> </options> <options> <option name="width">100px</option> <option name="className"> ExtListUserSettings-SettingList__textcenter </option> </options> </options> <option name="multiselect">false</option> </component> </div> </div>');return(p=n(p))+(e&&-1!==p.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.ExtListUserSettings"}},o});
define("html!SBIS3.EDO.ExtStatusConnection",function(){var n=function(n){var e=function(){var n=/\{\{([\s\S]+?)\}\}/g;return function(e){for(;n.test(e);)e=e.replace(n,"&#123;&#123;$1&#125;&#125;");return e}}(),t=function(n){return n.join?n.join(""):n.toString()},r=function(n){return void 0===n?"":n&&"object"==typeof n?t(n):""+n},o="undefined"!=typeof process,i=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div> <div id="indicator'+e(r(n.idConnection))+'" title="'+e(r(rk("Проверка соединения")))+'"><img src="'+e(r(n["loader-indicator"]))+'"/></div> </div>');return(i=e(i))+(o&&-1!==i.indexOf("{{")?String.fromCharCode(8203,8203):"")};return n.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.ExtStatusConnection"}},n});
define('js!SBIS3.EDO.ExtStatusConnection',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.ExtStatusConnection','js!SBIS3.EDO.IntEngine','Deprecated/Controls/PathSelector/PathSelector','Dokumentooborot_localization'],function(n,e,t){var o=n.extend({_dotTplFn:e,$protected:{_options:{'loader-indicator':'/resources/SBIS3.CONTROLS/themes/online/img/ajax-loader-16x16-wheel.v1516270649826335cf4508dd597be4bfc9caa3e08b901.gif'}},$constructor:function(){},init:function(){o.superclass.init.call(this);var n=this._options['idConnection'],e=document.getElementById('indicator'+n),i=t.getUserConfig(n),c='<div class="icon-16 icon-BigRemark icon-disabled" connected="false" title="Соединение не установлено"></div>',r='<div class="icon-16 icon-BigRemark icon-done" connected="true" title="Соединение установлено"></div>',a=function(o){if(e.innerHTML='<img src="/resources/SBIS3.CONTROLS/themes/online/img/ajax-loader-16x16-wheel.v1516270649826335cf4508dd597be4bfc9caa3e08b901.gif"/>','false'===o.toElement.attributes['connected'].value)t.createConnection(n,true).addCallbacks(function(n){e.innerHTML=n?r:c,e.onclick=a;},function(o){e.innerHTML=c,e.onclick=a,t.sendErrorReport(n,'Мастер подключения','',o.message);});else if('true'===o.toElement.attributes['connected'].value)t.destroyConnection(n).addCallbacks(function(n){e.innerHTML=!n?r:c,e.onclick=a;},function(o){e.innerHTML=c,e.onclick=a,t.sendErrorReport(n,'Мастер подключения','',o.message);});};(function(){var e=document.getElementById('indicator'+n);if(i.paramsConnection.nameModule)t.checkConnection(n).addCallbacks(function(n){e.innerHTML=n?r:c,e.onclick=a;},function(n){e.innerHTML=c,e.onclick=a;});else e.innerHTML=c,e.onclick=a;}());}});return o;});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.ExtListUserSettings", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".ExtListUserSettings-SettingList__textcenter{text-align:center}.ExtListUserSettings-Toolbar .controls-ItemsToolbar{bottom:10px}"));head.appendChild(style);});}
define("tmpl!SBIS3.EDO.ExtListUserSettings/resources/servIconTempl",["Core/tmpl/js/tclosure"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={},i=function e(i,s,n,o,l){function c(){}var a=0,u=void 0!==t&&t?t:arguments[arguments.length-1];void 0===u&&(eval("var thelpers = null;"),u=global.requirejs("View/Runner/tclosure"));var d={};l&&l.isSetts&&(d=l.fullContext||{});var p="string"==typeof n?n:"",v=void 0===r?void 0:r,m={id:[],def:void 0},f=u.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,i),g=this&&this.includedTemplates?this.includedTemplates:{},S=u.getMarkupGenerator(o);try{var h=S.joinElements([S.createTag("div",{class:""+u.wrapUndef(u.utils.escape(u.getter(i,["item","get"]).apply(u.getter(i,["item"]),["icon_field"])))},[],s,m,this)],p,m);m.def&&(h=S.chain(h,m,s),m=void 0)}catch(e){u.templateError("resources/Dokumentooborot/IntegrationSystem/ExtListUserSettings/resources/servIconTempl.tmpl",e,i)}return h||""};return i.includedFunctions={},i.stable=!0,i.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.ExtListUserSettings/resources/servIconTempl"}},i});
define("tmpl!SBIS3.EDO.ExtListUserSettings/resources/connToSystem",["Core/tmpl/js/tclosure","js!SBIS3.EDO.ExtStatusConnection"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],n={};n["js!SBIS3.EDO.ExtStatusConnection"]=e[1];var r=function e(r,o,i,s,c){function a(){}var l=0,u=void 0!==t&&t?t:arguments[arguments.length-1];void 0===u&&(eval("var thelpers = null;"),u=global.requirejs("View/Runner/tclosure"));var d={};c&&c.isSetts&&(d=c.fullContext||{});var S="string"==typeof i?i:"",m=void 0===n?void 0:n,p={id:[],def:void 0},v=u.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,r),f=this&&this.includedTemplates?this.includedTemplates:{},g=u.getMarkupGenerator(s);try{var y=g.joinElements([g.createTag("div",{style:"text-align: center;"},[g.createControl("wsControl","ws:SBIS3.EDO.ExtStatusConnection",{idConnection:u.getter(r,["item","get"]).apply(u.getter(r,["item"]),["@IntegrationConnection"])},{},{data:r,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:v},i,m,f,u.config,d)],o,p,this)],S,p);p.def&&(y=g.chain(y,p,o),p=void 0)}catch(e){u.templateError("resources/Dokumentooborot/IntegrationSystem/ExtListUserSettings/resources/connToSystem.tmpl",e,r)}return y||""};return r.includedFunctions={},r.stable=!0,r.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.ExtListUserSettings/resources/connToSystem"}},r});
define("tmpl!SBIS3.EDO.ExtListUserSettings/resources/headSyncTempl",["Core/tmpl/js/tclosure"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={},n=function e(n,i,l,o,s){function a(){}var c=0,d=void 0!==t&&t?t:arguments[arguments.length-1];void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure"));var u={};s&&s.isSetts&&(u=s.fullContext||{});var p="string"==typeof l?l:"",m=void 0===r?void 0:r,v={id:[],def:void 0},g=d.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,n),f=this&&this.includedTemplates?this.includedTemplates:{},y=d.getMarkupGenerator(o);try{var h=y.joinElements([y.createTag("div",{style:"vertical-align: middle;text-align: center;margin-left: 15px"},[y.createText(""+global.rk("ИС&nbsp;")),y.createTag("span",{class:"icon-16 icon-ConnectionPeriod icon-primary",style:"vertical-align:middle;"},[],{},v,this),y.createText(""+global.rk("&nbsp;&nbsp;СБИС"))],i,v,this)],p,v);v.def&&(h=y.chain(h,v,i),v=void 0)}catch(e){d.templateError("resources/Dokumentooborot/IntegrationSystem/ExtListUserSettings/resources/headSyncTempl.tmpl",e,n)}return h||""};return n.includedFunctions={},n.stable=!0,n.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.ExtListUserSettings/resources/headSyncTempl"}},n});
define("tmpl!SBIS3.EDO.ExtListUserSettings/resources/directionSync",["Core/tmpl/js/tclosure"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={},i=function e(i,n,o,s,c){function l(){}var a=0,u=void 0!==t&&t?t:arguments[arguments.length-1];void 0===u&&(eval("var thelpers = null;"),u=global.requirejs("View/Runner/tclosure"));var d={};c&&c.isSetts&&(d=c.fullContext||{});var p="string"==typeof o?o:"",v=void 0===r?void 0:r,m={id:[],def:void 0},f=u.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,i),g=this&&this.includedTemplates?this.includedTemplates:{},S=u.getMarkupGenerator(s);try{var y=S.joinElements([S.createTag("div",{class:""+u.wrapUndef(u.utils.escape(u.getter(i,["item","get"]).apply(u.getter(i,["item"]),["dir_icon"])))},[],n,m,this)],p,m);m.def&&(y=S.chain(y,m,n),m=void 0)}catch(e){u.templateError("resources/Dokumentooborot/IntegrationSystem/ExtListUserSettings/resources/directionSync.tmpl",e,i)}return y||""};return i.includedFunctions={},i.stable=!0,i.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.ExtListUserSettings/resources/directionSync"}},i});
define("tmpl!SBIS3.EDO.ExtListUserSettings/resources/nameConnection",["Core/tmpl/js/tclosure"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={},n=function e(n,i,a,o,s){function c(){}var m=0,l=void 0!==t&&t?t:arguments[arguments.length-1];void 0===l&&(eval("var thelpers = null;"),l=global.requirejs("View/Runner/tclosure"));var p={};s&&s.isSetts&&(p=s.fullContext||{});var g="string"==typeof a?a:"",u=void 0===r?void 0:r,d={id:[],def:void 0},y=l.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,n),f=this&&this.includedTemplates?this.includedTemplates:{},v=l.getMarkupGenerator(o);try{var S=v.joinElements([v.createTag("div",{},[v.createText(" "+l.wrapUndef(l.utils.escape(l.getter(n,["item","get"]).apply(l.getter(n,["item"]),["name_connection"])))+" "),v.createTag("div",{style:"font-size: 12px;color: #8991A9;"},[l.getter(l.getter(n,["item","get"]).apply(l.getter(n,["item"]),["paramsConnection"]),["nameSystem"])?[v.createText(" "+l.wrapUndef(l.utils.escape(l.getter(l.getter(n,["item","get"]).apply(l.getter(n,["item"]),["paramsConnection"]),["nameSystem"])))+" "),l.getter(l.getter(n,["item","get"]).apply(l.getter(n,["item"]),["paramsConnection"]),["nameSubsystem"])?[v.createText(" "+global.rk(":")+" ")]:v.createText("")]:v.createText(""),l.getter(l.getter(n,["item","get"]).apply(l.getter(n,["item"]),["paramsConnection"]),["nameSubsystem"])?[v.createText(" "+l.wrapUndef(l.utils.escape(l.getter(l.getter(n,["item","get"]).apply(l.getter(n,["item"]),["paramsConnection"]),["nameSubsystem"])))+" ")]:v.createText("")],{},d,this)],i,d,this)],g,d);d.def&&(S=v.chain(S,d,i),d=void 0)}catch(e){l.templateError("resources/Dokumentooborot/IntegrationSystem/ExtListUserSettings/resources/nameConnection.tmpl",e,n)}return S||""};return n.includedFunctions={},n.stable=!0,n.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.ExtListUserSettings/resources/nameConnection"}},n});
define('js!SBIS3.EDO.ExtListUserSettings',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.ExtListUserSettings','js!SBIS3.EDO.IntEngine','Core/Context','WS.Data/Source/SbisService','Core/core-attach','js!SBIS3.EDO.ExtStatusConnection','css!SBIS3.EDO.ExtListUserSettings','tmpl!SBIS3.EDO.ExtListUserSettings/resources/servIconTempl','tmpl!SBIS3.EDO.ExtListUserSettings/resources/connToSystem','tmpl!SBIS3.EDO.ExtListUserSettings/resources/headSyncTempl','tmpl!SBIS3.EDO.ExtListUserSettings/resources/directionSync','tmpl!SBIS3.EDO.ExtListUserSettings/resources/nameConnection','SBIS3.CONTROLS/Menu/MenuButton','SBIS3.CONTROLS/DataGridView','SBIS3.CONTROLS/Button','Dokumentooborot_localization'],function(t,e,n,i,o,r){var s={serviceIcons:{},connectionIcons:{con:'icon-16 icon-BigRemark icon-done',discon:'icon-16 icon-BigRemark icon-disabled'},statusIcons:{0:'',1:'icon-16 icon-ConnectionPeriod icon-primary',2:'icon-16 icon-Sent2 icon-primary',3:'icon-16 icon-Received2 icon-primary'}},c=t.extend({_dotTplFn:e,$protected:{_options:{}},$constructor:function(){},init:function(){c.superclass.init.call(this);var t=this,e=n.paramModule;for(var a in e)s.serviceIcons[e[a]['service']]='icon-32 '+e[a]['iconSystem']+' icon-primary';var u=this.getChildControlByName('settingList');SBIS3.EDO.ExtListUserSettings.prototype.updateList(u),u.subscribe('onBeginDelete',function(t,e){return new o({endpoint:{address:'/integration_config/service/',contract:'IntegrationConnection'}}).call('Удалить',{'ИдО':e[0]}).addCallbacks(function(t){return n.destroyConnection(e[0]).addCallbacks(function(t){return delete n.userConfig()[e[0]],SBIS3.EDO.ExtListUserSettings.prototype.updateList(u).addCallback(function(t){if(t){if(i.global.getValue('paramMenu'))n.createMenu();n.updateMenu();}});},function(t){n.sendErrorReport(e[0],'Мастер подключения','',t.message);});},function(t){n.sendErrorReport(e[0],'Мастер подключения','',t.message);});}),u.subscribe('onItemActivate',function(e,n){r.attachInstance('Lib/Control/FloatArea/FloatArea',{target:$('body'),template:'js!SBIS3.IntegrationConfig.ExtConfiguration',autoWidth:false,autoHeight:true,modal:false,autoHide:true,autoShow:true,catchScroll:false,resizable:false,side:'right',controlsSide:'right',autoCloseOnHide:true,verticalAlign:'middle',isStack:true,keepSize:false,width:1000,direction:'left',componentOptions:{idConnection:n.id,settingList:t.getChildControlByName('settingList')}});}),this.getChildControlByName('addConnection').subscribe('onMenuItemActivate',function(t,e){n.showExtConnectionWizard({moduleNameWizard:e});});},updateList:function(t){return n.readConnectionList(true,true).addCallbacks(function(e){var n=[];for(var i in e){if(!e.hasOwnProperty(i))continue;var o=e[i];o['icon_field']=s.serviceIcons[o['service']],o['conn_icon']=s.connectionIcons[o.connected?'con':'discon'],n.push(o);}return t.setItems(n),true;},function(t){return n.sendErrorReport(idConnection,'Мастер подключения','',t.message),false;});}});return c;});
define("html!SBIS3.EDO.ExtSysDateCellTemplate",function(){var e=function(e){var t=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;e.test(t);)t=t.replace(e,"&#123;&#123;$1&#125;&#125;");return t}}(),r=function(e){return e.join?e.join(""):e.toString()},n=function(e){return void 0===e?"":e&&"object"==typeof e?r(e):""+e},o="undefined"!=typeof process,i=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="ext_datadoc"> ');return e.ladder.get(e.item,"Дата")&&(i+=" "+t(n(e.ladder.get(e.item,"Дата").substr(0,6)))+t(n(e.ladder.get(e.item,"Дата").substr(8)))+" "),i+=" </div>",(i=t(i))+(o&&-1!==i.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.ExtSysDateCellTemplate"}},e});
define('js!SBIS3.EDO.ExtSysDateCellTemplate',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.ExtSysDateCellTemplate','Dokumentooborot_localization'],function(t,e){var n=t.extend({_dotTplFn:e,$protected:{_options:{}},$constructor:function(){},init:function(){n.superclass.init.call(this);}});return n;});
define("html!SBIS3.EDO.ExtSysDocumentCellTemplate",function(){var t=function(t){var e=function(){var t=/\{\{([\s\S]+?)\}\}/g;return function(e){for(;t.test(e);)e=e.replace(t,"&#123;&#123;$1&#125;&#125;");return e}}(),i=function(t){return t.join?t.join(""):t.toString()},n=function(t){return void 0===t?"":t&&"object"==typeof t?i(t):""+t},o="undefined"!=typeof process,r=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div> <div class="ext_partner">'+e(n(t.item.get("Контрагент")))+'</div> <div class="ext_organization">'+e(n(t.item.get("Организация")))+"</div> <table> ");r+=" ";var s=t.item.get("Вложения").toArray();if(s)for(var l,c=-1,d=s.length-1;c<d;)l=s[c+=1],r+=' <tr style="line-height: 16px"> <td class="icon" style="vertical-align: top; width: 18px"> ',0==c&&(r+=' <div class="icon-12 icon-Attach icon-disabled" style="font-size: 12px; font-family: \'cbuc-icons\'"></div> '),r+=' </td> <td> <div class="ext_attachement">'+e(n(l.get("Название")))+"</div> </td> </tr> ";return r+=" ",t.item.get("Комментарий")&&(r+=' <tr style="line-height: 16px"> <td class="icon" style="vertical-align: top; width: 16px"> <div class="icon-12 icon-Document icon-disabled" style="font-size: 12px; font-family: \'cbuc-icons\'"></div> </td> <td> <div class="ext_comment">'+e(n(t.item.get("Комментарий")))+"</div> </td> </tr> "),r+=" ",t.item.get("Состояние")&&(r+=" ","Ошибка:"===t.item.get("Состояние").substr(0,7)&&(r+=' <tr style="line-height: 16px"> <td class="icon" style="vertical-align: top; width: 18px"> <div class="icon-12 icon-EmptyMessage icon-hover" style="font-size: 12px; font-family: \'cbuc-icons\';"></div> </td> <td> <div class="ext_comment_error">'+e(n(t.item.get("Состояние").substr(8)))+"</div> </td> </tr> "),r+=" "),r+=" </table> </div>",(r=e(r))+(o&&-1!==r.indexOf("{{")?String.fromCharCode(8203,8203):"")};return t.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.ExtSysDocumentCellTemplate"}},t});
define('js!SBIS3.EDO.ExtSysDocumentCellTemplate',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.ExtSysDocumentCellTemplate','Dokumentooborot_localization'],function(t,n){var e=t.extend({_dotTplFn:n,$protected:{_options:{}},$constructor:function(){},init:function(){e.superclass.init.call(this);}});return e;});
define("html!SBIS3.EDO.ExtSysDocumentCellTemplateTax",function(){var t=function(t){var e=function(){var t=/\{\{([\s\S]+?)\}\}/g;return function(e){for(;t.test(e);)e=e.replace(t,"&#123;&#123;$1&#125;&#125;");return e}}(),i=function(t){return t.join?t.join(""):t.toString()},n=function(t){return void 0===t?"":t&&"object"==typeof t?i(t):""+t},r="undefined"!=typeof process,o=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div> <div class="ext_partner">'+e(n(t.item.get("НаименованиеОтчета")))+'</div> <table> <tr style="line-height: 18px"> <td class="icon" style="vertical-align: top; width: 18px"></td> <td> <div class="">'+e(n(t.item.get("Организация")))+"</div> </td> </tr> ");return t.item.get("Комментарий")&&(o+=' <tr style="line-height: 16px"> <td class="icon" style="vertical-align: top; width: 18px"> <div class="icon-12 icon-EmptyMessage icon-disabled" style="font-size: 12px; font-family: \'cbuc-icons\'"></div> </td> <td> <div class="ext_comment">'+e(n(t.item.get("Комментарий")))+"</div> </td> </tr> "),o+=" </table> </div>",(o=e(o))+(r&&-1!==o.indexOf("{{")?String.fromCharCode(8203,8203):"")};return t.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.ExtSysDocumentCellTemplateTax"}},t});
define('js!SBIS3.EDO.ExtSysDocumentCellTemplateTax',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.ExtSysDocumentCellTemplateTax','Dokumentooborot_localization'],function(t,n){var e=t.extend({_dotTplFn:n,$protected:{_options:{}},$constructor:function(){},init:function(){e.superclass.init.call(this);}});return e;});
define("html!SBIS3.EDO.ExtSysFilterDocuments",function(){var e=function(e){var t=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;e.test(t);)t=t.replace(e,"&#123;&#123;$1&#125;&#125;");return t}}(),o=function(e){return e.join?e.join(""):e.toString()},n=function(e){return void 0===e?"":e&&"object"==typeof e?o(e):""+e},i="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="edo-EDOFilter"> <div> <table style="padding: 0px 0px 10px 0px"> <tr> <td> <component data-component="SBIS3.CONTROLS/DropdownList" name="PeriodDropdown" style="padding: 0px 10px 0px 0px"> <options name="items" type="array"> <options> <option name="key" value="Все"></option> <option name="title">За весь период</option> </options> <options> <option name="key" value="Сегодня"></option> <option name="title">За сегодня</option> </options> <options> <option name="key" value="Месяц"></option> <option name="title">За последний месяц</option> </options> <options> <option name="key" value="Полгода"></option> <option name="title">За последние полгода</option> </options> <options> <option name="key" value="Год"></option> <option name="title">За последний год</option> </options> <options> <option name="key" value="Период"></option> <option name="title">За период</option> </options> </options> <option name="keyField" value="key"></option> <option name="displayField" value="title"></option> <option name="multiselect">false</option> <option name="mode">click</option> <opt name="pickerClassName">controls-DropdownList__picker edo-EDOCtxFilter__picker</opt> <opts name="pickerConfig"> <opt name="closeByExternalOver">true</opt> </opts> <option name="text" bind="FilterDatePeriodText" direction="fromProperty" oneWay="true" value=""></option> <options name="selectedKeys" type="array" bind="filterDDLKey"></options> </component> </td> <td> <component data-component="SBIS3.CONTROLS/Date/Range" name="PeriodInput"> <option name="serializationMode">date</option> <option name="startValue" bind="dateFrom"></option> <option name="endValue" bind="dateTo"></option> <option name="visible">false</option> </component> </td> <td> <div style="display: inline-block;"> <div id="drSelectPeriod" style="margin: 5px; z-index: 1;"> <span style="color: darkgrey" data-bind="text : drSelectPeriod"></span> </div> <component data-component="SBIS3.CONTROLS/Date/Range" name="drPeriod" class="DateRange ws-Label-content" style="z-index: 1;"> <option name="endDate" bind="dateTo">2016-11-30</option> <option name="startDate" bind="dateFrom">2016-11-30</option> <option name="visible">false</option> </component> </div> </td> </tr> </table> </div> <div> <table width="100%" style="padding: 0px 0px 10px 0px"> <tr> <td> <div class="edo-EDOCtxFilter__flLabel" style="padding: 0px 10px 0px 0px">'+t(n(rk("Наша организация")))+'</div> </td> <td align="right"> <component data-component="SBIS3.Contragents.ChoiceOurCompany" name="FilterOurOrganisation" style="width:250px;"> <opt name="selectedKeys" bind="idOrganisation"/> <opt name="textValue" bind="textOrganisation" direction="fromProperty" oneWay="true" value=""/> <opt name="placeholder" value="'+t(n(rk("Укажите название, ИНН или КПП")))+'"/> <opt name="displayField" value="Название"/> <opt name="keyField" value="@Лицо"/> </component> </td> </tr> </table> </div> ');return"ListDocuments"===e.nameTemplate&&(a+=' <div> <table width="100%"> <tr> <td> <div class="edo-EDOCtxFilter__flLabel" style="padding: 0px 10px 0px 0px">'+t(n(rk("Контрагент")))+'</div> </td> <td align="right"> <component data-component="SBIS3.AddresseeChoice.FieldLink" name="FilterFace1" style="width: 294px;"> <option name=\'multiselect\' type="boolean">false</option> <option name="selectedKeys" bind="idPartner"></option> <option name="placeholder" value="Укажите название или ИНН"></option> <option name="textValue" bind="textPartner" direction="fromProperty" oneWay="true" value=""></option> <option name="autoShow">false</option> </component> </td> </tr> </table> </div> '),a+=" </div>",(a=t(a))+(i&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.ExtSysFilterDocuments"}},e});
define('js!SBIS3.EDO.ExtSysFilterDocuments',['Core/helpers/string-helpers','SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.ExtSysFilterDocuments','SBIS3.CONTROLS/DropdownList','SBIS3.CONTROLS/Date/Range','SBIS3.CONTROLS/FieldLink','optional!js!SBIS3.Contragents.ChoiceOurCompany','SBIS3.CONTROLS/TextBox','js!SBIS3.AddresseeChoice.FieldLink','Dokumentooborot_localization'],function(e,t,o){var n=t.extend({_dotTplFn:o,$protected:{_options:{}},$constructor:function(){self=this;},init:function(){n.superclass.init.call(this);var t=self.getChildControlByName('drPeriod');t.subscribe('onRangeChange',function(o,n){var i=t.getStartValue(),l=t.getEndValue();if(!n)this.getLinkedContext().setValue('drSelectPeriod','');else if(i&&l&&i.getFullYear()===l.getFullYear()&&i.getMonth()===l.getMonth()&&i.getDate()===l.getDate())this.getLinkedContext().setValue('drSelectPeriod',e.format({date:i},'$date$t$%e %q %Y$'));else this.getLinkedContext().setValue('drSelectPeriod',e.format({date:i},'$date$t$%d.%m.%Y$')+'-'+e.format({date:l},'$date$t$%d.%m.%Y$'));}),periodDropdown=this.getChildControlByName('PeriodDropdown'),periodInput=this.getChildControlByName('PeriodInput'),periodDropdown.subscribe('onSelectedItemsChange',function(){dropdownValue=periodDropdown.getSelectedKeys();var e='',t='';if('Период'==dropdownValue)n.prototype.setVisibility(true);else if('Все'==dropdownValue)n.prototype.setVisibility(false),n.prototype.setDate(null,null);else if('Сегодня'==dropdownValue)n.prototype.setVisibility(false),n.prototype.setDate(new Date(),new Date());else if('Месяц'==dropdownValue)n.prototype.setVisibility(false),n.prototype.setDate(new Date(new Date().setMonth(new Date().getMonth()-1)),new Date());else if('Полгода'==dropdownValue)n.prototype.setVisibility(false),n.prototype.setDate(new Date(new Date().setMonth(new Date().getMonth()-6)),new Date());else if('Год'==dropdownValue)n.prototype.setVisibility(false),n.prototype.setDate(new Date(new Date().setFullYear(new Date().getFullYear()-1)),new Date());});},setVisibility:function(e){periodInput=self.getChildControlByName('PeriodInput'),periodInput.setVisible(e),document.getElementById('drSelectPeriod').style.display=e?'none':'block';},setDate:function(e,t){if(!e&&!t)(o=self.getChildControlByName('drPeriod')).setStartDate(),o.setEndDate(),self.getLinkedContext().setValue('filterContext/dateFrom',null),self.getLinkedContext().setValue('filterContext/dateTo',null);else{var o=self.getChildControlByName('drPeriod');o.setStartDate(e),o.setEndDate(t);}}});return n;});
define("tmpl!SBIS3.EDO.ExtSysFilterLineTemplate",["Core/tmpl/js/tclosure"],function(){var t=Array.prototype.slice.call(arguments),e=t[0],i={},r=function t(r,n,l,o,s){function a(){}var c=0,d=void 0!==e&&e?e:arguments[arguments.length-1];void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure"));var u={};s&&s.isSetts&&(u=s.fullContext||{});var f="string"==typeof l?l:"",_=void 0===i?void 0:i,h={id:[],def:void 0},p=d.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,r),v=this&&this.includedTemplates?this.includedTemplates:{},m=d.getMarkupGenerator(o);try{var g=m.joinElements([m.createTag("div",{class:"controls__filterButton__filterLine"},[m.createTag("div",{class:"controls__filterButton__filterLine-table"},[m.createTag("div",{class:"controls__filterButton__filterLine-table-row"},[m.createTag("span",{class:"controls__filterButton__filterLine-items ws-hover-target","data-bind":"attr : {title : 'titleText'}"},[m.createTag("i",{class:"controls__filterButton__filterLine-arrow icon-size icon-16 icon-DayForward icon-primary ws-hidden","data-bind":"{visible: 'filterChanged'}",id:"ExtArrow"},[],{},h,this),m.createTag("span",{class:"docs-FBLineResult__linetxt","data-bind":"{html: 'linkText'}"},[],{},h,this)],{},h,this),m.createTag("i",{class:"controls__filterButton__filterLine-cross icon-size icon-16 icon-Close icon-disabled action-hover ws-hidden","data-bind":"{visible: 'filterChanged'}",id:"ExtCross"},[],{},h,this)],{},h,this)],{},h,this)],n,h,this)],f,h);h.def&&(g=m.chain(g,h,n),h=void 0)}catch(t){d.templateError("resources/Dokumentooborot/IntegrationSystem/ExtSysListDocuments/ExtSysFilterLineTemplate/ExtSysFilterLineTemplate.tmpl",t,r)}return g||""};return r.includedFunctions={},r.stable=!0,r.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.ExtSysFilterLineTemplate"}},r});
define('js!SBIS3.EDO.ExtSysFilterLineTemplate',['Core/helpers/string-helpers','SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.ExtSysFilterLineTemplate','Dokumentooborot_localization'],function(e,t,i){var n=t.extend({_dotTplFn:i,$protected:{_options:{}},$constructor:function(){var t=this.getLinkedContext(),i=this,n=function(){var n=t.getValue('filterStructure'),l='',s=[],o,r=t.getValue('filterResetLinkText'),a=n[0].value,f=n[1].value,u=n[2].caption,c=n[3].caption,d=n[4].value;if(d&&d.length>0)o=d[0];if(u)s.push(u);if(c)s.push(c);if(f&&o)if('Период'==o)if(a.getFullYear()===f.getFullYear()&&a.getMonth()===f.getMonth()&&a.getDate()===f.getDate())s.push(e.format({date:f},'$date$t$%e %q %Y$'));else s.push(e.format({date:a},'$date$t$%d.%m.%Y$')+'-'+e.format({date:f},'$date$t$%d.%m.%Y$'));else if('Сегодня'==o)s.push('За сегодня');else if('Месяц'==o)s.push('За последний месяц');else if('Полгода'==o)s.push('За последние полгода');else if('Год'==o)s.push('За последний год');if(0==s.length)l=t.getValue('filterResetLinkText');else l=s.join('<span class="filterString icon-size icon-16 icon-DayForward icon-primary ext_arrow"/>');t.setValueSelf({linkText:l,titleText:e.escapeTagsFromStr(l,'')}),i.toggle(!!r);};t.subscribe('onFieldsChanged',n),this._container.on('click','.controls__filterButton__filterLine-cross',function(){if(i.isEnabled())i.sendCommand('reset-filter');}),this._container.on('click','.controls__filterButton__filterLine-items',function(){if(i.isEnabled())i.sendCommand('show-filter');});},init:function(){n.superclass.init.call(this);}});return n;});
define("html!SBIS3.EDO.ExtSysListDocuments",function(){var t=function(t){var o=function(){var t=/\{\{([\s\S]+?)\}\}/g;return function(o){for(;t.test(o);)o=o.replace(t,"&#123;&#123;$1&#125;&#125;");return o}}(),n=function(t){return t.join?t.join(""):t.toString()},e=function(t){return void 0===t?"":t&&"object"==typeof t?n(t):""+t},i="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div> <div class="ws-sticky-header__block"> <div data-lmtype="RightFixed" style="overflow:hidden;" name="div 1"> <div data-lmchild="1" class="rightFixed-side" style="float:right;height:32px;padding-top:8px;padding-right:48px;"> <component data-component="SBIS3.CONTROLS/Button" name="LoadButton"> <option name="caption">Загрузить</option> <option name="primary">true</option> <option name="visible">false</option> </component> <div id="closeDialog"><a href="javascript:void(0)" class="ws-window-titlebar-action close"></a></div> </div> <div data-lmchild="1" class="rightFixed-content" style="margin-right:110px;height:100%;"> <span class="ext_titleDialog" id="titleDialog"></span> </div> </div> <table width="100%"> <tr> <td> <component data-component="SBIS3.CONTROLS/CheckBox" name="CheckBox"> <option name="threeState">true</option> <option name="className">multiselectCheckBox</option> </component> </td> <td align="right"> <component data-component="SBIS3.CONTROLS/Filter/Button" name="FilterButton"> <option name="template"> <component data-component="SBIS3.EDO.ExtSysFilterDocuments"> <option name="nameTemplate" value="'+o(e(t.params.nameTemplate))+'"></option> </component> </option> <option name="filterLineComponent" value="SBIS3.EDO.ExtSysFilterLineTemplate"></option> <option name="resetCaption" value="Сбросить"></option> <option name="resetLinkText" value=" "></option> <options name="filterStructure" type="array"> <options> <option name="internalValueField">dateFrom</option> <option name="internalCaptionField">dateFrom</option> <option name="value" bind="filterContext/dateFrom" value=""></option> <option name="caption" bind="filterContext/dateFrom" value=""></option> </options> <options> <option name="internalValueField">dateTo</option> <option name="internalCaptionField">dateTo</option> <option name="value" bind="filterContext/dateTo" value=""></option> <option name="caption" bind="filterContext/dateTo" value=""></option> </options> <options> <option name="internalValueField">idPartner</option> <option name="internalCaptionField">textPartner</option> <option name="value" bind="filterContext/idPartner" value=""></option> <option name="caption" bind="filterContext/textPartner" value=""></option> </options> <options> <option name="internalValueField">idOrganisation</option> <option name="internalCaptionField">textOrganisation</option> <option name="value" bind="filterContext/idOrganisation" value=""></option> <option name="caption" bind="filterContext/textOrganisation" value=""></option> </options> <options> <option name="internalValueField">filterDDLKey</option> <option name="value" bind="filterContext/filterDDLKey" value=""></option> </options> <options> <option name="internalValueField">drSelectPeriod</option> </options> <options> <option name="internalValueField">filterDDLTitle</option> </options> </options> </component> </td> </tr> </table> </div> <component data-component="SBIS3.CONTROLS/DataGridView" class="controls-DataGridView__hasSeparator" name="DataGridView"> <option name="keyField">Идентификатор</option> <options name="filter" bind="filterContext"></options> <options name="itemsActions" type="array"/> <option name="stickyHeader">true</option> <option name="itemsDragNDrop">false</option> <options name="ladder" type="array"> <option>Дата</option> </options> ');return"ListDocumentsTax"!==t.params.nameTemplate&&"ListDocumentsPFR"!==t.params.nameTemplate||(a+=' <option name="showHead">false</option> <options name="columns" type="array"> <options> <option name="width" type="string">70</option> <option name="cellTemplate">html!SBIS3.EDO.ExtSysDateCellTemplate</option> <option name="className">ExtSysListDoumentsDateCell</option> </options> <options> <option name="width" type="string">550</option> <option name="className">ext_reporting_top</option> <option name="cellTemplate">html!SBIS3.EDO.ExtSysDocumentCellTemplateTax</option> </options> <options> <option name="field">'+o(e(t.params.nameTemplate))+'</option> <option name="className">ext_reporting_top</option> <option name="cellTemplate">html!SBIS3.EDO.ExtSysReportingData</option> </options> </options> '),a+=" ","ListDocuments"===t.params.nameTemplate&&(a+=' <options name="columns" type="array"> <options> <option name="width" type="string">70</option> <option name="cellTemplate">html!SBIS3.EDO.ExtSysDateCellTemplate</option> <option name="field">Дата</option> <option name="className">ExtSysListDoumentsDateCell</option> </options> <options> <option name="cellTemplate">html!SBIS3.EDO.ExtSysDocumentCellTemplate</option> </options> <options> <option name="width" type="string">100</option> <option name="title">Состояние</option> <option name="className">ext_сondition</option> <option name="cellTemplate">html!SBIS3.EDO.ExtSysStatusImageTemplate</option> </options> <options> <option name="width" type="string">200</option> <option name="className">ext_responsible</option> <option name="title">Ответственный</option> <option name="field">Ответственный</option> </options> </options> '),a+=' <option name="emptyHTML">Нет документов за этот период</option> <option name="multiselect">true</option> <option name="showPaging">false</option> <option name="infiniteScroll">down</option> <option name="pageSize">30</option> </component> </div>',(a=o(a))+(i&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return t.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.ExtSysListDocuments"}},t});
define('js!SBIS3.EDO.ExtSysStatusImageTemplate',['WS.Data/Entity/Model','Dokumentooborot_localization'],function(i){return i.extend({$protected:{_options:{properties:{statusImageClass:{get:function(){var i=this.get('Состояние').toLowerCase();if(0===i.indexOf('отослано приглашение'))return'icon-16 icon-Send icon-disabled';if(0===i.indexOf('отправлен'))return'icon-16 icon-Sent2 icon-disabled';if(0===i.indexOf('на утверждении')||0===i.indexOf('доставлен'))return'icon-16 icon-Sent2 icon-disabled';if(0===i.indexOf('выполнение завершено с проблемами')||-1!==i.indexOf('ошибка')||-1!==i.indexOf('проблемы при доставке'))return'icon-16 icon-Exclamation icon-error';if(0===i.indexOf('выполнение завершено успешно'))return'icon-16 icon-Successful icon-done';if(0===i.indexOf('в обработке')||0===i.indexOf('выгружен')||0===i.indexOf('документ редактируется'))return'icon-16 icon-Successful icon-disabled';if(0===i.indexOf('отозван мной'))return'icon-16 icon-Close icon-disabled';if(0===i.indexOf('удален'))return'icon-16 icon-Close icon-disabled';}},statusImageTitle:{get:function(){var i=this.get('Состояние').toLowerCase();if(0===i.indexOf('отослано приглашение'))return rk('Отправлено приглашение');if(0===i.indexOf('отправлен'))return rk('Документ отправлен');if(0===i.indexOf('на утверждении')||0===i.indexOf('доставлен'))return rk('Документ доставлен');if(0===i.indexOf('выполнение завершено с проблемами')||-1!==i.indexOf('ошибка')||-1!==i.indexOf('проблемы при доставке'))return rk('Проблемы при доставке');if(0===i.indexOf('выполнение завершено успешно'))return rk('Успешно завершен');if(0===i.indexOf('в обработке')||0===i.indexOf('выгружен')||0===i.indexOf('документ редактируется'))return rk('В обработке');if(0===i.indexOf('отозван мной'))return rk('Удалено мной');if(0===i.indexOf('удален'))return rk('Удалено контрагентом');}}}}}});});
define("html!SBIS3.EDO.ExtSysStatusImageTemplate",function(){var e=function(e){var t=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;e.test(t);)t=t.replace(e,"&#123;&#123;$1&#125;&#125;");return t}}(),r=function(e){return e.join?e.join(""):e.toString()},n=function(e){return void 0===e?"":e&&"object"==typeof e?r(e):""+e},i="undefined"!=typeof process,o=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div style="text-align: center;"> ');return e.item.get("Состояние")&&(o+=" <div class='"+t(n(e.item.get("statusImageClass")))+"' title='"+t(n(e.item.get("statusImageTitle")))+'\' style="margin: 4px;"></div> '),o+=" </div>",(o=t(o))+(i&&-1!==o.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.ExtSysStatusImageTemplate"}},e});
define("html!SBIS3.EDO.ExtSysReportingData",function(){var e=function(e){var t=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;e.test(t);)t=t.replace(e,"&#123;&#123;$1&#125;&#125;");return t}}(),r=function(e){return e.join?e.join(""):e.toString()},i=function(e){return void 0===e?"":e&&"object"==typeof e?r(e):""+e},n="undefined"!=typeof process,o=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div> <div class="ext_reporting_right ext_reporting_period" style="margin-top: 2px;line-height: 21px;">'+t(i(e.item.get("ОтчетныйПериод")))+'</div> <div class="ext_reporting_right ext_reporting_period" style="line-height: 18px;"> ');return"ListDocumentsTax"==e.field&&(o+=' <span title="'+t(i(rk("Код налогового органа")))+'">'+t(i(e.item.get("КодНалоговогоОргана")))+"</span> "),o+=" ","ListDocumentsPFR"==e.field&&(o+=' <span title="'+t(i(rk("Номер пачки документов")))+'">'+t(i(e.item.get("НомерПачки")))+"</span> "),o+=" </div> </div>",(o=t(o))+(n&&-1!==o.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.ExtSysReportingData"}},e});
define('js!SBIS3.EDO.ExtSysReportingData',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.ExtSysReportingData','Dokumentooborot_localization'],function(t,n){var o=t.extend({_dotTplFn:n,$protected:{_options:{}},$constructor:function(){},init:function(){o.superclass.init.call(this);}});return o;});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.ExtSysListDocuments", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".ext_attachement{font-family:TensorFont,sans-serif;font-size:12px;color:#999;line-height:16px}.ext_partner{color:#313e78;float:left;line-height:21px;margin-top:1px;margin-right:8px;width:100%;z-index:1;font-family:TensorFont,sans-serif;font-size:15px;font-weight:700}.ext_datadoc{font-family:TensorFont,sans-serif;font-size:14px;color:#000;text-align:right;margin-top:2px;line-height:21px}.ExtSysListDoumentsDateCell{vertical-align:top!important}.ext_organization{margin-top:2px;color:#8991a9;line-height:21px;left:auto;max-width:50%;font-family:TensorFont,sans-serif;font-size:12px;font-weight:400;position:absolute;right:0}.ext_responsible{padding-top:5px;line-height:21px;vertical-align:top!important}.ext_comment_error{color:#ef463a;font-style:italic;font-family:TensorFont,sans-serif;font-size:12px;font-weight:400}.ext_comment{color:#999;font-style:italic;font-family:TensorFont,sans-serif;font-size:12px;font-weight:400}.multiselectCheckBox{position:relative;z-index:1}.ext_�ondition{text-align:center!important;margin-top:18px!important}.multiselectCheckBox>span{font-family:'TensorFont Regular',TensorFont!important;color:#05b!important}.ext_titleDialog{font-family:TensorFont,sans-serif;font-weight:700;font-size:18px;line-height:40px;height:40px;max-height:40px;margin-left:8px;margin-right:60px;position:absolute;left:0;overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;white-space:nowrap}.ext_filterString{height:19px;vertical-align:middle}.ext_arrow{vertical-align:middle;height:19px}.ext_reporting_top{vertical-align:top!important}.ext_reporting_right{text-align:right!important}.ext_reporting_period{color:#8991a9;font-family:TensorFont,sans-serif;font-size:12px;font-weight:400}"));head.appendChild(style);});}
define("html!SBIS3.EDO.ExtSysMultiselectHeaderTemplate",function(){var e=function(e){var t=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;e.test(t);)t=t.replace(e,"&#123;&#123;$1&#125;&#125;");return t}}(),n="undefined"!=typeof process,r=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div style="width: 100px; position: relative; right: 21px;"> <component data-component="SBIS3.CONTROLS/CheckBox" name="MultiselectHeaderTemplate"> <option name="threeState">true</option> <option name="className">multiselectCheckBox</option> </component> </div>');return(r=t(r))+(n&&-1!==r.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.ExtSysMultiselectHeaderTemplate"}},e});
define('js!SBIS3.EDO.ExtSysMultiselectHeaderTemplate',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.ExtSysMultiselectHeaderTemplate','SBIS3.CONTROLS/CheckBox','Dokumentooborot_localization'],function(t,e){var n=t.extend({_dotTplFn:e,$protected:{_options:{}},$constructor:function(){},init:function(){n.superclass.init.call(this);}});return n;});
define('js!SBIS3.EDO.ExtSysListDocuments',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.ExtSysListDocuments','js!SBIS3.EDO.ExtSysStatusImageTemplate','html!SBIS3.EDO.ExtSysStatusImageTemplate','js!SBIS3.EDO.ExtSysDocumentCellTemplate','js!SBIS3.EDO.ExtSysDocumentCellTemplateTax','js!SBIS3.EDO.ExtSysReportingData','js!SBIS3.EDO.ExtSysDateCellTemplate','js!SBIS3.EDO.ExtSysFilterDocuments','js!SBIS3.EDO.ExtSysFilterLineTemplate','SBIS3.CONTROLS/DataGridView','css!SBIS3.EDO.ExtSysListDocuments','SBIS3.CONTROLS/Filter/Button','SBIS3.CONTROLS/Filter/Button/Text','SBIS3.CONTROLS/Button','SBIS3.CONTROLS/Tab/Control','js!SBIS3.EDO.ExtSysMultiselectHeaderTemplate','SBIS3.CONTROLS/CheckBox','Dokumentooborot_localization'],function(e,t){var n=e.extend({_dotTplFn:t,$protected:{_options:{period:'',ourOrganization:'',contragent:''}},$constructor:function(){this.getLinkedContext().setValue('filterContext',{});},init:function(){this.filterValuesString='';var e=this;n.superclass.init.call(this);var t=e.getChildControlByName('DataGridView'),o=this._options.params,i=o.idConnection,l=SBIS3.EDO.IntEngine.getUserConfig(i);require(['js!SBIS3.Plugin.Source.LocalService'],function(e){var n;if('IntEngineCom1S82'===l.paramsConnection.nameModule||'IntEngineCom1S83'===l.paramsConnection.nameModule||'IntEngineCom1S77'===l.paramsConnection.nameModule)n='ExtCom1C';else if('IntEngineWeb1S83'===l.paramsConnection.nameModule)n='ExtWeb1C';else if('IntEngineComSAPBN1'===l.paramsConnection.nameModule||'IntEngineComSAPNC3'===l.paramsConnection.nameModule)n='ExtSap';else if('IntEngineComStoreHouse4'===l.paramsConnection.nameModule)n='ExtStoreHouse';var r=new e({endpoint:{address:n+'-1.0.0.0',contract:n},binding:{query:'getListDocuments'},adapter:'adapter.sbis',options:{mode:'always',queryTimeout:600000,navigationType:'Page'}});r.isReady().addCallbacks(function(){if(t.getContext().setValue('filterContext/iniName',o.reestr),t.getContext().setValue('filterContext/idConnection',i.toString()),o.filter){var e=o.filter;if(t.getContext().setValue('filterContext/dateFrom',e['ДатаНачала'].strftime('%Y.%m.%d')),t.getContext().setValue('filterContext/dateTo',e['ДатаКонца'].strftime('%Y.%m.%d')),t.getContext().setValue('filterContext/filterDDLKey',[e['Период']]),e['Организация']){if(e['Организация']['id'])t.getContext().setValue('filterContext/idOrganisation',[e['Организация']['id']]);if(e['Организация']['Название'])t.getContext().setValue('filterContext/textOrganisation',[e['Организация']['Название']]);}if(e['Контрагент']){if(e['Контрагент']['id'])t.getContext().setValue('filterContext/idPartner',[e['Контрагент']['id']]);if(e['Контрагент']['Название'])t.getContext().setValue('filterContext/textPartner',[e['Контрагент']['Название']]);}}t.setDataSource(r);},function(e){SBIS3.EDO.IntEngine.sendErrorReport(i,'ExtSysListDocuments.isReady',e.message);});});var r=e.getChildControlByName('CheckBox');t.subscribe('onSelectedItemsChange',function(){var n=t.getSelectedKeys().length;if(0!==n)e.getChildControlByName('LoadButton').show();else e.getChildControlByName('LoadButton').hide();if(n==t.getDataSet().getCount())r.setChecked(true),r.setCaption('Выбрано все ('+n+')');else if(n>0)r.setChecked(null),r.setCaption('Выбрано ('+n+')');else r.setChecked(false),r.setCaption('');}),t.subscribe('onDrawItems',function(){var e=t.getDataSet();if(0!=e.getCount()){var n=e._getRecord(e.getCount()-1).get('Идентификатор');t._options.filter['currDocument']=n;}}),r.subscribe('onActivated',function(){if(true==r.isChecked()){t.setSelectedItemsAll();var e=t.getPage();}else r.setChecked(false),t.setSelectedKeys([]);}),e.getChildControlByName('LoadButton').subscribe('onActivated',function(){for(var t=e.getChildControlByName('DataGridView'),n=t.getSelectedKeys(),i=t.getItems(),l=[],r=0;r<n.length;r++){var a=i.getRecordById(n[r]);if(a)l.push(a);}if(SBIS3.EDO.IntEngine[o.methodLoad])SBIS3.EDO.IntEngine[o.methodLoad](o,l);else SBIS3.EDO.IntEngine.loadDocumentsPackage(o,l);}),filterButton=e.getChildControlByName('FilterButton'),filterButton.subscribe('onResetFilter',function(){if(filterButton.isPickerVisible())if(filterButton.getChildControlByName('PeriodDropdown').setSelectedKeys(['Все']),filterButton.getChildControlByName('PeriodInput').hide(),document.getElementById('drSelectPeriod').style.display='none',filterButton.getChildControlByName('FilterOurOrganisation').setSelectedKeys([]),filterButton.hasChildControlByName('FilterFace1'))filterButton.getChildControlByName('FilterFace1').setSelectedKeys([]);}),filterButton.subscribe('onApplyFilter',function(){var e='',n='Все;null;null;;';if(e+=filterButton.getChildControlByName('PeriodDropdown').getSelectedKeys()[0]+';',e+=filterButton.getChildControlByName('PeriodInput').getStartDate()+';',e+=filterButton.getChildControlByName('PeriodInput').getEndDate()+';',e+=filterButton.getChildControlByName('FilterOurOrganisation').getSelectedKeys()+';',filterButton.hasChildControlByName('FilterFace1'))e+=filterButton.getChildControlByName('FilterFace1').getSelectedKeys()+';',n+=';';if(e==n)document.getElementById('ExtArrow').style.display='none',document.getElementById('ExtCross').style.display='none';else document.getElementById('ExtArrow').style.display='block',document.getElementById('ExtCross').style.display='inline-block';if(this.filterValuesString!=e&&this.filterValuesString)return void(this.filterValuesString=e);t.reload();}),filterButtonContext=filterButton.getContext(),document.getElementById('closeDialog').onclick=function(){e.getParent().close();};var a=document.getElementById('titleDialog');a.title=o.name,a.textContent=o.name;}});return n;});
define("html!SBIS3.EDO.IntAuthorization",function(){var t=function(t){var o=function(){var t=/\{\{([\s\S]+?)\}\}/g;return function(o){for(;t.test(o);)o=o.replace(t,"&#123;&#123;$1&#125;&#125;");return o}}(),n="undefined"!=typeof process,e=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div data-lmtype="Dialog"> <div class="ws-window-titlebar-custom" data-lmchild="WindowTitle" style="font-size:0; padding-right:30px"> </div> <table> <tr style="height:35px;"> <td style="width:16px;"></td> <td> <component data-component="Deprecated/Controls/FieldString/FieldString" style="width:100px;" name="надписьПользователь"> <option name="readOnly">true</option> <option name="enabled">false</option> <option name="value">Пользователь:</option> </component> </td> <td style="width:270px;"> <component data-component="Deprecated/Controls/FieldString/FieldString" style="width:100%;" name="Пользователь"> <option name="tooltipInside">true</option> <option name="tooltip">Введите имя пользователя</option> </component> <component data-component="SBIS3.CONTROLS/ComboBox" name="Пользователи" style="width:100%;"> <option name="visible">false</option> <option name="selectOnClick">true</option> <option name="keyField">key</option> <option name="pickerClassName">listUser</option> </component> </td> <td style="width:16px;"></td> </tr> <tr style="height:35px;"> <td></td> <td> <component data-component="Deprecated/Controls/FieldString/FieldString" style="width:100px;" name="надписьПароль"> <option name="readOnly">true</option> <option name="enabled">false</option> <option name="value">Пароль:</option> </component> </td> <td> <component data-component="Deprecated/Controls/FieldString/FieldString" style="width:100%;" name="Пароль"> <option name="password">true</option> <option name="tooltip">Введите пароль</option> <option name="tooltipInside">true</option> </component> </td> <td></td> </tr> <tr> <td></td> <td colspan="2" style="text-align:center;"> <div id="textMessage" style="color: #EF463A;"></div> </td> <td></td> </tr> </table> <component data-component="Deprecated/Controls/FieldCheckbox/FieldCheckbox" name="СохранятьПароль" style="float:left;margin-left:15px;margin-top:7px;width:140px;"> <option name="caption">запомнить пароль</option> <option name="tabIndex">1</option> </component> <component data-component="Deprecated/Controls/Button/Button" style="width:100px;float:right;margin-right:15px;margin-top:11px;margin-bottom:15px;" name="ButtonCancel"> <option name="caption">Отмена</option> </component> <component data-component="Deprecated/Controls/Button/Button" style="width:100px;float:right;margin-right:8px;margin-top:11px;" name="ButtonOK"> <option name="caption">ОК</option> <option name="defaultButton">true</option> </component> </div>');return(e=o(e))+(n&&-1!==e.indexOf("{{")?String.fromCharCode(8203,8203):"")};return t.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.IntAuthorization"}},t});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.IntAuthorization", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".ws-window-titlebar-custom .ws-window-title{position:absolute}.controls-ComboBox__picker .controls-ComboBox__itemRow{font-size:14px!important}"));head.appendChild(style);});}
define('js!SBIS3.EDO.IntAuthorization',['Core/core-attach','Core/WindowManager','Core/Deferred','SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.IntAuthorization','css!SBIS3.EDO.IntAuthorization','Deprecated/Controls/FieldString/FieldString','Deprecated/Controls/FieldCheckbox/FieldCheckbox','Deprecated/Controls/Button/Button','SBIS3.CONTROLS/ComboBox','SBIS3.CONTROLS/TextBox','Dokumentooborot_localization'],function(t,e,o,i,l){var n=i.extend({_dotTplFn:l,$protected:{_options:{minHeight:0,maximize:false}},$constructor:function(){},init:function(){n.superclass.init.call(this);var t=this._options._result;if(t['Пользователи']){this.getChildControlByName('Пользователь').hide(),this.getChildControlByName('Пользователи').show();for(var e=[],o=0,i=0;t['Пользователи']&&i<t['Пользователи'].length;i++)if(t['Пользователи'][i]){if(t['Пользователь']&&t['Пользователь']===t['Пользователи'][i])o=i;e.push({key:i,title:t['Пользователи'][i].replace(String.fromCharCode(13),'')});}var l=''!==t['Пользователь']?t['Пользователь']:e[o].title;this.getChildControlByName('Пользователи').setItems(e),this.getChildControlByName('Пользователи').setValue(l),this.getChildControlByName('Пользователь').setValue(l),this.getChildControlByName('Пользователи').subscribe('onTextChange',function(){var t=this.getTopParent(),e=t.getChildControlByName('Пользователи').getValue();t.getChildControlByName('Пользователь').setValue(e);});}else if(this.getChildControlByName('Пользователь').show(),this.getChildControlByName('Пользователи').hide(),t['Пользователь'])this.getChildControlByName('Пользователь').setValue(t['Пользователь']),this.getChildControlByName('Пароль').setActive(true,true);if(t['ТекстОшибки'])document.getElementById('textMessage').textContent=t['ТекстОшибки'];else document.getElementById('textMessage').textContent='';if(this.getChildControlByName('Пароль').setValue(t['Пароль']),this.getChildControlByName('СохранятьПароль').setValue(t['СохранятьПароль']),false===t['ПоказыватьСохранятьПароль'])this.getChildControlByName('СохранятьПароль').hide();else this.getChildControlByName('СохранятьПароль').show();this.getChildControlByName('ButtonOK').subscribe('onClick',function(t){var e=this.getTopParent(),o={'СохранятьПароль':e.getChildControlByName('СохранятьПароль').getValue(),'Пользователь':e.getChildControlByName('Пользователь').getValue(),'Пароль':e.getChildControlByName('Пароль').getValue()};e.close(),defAuth.callback(o);}),this.getChildControlByName('ButtonCancel').subscribe('onClick',function(t){this.getTopParent().close(),defAuth.callback(false);});}});return n.title='Вход в систему',n.dimensions={autoWidth:true,autoHeight:true,resizable:false,width:400,height:165,modal:true,disableActions:true},n.showAuthorizationDialog=function(i){return defAuth=new o(),t.attachInstance('Source:Dialog',{template:'js!SBIS3.EDO.IntAuthorization',title:i.Заголовок,disableActions:true,opener:e.getActiveWindow(),componentOptions:{_result:i}}),defAuth;},n;});
define("html!SBIS3.EDO.IntConnectionWizard",function(){var t=function(t){var o=function(){var t=/\{\{([\s\S]+?)\}\}/g;return function(o){for(;t.test(o);)o=o.replace(t,"&#123;&#123;$1&#125;&#125;");return o}}(),e=function(t){return t.join?t.join(""):t.toString()},n=function(t){return void 0===t?"":t&&"object"==typeof t?e(t):""+t},i="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div> <div> <component data-component="SBIS3.CONTROLS/Panel" name="Step1" style="width:auto;min-width:auto;height:250px;"> <option name="visible">false</option> <table style="width:100%"> <tr> <td style="width:12px"></td> <td> <div style="margin-left:4px;text-align:justify;" id="ТекстНаШаге1"> '+o(n(rk("Данный мастер позволяет")))+' <a target="_blank" href="https://help.sbis.ru/help/integration/1C_set/1C_sbis/">'+o(n(rk("синхронизировать")))+"</a> "+o(n(rk("вашу 1С с личным кабинетом СБИС. После прохождения мастера всего за пару кликов вы сможете:")))+' <br/> <ul style="margin-left:18px;padding: 2px;padding-bottom: 10px;"> <li>'+o(n(rk("загружать входящие документы в 1С")))+"</li> <li>"+o(n(rk("выгружать из 1С в СБИС: электронную отчетность и документы, справочники номенклатуры и сотрудников")))+'</li> </ul> </div> </td> <td style="width:16px"></td> </tr> <tr> <td></td> <td> <component data-component="Deprecated/Controls/FieldText/FieldText" style="width:100%;height:auto;" name="ВыберитеУС"> <option name="value">Выберите версию вашей 1С и перейдите к следующему шагу</option> <option name="autoHeight">true</option> <option name="allowChangeEnable">false</option> <option name="readOnly">true</option> <option name="enabled">false</option> </component> </td> <td></td> </tr> <tr> <td></td> <td> <component data-component="Deprecated/Controls/FieldRadio/FieldRadio" name="ВыборСистемы" style="margin-left:15px;"> <option name="value">IntEngineCom1S82</option> <option name="stateKey">ТипСистемы</option> <options name="data" type="array"> <options> <option name="align">left</option> <option name="label">1С: 8.2</option> <option name="name">IntEngineCom1S82</option> <option name="value">IntEngineCom1S82</option> </options> <options> <option name="align">left</option> <option name="label">1C: 8.3</option> <option name="name">IntEngineCom1S83</option> <option name="value">IntEngineCom1S83</option> </options> <options> <option name="align">left</option> <option name="label">1C: Web</option> <option name="name">IntEngineWeb1S83</option> <option name="value">IntEngineWeb1S83</option> </options> </options> </component> </td> <td></td> </tr> </table> </component> <component data-component="SBIS3.CONTROLS/Panel" name="Step1SAP" style="width:auto;min-width:auto;height:250px;"> <option name="visible">false</option> <table style="width:100%"> <tr> <td style="width:12px"></td> <td> <div style="margin-left:4px;text-align:justify;" id="ТекстНаШаге1SAP"> '+o(n(rk("Данный мастер позволяет")))+' <a target="_blank" href="https://help.sbis.ru/help/integration/saprfc/">'+o(n(rk("синхронизировать")))+"</a> "+o(n(rk("ваш SAP с личным кабинетом СБИС. После прохождения мастера всего за")))+' <span id="twoclicks">'+o(n(rk("пару кликов")))+"</span> "+o(n(rk("вы сможете:")))+' <ul style="margin-left:18px;padding: 2px;padding-bottom: 10px;"> <li>'+o(n(rk("загружать входящие документы в SAP")))+"</li> <li>"+o(n(rk("выгружать из SAP в СБИС: документы, справочники номенклатуры и сотрудников")))+'</li> </ul> </div> </td> <td style="width:16px"></td> </tr> <tr> <td></td> <td> <component data-component="Deprecated/Controls/FieldText/FieldText" style="width:100%;height:auto;" name="ВыберитеУСSAP"> <option name="value">Выберите версию вашего SAP и перейдите к следующему шагу</option> <option name="autoHeight">true</option> <option name="allowChangeEnable">false</option> <option name="readOnly">true</option> <option name="enabled">false</option> </component> </td> <td></td> </tr> <tr> <td></td> <td> <component data-component="Deprecated/Controls/FieldRadio/FieldRadio" name="ВыборСистемыSAP" style="margin-left:15px;"> <option name="value">IntEngineComSAPNC3</option> <option name="stateKey">ТипСистемы</option> <options name="data" type="array"> <options> <option name="align">left</option> <option name="label">SAP ERP</option> <option name="name">IntEngineComSAPNC3</option> <option name="value">IntEngineComSAPNC3</option> </options> <options> <option name="align">left</option> <option name="label">SAP Business One</option> <option name="name">IntEngineComSAPBN1</option> <option name="value">IntEngineComSAPBN1</option> </options> </options> </component> </td> <td></td> </tr> </table> </component> <component data-component="SBIS3.CONTROLS/Panel" name="Step1StoreHouse" style="width:auto;min-width:auto;height:250px;"> <option name="visible">false</option> <table style="width:100%"> <tr> <td style="width:12px"></td> <td> <div style="margin-left:4px;text-align:justify;" id="ТекстНаШаге1SAP"> '+o(n(rk("Данный мастер позволяет синхронизировать вашу учетную систему с личным кабинетом СБИС. После прохождения мастера всего за")))+' <span id="twoclicks">'+o(n(rk("пару кликов")))+"</span> "+o(n(rk("вы сможете:")))+' <ul style="margin-left:18px;padding: 2px;padding-bottom: 10px;"> <li>'+o(n(rk("загружать входящие документы в Store House")))+"</li> <li>"+o(n(rk("выгружать из Store House в СБИС: справочник номенклатуры")))+'</li> </ul> </div> </td> <td style="width:16px"></td> </tr> <tr> <td></td> <td> <component data-component="Deprecated/Controls/FieldText/FieldText" style="width:100%;height:auto;" name="ВыберитеУСStoreHouse"> <option name="value">Выберите версию вашего Store House и перейдите к следующему шагу</option> <option name="autoHeight">true</option> <option name="allowChangeEnable">false</option> <option name="readOnly">true</option> <option name="enabled">false</option> </component> </td> <td></td> </tr> <tr> <td></td> <td> <component data-component="Deprecated/Controls/FieldRadio/FieldRadio" name="ВыборСистемыStoreHouse" style="margin-left:15px;"> <option name="value">IntEngineComStoreHouse4</option> <option name="stateKey">ТипСистемы</option> <options name="data" type="array"> <options> <option name="align">left</option> <option name="label">Store House 4</option> <option name="name">IntEngineComStoreHouse4</option> <option name="value">IntEngineComStoreHouse4</option> </options> </options> </component> </td> <td></td> </tr> </table> </component> <component data-component="SBIS3.CONTROLS/Panel" name="Step2" style="width:auto;min-width:auto;height:250px;"> <option name="visible">false</option> <component data-component="SBIS3.CONTROLS/Panel" name="IntEngineCom1S82" style="width:auto;min-width:auto;height:250px;"> <option name="visible">false</option> <table style="width:100%"> <tr> <td style="width:12px"></td> <td> <component data-component="Deprecated/Controls/FieldText/FieldText" style="width:100%;height:auto;" name="Com1S82ТекстНаШаге2"> <option name="value">Выберите информационную базу:</option> <option name="autoHeight">true</option> <option name="allowChangeEnable">false</option> <option name="readOnly">true</option> <option name="enabled">false</option> </component> </td> <td style="width:16px"></td> </tr> <tr> <td></td> <td> <component data-component="Deprecated/Controls/FieldDropdown/FieldDropdown" name="СписокКонфигураций" style="width:498px;height:auto;padding-left: 5px;"> <option name="required">true</option> </component> </td> <td></td> </tr> <tr> <td></td> <td> <div style="width:100%;" id="ПутьКБазе"></div> </td> <td></td> </tr> <tr> <td></td> <td> <component data-component="Deprecated/Controls/FieldText/FieldText" style="width:100%;height:auto;" name="Com1S82ТекстНаШаге22"> <option name="value">При переходе на следующий шаг будут запрошены данные для авторизации и произведено подключение к настраиваемой системе. </option> <option name="autoHeight">true</option> <option name="allowChangeEnable">false</option> <option name="readOnly">true</option> <option name="enabled">false</option> </component> </td> <td></td> </tr> <tr> <td></td> <td> <component data-component="Deprecated/Controls/FieldText/FieldText" style="width:100%;height:auto;" name="Com1S82ТекстНаШаге23"> <option name="autoHeight">true</option> <option name="allowChangeEnable">false</option> <option name="readOnly">true</option> <option name="enabled">false</option> </component> </td> <td></td> </tr> </table> </component> <component data-component="SBIS3.CONTROLS/Panel" name="IntEngineWeb1S83" style="width:auto;min-width:auto;height:250px;"> <option name="visible">false</option> <table style="width:100%"> <tr> <td style="width:12px"></td> <td> <component data-component="Deprecated/Controls/FieldText/FieldText" style="width:100%;height:auto;" name="Web1S83ТекстНаШаге2"> <option name="value">Введите URL-адрес информационной базы:</option> <option name="autoHeight">true</option> <option name="allowChangeEnable">false</option> <option name="readOnly">true</option> <option name="enabled">false</option> </component> </td> <td style="width:16px"></td> </tr> <tr> <td></td> <td> <component data-component="Deprecated/Controls/FieldString/FieldString" name="Web1S83ПутьКБазе" style="margin-left: 5px;width:100%;"> <option name="tooltipInside">true</option> <option name="tooltip">Например: http://platform.demo.1c.ru/demo83</option> </component> </td> <td></td> </tr> <tr> <td></td> <td> <component data-component="Deprecated/Controls/FieldText/FieldText" style="width:100%;height:auto;" name="Web1S83ТекстНаШаге22"> <option name="value">При переходе на следующий шаг будут запрошены данные для авторизации и произведено подключение к настраиваемой системе. </option> <option name="autoHeight">true</option> <option name="allowChangeEnable">false</option> <option name="readOnly">true</option> <option name="enabled">false</option> </component> </td> <td></td> </tr> <tr> <td></td> <td> <component data-component="Deprecated/Controls/FieldText/FieldText" style="width:100%;height:auto;" name="Web1S83ТекстНаШаге23"> <option name="autoHeight">true</option> <option name="allowChangeEnable">false</option> <option name="readOnly">true</option> <option name="enabled">false</option> </component> </td> <td></td> </tr> </table> </component> <component data-component="SBIS3.CONTROLS/Panel" name="IntEngineComSAPNC3" style="width:auto;min-width:auto;height:250px;"> <option name="visible">false</option> <table style="width:100%"> <tr> <td style="width:12px"></td> <td> <component data-component="Deprecated/Controls/FieldText/FieldText" style="width:100%;height:auto;" name="ComSAPNC3ТекстНаШаге2"> <option name="value">Заполните параметры подключения к системе:</option> <option name="autoHeight">true</option> <option name="allowChangeEnable">false</option> <option name="readOnly">true</option> <option name="enabled">false</option> </component> </td> <td style="width:16px"></td> </tr> <tr> <td></td> <td> <component data-component="Deprecated/Controls/FieldText/FieldText" style="width:100%;height:auto;" name="ComSAPNC3ТекстНаШаге22"> <option name="value">Сервер приложений:</option> <option name="autoHeight">true</option> <option name="allowChangeEnable">false</option> <option name="readOnly">true</option> <option name="enabled">false</option> </component> </td> <td></td> </tr> <tr> <td></td> <td> <component data-component="Deprecated/Controls/FieldString/FieldString" name="ComSAPNC3ApplicationServer" style="margin-left: 5px;width:100%;"> <option name="tooltipInside">false</option> <option name="tooltip">IP адрес или FQDN сервера, где установлена система SAP</option> </component> </td> <td></td> </tr> <tr> <td></td> <td> <table style="width:100%;"> <tr> <td style="width:50%;"> <component data-component="Deprecated/Controls/FieldText/FieldText" style="width:100%;height:auto;" name="ComSAPNC3ТекстНаШаге27"> <option name="value">Номер инстанции:</option> <option name="autoHeight">true</option> <option name="allowChangeEnable">false</option> <option name="readOnly">true</option> <option name="enabled">false</option> </component> </td> <td style="width:50%;"> <component data-component="Deprecated/Controls/FieldText/FieldText" style="width:100%;height:auto;" name="ComSAPNC3ТекстНаШаге28"> <option name="value">Ид системы:</option> <option name="autoHeight">true</option> <option name="allowChangeEnable">false</option> <option name="readOnly">true</option> <option name="enabled">false</option> </component> </td> </tr> <tr> <td style="padding-left: 5px;"> <component data-component="Deprecated/Controls/FieldString/FieldString" name="ComSAPNC3systemNumber" style="width:100%;"> <option name="tooltip">Номер инстанции, фактически номер сервера приложений, который обрабатывает запрос </option> </component> </td> <td> <component data-component="Deprecated/Controls/FieldString/FieldString" name="ComSAPNC3systemId" style="margin-left: 5px;width:100%"> <option name="tooltip">Ид системы в SAP</option> </component> </td> </tr> </table> </td> <td></td> </tr> <tr> <td></td> <td> <table style="width:100%;"> <tr> <td style="width:50%;"> <component data-component="Deprecated/Controls/FieldText/FieldText" style="width:50%;height:auto;" name="ComSAPNC3ТекстНаШаге23"> <option name="value">Мандант:</option> <option name="autoHeight">true</option> <option name="allowChangeEnable">false</option> <option name="readOnly">true</option> <option name="enabled">false</option> </component> </td> <td style="width:50%;"> <component data-component="Deprecated/Controls/FieldText/FieldText" style="width:50%;height:auto;" name="ComSAPNC3ТекстНаШаге24"> <option name="value">Язык:</option> <option name="autoHeight">true</option> <option name="allowChangeEnable">false</option> <option name="readOnly">true</option> <option name="enabled">false</option> </component> </td> </tr> <tr> <td style="padding-left: 5px;"> <component data-component="Deprecated/Controls/FieldString/FieldString" name="ComSAPNC3Client" style="width:100%"> <option name="tooltip">Мандант, в котором работает пользователь(например, 800 - работа, 200, 140 - разработка)</option> </component> </td> <td> <component data-component="Deprecated/Controls/FieldString/FieldString" name="ComSAPNC3Language" style="margin-left: 5px;width:100%"> <option name="tooltip">Язык локали, к которой происходит подключение</option> </component> </td> </tr> </table> </td> <td></td> </tr> <tr> <td></td> <td> <component data-component="Deprecated/Controls/FieldText/FieldText" style="width:100%;height:auto;" name="ComSAPNC3ТекстНаШаге25"> <option name="value">При переходе на следующий шаг будут запрошены данные для авторизации и произведено подключение к настраиваемой системе. </option> <option name="autoHeight">true</option> <option name="allowChangeEnable">false</option> <option name="readOnly">true</option> <option name="enabled">false</option> </component> </td> <td></td> </tr> <tr> <td></td> <td> <component data-component="Deprecated/Controls/FieldText/FieldText" style="width:100%;height:auto;" name="ComSAPNC3ТекстНаШаге26"> <option name="autoHeight">true</option> <option name="allowChangeEnable">false</option> <option name="readOnly">true</option> <option name="enabled">false</option> </component> </td> <td></td> </tr> </table> </component> <component data-component="SBIS3.CONTROLS/Panel" name="IntEngineComStoreHouse4" style="width:auto;min-width:auto;height:250px;"> <option name="visible">false</option> <table style="width:100%"> <tr> <td style="width:12px"></td> <td> <component data-component="Deprecated/Controls/FieldText/FieldText" style="width:100%;height:auto;" name="StoreHouse4ТекстНаШаге2"> <option name="value">Введите адрес сервера информационной базы:</option> <option name="autoHeight">true</option> <option name="allowChangeEnable">false</option> <option name="readOnly">true</option> <option name="enabled">false</option> </component> </td> <td style="width:16px"></td> </tr> <tr> <td></td> <td> <component data-component="Deprecated/Controls/FieldString/FieldString" name="StoreHouse4ПутьКБазе" style="margin-left: 5px;width:100%;"> <option name="tooltipInside">true</option> <option name="tooltip">Например: 192.168.0.82:pTa9001t2000</option> </component> </td> <td></td> </tr> <tr> <td></td> <td> <component data-component="Deprecated/Controls/FieldText/FieldText" style="width:100%;height:auto;" name="StoreHouse4ТекстНаШаге22"> <option name="value">При переходе на следующий шаг будут запрошены данные для авторизации и произведено подключение к настраиваемой системе. </option> <option name="autoHeight">true</option> <option name="allowChangeEnable">false</option> <option name="readOnly">true</option> <option name="enabled">false</option> </component> </td> <td></td> </tr> <tr> <td></td> <td> <component data-component="Deprecated/Controls/FieldText/FieldText" style="width:100%;height:auto;" name="StoreHouse4ТекстНаШаге23"> <option name="autoHeight">true</option> <option name="allowChangeEnable">false</option> <option name="readOnly">true</option> <option name="enabled">false</option> </component> </td> <td></td> </tr> </table> </component> </component> <component data-component="SBIS3.CONTROLS/Panel" name="Step3" style="width:auto;min-width:auto;min-height:250px;height:auto;"> <option name="visible">false</option> <table style="width:100%"> <tr> <td style="width:12px"></td> <td> <component data-component="Deprecated/Controls/FieldText/FieldText" style="width:100%;height:auto;" name="ТекстНаШаге3"> <option name="value">Соединение с учетной системой прошло успешно.</option> <option name="autoHeight">true</option> <option name="allowChangeEnable">false</option> <option name="readOnly">true</option> <option name="enabled">false</option> </component> </td> <td style="width:16px"></td> </tr> <tr> <td></td> <td> <component data-component="Deprecated/Controls/FieldText/FieldText" style="width:100%;height:auto;" name="ТекстНаШаге33"> <option name="value">Название подключения:</option> <option name="autoHeight">true</option> <option name="allowChangeEnable">false</option> <option name="readOnly">true</option> <option name="enabled">false</option> </component> </td> <td></td> </tr> <tr> <td></td> <td> <component data-component="Deprecated/Controls/FieldText/FieldText" name="НазваниеПодключения" style="width:498px;margin-left: 5px;"> <option name="autoHeight">true</option> <option name="maxLength" value="255"></option> <option name="trim">true</option> </component> </td> <td></td> </tr> <tr> <td></td> <td> <component data-component="Deprecated/Controls/FieldText/FieldText" style="width:100%;height:auto;" name="ТекстНаШаге32"> <option name="value">На вашем компьютере для вас в реестрах СБИС добавлена возможность загружать и выгружать документы. </option> <option name="autoHeight">true</option> <option name="allowChangeEnable">false</option> <option name="readOnly">true</option> <option name="enabled">false</option> </component> </td> <td></td> </tr> <tr> <td></td> <td style="padding-left: 4px;"> </td> <td></td> </tr> <tr> <td></td> <td> </td> <td></td> </tr> </table> </component> </div> <div> <component data-component="SBIS3.CONTROLS/Panel" name="Button" style="height:32px;position:static;"> <component data-component="Deprecated/Controls/Button/Button" style="width:100px;float:right;margin-right:8px;" name="ButtonCancel"> <option name="caption">Отмена</option> </component> <component data-component="Deprecated/Controls/Button/Button" style="width:100px;float:right;margin-right:8px;" name="ButtonReady"> <option name="caption">Готово</option> <option name="defaultButton">true</option> <option name="visible">false</option> </component> <component data-component="Deprecated/Controls/Button/Button" style="width:100px;float:right;margin-right:8px;" name="ButtonNext"> <option name="caption">Далее</option> <option name="defaultButton">true</option> </component> <component data-component="Deprecated/Controls/Button/Button" style="width:100px;float:right;margin-right:8px;" name="ButtonPrevious"> <option name="caption">Назад</option> <option name="visible">false</option> </component> </component> </div> </div>');return(a=o(a))+(i&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return t.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.IntConnectionWizard"}},t});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.IntConnectionWizard", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".error{text-align:center;color:#ef463a}.listRegisters tr.ws-browser-table-row.ws-visible{height:16px}.listRegisters .ws-browser-cell-container{min-height:0;line-height:16px}a:hover{color:#ff7033}"));head.appendChild(style);});}
define('js!SBIS3.EDO.IntConnectionWizard',['Deprecated/helpers/fast-control-helpers','Deprecated/helpers/collection-helpers','Core/moduleStubs','Core/Indicator','Core/Context','SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.IntConnectionWizard','css!SBIS3.EDO.IntConnectionWizard','Deprecated/Controls/FieldString/FieldString','SBIS3.CONTROLS/Panel','Deprecated/Controls/FieldText/FieldText','Deprecated/Controls/FieldRadio/FieldRadio','Deprecated/Controls/Button/Button','Deprecated/Controls/FieldDropdown/FieldDropdown','Dokumentooborot_localization'],function(e,t,n,i,o,s,l){var r=s.extend({_dotTplFn:l,$protected:{_options:{}},$constructor:function(){},init:function(){r.superclass.init.call(this),selfThis=this,this.getChildControlByName('ButtonNext').subscribe('onClick',r.onNext),this.getChildControlByName('ButtonReady').subscribe('onClick',r.onComplete),this.getChildControlByName('ButtonCancel').subscribe('onClick',r.onCancel),this.getChildControlByName('ButtonPrevious').subscribe('onClick',r.onPrevious),selfThis['Step']=1,selfThis['typeSystem']='',r.updateForm(selfThis.Step);var e=SBIS3.EDO['IntEngine'].nameConfig,t=SBIS3.EDO.IntEngine.UserConfig()[e];if(t)if(selfThis['typeSystem']=t.version,'IntEngineComSAPNC3'===t.version)selfThis.getChildControlByName('ВыборСистемыSAP').setValue(t.version),selfThis.getChildControlByName('Step1').hide(),selfThis.getChildControlByName('Step1SAP').show(),selfThis.getChildControlByName('Step1StoreHouse').hide();else if('IntEngineComStoreHouse4'===t.version)selfThis.getChildControlByName('Step1').hide(),selfThis.getChildControlByName('Step1SAP').hide(),selfThis.getChildControlByName('Step1StoreHouse').show();else selfThis.getChildControlByName('ВыборСистемы').setValue(t.version),selfThis.getChildControlByName('Step1').show(),selfThis.getChildControlByName('Step1SAP').hide(),selfThis.getChildControlByName('Step1StoreHouse').hide();},drawCheckBox:function(e,t){return'<input type="checkbox" class="checkBoxSbis" reestr="'+e.get('Реестр1С_Тип')+'" sbis_reestr="'+e.get('РеестрСБИС_Тип')+'" checked >';}});return r.onPrevious=function(){if(3===selfThis.Step){var e=selfThis.getChildControlByName('НазваниеПодключения');if(0!==e.getValidators().length)e.getValidators().splice(0,1);}selfThis.Step=selfThis.Step-1,selfThis.getChildControlByName('ButtonNext').setEnabled(true),r.updateForm(selfThis.Step);},r.onNext=function(){var e=SBIS3.EDO['IntEngine'].nameConfig,t=SBIS3.EDO.IntEngine.getUserConfig(e);if(1===selfThis.Step){selfThis.Step=selfThis.Step+1;var n='';if(-1!=selfThis.typeSystem.indexOf('1S'))n=selfThis.getChildControlByName('ВыборСистемы').getValueAsString();else if(-1!=selfThis.typeSystem.indexOf('SAP'))n=selfThis.getChildControlByName('ВыборСистемыSAP').getValueAsString();else if(-1!=selfThis.typeSystem.indexOf('StoreHouse'))n=selfThis.getChildControlByName('ВыборСистемыStoreHouse').getValueAsString();if(t)if(t.version!==n)delete t.connection,delete t.connected;if(t.version=n,t.connection)delete t.connection;if(!SBIS3.EDO[n])i.setMessage('Загрузка модуля системы');SBIS3.EDO.IntEngine.initializeModule(n).addCallback(function(e){if(!e)return i.hide(),void(selfThis.Step=selfThis.Step-1);t.nameSystem=e.nameSystem,t.iconSystem=e.iconSystem,e.System.afterSelectSystem(n).addCallbacks(function(e){if(r.updateForm(selfThis.Step),!e)selfThis.getChildControlByName('ButtonNext').setEnabled(false);i.hide();},function(e){selfThis.getChildControlByName('ButtonNext').setEnabled(false),i.hide();});});}else if(2===selfThis.Step)if(e)SBIS3.EDO.IntEngine.initializeModule(t.version).addCallback(function(n){var o=true;if(n.System.prepareConnectionSettings&&!n.System.prepareConnectionSettings(e))o=false;if(o){var s=function(e){SBIS3.EDO.IntEngine.createConnection(e,true,'Мастер подключения').addCallback(function(e){if(e)selfThis.Step=selfThis.Step+1,selfThis.getChildControlByName('НазваниеПодключения').setValue(t.title);r.updateForm(selfThis.Step),i.hide();});};if(t.connected)s(e);else{if(t.connection)delete t.connection;s(e);}}});},r.onComplete=function(){var e=this.getTopParent(),t=e.getChildControlByName('НазваниеПодключения');if(SBIS3.EDO.IntEngine.getUserConfig(SBIS3.EDO['IntEngine'].nameConfig).title=t.getValue(),0===t.getValidators().length)t.setValidators([{validator:function(){return!this._curval?false:true;},errorMessage:'Введите название подключения',noFailOnError:false}]);if(t.validate())i.setMessage('Сохранение'),SBIS3.EDO.IntEngine.saveConnectionSetting(SBIS3.EDO.IntEngine['nameConfig']).addCallback(function(t){if(t)n.requireModule('SBIS3.EDO.IntSettingsProfile').addCallback(function(){SBIS3.EDO.IntSettingsProfile.prototype.onAfterShowSettings();var t=o.global.getValue('paramMenu'),n=SBIS3.EDO['IntEngine'].nameConfig;if(t)SBIS3.EDO.IntEngine.createMenu();if(SBIS3.EDO.IntEngine.updateMenu(),SBIS3.EDO.IntEngine.addIntegrationUse(n,'Мастер подключения','',1),i.hide(),e.close(),selfThis._options.params['nameButton']&&selfThis._options.params['type_doc'])r.showDefaultRegistry(selfThis._options.params['nameButton'],selfThis._options.params['type_doc'],selfThis._options.params['record'],n,selfThis._options.params['updateFormDocument']);SBIS3.EDO['IntEngine'].nameConfig='';});else i.hide(),e.close();});},r.showDefaultRegistry=function(e,n,i,o,s){var l=SBIS3.EDO.IntEngine.getUserConfig(o).reestrs[e],r=false,a;if(1===t.countOfProperties(l))r=true;for(var f in l)if(l.hasOwnProperty(f))if(true===l[f].default||'1'===l[f].default||r){a=l[f];break;}if(a){var h=new Date(),S='Месяц',d=new Date();if(e.indexOf('Отчет')>-1)d.setFullYear(d.getFullYear()-1),S='Год';else d.setMonth(d.getMonth()-1);var C={nameConfig:o,reestr:a.xmlname,caption:f,record:i,filter:{'ДатаНачала':d,'ДатаКонца':h,'Период':S},nameButton:e,type_doc:n,updateFormDocument:s};if('Номенклатура'===n||'Сотрудники'===n)SBIS3.EDO.IntEngine.showListItems(C);else SBIS3.EDO.IntEngine.showListDocuments(C);}},r.onCancel=function(){e.question('Прервать настройку соединения?').addCallback(function(e){if(e){var t=SBIS3.EDO['IntEngine'].nameConfig,n=function(e){var t=SBIS3.EDO.IntEngine.UserConfig();if(t[e])delete t[e];};if(SBIS3.EDO.IntEngine.getUserConfig(t).connected)SBIS3.EDO.IntEngine.destroyConnection(t).addCallback(function(){n(t),selfThis.getTopParent().cancel();});else{n(t);var i=selfThis.getTopParent();if(i)i.cancel();}}});},r.updateForm=function(e){selfThis.getTopParent().setTitle('Мастер настройки соединения. Шаг '+e+' из 3');for(var t=1;t<=3;t++){var n=selfThis.getChildControlByName('Step'+t);if(-1!=selfThis.typeSystem.indexOf('SAP')&&1===t)n=selfThis.getChildControlByName('Step'+t+'SAP');else if(-1!=selfThis.typeSystem.indexOf('StoreHouse')&&1===t)n=selfThis.getChildControlByName('Step'+t+'StoreHouse');if(t===e){if(2===e){for(var i=n.getImmediateChildControls(),o=0;o<i.length;o++)i[o].hide();var s=selfThis.getChildControlByName('ВыборСистемы').getValueAsString();if(-1!=selfThis.typeSystem.indexOf('SAP'))s=selfThis.getChildControlByName('ВыборСистемыSAP').getValueAsString();else if(-1!=selfThis.typeSystem.indexOf('StoreHouse'))s=selfThis.getChildControlByName('ВыборСистемыStoreHouse').getValueAsString();var l=selfThis.getChildControlByName(SBIS3.EDO[s].nameTemplate);if(l)l.show();}n.show();}else n.hide();}if(1===e)selfThis.getChildControlByName('ButtonPrevious').hide();else selfThis.getChildControlByName('ButtonPrevious').show();if(3===e){selfThis.getChildControlByName('ButtonNext').hide(),selfThis.getChildControlByName('ButtonReady').setDefaultButton(true),selfThis.getChildControlByName('ButtonReady').show();var r=[],a=SBIS3.EDO['IntEngine'].nameConfig;currentSettings=SBIS3.EDO.IntEngine.getUserConfig(a);var f=SBIS3.EDO[currentSettings.version].Settings[currentSettings.type],h=false;}else selfThis.getChildControlByName('ButtonNext').setDefaultButton(true),selfThis.getChildControlByName('ButtonNext').show(),selfThis.getChildControlByName('ButtonReady').hide();},r;});
define('js!SBIS3.EDO.IntEngineCom1S82',['Dokumentooborot_localization'],function(){'use strict';return{};});
define('js!SBIS3.EDO.IntEngineCom1S77',['Core/core-functions','js!SBIS3.EDO.IntEngineCom1S82','Dokumentooborot_localization'],function(n,e){'use strict';var o;return o=n.clone(e),o.versions_1c=[77],o.nameSystem='1C 7.7',o.nameModule='Com1C77',o;});
define('js!SBIS3.EDO.IntEngineCom1S83',['Core/core-functions','js!SBIS3.EDO.IntEngineCom1S82','Dokumentooborot_localization'],function(n,e){'use strict';var o={};return o=n.clone(e),o.nameSystem='1C 8.3',o.nameModule='Com1C83',o;});
define('js!SBIS3.EDO.IntEngineComSAPNC3',['Dokumentooborot_localization'],function(){'use strict';return{};});
define('js!SBIS3.EDO.IntEngineComSAPBN1',['Core/core-functions','js!SBIS3.EDO.IntEngineComSAPNC3','Dokumentooborot_localization'],function(n,e){'use strict';var o;return o=n.clone(e),o;});
define('js!SBIS3.EDO.IntEngineComStoreHouse4',['js!SBIS3.EDO.IntEngine','Dokumentooborot_localization'],function(e){'use strict';var t,n;return t={System:{prepareConnectionSettings:function(t,n){var r=n.getChildControlByName('url'),i=e.getUserConfig(t);if(r.validate())return i['url']=r.getText().trim(),true;else return false;}}};});
define('js!SBIS3.EDO.IntEngineWeb1S83',['js!SBIS3.EDO.IntEngine','js!SBIS3.Plugin/Source/Helper/Helper','Core/moduleStubs','Deprecated/base64','Core/Deferred','Dokumentooborot_localization'],function(n,e,t,r,a){'use strict';var i,o,s;return i={System:{authentication:function(e,r){var i=n.getUserConfig(e),o='';if(!i.paramsConnection['authentication'])i.paramsConnection['authentication']={};else o='Неверно указано имя пользователя или пароль';var s=i.paramsConnection['authentication'],u={login:s.login,password:s.password,savePassword:s.savePassword,title:'Аутентификация на: '+r,message:o};return t.requireModule('SBIS3.EDO.ExtAuthorizationDialog').addCallbacks(function(){return SBIS3.EDO.ExtAuthorizationDialog.showAuthorizationDialog(u).addCallbacks(function(t){if(t)if(t.savePassword||i.paramsConnection.authentication&&t.login!=i.paramsConnection.authentication.login)return n.readConnection(e).addCallbacks(function(r){if(r){if(!r.paramsConnection.authentication)r.paramsConnection['authentication']={};var o=r.paramsConnection.authentication;if(o.savePassword!==t.savePassword||o.password!==t.password||o.login!==t.login){if(o.savePassword=t.savePassword,!t.savePassword)o.password='';else o.password=t.password;return o.login=t.login,r.connected=i.connected,r.connection=i.connection,n.userConfig()[e]=r,n.writeConnection(e).addCallbacks(function(){return t;},function(n){return new a().errback(n);});}else return t;}else return t;},function(n){return new a().errback(n);});else return t;else return false;},function(n){return new a().errback(n);});},function(n){return new a().errback(n);});},prepareConnectionSettings:function(e,t){var r=n.getUserConfig(e),a=t.getChildControlByName('url'),i=a.getText();if(a.validate()&&i){if(i=(i=i.trim()).replace(new RegExp(/\\/g),'/'),-1!==i.indexOf('ws='))i=i.substring(4,i.length-3);var o=i.indexOf('ru_RU');if(o>-1)i=i.substring(0,o);if(o=i.indexOf('/ru/'),o>-1)i=i.substring(0,o);if(i.length>2&&'/ru'===i.substr(i.length-3,3))i=i.substr(0,i.length-2);if('/'!==i.substr(i.length-1,1))i+='/';if(i.length>4&&'http'!=i.substr(0,4))i='http://'+i;if(r['url']&&r['url']!=i)r['connected']=false,delete r['connection'];return r['url']=i,a.setText(i),true;}else return false;},getPlugin:function(e,t){var o=n.getUserConfig(e),s=o.paramsConnection.authentication;if(t=t?t:{},t['id']=e,t['url']=o.url,!t.authentication&&s&&s.savePassword)t['authentication']='Basic '+r.encode(s['login']+':'+s['password'],'UTF-8');return n.getPlugin(e,t).addCallbacks(function(n){return n;},function(n){if(n.message.indexOf('401')>-1)return i.System.authentication(e,o['url']).addCallbacks(function(n){if(n){if(o.paramsConnection.authentication.login=n['login'],o.paramsConnection.authentication.savePassword=n['savePassword'],n['savePassword'])o.paramsConnection.authentication.password=n['password'];var a='Basic '+r.encode(n['login']+':'+n['password'],'UTF-8');return t.authentication=a,i.System.getPlugin(e,t);}else return false;},function(n){return new a().errback(n);});return new a().errback(n);});},getListUser:function(t){var r=n.getUserConfig(t),o=location.hostname,s=e.getAccountId();return n.showIndicator('Получение списка пользователей...').addCallback(function(){var e={type:r.paramsConnection['nameModule'],url:r.url,host:'https://'+o,AccountID:s,id:t};return i.System.getPlugin(t,e).addCallbacks(function(e){if(e)return e.call('getUserList',{}).addCallbacks(function(e){n.hideIndicator();for(var t=[],r=0,a=e.length;r<a;r++)t.push({key:r,title:e[r]});return t;},function(e){return n.hideIndicator(),new a().errback(e);});else return n.hideIndicator(),false;},function(e){return n.hideIndicator(),new a().errback(e);});});}}};});
define("html!SBIS3.EDO.IntListItems",function(){var o=function(o){var n=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;o.test(n);)n=n.replace(o,"&#123;&#123;$1&#125;&#125;");return n}}(),t="undefined"!=typeof process,e=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div> <div> <component data-component="SBIS3.CONTROLS/OperationsPanel/PanelButton/OperationsPanelButton" name="PanelsButton" style="margin-left:8px;"></component> <component data-component="SBIS3.CONTROLS/OperationsPanel" name="OperationsPanel"> <options name="items" type="array"> <options> <option name="name">operationsMark</option> <option name="componentType">SBIS3.CONTROLS/OperationsPanel/Mark</option> <options name="type"> <option name="mark">true</option> </options> </options> <options> <option name="componentType">SBIS3.CONTROLS/Link</option> <options name="type"> <option name="selection">true</option> </options> <options name="options"> <option name="caption">Загрузить</option> <option name="name">load</option> <options name="handlers"> <option name="onActivated" type="function">js!SBIS3.EDO.IntListItems:prototype.load</option> </options> </options> </options> </options> </component> </div> <component data-component="SBIS3.CONTROLS/Button/BackButton" name="MyBackButton" class="MyBackButton" style="margin-left:16px;"></component> <component data-component="SBIS3.CONTROLS/BreadCrumbs" name="MyBreadCrumbs" class="MyBreadCrumbs" style="margin-left:5px;margin-top:8px; top:-5px; height: 22px;"></component> <component data-component="SBIS3.CONTROLS/Tree/DataGridView" name="ListItems" class="controls-ListView__showCheckBoxes" style="height:auto;min-height:400px;"> <option name="displayField">Name</option> <option name="hierField">parent</option> <option name="emptyHTML">Справочник пустой</option> <options name="columns" type="array"> <options> <option name="title">Код</option> <option name="textAlign">right</option> <option name="width" type="string">150</option> <option name="field">Code</option> </options> <options> <option name="title">Наименование</option> <option name="width" type="string">600</option> <option name="field">Name</option> </options> </options> <options name="itemsActions" type="array"></options> <option name="itemsDragNDrop" value=""></option> <option name="keyField">id</option> <option name="infiniteScroll">down</option> <option name="multiselect">true</option> <option name="allowEmptySelection">false</option> </component> </div>');return(e=n(e))+(t&&-1!==e.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.IntListItems"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.IntListItems", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".MyBreadCrumbs a{max-width:100000px!important}.controls-ListView.controls-ListView__hideCheckBoxes.controls-ListView__multiselect .controls-ListView__itemCheckBox{display:inline-block!important}.controls-DataGridView.controls-ListView__hideCheckBoxes.controls-ListView__multiselect .controls-DataGridView__colgroup col:first-child{width:24px!important}.controls-DataGridView.controls-ListView__hideCheckBoxes.controls-ListView__multiselect .controls-DataGridView__td__checkBox{width:24px!important}.controls-ListView__hideCheckBoxes-leaf .controls-ListView__item-type-leaf .controls-ListView__itemCheckBox{display:inline-block!important}.controls-ListView__hideCheckBoxes-node .controls-ListView__item-type-node .controls-ListView__itemCheckBox{display:inline-block!important}"));head.appendChild(style);});}
define('js!SBIS3.EDO.IntListItems',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.IntListItems','WS.Data/Source/Memory','SBIS3.CONTROLS/ComponentBinder','js!SBIS3.EDO.IntEngine','SBIS3.CONTROLS/Tree/DataGridView','SBIS3.CONTROLS/BreadCrumbs','SBIS3.CONTROLS/Button/BackButton','SBIS3.CONTROLS/OperationsPanel/PanelButton/OperationsPanelButton','SBIS3.CONTROLS/OperationsPanel','SBIS3.CONTROLS/CheckBox','css!SBIS3.EDO.IntListItems','Dokumentooborot_localization'],function(t,e,n,a,s){var i=t.extend({_dotTplFn:e,$protected:{_options:{}},$constructor:function(){},init:function(){i.superclass.init.call(this),selfThis=this,params=this._options.params;},setListItems:function(t){var e=selfThis.getChildControlByName('ListItems');if(!e||!t)return;var s=new n({data:t,idProperty:'id'}),i=selfThis.getChildControlByName('MyBreadCrumbs'),o=selfThis.getChildControlByName('MyBackButton'),r=selfThis.getChildControlByName('PanelsButton'),l=selfThis.getChildControlByName('OperationsPanel'),u=new a({view:e,operationPanel:l,breadCrumbs:i,backButton:o});u.bindOperationPanel(true),u.bindBreadCrumbs(),r.setLinkedPanel(l),e.setDataSource(s),l._eventBusChannel._events.ontoggle=l._eventBusChannel._events.ontoggle.slice(1),l.subscribe('ontoggle',function(){e._container.toggleClass('controls-ListView__showCheckBoxes',l.isVisible());});},load:function(){for(var t=selfThis.getChildControlByName('ListItems'),e=t.getSelectedItems().toArray(),n=t.getDataSource(),a=t.getItems(),i=[],o={},r=function(t){if(!o[t.id])i.push(t),o[t.id]=true;if(true===t['parent@'])for(var e=a.getIndicesByValue('parent',t['id']),n=0;n<e.length;n++){var s=a.at(e[n]).getRawData();r(s);}},l=function(t){if(t['parent']){var e=n._getRecordByKey(t.parent);if(e)if(!o[e.id])i.unshift(e),o[e.id]=true,l(e);}},u=0;u<e.length;u++)r(e[u].getRawData()),l(e[u].getRawData());s.loadItems(params,i);}});return i;});
define("html!SBIS3.EDO.IntResultUnload",function(){var o=function(o){var t=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;o.test(t);)t=t.replace(o,"&#123;&#123;$1&#125;&#125;");return t}}(),n="undefined"!=typeof process,e=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div> <div> <div class=\'unloadResultArea\'></div> <div id=\'loadErrorResultTemplate\'></div> </div> <component data-component="Deprecated/Controls/TableView/TableView" name="СписокДокументов" style="height:auto;min-height:400px;"> <option name="name" value="СписокДокументов"></option> <options name="display"> <option name="width" value="100%"></option> <option name="height" value="100%"></option> <option name="rowRender" type="function">js!SBIS3.EDO.IntResultUnload:prototype.rowRender</option> <options name="columns" type="array"> <options> <option name="title" value=""></option> <option name="field" value="Дата"></option> <option name="width" value="50px" type="string"></option> </options> <options> <option name="title" value="Документ СБИС"></option> <option name="field" value="ДокументСБИС"></option> <option name="filterName" value="ДокументСБИС"></option> </options> <options> <option name="title" value="Документ"></option> <option name="field" value="Документ"></option> <option name="filterName" value="Документ"></option> </options> </options> <option name="readOnly">true</option> <option name="showRecordsCount">true</option> <option name="showPaging">true</option> <option name="recordsPerPage">10</option> <option name="usePageSizeSelect">true</option> </options> <options name="dataSource"> <options name="readerParams"> <option name="adapterType" value="TransportAdapterStatic"></option> <options name="adapterParams"> <option name="data" value=\'{&quot;s&quot;:[{&quot;n&quot;:&quot;Номер&quot;,&quot;t&quot;:&quot;Строка&quot;},{&quot;n&quot;:&quot;Дата&quot;,&quot;t&quot;:&quot;Строка&quot;},{&quot;n&quot;:&quot;ДокументСБИС&quot;,&quot;t&quot;:&quot;Строка&quot;},{&quot;n&quot;:&quot;Документ1С&quot;,&quot;t&quot;:&quot;Строка&quot;}],&quot;d&quot;:[]}\'></option> </options> </options> </options> <option name="allowAdd">false</option> <option name="allowDelete">false</option> <option name="allowEdit">false</option> <option name="className">.ws-browser-small-paddings</option> </component> </div>');return(e=t(e))+(n&&-1!==e.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.IntResultUnload"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.IntResultUnload", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".doc1s{color:#999;margin-left:20px;vertical-align:top;font-size:12px}.docSbis{color:#999;padding-left:16px;vertical-align:top;font-size:12px;cursor:pointer;white-space:nowrap;overflow:hidden}.docSbis:hover{text-decoration:underline}.doc1slink{text-decoration:underline;cursor:pointer}.unloadeddocument{color:#999;padding-bottom:4px;margin-left:20px;vertical-align:top}.doc{text-decoration:underline;color:#05b;cursor:pointer;padding-bottom:4px;vertical-align:top}.link{text-decoration:underline;color:#05b;cursor:pointer;padding-bottom:4px}.error_comment{color:#ef463a}.notSupported{color:#313e78}.face1_name{font-family:TensorFont,sans-serif;font-size:15px;font-weight:700;color:#313e78}"));head.appendChild(style);});}
define('js!SBIS3.EDO.IntResultUnload',['Core/core-functions','Core/core-attach','Core/WindowManager','Core/moduleStubs','SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.IntResultUnload','css!SBIS3.EDO.IntResultUnload','Deprecated/Controls/FieldString/FieldString','Deprecated/Controls/TableView/TableView','Deprecated/Controls/FieldLink/FieldLink','Deprecated/Controls/Button/Button','SBIS3.CONTROLS/Link','Deprecated/Controls/LinkButton/LinkButton','Deprecated/Controls/CustomView/CustomView','Dokumentooborot_localization'],function(e,t,n,s,o,l){var r=o.extend({_dotTplFn:l,$protected:{_options:{}},$constructor:function(){},init:function(){r.superclass.init.call(this);var t=0,n=0;for(notSupported=0,errors=0,Docs=this._options._result,i=0,len=Docs.length;i<len;i++)for(ii=0,len2=Docs[i].Attachments.length;ii<len2;ii++){if(n+=1,Docs[i].Attachments[ii].extID)t+=1;if(Docs[i].Attachments[ii].Error&&''!==Docs[i].Attachments[ii].Error)if(-1!==Docs[i].Attachments[ii].Error.indexOf('поддерживается'))notSupported+=1;else errors+=1;}var o=function(e){var i=$('.unloadResultArea'),s=[];s.push('<div class="ws-separator ws-separator-marker ws-separator-line"><div>Отчет о выгрузке</div></div>'),s.push('<span class="unloadeddocument">Выгружено: <span class="link"'+('itsallright'===e?'style="font-weight: bold;"':'')+' id="itsallright">'+t+'</span> / <span class="link"'+(''===e?'style="font-weight: bold;"':'')+'id="all">'+n+'</span> документов, в том числе ошибок: <span class="link error_comment" '+('errors'===e?'style="font-weight: bold;"':'')+'id="errors">'+errors+'</span>, не поддерживается: <span class="link notSupported"'+('notSupported'===e?'style="font-weight: bold;"':'')+' id="notSupported">'+notSupported+'</span></span>');var r=s.join('');i[0].textContent='',i.append(r),document.getElementById('itsallright').onclick=function(){o('itsallright'),l('itsallright');},document.getElementById('all').onclick=function(){o(''),l('');},document.getElementById('errors').onclick=function(){o('errors'),l('errors');},document.getElementById('notSupported').onclick=function(){o('notSupported'),l('notSupported');};},l=function(t,i){if(!i)i='СписокДокументов';var n=self.getChildControlByName(i).getRecordSet();n.clear();var o=0;for(ПредДата='',il=0,leni=Docs.length;il<leni;il++){var l=[],r=e.clone(Docs[il]);for(ii=0,len2=Docs[il].Attachments.length;ii<len2;ii++){if('itsallright'===t&&''!==Docs[il].Attachments[ii].Error)continue;if('errors'===t&&''===Docs[il].Attachments[ii].Error)continue;if('errors'===t&&''!==Docs[il].Attachments[ii].Error&&-1!==Docs[il].Attachments[ii].Error.indexOf('поддерживается'))continue;if('notSupported'===t){if(''!==Docs[il].Attachments[ii].Error&&-1===Docs[il].Attachments[ii].Error.indexOf('поддерживается'))continue;if(''===Docs[il].Attachments[ii].Error)continue;}l.push(Docs[il].Attachments[ii]);}if(0!==l.length)n.createRecord().addCallback(function(e){if(o+=1,r.Attachments=l,ПредДата!==r.Date)e.set('Дата',r.Date);e.set('Номер',o),e.set('ДокументСБИС',r),n.appendRecord(e),ПредДата=r.Date;});}self.getChildControlByName(i).refresh();var a=document.getElementsByClassName('docSbis');for(idoc=0,lendoc=a.length;idoc<lendoc;idoc++)a[idoc].onclick=function(e){if(ИдентификаторДокумента=this.id,ИдентификаторДокумента)SBIS3.EDO.IntEngine.showIndicator('Пожалуйста, подождите...').addCallback(function(){s.requireModule('SBIS3.EDO2.OpenDialogAction').addCallbacks(function(e){new e[0]().execute({id:ИдентификаторДокумента}),SBIS3.EDO.IntEngine.hideIndicator();},function(e){SBIS3.EDO.IntEngine.hideIndicator();});});};};self=this,o(''),this.getChildControlByName('СписокДокументов').subscribe('onReady',function(e){l('','СписокДокументов');});},rowRender:function(e,t){var i='#E1FFFF',n=e.get('ДокументСБИС'),s='<td coldefindex="0" class="ws-browser-cell  ws-browser-right  ws-browser-valign-top"><div class="ws-browser-cell-paddings"><div class="ws-browser-render" style="font-size: 13px;vertical-align: middle;min-height: 20px;padding: 4px;overflow: hidden;"><div><div class="">';if(null!==e.get('Дата'))s=s+n.Date.substr(0,5)+'<br>';s=s+'<div style="color: #999999;font-size:11px;margin-top:1px;">'+n.Time+'</div></div><div></div></div></div></div></td>';var o=''===n.Partner?'Контрагент не указан':n.Partner;s=s+'<td coldefindex="1" class="ws-browser-cell ws-browser-valign-top"><div class="ws-browser-cell-paddings"><div class="ws-browser-render" style="font-size: 13px;vertical-align: middle;min-height: 20px;padding: 4px;overflow: hidden;"><div class="maincol"><div class="line" title="'+o+'"><span class="face1_name">'+o+'</span></div>';for(var l=0,r=n.Attachments.length;l<r;l++)s=s+'<div class="line comment small_size padding_line item_isfiles" title="'+n.Attachments[l].Name+'"><span class="vd_item docSbis" id="'+n.ID+'">'+n.Attachments[l].Name+'</span></div>';s+='</div></div></div></td>',s+='<td coldefindex="2" class="ws-browser-cell ws-browser-valign-top"><div class="ws-browser-cell-paddings"><div class="ws-browser-render" style="font-size: 13px;vertical-align: middle;min-height: 20px;padding: 4px;overflow: hidden;"><div class="maincol"><div class="line" title=""><span class="face1_name">&nbsp</span></div>';for(var l=0,r=n.Attachments.length;l<r;l++)if(n.Attachments[l].extID)s=s+'<div class="line comment small_size padding_line item_isfiles" title="'+n.Attachments[l].extName+'"><span class="doc1s">'+n.Attachments[l].extName+'</span></div>';else{var a=n.Attachments[l].Error;if('object'===typeof a){s+='<div class="line comment small_size padding_line item_isfiles" title="">';for(var d=0,c=a.length;d<c;d++)s=s+'<span class="doc1s error_comment">'+a[d]+'</span><br>';s+='</div>';}else s=s+'<div class=\'line comment small_size padding_line item_isfiles\' title=\''+a+'\'><span class=\'doc1s '+(-1!==a.indexOf('поддерживается')?'notSupported':'error_comment')+'\'>'+a+'</span></div>';}s+='</div></div></div></td>',t.html(s);}});return r.showUnloadResultDialog=function(e){t.attachInstance('Source:Dialog',{width:'956',height:'auto',autoHeight:false,resizable:true,template:'js!SBIS3.EDO.IntResultUnload',opener:n.getActiveWindow(),componentOptions:{_result:e}});},r;});
define("html!SBIS3.EDO.IntSettingsProfile",function(){var o=function(o){var n=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;o.test(n);)n=n.replace(o,"&#123;&#123;$1&#125;&#125;");return n}}(),t="undefined"!=typeof process,i=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div> <component data-component="SBIS3.CONTROLS/Menu/MenuButton" style="margin-left:8px;margin-top:4px;" name="ДобавитьНастройку"> <option name="caption">+ Соединение</option> <option name="idProperty">id</option> <option name="displayProperty">title</option> <option name="primary">true</option> <options name="items" type="array"> <options> <option name="id">IntEngineCom1S82</option> <option name="title">1С</option> </options> <options> <option name="id">IntEngineComSAPNC3</option> <option name="title">SAP</option> </options> <options> <option name="id">IntEngineComStoreHouse4</option> <option name="title">Store House</option> </options> </options> </component> <div style="background-color: #c0c0c0; bottom: 0; left: 0; position: absolute; right: 0; top: 40px; height: 1px;"></div> <component data-component="Deprecated/Controls/TableView/TableView" name="СписокНастроек" style="margin-top:10px;"> <options name="display"> <options name="columns" type="array"> <options> <option name="field">Название</option> <option name="title" value="Название"></option> <option name="width">250</option> <option name="titleAlign">left</option> </options> <options> <option name="field">Тип</option> <option name="title" value="Тип"></option> <option name="width">270</option> <option name="titleAlign">left</option> <option name="render" type="function">js!SBIS3.EDO.IntSettingsProfile:prototype.drawType</option> </options> <options> <option name="field">ПутьКБазе</option> <option name="title" value="Адрес"></option> <option name="width">300</option> <option name="titleAlign">left</option> </options> </options> <option name="allowHorizontalScroll">false</option> <option name="showRecordsCount">false</option> <option name="showHead">true</option> <option name="editAtThePlaceOnly">true</option> <option name="rowOptions">true</option> <options name="mainRowOptions"> <option name="edit">false</option> <option name="recordDown">false</option> <option name="recordUp">false</option> </options> <option name="emptyHtml">Вы не настроили ни одного соединения</option> </options> <option name="autoWidth">true</option> <option name="autoHeight">true</option> <option name="allowAdd">false</option> <option name="multiSelect">false</option> </component> </div>');return(i=n(i))+(t&&-1!==i.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.IntSettingsProfile"}},o});
define('js!SBIS3.EDO.IntSettingsProfile',['Lib/Control/Control','Core/core-functions','Deprecated/Record','Deprecated/RecordSetStatic','Core/moduleStubs','Core/Indicator','Core/Context','SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.IntSettingsProfile','Deprecated/Controls/Button/Button','SBIS3.CONTROLS/Menu/MenuButton','Deprecated/Controls/TableView/TableView','Deprecated/Controls/TableView/plugins/AtPlaceEdit-plugin','Deprecated/Controls/OutlineButton/OutlineButton','Dokumentooborot_localization'],function(e,n,t,o,a,i,r,l,s){var d=l.extend({_dotTplFn:s,$protected:{_options:{}},$constructor:function(){},init:function(){d.superclass.init.call(this),self=this,this.getChildControlByName('СписокНастроек').subscribe('onRowClick',function(e,n,t){a.requireModule('SBIS3.EDO.IntEngine').addCallback(function(){SBIS3.EDO.IntEngine.showConnectionWizard(t,'',self);});}),this.getChildControlByName('СписокНастроек').subscribe('onBeforeDelete',function(e,t){e.setResult(false),i.setMessage('Удаление'),a.requireModule('SBIS3.EDO.IntEngine').addCallback(function(){SBIS3.EDO.IntEngine.getUserSettings().addCallback(function(e){if(e){delete e[t[0].get('Идентификатор')],delete SBIS3.EDO.IntEngine.UserConfig()[t[0].get('Идентификатор')];var o=n.clone(e);SBIS3.EDO.IntEngine.setUserSettings(e).addCallback(function(){if(u(o),r.global.getValue('paramMenu'))SBIS3.EDO.IntEngine.createMenu();SBIS3.EDO.IntEngine.updateMenu(),i.hide();});}}).addErrback(function(e){n.alert('Не удалось получить пользовательские параметры',e,'error'),i.hide();});});}),this.getChildControlByName('ДобавитьНастройку').subscribe('onMenuItemActivate',function(e,n){a.requireModule('SBIS3.EDO.IntEngine').addCallback(function(){SBIS3.EDO.IntEngine.showConnectionWizard(null,n);});});},drawType:function(e,n){var t=e.get('Конфигурация');return e.get('Тип')+(t?' : '+t:'');},onAfterShowSettings:function(){var n=function(){var n=new o();if(n.setRecords([]),e.ControlStorage.containsByName('СписокНастроек'))e.ControlStorage.getByName('СписокНастроек').setData(n);};(function(){a.requireModule('SBIS3.EDO.IntEngine').addCallback(function(){SBIS3.EDO.IntEngine.getUserSettings().addCallback(function(e){u(e);});});}());}});function u(n){var a=new o(),i=[];for(var r in n){if(!n.hasOwnProperty(r))continue;n[r].file=n[r].file;var l=new t();l.addColumn('Идентификатор',t.FIELD_TYPE_INTEGER),l.setKey(r,0),l.addColumn('НазваниеКонфигурацииВБД',t.FIELD_TYPE_STRING),l.set('НазваниеКонфигурацииВБД',r),l.addColumn('КонфигурацияВБД',t.FIELD_TYPE_STRING);var s=n[r];if(s.connection)s.connection=false;l.set('КонфигурацияВБД',s),l.addColumn('Название',t.FIELD_TYPE_STRING),l.set('Название',n[r].title),l.addColumn('Тип',t.FIELD_TYPE_STRING),l.set('Тип',n[r].nameSystem?n[r].nameSystem:''),l.addColumn('Конфигурация',t.FIELD_TYPE_STRING),l.set('Конфигурация',n[r].nameType?n[r].nameType:''),l.addColumn('Версия',t.FIELD_TYPE_STRING),l.set('Версия',n[r].version),l.addColumn('ПутьКБазе',t.FIELD_TYPE_STRING),l.set('ПутьКБазе',n[r].file),l.addColumn('Логин',t.FIELD_TYPE_STRING),l.set('Логин',n[r].login?n[r].login:''),l.addColumn('Пароль',t.FIELD_TYPE_STRING),l.set('Пароль',n[r].password?n[r].password:''),l.addColumn('Реестры',t.FIELD_TYPE_QUERY);for(var d=n[r].reestrs,u=new o(),c=[],E=0;E<d.length;E++){var S=new t();S.addColumn('Идентификатор',t.FIELD_TYPE_INTEGER),S.setKey(E,0),S.addColumn('РеестрСБИС',t.FIELD_TYPE_STRING),S.addColumn('Реестр1С',t.FIELD_TYPE_STRING),S.set('РеестрСБИС',Object.keys(d[E])[0]),S.set('Реестр1С',d[E][Object.keys(d[E])[0]]),c.push(S);}u.setRecords(c),l.set('Реестры',u),i.push(l);}if(a.setRecords(i),e.ControlStorage.containsByName('СписокНастроек'))e.ControlStorage.getByName('СписокНастроек').setData(a);}return d;});
define('js!SBIS3.EDO.DocsAutoSign',['Core/WindowManager','Core/RightsManager','Core/moduleStubs','Core/MicroSession','Core/Indicator','Core/IoC','Core/Deferred','Core/constants','Core/core-extend','Core/UserInfo','WS.Data/Source/SbisService','WS.Data/Entity/Record','WS.Data/Collection/RecordSet','i18n!SBIS3.EDO.DocsAutoSign','Dokumentooborot_localization'],function(e,t,n,r,s,o,a,i,c,l,u,g,f){var d='AutoSign_TimeOfLastRequest',p=300000,_='___',m=rk('Есть новые документы, требующие подписи и расшифровки'),h=rk('Все новые документы подписаны и расшифрованы'),S=rk('Автоприостановка этапа'),k=rk('Обработка отложена'),C={signDocumentAttachments:function(e,t){var r=new C.AutoSign({silent_mode:false,cert:t||null});return r.checkRights().addCallback(function(){return r.processDocument(e);}).addErrback(function(e){if(n.require(['SBIS3.CONTROLS/Utils/InformationPopupManager']).addCallback(function(t){t[0].showMessageDialog({message:e.message,status:'error'});}),s.hide(),!r._isUserCancelledError(e))return e;else return;});},signIntDocsForDocument:function(e){return o.resolve('ILogger').info('Deprecated','Метод DocsAutoSign.signIntDocsForDocument() объявлен deprecated и будет удален в версии 3.7.5.150. Используйте метод signDocumentAttachments(docKey)'),C.signDocumentAttachments(e);},signIntDocsForDocumentByCert:function(e,t){return o.resolve('ILogger').info('Deprecated','Метод DocsAutoSign.signIntDocsForDocumentByCert() объявлен deprecated и будет удален в версии 3.7.5.150. Используйте метод signDocumentAttachments(docKey, cert)'),C.signDocumentAttachments(e,t);},objParam:function(e){return{endpoint:{contract:e,address:'/service/?srv=1'}};},AutoSign:c.extend({},{$protected:{_silentMode:true,_informer:null,_processingStages:null,_processingSuspended:false,_processingContinued:false,_somethingProcessed:false,_wasAutoSuspend:false,_lastAutoSignComponentOptions:null,_certChoosingPopupOpened:false,_completedDef:null,_stopOnError:false,_opener:null,_actionExecutor:null},$constructor:function(e){this._silentMode=e.silentMode||e.silent_mode||false,this._informer=e.informer||null;},checkRights:function(){var e=t.getRights(['Подпись документов']),n=new a(),r=e['Подпись документов']&t.ALLOW_MASK;return n.addErrback(function(e){return e;}),n.callback(!r?new Error(rk('У вас нет прав на подпись документов!')):r),n;},processAllOurOrgs:function(e){var t=this,n=new a(),s=new a();if(void 0===e)e=false;if(e){if(t._completedDef&&(void 0===t._completedDef.callbackAdded||!t._completedDef.callbackAdded))t._completedDef.callbackAdded=true,t._completedDef.addCallback(function(){t.processAllOurOrgs(e);});if(t._processingContinued||t._completedDef)return;}else t._completedDef=new a();return t._processingContinued=e,t._processingStages=null,new u({endpoint:'ПроверкаПрав'}).call('ДоступностьМетода',{'ИмяМетода':'ЭДО.ИнформацияОСлужебныхЭтапах','ЧислоАргументов':1}).addCallback(function(o){var a;if(o&&o.getRawData())return a=new g({adapter:'adapter.sbis',format:[{name:'ТолькоНаличиеСобытий',type:'boolean'},{name:'ТолькоЭДО',type:'boolean'}]}),a.set({'ТолькоНаличиеСобытий':true,'ТолькоЭДО':false}),new u(C.objParam('ЭДО')).call('ИнформацияОСлужебныхЭтапах',{'Фильтр':a}).addCallback(function(o){var a=o&&o.getRow()||null,i,c,l,u,g,f,d;if(s.addBoth(function(){var e;if(t._informerProcessFinished(),t._processingContinued)if(t._processingContinued=false,t._processingSuspended=false,!t._somethingProcessed&&t._informer)t._informer.setState(t._informer.state.hidden);if(t.clearTempData(),!a.get('ПрекратитьЗапросы'))setTimeout(function(){if(t._informer&&t._informer.getState()!==t._informer.state.processing)t.processAllOurOrgs();},p);else r.set('autosign_stop_requests','StopRequests');if(t._completedDef)e=t._completedDef,t._completedDef=null,e.callback();}),a){if(c=a.get('ОбработкаПриостановленаДо')||null,l=a.get('ЧислоНеобработанныхЭтапов')||null,i=a.get('СерверноеВремя')?new Date(a.get('СерверноеВремя')):null,i&&!r.get('autosign_start_time'))i=i.toISOString(),r.set('autosign_start_time',i);if(e)t._processingSuspended=false;else if(!!c&&l>0)t._setSuspend(c,false);if(l>0)if(g=a.get('НашаОрганизация')||null,u=g&&g.getCount()||0,u){for(d=0;d<u;++d)(function(e){n.addCallback(function(n){return t._processOurOrg(e,true);});}(f=g.at(d)));return n.addCallback(function(){s.callback();}).addErrback(function(e){s.errback(e);}).callback(),s;}}return s.callback();}).addErrback(function(e){return e.processed=true,true;});else return r.set('autosign_stop_requests','NoRights'),true;}).addErrback(function(e){return true;});},processDocument:function(e){var t=this;return t._stopOnError=true,t._processDocumentOneTime(e).addBoth(function(n){if(n&&n.message===rk('Действие уже обработано'))return true;else if(t._isEventlockError(n))return t.processDocument(e);return n;});},decryptDocument:function(e){var t=new C.AutoSign({silentMode:false});return t._getServiceStagesByDocument(e).addCallback(function(e){var n,r,s;if(e){if(s=e.get('Документ')||null,s)n=new f({adapter:'adapter.sbis',format:s.getFormat()}),s.each(function(e){if(r=t._getAction(e),r&&!!(r.get('ТребуетРасшифровки')||r.get('ТребуетсяРасшифровка')))n.add(e);});return t._processStages(n);}});},_getServiceStagesByDocument:function(e){return new u(C.objParam('ЭДО')).call('ИдентификаторДокумента',{'КлючДокумента':e}).addCallback(function(e){var t=e?e.getRawData():null,n;if(t)return n=new g({adapter:'adapter.sbis',format:[{name:'ИдентификаторДокумента',type:'string'},{name:'Блокировать',type:'boolean'},{name:'ТолькоЭДО',type:'boolean'}]}),n.set({'ИдентификаторДокумента':t,'Блокировать':false,'ТолькоЭДО':false}),new u(C.objParam('ЭДО')).call('СписокСлужебныхЭтапов',{'Фильтр':n}).addCallback(function(e){return e&&e.getRow()||null;});else return new Error(rk('Не удалось получить идентификатор документа.'));});},_processDocumentOneTime:function(e){var t=this;return t._getServiceStagesByDocument(e).addCallback(function(e){var n;if(e)return n=e.get('Документ')||null,t._processStages(n).addBoth(function(e){return t._informerProcessFinished(),e;});});},continueProcess:function(e){var t=this;if(t._lastAutoSignComponentOptions&&e)t._showCertChoosingPopup(t._lastAutoSignComponentOptions).addCallback(function(){if(!r.get('autosign_stop_requests'))t.processAllOurOrgs(true);}).addErrback(function(e){if(e&&e.message===rk('Обработка отложена')&&!r.get('autosign_stop_requests'))t.processAllOurOrgs(false);});else if(!r.get('autosign_stop_requests'))t.processAllOurOrgs(true);},_processOurOrg:function(e){var t=this,n=new g({adapter:'adapter.sbis',format:[{name:'НашаОрганизация',type:'record'},{name:'Блокировать',type:'boolean'},{name:'ТолькоЭДО',type:'boolean'}]});return n.set({'НашаОрганизация':e,'Блокировать':false,'ТолькоЭДО':false}),new u(C.objParam('ЭДО')).call('СписокСлужебныхЭтапов',{'Фильтр':n}).addCallback(function(n){var r=n&&n.getRow()||null,s;if(t._processingStages=null,r){if(s=r.get('Документ')||null,!s||!s.getCount())return new a().callback();return t._processStages(s,e.get('ПервичныйКлюч')||null).addCallback(function(){return t._processOurOrg(e);});}}).addErrback(function(e){return true;});},_processStages:function(e,t){var n=this,r=new a(),s=new a(),o,i;if(e&&e.getCount()){for(n._processingStages=e,i=0;i<e.getCount();++i)(function(e,t){r.addCallback(function(){return n._processStage(e,t);});}(o=e.at(i),t));r.addCallback(function(){s.callback();}).addErrback(function(e){s.errback(e);}),r.callback();}else s.callback();return s;},_processStage:function(e,t){var r=this;return n.require(['js!SBIS3.EDO2.ActionExecutor']).addCallback(function(n){var s=e.get('НашаОрганизация')||null,o=e.get('Этап').at(0),c=o.get('Действие').at(0),l={'Идентификатор':e.get('Идентификатор'),'ПервичныйКлюч':e.get('ПервичныйКлюч'),'ИдентификаторНО':t,'Этап':[{'ПервичныйКлюч':o.get('ПервичныйКлюч'),'Идентификатор':o.get('Идентификатор'),'Название':o.get('Название'),'Действие':[{'Название':c.get('Название'),'Комментарий':c.get('Комментарий'),'ТребуетКомментария':!!c.get('ТребуетКомментария')||!!c.get('ТребуетсяКомментарий'),'ТребуетПодписания':!!c.get('ТребуетПодписания')||!!c.get('ТребуетсяПодписание'),'ТребуетРасшифровки':!!c.get('ТребуетРасшифровки')||!!c.get('ТребуетсяРасшифровка'),'ТребуетИсполнителя':!!c.get('ТребуетИсполнителя')||!!c.get('ТребуетсяИсполнитель'),'Сертификат':c.get('Сертификат')}]}]},u=function(n){var s=e.get('Этап').at(0).get('Действие').at(0),o,c,l;if(r._isEventlockError(n)&&!s.get('ТребуетРасшифровки')&&!s.get('ТребуетсяРасшифровка')){if(r._stopOnError)return n;return r._suspendProcessing(e).addBoth(function(){return true;});}else if(!r._silentMode&&n instanceof Error)return r._suspendProcessing(e).addBoth(function(e){return n;});else if(n&&(n.message===rk('Для выбранного действия требуется Ваша действующая электронная подпись. Вставьте в компьютер действующий ключ электронной подписи.')||n.message===rk('Не удалось получить сертификаты клиента. Работа с криптографией на данной операционной системе не поддерживается.')||n.details&&-1!==n.details.indexOf('Distribution')&&-1!==n.details.indexOf('autosign.close')))return c=new a(),o=s.get('Сертификат'),l=r._actionExecutor._convertDataForChoosingCert(o,false),r._getAutoSignComponentOptions(e,l,t).addCallback(function(t){var n=new a();if(s.get('ТребуетРасшифровки'))r._suspendProcessing(e).addBoth(function(e){n.callback();});else n.callback();n.addCallback(function(){var n;if(r._processingSuspended){if(!r._lastAutoSignComponentOptions)r._lastAutoSignComponentOptions=t;r._wasAutoSuspend=true,c.errback(new Error(S));}else if(r._processingContinued=false,i.browser.isMobilePlatform)(n=new Date()).setTime(n.getTime()+10*60*1000),r._lastAutoSignComponentOptions=t,r._certChoosingPopupOpened=false,r._suspendProcessing(e,n).addBoth(function(){c.errback(new Error(k));});else c.dependOn(r._showCertChoosingPopup(t).addErrback(function(e){return e&&e.message===rk('Обработка отложена')?true:e;}));});}),c;else return r._suspendProcessing(e).addBoth(function(){return!!r._silentMode||n;});};if(!r._actionExecutor)r._actionExecutor=new n[0].ActionEx({});if(!e||!s||!r._processingStages)return Error(rk('Пользователь приостановил обработку'));return r._setStageMicroSessionId(e),r._actionExecutor.performAction('Документ',l,null,r,true,false).addCallback(function(){if(r._clearStageMicroSessionId(e),r._somethingProcessed=true,r._informer)r._informer.setState(r._informer.state.processing);if(!!r._processingStages)r._processingStages.remove(e);}).addErrback(u);});},clearTempData:function(){if(this._actionExecutor)this._actionExecutor.clearTempData(),this._actionExecutor=null;},_suspendProcessing:function(e,t){var n=this,r=new g({adapter:'adapter.sbis',format:[{name:'Документ',type:'record'}]}),s=n._cleanStage(e);if(r.set('Документ',s),t)r.addField({name:'ПриостановитьДо',type:'datetime'}),r.set('ПриостановитьДо',t),n._setSuspend(t);return new u(C.objParam('ЭДО')).call('ОтложитьОбработкуСлужебныхЭтапов',{'Параметры':r}).addCallback(function(){if(!!n._processingStages)n._processingStages.remove(s);});},_setSuspend:function(e,t){var n=this,r,s,o;if(void 0===t)t=true;if(!!e)if(r=new Date(Date.parse(e)),s=new Date(),r>s)if(n._processingSuspended=true,o=parseInt(r-s,10),o<24*60*60*1000)setTimeout(function(){n._processingSuspended=false;},o);if(t&&n._informer)n._informer.setState(n._informer.state.needSign);},_cleanStage:function(e){var t=['Идентификатор','ПервичныйКлюч','Редакция','Этап'],n=e.clone(false),r=n.getFormat().getEnumerator(),s,o,a;while(r.moveNext()){var i=r.getCurrent().getName();if(-1===t.indexOf(i))n.removeField(i);}if(o=this._getAction(n),o&&o.has('Сертификат'))if(a=o.get('Сертификат'),a&&a.getCount()>1)(s=new f({adapter:'adapter.sbis',format:a.getFormat()})).add(a.at(0)),o.set('Сертификат',s);return n;},_cutCertRec:function(e){return n.require(['Deprecated/Record']).addCallback(function(t){var n=t[0],r=new n();return r.addColumn('ФИО',n.FIELD_TYPE_STRING),r.addColumn('Должность',n.FIELD_TYPE_STRING),r.addColumn('ИНН',n.FIELD_TYPE_STRING),r.addColumn('Название',n.FIELD_TYPE_STRING),r.addColumn('Отпечаток',n.FIELD_TYPE_STRING),r.addColumn('СерийныйНомер',n.FIELD_TYPE_STRING),r.set('ФИО',e.get('ФИО')),r.set('Должность',e.get('Должность')),r.set('ИНН',e.get('ИНН')),r.set('Название',e.get('Организация')),r.set('Отпечаток',e.get('Отпечаток')),r.set('СерийныйНомер',e.get('СерийныйНомер')),r;});},_getAction:function(e){var t=e&&e.get('Этап')||null,n=t&&t.getCount()&&t.at(0)||null,r=n&&n.get('Действие')||null;return r&&r.getCount()&&r.at(0)||null;},_getActionProperties:function(e){var t=this._getAction(e);return{title:t&&t.get('Название')||'',isNeedSign:t&&t.get('ТребуетПодписания')||false,isNeedDecrypt:t&&t.get('ТребуетРасшифровки')||false,certs:t&&t.get('Сертификат')||null};},_getStageId:function(e){var t=e&&e.get('Этап')||null,n=t&&t.getCount()&&t.at(0)||null;return n&&n.get('Идентификатор')||'';},_getAutoSignComponentOptions:function(e,t,n){var r=e.clone(),s=new a(),o=this,i=r.has('НашаОрганизация')?r.get('НашаОрганизация'):null,c=[],l=[],u=[],g=[],f=function(e,t){var n;for(n=0;n<t.length;n++)if(t[n].name===e)return true;return false;},d=null,p={};if(o._processingStages)o._processingStages.each(function(e){var t=o._getActionProperties(e),n=e.has('Этап')?e.get('Этап'):null,r=n&&n.getCount()?n.at(0):null,s=r&&r.has('Название')?r.get('Название'):null,a=['Извещение о получении Уведомления о приеме','Извещение о получении Уведомления об уточнении'],i=e.has('Название')?e.get('Название'):null,c=e.has('Контрагент')?e.get('Контрагент'):null,d=c?o._getOrgProperties(c).title:null;if(t.isNeedDecrypt){if(i)l.push({name:i});}else if(d&&-1!==s.indexOf(a)){if(!f(d,g))g.push({name:d});}else if(d){if(!f(d,u))u.push({name:d});}else if(i)l.push({name:i});else if(r&&r.get('Идентификатор')&&r.get('Идентификатор').split(':').length>1)l.push({name:s});});if(l.length)c.push({name:rk('Ответы по отправленной электронной отчетности'),data:l});if(u.length)c.push({name:rk('Входящие документы'),data:u});if(g.length)c.push({name:rk('Ответы на документы отправленные контрагентам'),data:g});if(t.firstClientCert)d={name:t.firstClientCert.get('ФИО')||null,post:t.firstClientCert.get('Должность')||null,company:t.firstClientCert.get('Название')||null};if(!r.has('ИдентификаторНО'))r.addField({name:'ИдентификаторНО',type:'integer'}),r.set('ИдентификаторНО',i.get('ПервичныйКлюч')||n||null);if(p={docs:c,sign:null,title:m,our_org:i,data:t,stage:r},!d||!d.name||!d.company)o._getOrgPropertiesDef(i).addCallback(function(e){d={company:e.title},p.sign=d,s.callback(p);}).addErrback(function(e){s.callback(p);});else p.sign=d,s.callback(p);return s;},_informerProcessFinished:function(){if(this._informer)if(this._wasAutoSuspend&&!this._somethingProcessed)this._informer.setState(this._informer.state.needSign);else if(this._somethingProcessed){if(this._informer.getState()!==this._informer.state.hidden&&this._informer.getState()!==this._informer.state.needSign)this._informer.setState(this._informer.state.processFinished);}else if(this._informer.isInitialState){var e=parseInt(r.get('autosign_state'),10);if(!e||e&&e<2)this._informer.setState(this._informer.state.hidden);}else if(this._informer.getState()!==this._informer.state.needSign)this._informer.setState(this._informer.state.hidden);},_showCertChoosingPopup:function(t,r){var o=this,i=new a(),c,l,u=e.getActiveWindow(),g={};if(void 0===r)r=false;if(o._certChoosingPopupOpened)return i;if(l=function(e){var c=true,l=new a(),g,f;if(r)e.sendCommand('close'),i.callback();else{if(s.setMessage(rk('Пожалуйста, подождите')+'...'),g=o._getStageId(t.stage),f=g&&g.split(':')||[],f&&'sbis-notice-distribution'===f[0])c=false;if(l.addCallback(function(){o._actionExecutor.performAction('Документ',t.stage,null,u,c,false).addCallback(function(t){if(s.hide(),e.sendCommand('close'),!i.isReady())i.callback();else o._lastAutoSignComponentOptions=null;}).addErrback(function(t){s.hide(),n.require(['SBIS3.CONTROLS/Utils/InformationPopupManager']).addCallback(function(e){e[0].showMessageDialog({message:rk('Требуемая подпись не обнаружена. Если вы только что вставили носитель, то необходимо обновить страницу.'),status:'error'});}),e.withPostpone=true;});}),o._actionExecutor)l.callback();else n.require(['js!SBIS3.EDO2.ActionExecutor']).addCallback(function(e){o._actionExecutor=new e[0].ActionEx({}),l.callback();});}},c=function(e,n){var r=new Date(),s=60*1000;switch(n){case'30m':s*=30;break;case'1h':s*=60;break;case'2h':s*=120;break;case'3h':s*=180;break;default:s*=30;}if(r.setTime(r.getTime()+s),void 0===r)(r=new Date()).setTime(r.getTime()+30*60*1000);if(o._suspendProcessing(t.stage,r),e.sendCommand('close'),!i.isReady())i.errback(new Error(k));},o._certChoosingPopupOpened=true,o._lastAutoSignComponentOptions=t,g={componentOptions:{dataDocs:t.docs,dataSign:t.sign,defSign:l,defPostpone:c},dialogOptions:{title:t.title,resizable:false}},o._opener)o._opener.execute(g);else n.require(['SBIS3.CONTROLS/Action/OpenDialog']).addCallback(function(e){var t=e[0];o._opener=new t({name:'autoSignDialogOpener',template:'js!SBIS3.EDO2.AutoSignDialog',mode:'dialog',componentOptions:{onAfterCloseFunc:function(e){o._certChoosingPopupOpened=false;}},dialogOptions:{resizable:false},handlers:{onDestroy:function(e){o._opener=null;}}}),o._opener.execute(g);}).addErrback(function(e){i.errback(e);});return i;},_getOrgProperties:function(e){var t='',n='',r='';if(e)if(e.has('СвЮЛ')){var s=e.get('СвЮЛ');if(s)t=s.get('ИНН')||'',n=s.get('КПП')||'',r=s.get('Название')||'';}else if(e.has('СвФЛ')){var o=e.get('СвФЛ');if(o){t=o.get('ИНН')||'';var a=o.get('Фамилия')||'',i=o.get('Имя')||'',c=o.get('Отчество')||'';r=a+(a.length?' ':'')+i,r+=(r.length?' ':'')+c;}}return{inn:t,kpp:n,title:r,key:t.length?t+n:null};},_getOrgPropertiesDef:function(e){var t=new a(),n='',r='',s='',o,i,c,l,g;if(e&&e.has('СвЮЛ'))r=(l=e.get('СвЮЛ')||null)&&l.get('КПП')||'',s=l&&l.get('Название')||'';else if(e&&e.has('СвФЛ'))i=(l=e.get('СвФЛ')||null)&&l.get('Фамилия')||'',c=l&&l.get('Имя')||'',o=l&&l.get('Отчество')||'',s=(i+(i?' ':'')+c+(c?' ':'')+o).trim();if(n=l&&l.get('ИНН')||'',s)t.callback({inn:n,kpp:r,title:s,key:n.length?n+r:null});else if(g=e.get('ПервичныйКлюч')||null,g)t.dependOn(new u({endpoint:'НашаОрганизация'}).call('ПрочитатьДляКарточки',{'ИдО':g,'ИмяМетода':'БазовоеРасширение'}).addCallback(function(e){var t=e.getRow();return{inn:t&&t.get('ИНН')||'',kpp:t&&t.get('КПП')||'',title:t&&t.get('Название')||'',key:g};}));else t.errback('no data');return t;},_setStageMicroSessionId:function(e){var t=e.get('Этап')||null,n=t&&t.getCount()&&t.at(0)||null,s,o;if(!!n&&n.has('Идентификатор'))if(o=n.get('Идентификатор').split('_'),2===o.length)if(s=r.get('autosign_msid'),!!s&&o[1]!==s)n.set('Идентификатор',o[0]+'_'+s);else r.set('autosign_msid',o[1]);},_clearStageMicroSessionId:function(e){var t=e.get('Этап')||null,n=t&&t.getCount()&&t.at(0)||null,s;if(!!n&&n.has('Идентификатор'))if(s=n.get('Идентификатор').split('_'),2===s.length&&s[1]===r.get('autosign_msid'))r.set('autosign_msid','');},_checkTimeOfLastRequest:function(){var e=this,t=new a(),n=new Date(),s=this._getValueFromCookie(d),o=s&&s.split(_)||[],i=o&&o[0]||'',c=o&&o[1]||null,u=c&&new Date(c)||null,g=r.get(d)||false;if(i&&i===String(l.get('ИдентификаторПользователя')))if(g||!u||u&&n>new Date(u.getTime()+p))e._setTimeOfLastRequestToCookies(),t.callback();else(function(e,t){setTimeout(function(){t.dependOn(e._checkTimeOfLastRequest());},p);}(e,t));else e._setTimeOfLastRequestToCookies(),t.callback();return t;},_setTimeOfLastRequestToCookies:function(){var e=new Date(),t=l.get('ИдентификаторПользователя');r.set(d,true),document.cookie=d+'='+[t,e].join(_)+'; expires=3600; path=/;';},_getValueFromCookie:function(e){var t=document.cookie.match(new RegExp('(?:^|; )'+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,'\\$1')+'=([^;]*)'));return t?decodeURIComponent(t[1]):void 0;},_log:function(e,t){o.resolve('ILogger').info(rk('Ошибка автоподписи'),e+': '+t.message);},_isUserCancelledError:function(e){return e instanceof Error&&('USER_CANCELLED'===e.type||'Отменено пользователем!'===e.message||e.message===S||e.message===k);},_isEventlockError:function(e){return e&&(e.classid&&('{00000000-0000-0000-0000-1aa000030000}'===e.classid||'{00000000-0000-0000-0000-1fa0000B0002}'===e.classid||'{00000000-0000-0000-0000-1aa000010006}'===e.classid)||e.message===rk('Действие не обработано')||e.message===rk('Событие обрабатывается другим процессом'));}})};return C;});
define("html!SBIS3.EDO.AuthorizedToSign",function(){var o=function(o){var n=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;o.test(n);)n=n.replace(o,"&#123;&#123;$1&#125;&#125;");return n}}(),i=function(o){return o.join?o.join(""):o.toString()},e=function(o){return void 0===o?"":o&&"object"==typeof o?i(o):""+o},t="undefined"!=typeof process,r=("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),d=function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,a="<div class='edo-AuthorizedToSign'> <div class='edo-AuthorizedToSign_header'> <div class='edo-AuthorizedToSign_header_flag OurCardPanel_flagRussia'> </div> <div class='edo-AuthorizedToSign_infoBlock'> <div class='edo-AuthorizedToSign_infoBlock_main'> <div class='edo-AuthorizedToSign_infoBlock_row'> <div class='edo-AuthorizedToSign_infoBlock_block'> ";return'"Предприниматель"'!==o.record.get("Контрагент_")&&(a+=" <div class='edo-AuthorizedToSign_infoBlock_caption'> "+n(e(rk("КПП")))+" </div> <div class='edo-AuthorizedToSign_infoBlock_text'> "+n(e(o.record.get("КПП")||""))+" </div> "),a+=" </div> <div class='edo-AuthorizedToSign_infoBlock_block'> <div class='edo-AuthorizedToSign_infoBlock_caption'> "+n(e(rk("ИНН")))+" </div> <div class='edo-AuthorizedToSign_infoBlock_text'> "+n(e(o.record.get("ИНН")||""))+" </div> </div> </div> </div> <div class='edo-AuthorizedToSign_infoBlock_icoBlock'> <div class='edo-AuthorizedToSign_infoBlock_icoBlock_KPP ws-hidden'> <i class='icon-16 icon-Publish2 icon-disabled edo-AuthorizedToSign_infoBlock_ico'></i> </div> </div> </div> <component data-component='SBIS3.CONTROLS/Link' name='closePage' class='ws-float-close sbisname-window-title-close ws-float-close-right'> <option name='command'>closePage</option> </component> </div> <component data-component='SBIS3.CONTROLS/Tab/Control' name='orgTabs' class='edo-AuthorizedToSign_tab'> <option name='idProperty'>id</option> <option name='tabsDisplayProperty'>title</option> <option name='selectedKey'>orgTab</option> <option name='stickyHeader'>false</option> <option name='tabindex'>1</option> <options name='items' type='array'> <options> <option name='id'>orgTab</option> <option name='title' type='string'> <div class='edo-AuthorizedToSign_org_name' title='"+n(e(o.record.get("Название")||""))+"'>"+n(e(o.record.get("Название")||""))+"</div> </option> <option name='align'>left</option> <option name='content' type='string'> <component data-component='SBIS3.CONTROLS/ScrollContainer' name='scrollOrgTabs' class='edo-AuthorizedToSign_scrollContainer'> <option name='content' type='string'> <component data-component='SBIS3.EDO.PowerOfAttorneyList'> <option name='filterOrgID'>"+n(e(o.record.get("@Лицо")))+"</option> <option name='listItems' type='ref'>"+n(e(function(o,n){var i=r.randomId();return o[i]=n,i}(d,o.listItems)))+"</option> <option name='leader' type='ref'>"+n(e(function(o,n){var i=r.randomId();return o[i]=n,i}(d,o.leader)))+"</option> </component> </option> </component> </option> </options> </options> </component> </div>",(a=n(a))+(t&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.AuthorizedToSign"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.AuthorizedToSign", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-AuthorizedToSign{min-width:900px;width:900px;max-width:900px}.edo-AuthorizedToSign_header{width:100%;height:40px;background-color:#f7f4f0}.edo-AuthorizedToSign_header_flag{width:16px;height:16px;background-image:url(/resources/Doverennosti/components/AuthorizedToSign/resources/643_mini.v1516270649826335cf4508dd597be4bfc9caa3e08b901.png);background-repeat:no-repeat;position:absolute;top:11px;left:8px}.edo-AuthorizedToSign_infoBlock{position:absolute;top:8px;left:331px;z-index:100}.edo-AuthorizedToSign_infoBlock_main{float:left}.edo-AuthorizedToSign_infoBlock_row{height:24px;line-height:24px}.edo-AuthorizedToSign_infoBlock_block{float:right}.edo-AuthorizedToSign_infoBlock_icoBlock{height:24px;float:left}.AuthorizedToSign_infoBlock_icoBlock_KPP{float:left;width:20px}.edo-AuthorizedToSign_infoBlock_icoBlock_CodeAndGLN{float:left;width:20px}.edo-AuthorizedToSign_infoBlock_caption{float:left;text-align:right;width:44px;font-size:14px;color:#999}.edo-AuthorizedToSign_infoBlock_text{float:left;width:86px;text-align:left;font-size:14px;color:#000;padding-left:8px}.edo-AuthorizedToSign_infoBlock_ico{margin:4px 0}.edo-AuthorizedToSign_tab{width:100%;background-color:#f7f4f0;height:calc(100vh - 40px)}.edo-AuthorizedToSign_tab .ws-SwitchableArea{height:calc(100vh - 40px)}.edo-AuthorizedToSign_tab .ws-SwitchableArea .ws-SwitchableArea__item{height:100%}.edo-AuthorizedToSign_scrollContainer{height:100%}.edo-AuthorizedToSign_tabs_list{overflow:hidden}.edo-AuthorizedToSign_org_name{max-width:315px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;font-size:18px}"));head.appendChild(style);});}
define("html!SBIS3.EDO.PowerOfAttorneyList",function(){var o=function(o){var t=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;o.test(t);)t=t.replace(o,"&#123;&#123;$1&#125;&#125;");return t}}(),n=function(o){return o.join?o.join(""):o.toString()},e=function(o){return void 0===o?"":o&&"object"==typeof o?n(o):""+o},i="undefined"!=typeof process,p=("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),a=function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,r="<div class='edo-PowerOfAttorneyList'> <div class='edo-PowerOfAttorneyList_controls'> <div class='edo-PowerOfAttorneyList_leader'> <component data-component='SBIS3.EDO.DelegateStaffChoice' name='dscLeader' class='edo-PowerOfAttorneyList_leader_field'> <option name='leader' type='ref'>"+t(e(function(o,t){var n=p.randomId();return o[n]=t,n}(a,o.leader)))+"</option> </component> </div> <div class='edo-PowerOfAttorneyList_confirmer'> <component data-component='SBIS3.EDO.ConfirmerStaffChoice' name='cscConfirmer' class='edo-PowerOfAttorneyList_confirmer_field'> <option name='confirmerField' value='record/НашаОрганизация.ПодтверждаетПолучениеДокументов'></option> </component> </div> <div class='edo-PowerOfAttorneyList_canSign'> <div class='edo-PowerOfAttorneyList_canSign_caption'> "+t(e(rk("Документы и отчетность могут подписывать")))+" </div> <component data-component='SBIS3.CONTROLS/Switcher/Double' name='sdCanSign' class='edo-PowerOfAttorneyList_canSign_switcher'> <option name='stateOff'>только руководитель и указанные ниже лица</option> <option name='stateOn'>все сотрудники с электронной подписью</option> <option name='disposition'>vertical</option> <option name='tabindex'>3</option> <options name='handlers'> <option name='onInit' type='function'>js!SBIS3.EDO.PowerOfAttorneyList:prototype.onInitSdCanSign</option> <option name='onCheckedChange' type='function'>js!SBIS3.EDO.PowerOfAttorneyList:prototype.onCheckedChangeSdCanSign</option> </options> </component> </div> <div class='edo-PowerOfAttorneyList_active'> <div class='edo-PowerOfAttorneyList_active_caption'> "+t(e(rk("Кому дано право подписи")))+" </div> <component data-component='SBIS3.CONTROLS/Button/IconButton' name='linkAdd' class='edo-PowerOfAttorneyList_active_linkAdd controls-IconButton__round-border-24'> <option name='icon'>sprite:icon-16 icon-AddButtonNew icon-primary</option> <option name='tabindex'>4</option> </component> <component data-component='SBIS3.CONTROLS/Switcher/Double' name='sdActive' class='edo-PowerOfAttorneyList_active_switcher'> <option name='state'>on</option> <option name='checked' bind='filterActive'></option> <option name='stateOff'>"+t(e(rk("Все")))+"</option> <option name='stateOn'>"+t(e(rk("Действующие")))+"</option> <option name='disposition'>horizontal</option> <option name='tabindex'>5</option> </component> </div> </div> <div class='edo-PowerOfAttorneyList_facsimile'> <component data-component='SBIS3.DigitalSignatures.Facsimile' name='cfFacsimile'> <option name='component_type'>stamp</option> <option name='context_column_name'>НашаОрганизация.@Лицо</option> </component> </div> <div class='edo-PowerOfAttorneyList_list'> <component data-component='SBIS3.CONTROLS/Tree/DataGridView' name='tdPoAList' class='edo-PowerOfAttorneyList_list_browser controls-ListView__hideCheckBoxes controls-TreeDataGridView__withPhoto-M'> <option name='displayProperty'>Название</option> <option name='idProperty'>@Документ</option> <option name='parentProperty'>Раздел</option> <option name='emptyHTML'>"+t(e(rk("Лица с правом подписи не заданы")))+"</option> <options name='ladder' type='array'> <option name='name'>Доверенность.ЛицоОтправителя</option> </options> <options name='filter'> <option name='Доверенность.Доверитель'>"+t(e(o.filterOrgID))+"</option> <option name='Действительные' bind='filterActive' oneWay='true' direction='fromContext' nonexistent='true'>true</option> </options> <option name='items' type='ref'>"+t(e(function(o,t){var n=p.randomId();return o[n]=t,n}(a,o.listItems)))+"</option> <options name='dataSource'> <option name='module'>WS.Data/Source/SbisService</option> <options name='options'> <option name='endpoint'>Доверенность</option> <options name='binding'> <option name='query'>ИерархическийСписок</option> <option name='create'>Создать</option> <option name='format'>Доверенность.Format</option> <option name='create'>Создать</option> <option name='read'>Прочитать</option> <option name='save'>Записать</option> <option name='destroy'>Удалить</option> </options> <option name='model'>PowerOfAttorneyListModel</option> </options> <option name='idProperty'>@Документ</option> </options> <options name='columns' type='array'> <options> <option name='title'>Данные</option> <option name='cellTemplate'>html!SBIS3.EDO.PowerOfAttorneyList/resources/mainCellTemplate</option> </options> </options> <option name='editMode'>toolbar|single</option> <options name='itemsActions' type='array'> <options> <option name='name'>extend</option> <option name='caption'>"+t(e(rk("продлить на год")))+"</option> <option name='isMainAction'>true</option> <option name='tooltip'>"+t(e(rk("Продлить на год")))+"</option> <option name='onActivated' type='function'>js!SBIS3.EDO.PowerOfAttorneyList:prototype.actionExtendPOA</option> </options> <options> <option name='name'>delete</option> <option name='icon'>sprite:icon-16 icon-Erase icon-error</option> <option name='isMainAction'>true</option> <option name='caption'>Удалить</option> <option name='tooltip'>Удалить</option> <option name='onActivated' type='function'>js!SBIS3.EDO.PowerOfAttorneyList:prototype.actionDeletePOA</option> </options> <options> <option name='name'>abort</option> <option name='icon'>sprite:icon-16 icon-Erase icon-error</option> <option name='isMainAction'>true</option> <option name='tooltip'>Прекратить досрочно</option> <option name='onActivated' type='function'>js!SBIS3.EDO.PowerOfAttorneyList:prototype.actionAbortPOA</option> </options> </options> <option name='itemsDragNDrop' value=''></option> <option name='editArrow'>false</option> <option name='allowEnterToFolder'>false</option> <option name='ignoreLocalPageSize'>true</option> <option name='expand'>true</option> <option name='multiselect'>false</option> <option name='paging'>no</option> <option name='partialPaging'>false</option> <option name='showHead'>false</option> <option name='itemsSortMethod' type='function'>js!SBIS3.EDO.PowerOfAttorneyList:prototype.itemsSortMethodPOAList</option> <options name='handlers'> <option name='onChangeHoveredItem' type='function'>js!SBIS3.EDO.PowerOfAttorneyList:prototype.onChangeHoveredItemPOAList</option> <option name='onBeginEdit' type='function'>js!SBIS3.EDO.PowerOfAttorneyList:prototype.onBeginEditDgvList</option> <option name='onAfterBeginEdit' type='function'>js!SBIS3.EDO.PowerOfAttorneyList:prototype.onAfterBeginEditDgvList</option> </options> </component> <component data-component='SBIS3.EDO2.OpenDialogAction' name='powerOfAttorneyOpener'> <option name='dialogComponent'>js!SBIS3.EDO2.PowerOfAttorneyToSign</option> <option name='mode'>floatArea</option> </component> </div> </div>";return(r=t(r))+(i&&-1!==r.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.PowerOfAttorneyList"}},o});
define("html!SBIS3.EDO.PowerOfAttorneyList/resources/poaEditingTemplate",function(){var o=function(o){var t=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;o.test(t);)t=t.replace(o,"&#123;&#123;$1&#125;&#125;");return t}}(),n=function(o){return o.join?o.join(""):o.toString()},e=function(o){return void 0===o?"":o&&"object"==typeof o?n(o):""+o},i="undefined"!=typeof process,r=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,"<div class='edo-PowerOfAttorneyList_rowEdit'> <div class='edo-PowerOfAttorneyList_rowEdit_main_leaf'> <div class='edo-PowerOfAttorneyList_rowEdit_area'> <div class='edo-PowerOfAttorneyList_rowEdit_dates'> <span>"+t(e(rk("c")))+"</span> <component data-component='SBIS3.CONTROLS/Date/Picker' name='dp_DateFrom' class='edo-PowerOfAttorneyList_rowEdit_dateFrom'> <option name='date' bind='Дата'></option> <option name='mask'>DD.MM.YY</option> <option name='isCalendarIconShown'>false</option> <option name='enabled'>false</option> <option name='allowChangeEnable'>false</option> </component> <span>"+t(e(rk("по")))+"</span> <component data-component='SBIS3.CONTROLS/Date/Picker' name='dp_DateTo' class='edo-PowerOfAttorneyList_rowEdit_dateTo'> <option name='date' bind='Доверенность.Срок'></option> <option name='mask'>DD.MM.YYYY</option> <option name='isCalendarIconShown'>true</option> <options name='validators' type='array'> <options> <option name='validator' type='function'>js!SBIS3.EDO.PowerOfAttorneyList:prototype.validatorDateTo</option> </options> </options> <options name='handlers'> <option name='onInit' type='function'>js!SBIS3.EDO.PowerOfAttorneyList:prototype.onInitDpDateTo</option> <option name='onDateChange' type='function'>js!SBIS3.EDO.PowerOfAttorneyList:prototype.onDateChangeDpDateTo</option> </options> </component> </div> </div> </div> </div>");return(r=t(r))+(i&&-1!==r.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.PowerOfAttorneyList/resources/poaEditingTemplate"}},o});
define("html!SBIS3.EDO.PowerOfAttorneyList/resources/poaWithUserEditingTemplate",function(){var t=function(t){var o=function(){var t=/\{\{([\s\S]+?)\}\}/g;return function(o){for(;t.test(o);)o=o.replace(t,"&#123;&#123;$1&#125;&#125;");return o}}(),n=function(t){return t.join?t.join(""):t.toString()},e=function(t){return void 0===t?"":t&&"object"==typeof t?n(t):""+t},i="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,"<div class='edo-PowerOfAttorneyList_rowEdit'> <div class='edo-PowerOfAttorneyList_rowEdit_main'> <div class='edo-PowerOfAttorneyList_rowEdit_area'> <span class='edo-PowerOfAttorneyList_rowEdit_name'> <span title='' data-bind='html: ЛицоОтправителя.Фамилия, attr: {title: ЛицоОтправителя.Фамилия}'></span> <span title='' data-bind='html: ЛицоОтправителя.Имя, attr: {title: ЛицоОтправителя.Имя}'></span> <span title='' data-bind='html: ЛицоОтправителя.Отчество, attr: {title: ЛицоОтправителя.Отчество}'></span> </span> <div class='edo-PowerOfAttorneyList_rowEdit_dates edo-WhoIsEntitledToSign_rowEdit_padding'> <span>"+o(e(rk("c")))+"</span> <component data-component='SBIS3.CONTROLS/Date/Picker' name='dp_DateFrom' class='edo-PowerOfAttorneyList_rowEdit_dateFrom'> <option name='date' bind='Дата'></option> <option name='mask'>DD.MM.YY</option> <option name='isCalendarIconShown'>false</option> <option name='enabled'>false</option> <option name='allowChangeEnable'>false</option> </component> <span>"+o(e(rk("по")))+"</span> <component data-component='SBIS3.CONTROLS/Date/Picker' name='dp_DateTo' class='edo-PowerOfAttorneyList_rowEdit_dateTo'> <option name='date' bind='Доверенность.Срок'></option> <option name='mask'>DD.MM.YYYY</option> <option name='isCalendarIconShown'>true</option> <options name='validators' type='array'> <options> <option name='validator' type='function'>js!SBIS3.EDO.PowerOfAttorneyList:prototype.validatorDateTo</option> </options> </options> <options name='handlers'> <option name='onInit' type='function'>js!SBIS3.EDO.PowerOfAttorneyList:prototype.onInitDpDateTo</option> <option name='onDateChange' type='function'>js!SBIS3.EDO.PowerOfAttorneyList:prototype.onDateChangeDpDateTo</option> </options> </component> </div> </div> </div> </div>");return(a=o(a))+(i&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return t.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.PowerOfAttorneyList/resources/poaWithUserEditingTemplate"}},t});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.PowerOfAttorneyList", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-PowerOfAttorneyList{position:relative;height:auto}.edo-PowerOfAttorneyList_facsimile{position:absolute;right:8px;top:-8px}.edo-PowerOfAttorneyList_controls{margin:16px 8px 8px 8px;position:relative}.edo-PowerOfAttorneyList_leader{height:48px;margin-right:116px}.edo-PowerOfAttorneyList_leader_field .edo-DelegateStaffChoice_mainEmpty{width:474px!important}.edo-PowerOfAttorneyList_confirmer{height:38px;margin-right:116px}.edo-PowerOfAttorneyList_canSign{height:54px}.edo-PowerOfAttorneyList_canSign_caption{float:left;margin-right:12px;font-size:14px;line-height:24px}.edo-PowerOfAttorneyList_active{height:26px;clear:both}.edo-PowerOfAttorneyList_active_caption{float:left;color:#313e78;font-size:18px;font-weight:700}.edo-PowerOfAttorneyList_active_linkAdd{float:left;margin:0 0 0 12px}.edo-PowerOfAttorneyList_active_switcher{float:right}.edo-PowerOfAttorneyList_active_switcher .controls-SwitcherDouble__toggle{margin:0 3px!important}.edo-PowerOfAttorneyList_list{width:100%;height:auto;margin-top:16px}.edo-PowerOfAttorneyList_list_browser{margin:0;min-height:37px}.edo-PowerOfAttorneyList_list_browser .controls-ItemsToolbar{bottom:0!important}.edo-PowerOfAttorneyList_rowMain{font-size:14px}.edo-PowerOfAttorneyList_rowFilial{height:22px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.edo-PowerOfAttorneyList_rowFilial_name{line-height:24px;font-weight:700;color:#000;font-size:14px}.edo-PowerOfAttorneyList_rowFilial_link{color:#000;font-weight:700}.edo-PowerOfAttorneyList_row{width:100%;height:37px}.edo-PowerOfAttorneyList_row_photo{width:34px;height:34px;padding:4px 0 0 3px;float:left}.edo-PowerOfAttorneyList_row_additional{width:136px;float:right}.edo-PowerOfAttorneyList_row_ends{height:20px;color:#fec63f;font-size:12px;text-align:right}.edo-PowerOfAttorneyList_row_ends_ico{position:relative;top:2px}.edo-PowerOfAttorneyList_row_ends_caption{margin-right:4px}.edo-PowerOfAttorneyList_row_cert{height:17px;text-align:right}.edo-PowerOfAttorneyList_row_cert_link{color:#ef463a;height:17px;line-height:17px;display:block}.edo-PowerOfAttorneyList_row_user{height:37px}.edo-PowerOfAttorneyList_row_half{white-space:nowrap}.edo-PowerOfAttorneyList_row_delim{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;height:17px;line-height:17px;font-size:12px}.edo-PowerOfAttorneyList_mainRow_noTrust{color:#ef463a;width:136px;height:20px;padding-top:20px;float:right;vertical-align:bottom;text-align:center}.edo-PowerOfAttorneyList_mainRow_noTrust:hover{text-decoration:underline}.edo-PowerOfAttorneyList_mainRow_name{max-width:100%;display:inline-block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;vertical-align:middle}.edo-PowerOfAttorneyList_rowPOA{margin-left:44px;height:37px}.edo-PowerOfAttorneyList_rowPOA_main{height:37px;margin:0 136px 0 0}.edo-PowerOfAttorneyList_rowPOA_dates{white-space:nowrap;height:20px}.edo-PowerOfAttorneyList_mainRow_dates{display:inline-block;vertical-align:middle}.edo-PowerOfAttorneyList_mainRow_dateUntil{display:inline-block;position:relative;margin-left:4px}.edo-PowerOfAttorneyList_mainRow_post{font-size:12px!important;height:20px;width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.edo-PowerOfAttorneyList_row_inline{display:inline-block}.edo-PowerOfAttorneyList_row_disabled{color:#999}.edo-PowerOfAttorneyList_row_withPhoto{margin:0 0 0 43px}.edo-PowerOfAttorneyList_row_withPhoto_leaf{margin:0 0 0 43px}.edo-PowerOfAttorneyList_row_withPhotoAndNoTrust{margin:0 136px 0 43px}.edo-PowerOfAttorneyList_row_withPhotoAndNoTrust_leaf{margin:0 136px 0 43px}.edo-PowerOfAttorneyList_row_withDates{padding-right:150px;height:20px}.edo-PowerOfAttorneyList_row_withDatesAndAccess{padding-right:334px;height:20px}.edo-PowerOfAttorneyList_row_black{color:#000}.edo-PowerOfAttorneyList_row_gray{color:#999}.edo-PowerOfAttorneyList_row_lightGray{color:#ccc}.edo-PowerOfAttorneyList_row_onlyDates{margin-right:-150px;width:150px}.edo-PowerOfAttorneyList_row_withAccess{margin-right:-334px;width:334px}.edo-PowerOfAttorneyList_rowEdit{background-color:transparent;height:37px}.edo-PowerOfAttorneyList_rowEdit_main{padding-left:48px;height:24px}.edo-PowerOfAttorneyList_rowEdit_main_leaf{padding-left:30px;height:24px}.edo-PowerOfAttorneyList_rowEdit_dateFrom .controls-TextBox__field{padding:0!important}.edo-PowerOfAttorneyList_rowEdit_area{background-color:#f3f3f3;padding-right:244px;line-height:26px}.edo-PowerOfAttorneyList_rowEdit_name{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;float:left;max-width:100%}.edo-PowerOfAttorneyList_rowEdit_dates{color:#999;margin-right:-174px;display:inline-block}.edo-WhoIsEntitledToSign_rowEdit_padding{padding-left:4px}.edo-PowerOfAttorneyList_rowEdit_dateFrom .controls-DatePicker__fieldWrapper{padding:0!important}"));head.appendChild(style);});}
define("html!SBIS3.EDO.DelegateStaffChoice",function(){var e=function(e){var o=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(o){for(;e.test(o);)o=o.replace(e,"&#123;&#123;$1&#125;&#125;");return o}}(),n=function(e){return e.join?e.join(""):e.toString()},t=function(e){return void 0===e?"":e&&"object"==typeof e?n(e):""+e},i="undefined"!=typeof process,a=("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),p="<div class='edo-DelegateStaffChoice'> <div class='edo-DelegateStaffChoice_caption'> <component data-component='SBIS3.CONTROLS/Link' name='linkChooseLeader' class='edo-DelegateStaffChoice_userLinkBtn'> <option name='caption'>Руководитель</option> <option name='tabindex'>1</option> </component> </div> <component data-component='SBIS3.Staff.Choice' name='scLeader' class='edo-DelegateStaffChoice_mainEmpty'> <option name='entityType'>ЧастноеЛицо</option> <option name='organization' bind='record/@Лицо' oneWay='true' direction='fromContext' nonexistent='-1'></option> <option name='selectionType'>leaf</option> <option name='multiselect'>false</option> <option name='placeholder'>Укажите ФИО</option> <options name='selectedKeys' type='array'> <option bind='record/НашаОрганизация.Руководитель'/> </options> <option name='selectedItems' type='ref'>"+o(t(function(e,o){var n=a.randomId();return e[n]=o,n}(function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,e.leader)))+"</option> <options name='handlers'> <option name='onInit' type='function'>js!SBIS3.EDO.DelegateStaffChoice:prototype.onInitScLeader</option> </options> <option name='showOurCompany'>false</option> <option name='showOrgChoose'>false</option> <option name='tabindex'>2</option> <option name='pickerClassName'>edo-DelegateStaffChoice_mainEmpty_picker</option> <option name='visible'>"+o(t(!e.leader))+"</option> </component> <div class='edo-DelegateStaffChoice_mainSelect ";return e.leader||(p+="ws-hidden"),p+="'> <div class='edo-DelegateStaffChoice_photoContainer'> <component data-component='SBIS3.Person.PersonPhoto' name='scPhoto' class='edo-DelegateStaffChoice_photo'> <options name='data' bind='leaderPhotoData' oneWay='true' direction='fromContext'> ",e.leader&&(p+=" <option name='personId'>"+o(t(e.leader.at(0).get("Лицо")))+"</option> <option name='photoId'>"+o(t(e.leader.at(0).get("ФотоБольшое")))+"</option> "),p+=" </options> <options name='settingsView'> <option name='size'>34</option> </options> </component> </div> <div class='edo-DelegateStaffChoice_selectLinkContainer'> <div class='edo-DelegateStaffChoice_fieldContainer edo-DelegateStaffChoice_fieldContainer_onlyDel'> <div class='edo-DelegateStaffChoice_nameContainer'> <component data-component='SBIS3.CONTROLS/Link' name='linkNameLeader' class='edo-DelegateStaffChoice_linkSelect controls-Button__ellipsis'> <option name='caption' bind='leaderFIO' oneWay='true' direction='fromContext'>",e.leader&&(p+=o(t(e.leader.at(0).get("Название")))),p+="</option> <option name='tabindex'>3</option> <options name='handlers'> <option name='onActivated' type='function'>js!SBIS3.EDO.DelegateStaffChoice:prototype.onActivatedLinkNameLeader</option> </options> <option name='allowChangeEnable'>false</option> <option name='enabled'>true</option> </component> <div class='edo-DelegateStaffChoice_icoContainer edo-DelegateStaffChoice_icoContainer_onlyDel'> <component data-component='SBIS3.CONTROLS/Button/IconButton' name='linkRemoveLink' class='edo-DelegateStaffChoice_destroyLink'> <option name='icon'>sprite:icon-16 icon-Close icon-disabled action-hover</option> <option name='tabindex'>4</option> <options name='handlers'> <option name='onActivated' type='function'>js!SBIS3.EDO.DelegateStaffChoice:prototype.onActivatedLinkRemoveLink</option> </options> </component> <component data-component='SBIS3.CONTROLS/Button/IconButton' name='linkSign' class='edo-DelegateStaffChoice_signSelect'> <option name='icon'>sprite:icon-16 icon-Signature icon-primary action-hover</option> <option name='tabindex'>5</option> <options name='handlers'> <option name='onActivated' type='function'>js!SBIS3.EDO.DelegateStaffChoice:prototype.onActivatedLinkSign</option> </options> <option name='enabled'>true</option> <option name='allowChangeEnable'>false</option> <option name='visible'>false</option> </component> </div> </div> </div> <div class='edo-DelegateStaffChoice_postContainer'> <span>("+o(t(rk("обладает правом первой подписи")))+")</span> </div> </div> </div> </div>",(p=o(p))+(i&&-1!==p.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.DelegateStaffChoice"}},e});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.DelegateStaffChoice", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-DelegateStaffChoice{width:100%;font-size:14px;font-family:TensorFont,sans-serif;vertical-align:top}.edo-DelegateStaffChoice_caption{float:left;height:40px}.edo-DelegateStaffChoice_userLinkBtn{margin-right:8px;color:#999}.edo-DelegateStaffChoice_mainEmpty{float:left;width:470px}.edo-DelegateStaffChoice_mainEmpty_picker{max-width:472px}.edo-DelegateStaffChoice_mainSelect{margin:0 0 0 92px;max-height:48px;overflow:hidden}.edo-DelegateStaffChoice_photoContainer{width:38px;height:40px;float:left}.edo-DelegateStaffChoice_photo{margin:5px 0 3px 0}.edo-DelegateStaffChoice_selectLinkContainer{height:40px;margin:0 0 0 38px}.edo-DelegateStaffChoice_fieldContainer{height:24px;padding-right:48px;white-space:nowrap}.edo-DelegateStaffChoice_fieldContainer_onlyDel{padding-right:24px!important}.edo-DelegateStaffChoice_icoContainer{margin-right:-48px;display:inline-block;width:48px}.edo-DelegateStaffChoice_icoContainer_onlyDel{margin-right:-24px!important}.edo-DelegateStaffChoice_linkSelect{max-width:100%;float:left;color:#000!important;font-weight:700;height:24px}.ws-button-link.ws-disabled{color:#ccc!important}.edo-DelegateStaffChoice_bold{font-weight:700}.edo-DelegateStaffChoice_signSelect{margin:4px 0 4px 4px}.edo-DelegateStaffChoice_organizationContainer{height:24px;line-height:24px;color:#999;margin-left:4px}.edo-DelegateStaffChoice_destroyLink{margin:4px 0 4px 4px}.edo-DelegateStaffChoice_postContainer{width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;height:16px;line-height:14px;font-size:12px;color:#999}"));head.appendChild(style);});}
define('js!SBIS3.EDO.DelegateStaffChoice',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.DelegateStaffChoice','WS.Data/Source/SbisService','Core/moduleStubs','js!SBIS3.Staff.Employee','Core/CommandDispatcher','css!SBIS3.EDO.DelegateStaffChoice','js!SBIS3.Staff.Choice','js!SBIS3.Person.PersonPhoto','SBIS3.CONTROLS/Link','SBIS3.CONTROLS/Button/IconButton','Doverennosti_localization'],function(e,t,n,o,a,l){var i=e.extend({$protected:{_options:{leader:null}},_dotTplFn:t,_controls:{},$constructor:function(){var e=this.getLinkedContext();e.setValue('leaderFIO',''),e.setValue('leaderPhotoData',{personId:null,photoId:null});},init:function(){i.superclass.init.call(this);var e=this,t=e.getChildControlByName('scLeader'),n=e.getChildControlByName('linkChooseLeader');e._controls={chooseLink:n,leaderField:t,nameLink:e.getChildControlByName('linkNameLeader'),removeLink:e.getChildControlByName('linkRemoveLink'),signLink:e.getChildControlByName('linkSign')},e.setEnabledLeader(),e.subscribeTo(n,'onActivated',function(t){e._controls.leaderField.sendCommand('showSelector');}),e.subscribeTo(t,'onSelectedItemsChange',function(t,n,o){var a=this,i=a.getContext(),r=n[0]||null;if(a._previousLink!==r)a._previousLink=r,i.setValue('record/НашаОрганизация.Руководитель',r),l.sendCommand(a,'updateOrgRecord');e.changeView(r);});},setEnabled:function(e){var t=this,n=t.getParent().isEnabled(),o=!!e&&n;if(t._controls.chooseLink)t._controls.chooseLink.setEnabled(o);if(t._controls.leaderField)t._controls.leaderField.setEnabled(o);if(t._controls.removeLink)if(t._controls.removeLink.setEnabled(o),o)t._controls.removeLink.show();else t._controls.removeLink.hide();},setEnabledLeader:function(){var e=this.getLinkedContext();if('"Предприниматель"'===e.getValue('record/Контрагент_')){var t=e.getValue('record/Название'),n=(t?t.split(', '):[])[0]||'',o=(e.getValue('record/Руководитель.Фамилия')||'')+' '+(e.getValue('record/Руководитель.Имя')||'')+' '+(e.getValue('record/Руководитель.Отчество')||'');if(n=n.replace(/\s+/g,' '),n=n.trim(),o=o.replace(/\s+/g,' '),o=o.trim(),n!==o)this.setEnabled(true);else this.setEnabled(false);}else this.setEnabled(true);},changeView:function(e){var t=this;t.waitChildControlByName('scLeader').addCallback(function(o){var a=o,l=e,i=a.getSelectedItems(),r=i&&i.at(0)||null,d=t.getLinkedContext(),s=t.getContainer(),c=d.getValue('record/@Лицо'),u=s.find('.edo-DelegateStaffChoice_mainEmpty'),C=s.find('.edo-DelegateStaffChoice_mainSelect'),g,f,h;if(r)d.setValue('leaderFIO',r&&(r.get('НазваниеПолное')||r.get('Название'))||''),d.setValue('leaderPhotoData',{personId:l||null,photoId:r&&(r.get('Фото')||r.get('ФотоБольшое'))||null});else a.getSelectedItems(true).addCallback(function(e){var t=e&&e.getCount()>0?e.at(0):null,n=t?(t.get('Фамилия')||'')+' '+(t.get('Имя')||'')+' '+(t.get('Отчество')||''):'';d.setValue('leaderFIO',n),d.setValue('leaderPhotoData',{personId:l||null,photoId:l&&t&&(t.get('Фото')||t.get('ФотоБольшое'))||null});}).addErrback(function(e){d.setValue('leaderFIO',''),d.setValue('leaderPhotoData',{personId:null,photoId:null});});if(t.setEnabledLeader(),c&&l)g=s.find('.edo-DelegateStaffChoice_fieldContainer'),f=s.find('.edo-DelegateStaffChoice_icoContainer'),(h=new n({endpoint:{contract:'Доверенность'}})).call('НаличиеЭП',{'ЧастноеЛицо':l,'Контрагент':d.getValue('record/@Лицо')}).addCallback(function(e){if(e.getRawData())t._controls.signLink.show(),g.removeClass('edo-DelegateStaffChoice_fieldContainer_onlyDel'),f.removeClass('edo-DelegateStaffChoice_icoContainer_onlyDel');else{if(t._controls.signLink)t._controls.signLink.hide();g.addClass('edo-DelegateStaffChoice_fieldContainer_onlyDel'),f.addClass('edo-DelegateStaffChoice_icoContainer_onlyDel');}}).addErrback(function(e){if(t._controls.signLink)t._controls.signLink.hide();g.addClass('edo-DelegateStaffChoice_fieldContainer_onlyDel'),f.addClass('edo-DelegateStaffChoice_icoContainer_onlyDel');}),u.addClass('ws-hidden'),C.removeClass('ws-hidden');else u.removeClass('ws-hidden'),C.addClass('ws-hidden');});},onInitScLeader:function(e){var t=this,n=t.getParentByClass('SBIS3.EDO.DelegateStaffChoice'),o=t.getContext().getValue('record/НашаОрганизация.Руководитель')||null;if(this._previousLink=o,o)n.changeView(o);},onActivatedLinkNameLeader:function(e){var t=this,n=this.getParent().getLinkedContext();a.editByFace(n.getValue('record/НашаОрганизация.Руководитель'),t,{},n.getValue('record/НашаОрганизация.@Лицо'));},onActivatedLinkRemoveLink:function(e){this.getLinkedContext().setValue('record/НашаОрганизация.Руководитель',null);},onActivatedLinkSign:function(e){var t=this.getParent(),n=t.getLinkedContext();o.require(['Deprecated/BLObject','js!SBIS3.CRYPTO.CryptoDialogs']).addCallback(function(e){var o=e[0],a=e[1];new o('Доверенность').call('ПолучитьИнформациюОбЭП',{'ЧастноеЛицо':n.getValue('record/НашаОрганизация.Руководитель'),'Контрагент':n.getValue('record/НашаОрганизация.@Лицо')},o.RETURN_TYPE_RECORDSET).addCallback(function(e){a.showDigitalSignatures(e,t);});});}});return i;});
define("html!SBIS3.EDO.PowerOfAttorneyList/resources/mainCellTemplate",function(){var o=function(o){var t=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;o.test(t);)t=t.replace(o,"&#123;&#123;$1&#125;&#125;");return t}}(),e=function(o){return o.join?o.join(""):o.toString()},i=function(o){return void 0===o?"":o&&"object"==typeof o?e(o):""+o},n="undefined"!=typeof process,r=("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),s=function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,a="<div class='edo-PowerOfAttorneyList_rowMain'> ",d=parseInt(o.item.get("@Документ"),10);if(a+=" ",d<0){a+=" ";var l=o.item.get("ЭтоФилиалПапка"),_=o.item.get("Филиал.Название")||"",c=o.item.get("ФилиалДействующий");if(a+=" <div class='edo-PowerOfAttorneyList_rowFilial'> ",l)a+=" <span class='edo-PowerOfAttorneyList_rowFilial_name ",c||(a+="edo-PowerOfAttorneyList_row_disabled"),a+="' title='"+t(i(_))+"'> "+t(i(_))+" </span> ";else{a+=" ";var w=o.item.get("Доверенность.МестоОсуществленияПолномочий");a+=" <component data-component='SBIS3.CONTROLS/Link' name='"+t(i("linkFilial_"+w))+"' class='edo-PowerOfAttorneyList_rowFilial_link'> <option name='caption'>"+t(i(_))+"</option> <option name='idFilial'>"+t(i(w))+"</option> <options name='handlers'> <option name='onActivated' type='function'>js!SBIS3.EDO.PowerOfAttorneyList:prototype.onActivatedLinkFilial</option> </options> <option name='enabled'>"+t(i(c))+"</option> </component> "}a+=" </div> "}else{a+=" ";var p=!o.item.get("ЕстьПодпись"),f=o.item.get("Доверенность.ЛицоОтправителя"),m=o.item.get("Доверенность.Отправитель"),v=(o.item.get("ЛицоОтправителя.Фамилия")||"")+" "+(o.item.get("ЛицоОтправителя.Имя")||"")+" "+(o.item.get("ЛицоОтправителя.Отчество")||""),y=o.item.get("НетДоступа"),O=y?"edo-PowerOfAttorneyList_row_withDatesAndAccess":"edo-PowerOfAttorneyList_row_withDates",A=o.item.get("Доверенность.Срок"),L=A&&new Date>new Date(A),P=L||y?"edo-PowerOfAttorneyList_row_lightGray":"edo-PowerOfAttorneyList_row_black",g=L||y?"edo-PowerOfAttorneyList_row_lightGray":"edo-PowerOfAttorneyList_row_gray",u=o.item.get("Дата"),S=u?u.strftime(rk("с")+" %d.%m.%y"):"",h=A?A.strftime(rk("по")+" %d.%m.%y"):"",k=o.item.get("РП.НазваниеСтруктуры")||"",D=o.item.get("РП.Должность")||"",B=k+(k&&D?" / ":"")+D,I=new Date,j=y?"edo-PowerOfAttorneyList_row_datesWithAccess":"edo-PowerOfAttorneyList_row_onlyDates",C=A?Math.floor((A.getTime()-I.getTime())/864e5)+1:0,R=C>0&&C<=30,F=p||R?"edo-PowerOfAttorneyList_row_withPhotoAndNoTrust_leaf":"edo-PowerOfAttorneyList_row_withPhoto_leaf";if(a+=" ",o.ladder.isPrimary(o.item,"Доверенность.ЛицоОтправителя")){if(a+=" <div class='edo-PowerOfAttorneyList_row'> <div class='edo-PowerOfAttorneyList_row_photo'> <component data-component='SBIS3.Person.PersonsCollage'> <option name='data' type='ref'>"+t(i(function(o,t){var e=r.randomId();return o[e]=t,e}(s,o.item.get("userPhotoData"))))+"</option> <options name='settings'> <option name='size'>34</option> </options> </component> </div> ",p||R){a+=" ";T="linkUser_"+d;a+=" <div class='edo-PowerOfAttorneyList_row_additional'> <div class='edo-PowerOfAttorneyList_row_ends'> ",R&&(a+=" <i class='edo-PowerOfAttorneyList_row_ends_ico controls-Button__icon js-controls-Button__icon icon-16 icon-Sandclock icon-attention'></i> <span class='edo-PowerOfAttorneyList_row_ends_caption'>"+t(i(o.item.getStringDaysLeft()))+"</span> "),a+=" </div> <div class='edo-PowerOfAttorneyList_row_cert'> ",p&&(a+=" <component data-component='SBIS3.CONTROLS/Link' name='"+t(i(T))+"' class='edo-PowerOfAttorneyList_row_cert_link'> <option name='caption'>"+t(i(rk("Нет действующей ЭП")))+"</option> <option name='idFaceSender'>"+t(i(f))+"</option> <option name='idOrgSender'>"+t(i(m))+"</option> <options name='handlers'> <option name='onActivated' type='function'>js!SBIS3.EDO.PowerOfAttorneyList:prototype.onActivatedLinkUser</option> </options> </component> "),a+=" </div> </div> "}a+=" <div class='edo-PowerOfAttorneyList_row_user "+t(i(F))+" "+t(i(g))+"'> <div class='edo-PowerOfAttorneyList_row_half "+t(i(O))+"'> <div class='edo-PowerOfAttorneyList_mainRow_name "+t(i(P))+"'> <span title='"+t(i(v))+"'>"+t(i(v))+"</span> </div> <div class='edo-PowerOfAttorneyList_mainRow_dates "+t(i(j))+"'> <div class='edo-PowerOfAttorneyList_row_inline'> <span>"+t(i(S))+"</span> </div> <div class='edo-PowerOfAttorneyList_mainRow_dateUntil'> <span>"+t(i(h))+"</span> <div class='edo-PowerOfAttorneyList_divEditAtPlace'></div> </div> ",y&&(a+=" <div class='edo-PowerOfAttorneyList_row_inline'> <span>("+t(i(rk("не может входить в систему")))+")</span> </div> "),a+=" </div> </div> <div class='edo-PowerOfAttorneyList_row_half edo-PowerOfAttorneyList_row_delim'> <span>"+t(i(B))+"</span> </div> </div> </div> "}else{if(a+=" <div class='edo-PowerOfAttorneyList_rowPOA "+t(i(P))+"'> ",p||R){a+=" ";var T="linkUser_"+d;a+=" <div class='edo-PowerOfAttorneyList_row_additional'> <div class='edo-PowerOfAttorneyList_row_ends'> ",R&&(a+=" <i class='edo-PowerOfAttorneyList_row_ends_ico controls-Button__icon js-controls-Button__icon icon-16 icon-Sandclock icon-attention'></i> <span class='edo-PowerOfAttorneyList_row_ends_caption'>"+t(i(o.item.getStringDaysLeft()))+"</span> "),a+=" </div> <div class='edo-PowerOfAttorneyList_row_cert'> ",p&&(a+=" <component data-component='SBIS3.CONTROLS/Link' name='"+t(i(T))+"' class='edo-PowerOfAttorneyList_row_cert_link'> <option name='caption'>"+t(i(rk("Нет действующей ЭП")))+"</option> <option name='idFaceSender'>"+t(i(f))+"</option> <option name='idOrgSender'>"+t(i(m))+"</option> <options name='handlers'> <option name='onActivated' type='function'>js!SBIS3.EDO.PowerOfAttorneyList:prototype.onActivatedLinkUser</option> </options> </component> "),a+=" </div> </div> "}a+=" <div class='edo-PowerOfAttorneyList_rowPOA_main'> <div class='edo-PowerOfAttorneyList_rowPOA_dates'> <div class='edo-PowerOfAttorneyList_mainRow_dates'> <div class='edo-PowerOfAttorneyList_row_inline'> <span>"+t(i(S))+"</span> </div> <div class='edo-PowerOfAttorneyList_mainRow_dateUntil'> <span>"+t(i(h))+"</span> <div class='edo-PowerOfAttorneyList_divEditAtPlace'></div> </div> ",y&&(a+=" <div class='edo-PowerOfAttorneyList_row_inline'> <span>("+t(i(rk("не может входить в систему")))+")</span> </div> "),a+=" </div> </div> <div class='edo-PowerOfAttorneyList_mainRow_post "+t(i(g))+"'> <span>"+t(i(B))+"</span> </div> </div> </div> "}a+=" "}return a+=" </div>",(a=t(a))+(n&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.PowerOfAttorneyList/resources/mainCellTemplate"}},o});
define("html!SBIS3.EDO.ConfirmerStaffChoice",function(){var o=function(o){var n=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;o.test(n);)n=n.replace(o,"&#123;&#123;$1&#125;&#125;");return n}}(),e=function(o){return o.join?o.join(""):o.toString()},i=function(o){return void 0===o?"":o&&"object"==typeof o?e(o):""+o},t="undefined"!=typeof process,r=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,"<div class='edo-ConfirmerStaffChoice ws-flexbox'> <div class='edo-ConfirmerStaffChoice_caption ws-flex-shrink-0'> <span>"+n(i(rk("Подтвердить получение входящих документов может")))+"</span> </div> <div class='edo-ConfirmerStaffChoice_linkContent'> <div class='edo-ConfirmerStaffChoice_content'> <div class='edo-ConfirmerStaffChoice_limiter'> <div> <component data-component='SBIS3.CONTROLS/Link' name='linkNameConfirmer' class='edo-ConfirmerStaffChoice_linkName controls-Button__ellipsis'> <option name='caption' bind='confirmerName' oneWay='true' direction='fromContext'></option> <option name='clickThrottle'>true</option> <option name='tabindex'>1</option> </component> <div class='edo-ConfirmerStaffChoice_buttons'> <component data-component='SBIS3.CONTROLS/Link' name='linkRemoveLink' class='edo-ConfirmerStaffChoice_destroyLink'> <option name='icon'>sprite:icon-16 icon-Close icon-disabled action-hover</option> <option name='clickThrottle'>true</option> <option name='tabindex'>2</option> </component> </div> </div> </div> </div> </div> <component data-component='SBIS3.Staff.Choice' name='scConfirmer'> <option name='entityType'>Лицо</option> <option name='organization' bind='НашаОрганизация.@Лицо' oneWay='true' direction='fromContext' nonexistent='-1'></option> <option name='selectionType'>all</option> <option name='multiselect'>false</option> <options name='selectedKeys' type='array'> <option bind='"+n(i(o.confirmerField))+"'/> </options> <options name='handlers'> <option name='onInit' type='function'>js!SBIS3.EDO.ConfirmerStaffChoice:prototype._onInitScConfirmer</option> </options> <option name='showOurCompany'>false</option> <option name='showOrgChoose'>true</option> <option name='visible'>false</option> </component> </div>");return(r=n(r))+(t&&-1!==r.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.ConfirmerStaffChoice"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.ConfirmerStaffChoice", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-ConfirmerStaffChoice{font-size:14px;font-family:TensorFont,sans-serif;vertical-align:top}.edo-ConfirmerStaffChoice_caption{float:left;text-align:left;height:24px;line-height:24px;color:#000}.edo-ConfirmerStaffChoice_linkContent{margin-left:4px;overflow:hidden}.edo-ConfirmerStaffChoice_content{height:24px;margin:0}.edo-ConfirmerStaffChoice_limiter{height:24px;padding-right:24px;white-space:nowrap}.edo-ConfirmerStaffChoice_buttons{margin-right:-24px;display:inline-block}.edo-ConfirmerStaffChoice_linkName{color:#999;max-width:100%;float:left;height:24px}.edo-ConfirmerStaffChoice_destroyLink{height:24px;width:24px;font-size:14px!important;margin-top:1px}"));head.appendChild(style);});}
define('js!SBIS3.EDO.ConfirmerStaffChoice',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.ConfirmerStaffChoice','WS.Data/Entity/Record','Core/CommandDispatcher','css!SBIS3.EDO.ConfirmerStaffChoice','js!SBIS3.Staff.Choice','SBIS3.CONTROLS/Link','Doverennosti_localization'],function(e,t,n,i){var o=e.extend({_dotTplFn:t,$protected:{_options:{confirmerField:'record/НашаОрганизация.ПодтверждаетПолучениеДокументов'}},$constructor:function(){this.getLinkedContext().setValue('confirmerName',''),i.declareCommand(this,'changeViewLink',this._changeViewLink);},init:function(){o.superclass.init.call(this);var e=this;e.waitChildControlByName('linkNameConfirmer').addCallback(function(t){t.subscribeTo(t,'onActivated',function(t){e.getChildControlByName('scConfirmer').sendCommand('showSelector');});}),e.waitChildControlByName('linkRemoveLink').addCallback(function(t){t.subscribeTo(t,'onActivated',function(t){e.getLinkedContext().setValue(e._options.confirmerField,null);});}),e.waitChildControlByName('scConfirmer').addCallback(function(t){t.subscribeTo(t,'onSelectedItemsChange',function(t,i,o){var a=e.getContext(),r=i[0]||null,c=e._options.confirmerField,s;if(this._previousLink!==r){if(this._previousLink=r,-1!==c.indexOf('record/'))a.setValue(c,r);else(s=new n({adapter:'adapter.sbis',format:[{name:'@Лицо',type:'integer'},{name:'НашаОрганизация.ПодтверждаетПолучениеДокументов',type:'integer'}]})).set({'@Лицо':this.getContext().getValue('@Лицо'),'НашаОрганизация.ПодтверждаетПолучениеДокументов':r});this.sendCommand('updateOrgRecord',s),this.sendCommand('changeViewLink');}});});},_changeViewLink:function(){var e=this,t=e.getLinkedContext(),n=rk('любой сотрудник');e.waitChildControlByName('scConfirmer').addCallback(function(i){var o=i.getSelectedItems();e.waitChildControlByName('linkRemoveLink').addCallback(function(e){if(o&&o.at(0))if(o&&o.getCount()>0)t.setValue('confirmerName',o.at(0).get('НазваниеКраткое')||''),e.show();else t.setValue('confirmerName',n),e.hide();else i.getSelectedItems(true).addCallback(function(i){var o=i&&i.getCount()>0?i.at(0):null,a=o?o.get('Название')||'':n;if(t.setValue('confirmerName',a),o)e.show();else e.hide();}).addErrback(function(i){t.setValue('confirmerName',n),e.hide();});});});},_onInitScConfirmer:function(e){this._previousLink=this.getSelectedKeys()[0]||null,this.sendCommand('changeViewLink');}});return o;});
define('js!SBIS3.EDO.PowerOfAttorneyList',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.PowerOfAttorneyList','WS.Data/Source/SbisService','js!SBIS3.Contragents.OurCardCommonFunctions','js!SBIS3.Staff.Employee','Deprecated/Controls/DialogConfirm/DialogConfirm','html!SBIS3.EDO.PowerOfAttorneyList/resources/poaEditingTemplate','html!SBIS3.EDO.PowerOfAttorneyList/resources/poaWithUserEditingTemplate','SBIS3.CONTROLS/Utils/InformationPopupManager','Core/CommandDispatcher','css!SBIS3.EDO.PowerOfAttorneyList','js!SBIS3.DigitalSignatures.Facsimile','js!SBIS3.EDO.DelegateStaffChoice','SBIS3.CONTROLS/Switcher/Double','js!SBIS3.Staff.Choice','SBIS3.CONTROLS/Button/IconButton','js!SBIS3.Person.PersonsCollage','html!SBIS3.EDO.PowerOfAttorneyList/resources/mainCellTemplate','SBIS3.CONTROLS/Tree/DataGridView','js!SBIS3.EDO2.OpenDialogAction','SBIS3.CONTROLS/FieldLink','SBIS3.CONTROLS/Date/Picker','js!SBIS3.EDO.ConfirmerStaffChoice','js!SBIS3.EDO2.PowerOfAttorneyListModel','i18n!SBIS3.EDO.PowerOfAttorneyList','Doverennosti_localization'],function(e,t,n,i,o,a,r,s,l,d){var c=e.extend({_dotTplFn:t,$protected:{_options:{filterOrgID:null,listItems:null,leader:null}},_hasSign:false,$constructor:function(){this.getContext().setValue('filterActive',true),d.declareCommand(this,'openEmployeeCard',this._commandOpenEmployeeCard),d.declareCommand(this,'openOurCard',this._commandOpenOurCard);},init:function(){c.superclass.init.call(this);var e=this;e.waitChildControlByName('powerOfAttorneyOpener').addCallback(function(t){t.subscribeTo(t,'onUpdateModel',function(t,n,i){e.getChildControlByName('tdPoAList').reload();});}),e.waitChildControlByName('linkAdd').addCallback(function(t){t.subscribeTo(t,'onActivated',function(t){e.getChildControlByName('powerOfAttorneyOpener').execute({itemType:null,filter:{'Доверенность.Доверитель':e.getLinkedContext().getValue('record/@Лицо'),'ВызовИзБраузера':true,'ФильтрРегламент':-1,'ФильтрДокументНашаОрганизация':-1}});});}),e.waitChildControlByName('tdPoAList').addCallback(function(t){t.subscribeTo(t,'onItemActivate',function(t,n){e.getChildControlByName('powerOfAttorneyOpener').execute({id:n.id,itemType:null});});});},_commandOpenEmployeeCard:function(e,t){o.editByFace(e,this,void 0,t,'Подписи');},_commandOpenOurCard:function(e){i.openOurCard(e,this,false);},isHasPowerOfAttorney:function(){return this._hasSign;},onInitSdCanSign:function(){var e=this.getLinkedContext().getValue('record/НашаОрганизация.ОграничиватьПраваПодписи');this._enabledCheckCanSign=e,this.setState(e?'off':'on');},onCheckedChangeSdCanSign:function(e,t){var n=this;if(n._enabledCheckCanSign){var i=!t,o=n.getLinkedContext(),r=i?rk('Внимание!')+'<br />'+rk('При переключении вступает в силу ограничение на подписание внешних документов только сотрудниками с явно выданным правом подписи!'):rk('Внимание!')+'<br />'+rk('При переключении снимаются все ограничения на подписание внешних документов!');new a({message:r,height:207,width:395,type:'alert',opener:n,buttons:[{caption:rk('Продолжить'),width:'110px',tabindex:2},{caption:rk('Отмена'),width:'90px',tabindex:1}],modal:true,handlers:{onConfirm:function(e,t){if(t&&'cancel'!==t)o.setValue('record/НашаОрганизация.ОграничиватьПраваПодписи',i),n.sendCommand('updateOrgRecord');else n._enabledCheckCanSign=false,n.setState(i?'on':'off');}}});}else n._enabledCheckCanSign=true;},onActivatedLinkFilial:function(){this.sendCommand('openOurCard',this._options.idFilial);},onActivatedLinkUser:function(){this.sendCommand('openEmployeeCard',this._options.idFaceSender,this._options.idOrgSender);},itemsSortMethodPOAList:function(e,t){var n=e.item.isNode(),i=t.item.isNode();if(n===i)return e.index>t.index?1:-1;else return i?-1:1;},onChangeHoveredItemPOAList:function(e,t,n){var i=this.getItemsActions().getItemsInstances(),o=t.record,a=parseInt(t.key,10),r=o?o.get('Доверенность.Срок'):null,s=new Date();if(!o||a<0)i['delete'].hide(),i['abort'].hide(),i['extend'].hide();else{if(o.get('Доверенность.Использовано'))if(i['delete'].hide(),r>s.setHours(23,59,59,999))i['abort'].show();else i['abort'].hide();else i['delete'].show(),i['abort'].hide();var l=r?Math.floor((r.getTime()-s.getTime())/86400000)+1:0;if(l>0&&l<=30)i['extend'].show();else i['extend'].hide();}},onBeginEditDgvList:function(e,t){var n=parseInt(t.get('@Документ'),10),i=t.get('Раздел'),o=null;if(null===i)if(n<0)if(n%2===0)o='filial';else o='user';else o='user_poa';else if(n<0)if(n%2===0)o='filial';else o='user';else if(i%2===0)o='user_poa';else o='poa';if('poa'===o)this.setEditingTemplate(r());else this.setEditingTemplate(s());},onAfterBeginEditDgvList:function(e,t){this._getItemsToolbar().hideItemsActions();},actionDeletePOA:function(e,t,n){this.deleteRecords(t);},actionAbortPOA:function(e,t,n){var i=this,o=n;l.showConfirmDialog({message:rk('Нельзя удалить доверенность на право подписи, использованную в работе.'),details:rk('Изменить срок действия доверенности?'),opener:i,hasCancelButton:false},function(){i.sendCommand('beginEdit',o);});},actionExtendPOA:function(e,t,i){var o=this,a=i.get('@Документ');if(i.get('Доверенность.Использовано'))l.showConfirmDialog({message:rk('Невозможно продлить использованную доверенность.'),details:rk('Будет создана копия доверенности с измененными сроками. Продолжить?'),opener:o,hasCancelButton:false},function(){if(a)new n({endpoint:'Доверенность'}).call('Продлить',{'ИдО':''+a,'Срок':1}).addCallback(function(e){o.reload();});else l.showMessageDialog({message:rk('Не найден идентификатор доверенности.'),details:rk('Пожалуйста, обратитесь к администратору.'),status:'error',opener:o});});else o.sendCommand('beginEdit',i).addCallback(function(e){var t=new Date(e.get('Доверенность.Срок')),n=new Date(t.setFullYear(t.getFullYear()+1));o._getEditInPlace().addCallback(function(e){e.getChildControlByName('dp_DateTo').setDate(n);}),o.sendCommand('commitEdit');});},onInitDpDateTo:function(){this._poaPrevDate=null,this.subscribeOnceTo(this,'onDateChange',function(e,t){this._poaPrevDate=t;});},onDateChangeDpDateTo:function(e,t){if(t)t.setHours(23,59,59,999);},validatorDateTo:function(){var e=this.getDate(),t=new Date(),n=this._poaPrevDate;if(e.setHours(23,59,59,999),!e)return rk('Поле обязательно для заполнения');else if(t>e)return rk('Дата окончания действия доверия должна быть позже или равна текущей дате.');else if(e>n&&this.getLinkedContext().getValue('Доверенность.Использовано'))return rk('Дата окончания действия доверия должна быть меньше ранее установленной даты.');return true;}});return c.dimensions={height:'auto'},c;});
define('js!SBIS3.EDO.AuthorizedToSign',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.AuthorizedToSign','Core/CommandDispatcher','Core/Indicator','WS.Data/Source/SbisService','css!SBIS3.EDO.AuthorizedToSign','SBIS3.CONTROLS/Link','SBIS3.CONTROLS/Tab/Control','js!SBIS3.EDO.PowerOfAttorneyList','SBIS3.CONTROLS/ScrollContainer','css!Lib/Control/FloatArea/FloatArea','Doverennosti_localization'],function(t,e,o,n,i){var r=t.extend({_dotTplFn:e,$protected:{_options:{record:null,listItems:null,leader:null}},$constructor:function(){o.declareCommand(this,'updateOrgRecord',this._updateOrgRecord),o.declareCommand(this,'closePage',function(){if('undefined'!==typeof thickClient&&thickClient.onRootFloatAreaClose&&'function'===typeof thickClient.onRootFloatAreaClose)thickClient.onRootFloatAreaClose();});},init:function(){r.superclass.init.call(this),this.subscribeTo(this,'onInitComplete',function(t){if('undefined'!==typeof thickClient&&thickClient.onShowPage&&'function'===typeof thickClient.onShowPage)thickClient.onShowPage();});},_updateOrgRecord:function(){var t=this.getLinkedContext().getValue('record'),e=new i({endpoint:{contract:'НашаОрганизация'},binding:{update:'Сохранить'},options:{updateOnlyChanged:true},idProperty:'@Лицо'});n.setMessage(rk('Сохранение')),e.update(t).addBoth(function(t){n.hide();});},getRecord:function(){return this.getLinkedContext().getValue('record');}});return r.dimensions={width:'900px',maxWidth:'900px',minWidth:'900px'},r;});
define("tmpl!SBIS3.EDO.DelegatePermissionsList",["Core/tmpl/js/tclosure","js!SBIS3.CONTROLS/CheckBox","js!SBIS3.CONTROLS/Tree/DataGridView","js!SBIS3.PersonCore.AProfile.DoublePanel.ExpandLink"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.CONTROLS/CheckBox"]=e[1],r["js!SBIS3.CONTROLS/Tree/DataGridView"]=e[2],r["js!SBIS3.PersonCore.AProfile.DoublePanel.ExpandLink"]=e[3];var i=function e(i,o,s,n,a){function l(){}var p=0,c=void 0!==t&&t?t:arguments[arguments.length-1];void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure"));var d={};a&&a.isSetts&&(d=a.fullContext||{});var m="string"==typeof s?s:"",S=void 0===r?void 0:r,g={id:[],def:void 0},u=c.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,i),P=this&&this.includedTemplates?this.includedTemplates:{},C=c.getMarkupGenerator(n);try{var y=C.joinElements([C.createTag("div",{class:"edo-DelegatePermissionsList"},[c.getter(i,["previewMode"])?C.createText(""):[C.createControl("wsControl","ws:SBIS3.CONTROLS/CheckBox",{handlers:{onInit:c.getTypeFunc(" js!SBIS3.EDO.DelegatePermissionsList:prototype._onInitTypeSelectCert ",{}),onCheckedChange:c.getTypeFunc(" js!SBIS3.EDO.DelegatePermissionsList:prototype._onCheckedChangeTypeSelectCert ",{})},name:"cbTypeSelectCert",caption:global.rk("При наличии нескольких подписей, сотрудник вправе выбирать, какую использовать."),threeState:!1,checked:!1,bindings:[{fieldName:"record/IsEditMode",propName:"enabled",propPath:[],fullPropName:"enabled",propPathStr:"",oneWay:!0,direction:"fromContext",bindNonExistent:!1}],enabled:void 0,esc:!1},{class:"edo-DelegatePermissionsList_selectCert",name:"cbTypeSelectCert",sbisname:"cbTypeSelectCert","data-access":"Конфигурация"},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:u},s,S,P,c.config,d)],C.createControl("wsControl","ws:SBIS3.CONTROLS/Tree/DataGridView",{itemsActions:[],itemsSortMethod:c.getTypeFunc(" js!SBIS3.EDO.DelegatePermissionsList:prototype._itemsSortMethodPermissionsList ",{}),filter:{"ЧастноеЛицо":void 0},dataSource:{options:{endpoint:{contract:"Документ",idProperty:"Идентификатор"},binding:{query:"СписокРазрешеноПодписывать"},model:"DelegatePermissionsListModel"},module:"WS.Data/Source/SbisService"},columns:[{title:global.rk("Данные"),cellTemplate:c.getter(i,["previewMode"])?"tmpl!SBIS3.EDO.DelegatePermissionsList/resources/smallCellTemplate":"tmpl!SBIS3.EDO.DelegatePermissionsList/resources/mainCellTemplate"}],name:"permissionsList",idProperty:"Идентификатор",displayProperty:"Название",parentProperty:"Раздел",emptyHTML:global.rk("Для подписания необходимо зарегистрировать или получить электронную подпись."),itemsDragNDrop:"",editArrow:!1,allowEnterToFolder:!1,ignoreLocalPageSize:!0,expand:!0,showHead:!1,multiselect:!1,partialPaging:!1,showPaging:!1,paging:"no",pageSize:c.getter(i,["previewMode"])?4:"",esc:!1,bindings:[{fieldName:""+c.getter(i,["faceIdFieldName"]),propName:"filter/ЧастноеЛицо",propPath:["ЧастноеЛицо"],fullPropName:"filter/ЧастноеЛицо",propPathStr:"ЧастноеЛицо",oneWay:!0,direction:"fromContext",bindNonExistent:!1}]},{class:"controls-ListView__hideCheckBoxes controls-ListView__withoutMarker         "+c.utils.escape(c.getter(i,["previewMode"])?"edo-DelegatePermissionsList_smallTree":"controls-DataGridView__hasSeparator"),name:"permissionsList",sbisname:"permissionsList"},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:u,internal:{__dirtyCheckingVars_1:c.getter(i,["previewMode"])?"tmpl!SBIS3.EDO.DelegatePermissionsList/resources/smallCellTemplate":"tmpl!SBIS3.EDO.DelegatePermissionsList/resources/mainCellTemplate"}},s,S,P,c.config,d),c.getter(i,["previewMode"])?[C.createControl("wsControl","ws:SBIS3.PersonCore.AProfile.DoublePanel.ExpandLink",{name:"pcExpandLink",caption:global.rk("Ещё")+"...",className:"edo-DelegatePermissionsList_expandLink",visible:!1},{name:"pcExpandLink",sbisname:"pcExpandLink"},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:u},s,S,P,c.config,d)]:C.createText("")],o,g,this)],m,g);g.def&&(y=C.chain(y,g,o),g=void 0)}catch(e){c.templateError("resources/Doverennosti/components/DelegatePermissionsList/DelegatePermissionsList.tmpl",e,i)}return y||""};return i.includedFunctions={},i.stable=!0,i.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.DelegatePermissionsList"}},i});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.DelegatePermissionsList", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-DelegatePermissionsList{width:100%}.edo-DelegatePermissionsList_caption{font-size:15px;font-weight:700;color:#313e78}.edo-DelegatePermissionsList_selectCert{margin:4px 8px 8px 24px}.edo-DelegatePermissionsList_smallTree .controls-ListView__EmptyData{padding:0 8px 8px 8px!important;font-size:14px;color:#999}.edo-DelegatePermissionsList_row{overflow:hidden}.edo-DelegatePermissionsList_row_rights{padding-left:16px}.edo-DelegatePermissionsList_linkOrg{color:#000!important;font-weight:700;text-align:left}.edo-DelegatePermissionsList_normalText{font-size:14px;line-height:24px;margin-right:4px}.edo-DelegatePermissionsList_errorCert{font-size:12px;line-height:24px;color:#999;margin-left:4px}.edo-DelegatePermissionsList_infoText{font-size:14px;line-height:24px;color:#999;margin-left:4px}.edo-DelegatePermissionsList_infoList{font-size:0;color:#999}.edo-DelegatePermissionsList_infoList_text{font-size:14px;line-height:24px}.edo-DelegatePermissionsList_linkPoaTrustSign{margin-left:4px}.edo-DelegatePermissionsList_linkTsTrustSign{margin-left:4px}.edo-DelegatePermissionsList_linkOrg_small{color:#313e78;font-weight:700;font-size:14px;text-align:left;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.edo-DelegatePermissionsList_infoText_small{font-size:12px;color:#999}.edo-DelegatePermissionsList_row_rights_small{padding-left:8px;font-size:14px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.edo-DelegatePermissionsList_expandLink{font-size:14px;margin:8px 12px;color:#05b;font-weight:400}.edo-DelegatePermissionsList_expandLink:hover{color:#313e78!important;text-decoration:underline}"));head.appendChild(style);});}
define("tmpl!SBIS3.EDO.DelegatePermissionsList/resources/mainCellTemplate",["Core/tmpl/js/tclosure","js!SBIS3.CONTROLS/Link"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],a={};a["js!SBIS3.CONTROLS/Link"]=e[1];var r=function e(r,i,s,o,n){function l(){}var g=0,p=void 0!==t&&t?t:arguments[arguments.length-1];void 0===p&&(eval("var thelpers = null;"),p=global.requirejs("View/Runner/tclosure"));var c={};n&&n.isSetts&&(c=n.fullContext||{});var m="string"==typeof s?s:"",d=void 0===a?void 0:a,T={id:[],def:void 0},u=p.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,r),v=this&&this.includedTemplates?this.includedTemplates:{},y=p.getMarkupGenerator(o);try{var D=y.joinElements([y.createTag("div",{class:"edo-DelegatePermissionsList_row"},[y.createTag("div",{class:"edo-DelegatePermissionsList_row_org"},[p.getter(r,["item","isLinkOrg"]).apply(p.getter(r,["item"]),[])?[y.createControl("wsControl","ws:SBIS3.CONTROLS/Link",{handlers:{onActivated:p.getTypeFunc(" js!SBIS3.EDO.DelegatePermissionsList:prototype._onActivatedLinkOrg ",{})},name:"linkOrg_"+p.getter(r,["item","getDataFromOrg"]).apply(p.getter(r,["item"]),["Лицо"]),caption:p.getter(r,["item","getDataFromOrg"]).apply(p.getter(r,["item"]),["Название"]),idOrgTrustSign:p.getter(r,["item","getDataFromOrg"]).apply(p.getter(r,["item"]),["Лицо"]),enabled:!0,allowChangeEnable:!1,esc:!1},{class:"edo-DelegatePermissionsList_linkOrg ws-additional-link",name:"linkOrg_"+p.getter(r,["item","getDataFromOrg"]).apply(p.getter(r,["item"]),["Лицо"]),sbisname:"linkOrg_"+p.getter(r,["item","getDataFromOrg"]).apply(p.getter(r,["item"]),["Лицо"])},{data:r,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:u},s,d,v,p.config,c)]:[y.createTag("span",{class:"edo-DelegatePermissionsList_linkOrg"},[y.createText(""+p.wrapUndef(p.utils.escape(p.getter(r,["item","getDataFromOrg"]).apply(p.getter(r,["item"]),["Название"]))))],{},T,this)],p.getter(r,["item","getInnKpp"]).apply(p.getter(r,["item"]),[])?[y.createTag("span",{class:"edo-DelegatePermissionsList_infoText"},[y.createText("("+p.wrapUndef(p.utils.escape(p.getter(r,["item","getInnKpp"]).apply(p.getter(r,["item"]),[])))+")")],{},T,this)]:y.createText(""),p.getter(r,["item","getDataFromOrg"]).apply(p.getter(r,["item"]),["Адрес"])?[y.createTag("span",{class:"edo-DelegatePermissionsList_infoText"},[y.createText(""+p.wrapUndef(p.utils.escape(p.getter(r,["item","getDataFromOrg"]).apply(p.getter(r,["item"]),["Адрес"]))))],{},T,this)]:y.createText("")],{},T,this),y.createTag("div",{class:"edo-DelegatePermissionsList_row_rights"},[p.getter(r,["item","getDataFromPOA"]).apply(p.getter(r,["item"]),["ТолькоТекст"])?[y.createTag("span",{class:"edo-DelegatePermissionsList_normalText"},[y.createText(""+p.wrapUndef(p.utils.escape(p.getter(r,["item","getDataFromPOA"]).apply(p.getter(r,["item"]),["Название"]))))],{},T,this),p.getter(r,["item","getDataFromPOA"]).apply(p.getter(r,["item"]),["НетСертификата"])?[y.createTag("span",{class:"edo-DelegatePermissionsList_errorCert"},[y.createText("("+global.rk("Нет действующей ЭП")+")")],{},T,this)]:y.createText("")]:p.getter(r,["item","getDataFromPOA"]).apply(p.getter(r,["item"]),["Идентификаторы"])&&p.getter(p.getter(r,["item","getDataFromPOA"]).apply(p.getter(r,["item"]),["Идентификаторы"]),["length"])>0?[y.createTag("span",{class:"edo-DelegatePermissionsList_normalText"},[y.createText(""+p.wrapUndef(p.utils.escape(p.getter(r,["item","getDataFromPOA"]).apply(p.getter(r,["item"]),["Название"]))))],{},T,this),y.createTag("span",{class:"edo-DelegatePermissionsList_infoList"},[y.createTag("span",{class:"edo-DelegatePermissionsList_infoList_text"},[y.createText("("+global.rk("по доверенности на право подписи"))],{},T,this),function(){for(var e=void 0,t=0;t<p.iterators.length&&!e;t++)p.iterators[t].is(p.utils.escape(p.getter(r,["item","getDataFromPOA"]).apply(p.getter(r,["item"]),["Идентификаторы"])))&&(e=p.iterators[t].iterator);var a=[];return function(){var t=p.createScope(r);if(r=t,e){var i=s,n=0;e(p.utils.escape(p.getter(r,["item","getDataFromPOA"]).apply(p.getter(r,["item"]),["Идентификаторы"])),function(e,t){p.presetScope(e,r,t,{key:"key",value:"value"}),s&&void 0!==o&&o&&(s=i+"-for_"+n,n++);var l=[p.getter(r,["key"])>0?[y.createTag("span",{class:"edo-DelegatePermissionsList_infoList_text"},[y.createText(""+global.rk(","))],{},T,this)]:y.createText(""),y.createControl("wsControl","ws:SBIS3.CONTROLS/Link",{handlers:{onActivated:p.getTypeFunc(" js!SBIS3.EDO.DelegatePermissionsList:prototype._onActivatedLinkPoaTrustSign ",{})},name:"linkPoaTrustSign_"+p.getter(r,["value"]),caption:p.getter(r,["item","getCaptionPOA"]).apply(p.getter(r,["item"]),["Номера",p.getter(r,["key"]),!0]),idPoaTrustSign:p.getter(r,["value"]),enabled:!0,allowChangeEnable:!1,alwaysShowExtendedTooltip:!0,extendedTooltip:p.getter(r,["item","getCaptionPOA"]).apply(p.getter(r,["item"]),["Номера",p.getter(r,["key"]),!1]),esc:!1},{class:"edo-DelegatePermissionsList_linkPoaTrustSign ws-additional-link",name:"linkPoaTrustSign_"+p.getter(r,["value"]),sbisname:"linkPoaTrustSign_"+p.getter(r,["value"])},{data:r,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:u},s,d,v,p.config,c)];void 0===l[0]&&void 0!==o&&o||(a=a.concat(l))}.bind(r))}else a=""}.call(r),a}(),y.createTag("span",{class:"edo-DelegatePermissionsList_infoList_text"},[y.createText(""+global.rk(")"))],{},T,this)],{},T,this),p.getter(r,["item","getDataFromPOA"]).apply(p.getter(r,["item"]),["НетСертификата"])?[y.createTag("span",{class:"edo-DelegatePermissionsList_errorCert"},[y.createText("("+global.rk("Нет действующей ЭП")+")")],{},T,this)]:y.createText("")]:y.createText("")],{},T,this),y.createTag("div",{class:"edo-DelegatePermissionsList_row_rights"},[p.getter(r,["item","getDataFromTS"]).apply(p.getter(r,["item"]),["Идентификаторы"])&&p.getter(p.getter(r,["item","getDataFromTS"]).apply(p.getter(r,["item"]),["Идентификаторы"]),["length"])>0?[y.createTag("span",{class:"edo-DelegatePermissionsList_normalText"},[y.createText(""+p.wrapUndef(p.utils.escape(p.getter(r,["item","getDataFromTS"]).apply(p.getter(r,["item"]),["Название"]))))],{},T,this),y.createTag("span",{class:"edo-DelegatePermissionsList_infoList"},[y.createTag("span",{class:"edo-DelegatePermissionsList_infoList_text"},[y.createText("("+global.rk("по доверию подписью"))],{},T,this),function(){for(var e=void 0,t=0;t<p.iterators.length&&!e;t++)p.iterators[t].is(p.utils.escape(p.getter(r,["item","getDataFromTS"]).apply(p.getter(r,["item"]),["Идентификаторы"])))&&(e=p.iterators[t].iterator);var a=[];return function(){var t=p.createScope(r);if(r=t,e){var i=s,n=0;e(p.utils.escape(p.getter(r,["item","getDataFromTS"]).apply(p.getter(r,["item"]),["Идентификаторы"])),function(e,t){p.presetScope(e,r,t,{key:"key",value:"value"}),s&&void 0!==o&&o&&(s=i+"-for_"+n,n++);var l=[p.getter(r,["key"])>0?[y.createTag("span",{class:"edo-DelegatePermissionsList_infoList_text"},[y.createText(""+global.rk(","))],{},T,this)]:y.createText(""),y.createControl("wsControl","ws:SBIS3.CONTROLS/Link",{handlers:{onActivated:p.getTypeFunc(" js!SBIS3.EDO.DelegatePermissionsList:prototype._onActivatedLinkTsTrustSign ",{})},name:"linkTsTrustSign_"+p.getter(r,["value"]),caption:p.getter(r,["item","getCaptionTS"]).apply(p.getter(r,["item"]),["ФИО",p.getter(r,["key"]),!0]),idTsTrustSign:p.getter(r,["value"]),enabled:!0,allowChangeEnable:!1,alwaysShowExtendedTooltip:!0,extendedTooltip:p.getter(r,["item","getCaptionTS"]).apply(p.getter(r,["item"]),["ФИО",p.getter(r,["key"]),!1]),esc:!1},{class:"edo-DelegatePermissionsList_linkTsTrustSign ws-additional-link",name:"linkTsTrustSign_"+p.getter(r,["value"]),sbisname:"linkTsTrustSign_"+p.getter(r,["value"])},{data:r,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:u},s,d,v,p.config,c)];void 0===l[0]&&void 0!==o&&o||(a=a.concat(l))}.bind(r))}else a=""}.call(r),a}(),y.createTag("span",{class:"edo-DelegatePermissionsList_infoList_text"},[y.createText(""+global.rk(")"))],{},T,this)],{},T,this)]:y.createText("")],{},T,this)],i,T,this)],m,T);T.def&&(D=y.chain(D,T,i),T=void 0)}catch(e){p.templateError("resources/Doverennosti/components/DelegatePermissionsList/resources/mainCellTemplate.tmpl",e,r)}return D||""};return r.includedFunctions={},r.stable=!0,r.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.DelegatePermissionsList/resources/mainCellTemplate"}},r});
define("tmpl!SBIS3.EDO.DelegatePermissionsList/resources/smallCellTemplate",["Core/tmpl/js/tclosure"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],s={},r=function e(r,i,l,a,n){function o(){}var c=0,m=void 0!==t&&t?t:arguments[arguments.length-1];void 0===m&&(eval("var thelpers = null;"),m=global.requirejs("View/Runner/tclosure"));var p={};n&&n.isSetts&&(p=n.fullContext||{});var d="string"==typeof l?l:"",g=void 0===s?void 0:s,u={id:[],def:void 0},v=m.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,r),f=this&&this.includedTemplates?this.includedTemplates:{},h=m.getMarkupGenerator(a);try{var T=h.joinElements([h.createTag("div",{class:"edo-DelegatePermissionsList_row"},[h.createTag("div",{class:"edo-DelegatePermissionsList_linkOrg_small"},[h.createText(" "+m.wrapUndef(m.utils.escape(m.getter(r,["item","getDataFromOrg"]).apply(m.getter(r,["item"]),["Название"])))+" ")],{},u,this),m.getter(r,["item","getInnKpp"]).apply(m.getter(r,["item"]),[])?[h.createTag("div",{class:"edo-DelegatePermissionsList_infoText_small"},[h.createText(" "+m.wrapUndef(m.utils.escape(m.getter(r,["item","getInnKpp"]).apply(m.getter(r,["item"]),[])))+" ")],{},u,this)]:h.createText(""),h.createTag("div",{class:"edo-DelegatePermissionsList_row_rights_small"},[h.createText(" "+m.wrapUndef(m.utils.escape(m.getter(r,["item","getRigthsList"]).apply(m.getter(r,["item"]),[])))+" ")],{},u,this)],i,u,this)],d,u);u.def&&(T=h.chain(T,u,i),u=void 0)}catch(e){m.templateError("resources/Doverennosti/components/DelegatePermissionsList/resources/smallCellTemplate.tmpl",e,r)}return T||""};return r.includedFunctions={},r.stable=!0,r.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.DelegatePermissionsList/resources/smallCellTemplate"}},r});
define('js!SBIS3.EDO.DelegatePermissionsList',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.DelegatePermissionsList','js!SBIS3.Contragents.OurCardCommonFunctions','WS.Data/Source/SbisService','SBIS3.CONTROLS/Utils/InformationPopupManager','Core/UserInfo','Core/Deferred','SBIS3.CONTROLS/Action/List/OpenEditDialog','Core/CommandDispatcher','css!SBIS3.EDO.DelegatePermissionsList','js!SBIS3.EDO2.DelegatePermissionsListModel','SBIS3.CONTROLS/Tree/DataGridView','SBIS3.CONTROLS/CheckBox','SBIS3.CONTROLS/Link','tmpl!SBIS3.EDO.DelegatePermissionsList/resources/mainCellTemplate','tmpl!SBIS3.EDO.DelegatePermissionsList/resources/smallCellTemplate','js!SBIS3.PersonCore.AProfile.DoublePanel.ExpandLink','Doverennosti_localization'],function(e,t,n,o,i,r,s,a,l){'use strict';var d=e.extend({_dotTplFn:t,$protected:{_options:{previewMode:false,faceIdFieldName:'record/Ids/ЧастноеЛицо'}},_browser:null,_openerTS:null,_openerPOA:null,$constructor:function(){var e=this.getLinkedContext().getValue('record')||null;if(l.declareCommand(this,'openOurCard',this._commandOpenOurCard),l.declareCommand(this,'openTrustSignDialog',this._commandOpenTrustSignDialog),l.declareCommand(this,'openPowerOfAttorneyDialog',this._commandOpenPowerOfAttorneyDialog),!this._options.previewMode&&e&&e.has('HasOtherAccounts'))this.waitChildControlByName('cbTypeSelectCert').addCallback(function(e){e.setEnabled(false),e.setAllowChangeEnable(false);});},init:function(){d.superclass.init.call(this);var e=this;if(e._browser=e.getChildControlByName('permissionsList'),e._options.previewMode)e._browser.subscribeTo(e._browser,'onDataLoad',function(t,n){e.waitChildControlByName('pcExpandLink').addCallback(function(t){if(n&&n.getRawData()&&n.getRawData().n>e._browser.getPageSize())t.show();else t.hide();});});e.subscribeTo(e,'onDestroy',function(t){if(e._openerTS)e._openerTS.destroy();if(e._openerPOA)e._openerPOA.destroy();});},_commandOpenOurCard:function(e){n.openOurCard(e,this,false);},_commandOpenTrustSignDialog:function(e){var t=this;if(!this._options.previewMode){if(!this._openerTS)this._openerTS=new a({name:'trustSignOpener',mode:'floatArea',template:'js!SBIS3.EDO.TrustSignDialog',componentOptions:{enabled:false}}),this._openerTS.subscribeTo(this._openerTS,'onUpdateModel',function(e,n,o){t._browser.reload();});this._openerTS.execute({id:e});}},_commandOpenPowerOfAttorneyDialog:function(e){var t=this;if(!this._options.previewMode){if(!this._openerPOA)this._openerPOA=new a({name:'powerOfAttorneyOpener',mode:'floatArea',template:'js!SBIS3.EDO2.PowerOfAttorneyToSign'}),this._openerPOA.subscribeTo(this._openerPOA,'onUpdateModel',function(e,n,o){t._browser.reload();});this._openerPOA.execute({id:e});}},_onActivatedLinkOrg:function(e){l.sendCommand(this,'openOurCard',this._options.idOrgTrustSign);},_onActivatedLinkTsTrustSign:function(e){l.sendCommand(this,'openTrustSignDialog',this._options.idTsTrustSign);},_onActivatedLinkPoaTrustSign:function(e){l.sendCommand(this,'openPowerOfAttorneyDialog',this._options.idPoaTrustSign);},_itemsSortMethodPermissionsList:function(e,t){return e.item.getContents().get('Организация').get('Название')>t.item.getContents().get('Организация').get('Название')?1:-1;},_getUserId:function(){var e=new s(),t=this.getLinkedContext().getValue(this._options.faceIdFieldName)||null,n=r.get('ИдентификаторПользователя');if(t)new o({endpoint:'ЧастноеЛицо'}).call('Пользователь',{'ИдО':t}).addCallback(function(t){var n=t?t.getRawData():null;if(n)e.callback(n);else e.errback(new Error(rk('Пользователь не найден.')));}).addErrback(function(t){e.errback();});else if(n)e.callback(n);else e.errback();return e;},_onInitTypeSelectCert:function(e){var t=this;t.getParentByClass('SBIS3.EDO.DelegatePermissionsList')._getUserId().addCallback(function(e){new o({endpoint:'ГлобальныеПараметрыКлиента'}).call('ПолучитьЗначение',{'Путь':'GetAllUserCerts_'+e}).addCallback(function(e){var n=e&&e.getRawData();t._prevValue=null,t.setChecked('true'===n);}).addErrback(function(e){t._prevValue=false;});}).addErrback(function(e){t._prevValue=false;});},_onCheckedChangeTypeSelectCert:function(e,t){var n=this,r=n.getParentByClass('SBIS3.EDO.DelegatePermissionsList');if(n._prevValue!==t)if(null===n._prevValue)n._prevValue=t;else r._getUserId().addCallback(function(e){new o({endpoint:'ГлобальныеПараметрыКлиента'}).call('ВставитьЗначение',{'Путь':'GetAllUserCerts_'+e,'ЗначениеПараметра':''+t}).addCallback(function(e){n._prevValue=t;}).addErrback(function(e){n.setChecked(n._prevValue),i.showMessageDialog({message:e.message,status:'error'});});}).addErrback(function(e){i.showMessageDialog({message:rk('Не удалось получить информацию о пользователе.'),details:rk('Пожалуйста, обратитесь к администратору.'),status:'error'});});}});return d;});
define("html!SBIS3.EDO.PowerOfAttorneyDialog",function(){var o=function(o){var n=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;o.test(n);)n=n.replace(o,"&#123;&#123;$1&#125;&#125;");return n}}(),t=function(o){return o.join?o.join(""):o.toString()},e=function(o){return void 0===o?"":o&&"object"==typeof o?t(o):""+o},i="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,"<div class='edo-PowerOfAttorneyDialog'> <component data-component='SBIS3.EDO2.Dialog' name='PowerOfAttorneyEDODialog'> <option name='objectName'>Доверенность</option> <option name='stickyHeader'>true</option> <options name='fullTrace' type='array'> <option name='objectName'>Доверенность</option> <option name='linkDoc'>@Документ</option> </options> <option name='firstLineContent'> <component data-component='SBIS3.EDO.PowerOfAttorneyStatus' name='PowerOfAttorneyStatus'> </component> </option> <option name='tabindex'>1</option> <options name='tabs' type='array'> <options> <option name='id'>mainTab</option> <option name='title' type='content'> <component data-component='SBIS3.EDO2.MainTabHeaderTemplate'> <option name='mainInfo'>"+n(e(rk("Доверенность на право подписи")))+"</option> <option name='additionalInfo1'> <component data-component='SBIS3.CONTROLS/EditAtPlace' name='additionalInfo1'> <options name='text'> <option name='startDate' bind='record/Дата'></option> <option name='endDate' bind='record/Доверенность.Срок'></option> </options> <option name='editorTpl'> <component data-component='SBIS3.CONTROLS/Date/Range' name='DRDates' class='edo-PowerOfAttorneyDialog_dateFields'> <option name='startValue' bind='record/Дата'></option> <option name='endValue' bind='record/Доверенность.Срок'></option> <option name='serializationMode'>datetime</option> <option name='mask'>DD.MM.YYYY</option> <option name='notificationMode'>complete</option> <options name='validators' type='array'> <options> <option name='validator' type='function' value='js!SBIS3.EDO.PowerOfAttorneyDialog:prototype.validateDateRange'></option> </options> </options> <options name='handlers'> <option name='onInit' type='function'>js!SBIS3.EDO.PowerOfAttorneyDialog:prototype.onInitDateRange</option> </options> </component> </option> </component> </option> <option name='additionalInfo2'> <span>№ </span> <component data-component='SBIS3.CONTROLS/EditAtPlace' name='additionalInfo2' class='edo-PowerOfAttorneyDialog__number controls-EditAtPlace__ellipsis'> <option name='text' bind='record/Номер'></option> <option name='tooltip' bind='record/Номер'></option> <option name='editorTpl'> <component data-component='SBIS3.CONTROLS/TextBox' name='TBNumber' class='edo-PowerOfAttorneyDialog_numberField'> <option name='text' bind='record/Номер'></option> <option name='placeholder' value='Номер'></option> <option name='maxLength' value='256'></option> <option name='inputRegExp' value='[\\\\\\\\/\\.0-9a-zA-Zа-яА-ЯёЁ-]'></option> <options name='validators' type='array'> <options> <option name='option'>text</option> <option name='validator' type='function'>SBIS3.CONTROLS/Utils/ControlsValidators:required</option> </options> </options> </component> </option> </component> </option> </component> </option> <option name='className'>controls-TabButton__main-item</option> <option name='content'> <component data-component='SBIS3.EDO.PowerOfAttorneyForSign' name='PowerOfAttorneyForSign'> <option name='key_name'>@Документ</option> </component> </option> </options> </options> </component> </div>");return(a=n(a))+(i&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.PowerOfAttorneyDialog"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.PowerOfAttorneyDialog", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-PowerOfAttorneyDialog_caption{display:inline-block;font-size:14px;color:#000;font-weight:400;margin-left:8px}.edo-PowerOfAttorneyDialog_numberText{margin-left:4px}.edo-PowerOfAttorneyDialog_numberField{width:62px}.edo-PowerOfAttorneyDialog_FSS{height:40px;background-color:#d6e8cb}.edo-PowerOfAttorneyDialog_infoFSS{float:left;width:500px;height:40px}.edo-PowerOfAttorneyDialog__number{max-width:121px}.edo-PowerOfAttorneyDialog_btnSave{float:right;margin-top:8px;margin-right:40px}"));head.appendChild(style);});}
define("html!SBIS3.EDO.PowerOfAttorneyForSign",function(){var o=function(o){var e=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(e){for(;o.test(e);)e=e.replace(o,"&#123;&#123;$1&#125;&#125;");return e}}(),n=function(o){return o.join?o.join(""):o.toString()},t=function(o){return void 0===o?"":o&&"object"==typeof o?n(o):""+o},i="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,"<div class='edo-PowerOfAttorneyForSign ws-dataview-text'> <div class='edo-PowerOfAttorneyForSign_users'> <table class='edo-PowerOfAttorneyForSign_tableUsers'> <tr> <td class='edo-PowerOfAttorneyForSign_tableUsers_td_link'> <component data-component='SBIS3.CONTROLS/Menu/MenuLink' name='chooseOwner' class='edo-PowerOfAttorneyForSign_chooseOwner'> <option name='caption'>"+e(t(rk("От кого")))+"</option> <option name='allowChangeEnable'>true</option> <option name='enable'>true</option> <option name='idProperty'>id</option> <option name='clickThrottle'>true</option> <options name='items' type='array'> <options> <option name='id' type='string'>fromOurOrganization</option> <option name='title'>"+e(t(rk("Наша организация")))+"</option> </options> <options> <option name='id' type='string'>fromContragent</option> <option name='title'>"+e(t(rk("Контрагент")))+"</option> </options> </options> </component> </td> <td class='edo-PowerOfAttorneyForSign_tableUsers_td_nameOrg'> <div class='edo-PowerOfAttorneyForSign_orgName'> <span title='' data-bind='html: record/delegatorNamePOA, attr: {title: record/Доверитель.Название}'></span> </div> </td> </tr> <tr> <td colspan='2'> <component data-component='SBIS3.Staff.Choice' name='scFaceOwner' class='edo-PowerOfAttorneyForSign_staffChoice'> <option name='entityType'>Сотрудник</option> <option name='organization'>-1</option> <option name='selectionType'>leaf</option> <option name='multiselect'>false</option> <option name='placeholder'>"+e(t(rk("Фамилия, имя, отчество доверителя")))+"</option> <options name='selectedKeys' type='array'> <option bind='record/СотрудникДоверителя'></option> </options> <option name='pickerClassName'>edo-PowerOfAttorneyForSign_staffChoice_picker</option> <option name='showOurCompany'>false</option> <options name='photo'> <option name='show'>true</option> <option name='size'>40</option> </options> <option name='signatureTemplate'>tmpl!SBIS3.EDO.PowerOfAttorneyForSign/resources/departmentTemplate</option> <option name='fioMode'>full</option> <options name='handlers'> <option name='onReady' type='function'>js!SBIS3.EDO.PowerOfAttorneyForSign:prototype.onReadySCFaceOwner</option> <option name='onSelectedItemsChange' type='function'>js!SBIS3.EDO.PowerOfAttorneyForSign:prototype.onSelectedItemsChangeSCFaceOwner</option> </options> </component> <component data-component='SBIS3.AddresseeChoice.FieldLink' name='acOwner' class='edo-PowerOfAttorneyForSign_addrChoice'> <option name='selectedKey' bind='record/Доверенность.Доверитель'></option> <option name='contragentChoice'>true</option> <option name='placeholder'>"+e(t(rk("Наименование доверителя")))+"</option> <option name='multiSelect'>false</option> <option name='returnFolders'>false</option> <option name='visible'>false</option> </component> <div class='edo-PowerOfAttorneyForSign_faceOwner ws-hidden'> <img class='edo-PowerOfAttorneyForSign_imgFaceOwner' src='/resources/PersonCore/Photo/resources/default_photo_mini.v1516270649826335cf4508dd597be4bfc9caa3e08b901.png'/> <component data-component='SBIS3.CONTROLS/TextBox' name='tbNameFaceOwner' class='edo-PowerOfAttorneyForSign_nameFaceOwner'> <option name='text' bind='record/Доверенность.Основание' nonexistent=''></option> <option name='placeholder'>"+e(t(rk("Фамилия, имя, отчество доверителя")))+"</option> <option name='maxLength'>256</option> <options name='validators' type='array'> <options> <option name='validator' type='function' value='js!SBIS3.EDO.PowerOfAttorneyForSign:prototype.validatorNameFaceOwner'></option> </options> </options> </component> </div> </td> </tr> <tr class='edo-PowerOfAttorneyForSign_tableUsers_tr_delegate'> <td class='edo-PowerOfAttorneyForSign_tableUsers_td_link'> <component data-component='SBIS3.CONTROLS/Link' name='linkDelegate' class='edo-PowerOfAttorneyForSign_link'> <option name='caption'>Кому</option> <option name='clickThrottle'>true</option> </component> </td> <td class='edo-PowerOfAttorneyForSign_tableUsers_td_nameOrg'> <div class='edo-PowerOfAttorneyForSign_orgName'> <span title='' data-bind='html: record/senderNamePOA, attr: {title: record/Отправитель.Название}'></span> </div> </td> </tr> <tr> <td colspan='2'> <component data-component='SBIS3.Staff.Choice' name='scFaceDelegate' class='edo-PowerOfAttorneyForSign_staffChoice'> <option name='entityType'>Сотрудник</option> <option name='organization'>-1</option> <option name='selectionType'>leaf</option> <option name='multiselect'>false</option> <option name='placeholder'>"+e(t(rk("Фамилия, имя, отчество уполномоченного")))+"</option> <option name='pickerClassName'>edo-PowerOfAttorneyForSign_staffChoice_picker</option> <options name='selectedKeys' type='array'> <option bind='record/СотрудникОтправителя'></option> </options> <option name='showOurCompany'>false</option> <options name='photo'> <option name='show'>true</option> <option name='size'>40</option> </options> <option name='signatureTemplate'>tmpl!SBIS3.EDO.PowerOfAttorneyForSign/resources/departmentTemplate</option> <option name='fioMode'>full</option> <options name='handlers'> <option name='onInit' type='function'>js!SBIS3.EDO.PowerOfAttorneyForSign:prototype.onInitSCFaceDelegate</option> <option name='onReady' type='function'>js!SBIS3.EDO.PowerOfAttorneyForSign:prototype.onReadySCFaceDelegate</option> <option name='onSelectedItemsChange' type='function'>js!SBIS3.EDO.PowerOfAttorneyForSign:prototype.onSelectedItemsChangeSCFaceDelegate</option> </options> </component> <component data-component='SBIS3.AddresseeChoice.FieldLink' name='acDelegate' class='edo-PowerOfAttorneyForSign_addrChoice'> <option name='selectedKey' bind='record/Доверенность.Отправитель'></option> <option name='contragentChoice'>true</option> <option name='placeholder'>"+e(t(rk("Название отправителя")))+"</option> <option name='multiSelect'>false</option> <option name='returnFolders'>false</option> <option name='visible'>false</option> </component> </td> </tr> </table> </div> <div class='edo-PowerOfAttorneyForSign_rowAllowedSign'> <component data-component='SBIS3.EDO.AllowedToSign' name='tdList' class='edo-PowerOfAttorneyForSign_allowedSign_table'> <option name='content' type='content'> <div class='edo-PowerOfAttorneyForSign_rowFilial ws-hidden'> <div class='edo-PowerOfAttorneyForSign_divLink'> <component data-component='SBIS3.CONTROLS/Link' name='linkFilial' class='edo-PowerOfAttorneyForSign_link'> <option name='caption'>"+e(t(rk("в филиале")))+"</option> <option name='clickThrottle'>true</option> </component> </div> <component data-component='SBIS3.Contragents.ChoiceOurCompany' name='FLFilial' class='edo-PowerOfAttorneyForSign_filial'> <opts name='componentOptions'> <option name='ShowInnerCompany'>false</option> <option name='ShowAllCompany'>false</option> <option name='ourCompany'>false</option> <option name='withAffiliates'>false</option> <option name='visibleAddOrg'>false</option> <option name='head_our_org_id' bind='record/Доверенность.Доверитель' oneWay='true' direction='fromContext' value='-1' nonexistent='-1'></option> <option name='only_root'>false</option> </opts> <option name='keyField'>@Лицо</option> <option name='displayField'>Название</option> <options name='selectedItem'> <option name='@Лицо' bind='record/Доверенность.МестоОсуществленияПолномочий'></option> <option name='Название' bind='record/Филиал.Название'></option> </options> <option name='multiselect'>false</option> <options name='handlers'> <option name='onInit' type='function'>js!SBIS3.EDO.PowerOfAttorneyForSign:prototype.onInitFLFilial</option> <option name='onSelectedItemChange' type='function'>js!SBIS3.EDO.PowerOfAttorneyForSign:prototype.onSelectedItemChangeFLFilial</option> </options> </component> </div> </option> <option name='useReportTemplate'>true</option> <option name='key_name'>@Документ</option> </component> </div> <div class='edo-PowerOfAttorneyForSign_rowRightOfSubstitution'> <component data-component='SBIS3.CONTROLS/CheckBox' name='флагПравоПередоверия' class='edo-PowerOfAttorneyForSign_rightOfSubstitution'> <option name='caption'>"+e(t(rk("С правом передоверия")))+"</option> <option name='threeState'>false</option> <option name='checked' bind='record/Доверенность.ДоверенностьСПередоверием'></option> </component> </div> <div class='edo-PowerOfAttorneyForSign_rowNotary'> <component data-component='SBIS3.CONTROLS/FieldLink/Link' name='linkNotery' class='edo-PowerOfAttorneyForSign_link'>"+e(t(rk(">")))+" <option name='caption'>"+e(t(rk("Если доверенность нотариально заверена, укажите нотариуса")))+"</option> <option name='clickThrottle'>true</option> </component> <component data-component='SBIS3.AddresseeChoice.FieldLink' name='FLNotery' class='edo-PowerOfAttorneyForSign_notary'> <option name='selectedKey' bind='record/Доверенность.Нотариус'></option> <option name='contragentChoice'>true</option> <option name='placeholder'>"+e(t(rk("если доверенность нотариально заверена, укажите нотариуса")))+"</option> <option name='multiSelect'>false</option> <option name='returnFolders'>false</option> <option name='visible'>false</option> </component> </div> <div class='edo-PowerOfAttorneyForSign_rowFileArea'> <div> <component data-component='SBIS3.EDO2.AttachButton' name='attachFile' class='edo-PowerOfAttorneyForSign_linkAttachButton'> <option name='multiSelect' type='boolean'>false</option> <option name='onFinishCreateAttachment' type='function'>js!SBIS3.EDO.PowerOfAttorneyForSign:prototype.onFinishCreateAttachmentAttachFile</option> <options name='fileMasks' type='array'> <option value='*.pdf'></option> <option value='*.jpg'></option> <option value='*.jpeg'></option> <option value='*.tiff'></option> <option value='*.bmp'></option> <option value='*.gif'></option> <option value='*.png'></option> <option value='*.tif'></option> </options> <options name='referenceTypes'> <option name='sbisDisk'>false</option> <option name='web'>false</option> </options> <option name='maxAttachmentSize'>2</option> <option name='visible'>false</option> </component> </div> <div> <component data-component='SBIS3.EDO2.Viewer' name='docView'> </component> </div> </div> </div>");return(a=e(a))+(i&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.PowerOfAttorneyForSign"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.PowerOfAttorneyForSign", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-PowerOfAttorneyForSign{width:100%;height:auto}.edo-PowerOfAttorneyForSign_linkAttachButton{height:24px;line-height:24px;margin-left:8px}.edo-PowerOfAttorneyForSign_users{padding:8px 8px 0 8px}.edo-PowerOfAttorneyForSign_tableUsers{width:100%}.edo-PowerOfAttorneyForSign_tableUsers tr{height:24px}.edo-PowerOfAttorneyForSign_tableUsers_td_link{width:48px}.edo-PowerOfAttorneyForSign_chooseOwner{vertical-align:bottom;width:auto;text-align:left;white-space:nowrap;color:#8991a9;text-decoration:underline}.edo-PowerOfAttorneyForSign_link{color:#8991a9;text-decoration:underline;float:left}.edo-PowerOfAttorneyForSign_tableUsers_td_nameOrg{max-width:0}.edo-PowerOfAttorneyForSign_orgName{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.edo-PowerOfAttorneyForSign_orgName span{font-size:14px;font-weight:700;width:400px;text-align:left;line-height:24px;margin-left:8px}.edo-PowerOfAttorneyForSign_staffChoice{width:451px;height:40px;margin-top:4px}.edo-PowerOfAttorneyForSign_staffChoice .StaffChoice__fieldLink{width:calc(100% - 44px)!important}.edo-PowerOfAttorneyForSign_staffChoice_picker{width:449px!important;max-height:558px!important}.edo-PowerOfAttorneyForSign_addrChoice{width:560px}.edo-PowerOfAttorneyForSign_tableUsers_tr_delegate{height:40px!important;vertical-align:bottom}.edo-PowerOfAttorneyForSign_faceOwner{margin-top:4px;height:40px}.edo-PowerOfAttorneyForSign_imgFaceOwner{vertical-align:top;border-radius:8px;-moz-border-radius:8px;-webkit-border-radius:8px;width:40px;height:40px}.edo-PowerOfAttorneyForSign_nameFaceOwner{width:407px}.edo-PowerOfAttorneyForSign_rowAllowedSign{padding-top:12px;width:100%}.edo-PowerOfAttorneyForSign_rowFilial{padding-top:4px;height:24px}.edo-PowerOfAttorneyForSign_divLink{float:left;width:72px}.edo-PowerOfAttorneyForSign_filial{width:379px;float:left}.edo-PowerOfAttorneyForSign_rowRightOfSubstitution{padding:19px 8px 0 1px}.edo-PowerOfAttorneyForSign_rowNotary{height:24px;padding:8px 8px 0 8px}.edo-PowerOfAttorneyForSign_notary{margin-left:8px;width:386px}.edo-PowerOfAttorneyForSign_rowFileArea{padding:16px 0 8px 0}.edo-PowerOfAttorneyForSign_position{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;color:#999;font-size:12px;padding-left:5px;height:16px;line-height:16px}.edo-PowerOfAttorneyForSign_position span{vertical-align:middle}"));head.appendChild(style);});}
define("tmpl!SBIS3.EDO.PowerOfAttorneyForSign/resources/departmentTemplate",["Core/tmpl/js/tclosure"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={},o=function e(o,n,i,a,s){function l(){}var c=0,d=void 0!==t&&t?t:arguments[arguments.length-1];void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure"));var u={};s&&s.isSetts&&(u=s.fullContext||{});var p="string"==typeof i?i:"",f=void 0===r?void 0:r,m={id:[],def:void 0},v=d.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),g=this&&this.includedTemplates?this.includedTemplates:{},y=d.getMarkupGenerator(a);try{var h=y.joinElements([y.createTag("div",{class:"edo-PowerOfAttorneyForSign_position"},[y.createTag("span",{"data-bind":"text:StaffChoice/record/0/Должность"},[],{},m,this)],n,m,this)],p,m);m.def&&(h=y.chain(h,m,n),m=void 0)}catch(e){d.templateError("resources/Doverennosti/components/PowerOfAttorneyDialog/PowerOfAttorneyForSign/resources/departmentTemplate.tmpl",e,o)}return h||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.PowerOfAttorneyForSign/resources/departmentTemplate"}},o});
define('js!SBIS3.EDO.PowerOfAttorneyForSign',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.PowerOfAttorneyForSign','WS.Data/Source/SbisService','Core/CommandDispatcher','Core/Deferred','css!SBIS3.EDO.PowerOfAttorneyForSign','SBIS3.CONTROLS/CheckBox','SBIS3.CONTROLS/FieldLink','SBIS3.CONTROLS/TextBox','SBIS3.CONTROLS/Menu/MenuLink','js!SBIS3.Staff.Choice','SBIS3.CONTROLS/Link','SBIS3.CONTROLS/FieldLink/Link','js!SBIS3.AddresseeChoice.FieldLink','SBIS3.CONTROLS/CheckBox','js!SBIS3.EDO2.Viewer','js!SBIS3.EDO2.AttachButton','js!SBIS3.EDO.AllowedToSign','js!SBIS3.Contragents.ChoiceOurCompany','tmpl!SBIS3.EDO.PowerOfAttorneyForSign/resources/departmentTemplate','Doverennosti_localization'],function(e,t,n,l,r){var o='fromContragent',i='fromOurOrganization',a=e.extend({_dotTplFn:t,$protected:{_options:{}},_showAllowedSign:false,_ownerType:null,_hasFilials:false,_contragentKey:0,_fcOwn:false,_fcDel:false,_hasRegNumber:false,$constructor:function(){this._options.autoHeight=true,l.declareCommand(this,'poaValidateNumberFSS',this._poaValidateNumberFSS);},init:function(){a.superclass.init.call(this);var e=this,t=e.getLinkedContext(),l=e.getParentByClass('SBIS3.EDO.PowerOfAttorneyDialog'),r=e.getChildControlByName('FLNotery'),d=e.getChildControlByName('linkNotery'),s=e.getChildControlByName('scFaceOwner'),u=e.getChildControlByName('chooseOwner'),c=e.getChildControlByName('acOwner'),g=e.getChildControlByName('linkDelegate'),h=e.getChildControlByName('linkFilial'),C=e.getChildControlByName('docView'),f=function(){var n=t.getValue('record/Доверенность.Нотариус'),a=t.getValue('record/КонтрагентРасширение.РегНомерФСС'),u=function(){var n=e.getChildControlByName('attachFile');if(t.getValue('record/РП.Документ/СписокВложений').getCount()>0)n.hide();else n.show();},c,g;if(t.getValue('record/ДоверительЭтоНО')){if(g=t.getValue('record/Доверенность.Доверитель'),s.getLinkedContext().setValue('Choice__organization',null!==g?g:-1),e.switchOwnerFieldView(i),c=e.getChildControlByName('FLFilial'),g)e.hasFilials(g).addCallback(function(n){if(e._hasFilials=!!(n&&n.getRawData()),e._hasFilials)e.hiddenRowFilial(true),c.getLinkedContext().setValue('СкрытьГоловнуюОрганизацию',true),c.getLinkedContext().setValue('ОрганизацияДляФильтра',g);else if(t.getValue('record/Доверенность.МестоОсуществленияПолномочий'))e.hiddenRowFilial(true);else t.setValue('record/Доверенность.МестоОсуществленияПолномочий',null),e.hiddenRowFilial(false);});}else s.getLinkedContext().setValue('Choice__organization',l.getIdOpenerOrg()||-1),e.switchOwnerFieldView(o);if(C.subscribeTo(C,'onFinishCommand',function(){var t=e.getChildControlByName('attachFile');if(/delete/i.test(arguments[1]))e.onDeleteCommand.call(e,t);}),null===n||void 0===n)r.hide(),d.setCaption(rk('Если доверенность нотариально заверена, укажите нотариуса'));else d.setCaption(rk('Нотариус')),r.show();e._hasRegNumber=!!a&&10===a.length,u(),t.subscribeTo(t,'onFieldChange',function(e,t,n){if(('record'===t||'record/РП.Документ/СписокВложений'===t)&&n)u();});};if(t.getValue('record/@Документ'))f();else t.subscribeTo(t,'onFieldChange',function e(n,l,r){if('record'===l&&r){var o=r.get('Доверенность.Нотариус');t.unsubscribeFrom(t,'onFieldChange',e),f(),t.setValue('record/Доверенность.Нотариус',o);}});d._options.owner=r.getName(),r.subscribeTo(r,'onSelectedItemsChange',function(e,t){var n=this.getSelectedItems();if(n)if(n.getCount()>0)d.setCaption('Нотариус'),r.show();else r.hide(),d.setCaption(rk('Если доверенность нотариально заверена, укажите нотариуса'));}),u.subscribeTo(u,'onMenuItemActivate',function(t,n){e.switchOwnerFieldView(n);}),c.subscribeTo(c,'onSelectedItemsChange',function(t,l){var r=this,i=e.getLinkedContext(),a=r.getSelectedItems(),d,s,u,c;if(e.hasChildControlByName('FLFilial')&&e.hasChildControlByName('linkFilial'))if(d=e.getChildControlByName('FLFilial'),a)if(a.getCount()>0){if(c=a.at(0),u=c.get('@Лицо'),u){if(e._contragentKey!==u&&e._ownerType===o){if(i.setValue('record/Доверитель.Название',c.get('Название')),!(!e._contragentKey&&i.getValue('record/Доверенность.Основание')))(s=new n({endpoint:{contract:'Контрагент'}})).call('Director',{id:u}).addCallback(function(e){var t=e.getRow(),n=null,l,r,o;if(t)r=t.get('Фамилия')||'',o=t.get('Имя')||'',l=t.get('Отчество')||'',n=(r+(r?' ':'')+o+(o?' ':'')+l).trim();i.setValue('record/Доверенность.Основание',n?n:null);}).addErrback(function(e){i.setValue('record/Доверенность.Основание',null);});e._contragentKey=u;}e.hasFilials(u).addCallback(function(t){if(!!(t&&t.getRawData()))e.hiddenRowFilial(true),d.getLinkedContext().setValue('СкрытьГоловнуюОрганизацию',true),d.getLinkedContext().setValue('ОрганизацияДляФильтра',u);else if(i.getValue('record/Доверенность.МестоОсуществленияПолномочий'))e.hiddenRowFilial(true);else i.setValue('record/Доверенность.МестоОсуществленияПолномочий',null),e.hiddenRowFilial(false);}),(s=new n({endpoint:{contract:'Контрагент'}})).call('ЭтоНО',{'ИдО':u}).addCallback(function(e){i.setValue('record/ДоверительЭтоНО',!!e.getRawData());}).addErrback(function(e){i.setValue('record/ДоверительЭтоНО',true);}),s.call('Прочитать',{'ИдО':u,'ИмяМетода':'Прочитать'}).addCallback(function(t){var n=t.getRow().get('КонтрагентРасширение.РегНомерФСС');i.setValue('record/КонтрагентРасширение.РегНомерФСС',n?n:null),e._hasRegNumber=!!n&&10===n.length;}).addErrback(function(e){i.setValue('record/КонтрагентРасширение.РегНомерФСС',null);});}}else i.setValue('record/Доверенность.МестоОсуществленияПолномочий',null),e.hiddenRowFilial(false),i.setValue('record/Доверенность.Основание',null);}),g.subscribeTo(g,'onActivated',function(t){e.getChildControlByName('scFaceDelegate').sendCommand('showSelector');}),h.subscribeTo(h,'onActivated',function(t){e.getChildControlByName('FLFilial').sendCommand('showSelector');});},hasFilials:function(e){var t=this,l=t.getLinkedContext();return new n({endpoint:{contract:'OurOrg'}}).call('HasBranches',{head:e,closed:false,rights:false}).addErrback(function(e){l.setValue('record/Доверенность.МестоОсуществленияПолномочий',null),t.hiddenRowFilial(false);});},validatorFaceAndOrg:function(e){var t=e.getSelectedKeys(),n=t.length>0?t[0]:null,l,r,o,i;if(null===n||''===n)return rk('Поле обязательно для заполнения');else if(o=e.getSelectedItems(),i=o?o.at(0):null,i)return l=i?i.get('Контрагент'):null,r=l&&'null'!==l&&''!==l?parseInt(l,10):null,r?true:rk('Не выбрана организация');else return true;},onReadySCFaceOwner:function(){var e=this.getChildControlByName('StaffChoice__fieldLink'),t=this.getParentByClass('SBIS3.EDO.PowerOfAttorneyForSign'),n=[{validator:function(){if(t._ownerType===i)return t.validatorFaceAndOrg(this);else return true;}}];e.setValidators(n);},onSelectedItemsChangeSCFaceOwner:function(e,t){var n=this,l=n.getLinkedContext();l.setValue('record/СотрудникДоверителя',t[0]||null),n.getSelectedItems(true).addCallback(function(e){var t,n,r,o,i,a;if(e)if(e.getCount()>0)for(a=0;a<e.getCount();a++)n=(i=e.at(a)).get('Контрагент')&&'null'!==i.get('Контрагент')&&''!==i.get('Контрагент')?parseInt(i.get('Контрагент'),10):null,t=i.get('Контрагент.НазваниеСокращенное')||i.get('Контрагент.Название')||null,r=i.get('НазваниеКраткое')||i.get('ЧастноеЛицо.Название')||null,o=i.get('Лицо')||i.get('ЧастноеЛицо.@Лицо')||null,l.setValue('record/ЛицоДоверителя.Название',r),l.setValue('record/Доверитель.Название',t),l.setValue('record/Доверенность.ЛицоДоверителя',o),l.setValue('record/Доверенность.Доверитель',n);else l.setValue('record/Доверитель.Название',null),l.setValue('record/ЛицоДоверителя.Название',null),l.setValue('record/Доверенность.ЛицоДоверителя',null),l.setValue('record/Доверенность.Доверитель',null);return e;});},validateFSS:function(e){var t=this,n=t.getChildControlByName('listAllowedSign'),l=t.getChildControlByName('tdList'),r=t.getLinkedContext(),o=r.getValue('record/СтатусДоверенности'),i=r.getValue('record/КонтрагентРасширение.РегНомерФСС'),a=i?i.length:0,d=t._hasRegNumber&&a<10,s=(1===o||2===o||3===o||!!e)&&10!==a,u=a>0&&10!==a,c=true,g;if(d||s||u){if(l.changeView(true),n.expandNode(0),g=n.hasChildControlByName('tbRegNumber')?n.getChildControlByName('tbRegNumber'):null,g&&g.validate()&&e&&0===a&&!g.isMarked())g.markControl(rk('Поле обязательно для заполнения'));c=false;}return c;},_poaValidateNumberFSS:function(){var e=this.validateFSS(true);return new r().callback({valid:e,text:!e&&!this.hasChildControlByName('tbRegNumber')&&rk('Необходимо ввести корректный регистрационный номер ФСС')||''});},validatorNameFaceOwner:function(e){var t=this,n=t.getText(),l=t.getParentByClass('SBIS3.EDO.PowerOfAttorneyForSign'),r=l.getChildControlByName('acOwner').getSelectedKeys(),i=0===r.length||null===r[0];if(l._ownerType===o)if(i)return rk('Не выбран контрагент');else return n?true:rk('Поле обязательно для заполнения');else return true;},onInitSCFaceDelegate:function(e){this.getLinkedContext().setValue('Choice__organization',-1);},onReadySCFaceDelegate:function(){var e=this.getChildControlByName('StaffChoice__fieldLink'),t=this.getParentByClass('SBIS3.EDO.PowerOfAttorneyForSign'),n=[{validator:function(){return t.validatorFaceAndOrg(this);}}];e.setValidators(n);},onSelectedItemsChangeSCFaceDelegate:function(e,t){var n=this,l=n.getLinkedContext();l.setValue('record/СотрудникОтправителя',t[0]||null),n.getSelectedItems(true).addCallback(function(e){var t,n,r,o,i,a;if(e)if(e.getCount()>0)for(a=0;a<e.getCount();a++)n=(i=e.at(a)).get('Контрагент')&&'null'!==i.get('Контрагент')&&''!==i.get('Контрагент')?parseInt(i.get('Контрагент'),10):null,t=i.get('Контрагент.НазваниеСокращенное')||i.get('Контрагент.Название')||null,r=i.get('НазваниеКраткое')||i.get('ЧастноеЛицо.Название')||null,o=i.get('Лицо')||i.get('ЧастноеЛицо.@Лицо')||null,l.setValue('record/ЛицоОтправителя.Название',r),l.setValue('record/Отправитель.Название',t),l.setValue('record/Доверенность.ЛицоОтправителя',o),l.setValue('record/Доверенность.Отправитель',n);else l.setValue('record/Отправитель.Название',null),l.setValue('record/ЛицоОтправителя.Название',null),l.setValue('record/Доверенность.ЛицоОтправителя',null),l.setValue('record/Доверенность.Отправитель',null);return e;});},switchOwnerFieldView:function(e){var t=this,n=t.getLinkedContext(),l=t.getChildControlByName('scFaceOwner'),r=t.getChildControlByName('acOwner'),a=t.getContainer().find('.edo-PowerOfAttorneyForSign_faceOwner');if(null!==t._ownerType&&t._ownerType!==e)n.setValue('record/ЛицоДоверителя.Название',null),n.setValue('record/Доверитель.Название',null),n.setValue('record/Доверенность.Доверитель',null),n.setValue('record/Доверенность.ЛицоДоверителя',null),n.setValue('record/Доверенность.Основание',null),l.removeItemsSelectionAll(),r.removeItemsSelectionAll(),l.clearMark();if(e===i){if(l.show(),a.addClass('ws-hidden'),null!==t._ownerType)l.sendCommand('showSelector');}else if(e===o)if(l.hide(),a.removeClass('ws-hidden'),t.hiddenRowFilial(false),null!==t._ownerType)r.sendCommand('showSelector');t._ownerType=e;},onInitFLFilial:function(){var e=this,t=e.getLinkedContext(),n=t.getValue('record/Доверенность.МестоОсуществленияПолномочий'),l=function(t){if(t)e.show();else e.hide();};if(void 0===n)t.subscribeTo(t,'onFieldChange',function e(n,r,o){if('record'===r&&o)t.unsubscribeFrom(t,'onFieldChange',e),l(t.getValue('record/Доверенность.МестоОсуществленияПолномочий'));});else l(n);},onSelectedItemChangeFLFilial:function(e,t,n){if(t&&this.getSelectedItem())this.show();else this.hide();},onFinishCreateAttachmentAttachFile:function(e,t){var n=this.getLinkedContext(),l=n.getValue('record');if(this.hide(),l.has('ЗагруженНовыйСканДоверенности'))l.set('ЗагруженНовыйСканДоверенности',true);if(3===n.getValue('record/СтатусДоверенности'))n.setValue('record/needSavePOA',true);},onDeleteCommand:function(e){e.show();},hiddenRowFilial:function(e){var t=this.getContainer().find('.edo-PowerOfAttorneyForSign_rowFilial');if(e)t.removeClass('ws-hidden');else t.addClass('ws-hidden');}});return a;});
define("html!SBIS3.EDO.PowerOfAttorneyStatus",function(){var t=function(t){var o=function(){var t=/\{\{([\s\S]+?)\}\}/g;return function(o){for(;t.test(o);)o=o.replace(t,"&#123;&#123;$1&#125;&#125;");return o}}(),e=function(t){return t.join?t.join(""):t.toString()},s=function(t){return void 0===t?"":t&&"object"==typeof t?e(t):""+t},n="undefined"!=typeof process,i=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,"<div class='edo-PowerOfAttorneyStatus'> <div class='edo-PowerOfAttorneyStatus_status edo-PowerOfAttorneyStatus_fssSendDoc ws-hidden'> <component data-component='SBIS3.CONTROLS/Link' name='linkSendDoc' class='edo-PowerOfAttorneyStatus_link mainLink__2 controls-Link__disabledHover'> <option name='caption'>"+o(s(rk("Зарегистрировать доверенность в ФСС")))+"</option> <options name='handlers'> <option name='onActivated' type='function'>js!SBIS3.EDO.PowerOfAttorneyStatus:prototype.onActivatedLinkSendDoc</option> </options> </component> </div> <div class='edo-PowerOfAttorneyStatus_status edo-PowerOfAttorneyStatus_fssRegUser ws-hidden'> <component data-component='SBIS3.CONTROLS/Link' name='linkRegUser' class='edo-PowerOfAttorneyStatus_link mainLink__2 controls-Link__disabledHover'> <option name='caption'>"+o(s(rk("Зарегистрироваться в ФСС")))+"</option> <options name='handlers'> <option name='onActivated' type='function'>js!SBIS3.EDO.PowerOfAttorneyStatus:prototype.onActivatedLinkSendDoc</option> </options> </component> </div> <div class='edo-PowerOfAttorneyStatus_status edo-PowerOfAttorneyStatus_fssRegister ws-hidden'> <div class='edo-PowerOfAttorneyStatus_ico_cont'> <i class='edo-PowerOfAttorneyStatus_icoFSS controls-Button__icon js-controls-Button__icon icon-24 icon-Sandclock icon-primary'></i> </div> <div class='edo-PowerOfAttorneyStatus_textFSS'> <div class='edo-PowerOfAttorneyStatus_statusFSS ws-ellipsis'> "+o(s(rk("Выполняется регистрация в ФСС")))+" </div> <div class='edo-PowerOfAttorneyStatus_addStatusFSS ws-ellipsis'> "+o(s(rk("Процесс может занять целый день")))+" </div> </div> </div> <div class='edo-PowerOfAttorneyStatus_status edo-PowerOfAttorneyStatus_fssDownload ws-hidden'> <div class='edo-PowerOfAttorneyStatus_ico_cont'> <i class='edo-PowerOfAttorneyStatus_icoFSS controls-Button__icon js-controls-Button__icon icon-24 icon-Upload icon-primary'></i> </div> <div class='edo-PowerOfAttorneyStatus_textFSS'> <div class='edo-PowerOfAttorneyStatus_statusFSS ws-ellipsis'> "+o(s(rk("Загрузите заверенную доверенность")))+" </div> <div class='edo-PowerOfAttorneyStatus_addStatusFSS ws-ellipsis'> "+o(s(rk("С подписью и печатью")))+" </div> </div> </div> <div class='edo-PowerOfAttorneyStatus_status edo-PowerOfAttorneyStatus_fssError ws-hidden'> <div class='edo-PowerOfAttorneyStatus_ico_cont'> <i class='edo-PowerOfAttorneyStatus_icoFSS controls-Button__icon js-controls-Button__icon icon-24 icon-Alert icon-error'></i> </div> <div class='edo-PowerOfAttorneyStatus_textFSS'> <div class='edo-PowerOfAttorneyStatus_statusFSS ws-ellipsis'> "+o(s(rk("Не предоставлено в ФСС")))+" </div> <div class='edo-PowerOfAttorneyStatus_addStatusFSS ws-ellipsis'> "+o(s(rk("Предоставьте доверенность в бумажном виде до сдачи отчетности")))+" </div> </div> </div> <div class='edo-PowerOfAttorneyStatus_status edo-PowerOfAttorneyStatus_fssComplite ws-hidden'> <div class='edo-PowerOfAttorneyStatus_ico_cont'> <i class='edo-PowerOfAttorneyStatus_icoFSS controls-Button__icon js-controls-Button__icon icon-24 icon-Yes icon-done'></i> </div> <div class='edo-PowerOfAttorneyStatus_textFSS'> <div class='edo-PowerOfAttorneyStatus_statusFSS ws-ellipsis'> "+o(s(rk("Зарегистрировано в ФСС")))+" </div> <div class='edo-PowerOfAttorneyStatus_addStatusFSS ws-ellipsis'> "+o(s(rk("Теперь вы можете сдавать отчетность")))+" </div> </div> </div> </div>");return(i=o(i))+(n&&-1!==i.indexOf("{{")?String.fromCharCode(8203,8203):"")};return t.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.PowerOfAttorneyStatus"}},t});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.PowerOfAttorneyStatus", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-PowerOfAttorneyStatus{height:40px}.edo-PowerOfAttorneyStatus_link{margin-top:8px;line-height:24px}.edo-PowerOfAttorneyStatus_ico_cont{width:30px;height:40px;float:left}.edo-PowerOfAttorneyStatus_icoFSS{vertical-align:top;margin-top:8px;margin-right:6px}.edo-PowerOfAttorneyStatus_status{width:100%;height:100%}.edo-PowerOfAttorneyStatus_statusFSS{height:24px;line-height:30px;font-size:15px;font-weight:700;color:#000}.edo-PowerOfAttorneyStatus_addStatusFSS{height:16px;line-height:12px;font-size:12px;color:#999}"));head.appendChild(style);});}
define("html!SBIS3.EDO.FssRegAuth",function(){var o=function(o){var t=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;o.test(t);)t=t.replace(o,"&#123;&#123;$1&#125;&#125;");return t}}(),n=function(o){return o.join?o.join(""):o.toString()},e=function(o){return void 0===o?"":o&&"object"==typeof o?n(o):""+o},s="undefined"!=typeof process,i=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,"<div class='edo-FssRegAuth'> <div class='edo-FssRegAuth_caption ws-window-titlebar-custom'> <div class='edo-FssRegAuth_captionName'> "+t(e(rk("Регистрация представителя")))+" </div> <component data-component='SBIS3.CONTROLS/Link' name='linkHelp' class='edo-FssRegAuth_linkHelp'> <option name='icon'>sprite:icon-24 icon-Question2 icon-primary</option> <option name='href' value='https://help.sbis.ru/help/ereport/fss/4fss/other_org/#msid=s1463647960766'></option> <option name='inNewTab'>true</option> </component> </div> <div class='edo-FssRegAuth_info'> "+t(e(rk("Для сдачи отчетности уполномоченному представителю требуется:")))+" <br/>• "+t(e(rk("пройти регистрацию на портале ФСС")))+" <br/>• "+t(e(rk("предоставить доверенность в бумажном виде до сдачи отчетности")))+" </div> <div class='edo-FssRegAuth_tabs'> <component data-component='SBIS3.CONTROLS/Tab/Buttons' name='tabsRegAuth' class='edo-FssRegAuth_tabButtons ws-TabButtons__marker'> <option name='selectedKey'>tabRegAuth</option> <option name='displayProperty'>title</option> <option name='idProperty'>id</option> <option name='allowChangeEnable'>false</option> <options name='items' type='array'> <options> <option name='id'>tabRegAuth</option> <option name='align'>left</option> <option name='title'> <span class='edo-FssRegAuth_fontTabButtons'> <span class='edo-FssRegAuth_nameTabRegAuth'>"+t(e(rk("Регистрация")))+"</span> "+t(e(rk("на fz122.fss.ru")))+" </span> </option> </options> </options> </component> </div> <div class='edo-FssRegAuth_containerChange'> <component data-component='SBIS3.CONTROLS/Link' name='linkChange' class='edo-FssRegAuth_linkChange mainLink__2 controls-Link__disabledHover'> <option name='caption'>"+t(e(rk("Уже зарегистрированы?")))+"</option> <options name='handlers'> <option name='onActivated' type='function'>js!SBIS3.EDO.FssRegAuth:prototype.onActivatedLinkChange</option> </options> </component> </div> <div class='edo-FssRegAuth_radius'> <div class='edo-FssRegAuth_labelField'> <div class='edo-FssRegAuth_label'> "+t(e(rk("Логин")))+" </div> <div class='edo-FssRegAuth_star'>"+t(e(rk("*")))+"</div> <div class='edo-FssRegAuth_field'> <component data-component='SBIS3.CONTROLS/TextBox' name='fssLogin'> <option name='maxLength'>32</option> <options name='validators' type='array'> <options> <option name='option'>text</option> <option name='validator' type='function'>SBIS3.CONTROLS/Utils/ControlsValidators:required</option> </options> </options> </component> </div> </div> <div class='edo-FssRegAuth_labelField'> <div class='edo-FssRegAuth_label'> "+t(e(rk("Пароль")))+" </div> <div class='edo-FssRegAuth_star'>"+t(e(rk("*")))+"</div> <div class='edo-FssRegAuth_field'> <component data-component='SBIS3.CONTROLS/PasswordTextBox' name='fssPass'> <option name='maxLength'>20</option> <options name='validators' type='array'> <options> <option name='option'>text</option> <option name='validator' type='function'>SBIS3.CONTROLS/Utils/ControlsValidators:required</option> </options> </options> </component> </div> </div> <div class='edo-FssRegAuth_labelField edo-FssRegAuth_labelField_dPass'> <div class='edo-FssRegAuth_label'> "+t(e(rk("Повторите пароль")))+" </div> <div class='edo-FssRegAuth_star'>"+t(e(rk("*")))+"</div> <div class='edo-FssRegAuth_field'> <component data-component='SBIS3.CONTROLS/PasswordTextBox' name='fssRePass'> <option name='maxLength'>20</option> <options name='validators' type='array'> <options> <option name='validator' type='function'>js!SBIS3.EDO.FssRegAuth:prototype.validateRePassword</option> </options> </options> </component> </div> </div> </div> <div class='edo-FssRegAuth_containerAuthBtn'> <component data-component='SBIS3.CONTROLS/Button' name='authBtn' class='edo-FssRegAuth_authBtn controls-Button__big'> <option name='caption'>Зарегистрироваться</option> <option name='primary'>true</option> <options name='handlers'> <option name='onActivated' type='function'>js!SBIS3.EDO.FssRegAuth:prototype.onActivatedAuthBtn</option> </options> </component> </div> </div>");return(i=t(i))+(s&&-1!==i.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.FssRegAuth"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.FssRegAuth", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-FssRegAuth{width:469px;height:315px}.edo-FssRegAuth_caption{height:40px}.edo-FssRegAuth_captionName{float:left;margin-top:8px;margin-left:15px;font-size:18px}.edo-FssRegAuth_linkHelp{float:right;margin-top:8px;margin-right:48px}.edo-FssRegAuth_info{margin:2px 15px 0 15px;font-size:14px}.edo-FssRegAuth_tabs{margin:15px 15px 0 15px}.edo-FssRegAuth_fontTabButtons{font-size:18px;font-weight:700}.edo-FssRegAuth_containerChange{position:absolute;top:74px;right:16px;z-index:1000}.edo-FssRegAuth_linkChange{font-size:14px;text-align:right}.edo-FssRegAuth_radius{margin:15px 15px 0 15px;border:1px solid #eaeaea;border-radius:10px;height:124px}.edo-FssRegAuth_containerAuthBtn{text-align:center;vertical-align:middle;line-height:45px;margin:13px}.edo-FssRegAuth_authBtn{width:208px}.edo-FssRegAuth_labelField{height:24px;padding-top:12px}.edo-FssRegAuth_labelField>div{float:left;vertical-align:middle}.edo-FssRegAuth_field{margin-left:8px}.edo-FssRegAuth_field>div{width:250px}.edo-FssRegAuth_label{color:#8991a9;font-size:14px;line-height:24px;text-align:right;width:134px}.edo-FssRegAuth_labelOnCenter{right:28px;position:relative;top:19px}.edo-FssRegAuth_caption{font-weight:700;font-style:normal;font-size:18px}.edo-FssRegAuth_star{color:#ef463a;font-size:14px;line-height:24px;margin-left:4px}"));head.appendChild(style);});}
define('js!SBIS3.EDO.FssRegAuth',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.FssRegAuth','WS.Data/Source/SbisService','WS.Data/Entity/Record','Core/Indicator','css!SBIS3.EDO.FssRegAuth','SBIS3.CONTROLS/Link','SBIS3.CONTROLS/Button','SBIS3.CONTROLS/TextBox','SBIS3.CONTROLS/PasswordTextBox','SBIS3.CONTROLS/Tab/Buttons','SBIS3.CONTROLS/Utils/ControlsValidators','Doverennosti_localization'],function(e,t,s,a,r){var o=e.extend({_dotTplFn:t,$protected:{_options:{name:'FssRegAuth',width:469,height:315,autoHeight:false,resizable:false},_tabDraw:1,_dlog:{log:'',pas:''},_dReg:{log:'',pas:'',repas:''}},init:function(){o.superclass.init.call(this),this._dlog={log:'',pas:''},this._dReg={log:'',pas:'',repas:''},this.changeView();},onActivatedLinkChange:function(e){var t=this.getParent();t._tabDraw=0===t._tabDraw?1:0,t.changeView();},changeView:function(){var e=this,t=e.getContainer(),s=0===e._tabDraw,a=e.getChildControlByName('fssLogin'),r=e.getChildControlByName('fssPass'),o=e.getChildControlByName('fssRePass');if(s)e._dlog.log=a.getText(),e._dlog.pas=r.getText(),a.setText(e._dReg.log),r.setText(e._dReg.pas),o.setText(e._dReg.repas);else e._dReg.log=a.getText(),e._dReg.pas=r.getText(),e._dReg.repas=o.getText(),a.setText(e._dlog.log),r.setText(e._dlog.pas),o.setText();e.getChildControlByName('linkChange').setCaption(s?rk('Уже зарегистрированы?'):rk('Зарегистрироваться')+'?'),e.getChildControlByName('authBtn').setCaption(s?rk('Зарегистрироваться'):rk('Войти на портал')),t.find('.edo-FssRegAuth_nameTabRegAuth').html(s?rk('Регистрация'):rk('Авторизация')),t.find('.edo-FssRegAuth_labelField_dPass').toggle(s),t.find('.edo-FssRegAuth_labelField').toggleClass('edo-FssRegAuth_labelOnCenter',!s);},validateRePassword:function(e){var t=this,s=t.getParent(),a=s.getChildControlByName('fssPass'),r=t.getText();if(0===s._tabDraw&&r!==a.getText())return rk('Пароли не совпадают');else return true;},onActivatedAuthBtn:function(e){r.setMessage(rk('Пожалуйста, подождите')+'.');var t=this.getParent(),s=t.getParent().getOpener(),a=t.getChildControlByName('fssLogin'),o=t.getChildControlByName('fssPass'),n=t.getChildControlByName('fssRePass');if(a.validate()&&o.validate()&&n.validate())if(0===t._tabDraw)t.startReg();else s.startAuth(false,t._options.idSub,t);else r.hide();},startReg:function(){r.setMessage(rk('Выполняется регистрация на портале ФСС. Пожалуйста, подождите.'));var e=this,t=e.getParent().getOpener(),o=t.getLinkedContext(),n=e.getChildControlByName('fssLogin'),i=e.getChildControlByName('fssPass'),l=e.getChildControlByName('fssRePass'),g=new s({endpoint:{contract:'ДоверенностьЛКФСС'}}),d=new a({adapter:'adapter.sbis',format:[{name:'ИдентификаторАбонента',type:'integer'},{name:'Сертификат',type:'rpcfile'},{name:'Логин',type:'string'},{name:'Пароль',type:'string'},{name:'Фамилия',type:'string'},{name:'Имя',type:'string'},{name:'Отчество',type:'string'}]});d.set({'ИдентификаторАбонента':e._options.idSub,'Сертификат':null,'Логин':n.getText(),'Пароль':i.getText(),'Фамилия':o.getValue('record/ЛицоОтправителя.Фамилия'),'Имя':o.getValue('record/ЛицоОтправителя.Имя'),'Отчество':o.getValue('record/ЛицоОтправителя.Отчество')}),g.call('РегистрацияПользователя',{'ВходныеДанные':d}).addCallback(function(t){e.regResultProcessing(t.getRow());}).addErrback(function(s){r.hide(),i.setText(''),l.setText(''),t.showErrorAlert(s.details,e);});},regResultProcessing:function(e){var t=this,s=t.getParent(),a=s.getOpener(),o=e.get('ЭтапВыполнения'),n=e.get('КодРезультата'),i=e.get('ОписаниеОшибки'),l=t.getChildControlByName('fssLogin'),g=t.getChildControlByName('fssPass'),d=t.getChildControlByName('fssRePass');a.sendCommand('edoRead').addCallback(function(e){switch(o){case 0:switch(n){case 0:case 1:r.hide(),s.close(),a.showStatus(0);break;case-2147483645:r.hide(),g.setText(''),d.setText(''),l.markControl(rk('Логин уже используется другим пользователем'),true);break;case-2147483644:r.hide(),g.setText(''),d.setText(''),l.markControl(rk('Некорректный логин'),true);break;case-2147483643:r.hide(),g.setText(''),d.setText(''),g.markControl(rk('Некорректный пароль'),true);break;case-2147483648:r.hide(),s.close(),a.showErrorAlert(i);break;default:r.hide(),g.setText(''),d.setText(''),a.showErrorAlert(i,t);}break;case 1:switch(n){case 0:r.hide(),s.close(),a.showStatus(0);break;default:r.hide(),s.close(),a.showStatus(null),a.showErrorAlert(i);}break;default:r.hide(),s.close(),a.showErrorAlert(rk('Непредвиденная ошибка.')+'\n'+rk('Пожалуйста, обратитесь к администратору.'));}return e;});}});return o;});
define('js!SBIS3.EDO.PowerOfAttorneyStatus',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.PowerOfAttorneyStatus','WS.Data/Source/SbisService','WS.Data/Entity/Record','Lib/Control/Dialog/Dialog','Core/Indicator','SBIS3.CONTROLS/Utils/InformationPopupManager','css!SBIS3.EDO.PowerOfAttorneyStatus','SBIS3.CONTROLS/Link','js!SBIS3.EDO.FssRegAuth','Doverennosti_localization'],function(e,t,r,s,a,o,n){var i=e.extend({_dotTplFn:t,$protected:{_options:{}},_nowShowStatus:void 0,_selectCert:null,init:function(){i.superclass.init.call(this);var e=this,t=e.getLinkedContext(),r=function(){var r=t.getValue('record/СтатусДоверенности'),s=t.getValue('record/КодСПортала'),a=t.getValue('record/ВыбранныеРазрешения'),o=t.getValue('record/Доверенность.Доверитель'),n=t.getValue('record/Доверенность.Отправитель'),i,d,l;if(!t.getValue('record/ДоверительЭтоНО')&&null!==o&&null!==n&&o!==n)if(-1!==a.indexOf(3)||-1!==a.indexOf('3')){if(null===r||void 0===r)e.showStatus(null);else if(4===r)e.showStatusFromCode(s);else if(e.showStatus(r),3===r)if(i=t.getValue('record/РП.Документ/СписокВложений'),l=i?i.at(0):null,d=l?l.get('redactionId'):null,d)t.setValue('record/needSavePOA',true);}else e.hideStatus();else e.hideStatus();};if(t.getValue('record/@Документ'))r();t.subscribeTo(t,'onFieldChange',function e(s,a,o,n){if('record'===a&&t.getValue('record'))r();});},hideStatus:function(){var e;if(void 0!==this._nowShowStatus)this._nowShowStatus=void 0,(e=this.getContainer()).find('.edo-PowerOfAttorneyStatus_fssSendDoc').addClass('ws-hidden'),e.find('.edo-PowerOfAttorneyStatus_fssRegUser').addClass('ws-hidden'),e.find('.edo-PowerOfAttorneyStatus_fssRegister').addClass('ws-hidden'),e.find('.edo-PowerOfAttorneyStatus_fssDownload').addClass('ws-hidden'),e.find('.edo-PowerOfAttorneyStatus_fssError').addClass('ws-hidden'),e.find('.edo-PowerOfAttorneyStatus_fssComplite').addClass('ws-hidden');},showStatus:function(e){var t;if(this._nowShowStatus!==e)switch(this.hideStatus(),this._nowShowStatus=e,t=this.getContainer(),e){case 0:t.find('.edo-PowerOfAttorneyStatus_fssRegister').removeClass('ws-hidden');break;case 1:t.find('.edo-PowerOfAttorneyStatus_fssError').removeClass('ws-hidden');break;case 2:t.find('.edo-PowerOfAttorneyStatus_fssComplite').removeClass('ws-hidden');break;case 3:t.find('.edo-PowerOfAttorneyStatus_fssDownload').removeClass('ws-hidden');break;case 4:t.find('.edo-PowerOfAttorneyStatus_fssSendDoc').removeClass('ws-hidden');break;default:t.find('.edo-PowerOfAttorneyStatus_fssRegUser').removeClass('ws-hidden');}},showErrorAlert:function(e,t){var r=this;n.showMessageDialog({message:e,status:'error',opener:t||r});},resultProcessing:function(e,t){var r=this,s=e.get('ЭтапВыполнения'),a=e.get('КодРезультата'),i=e.get('Сертификат'),d=e.get('СтатусДоверенности'),l=e.get('ОписаниеОшибки'),u=e.get('ИдентификаторАбонента'),c=e.get('ДоверенностьС'),g=e.get('ДоверенностьПо'),f=t?t.getChildControlByName('fssLogin'):void 0,h=t?t.getChildControlByName('fssPass'):void 0,w=t?t.getChildControlByName('fssRePass'):void 0,S=r.getLinkedContext();c=c.toServerTime(),(g=g.toServerTime()).setHours(23,59,59,999),r.sendCommand('edoRead').addCallback(function(e){switch(S.setValue('record/Дата',c),S.setValue('record/Время',c),S.setValue('record/Доверенность.Срок',g),r._selectCert=i,s){case 0:switch(a){case 1:if(o.hide(),t)t.getParent().close();r.showStatus(0);break;case-2147483642:if(o.hide(),t)h.setText(''),h.markControl(rk('Неверный логин или пароль'),false),f.markControl(rk('Неверный логин или пароль'),true);else r.showDialogFssRegAuth(u);break;case-2147483648:if(o.hide(),t)t.getParent().close();r.showErrorAlert(l);break;default:if(o.hide(),t)h.setText(''),r.showErrorAlert(l,t);else r.showDialogFssRegAuth(u);}break;case 1:switch(a){case 100:o.hide();var w=r.getLinkedContext().getValue('record/delegatorNamePOA');n.showConfirmDialog({message:rk('На портале уже зарегистрирована доверенность от')+' '+w+'.\n'+rk('Заменить доверенность?'),status:'alert',opener:r,hasCancelButton:false},function(){o.setMessage(rk('Выполняется регистрация доверенности на портале ФСС. Пожалуйста, подождите.'));var e=r.createFilterForReg(true);r.getServiceFSS().call('Зарегистрировать',{'ВходныеДанные':e}).addCallback(function(e){return r.resultProcessing(e.getRow());}).addErrback(function(e){return o.hide(),r.showErrorAlert(e.details);});});break;case 0:if(o.hide(),t)t.getParent().close();r.showStatus(d);break;case-2147483648:if(o.hide(),t)t.getParent().close();r.showErrorAlert(l);break;default:if(o.hide(),t)h.setText(''),r.showErrorAlert(l,t);else r.showDialogFssRegAuth(u);}break;case 2:switch(a){case-2147483641:if(o.hide(),t)h.setText(''),r.showErrorAlert(l,t);else r.showDialogFssRegAuth(u);break;default:if(o.hide(),4===d){if(t)t.getParent().close();r.showErrorAlert(l);}else if(t)h.setText(''),r.showErrorAlert(l,t);else r.showDialogFssRegAuth(u);}break;case 3:switch(a){case 0:if(o.hide(),r.showStatus(d),t)t.getParent().close();break;case-2147483648:if(o.hide(),t)t.getParent().close();r.showErrorAlert(l);break;default:if(o.hide(),t)h.setText(''),r.showErrorAlert(l,t);else r.showDialogFssRegAuth(u);}break;default:if(o.hide(),t)t.getParent().close();r.showErrorAlert(rk('Непредвиденная ошибка.')+'\n'+rk('Пожалуйста, обратитесь к администратору.'));}return e;});},onActivatedLinkSendDoc:function(e){o.setMessage('');var t=this,r=t.getParent();if(null===t.getLinkedContext().getValue('record/СтатусДоверенности'))o.setMessage(rk('Выполняется регистрация на портале ФСС. Пожалуйста, подождите.'));else o.setMessage(rk('Выполняется регистрация доверенности на портале ФСС. Пожалуйста, подождите.'));return t.sendCommand('poaValidateFSS').addCallback(function(e){if(e&&e.valid)return t.sendCommand('edoSaveDocument').addCallback(function(){var e=r.getServiceFSS(),t=r.createFilterForReg();return e.call('Зарегистрировать',{'ВходныеДанные':t}).addCallback(function(e){return r.resultProcessing(e.getRow());});});else return new Error(e&&e.text||'');}).addErrback(function(e){if(o.hide(),e&&e.message)r.showErrorAlert(e.message);return e;});},createFilterForReg:function(e){var t=new s({adapter:'adapter.sbis',format:[{name:'@Документ',type:'integer'},{name:'РегНомерФСС',type:'string'},{name:'Контрагент',type:'integer'},{name:'ДоверенностьС',type:'date'},{name:'ДоверенностьПо',type:'date'}]}),r=this.getLinkedContext(),a=r.getValue('record/РП.Документ/СписокВложений'),o=a?a.at(0):null,n=o?o.get('redactionId'):null;if(t.set({'@Документ':r.getValue('record/@Документ'),'РегНомерФСС':r.getValue('record/КонтрагентРасширение.РегНомерФСС'),'Контрагент':r.getValue('record/Доверенность.Отправитель'),'ДоверенностьС':r.getValue('record/Дата'),'ДоверенностьПо':r.getValue('record/Доверенность.Срок')}),n)t.addField({name:'ВВД',type:'string'}),t.set('ВВД',n);if(!!e)t.addField({name:'НоваяРегистрация',type:'boolean'}),t.addField({name:'Доверитель',type:'integer'}),t.set({'НоваяРегистрация':true,'Доверитель':r.getValue('record/Доверенность.Доверитель')});return t;},showDialogFssRegAuth:function(e){new a({name:'DialogFssRegAuth',template:'js!SBIS3.EDO.FssRegAuth',resizable:false,opener:this,componentOptions:{idSub:e},modal:true,handlers:{onAfterClose:function(e,t){if(void 0===t)o.hide();}}});},showStatusFromCode:function(e){var t=this;switch(e){case 0:case 3:t.showStatus(4);break;case 4:t.showStatus(0);break;default:t.showStatus(null);}},startAuth:function(e,t,r){o.setMessage(rk('Выполняется регистрация доверенности на портале ФСС. Пожалуйста, подождите.'));var a=this,n=a.getLinkedContext(),i=new s({adapter:'adapter.sbis',format:[{name:'@Документ',type:'integer'},{name:'РегНомерФСС',type:'string'},{name:'Сертификат',type:'rpcfile'},{name:'ИдентификаторАбонента',type:'integer'}]}),d=n.getValue('record/РП.Документ/СписокВложений'),l=d?d.at(0):null,u=l?l.get('redactionId'):null,c=a.getServiceFSS(),g,f,h,w,S,m,C;if(i.set({'@Документ':parseInt(n.getValue('record/РП.Документ/ИдО'),10),'РегНомерФСС':n.getValue('record/КонтрагентРасширение.РегНомерФСС'),'Сертификат':a._selectCert,'ИдентификаторАбонента':t}),u)i.addField({name:'ВВД',type:'string'}),i.set('ВВД',u);if(!!e)i.addField({name:'ВыбранСертификат',type:'boolean'}),i.set('ВыбранСертификат',true);if(r)g=(m=new Date(n.getValue('record/Дата'))).toServerTime(),f=(C=new Date(n.getValue('record/Доверенность.Срок'))).toServerTime(),w=r.getChildControlByName('fssLogin'),S=r.getChildControlByName('fssPass'),h=r.getChildControlByName('fssRePass'),i.addField({name:'ДоверенностьС',type:'date'}),i.addField({name:'ДоверенностьПо',type:'date'}),i.addField({name:'Логин',type:'string'}),i.addField({name:'Пароль',type:'string'}),i.set({'ДоверенностьС':g,'ДоверенностьПо':f,'Логин':w.getText(),'Пароль':S.getText()});c.call('Зарегистрировать',{'ВходныеДанные':i}).addCallback(function(e){a.resultProcessing(e.getRow(),r);}).addErrback(function(e){if(o.hide(),r)S.setText(''),h.setText('');a.showErrorAlert(e.details,r||a);});},getServiceFSS:function(){return new r({endpoint:{contract:'ДоверенностьЛКФСС'}});}});return i;});
define('js!SBIS3.EDO.PowerOfAttorneyDialog',['js!SBIS3.EDO2.FormController','html!SBIS3.EDO.PowerOfAttorneyDialog','Core/Indicator','Core/Deferred','Core/CommandDispatcher','js!SBIS3.EDO2.Dialog','WS.Data/Source/SbisService','js!SBIS3.EDO2.PowerOfAttorneyModel','SBIS3.CONTROLS/Utils/InformationPopupManager','css!SBIS3.EDO.PowerOfAttorneyDialog','js!SBIS3.EDO2.MainTabHeaderTemplate','js!SBIS3.EDO.PowerOfAttorneyForSign','SBIS3.CONTROLS/TextBox','SBIS3.CONTROLS/Date/Range','js!SBIS3.EDO.PowerOfAttorneyStatus','SBIS3.CONTROLS/EditAtPlace','SBIS3.CONTROLS/Utils/ControlsValidators','Doverennosti_localization'],function(e,t,a,o,r,n,i,l,d){var s=rk('Срок действия не должен превышать пять лет'),c=e.extend({_dotTplFn:t,$protected:{_options:{autoHeight:true,name:'PowerOfAttorneyDialog',dataSource:{endpoint:{contract:'Доверенность'},binding:{read:'Документ.ПрочитатьДляУчастника',format:'Доверенность.Format',create:'Создать',destroy:'Удалить'},model:l,idProperty:'@Документ'},readMetaData:{'ИмяОбъекта':'Доверенность'},significantFields:[],idOpenerOrg:null}},_saveConvertedDates:true,_printing:false,$constructor:function(){var e=this,t=e.getLinkedContext(),o,n;if(r.declareCommand(e,'powerOfAttorneyPrint',e.powerOfAttorneyPrint),r.declareCommand(e,'poaValidateFSS',e._poaValidateFSS),t.getValue('record/@Документ')&&t.getValue('record/Событие'))$.cookie('ActivePhase_Document',t.getValue('record/@Документ'),{path:'/'}),$.cookie('ActivePhase_Event',t.getValue('record/Событие'),{path:'/'});else a.setMessage(rk('Загрузка данных')),n=e._options.key,(o=new i({endpoint:{contract:'Документ'}})).call('ДанныеФаз',{'Документы':[n]}).addCallback(function(t){var o=t.getAll();if(o&&o.getCount()){var r=o.at(0).get('идСобытия');if(n&&r)$.cookie('ActivePhase_Event',r,{path:'/'}),$.cookie('ActivePhase_Document',n,{path:'/'}),e.sendCommand('edoRead').addCallback(function(){a.hide();}).addErrback(function(e){a.hide();});else a.hide();}else a.hide();}).addErrback(function(e){a.hide();});},getIdOpenerOrg:function(){return this._options.idOpenerOrg||null;},validateDateRange:function(e){var t=this,a=this._poaPrevDateTo,o=t.getStartValue(),r=t.getEndValue(),n=new Date(),i=t.getContext(),l=i.getValue('record/СтатусДоверенности'),d;if(!o||!r)d=rk('Поле обязательно для заполнения');else if(r=new Date(r),r.setHours(23,59,59,999),r<n)d=rk('Срок действия не может быть меньше текущей даты');else if(r>a&&i.getValue('record/Доверенность.Использовано'))d=rk('Дата окончания действия доверия должна быть меньше ранее установленной даты.');else if(1===l||2===l||3===l){var s=new Date(o);if(s.setFullYear(s.getFullYear()+5),s.setHours(r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()),s<r)d=rk('Срок действия зарегистрированной доверенности не должен превышать пять лет');}return d||true;},onInitDateRange:function(){this._poaPrevDateTo=this.getEndValue();},powerOfAttorneyPrint:function(){var e=this;if(e.getLinkedContext().getValue('record').isChanged())e.getChildControlByName('PowerOfAttorneyEDODialog').sendCommand('edoSaveDocument',{close:false}).addCallback(function(t){e.showPrintedForm();});else e.showPrintedForm();},_poaValidateFSS:function(){var e=new o(),t=this.getLinkedContext(),a=new Date(t.getValue('record/Дата')),r=new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0,0),n=new Date(t.getValue('record/Доверенность.Срок')),i='',l;if(r.setFullYear(r.getFullYear()+5),r.setDate(r.getDate()+1),r>n)e.dependOn(this.getChildControlByName('PowerOfAttorneyForSign').sendCommand('poaValidateNumberFSS'));else{if(l=this.getChildControlByName('additionalInfo1')._textField,l)l.click(),this.getChildControlByName('DRDates').markControl(s,true);else i=s;e.callback({valid:false,text:i});}return e;},showPrintedForm:function(){var e=this,t=e.getLinkedContext().getValue('record/@Документ'),a=function(){var a=new o();return require(['js!SBIS3.FED.DocView','js!SBIS3.FED.DocContext','js!SBIS3.FED.FormLib'],function(o,r,n){n.showLetterPrintDialog(t,e).addCallback(function(){a.callback();}).addErrback(function(e){a.errback(e);});},function(e){a.errback(e);}),a;};if(!e._printing)e._printing=true,a().addCallback(function(){e._printing=false;}).addErrback(function(t){e._printing=false,d.showMessageDialog({message:rk('Не удалось получить печатную форму доверенности.'),details:rk('Мы знаем об этом и уже исправляем. Попробуйте заглянуть сюда через 15 минут.'),status:'error',opener:e});});}});return c.webPage={htmlTemplate:'\\Тема Скрепка\\Шаблоны\\grayThemeEditNarrow.html',outFileName:'PowerOfAttorneyDialog'},n.dimensions={minWidth:'710px',width:'710px',height:'auto'},c.dimensions={minWidth:'710px',width:'710px',height:'auto'},c;});
define("html!SBIS3.EDO.ThatSignDialog",function(){var o=function(o){var n=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;o.test(n);)n=n.replace(o,"&#123;&#123;$1&#125;&#125;");return n}}(),t=function(o){return o.join?o.join(""):o.toString()},i=function(o){return void 0===o?"":o&&"object"==typeof o?t(o):""+o},e="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,"<div class='edo-ThatSignDialog'> <div class='edo-ThatSignDialog_docTypesArea'> <div class='edo-ThatSignDialog_docTypesArea_browser'> <component data-component='SBIS3.CONTROLS/DataGridView' name='dgvDocTypesList' class='edo-ThatSignDialog_docTypesList controls-DataGridView__hasSeparator controls-ListView__orangeMarker'> <option name='displayProperty'>Название</option> <option name='idProperty'>Номер</option> <option name='emptyHTML'>Нет данных</option> <options name='columns' type='array'> <options> <option name='title'>Тип документа</option> <option name='cellTemplate'>html!SBIS3.EDO.ThatSignDialog/resources/docTypeCellTemplate</option> </options> </options> <options name='dataSource'> <option name='module'>WS.Data/Source/SbisService</option> <options name='options'> <option name='endpoint'>Доверенность</option> <options name='binding'> <option name='query'>СписокПолномочий</option> </options> <option name='idProperty'>Идентификатор</option> </options> </options> <options name='itemsActions' type='array'> </options> <option name='itemsDragNDrop' value=''></option> <option name='ignoreLocalPageSize'>true</option> <option name='showHead'>false</option> <option name='multiselect'>false</option> <option name='partialPaging'>false</option> <option name='showPaging'>false</option> <option name='paging'>no</option> <option name='tabindex'>1</option> <options name='handlers'> <option name='onItemActivate' type='function'>js!SBIS3.EDO.ThatSignDialog:prototype.onItemActivateDocTypesList</option> </options> </component> </div> <div class='edo-ThatSignDialog_docTypesInfo'> "+n(i(rk("Все остальные, не перечисленные в списке документы, могут подписывать все сотрудники с электронной подписью.")))+" </div> </div> <div class='edo-ThatSignDialog_usersArea'> <div> <component data-component='SBIS3.CONTROLS/DataGridView' name='dgvUsersList' class='edo-ThatSignDialog_usersList controls-DataGridView__hasSeparator controls-ListView__hideCheckBoxes controls-ListView__withoutMarker'> <option name='displayProperty'>ЛицоОтправителя.Фамилия</option> <option name='idProperty'>Лицо</option> <option name='emptyHTML'>Нет данных</option> <options name='columns' type='array'> <options> <option name='title'>Сотрудники</option> <option name='cellTemplate'>html!SBIS3.EDO.ThatSignDialog/resources/userCellTemplate</option> <options name='includedTemplates'> <option name='photoTpl'>html!SBIS3.PersonCore.Photo/photoCellTpl</option> </options> <options name='templateBinding'> <option name='photoFldName'>userPhotoData</option> <option name='cssClass'>person-photo-mini-large</option> </options> </options> </options> <options name='filter'> <option name='Контрагент' bind='@Лицо'></option> <option name='Полномочие' bind='filterAuthority' oneWay='true' direction='fromContext' nonexistent='0'></option> </options> <options name='dataSource'> <option name='module'>WS.Data/Source/SbisService</option> <options name='options'> <option name='endpoint'>Доверенность</option> <options name='binding'> <option name='query'>СписокПользователейНаделенныхПолномочием</option> </options> </options> <option name='idProperty'>Лицо</option> </options> <options name='itemsActions' type='array'> </options> <option name='itemsDragNDrop' value=''></option> <option name='ignoreLocalPageSize'>true</option> <option name='showHead'>false</option> <option name='multiselect'>false</option> <option name='partialPaging'>false</option> <option name='showPaging'>false</option> <option name='paging'>no</option> <option name='tabindex'>2</option> <option name='itemsSortMethod' type='function'>js!SBIS3.EDO.ThatSignDialog:prototype.itemsSortMethodUsersList</option> </component> </div> <div class='edo-ThatSignDialog_basement'></div> </div> </div>");return(a=n(a))+(e&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.ThatSignDialog"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.ThatSignDialog", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-ThatSignDialog{margin:16px 8px 8px 8px;display:table;height:auto}.edo-ThatSignDialog_docTypesArea{vertical-align:top;display:table-cell!important;display:inline;width:300px;min-width:300px;border-right:2px solid #f5f5f5}.edo-ThatSignDialog_docTypesArea_browser{width:100%}.edo-ThatSignDialog_docTypesList{width:292px;margin:0 0 8px 0}.edo-ThatSignDialog_docTypeRow_p1{margin-left:10px}.edo-ThatSignDialog_docTypeRow_p2{margin-left:20px}.edo-ThatSignDialog_docTypesInfo{color:#ccc;font-size:12px}.edo-ThatSignDialog_usersArea{vertical-align:top;display:table-cell!important;display:inline;width:100%;min-width:350px}.edo-ThatSignDialog_usersList{margin:0 8px}.edo-ThatSignDialog_userRow{height:40px}.edo-ThatSignDialog_userRow_photo{width:34px;height:34px;padding:3px 0 1px 0;float:left}.edo-ThatSignDialog_userRow_user{margin:0 0 0 40px}.edo-ThatSignDialog_userRow_name{color:#000;height:20px;line-height:20px;font-size:14px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.edo-ThatSignDialog_userRow_post{color:#999;height:18px;line-height:18px;font-size:12px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.edo-ThatSignDialog_basement{margin:8px;color:#999;font-size:14px}.edo-ThatSignDialog_noLeader{color:#ef463a!important}"));head.appendChild(style);});}
define("html!SBIS3.EDO.ThatSignDialog/resources/docTypeCellTemplate",function(){var e=function(e){var o=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(o){for(;e.test(o);)o=o.replace(e,"&#123;&#123;$1&#125;&#125;");return o}}(),n=function(e){return e.join?e.join(""):e.toString()},r=function(e){return void 0===e?"":e&&"object"==typeof e?n(e):""+e},t="undefined"!=typeof process,i=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,"<div class='edo-ThatSignDialog_docTypeRow'> "),a=e.item.get("Отступ");return i+=" <span class='",a&&(i+="edo-ThatSignDialog_docTypeRow_p"+o(r(a))),i+=" '> "+o(r(e.item.get("Название")))+" </span> </div>",(i=o(i))+(t&&-1!==i.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.ThatSignDialog/resources/docTypeCellTemplate"}},e});
define("html!SBIS3.EDO.ThatSignDialog/resources/userCellTemplate",function(){var e=function(e){var t=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;e.test(t);)t=t.replace(e,"&#123;&#123;$1&#125;&#125;");return t}}(),i=function(e){return e.join?e.join(""):e.toString()},o=function(e){return void 0===e?"":e&&"object"==typeof e?i(e):""+e},r="undefined"!=typeof process,n=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,"<div class='edo-ThatSignDialog_userRow'> <div class='edo-ThatSignDialog_userRow_photo'> "+t(o(e.included.photoTpl(e)))+" </div> <div class='edo-ThatSignDialog_userRow_user'> "),s=(e.item.get("ЛицоОтправителя.Фамилия")||"")+" "+(e.item.get("ЛицоОтправителя.Имя")||"")+" "+(e.item.get("ЛицоОтправителя.Отчество")||""),a=e.item.get("Должность")||"",l=e.item.get("НазваниеСтруктуры")||"",u=(a||"")+(a&&l?" / ":"")+(l||"");return n+=" <div class='edo-ThatSignDialog_userRow_name' title='"+t(o(s))+"'> "+t(o(s))+" </div> <div class='edo-ThatSignDialog_userRow_post' title='"+t(o(u))+"'> "+t(o(u))+" </div> </div> </div>",(n=t(n))+(r&&-1!==n.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.ThatSignDialog/resources/userCellTemplate"}},e});
define('js!SBIS3.EDO.ThatSignDialog',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.ThatSignDialog','css!SBIS3.EDO.ThatSignDialog','SBIS3.CONTROLS/DataGridView','html!SBIS3.EDO.ThatSignDialog/resources/docTypeCellTemplate','html!SBIS3.PersonCore.Photo/photoCellTpl','html!SBIS3.EDO.ThatSignDialog/resources/userCellTemplate','Doverennosti_localization'],function(e,t){var o=e.extend({$protected:{_options:{}},_controls:{},_dotTplFn:t,_needReload:false,$constructor:function(){this.getContext().setValue('filterAuthority',0);},init:function(){o.superclass.init.call(this);var e=this;e._controls={permissions:e.getChildControlByName('dgvDocTypesList'),users:e.getChildControlByName('dgvUsersList'),basement:e.getContainer().find('.edo-ThatSignDialog_basement')};},reloadUsersList:function(e){var t=this,o=t.getLinkedContext();if(o.getValue('НашаОрганизация.ОграничиватьПраваПодписи')){if(t._needReload)t._controls.users.reload();else t._needReload=!t._needReload;if(t._controls.users.show(),o.getValue('НашаОрганизация.Руководитель'))t._controls.basement.hide();else t._controls.basement.text(rk('Внимание! Не задан руководитель!')),t._controls.basement.addClass('edo-ThatSignDialog_noLeader'),t._controls.basement.show();}else t._controls.basement.text(rk('Подписывает любой сотрудник с электронной подписью, выданной на эту организацию.')),t._controls.basement.removeClass('edo-ThatSignDialog_noLeader'),t._controls.basement.show(),t._controls.users.hide();},onItemActivateDocTypesList:function(e,t){var o=this.getLinkedContext();if(o.getValue('НашаОрганизация.ОграничиватьПраваПодписи'))o.setValue('filterAuthority',t.item.get('Идентификатор'));},itemsSortMethodUsersList:function(e,t){var o=e.item.getContents(),s=t.item.getContents();return(o.get('ЛицоОтправителя.Фамилия')||'')+' '+(o.get('ЛицоОтправителя.Имя')||'')+' '+(o.get('ЛицоОтправителя.Отчество')||'')>(s.get('ЛицоОтправителя.Фамилия')||'')+' '+(s.get('ЛицоОтправителя.Имя')||'')+' '+(s.get('ЛицоОтправителя.Отчество')||'')?1:-1;}});return o;});
define("tmpl!SBIS3.EDO.FilterIncomingNew",["Core/tmpl/js/tclosure","js!SBIS3.EDO.BaseFilter.Period","js!SBIS3.EDO.BaseFilter.State","js!SBIS3.EDO.BaseFilter.Marks","js!SBIS3.EDO.BaseFilter.Regulation","js!SBIS3.EDO.BaseFilter.ResponsibleFace","js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleMe","js!SBIS3.EDO.BaseFilter.Face1","js!SBIS3.EDO.BaseFilter.Unfixed","js!SBIS3.EDO.BaseFilter.OurOrganisation","js!SBIS3.EDO.BaseFilter.Unread","js!SBIS3.EDO.BaseFilter.DocumentType","js!SBIS3.EDO.BaseFilter.RightsLimText"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.EDO.BaseFilter.Period"]=e[1],r["js!SBIS3.EDO.BaseFilter.State"]=e[2],r["js!SBIS3.EDO.BaseFilter.Marks"]=e[3],r["js!SBIS3.EDO.BaseFilter.Regulation"]=e[4],r["js!SBIS3.EDO.BaseFilter.ResponsibleFace"]=e[5],r["js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleMe"]=e[6],r["js!SBIS3.EDO.BaseFilter.Face1"]=e[7],r["js!SBIS3.EDO.BaseFilter.Unfixed"]=e[8],r["js!SBIS3.EDO.BaseFilter.OurOrganisation"]=e[9],r["js!SBIS3.EDO.BaseFilter.Unread"]=e[10],r["js!SBIS3.EDO.BaseFilter.DocumentType"]=e[11],r["js!SBIS3.EDO.BaseFilter.RightsLimText"]=e[12];var o=function e(o,i,a,n,l){function s(){}var c=0,d=void 0!==t&&t?t:arguments[arguments.length-1];void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure"));var S={};l&&l.isSetts&&(S=l.fullContext||{});var p="string"==typeof a?a:"",u=void 0===r?void 0:r,B={id:[],def:void 0},m=d.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),y=this&&this.includedTemplates?this.includedTemplates:{},f=d.getMarkupGenerator(n);try{var F=f.joinElements([f.createTag("div",{class:"edo-BaseFilter__filterPicker"},[f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Period",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,u,y,d.config,S),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.State",{items:[{key:"-1",title:global.rk("В любом состоянии")},{key:"10",title:global.rk("Внутренняя обработка")},{key:"7",title:global.rk("Утвержденные")},{key:"9",title:global.rk("Отклоненные")},{key:"22",title:global.rk("Аннулированные")},{key:"19,20",title:global.rk("Удалено мной/контрагентом")},{key:"0,1",title:global.rk("Черновики")},{key:"-2",title:global.rk("Удаленные")}],esc:!1},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,u,y,d.config,S),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Marks",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,u,y,d.config,S),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Regulation",{multiselect:!0,docTypes:d.getter(o,["docTypes"]),hidePhase:!0},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,u,y,d.config,S),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ResponsibleFace",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,u,y,d.config,S),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.AuthorOrResponsibleMe",{useMineStr:!0},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,u,y,d.config,S),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Face1",{caption:global.rk("Отправитель")},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,u,y,d.config,S),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Unfixed",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,u,y,d.config,S),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.OurOrganisation",{addHead:!0},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,u,y,d.config,S),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Unread",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,u,y,d.config,S),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.DocumentType",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,u,y,d.config,S),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.RightsLimText",{textRender:d.getTypeFunc("js!SBIS3.EDO.ScopeFilters:setScopeTextForFilter ",{}),hideGlobalText:!0,esc:!1},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,u,y,d.config,S)],i,B,this)],p,B);B.def&&(F=f.chain(F,B,i),B=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/Filtry/FilterIncomingNew/FilterIncomingNew.tmpl",e,o)}return F||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FilterIncomingNew"}},o});
define('js!SBIS3.EDO.FilterIncomingNew',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FilterIncomingNew','js!SBIS3.EDO.BaseFilter.RightsLimText','js!SBIS3.EDO.BaseFilter.Period','js!SBIS3.EDO.BaseFilter.State','js!SBIS3.EDO.BaseFilter.Marks','js!SBIS3.EDO.BaseFilter.ResponsibleFace','js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleMe','js!SBIS3.EDO.BaseFilter.Face1','js!SBIS3.EDO.BaseFilter.Regulation','js!SBIS3.EDO.BaseFilter.Unfixed','js!SBIS3.EDO.BaseFilter.Unread','js!SBIS3.EDO.BaseFilter.SpecificPerformer','js!SBIS3.EDO.BaseFilter.OurOrganisation','js!SBIS3.EDO.BaseFilter.DocumentType','Elektronnyj_dokumentooborot_localization'],function(e,t){var i=e.extend({_dotTplFn:t,$protected:{_options:{docTypes:[{docTypeString:'ДокОтгрВх',subDocTypeString:''},{docTypeString:'ФактураВх',subDocTypeString:''},{docTypeString:'КоррВх',subDocTypeString:''},{docTypeString:'АктСверВх',subDocTypeString:''},{docTypeString:'ДоговорВх',subDocTypeString:''},{docTypeString:'ДоговорДок',subDocTypeString:''},{docTypeString:'АктСверкиДок',subDocTypeString:''}]}},$constructor:function(){},init:function(){i.superclass.init.call(this);}});return i;});
define("tmpl!SBIS3.EDO.FilterIncomingNewSelector",["Core/tmpl/js/tclosure","js!SBIS3.EDO.BaseFilter.MarksSelector","js!SBIS3.EDO.BaseFilter.ResponsibleFaceSelector","js!SBIS3.EDO.BaseFilter.Face1Selector","js!SBIS3.EDO.BaseFilter.RegulationSelector","js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleMeSelector","js!SBIS3.EDO.BaseFilter.UnreadSelector","js!SBIS3.EDO.BaseFilter.UnfixedSelector","js!SBIS3.EDO.BaseFilter.OurOrganisationSelector","js!SBIS3.EDO.BaseFilter.DocumentTypeSelector"],function(){var e=Array.prototype.slice.call(arguments),r=e[0],t={};t["js!SBIS3.EDO.BaseFilter.MarksSelector"]=e[1],t["js!SBIS3.EDO.BaseFilter.ResponsibleFaceSelector"]=e[2],t["js!SBIS3.EDO.BaseFilter.Face1Selector"]=e[3],t["js!SBIS3.EDO.BaseFilter.RegulationSelector"]=e[4],t["js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleMeSelector"]=e[5],t["js!SBIS3.EDO.BaseFilter.UnreadSelector"]=e[6],t["js!SBIS3.EDO.BaseFilter.UnfixedSelector"]=e[7],t["js!SBIS3.EDO.BaseFilter.OurOrganisationSelector"]=e[8],t["js!SBIS3.EDO.BaseFilter.DocumentTypeSelector"]=e[9];var o=function e(o,l,n,i,a){function s(){}var c=0,S=void 0!==r&&r?r:arguments[arguments.length-1];void 0===S&&(eval("var thelpers = null;"),S=global.requirejs("View/Runner/tclosure"));var d={};a&&a.isSetts&&(d=a.fullContext||{});var u="string"==typeof n?n:"",p=void 0===t?void 0:t,B={id:[],def:void 0},m=S.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),f=this&&this.includedTemplates?this.includedTemplates:{},F=S.getMarkupGenerator(i);try{var y=F.joinElements([F.createTag("div",{class:"edo-BaseFilter__filterPicker  edo-twoColumnSelectors"},[F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.MarksSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},n,p,f,S.config,d),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ResponsibleFaceSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},n,p,f,S.config,d),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Face1Selector",{caption:global.rk("Отправителя")},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},n,p,f,S.config,d),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.RegulationSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},n,p,f,S.config,d),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.AuthorOrResponsibleMeSelector",{useMineStr:!0},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},n,p,f,S.config,d),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.UnreadSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},n,p,f,S.config,d),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.UnfixedSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},n,p,f,S.config,d),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.OurOrganisationSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},n,p,f,S.config,d),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.DocumentTypeSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},n,p,f,S.config,d)],l,B,this)],u,B);B.def&&(y=F.chain(y,B,l),B=void 0)}catch(e){S.templateError("resources/Elektronnyj_dokumentooborot/Filtry/FilterIncomingNew/FilterIncomingNewSelector/FilterIncomingNewSelector.tmpl",e,o)}return y||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FilterIncomingNewSelector"}},o});
define("html!SBIS3.EDO.FilterDeliveryMethod",function(){var e=function(e){var t=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;e.test(t);)t=t.replace(e,"&#123;&#123;$1&#125;&#125;");return t}}(),o=function(e){return e.join?e.join(""):e.toString()},n=function(e){return void 0===e?"":e&&"object"==typeof e?o(e):""+e},i="undefined"!=typeof process,r=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div> <component data-component="SBIS3.EDO.HideContainer" name="HideContainer" class="edo-EDOCtxFilter_HideContainer"> <div> <div>'+t(n(rk("Способ доставки")))+'</div> <component data-component="SBIS3.CONTROLS/FieldLink" name="FieldLinkDeliveryMethod" class="edo-EDOCtxFilter__FieldLink"> <opt name="text" bind="DeliveryMethod"></opt> <opt name="selectedKeys" bind=\'FilterDeliveryMethod\'></opt> <opt name=\'textValue\' bind=\'FilterDeliveryMethodText\' direction="fromProperty" oneWay="true" value=""/> <opt name="placeholder" value="'+t(n(rk("Укажите способ доставки")))+'"></opt> <opt name="displayProperty" value="Название"></opt> <opt name="idProperty" value="Ид"></opt> <opt name="usePicker" value="false"></opt> <opts name="dictionaries" type="array"> <opts> <opt name="template">js!SBIS3.EDO.DeliveryMethodDictionary</opt> <opt name="editMode">newFloatArea</opt> <opt name="idProperty">Ид</opt> <opt name="name">Выбор способа доставки</opt> <opt name="readOnly" type="boolean">true</opt> </opts> </opts> <opts name="list"> <opt name="component" value="SBIS3.CONTROLS/DataGridView"/> <opts name="options"> <opts name="itemsActions"></opts> <opts name="columns" type="array"> <opts> <opt name="title">'+t(n(rk("Название")))+'</opt> <opt name="field">Название</opt> </opts> </opts> <opt name="idProperty" value="Ид"></opt> </opts> </opts> <opts name="listFilter"> <opt name="Название" bind="DeliveryMethod" oneWay="true"/> </opts> </component> </div> <opt name="bindingChildName">FieldLinkDeliveryMethod</opt> <opt name="childEmptyItem">Все</opt> <opt name="value" bind="FilterDeliveryMethodShow"></opt> </component> </div>');return(r=t(r))+(i&&-1!==r.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.FilterDeliveryMethod"}},e});
define("html!SBIS3.EDO.DeliveryMethodDictionary",function(){var o=function(o){var e=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(e){for(;o.test(e);)e=e.replace(o,"&#123;&#123;$1&#125;&#125;");return e}}(),t=function(o){return o.join?o.join(""):o.toString()},n=function(o){return void 0===o?"":o&&"object"==typeof o?t(o):""+o},i="undefined"!=typeof process,r=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div> <div> <div class="edo-DeliveryMethodDictionary_title"> '+e(n(rk("Способы доставки")))+' </div> <div class="edo-DeliveryMethodDictionary_button"> <component data-component="SBIS3.CONTROLS/Button" name="SelectButton"> <option name="caption">'+e(n(rk("Выбрать")))+'</option> <option name="primary">true</option> </component> </div> </div> <component data-component="SBIS3.CONTROLS/DataGridView" name="view" class="controls-ListView__showCheckBoxes edo-DeliveryMethodDictionary_DataGridView"> <options name="columns" type="array"> <options> <option name="field">Название</option> </options> </options> <option name="showHead">false</option> <options name="itemsActions" type="array"></options> <option name="multiselect">true</option> </component> </div>');return(r=e(r))+(i&&-1!==r.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.DeliveryMethodDictionary"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.DeliveryMethodDictionary", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-DeliveryMethodDictionary_title{float:left;font-family:'TensorFont Regular',TensorFont!important;font-size:18px!important;font-weight:700!important;cursor:default;text-overflow:ellipsis;overflow:hidden;padding-left:8px;line-height:40px}.edo-DeliveryMethodDictionary_button{line-height:40px;padding-left:52px;display:inline-block}.edo-DeliveryMethodDictionary_DataGridView{height:auto;width:320px;margin-top:10px}"));head.appendChild(style);});}
define('js!SBIS3.EDO.DeliveryMethodDictionary',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.DeliveryMethodDictionary','WS.Data/Source/Memory','SBIS3.CONTROLS/DataGridView','SBIS3.CONTROLS/Button','css!SBIS3.EDO.DeliveryMethodDictionary','Elektronnyj_dokumentooborot_localization'],function(t,e,o){return t.extend({_dotTplFn:e,$protected:{_options:{}},$constructor:function(){this.once('onReady',function(){this._setDataSource(),this._setHandlers();}.bind(this));},_setDataSource:function(){var t=this.getChildControlByName('view'),e=[{'Ид':-1,'Название':rk('Не выбрано')},{'Ид':0,'Название':rk('Почтой')},{'Ид':1,'Название':rk('На e-mail')},{'Ид':2,'Название':rk('Доставка курьером')},{'Ид':3,'Название':rk('По факсу')},{'Ид':4,'Название':rk('Телефонограммой')},{'Ид':5,'Название':rk('Электронно')},{'Ид':6,'Название':rk('Доставка нашим сотрудником')},{'Ид':7,'Название':rk('Заказным письмом')},{'Ид':8,'Название':rk('Ценным письмом')},{'Ид':10,'Название':rk('Экспресс-почтой')}],i=new o({data:e,idProperty:'Ид'});t.setDataSource(i);},_setHandlers:function(){var t=this.getChildControlByName('view');this.getChildControlByName('SelectButton').subscribe('onActivated',function(){this.sendCommand('close',t.getSelectedKeys());}.bind(this));}});});
define('js!SBIS3.EDO.FilterDeliveryMethod',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.FilterDeliveryMethod','WS.Data/Source/Memory','js!SBIS3.EDO.HideContainer','SBIS3.CONTROLS/FieldLink','js!SBIS3.EDO.DeliveryMethodDictionary','Elektronnyj_dokumentooborot_localization'],function(e,t,r){return e.extend({_dotTplFn:t,$protected:{_options:{}},$constructor:function(){this.once('onReady',function(){this._setDataSource();}.bind(this));},_setDataSource:function(){var e=[{'Ид':-1,'Название':rk('Не выбрано')},{'Ид':0,'Название':rk('Почтой')},{'Ид':1,'Название':rk('На e-mail')},{'Ид':2,'Название':rk('Доставка курьером')},{'Ид':3,'Название':rk('По факсу')},{'Ид':4,'Название':rk('Телефонограммой')},{'Ид':5,'Название':rk('Электронно')},{'Ид':6,'Название':rk('Доставка нашим сотрудником')},{'Ид':7,'Название':rk('Заказным письмом')},{'Ид':8,'Название':rk('Ценным письмом')},{'Ид':10,'Название':rk('Экспресс-почтой')}],t=new r({data:e,idProperty:'Ид'});this.getChildControlByName('FieldLinkDeliveryMethod').setDataSource(t);}});});
define("html!SBIS3.EDO.FilterDeliveryMethodSelector",function(){var e=function(e){var n=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;e.test(n);)n=n.replace(e,"&#123;&#123;$1&#125;&#125;");return n}}(),t=function(e){return e.join?e.join(""):e.toString()},o=function(e){return void 0===e?"":e&&"object"==typeof e?t(e):""+e},r="undefined"!=typeof process,i=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div> <component data-component="SBIS3.EDO.FilterLinkButtonCtx" style="display:inline-block;padding-left:16px;"> <option name="fValue">true</option> <option name="fText">'+n(o(rk("Способ доставки")))+'</option> <option name="fTitle">ФильтрСпособДоставки</option> <option name="value" bind="FilterDeliveryMethodShow" value=""></option> </component> </div>');return(i=n(i))+(r&&-1!==i.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.FilterDeliveryMethodSelector"}},e});
define('js!SBIS3.EDO.FilterDeliveryMethodSelector',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.FilterDeliveryMethodSelector','js!SBIS3.EDO.FilterLinkButtonCtx','Elektronnyj_dokumentooborot_localization'],function(e,t){var i=e.extend({_dotTplFn:t,$protected:{_options:{}},$constructor:function(){var e=this.getLinkedContext();if(e&&!e.getValue('FilterDeliveryMethodShow'))e.setValue('FilterDeliveryMethodShow',null);},init:function(){i.superclass.init.call(this);}});return i;});
define("tmpl!SBIS3.EDO.DeliveryMethodSelector",["Core/tmpl/js/tclosure","js!SBIS3.CONTROLS/Filter/Button/Link"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.CONTROLS/Filter/Button/Link"]=e[1];var i=function e(i,o,n,l,a){function d(){}var s=0,c=void 0!==t&&t?t:arguments[arguments.length-1];void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure"));var u={};a&&a.isSetts&&(u=a.fullContext||{});var v="string"==typeof n?n:"",p=void 0===r?void 0:r,m={id:[],def:void 0},f=c.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,i),y=this&&this.includedTemplates?this.includedTemplates:{},S=c.getMarkupGenerator(l);try{var h=S.joinElements([S.createTag("div",{class:"edo-BaseFilter_flbColumn"},[S.createControl("wsControl","ws:SBIS3.CONTROLS/Filter/Button/Link",{commandArgs:["FilterDeliveryMethodVisibility",Boolean(!0)],caption:c.getter(i,["caption"]),name:"FilterLink",command:"change-field-internal",bindings:[{fieldName:"FilterDeliveryMethodVisibility",propName:"invertedVisible",propPath:[],fullPropName:"invertedVisible",propPathStr:"",oneWay:!0,direction:"fromContext",bindNonExistent:!1}],invertedVisible:void 0,esc:!1},{name:"FilterLink",sbisname:"FilterLink"},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},n,p,y,c.config,u)],o,m,this)],v,m);m.def&&(h=S.chain(h,m,o),m=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/Filtry/FilterLetter/resources/DeliveryMethodSelector/DeliveryMethodSelector.tmpl",e,i)}return h||""};return i.includedFunctions={},i.stable=!0,i.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.DeliveryMethodSelector"}},i});
define('js!SBIS3.EDO.DeliveryMethodSelector',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.DeliveryMethodSelector','SBIS3.CONTROLS/Filter/Button/Link','Elektronnyj_dokumentooborot_localization'],function(t,e){var n=t.extend({_dotTplFn:e,$protected:{_options:{caption:rk('Способ доставки')}},$constructor:function(){},init:function(){n.superclass.init.call(this);}});return n;});
define('js!SBIS3.EDO.FilterIncomingNewSelector',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FilterIncomingNewSelector','js!SBIS3.EDO.BaseFilter.MarksSelector','js!SBIS3.EDO.BaseFilter.ResponsibleFaceSelector','js!SBIS3.EDO.BaseFilter.Face1Selector','js!SBIS3.EDO.BaseFilter.RegulationSelector','js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleMeSelector','js!SBIS3.EDO.BaseFilter.UnreadSelector','js!SBIS3.EDO.BaseFilter.UnfixedSelector','js!SBIS3.EDO.BaseFilter.SpecificPerformerSelector','js!SBIS3.EDO.BaseFilter.OurOrganisationSelector','js!SBIS3.EDO.BaseFilter.DocumentTypeSelector','js!SBIS3.EDO.FilterDeliveryMethod','js!SBIS3.EDO.FilterDeliveryMethodSelector','js!SBIS3.EDO.DeliveryMethodSelector','js!SBIS3.EDO.ScopeFilters','Elektronnyj_dokumentooborot_localization'],function(e,t){var r=e.extend({_dotTplFn:t,$protected:{_options:{autoHeight:true,autoWidth:true}},$constructor:function(){},init:function(){r.superclass.init.call(this);}});return r;});
define("tmpl!SBIS3.EDO.FilterIncomingStats",["Core/tmpl/js/tclosure","js!SBIS3.EDO.BaseFilter.Period","js!SBIS3.EDO.BaseFilter.ResponsibleFace","js!SBIS3.EDO.BaseFilter.Face1","js!SBIS3.EDO.BaseFilter.Unfixed","js!SBIS3.EDO.BaseFilter.OurOrganisation","js!SBIS3.EDO.BaseFilter.DocumentType","js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleMe","js!SBIS3.EDO.BaseFilter.RightsLimText"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.EDO.BaseFilter.Period"]=e[1],r["js!SBIS3.EDO.BaseFilter.ResponsibleFace"]=e[2],r["js!SBIS3.EDO.BaseFilter.Face1"]=e[3],r["js!SBIS3.EDO.BaseFilter.Unfixed"]=e[4],r["js!SBIS3.EDO.BaseFilter.OurOrganisation"]=e[5],r["js!SBIS3.EDO.BaseFilter.DocumentType"]=e[6],r["js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleMe"]=e[7],r["js!SBIS3.EDO.BaseFilter.RightsLimText"]=e[8];var o=function e(o,i,n,a,s){function l(){}var c=0,d=void 0!==t&&t?t:arguments[arguments.length-1];void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure"));var S={};s&&s.isSetts&&(S=s.fullContext||{});var p="string"==typeof n?n:"",u=void 0===r?void 0:r,B={id:[],def:void 0},m=d.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),f=this&&this.includedTemplates?this.includedTemplates:{},F=d.getMarkupGenerator(a);try{var y=F.joinElements([F.createTag("div",{class:"edo-BaseFilter__filterPicker"},[F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Period",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},n,u,f,d.config,S),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ResponsibleFace",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},n,u,f,d.config,S),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Face1",{caption:global.rk("Покупатель")},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},n,u,f,d.config,S),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Unfixed",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},n,u,f,d.config,S),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.OurOrganisation",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},n,u,f,d.config,S),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.DocumentType",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},n,u,f,d.config,S),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.AuthorOrResponsibleMe",{useMineStr:!0},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},n,u,f,d.config,S),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.RightsLimText",{textRender:d.getTypeFunc("js!SBIS3.EDO.ScopeFilters:setScopeTextForFilter ",{}),hideGlobalText:!0,esc:!1},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},n,u,f,d.config,S)],i,B,this)],p,B);B.def&&(y=F.chain(y,B,i),B=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/Filtry/FilterIncomingStats/FilterIncomingStats.tmpl",e,o)}return y||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FilterIncomingStats"}},o});
define('js!SBIS3.EDO.FilterIncomingStats',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FilterIncomingStats','js!SBIS3.EDO.BaseFilter.Period','js!SBIS3.EDO.BaseFilter.State','js!SBIS3.EDO.BaseFilter.Marks','js!SBIS3.EDO.BaseFilter.ResponsibleFace','js!SBIS3.EDO.BaseFilter.Face1','js!SBIS3.EDO.BaseFilter.Regulation','js!SBIS3.EDO.BaseFilter.Unfixed','js!SBIS3.EDO.BaseFilter.Unread','js!SBIS3.EDO.BaseFilter.OurOrganisation','js!SBIS3.EDO.BaseFilter.DocumentType','js!SBIS3.EDO.BaseFilter.RightsLimText','js!SBIS3.EDO.ScopeFilters','Elektronnyj_dokumentooborot_localization'],function(e,S){return e.extend({_dotTplFn:S,$protected:{_options:{docTypes:[{docTypeString:'ДокОтгрВх',subDocTypeString:''},{docTypeString:'ФактураВх',subDocTypeString:''},{docTypeString:'КоррВх',subDocTypeString:''},{docTypeString:'АктСверВх',subDocTypeString:''},{docTypeString:'ДоговорВх',subDocTypeString:''},{docTypeString:'ДоговорДок',subDocTypeString:''},{docTypeString:'АктСверкиДок',subDocTypeString:''}]}}});});
define("tmpl!SBIS3.EDO.FilterIncomingStatsSelector",["Core/tmpl/js/tclosure","js!SBIS3.EDO.BaseFilter.ResponsibleFaceSelector","js!SBIS3.EDO.BaseFilter.Face1Selector","js!SBIS3.EDO.BaseFilter.UnfixedSelector","js!SBIS3.EDO.BaseFilter.OurOrganisationSelector","js!SBIS3.EDO.BaseFilter.DocumentTypeSelector","js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleMeSelector"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.EDO.BaseFilter.ResponsibleFaceSelector"]=e[1],r["js!SBIS3.EDO.BaseFilter.Face1Selector"]=e[2],r["js!SBIS3.EDO.BaseFilter.UnfixedSelector"]=e[3],r["js!SBIS3.EDO.BaseFilter.OurOrganisationSelector"]=e[4],r["js!SBIS3.EDO.BaseFilter.DocumentTypeSelector"]=e[5],r["js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleMeSelector"]=e[6];var o=function e(o,n,l,i,a){function s(){}var c=0,S=void 0!==t&&t?t:arguments[arguments.length-1];void 0===S&&(eval("var thelpers = null;"),S=global.requirejs("View/Runner/tclosure"));var u={};a&&a.isSetts&&(u=a.fullContext||{});var d="string"==typeof l?l:"",p=void 0===r?void 0:r,m={id:[],def:void 0},B=S.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),f=this&&this.includedTemplates?this.includedTemplates:{},F=S.getMarkupGenerator(i);try{var y=F.joinElements([F.createTag("div",{class:"edo-BaseFilter__filterPicker  edo-twoColumnSelectors"},[F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ResponsibleFaceSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},l,p,f,S.config,u),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Face1Selector",{caption:global.rk("Покупателя")},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},l,p,f,S.config,u),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.UnfixedSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},l,p,f,S.config,u),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.OurOrganisationSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},l,p,f,S.config,u),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.DocumentTypeSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},l,p,f,S.config,u),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.AuthorOrResponsibleMeSelector",{useMineStr:!0},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},l,p,f,S.config,u)],n,m,this)],d,m);m.def&&(y=F.chain(y,m,n),m=void 0)}catch(e){S.templateError("resources/Elektronnyj_dokumentooborot/Filtry/FilterIncomingStats/FilterIncomingStatsSelector/FilterIncomingStatsSelector.tmpl",e,o)}return y||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FilterIncomingStatsSelector"}},o});
define('js!SBIS3.EDO.FilterIncomingStatsSelector',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FilterIncomingStatsSelector','js!SBIS3.EDO.BaseFilter.MarksSelector','js!SBIS3.EDO.BaseFilter.ResponsibleFaceSelector','js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleMeSelector','js!SBIS3.EDO.BaseFilter.Face1Selector','js!SBIS3.EDO.BaseFilter.RegulationSelector','js!SBIS3.EDO.BaseFilter.UnreadSelector','js!SBIS3.EDO.BaseFilter.UnfixedSelector','js!SBIS3.EDO.BaseFilter.SpecificPerformerSelector','js!SBIS3.EDO.BaseFilter.OurOrganisationSelector','js!SBIS3.EDO.BaseFilter.DocumentTypeSelector','js!SBIS3.EDO.FilterDeliveryMethod','js!SBIS3.EDO.FilterDeliveryMethodSelector','js!SBIS3.EDO.DeliveryMethodSelector','Elektronnyj_dokumentooborot_localization'],function(e,S){return e.extend({_dotTplFn:S,$protected:{_options:{}}});});
define("tmpl!SBIS3.EDO.DeliveryMethod",["Core/tmpl/js/tclosure","js!SBIS3.CONTROLS/FieldLink/Link","js!SBIS3.CONTROLS/FieldLink"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.CONTROLS/FieldLink/Link"]=e[1],r["js!SBIS3.CONTROLS/FieldLink"]=e[2];var i=function e(i,o,n,l,a){function d(){}var s=0,p=void 0!==t&&t?t:arguments[arguments.length-1];void 0===p&&(eval("var thelpers = null;"),p=global.requirejs("View/Runner/tclosure"));var c={};a&&a.isSetts&&(c=a.fullContext||{});var m="string"==typeof n?n:"",u=void 0===r?void 0:r,y={id:[],def:void 0},h=p.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,i),S=this&&this.includedTemplates?this.includedTemplates:{},f=p.getMarkupGenerator(l);try{var v=f.joinElements([f.createTag("div",{class:"edo-BaseFilter__flContainer"},[f.createControl("wsControl","ws:SBIS3.CONTROLS/FieldLink/Link",{caption:p.getter(i,["caption"]),owner:"FieldLinkDeliveryMethod"},{class:"edo-BaseFilter__flLink"},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:h},n,u,S,p.config,c),f.createControl("wsControl","ws:SBIS3.CONTROLS/FieldLink",{dictionaries:[{componentOptions:{searchString:""},editMode:"newFloatArea",idProperty:"Ид",name:"Выбор способа доставки",template:"js!SBIS3.EDO.DeliveryMethodDictionary",readOnly:!0}],list:{options:{itemsActions:{},columns:[{title:"Название",field:"Название"}],ignoreLocalPageSize:!0,idProperty:"Ид"},component:"SBIS3.CONTROLS/DataGridView"},name:"FieldLinkDeliveryMethod",tabindex:"0",defaultValue:p.getter(i,["defaultValue"]),bindings:[{fieldName:"FilterDeliveryMethod",propName:"selectedKeys",propPath:[],fullPropName:"selectedKeys",propPathStr:"",oneWay:!1,direction:"fromContext",bindNonExistent:!1},{fieldName:"FilterDeliveryMethodText",propName:"textValue",propPath:[],fullPropName:"textValue",propPathStr:"",oneWay:!0,direction:"fromProperty",bindNonExistent:!0},{fieldName:"DeliveryMethod",propName:"text",propPath:[],fullPropName:"text",propPathStr:"",oneWay:!0,direction:"fromProperty",bindNonExistent:!0},{fieldName:"DeliveryMethod",propName:"dictionaries/0/componentOptions/searchString",propPath:["0","componentOptions","searchString"],fullPropName:"dictionaries/0/componentOptions/searchString",propPathStr:"0/componentOptions/searchString",oneWay:!0,direction:"fromContext",bindNonExistent:!0}],selectedKeys:void 0,textValue:"",placeholder:global.rk("Укажите способ доставки"),displayField:"Название",idProperty:"Ид",usePicker:!1,text:"",esc:!1},{class:"edo-BaseFilter__flField edo-BaseFilter__FieldLinkDeliveryMethod",name:"FieldLinkDeliveryMethod",sbisname:"FieldLinkDeliveryMethod"},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:h},n,u,S,p.config,c)],o,y,this)],m,y);y.def&&(v=f.chain(v,y,o),y=void 0)}catch(e){p.templateError("resources/Elektronnyj_dokumentooborot/Filtry/FilterLetter/resources/DeliveryMethod/DeliveryMethod.tmpl",e,i)}return v||""};return i.includedFunctions={},i.stable=!0,i.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.DeliveryMethod"}},i});
define('js!SBIS3.EDO.DeliveryMethod',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.DeliveryMethod','WS.Data/Source/Memory','Core/ContextBinder','js!SBIS3.EDO.DeliveryMethodDictionary','SBIS3.CONTROLS/FieldLink/Link','SBIS3.CONTROLS/FieldLink','Elektronnyj_dokumentooborot_localization'],function(e,t,i,r){return e.extend({_dotTplFn:t,$protected:{_options:{caption:rk('Способ доставки')}},$constructor:function(){var e=new r();e.defineBinding('visible','FilterDeliveryMethodVisibility',true,'fromContext'),e.bindControl(this,this.getLinkedContext(),'syncControl'),this.once('onReady',function(){this._setDataSource();}.bind(this));},_setDataSource:function(){var e=[{'Ид':-1,'Название':rk('Не выбрано')},{'Ид':0,'Название':rk('Почтой')},{'Ид':1,'Название':rk('На e-mail')},{'Ид':2,'Название':rk('Доставка курьером')},{'Ид':3,'Название':rk('По факсу')},{'Ид':4,'Название':rk('Телефонограммой')},{'Ид':5,'Название':rk('Электронно')},{'Ид':6,'Название':rk('Доставка нашим сотрудником')},{'Ид':7,'Название':rk('Заказным письмом')},{'Ид':8,'Название':rk('Ценным письмом')},{'Ид':10,'Название':rk('Экспресс-почтой')}],t=new i({data:e,idProperty:'Ид'});this.getChildControlByName('FieldLinkDeliveryMethod').setDataSource(t);}});});
define("tmpl!SBIS3.EDO.FilterIncomingLetter",["Core/tmpl/js/tclosure","js!SBIS3.EDO.BaseFilter.Period","js!SBIS3.EDO.BaseFilter.State","js!SBIS3.EDO.BaseFilter.Marks","js!SBIS3.EDO.BaseFilter.ResponsibleFace","js!SBIS3.EDO.BaseFilter.Face1","js!SBIS3.EDO.BaseFilter.Unanswered","js!SBIS3.EDO.BaseFilter.OurOrganisation","js!SBIS3.EDO.BaseFilter.Regulation","js!SBIS3.EDO.DeliveryMethod","js!SBIS3.EDO.BaseFilter.RightsLimText"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.EDO.BaseFilter.Period"]=e[1],r["js!SBIS3.EDO.BaseFilter.State"]=e[2],r["js!SBIS3.EDO.BaseFilter.Marks"]=e[3],r["js!SBIS3.EDO.BaseFilter.ResponsibleFace"]=e[4],r["js!SBIS3.EDO.BaseFilter.Face1"]=e[5],r["js!SBIS3.EDO.BaseFilter.Unanswered"]=e[6],r["js!SBIS3.EDO.BaseFilter.OurOrganisation"]=e[7],r["js!SBIS3.EDO.BaseFilter.Regulation"]=e[8],r["js!SBIS3.EDO.DeliveryMethod"]=e[9],r["js!SBIS3.EDO.BaseFilter.RightsLimText"]=e[10];var o=function e(o,i,a,n,l){function s(){}var c=0,d=void 0!==t&&t?t:arguments[arguments.length-1];void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure"));var S={};l&&l.isSetts&&(S=l.fullContext||{});var p="string"==typeof a?a:"",u=void 0===r?void 0:r,B={id:[],def:void 0},y=d.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),m=this&&this.includedTemplates?this.includedTemplates:{},F=d.getMarkupGenerator(n);try{var f=F.joinElements([F.createTag("div",{class:"edo-BaseFilter__filterPicker"},[F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Period",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},a,u,m,d.config,S),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.State",{items:[{key:"-1",title:global.rk("В любом состоянии")},{key:"10",title:global.rk("Внутренняя обработка")},{key:"7",title:global.rk("Утвержденные")},{key:"9",title:global.rk("Отклоненные")},{key:"22",title:global.rk("Аннулированные")},{key:"0,1",title:global.rk("Черновики")},{key:"-2",title:global.rk("Удаленные")}],esc:!1},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},a,u,m,d.config,S),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Marks",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},a,u,m,d.config,S),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ResponsibleFace",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},a,u,m,d.config,S),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Face1",{caption:global.rk("Отправитель")},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},a,u,m,d.config,S),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Unanswered",{caption:global.rk("Не получен ответ")},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},a,u,m,d.config,S),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.OurOrganisation",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},a,u,m,d.config,S),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Regulation",{hidePhase:!0,docTypes:[{docTypeString:"КоррВх",subDocTypeString:""}]},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},a,u,m,d.config,S),F.createControl("wsControl","ws:SBIS3.EDO.DeliveryMethod",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},a,u,m,d.config,S),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.RightsLimText",{textRender:d.getTypeFunc("js!SBIS3.EDO.ScopeFilters:setScopeTextForFilter ",{}),esc:!1},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},a,u,m,d.config,S)],i,B,this)],p,B);B.def&&(f=F.chain(f,B,i),B=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/Filtry/FilterLetter/FilterIncomingLetter/FilterIncomingLetter.tmpl",e,o)}return f||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FilterIncomingLetter"}},o});
define('js!SBIS3.EDO.FilterIncomingLetter',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FilterIncomingLetter','js!SBIS3.EDO.ScopeFilters','js!SBIS3.EDO.BaseFilter.Period','js!SBIS3.EDO.BaseFilter.State','js!SBIS3.EDO.BaseFilter.Marks','js!SBIS3.EDO.BaseFilter.ResponsibleFace','js!SBIS3.EDO.BaseFilter.Face1','js!SBIS3.EDO.BaseFilter.Unanswered','js!SBIS3.EDO.BaseFilter.OurOrganisation','js!SBIS3.EDO.BaseFilter.Regulation','js!SBIS3.EDO.DeliveryMethod','js!SBIS3.EDO.BaseFilter.RightsLimText','Elektronnyj_dokumentooborot_localization'],function(e,t){var i=e.extend({_dotTplFn:t,$protected:{_options:{autoHeight:true,autoWidth:true}},$constructor:function(){},init:function(){i.superclass.init.call(this);}});return i;});
define("tmpl!SBIS3.EDO.FilterIncomingLetterSelector",["Core/tmpl/js/tclosure","js!SBIS3.EDO.BaseFilter.MarksSelector","js!SBIS3.EDO.BaseFilter.ResponsibleFaceSelector","js!SBIS3.EDO.BaseFilter.Face1Selector","js!SBIS3.EDO.BaseFilter.UnansweredSelector","js!SBIS3.EDO.BaseFilter.OurOrganisationSelector","js!SBIS3.EDO.DeliveryMethodSelector","js!SBIS3.EDO.BaseFilter.RegulationSelector"],function(){var e=Array.prototype.slice.call(arguments),r=e[0],t={};t["js!SBIS3.EDO.BaseFilter.MarksSelector"]=e[1],t["js!SBIS3.EDO.BaseFilter.ResponsibleFaceSelector"]=e[2],t["js!SBIS3.EDO.BaseFilter.Face1Selector"]=e[3],t["js!SBIS3.EDO.BaseFilter.UnansweredSelector"]=e[4],t["js!SBIS3.EDO.BaseFilter.OurOrganisationSelector"]=e[5],t["js!SBIS3.EDO.DeliveryMethodSelector"]=e[6],t["js!SBIS3.EDO.BaseFilter.RegulationSelector"]=e[7];var o=function e(o,l,n,i,a){function c(){}var s=0,S=void 0!==r&&r?r:arguments[arguments.length-1];void 0===S&&(eval("var thelpers = null;"),S=global.requirejs("View/Runner/tclosure"));var d={};a&&a.isSetts&&(d=a.fullContext||{});var u="string"==typeof n?n:"",p=void 0===t?void 0:t,B={id:[],def:void 0},m=S.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),f=this&&this.includedTemplates?this.includedTemplates:{},v=S.getMarkupGenerator(i);try{var y=v.joinElements([v.createTag("div",{class:"edo-BaseFilter__filterPicker  edo-twoColumnSelectors"},[v.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.MarksSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},n,p,f,S.config,d),v.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ResponsibleFaceSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},n,p,f,S.config,d),v.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Face1Selector",{caption:global.rk("Отправителя")},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},n,p,f,S.config,d),v.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.UnansweredSelector",{caption:global.rk("Не получен ответ")},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},n,p,f,S.config,d),v.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.OurOrganisationSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},n,p,f,S.config,d),v.createControl("wsControl","ws:SBIS3.EDO.DeliveryMethodSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},n,p,f,S.config,d),v.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.RegulationSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},n,p,f,S.config,d)],l,B,this)],u,B);B.def&&(y=v.chain(y,B,l),B=void 0)}catch(e){S.templateError("resources/Elektronnyj_dokumentooborot/Filtry/FilterLetter/FilterIncomingLetter/FilterIncomingLetterSelector/FilterIncomingLetterSelector.tmpl",e,o)}return y||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FilterIncomingLetterSelector"}},o});
define('js!SBIS3.EDO.FilterIncomingLetterSelector',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FilterIncomingLetterSelector','js!SBIS3.EDO.BaseFilter.MarksSelector','js!SBIS3.EDO.BaseFilter.ResponsibleFaceSelector','js!SBIS3.EDO.BaseFilter.Face1Selector','js!SBIS3.EDO.BaseFilter.UnansweredSelector','js!SBIS3.EDO.BaseFilter.OurOrganisationSelector','js!SBIS3.EDO.BaseFilter.RegulationSelector','js!SBIS3.EDO.DeliveryMethodSelector','Elektronnyj_dokumentooborot_localization'],function(e,t){var r=e.extend({_dotTplFn:t,$protected:{_options:{autoHeight:true,autoWidth:true}},$constructor:function(){},init:function(){r.superclass.init.call(this);}});return r;});
define("tmpl!SBIS3.EDO.FilterOutgoingLetter",["Core/tmpl/js/tclosure","js!SBIS3.EDO.BaseFilter.Period","js!SBIS3.EDO.BaseFilter.State","js!SBIS3.EDO.BaseFilter.Marks","js!SBIS3.EDO.BaseFilter.ResponsibleFace","js!SBIS3.EDO.BaseFilter.Face1","js!SBIS3.EDO.BaseFilter.Unanswered","js!SBIS3.EDO.BaseFilter.OurOrganisation","js!SBIS3.EDO.BaseFilter.Regulation","js!SBIS3.EDO.BaseFilter.RightsLimText"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.EDO.BaseFilter.Period"]=e[1],r["js!SBIS3.EDO.BaseFilter.State"]=e[2],r["js!SBIS3.EDO.BaseFilter.Marks"]=e[3],r["js!SBIS3.EDO.BaseFilter.ResponsibleFace"]=e[4],r["js!SBIS3.EDO.BaseFilter.Face1"]=e[5],r["js!SBIS3.EDO.BaseFilter.Unanswered"]=e[6],r["js!SBIS3.EDO.BaseFilter.OurOrganisation"]=e[7],r["js!SBIS3.EDO.BaseFilter.Regulation"]=e[8],r["js!SBIS3.EDO.BaseFilter.RightsLimText"]=e[9];var o=function e(o,i,a,l,n){function s(){}var c=0,d=void 0!==t&&t?t:arguments[arguments.length-1];void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure"));var S={};n&&n.isSetts&&(S=n.fullContext||{});var u="string"==typeof a?a:"",p=void 0===r?void 0:r,B={id:[],def:void 0},y=d.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),g=this&&this.includedTemplates?this.includedTemplates:{},F=d.getMarkupGenerator(l);try{var m=F.joinElements([F.createTag("div",{class:"edo-BaseFilter__filterPicker"},[F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Period",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},a,p,g,d.config,S),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.State",{items:[{key:"-1",title:global.rk("В любом состоянии")},{key:"10",title:global.rk("Внутренняя обработка")},{key:"2,3",title:global.rk("Недоставленные")},{key:"4",title:global.rk("Не получен ответ")},{key:"7",title:global.rk("Утвержденные")},{key:"9",title:global.rk("Отклоненные")},{key:"6",title:global.rk("С ошибками")},{key:"22",title:global.rk("Аннулированные")},{key:"0,1",title:global.rk("Черновики")},{key:"-2",title:global.rk("Удаленные")}],esc:!1},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},a,p,g,d.config,S),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Marks",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},a,p,g,d.config,S),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ResponsibleFace",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},a,p,g,d.config,S),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Face1",{caption:global.rk("Получатель")},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},a,p,g,d.config,S),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Unanswered",{caption:global.rk("Не получен ответ")},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},a,p,g,d.config,S),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.OurOrganisation",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},a,p,g,d.config,S),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Regulation",{hidePhase:!0,docTypes:[{docTypeString:"КоррИсх",subDocTypeString:""}]},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},a,p,g,d.config,S),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.RightsLimText",{textRender:d.getTypeFunc("js!SBIS3.EDO.ScopeFilters:setScopeTextForFilter ",{}),esc:!1},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},a,p,g,d.config,S)],i,B,this)],u,B);B.def&&(m=F.chain(m,B,i),B=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/Filtry/FilterLetter/FilterOutgoingLetter/FilterOutgoingLetter.tmpl",e,o)}return m||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FilterOutgoingLetter"}},o});
define('js!SBIS3.EDO.FilterOutgoingLetter',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FilterOutgoingLetter','js!SBIS3.EDO.ScopeFilters','js!SBIS3.EDO.BaseFilter.Period','js!SBIS3.EDO.BaseFilter.State','js!SBIS3.EDO.BaseFilter.Marks','js!SBIS3.EDO.BaseFilter.ResponsibleFace','js!SBIS3.EDO.BaseFilter.Face1','js!SBIS3.EDO.BaseFilter.Unanswered','js!SBIS3.EDO.BaseFilter.OurOrganisation','js!SBIS3.EDO.BaseFilter.Regulation','js!SBIS3.EDO.BaseFilter.RightsLimText','Elektronnyj_dokumentooborot_localization'],function(e,t){var i=e.extend({_dotTplFn:t,$protected:{_options:{autoHeight:true,autoWidth:true}},$constructor:function(){},init:function(){i.superclass.init.call(this);}});return i;});
define("tmpl!SBIS3.EDO.FilterOutgoingLetterSelector",["Core/tmpl/js/tclosure","js!SBIS3.EDO.BaseFilter.MarksSelector","js!SBIS3.EDO.BaseFilter.ResponsibleFaceSelector","js!SBIS3.EDO.BaseFilter.Face1Selector","js!SBIS3.EDO.BaseFilter.UnansweredSelector","js!SBIS3.EDO.BaseFilter.OurOrganisationSelector","js!SBIS3.EDO.BaseFilter.RegulationSelector"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.EDO.BaseFilter.MarksSelector"]=e[1],r["js!SBIS3.EDO.BaseFilter.ResponsibleFaceSelector"]=e[2],r["js!SBIS3.EDO.BaseFilter.Face1Selector"]=e[3],r["js!SBIS3.EDO.BaseFilter.UnansweredSelector"]=e[4],r["js!SBIS3.EDO.BaseFilter.OurOrganisationSelector"]=e[5],r["js!SBIS3.EDO.BaseFilter.RegulationSelector"]=e[6];var o=function e(o,l,i,n,a){function s(){}var c=0,S=void 0!==t&&t?t:arguments[arguments.length-1];void 0===S&&(eval("var thelpers = null;"),S=global.requirejs("View/Runner/tclosure"));var u={};a&&a.isSetts&&(u=a.fullContext||{});var d="string"==typeof i?i:"",p=void 0===r?void 0:r,B={id:[],def:void 0},F=S.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),f=this&&this.includedTemplates?this.includedTemplates:{},O=S.getMarkupGenerator(n);try{var m=O.joinElements([O.createTag("div",{class:"edo-BaseFilter__filterPicker  edo-twoColumnSelectors"},[O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.MarksSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:F},i,p,f,S.config,u),O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ResponsibleFaceSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:F},i,p,f,S.config,u),O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Face1Selector",{caption:"Получателя"},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:F},i,p,f,S.config,u),O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.UnansweredSelector",{caption:global.rk("Не получен ответ")},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:F},i,p,f,S.config,u),O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.OurOrganisationSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:F},i,p,f,S.config,u),O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.RegulationSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:F},i,p,f,S.config,u)],l,B,this)],d,B);B.def&&(m=O.chain(m,B,l),B=void 0)}catch(e){S.templateError("resources/Elektronnyj_dokumentooborot/Filtry/FilterLetter/FilterOutgoingLetter/FilterOutgoingLetterSelector/FilterOutgoingLetterSelector.tmpl",e,o)}return m||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FilterOutgoingLetterSelector"}},o});
define('js!SBIS3.EDO.FilterOutgoingLetterSelector',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FilterOutgoingLetterSelector','js!SBIS3.EDO.BaseFilter.MarksSelector','js!SBIS3.EDO.BaseFilter.ResponsibleFaceSelector','js!SBIS3.EDO.BaseFilter.Face1Selector','js!SBIS3.EDO.BaseFilter.UnansweredSelector','js!SBIS3.EDO.BaseFilter.OurOrganisationSelector','js!SBIS3.EDO.BaseFilter.RegulationSelector','Elektronnyj_dokumentooborot_localization'],function(e,t){var r=e.extend({_dotTplFn:t,$protected:{_options:{autoHeight:true,autoWidth:true}},$constructor:function(){},init:function(){r.superclass.init.call(this);}});return r;});
define("html!SBIS3.EDO.FilterDeliveryMethodTemplate",function(){var e=function(e){var r=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(r){for(;e.test(r);)r=r.replace(e,"&#123;&#123;$1&#125;&#125;");return r}}(),n=function(e){return e.join?e.join(""):e.toString()},t=function(e){return void 0===e?"":e&&"object"==typeof e?n(e):""+e},o="undefined"!=typeof process,i=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,"");return e.caption&&(i+="<div style='display:inline;'>"+r(t(rk("Способ доставки")))+": "+r(t(e.caption))+"</div>"),(i=r(i))+(o&&-1!==i.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.FilterDeliveryMethodTemplate"}},e});
define('js!SBIS3.EDO.FilterDeliveryMethodTemplate',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.FilterDeliveryMethodTemplate','Elektronnyj_dokumentooborot_localization'],function(t,e){var n=t.extend({_dotTplFn:e,$protected:{_options:{}},$constructor:function(){},init:function(){n.superclass.init.call(this);}});return n;});
define("tmpl!SBIS3.EDO.FilterOutgoingNew",["Core/tmpl/js/tclosure","js!SBIS3.EDO.BaseFilter.Period","js!SBIS3.EDO.BaseFilter.State","js!SBIS3.EDO.BaseFilter.Marks","js!SBIS3.EDO.BaseFilter.Regulation","js!SBIS3.EDO.BaseFilter.ResponsibleFace","js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleMe","js!SBIS3.EDO.BaseFilter.Face1","js!SBIS3.EDO.BaseFilter.Unfixed","js!SBIS3.EDO.BaseFilter.OurOrganisation","js!SBIS3.EDO.BaseFilter.DocumentType","js!SBIS3.EDO.BaseFilter.RightsLimText"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.EDO.BaseFilter.Period"]=e[1],r["js!SBIS3.EDO.BaseFilter.State"]=e[2],r["js!SBIS3.EDO.BaseFilter.Marks"]=e[3],r["js!SBIS3.EDO.BaseFilter.Regulation"]=e[4],r["js!SBIS3.EDO.BaseFilter.ResponsibleFace"]=e[5],r["js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleMe"]=e[6],r["js!SBIS3.EDO.BaseFilter.Face1"]=e[7],r["js!SBIS3.EDO.BaseFilter.Unfixed"]=e[8],r["js!SBIS3.EDO.BaseFilter.OurOrganisation"]=e[9],r["js!SBIS3.EDO.BaseFilter.DocumentType"]=e[10],r["js!SBIS3.EDO.BaseFilter.RightsLimText"]=e[11];var o=function e(o,i,l,a,n){function s(){}var c=0,d=void 0!==t&&t?t:arguments[arguments.length-1];void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure"));var S={};n&&n.isSetts&&(S=n.fullContext||{});var u="string"==typeof l?l:"",p=void 0===r?void 0:r,B={id:[],def:void 0},y=d.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),m=this&&this.includedTemplates?this.includedTemplates:{},f=d.getMarkupGenerator(a);try{var F=f.joinElements([f.createTag("div",{class:"edo-BaseFilter__filterPicker"},[f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Period",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},l,p,m,d.config,S),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.State",{items:[{key:"-1",title:global.rk("В любом состоянии")},{key:"10",title:global.rk("Внутренняя обработка")},{key:"2,3",title:global.rk("Недоставленные")},{key:"4",title:global.rk("Не получен ответ")},{key:"7",title:global.rk("Утвержденные")},{key:"9",title:global.rk("Отклоненные")},{key:"6",title:global.rk("С ошибками")},{key:"22",title:global.rk("Аннулированные")},{key:"19,20",title:global.rk("Удалено мной/контрагентом")},{key:"0,1",title:global.rk("Черновики")},{key:"-2",title:global.rk("Удаленные")}],esc:!1},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},l,p,m,d.config,S),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Marks",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},l,p,m,d.config,S),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Regulation",{multiselect:!0,docTypes:d.getter(o,["docTypes"]),hidePhase:!0},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},l,p,m,d.config,S),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ResponsibleFace",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},l,p,m,d.config,S),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.AuthorOrResponsibleMe",{useMineStr:!0},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},l,p,m,d.config,S),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Face1",{caption:global.rk("Получатель")},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},l,p,m,d.config,S),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Unfixed",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},l,p,m,d.config,S),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.OurOrganisation",{addHead:!0},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},l,p,m,d.config,S),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.DocumentType",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},l,p,m,d.config,S),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.RightsLimText",{textRender:d.getTypeFunc("js!SBIS3.EDO.ScopeFilters:setScopeTextForFilter ",{}),hideGlobalText:!0,esc:!1},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},l,p,m,d.config,S)],i,B,this)],u,B);B.def&&(F=f.chain(F,B,i),B=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/Filtry/FilterOutgoingNew/FilterOutgoingNew.tmpl",e,o)}return F||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FilterOutgoingNew"}},o});
define('js!SBIS3.EDO.FilterOutgoingNew',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FilterOutgoingNew','js!SBIS3.EDO.BaseFilter.Period','js!SBIS3.EDO.BaseFilter.State','js!SBIS3.EDO.BaseFilter.Marks','js!SBIS3.EDO.BaseFilter.ResponsibleFace','js!SBIS3.EDO.BaseFilter.Face1','js!SBIS3.EDO.BaseFilter.Regulation','js!SBIS3.EDO.BaseFilter.Unfixed','js!SBIS3.EDO.BaseFilter.Unread','js!SBIS3.EDO.BaseFilter.OurOrganisation','js!SBIS3.EDO.BaseFilter.DocumentType','js!SBIS3.EDO.BaseFilter.RightsLimText','js!SBIS3.EDO.ScopeFilters','Elektronnyj_dokumentooborot_localization'],function(e,t){var i=e.extend({_dotTplFn:t,$protected:{_options:{docTypes:[{docTypeString:'ДокОтгрИсх',subDocTypeString:''},{docTypeString:'ФактураИсх',subDocTypeString:''},{docTypeString:'КоррИсх',subDocTypeString:''},{docTypeString:'АктСверИсх',subDocTypeString:''},{docTypeString:'ДоговорИсх',subDocTypeString:''},{docTypeString:'ДоговорДок',subDocTypeString:''},{docTypeString:'АктСверкиДок',subDocTypeString:''}]}},$constructor:function(){},init:function(){i.superclass.init.call(this);}});return i;});
define("tmpl!SBIS3.EDO.FilterOutgoingNewSelector",["Core/tmpl/js/tclosure","js!SBIS3.EDO.BaseFilter.MarksSelector","js!SBIS3.EDO.BaseFilter.ResponsibleFaceSelector","js!SBIS3.EDO.BaseFilter.Face1Selector","js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleMeSelector","js!SBIS3.EDO.BaseFilter.RegulationSelector","js!SBIS3.EDO.BaseFilter.UnfixedSelector","js!SBIS3.EDO.BaseFilter.OurOrganisationSelector","js!SBIS3.EDO.BaseFilter.DocumentTypeSelector"],function(){var e=Array.prototype.slice.call(arguments),r=e[0],t={};t["js!SBIS3.EDO.BaseFilter.MarksSelector"]=e[1],t["js!SBIS3.EDO.BaseFilter.ResponsibleFaceSelector"]=e[2],t["js!SBIS3.EDO.BaseFilter.Face1Selector"]=e[3],t["js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleMeSelector"]=e[4],t["js!SBIS3.EDO.BaseFilter.RegulationSelector"]=e[5],t["js!SBIS3.EDO.BaseFilter.UnfixedSelector"]=e[6],t["js!SBIS3.EDO.BaseFilter.OurOrganisationSelector"]=e[7],t["js!SBIS3.EDO.BaseFilter.DocumentTypeSelector"]=e[8];var o=function e(o,l,i,n,a){function s(){}var c=0,S=void 0!==r&&r?r:arguments[arguments.length-1];void 0===S&&(eval("var thelpers = null;"),S=global.requirejs("View/Runner/tclosure"));var u={};a&&a.isSetts&&(u=a.fullContext||{});var d="string"==typeof i?i:"",p=void 0===t?void 0:t,B={id:[],def:void 0},f=S.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),O=this&&this.includedTemplates?this.includedTemplates:{},m=S.getMarkupGenerator(n);try{var F=m.joinElements([m.createTag("div",{class:"edo-BaseFilter__filterPicker  edo-twoColumnSelectors"},[m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.MarksSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},i,p,O,S.config,u),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ResponsibleFaceSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},i,p,O,S.config,u),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Face1Selector",{caption:global.rk("Получателя")},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},i,p,O,S.config,u),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.AuthorOrResponsibleMeSelector",{useMineStr:!0},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},i,p,O,S.config,u),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.RegulationSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},i,p,O,S.config,u),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.UnfixedSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},i,p,O,S.config,u),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.OurOrganisationSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},i,p,O,S.config,u),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.DocumentTypeSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},i,p,O,S.config,u)],l,B,this)],d,B);B.def&&(F=m.chain(F,B,l),B=void 0)}catch(e){S.templateError("resources/Elektronnyj_dokumentooborot/Filtry/FilterOutgoingNew/FilterOutgoingNewSelector/FilterOutgoingNewSelector.tmpl",e,o)}return F||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FilterOutgoingNewSelector"}},o});
define('js!SBIS3.EDO.FilterOutgoingNewSelector',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FilterOutgoingNewSelector','js!SBIS3.EDO.BaseFilter.MarksSelector','js!SBIS3.EDO.BaseFilter.ResponsibleFaceSelector','js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleMeSelector','js!SBIS3.EDO.BaseFilter.Face1Selector','js!SBIS3.EDO.BaseFilter.RegulationSelector','js!SBIS3.EDO.BaseFilter.UnreadSelector','js!SBIS3.EDO.BaseFilter.UnfixedSelector','js!SBIS3.EDO.BaseFilter.SpecificPerformerSelector','js!SBIS3.EDO.BaseFilter.OurOrganisationSelector','js!SBIS3.EDO.BaseFilter.DocumentTypeSelector','js!SBIS3.EDO.FilterDeliveryMethod','js!SBIS3.EDO.FilterDeliveryMethodSelector','js!SBIS3.EDO.DeliveryMethodSelector','Elektronnyj_dokumentooborot_localization'],function(e,t){var r=e.extend({_dotTplFn:t,$protected:{_options:{autoHeight:true,autoWidth:true}},$constructor:function(){},init:function(){r.superclass.init.call(this);}});return r;});
define('js!SBIS3.EDO.FilterOutgoingNewAnswer',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FilterOutgoingNew','js!SBIS3.EDO.BaseFilter.Period','js!SBIS3.EDO.BaseFilter.State','js!SBIS3.EDO.BaseFilter.Marks','js!SBIS3.EDO.BaseFilter.ResponsibleFace','js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleMe','js!SBIS3.EDO.BaseFilter.Face1','js!SBIS3.EDO.BaseFilter.Regulation','js!SBIS3.EDO.BaseFilter.Unfixed','js!SBIS3.EDO.BaseFilter.Unread','js!SBIS3.EDO.BaseFilter.SpecificPerformer','js!SBIS3.EDO.BaseFilter.OurOrganisation','js!SBIS3.EDO.BaseFilter.DocumentType','Elektronnyj_dokumentooborot_localization'],function(e,t){var i=e.extend({_dotTplFn:t,$protected:{_options:{docTypes:[{docTypeString:'ДокОтгрИсх',subDocTypeString:''},{docTypeString:'ФактураИсх',subDocTypeString:''},{docTypeString:'КоррИсх',subDocTypeString:''},{docTypeString:'АктСверИсх',subDocTypeString:''},{docTypeString:'ДоговорИсх',subDocTypeString:''},{docTypeString:'АктСверкиДок',subDocTypeString:''},{docTypeString:'ДоговорДок',subDocTypeString:''}]}},$constructor:function(){},init:function(){i.superclass.init.call(this);}});return i;});
define("tmpl!SBIS3.EDO.FilterOutgoingStats",["Core/tmpl/js/tclosure","js!SBIS3.EDO.BaseFilter.Period","js!SBIS3.EDO.BaseFilter.ResponsibleFace","js!SBIS3.EDO.BaseFilter.Face1","js!SBIS3.EDO.BaseFilter.Unfixed","js!SBIS3.EDO.BaseFilter.OurOrganisation","js!SBIS3.EDO.BaseFilter.DocumentType","js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleMe","js!SBIS3.EDO.BaseFilter.RightsLimText"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.EDO.BaseFilter.Period"]=e[1],r["js!SBIS3.EDO.BaseFilter.ResponsibleFace"]=e[2],r["js!SBIS3.EDO.BaseFilter.Face1"]=e[3],r["js!SBIS3.EDO.BaseFilter.Unfixed"]=e[4],r["js!SBIS3.EDO.BaseFilter.OurOrganisation"]=e[5],r["js!SBIS3.EDO.BaseFilter.DocumentType"]=e[6],r["js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleMe"]=e[7],r["js!SBIS3.EDO.BaseFilter.RightsLimText"]=e[8];var o=function e(o,i,n,a,s){function l(){}var c=0,d=void 0!==t&&t?t:arguments[arguments.length-1];void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure"));var u={};s&&s.isSetts&&(u=s.fullContext||{});var S="string"==typeof n?n:"",p=void 0===r?void 0:r,B={id:[],def:void 0},m=d.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),f=this&&this.includedTemplates?this.includedTemplates:{},F=d.getMarkupGenerator(a);try{var O=F.joinElements([F.createTag("div",{class:"edo-BaseFilter__filterPicker"},[F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Period",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},n,p,f,d.config,u),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ResponsibleFace",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},n,p,f,d.config,u),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Face1",{caption:global.rk("Покупатель")},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},n,p,f,d.config,u),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Unfixed",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},n,p,f,d.config,u),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.OurOrganisation",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},n,p,f,d.config,u),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.DocumentType",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},n,p,f,d.config,u),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.AuthorOrResponsibleMe",{useMineStr:!0},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},n,p,f,d.config,u),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.RightsLimText",{textRender:d.getTypeFunc("js!SBIS3.EDO.ScopeFilters:setScopeTextForFilter ",{}),hideGlobalText:!0,esc:!1},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},n,p,f,d.config,u)],i,B,this)],S,B);B.def&&(O=F.chain(O,B,i),B=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/Filtry/FilterOutgoingStats/FilterOutgoingStats.tmpl",e,o)}return O||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FilterOutgoingStats"}},o});
define('js!SBIS3.EDO.FilterOutgoingStats',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FilterOutgoingStats','js!SBIS3.EDO.BaseFilter.Period','js!SBIS3.EDO.BaseFilter.State','js!SBIS3.EDO.BaseFilter.Marks','js!SBIS3.EDO.BaseFilter.ResponsibleFace','js!SBIS3.EDO.BaseFilter.Face1','js!SBIS3.EDO.BaseFilter.Regulation','js!SBIS3.EDO.BaseFilter.Unfixed','js!SBIS3.EDO.BaseFilter.Unread','js!SBIS3.EDO.BaseFilter.OurOrganisation','js!SBIS3.EDO.BaseFilter.DocumentType','js!SBIS3.EDO.BaseFilter.RightsLimText','js!SBIS3.EDO.ScopeFilters','Elektronnyj_dokumentooborot_localization'],function(e,t){return e.extend({_dotTplFn:t,$protected:{_options:{docTypes:[{docTypeString:'ДокОтгрИсх',subDocTypeString:''},{docTypeString:'ФактураИсх',subDocTypeString:''},{docTypeString:'КоррИсх',subDocTypeString:''},{docTypeString:'АктСверИсх',subDocTypeString:''},{docTypeString:'ДоговорИсх',subDocTypeString:''},{docTypeString:'ДоговорДок',subDocTypeString:''},{docTypeString:'АктСверкиДок',subDocTypeString:''}]}}});});
define("tmpl!SBIS3.EDO.FilterOutgoingStatsSelector",["Core/tmpl/js/tclosure","js!SBIS3.EDO.BaseFilter.ResponsibleFaceSelector","js!SBIS3.EDO.BaseFilter.Face1Selector","js!SBIS3.EDO.BaseFilter.UnfixedSelector","js!SBIS3.EDO.BaseFilter.OurOrganisationSelector","js!SBIS3.EDO.BaseFilter.DocumentTypeSelector","js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleMeSelector"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.EDO.BaseFilter.ResponsibleFaceSelector"]=e[1],r["js!SBIS3.EDO.BaseFilter.Face1Selector"]=e[2],r["js!SBIS3.EDO.BaseFilter.UnfixedSelector"]=e[3],r["js!SBIS3.EDO.BaseFilter.OurOrganisationSelector"]=e[4],r["js!SBIS3.EDO.BaseFilter.DocumentTypeSelector"]=e[5],r["js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleMeSelector"]=e[6];var o=function e(o,l,i,n,a){function s(){}var c=0,S=void 0!==t&&t?t:arguments[arguments.length-1];void 0===S&&(eval("var thelpers = null;"),S=global.requirejs("View/Runner/tclosure"));var u={};a&&a.isSetts&&(u=a.fullContext||{});var d="string"==typeof i?i:"",p=void 0===r?void 0:r,B={id:[],def:void 0},f=S.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),O=this&&this.includedTemplates?this.includedTemplates:{},m=S.getMarkupGenerator(n);try{var F=m.joinElements([m.createTag("div",{class:"edo-BaseFilter__filterPicker  edo-twoColumnSelectors"},[m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ResponsibleFaceSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},i,p,O,S.config,u),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Face1Selector",{caption:global.rk("Покупателя")},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},i,p,O,S.config,u),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.UnfixedSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},i,p,O,S.config,u),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.OurOrganisationSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},i,p,O,S.config,u),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.DocumentTypeSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},i,p,O,S.config,u),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.AuthorOrResponsibleMeSelector",{useMineStr:!0},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},i,p,O,S.config,u)],l,B,this)],d,B);B.def&&(F=m.chain(F,B,l),B=void 0)}catch(e){S.templateError("resources/Elektronnyj_dokumentooborot/Filtry/FilterOutgoingStats/FilterOutgoingStatsSelector/FilterOutgoingStatsSelector.tmpl",e,o)}return F||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FilterOutgoingStatsSelector"}},o});
define('js!SBIS3.EDO.FilterOutgoingStatsSelector',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FilterOutgoingStatsSelector','js!SBIS3.EDO.BaseFilter.MarksSelector','js!SBIS3.EDO.BaseFilter.ResponsibleFaceSelector','js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleMeSelector','js!SBIS3.EDO.BaseFilter.Face1Selector','js!SBIS3.EDO.BaseFilter.RegulationSelector','js!SBIS3.EDO.BaseFilter.UnreadSelector','js!SBIS3.EDO.BaseFilter.UnfixedSelector','js!SBIS3.EDO.BaseFilter.SpecificPerformerSelector','js!SBIS3.EDO.BaseFilter.OurOrganisationSelector','js!SBIS3.EDO.BaseFilter.DocumentTypeSelector','js!SBIS3.EDO.FilterDeliveryMethod','js!SBIS3.EDO.FilterDeliveryMethodSelector','js!SBIS3.EDO.DeliveryMethodSelector','Elektronnyj_dokumentooborot_localization'],function(e,t){return e.extend({_dotTplFn:t,$protected:{_options:{}}});});
define("tmpl!SBIS3.EDO.FilterReconciliationReportsAll",["Core/tmpl/js/tclosure","js!SBIS3.EDO.BaseFilter.Period","js!SBIS3.EDO.BaseFilter.State","js!SBIS3.EDO.BaseFilter.Marks","js!SBIS3.EDO.BaseFilter.ResponsibleFace","js!SBIS3.EDO.BaseFilter.Face1","js!SBIS3.EDO.BaseFilter.Deleted","js!SBIS3.EDO.BaseFilter.Signed","js!SBIS3.EDO.BaseFilter.Regulation","js!SBIS3.EDO.BaseFilter.OurOrganisation","js!SBIS3.EDO.BaseFilter.RightsLimText"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.EDO.BaseFilter.Period"]=e[1],r["js!SBIS3.EDO.BaseFilter.State"]=e[2],r["js!SBIS3.EDO.BaseFilter.Marks"]=e[3],r["js!SBIS3.EDO.BaseFilter.ResponsibleFace"]=e[4],r["js!SBIS3.EDO.BaseFilter.Face1"]=e[5],r["js!SBIS3.EDO.BaseFilter.Deleted"]=e[6],r["js!SBIS3.EDO.BaseFilter.Signed"]=e[7],r["js!SBIS3.EDO.BaseFilter.Regulation"]=e[8],r["js!SBIS3.EDO.BaseFilter.OurOrganisation"]=e[9],r["js!SBIS3.EDO.BaseFilter.RightsLimText"]=e[10];var o=function e(o,i,l,a,n){function s(){}var c=0,d=void 0!==t&&t?t:arguments[arguments.length-1];void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure"));var S={};n&&n.isSetts&&(S=n.fullContext||{});var p="string"==typeof l?l:"",u=void 0===r?void 0:r,B={id:[],def:void 0},y=d.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),F=this&&this.includedTemplates?this.includedTemplates:{},m=d.getMarkupGenerator(a);try{var f=m.joinElements([m.createTag("div",{class:"edo-BaseFilter__filterPicker"},[m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Period",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},l,u,F,d.config,S),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.State",{items:[{key:"-1",title:global.rk("В любом состоянии")},{key:"10",title:global.rk("Внутренняя обработка")},{key:"7",title:global.rk("Утвержденные")},{key:"9",title:global.rk("Отклоненные")},{key:"22",title:global.rk("Аннулированные")},{key:"19,20",title:global.rk("Удалено мной/контрагентом")},{key:"0,1",title:global.rk("Черновики")}],esc:!1},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},l,u,F,d.config,S),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Marks",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},l,u,F,d.config,S),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ResponsibleFace",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},l,u,F,d.config,S),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Face1",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},l,u,F,d.config,S),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Deleted",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},l,u,F,d.config,S),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Signed",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},l,u,F,d.config,S),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Regulation",{query:"АктСверкиДок.RegulationStdList",docTypes:d.getter(o,["docTypes"])},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},l,u,F,d.config,S),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.OurOrganisation",{scopeArea:"Акты сверок"},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},l,u,F,d.config,S),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.RightsLimText",{textRender:d.getTypeFunc("js!SBIS3.EDO.ScopeFilters:setScopeTextForFilter ",{}),esc:!1},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},l,u,F,d.config,S)],i,B,this)],p,B);B.def&&(f=m.chain(f,B,i),B=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/Filtry/FilterReconciliationReportsAll/FilterReconciliationReportsAll.tmpl",e,o)}return f||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FilterReconciliationReportsAll"}},o});
define('js!SBIS3.EDO.FilterReconciliationReportsAll',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FilterReconciliationReportsAll','js!SBIS3.EDO.ScopeFilters','js!SBIS3.EDO.BaseFilter.Period','js!SBIS3.EDO.BaseFilter.State','js!SBIS3.EDO.BaseFilter.Deleted','js!SBIS3.EDO.BaseFilter.Marks','js!SBIS3.EDO.BaseFilter.ResponsibleFace','js!SBIS3.EDO.BaseFilter.Face1','js!SBIS3.EDO.BaseFilter.Signed','js!SBIS3.EDO.BaseFilter.Regulation','js!SBIS3.EDO.BaseFilter.OurOrganisation','js!SBIS3.EDO.BaseFilter.RightsLimText','Elektronnyj_dokumentooborot_localization'],function(e,t){var i=e.extend({_dotTplFn:t,$protected:{_options:{autoHeight:true,autoWidth:true,docTypes:[{docTypeString:'АктСверкиДок',subDocTypeString:''},{docTypeString:'АктСверВх',subDocTypeString:''},{docTypeString:'АктСверИсх',subDocTypeString:''}]}},$constructor:function(){},init:function(){i.superclass.init.call(this);}});return i;});
define("tmpl!SBIS3.EDO.FilterReconciliationReportsAllSelector",["Core/tmpl/js/tclosure","js!SBIS3.EDO.BaseFilter.MarksSelector","js!SBIS3.EDO.BaseFilter.ResponsibleFaceSelector","js!SBIS3.EDO.BaseFilter.Face1Selector","js!SBIS3.EDO.BaseFilter.DeletedSelector","js!SBIS3.EDO.BaseFilter.SignedSelector","js!SBIS3.EDO.BaseFilter.RegulationSelector","js!SBIS3.EDO.BaseFilter.OurOrganisationSelector"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.EDO.BaseFilter.MarksSelector"]=e[1],r["js!SBIS3.EDO.BaseFilter.ResponsibleFaceSelector"]=e[2],r["js!SBIS3.EDO.BaseFilter.Face1Selector"]=e[3],r["js!SBIS3.EDO.BaseFilter.DeletedSelector"]=e[4],r["js!SBIS3.EDO.BaseFilter.SignedSelector"]=e[5],r["js!SBIS3.EDO.BaseFilter.RegulationSelector"]=e[6],r["js!SBIS3.EDO.BaseFilter.OurOrganisationSelector"]=e[7];var o=function e(o,l,i,n,a){function c(){}var s=0,S=void 0!==t&&t?t:arguments[arguments.length-1];void 0===S&&(eval("var thelpers = null;"),S=global.requirejs("View/Runner/tclosure"));var d={};a&&a.isSetts&&(d=a.fullContext||{});var u="string"==typeof i?i:"",p=void 0===r?void 0:r,B={id:[],def:void 0},f=S.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),F=this&&this.includedTemplates?this.includedTemplates:{},m=S.getMarkupGenerator(n);try{var v=m.joinElements([m.createTag("div",{class:"edo-BaseFilter__filterPicker  edo-twoColumnSelectors"},[m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.MarksSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},i,p,F,S.config,d),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ResponsibleFaceSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},i,p,F,S.config,d),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Face1Selector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},i,p,F,S.config,d),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.DeletedSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},i,p,F,S.config,d),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.SignedSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},i,p,F,S.config,d),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.RegulationSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},i,p,F,S.config,d),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.OurOrganisationSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},i,p,F,S.config,d)],l,B,this)],u,B);B.def&&(v=m.chain(v,B,l),B=void 0)}catch(e){S.templateError("resources/Elektronnyj_dokumentooborot/Filtry/FilterReconciliationReportsAll/FilterReconciliationReportsAllSelector/FilterReconciliationReportsAllSelector.tmpl",e,o)}return v||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FilterReconciliationReportsAllSelector"}},o});
define('js!SBIS3.EDO.FilterReconciliationReportsAllSelector',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FilterReconciliationReportsAllSelector','js!SBIS3.EDO.BaseFilter.MarksSelector','js!SBIS3.EDO.BaseFilter.ResponsibleFaceSelector','js!SBIS3.EDO.BaseFilter.Face1Selector','js!SBIS3.EDO.BaseFilter.DeletedSelector','js!SBIS3.EDO.BaseFilter.SignedSelector','js!SBIS3.EDO.BaseFilter.RegulationSelector','js!SBIS3.EDO.BaseFilter.OurOrganisationSelector','Elektronnyj_dokumentooborot_localization'],function(e,t){var l=e.extend({_dotTplFn:t,$protected:{_options:{autoHeight:true,autoWidth:true}},$constructor:function(){},init:function(){l.superclass.init.call(this);}});return l;});
define("tmpl!SBIS3.EDO.FilterReconciliationReportsIn",["Core/tmpl/js/tclosure","js!SBIS3.EDO.BaseFilter.Period","js!SBIS3.EDO.BaseFilter.Marks","js!SBIS3.EDO.BaseFilter.ResponsibleFace","js!SBIS3.EDO.BaseFilter.Face1","js!SBIS3.EDO.BaseFilter.Deleted","js!SBIS3.EDO.BaseFilter.Signed","js!SBIS3.EDO.BaseFilter.Regulation","js!SBIS3.EDO.BaseFilter.OurOrganisation"],function(){var e=Array.prototype.slice.call(arguments),r=e[0],t={};t["js!SBIS3.EDO.BaseFilter.Period"]=e[1],t["js!SBIS3.EDO.BaseFilter.Marks"]=e[2],t["js!SBIS3.EDO.BaseFilter.ResponsibleFace"]=e[3],t["js!SBIS3.EDO.BaseFilter.Face1"]=e[4],t["js!SBIS3.EDO.BaseFilter.Deleted"]=e[5],t["js!SBIS3.EDO.BaseFilter.Signed"]=e[6],t["js!SBIS3.EDO.BaseFilter.Regulation"]=e[7],t["js!SBIS3.EDO.BaseFilter.OurOrganisation"]=e[8];var o=function e(o,i,n,a,s){function l(){}var c=0,d=void 0!==r&&r?r:arguments[arguments.length-1];void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure"));var p={};s&&s.isSetts&&(p=s.fullContext||{});var S="string"==typeof n?n:"",u=void 0===t?void 0:t,B={id:[],def:void 0},f=d.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),F=this&&this.includedTemplates?this.includedTemplates:{},m=d.getMarkupGenerator(a);try{var y=m.joinElements([m.createTag("div",{class:"edo-BaseFilter__filterPicker"},[m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Period",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},n,u,F,d.config,p),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Marks",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},n,u,F,d.config,p),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ResponsibleFace",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},n,u,F,d.config,p),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Face1",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},n,u,F,d.config,p),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Deleted",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},n,u,F,d.config,p),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Signed",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},n,u,F,d.config,p),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Regulation",{docTypes:d.getter(o,["docTypes"])},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},n,u,F,d.config,p),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.OurOrganisation",{scopeArea:"Входящие акты сверки"},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},n,u,F,d.config,p)],i,B,this)],S,B);B.def&&(y=m.chain(y,B,i),B=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/Filtry/FilterReconciliationReportsIn/FilterReconciliationReportsIn.tmpl",e,o)}return y||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FilterReconciliationReportsIn"}},o});
define('js!SBIS3.EDO.FilterReconciliationReportsIn',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FilterReconciliationReportsIn','js!SBIS3.EDO.ScopeFilters','js!SBIS3.EDO.BaseFilter.Period','js!SBIS3.EDO.BaseFilter.Deleted','js!SBIS3.EDO.BaseFilter.Marks','js!SBIS3.EDO.BaseFilter.ResponsibleFace','js!SBIS3.EDO.BaseFilter.Face1','js!SBIS3.EDO.BaseFilter.Signed','js!SBIS3.EDO.BaseFilter.Regulation','js!SBIS3.EDO.BaseFilter.OurOrganisation','Elektronnyj_dokumentooborot_localization'],function(e,t){var i=e.extend({_dotTplFn:t,$protected:{_options:{autoHeight:true,autoWidth:true,docTypes:[{docTypeString:'АктСверВх',subDocTypeString:''}]}},$constructor:function(){},init:function(){i.superclass.init.call(this);}});return i;});
define("tmpl!SBIS3.EDO.FilterReconciliationReportsOut",["Core/tmpl/js/tclosure","js!SBIS3.EDO.BaseFilter.Period","js!SBIS3.EDO.BaseFilter.Marks","js!SBIS3.EDO.BaseFilter.ResponsibleFace","js!SBIS3.EDO.BaseFilter.Face1","js!SBIS3.EDO.BaseFilter.Deleted","js!SBIS3.EDO.BaseFilter.Signed","js!SBIS3.EDO.BaseFilter.Regulation","js!SBIS3.EDO.BaseFilter.OurOrganisation"],function(){var e=Array.prototype.slice.call(arguments),r=e[0],t={};t["js!SBIS3.EDO.BaseFilter.Period"]=e[1],t["js!SBIS3.EDO.BaseFilter.Marks"]=e[2],t["js!SBIS3.EDO.BaseFilter.ResponsibleFace"]=e[3],t["js!SBIS3.EDO.BaseFilter.Face1"]=e[4],t["js!SBIS3.EDO.BaseFilter.Deleted"]=e[5],t["js!SBIS3.EDO.BaseFilter.Signed"]=e[6],t["js!SBIS3.EDO.BaseFilter.Regulation"]=e[7],t["js!SBIS3.EDO.BaseFilter.OurOrganisation"]=e[8];var o=function e(o,i,n,a,s){function l(){}var c=0,d=void 0!==r&&r?r:arguments[arguments.length-1];void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure"));var u={};s&&s.isSetts&&(u=s.fullContext||{});var p="string"==typeof n?n:"",S=void 0===t?void 0:t,B={id:[],def:void 0},f=d.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),F=this&&this.includedTemplates?this.includedTemplates:{},O=d.getMarkupGenerator(a);try{var m=O.joinElements([O.createTag("div",{class:"edo-BaseFilter__filterPicker"},[O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Period",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},n,S,F,d.config,u),O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Marks",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},n,S,F,d.config,u),O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ResponsibleFace",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},n,S,F,d.config,u),O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Face1",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},n,S,F,d.config,u),O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Deleted",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},n,S,F,d.config,u),O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Signed",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},n,S,F,d.config,u),O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Regulation",{docTypes:d.getter(o,["docTypes"])},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},n,S,F,d.config,u),O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.OurOrganisation",{scopeArea:"Исходящие акты сверки"},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},n,S,F,d.config,u)],i,B,this)],p,B);B.def&&(m=O.chain(m,B,i),B=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/Filtry/FilterReconciliationReportsOut/FilterReconciliationReportsOut.tmpl",e,o)}return m||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FilterReconciliationReportsOut"}},o});
define('js!SBIS3.EDO.FilterReconciliationReportsOut',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FilterReconciliationReportsOut','js!SBIS3.EDO.ScopeFilters','js!SBIS3.EDO.BaseFilter.Period','js!SBIS3.EDO.BaseFilter.Deleted','js!SBIS3.EDO.BaseFilter.Marks','js!SBIS3.EDO.BaseFilter.ResponsibleFace','js!SBIS3.EDO.BaseFilter.Face1','js!SBIS3.EDO.BaseFilter.Signed','js!SBIS3.EDO.BaseFilter.Regulation','js!SBIS3.EDO.BaseFilter.OurOrganisation','Elektronnyj_dokumentooborot_localization'],function(e,t){var i=e.extend({_dotTplFn:t,$protected:{_options:{autoHeight:true,autoWidth:true,docTypes:[{docTypeString:'АктСверИсх',subDocTypeString:''}]}},$constructor:function(){},init:function(){i.superclass.init.call(this);}});return i;});
define("tmpl!SBIS3.EDO.FilterStatsContragents",["Core/tmpl/js/tclosure","js!SBIS3.EDO.BaseFilter.Period","js!SBIS3.EDO.BaseFilter.ResponsibleFace","js!SBIS3.EDO.BaseFilter.Face1","js!SBIS3.EDO.BaseFilter.Unfixed","js!SBIS3.EDO.BaseFilter.OurOrganisation","js!SBIS3.EDO.BaseFilter.DocumentType","js!SBIS3.EDO.BaseFilter.State","js!SBIS3.EDO.BaseFilter.RightsLimText"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.EDO.BaseFilter.Period"]=e[1],r["js!SBIS3.EDO.BaseFilter.ResponsibleFace"]=e[2],r["js!SBIS3.EDO.BaseFilter.Face1"]=e[3],r["js!SBIS3.EDO.BaseFilter.Unfixed"]=e[4],r["js!SBIS3.EDO.BaseFilter.OurOrganisation"]=e[5],r["js!SBIS3.EDO.BaseFilter.DocumentType"]=e[6],r["js!SBIS3.EDO.BaseFilter.State"]=e[7],r["js!SBIS3.EDO.BaseFilter.RightsLimText"]=e[8];var o=function e(o,i,a,l,n){function s(){}var c=0,S=void 0!==t&&t?t:arguments[arguments.length-1];void 0===S&&(eval("var thelpers = null;"),S=global.requirejs("View/Runner/tclosure"));var d={};n&&n.isSetts&&(d=n.fullContext||{});var p="string"==typeof a?a:"",u=void 0===r?void 0:r,B={id:[],def:void 0},y=S.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),m=this&&this.includedTemplates?this.includedTemplates:{},f=S.getMarkupGenerator(l);try{var F=f.joinElements([f.createTag("div",{class:"edo-BaseFilter__filterPicker"},[f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Period",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},a,u,m,S.config,d),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ResponsibleFace",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},a,u,m,S.config,d),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Face1",{caption:global.rk("Покупатель")},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},a,u,m,S.config,d),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Unfixed",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},a,u,m,S.config,d),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.OurOrganisation",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},a,u,m,S.config,d),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.DocumentType",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},a,u,m,S.config,d),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.State",{items:[{key:"-1",title:global.rk("В любом состоянии")},{key:"10",title:global.rk("Внутренняя обработка")},{key:"2,3",title:global.rk("Недоставленные")},{key:"4",title:global.rk("Не получен ответ")},{key:"7",title:global.rk("Утвержденные")},{key:"9",title:global.rk("Отклоненные")},{key:"6",title:global.rk("С ошибками")},{key:"22",title:global.rk("Аннулированные")},{key:"19,20",title:global.rk("Удалено мной/контрагентом")},{key:"0,1",title:global.rk("Черновики")},{key:"-2",title:global.rk("Удаленные")}],esc:!1},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},a,u,m,S.config,d),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.RightsLimText",{textRender:S.getTypeFunc("js!SBIS3.EDO.ScopeFilters:setScopeTextForFilter ",{}),hideGlobalText:!0,esc:!1},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},a,u,m,S.config,d)],i,B,this)],p,B);B.def&&(F=f.chain(F,B,i),B=void 0)}catch(e){S.templateError("resources/Elektronnyj_dokumentooborot/Filtry/FilterStatsContragents/FilterStatsContragents.tmpl",e,o)}return F||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FilterStatsContragents"}},o});
define('js!SBIS3.EDO.FilterStatsContragents',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FilterStatsContragents','js!SBIS3.EDO.BaseFilter.Period','js!SBIS3.EDO.BaseFilter.State','js!SBIS3.EDO.BaseFilter.Marks','js!SBIS3.EDO.BaseFilter.ResponsibleFace','js!SBIS3.EDO.BaseFilter.Face1','js!SBIS3.EDO.BaseFilter.Regulation','js!SBIS3.EDO.BaseFilter.Unfixed','js!SBIS3.EDO.BaseFilter.Unread','js!SBIS3.EDO.BaseFilter.OurOrganisation','js!SBIS3.EDO.BaseFilter.DocumentType','js!SBIS3.EDO.BaseFilter.RightsLimText','js!SBIS3.EDO.ScopeFilters','Elektronnyj_dokumentooborot_localization'],function(e,t){return e.extend({_dotTplFn:t,$protected:{_options:{docTypes:[{docTypeString:'ДокОтгрИсх',subDocTypeString:''},{docTypeString:'ФактураИсх',subDocTypeString:''},{docTypeString:'КоррИсх',subDocTypeString:''},{docTypeString:'АктСверИсх',subDocTypeString:''},{docTypeString:'ДоговорИсх',subDocTypeString:''}]}}});});
define("tmpl!SBIS3.EDO.FilterStatsContragentsSelector",["Core/tmpl/js/tclosure","js!SBIS3.EDO.BaseFilter.ResponsibleFaceSelector","js!SBIS3.EDO.BaseFilter.Face1Selector","js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleMeSelector","js!SBIS3.EDO.BaseFilter.UnfixedSelector","js!SBIS3.EDO.BaseFilter.OurOrganisationSelector","js!SBIS3.EDO.BaseFilter.DocumentTypeSelector"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.EDO.BaseFilter.ResponsibleFaceSelector"]=e[1],r["js!SBIS3.EDO.BaseFilter.Face1Selector"]=e[2],r["js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleMeSelector"]=e[3],r["js!SBIS3.EDO.BaseFilter.UnfixedSelector"]=e[4],r["js!SBIS3.EDO.BaseFilter.OurOrganisationSelector"]=e[5],r["js!SBIS3.EDO.BaseFilter.DocumentTypeSelector"]=e[6];var o=function e(o,n,l,i,a){function s(){}var c=0,S=void 0!==t&&t?t:arguments[arguments.length-1];void 0===S&&(eval("var thelpers = null;"),S=global.requirejs("View/Runner/tclosure"));var u={};a&&a.isSetts&&(u=a.fullContext||{});var d="string"==typeof l?l:"",p=void 0===r?void 0:r,B={id:[],def:void 0},f=S.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),m=this&&this.includedTemplates?this.includedTemplates:{},F=S.getMarkupGenerator(i);try{var y=F.joinElements([F.createTag("div",{class:"edo-BaseFilter__filterPicker  edo-twoColumnSelectors"},[F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ResponsibleFaceSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},l,p,m,S.config,u),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Face1Selector",{caption:global.rk("Покупателя")},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},l,p,m,S.config,u),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.AuthorOrResponsibleMeSelector",{useMineStr:!0},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},l,p,m,S.config,u),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.UnfixedSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},l,p,m,S.config,u),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.OurOrganisationSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},l,p,m,S.config,u),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.DocumentTypeSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},l,p,m,S.config,u)],n,B,this)],d,B);B.def&&(y=F.chain(y,B,n),B=void 0)}catch(e){S.templateError("resources/Elektronnyj_dokumentooborot/Filtry/FilterStatsContragents/FilterStatsContragentsSelector/FilterStatsContragentsSelector.tmpl",e,o)}return y||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FilterStatsContragentsSelector"}},o});
define('js!SBIS3.EDO.FilterStatsContragentsSelector',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FilterStatsContragentsSelector','js!SBIS3.EDO.BaseFilter.MarksSelector','js!SBIS3.EDO.BaseFilter.ResponsibleFaceSelector','js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleMeSelector','js!SBIS3.EDO.BaseFilter.Face1Selector','js!SBIS3.EDO.BaseFilter.RegulationSelector','js!SBIS3.EDO.BaseFilter.UnreadSelector','js!SBIS3.EDO.BaseFilter.UnfixedSelector','js!SBIS3.EDO.BaseFilter.SpecificPerformerSelector','js!SBIS3.EDO.BaseFilter.OurOrganisationSelector','js!SBIS3.EDO.BaseFilter.DocumentTypeSelector','js!SBIS3.EDO.FilterDeliveryMethod','js!SBIS3.EDO.FilterDeliveryMethodSelector','js!SBIS3.EDO.DeliveryMethodSelector','Elektronnyj_dokumentooborot_localization'],function(e,t){return e.extend({_dotTplFn:t,$protected:{_options:{}}});});
define("tmpl!SBIS3.EDO.FilterStatsOrganizations",["Core/tmpl/js/tclosure","js!SBIS3.EDO.BaseFilter.Period","js!SBIS3.EDO.BaseFilter.ResponsibleFace","js!SBIS3.EDO.BaseFilter.Face1","js!SBIS3.EDO.BaseFilter.Unfixed","js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleMe","js!SBIS3.EDO.BaseFilter.RightsLimText"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.EDO.BaseFilter.Period"]=e[1],r["js!SBIS3.EDO.BaseFilter.ResponsibleFace"]=e[2],r["js!SBIS3.EDO.BaseFilter.Face1"]=e[3],r["js!SBIS3.EDO.BaseFilter.Unfixed"]=e[4],r["js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleMe"]=e[5],r["js!SBIS3.EDO.BaseFilter.RightsLimText"]=e[6];var o=function e(o,i,n,s,a){function l(){}var c=0,d=void 0!==t&&t?t:arguments[arguments.length-1];void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure"));var S={};a&&a.isSetts&&(S=a.fullContext||{});var p="string"==typeof n?n:"",u=void 0===r?void 0:r,B={id:[],def:void 0},f=d.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),F=this&&this.includedTemplates?this.includedTemplates:{},m=d.getMarkupGenerator(s);try{var v=m.joinElements([m.createTag("div",{class:"edo-BaseFilter__filterPicker"},[m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Period",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},n,u,F,d.config,S),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ResponsibleFace",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},n,u,F,d.config,S),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Face1",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},n,u,F,d.config,S),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Unfixed",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},n,u,F,d.config,S),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.AuthorOrResponsibleMe",{useMineStr:!0},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},n,u,F,d.config,S),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.RightsLimText",{textRender:d.getTypeFunc("js!SBIS3.EDO.ScopeFilters:setScopeTextForFilter",{}),hideGlobalText:!0,esc:!1},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},n,u,F,d.config,S)],i,B,this)],p,B);B.def&&(v=m.chain(v,B,i),B=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/Filtry/FilterStatsOrganizations/FilterStatsOrganizations.tmpl",e,o)}return v||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FilterStatsOrganizations"}},o});
define('js!SBIS3.EDO.FilterStatsOrganizations',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FilterStatsOrganizations','Elektronnyj_dokumentooborot_localization'],function(t,n){'use strict';return t.extend({_dotTplFn:n,$protected:{_options:{}}});});
define("tmpl!SBIS3.EDO.FilterStatsOrganizationsSelector",["Core/tmpl/js/tclosure","js!SBIS3.EDO.BaseFilter.ResponsibleFaceSelector","js!SBIS3.EDO.BaseFilter.Face1Selector","js!SBIS3.EDO.BaseFilter.UnfixedSelector","js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleMeSelector"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.EDO.BaseFilter.ResponsibleFaceSelector"]=e[1],r["js!SBIS3.EDO.BaseFilter.Face1Selector"]=e[2],r["js!SBIS3.EDO.BaseFilter.UnfixedSelector"]=e[3],r["js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleMeSelector"]=e[4];var o=function e(o,i,l,n,a){function s(){}var c=0,S=void 0!==t&&t?t:arguments[arguments.length-1];void 0===S&&(eval("var thelpers = null;"),S=global.requirejs("View/Runner/tclosure"));var d={};a&&a.isSetts&&(d=a.fullContext||{});var u="string"==typeof l?l:"",p=void 0===r?void 0:r,f={id:[],def:void 0},B=S.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),F=this&&this.includedTemplates?this.includedTemplates:{},m=S.getMarkupGenerator(n);try{var v=m.joinElements([m.createTag("div",{class:"edo-BaseFilter__filterPicker  edo-twoColumnSelectors"},[m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ResponsibleFaceSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},l,p,F,S.config,d),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Face1Selector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},l,p,F,S.config,d),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.UnfixedSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},l,p,F,S.config,d),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.AuthorOrResponsibleMeSelector",{useMineStr:!0},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},l,p,F,S.config,d)],i,f,this)],u,f);f.def&&(v=m.chain(v,f,i),f=void 0)}catch(e){S.templateError("resources/Elektronnyj_dokumentooborot/Filtry/FilterStatsOrganizations/FilterStatsOrganizationsSelector/FilterStatsOrganizationsSelector.tmpl",e,o)}return v||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FilterStatsOrganizationsSelector"}},o});
define('js!SBIS3.EDO.FilterStatsOrganizationsSelector',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FilterStatsOrganizationsSelector','js!SBIS3.EDO.ScopeFilters','Elektronnyj_dokumentooborot_localization'],function(t,e){return t.extend({_dotTplFn:e,$protected:{_options:{}}});});
define("tmpl!SBIS3.EDO.FilterTasks/FilterTasks",["Core/tmpl/js/tclosure","js!SBIS3.EDO.BaseFilter.Period","js!SBIS3.EDO.BaseFilter.ShortState","js!SBIS3.EDO.BaseFilter.LimitationOverdue","js!SBIS3.EDO.BaseFilter.Regulation","js!SBIS3.EDO.BaseFilter.Face1","js!SBIS3.EDO.BaseFilter.Marks","js!SBIS3.EDO.BaseFilter.ListDispatch","js!SBIS3.EDO.BaseFilter.SpecificPerformer","js!SBIS3.EDO.BaseFilter.AuthorOrResponsible","js!SBIS3.EDO.BaseFilter.Milestone","js!SBIS3.EDO.BaseFilter.WorkingArea"],function(){var e=Array.prototype.slice.call(arguments),r=e[0],t={};t["js!SBIS3.EDO.BaseFilter.Period"]=e[1],t["js!SBIS3.EDO.BaseFilter.ShortState"]=e[2],t["js!SBIS3.EDO.BaseFilter.LimitationOverdue"]=e[3],t["js!SBIS3.EDO.BaseFilter.Regulation"]=e[4],t["js!SBIS3.EDO.BaseFilter.Face1"]=e[5],t["js!SBIS3.EDO.BaseFilter.Marks"]=e[6],t["js!SBIS3.EDO.BaseFilter.ListDispatch"]=e[7],t["js!SBIS3.EDO.BaseFilter.SpecificPerformer"]=e[8],t["js!SBIS3.EDO.BaseFilter.AuthorOrResponsible"]=e[9],t["js!SBIS3.EDO.BaseFilter.Milestone"]=e[10],t["js!SBIS3.EDO.BaseFilter.WorkingArea"]=e[11];var o=function e(o,i,a,l,s){function n(){}var c=0,S=void 0!==r&&r?r:arguments[arguments.length-1];void 0===S&&(eval("var thelpers = null;"),S=global.requirejs("View/Runner/tclosure"));var d={};s&&s.isSetts&&(d=s.fullContext||{});var p="string"==typeof a?a:"",u=void 0===t?void 0:t,B={id:[],def:void 0},m=S.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),f=this&&this.includedTemplates?this.includedTemplates:{},y=S.getMarkupGenerator(l);try{var F=y.joinElements([y.createTag("div",{class:"edo-BaseFilter__filterPicker"},[y.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Period",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,u,f,S.config,d),y.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ShortState",{items:[{key:"-1",title:global.rk("В любом состоянии")},{key:"4",title:global.rk("В обработке")},{key:"1",title:global.rk("Завершенные")},{key:"2",title:global.rk("Завершенные положительно"),listTitle:global.rk("положительно")},{key:"3",title:global.rk("Завершенные отрицательно"),listTitle:global.rk("отрицательно")},{key:"5",title:global.rk("Черновики")},{key:"-2",title:global.rk("Удаленные")}],esc:!1},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,u,f,S.config,d),y.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.LimitationOverdue",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,u,f,S.config,d),y.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Regulation",{docTypes:[{docTypeString:"СлужЗап",subDocTypeString:""}]},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,u,f,S.config,d),y.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Face1",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,u,f,S.config,d),y.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Marks",{reestrName:"СлужЗап"},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,u,f,S.config,d),y.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ListDispatch",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,u,f,S.config,d),y.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.SpecificPerformer",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,u,f,S.config,d),y.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.AuthorOrResponsible",{showCustom:!0},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,u,f,S.config,d),y.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Milestone",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,u,f,S.config,d),y.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.WorkingArea",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,u,f,S.config,d)],i,B,this)],p,B);B.def&&(F=y.chain(F,B,i),B=void 0)}catch(e){S.templateError("resources/Elektronnyj_dokumentooborot/Filtry/FilterTasks/FilterTasks.tmpl",e,o)}return F||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FilterTasks/FilterTasks"}},o});
define('js!SBIS3.EDO.FilterTasks',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FilterTasks/FilterTasks','js!SBIS3.EDO.BaseFilter.ShortState','js!SBIS3.EDO.BaseFilter.LimitationOverdue','js!SBIS3.EDO.BaseFilter.Regulation','js!SBIS3.EDO.BaseFilter.Marks','js!SBIS3.EDO.BaseFilter.ListDispatch','js!SBIS3.EDO.BaseFilter.SpecificPerformer','js!SBIS3.EDO.BaseFilter.AuthorOrResponsible','js!SBIS3.EDO.BaseFilter.Milestone','js!SBIS3.EDO.BaseFilter.WorkingArea','Elektronnyj_dokumentooborot_localization'],function(e,s){var t=e.extend({_dotTplFn:s,$protected:{_options:{}},init:function(){t.superclass.init.call(this);}});return t;});
define("tmpl!SBIS3.EDO.FilterTasksSelector/FilterTasksSelector",["Core/tmpl/js/tclosure","js!SBIS3.EDO.BaseFilter.LimitationOverdueSelector","js!SBIS3.EDO.BaseFilter.RegulationSelector","js!SBIS3.EDO.BaseFilter.Face1Selector","js!SBIS3.EDO.BaseFilter.MarksSelector","js!SBIS3.EDO.BaseFilter.ListDispatchSelector","js!SBIS3.EDO.BaseFilter.SpecificPerformerSelector","js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleSelector","js!SBIS3.EDO.BaseFilter.MilestoneSelector","js!SBIS3.EDO.BaseFilter.WorkingAreaSelector"],function(){var e=Array.prototype.slice.call(arguments),r=e[0],t={};t["js!SBIS3.EDO.BaseFilter.LimitationOverdueSelector"]=e[1],t["js!SBIS3.EDO.BaseFilter.RegulationSelector"]=e[2],t["js!SBIS3.EDO.BaseFilter.Face1Selector"]=e[3],t["js!SBIS3.EDO.BaseFilter.MarksSelector"]=e[4],t["js!SBIS3.EDO.BaseFilter.ListDispatchSelector"]=e[5],t["js!SBIS3.EDO.BaseFilter.SpecificPerformerSelector"]=e[6],t["js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleSelector"]=e[7],t["js!SBIS3.EDO.BaseFilter.MilestoneSelector"]=e[8],t["js!SBIS3.EDO.BaseFilter.WorkingAreaSelector"]=e[9];var o=function e(o,i,l,a,s){function n(){}var c=0,S=void 0!==r&&r?r:arguments[arguments.length-1];void 0===S&&(eval("var thelpers = null;"),S=global.requirejs("View/Runner/tclosure"));var d={};s&&s.isSetts&&(d=s.fullContext||{});var u="string"==typeof l?l:"",p=void 0===t?void 0:t,B={id:[],def:void 0},f=S.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),m=this&&this.includedTemplates?this.includedTemplates:{},F=S.getMarkupGenerator(a);try{var v=F.joinElements([F.createTag("div",{class:"edo-BaseFilter__filterPicker edo-twoColumnSelectors"},[F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.LimitationOverdueSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},l,p,m,S.config,d),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.RegulationSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},l,p,m,S.config,d),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Face1Selector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},l,p,m,S.config,d),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.MarksSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},l,p,m,S.config,d),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ListDispatchSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},l,p,m,S.config,d),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.SpecificPerformerSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},l,p,m,S.config,d),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.AuthorOrResponsibleSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},l,p,m,S.config,d),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.MilestoneSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},l,p,m,S.config,d),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.WorkingAreaSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},l,p,m,S.config,d)],i,B,this)],u,B);B.def&&(v=F.chain(v,B,i),B=void 0)}catch(e){S.templateError("resources/Elektronnyj_dokumentooborot/Filtry/FilterTasks/FilterTasksSelector/FilterTasksSelector.tmpl",e,o)}return v||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FilterTasksSelector/FilterTasksSelector"}},o});
define('js!SBIS3.EDO.FilterTasksSelector',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FilterTasksSelector/FilterTasksSelector','js!SBIS3.EDO.BaseFilter.LimitationOverdueSelector','js!SBIS3.EDO.BaseFilter.RegulationSelector','js!SBIS3.EDO.BaseFilter.MarksSelector','js!SBIS3.EDO.BaseFilter.ListDispatchSelector','js!SBIS3.EDO.BaseFilter.SpecificPerformerSelector','js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleSelector','js!SBIS3.EDO.BaseFilter.MilestoneSelector','js!SBIS3.EDO.BaseFilter.WorkingAreaSelector','Elektronnyj_dokumentooborot_localization'],function(e,t){var r=e.extend({_dotTplFn:t,$protected:{_options:{}},init:function(){r.superclass.init.call(this);}});return r;});
define("tmpl!SBIS3.EDO.FilterTasksControlled/FilterTasksControlled",["Core/tmpl/js/tclosure","js!SBIS3.EDO.BaseFilter.LimitationOverdue","js!SBIS3.EDO.BaseFilter.Regulation","js!SBIS3.EDO.BaseFilter.Face1","js!SBIS3.EDO.BaseFilter.AuthorOrResponsible","js!SBIS3.EDO.BaseFilter.Milestone","js!SBIS3.EDO.BaseFilter.Marks","js!SBIS3.EDO.BaseFilter.Project","js!SBIS3.EDO.BaseFilter.WorkingArea","js!SBIS3.EDO.BaseFilter.ListDispatch","js!SBIS3.EDO.BaseFilter.State"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.EDO.BaseFilter.LimitationOverdue"]=e[1],r["js!SBIS3.EDO.BaseFilter.Regulation"]=e[2],r["js!SBIS3.EDO.BaseFilter.Face1"]=e[3],r["js!SBIS3.EDO.BaseFilter.AuthorOrResponsible"]=e[4],r["js!SBIS3.EDO.BaseFilter.Milestone"]=e[5],r["js!SBIS3.EDO.BaseFilter.Marks"]=e[6],r["js!SBIS3.EDO.BaseFilter.Project"]=e[7],r["js!SBIS3.EDO.BaseFilter.WorkingArea"]=e[8],r["js!SBIS3.EDO.BaseFilter.ListDispatch"]=e[9],r["js!SBIS3.EDO.BaseFilter.State"]=e[10];var o=function e(o,i,l,a,s){function n(){}var c=0,d=void 0!==t&&t?t:arguments[arguments.length-1];void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure"));var S={};s&&s.isSetts&&(S=s.fullContext||{});var u="string"==typeof l?l:"",B=void 0===r?void 0:r,p={id:[],def:void 0},m=d.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),y=this&&this.includedTemplates?this.includedTemplates:{},f=d.getMarkupGenerator(a);try{var F=f.joinElements([f.createTag("div",{class:"edo-BaseFilter__filterPicker"},[f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.LimitationOverdue",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},l,B,y,d.config,S),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Regulation",{multiselect:!0},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},l,B,y,d.config,S),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Face1",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},l,B,y,d.config,S),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.AuthorOrResponsible",{showCustom:!0},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},l,B,y,d.config,S),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Milestone",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},l,B,y,d.config,S),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Marks",{multiDocsReestr:!0},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},l,B,y,d.config,S),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Project",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},l,B,y,d.config,S),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.WorkingArea",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},l,B,y,d.config,S),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ListDispatch",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},l,B,y,d.config,S),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.State",{items:[{key:"-1",title:global.rk("В любом состоянии")},{key:"10",title:global.rk("В обработке")},{key:"7,9",title:global.rk("Завершенные")},{key:"7",title:global.rk("Завершенные положительно"),listTitle:global.rk("положительно")},{key:"9",title:global.rk("Завершенные отрицательно"),listTitle:global.rk("отрицательно")},{key:"-2",title:global.rk("Удаленные")}],esc:!1},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},l,B,y,d.config,S)],i,p,this)],u,p);p.def&&(F=f.chain(F,p,i),p=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/Filtry/FilterTasksControlled/FilterTasksControlled.tmpl",e,o)}return F||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FilterTasksControlled/FilterTasksControlled"}},o});
define('js!SBIS3.EDO.FilterTasksControlled',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FilterTasksControlled/FilterTasksControlled','js!SBIS3.EDO.BaseFilter.LimitationOverdue','js!SBIS3.EDO.BaseFilter.Regulation','js!SBIS3.EDO.BaseFilter.Face1','js!SBIS3.EDO.BaseFilter.AuthorOrResponsible','js!SBIS3.EDO.BaseFilter.Milestone','js!SBIS3.EDO.BaseFilter.Marks','js!SBIS3.EDO.BaseFilter.Project','js!SBIS3.EDO.BaseFilter.WorkingArea','js!SBIS3.EDO.BaseFilter.ListDispatch','js!SBIS3.EDO.BaseFilter.State','Elektronnyj_dokumentooborot_localization'],function(e,t){var s=e.extend({_dotTplFn:t,$protected:{_options:{}},$constructor:function(){},init:function(){s.superclass.init.call(this);}});return s;});
define("tmpl!SBIS3.EDO.FilterTasksControlledSelector/FilterTasksControlledSelector",["Core/tmpl/js/tclosure","js!SBIS3.EDO.BaseFilter.LimitationOverdueSelector","js!SBIS3.EDO.BaseFilter.RegulationSelector","js!SBIS3.EDO.BaseFilter.Face1Selector","js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleSelector","js!SBIS3.EDO.BaseFilter.MilestoneSelector","js!SBIS3.EDO.BaseFilter.MarksSelector","js!SBIS3.EDO.BaseFilter.ProjectSelector","js!SBIS3.EDO.BaseFilter.WorkingAreaSelector","js!SBIS3.EDO.BaseFilter.ListDispatchSelector"],function(){var e=Array.prototype.slice.call(arguments),r=e[0],t={};t["js!SBIS3.EDO.BaseFilter.LimitationOverdueSelector"]=e[1],t["js!SBIS3.EDO.BaseFilter.RegulationSelector"]=e[2],t["js!SBIS3.EDO.BaseFilter.Face1Selector"]=e[3],t["js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleSelector"]=e[4],t["js!SBIS3.EDO.BaseFilter.MilestoneSelector"]=e[5],t["js!SBIS3.EDO.BaseFilter.MarksSelector"]=e[6],t["js!SBIS3.EDO.BaseFilter.ProjectSelector"]=e[7],t["js!SBIS3.EDO.BaseFilter.WorkingAreaSelector"]=e[8],t["js!SBIS3.EDO.BaseFilter.ListDispatchSelector"]=e[9];var o=function e(o,l,i,a,n){function s(){}var c=0,S=void 0!==r&&r?r:arguments[arguments.length-1];void 0===S&&(eval("var thelpers = null;"),S=global.requirejs("View/Runner/tclosure"));var d={};n&&n.isSetts&&(d=n.fullContext||{});var u="string"==typeof i?i:"",p=void 0===t?void 0:t,B={id:[],def:void 0},m=S.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),f=this&&this.includedTemplates?this.includedTemplates:{},F=S.getMarkupGenerator(a);try{var v=F.joinElements([F.createTag("div",{class:"edo-BaseFilter__filterPicker edo-twoColumnSelectors"},[F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.LimitationOverdueSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},i,p,f,S.config,d),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.RegulationSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},i,p,f,S.config,d),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Face1Selector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},i,p,f,S.config,d),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.AuthorOrResponsibleSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},i,p,f,S.config,d),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.MilestoneSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},i,p,f,S.config,d),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.MarksSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},i,p,f,S.config,d),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ProjectSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},i,p,f,S.config,d),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.WorkingAreaSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},i,p,f,S.config,d),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ListDispatchSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},i,p,f,S.config,d)],l,B,this)],u,B);B.def&&(v=F.chain(v,B,l),B=void 0)}catch(e){S.templateError("resources/Elektronnyj_dokumentooborot/Filtry/FilterTasksControlled/FilterTasksControlledSelector/FilterTasksControlledSelector.tmpl",e,o)}return v||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FilterTasksControlledSelector/FilterTasksControlledSelector"}},o});
define('js!SBIS3.EDO.FilterTasksControlledSelector',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FilterTasksControlledSelector/FilterTasksControlledSelector','i18n!SBIS3.EDO.FilterTasksControlledSelector','js!SBIS3.EDO.BaseFilter.LimitationOverdueSelector','js!SBIS3.EDO.BaseFilter.RegulationSelector','js!SBIS3.EDO.BaseFilter.Face1Selector','js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleSelector','js!SBIS3.EDO.BaseFilter.MilestoneSelector','js!SBIS3.EDO.BaseFilter.MarksSelector','js!SBIS3.EDO.BaseFilter.ProjectSelector','js!SBIS3.EDO.BaseFilter.WorkingAreaSelector','js!SBIS3.EDO.BaseFilter.ListDispatchSelector','Elektronnyj_dokumentooborot_localization'],function(e,t){var r=e.extend({_dotTplFn:t,$protected:{_options:{}},$constructor:function(){},init:function(){r.superclass.init.call(this);}});return r;});
define("tmpl!SBIS3.EDO.FilterTasksExecute",["Core/tmpl/js/tclosure","js!SBIS3.EDO.BaseFilter.Period","js!SBIS3.EDO.BaseFilter.Overdue","js!SBIS3.EDO.BaseFilter.Milestone","js!SBIS3.EDO.BaseFilter.Marks","js!SBIS3.EDO.BaseFilter.Regulation","js!SBIS3.EDO.BaseFilter.Sender","js!SBIS3.EDO.BaseFilter.Receiver"],function(){var e=Array.prototype.slice.call(arguments),r=e[0],t={};t["js!SBIS3.EDO.BaseFilter.Period"]=e[1],t["js!SBIS3.EDO.BaseFilter.Overdue"]=e[2],t["js!SBIS3.EDO.BaseFilter.Milestone"]=e[3],t["js!SBIS3.EDO.BaseFilter.Marks"]=e[4],t["js!SBIS3.EDO.BaseFilter.Regulation"]=e[5],t["js!SBIS3.EDO.BaseFilter.Sender"]=e[6],t["js!SBIS3.EDO.BaseFilter.Receiver"]=e[7];var o=function e(o,i,n,a,l){function s(){}var c=0,d=void 0!==r&&r?r:arguments[arguments.length-1];void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure"));var u={};l&&l.isSetts&&(u=l.fullContext||{});var S="string"==typeof n?n:"",B=void 0===t?void 0:t,p={id:[],def:void 0},v=d.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),f=this&&this.includedTemplates?this.includedTemplates:{},m=d.getMarkupGenerator(a);try{var y=m.joinElements([m.createTag("div",{class:"edo-BaseFilter__filterPicker"},[m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Period",{limited:!0},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:v},n,B,f,d.config,u),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Overdue",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:v},n,B,f,d.config,u),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Milestone",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:v},n,B,f,d.config,u),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Marks",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:v},n,B,f,d.config,u),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Regulation",{multiselect:!0},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:v},n,B,f,d.config,u),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Sender",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:v},n,B,f,d.config,u),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Receiver",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:v},n,B,f,d.config,u)],i,p,this)],S,p);p.def&&(y=m.chain(y,p,i),p=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/Filtry/FilterTasksExecute/FilterTasksExecute.tmpl",e,o)}return y||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FilterTasksExecute"}},o});
define('js!SBIS3.EDO.FilterTasksExecute',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FilterTasksExecute','i18n!SBIS3.EDO.FilterTasksExecute','js!SBIS3.EDO.BaseFilter.Period','js!SBIS3.EDO.BaseFilter.Milestone','js!SBIS3.EDO.BaseFilter.Regulation','js!SBIS3.EDO.BaseFilter.Marks','js!SBIS3.EDO.BaseFilter.Sender','js!SBIS3.EDO.BaseFilter.Receiver','js!SBIS3.EDO.BaseFilter.Overdue','Elektronnyj_dokumentooborot_localization'],function(e,t){var s=e.extend({_dotTplFn:t,$protected:{_options:{autoHeight:true,autoWidth:true}},$constructor:function(){},init:function(){s.superclass.init.call(this);}});return s;});
define("tmpl!SBIS3.EDO.FilterTasksExecuteSelector",["Core/tmpl/js/tclosure","js!SBIS3.EDO.BaseFilter.OverdueSelector","js!SBIS3.EDO.BaseFilter.MilestoneSelector","js!SBIS3.EDO.BaseFilter.MarksSelector","js!SBIS3.EDO.BaseFilter.RegulationSelector","js!SBIS3.EDO.BaseFilter.SenderSelector","js!SBIS3.EDO.BaseFilter.ReceiverSelector"],function(){var e=Array.prototype.slice.call(arguments),r=e[0],t={};t["js!SBIS3.EDO.BaseFilter.OverdueSelector"]=e[1],t["js!SBIS3.EDO.BaseFilter.MilestoneSelector"]=e[2],t["js!SBIS3.EDO.BaseFilter.MarksSelector"]=e[3],t["js!SBIS3.EDO.BaseFilter.RegulationSelector"]=e[4],t["js!SBIS3.EDO.BaseFilter.SenderSelector"]=e[5],t["js!SBIS3.EDO.BaseFilter.ReceiverSelector"]=e[6];var o=function e(o,l,i,n,a){function s(){}var c=0,S=void 0!==r&&r?r:arguments[arguments.length-1];void 0===S&&(eval("var thelpers = null;"),S=global.requirejs("View/Runner/tclosure"));var d={};a&&a.isSetts&&(d=a.fullContext||{});var u="string"==typeof i?i:"",p=void 0===t?void 0:t,B={id:[],def:void 0},v=S.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),f=this&&this.includedTemplates?this.includedTemplates:{},m=S.getMarkupGenerator(n);try{var E=m.joinElements([m.createTag("div",{class:"edo-BaseFilter__filterPicker edo-twoColumnSelectors"},[m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.OverdueSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:v},i,p,f,S.config,d),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.MilestoneSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:v},i,p,f,S.config,d),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.MarksSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:v},i,p,f,S.config,d),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.RegulationSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:v},i,p,f,S.config,d),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.SenderSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:v},i,p,f,S.config,d),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ReceiverSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:v},i,p,f,S.config,d)],l,B,this)],u,B);B.def&&(E=m.chain(E,B,l),B=void 0)}catch(e){S.templateError("resources/Elektronnyj_dokumentooborot/Filtry/FilterTasksExecute/FilterTasksExecuteSelector/FilterTasksExecuteSelector.tmpl",e,o)}return E||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FilterTasksExecuteSelector"}},o});
define('js!SBIS3.EDO.FilterTasksExecuteSelector',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FilterTasksExecuteSelector','i18n!SBIS3.EDO.FilterTasksExecute','js!SBIS3.EDO.BaseFilter.Face1Selector','js!SBIS3.EDO.BaseFilter.MilestoneSelector','js!SBIS3.EDO.BaseFilter.RegulationSelector','js!SBIS3.EDO.BaseFilter.MarksSelector','js!SBIS3.EDO.BaseFilter.ProjectSelector','js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleSelector','js!SBIS3.EDO.BaseFilter.SenderSelector','js!SBIS3.EDO.BaseFilter.WorkingAreaSelector','js!SBIS3.EDO.BaseFilter.UnreadSelector','js!SBIS3.EDO.BaseFilter.OverdueSelector','Elektronnyj_dokumentooborot_localization'],function(e,t){var r=e.extend({_dotTplFn:t,$protected:{_options:{}},$constructor:function(){},init:function(){r.superclass.init.call(this);}});return r;});
define("tmpl!SBIS3.EDO.FilterTasksFromMe",["Core/tmpl/js/tclosure","js!SBIS3.EDO.BaseFilter.Period","js!SBIS3.EDO.BaseFilter.ShortState","js!SBIS3.EDO.BaseFilter.LimitationOverdue","js!SBIS3.EDO.BaseFilter.Milestone","js!SBIS3.EDO.BaseFilter.Project","js!SBIS3.EDO.BaseFilter.ListDispatch","js!SBIS3.EDO.BaseFilter.Marks","js!SBIS3.EDO.BaseFilter.Regulation","js!SBIS3.EDO.BaseFilter.Face1","js!SBIS3.EDO.BaseFilter.WorkingArea"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.EDO.BaseFilter.Period"]=e[1],r["js!SBIS3.EDO.BaseFilter.ShortState"]=e[2],r["js!SBIS3.EDO.BaseFilter.LimitationOverdue"]=e[3],r["js!SBIS3.EDO.BaseFilter.Milestone"]=e[4],r["js!SBIS3.EDO.BaseFilter.Project"]=e[5],r["js!SBIS3.EDO.BaseFilter.ListDispatch"]=e[6],r["js!SBIS3.EDO.BaseFilter.Marks"]=e[7],r["js!SBIS3.EDO.BaseFilter.Regulation"]=e[8],r["js!SBIS3.EDO.BaseFilter.Face1"]=e[9],r["js!SBIS3.EDO.BaseFilter.WorkingArea"]=e[10];var o=function e(o,i,a,l,s){function n(){}var c=0,S=void 0!==t&&t?t:arguments[arguments.length-1];void 0===S&&(eval("var thelpers = null;"),S=global.requirejs("View/Runner/tclosure"));var d={};s&&s.isSetts&&(d=s.fullContext||{});var u="string"==typeof a?a:"",B=void 0===r?void 0:r,p={id:[],def:void 0},m=S.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),y=this&&this.includedTemplates?this.includedTemplates:{},f=S.getMarkupGenerator(l);try{var F=f.joinElements([f.createTag("div",{class:"edo-BaseFilter__filterPicker  edo-twoColumnSelectors"},[f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Period",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,B,y,S.config,d),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ShortState",{items:[{key:"-1",title:global.rk("В любом состоянии")},{key:"8",title:global.rk("В обработке")},{key:"1",title:global.rk("Завершенные")},{key:"2",title:global.rk("Завершенные положительно"),listTitle:global.rk("положительно")},{key:"3",title:global.rk("Завершенные отрицательно"),listTitle:global.rk("отрицательно")},{key:"-2",title:global.rk("Удаленные")}],esc:!1},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,B,y,S.config,d),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.LimitationOverdue",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,B,y,S.config,d),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Milestone",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,B,y,S.config,d),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Project",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,B,y,S.config,d),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ListDispatch",{caption:global.rk("Получатель")},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,B,y,S.config,d),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Marks",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,B,y,S.config,d),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Regulation",{multiselect:!0,docTypes:[{docTypeString:"СлужЗап",subDocTypeString:""}]},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,B,y,S.config,d),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Face1",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,B,y,S.config,d),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.WorkingArea",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,B,y,S.config,d)],i,p,this)],u,p);p.def&&(F=f.chain(F,p,i),p=void 0)}catch(e){S.templateError("resources/Elektronnyj_dokumentooborot/Filtry/FilterTasksFromMe/FilterTasksFromMe.tmpl",e,o)}return F||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FilterTasksFromMe"}},o});
define('js!SBIS3.EDO.FilterTasksFromMe',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FilterTasksFromMe','i18n!SBIS3.EDO.FilterTasksFromMe','js!SBIS3.EDO.BaseFilter.Period','js!SBIS3.EDO.BaseFilter.ShortState','js!SBIS3.EDO.BaseFilter.Milestone','js!SBIS3.EDO.BaseFilter.Regulation','js!SBIS3.EDO.BaseFilter.Marks','js!SBIS3.EDO.BaseFilter.Project','js!SBIS3.EDO.BaseFilter.Face1','js!SBIS3.EDO.BaseFilter.ListDispatch','js!SBIS3.EDO.BaseFilter.WorkingArea','js!SBIS3.EDO.BaseFilter.LimitationOverdue','Elektronnyj_dokumentooborot_localization'],function(e,t){var s=e.extend({_dotTplFn:t,$protected:{_options:{}},$constructor:function(){},init:function(){s.superclass.init.call(this);}});return s;});
define("tmpl!SBIS3.EDO.FilterTasksFromMeSelector",["Core/tmpl/js/tclosure","js!SBIS3.EDO.BaseFilter.LimitationOverdueSelector","js!SBIS3.EDO.BaseFilter.MilestoneSelector","js!SBIS3.EDO.BaseFilter.ProjectSelector","js!SBIS3.EDO.BaseFilter.ListDispatchSelector","js!SBIS3.EDO.BaseFilter.MarksSelector","js!SBIS3.EDO.BaseFilter.Face1","js!SBIS3.EDO.BaseFilter.RegulationSelector","js!SBIS3.EDO.BaseFilter.WorkingAreaSelector"],function(){var e=Array.prototype.slice.call(arguments),r=e[0],t={};t["js!SBIS3.EDO.BaseFilter.LimitationOverdueSelector"]=e[1],t["js!SBIS3.EDO.BaseFilter.MilestoneSelector"]=e[2],t["js!SBIS3.EDO.BaseFilter.ProjectSelector"]=e[3],t["js!SBIS3.EDO.BaseFilter.ListDispatchSelector"]=e[4],t["js!SBIS3.EDO.BaseFilter.MarksSelector"]=e[5],t["js!SBIS3.EDO.BaseFilter.Face1"]=e[6],t["js!SBIS3.EDO.BaseFilter.RegulationSelector"]=e[7],t["js!SBIS3.EDO.BaseFilter.WorkingAreaSelector"]=e[8];var o=function e(o,i,l,a,n){function s(){}var c=0,S=void 0!==r&&r?r:arguments[arguments.length-1];void 0===S&&(eval("var thelpers = null;"),S=global.requirejs("View/Runner/tclosure"));var d={};n&&n.isSetts&&(d=n.fullContext||{});var u="string"==typeof l?l:"",p=void 0===t?void 0:t,B={id:[],def:void 0},m=S.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),F=this&&this.includedTemplates?this.includedTemplates:{},f=S.getMarkupGenerator(a);try{var v=f.joinElements([f.createTag("div",{class:"edo-BaseFilter__filterPicker edo-twoColumnSelectors"},[f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.LimitationOverdueSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},l,p,F,S.config,d),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.MilestoneSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},l,p,F,S.config,d),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ProjectSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},l,p,F,S.config,d),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ListDispatchSelector",{caption:global.rk("Получателя")},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},l,p,F,S.config,d),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.MarksSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},l,p,F,S.config,d),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Face1",{caption:global.rk("Контрагента")},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},l,p,F,S.config,d),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.RegulationSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},l,p,F,S.config,d),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.WorkingAreaSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},l,p,F,S.config,d)],i,B,this)],u,B);B.def&&(v=f.chain(v,B,i),B=void 0)}catch(e){S.templateError("resources/Elektronnyj_dokumentooborot/Filtry/FilterTasksFromMe/FilterTasksFromMeSelector/FilterTasksFromMeSelector.tmpl",e,o)}return v||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FilterTasksFromMeSelector"}},o});
define('js!SBIS3.EDO.FilterTasksFromMeSelector',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FilterTasksFromMeSelector','i18n!SBIS3.EDO.FilterTasksFromMe','js!SBIS3.EDO.BaseFilter.MilestoneSelector','js!SBIS3.EDO.BaseFilter.RegulationSelector','js!SBIS3.EDO.BaseFilter.ListDispatchSelector','js!SBIS3.EDO.BaseFilter.MarksSelector','js!SBIS3.EDO.BaseFilter.Face1Selector','js!SBIS3.EDO.BaseFilter.ProjectSelector','js!SBIS3.EDO.BaseFilter.WorkingAreaSelector','js!SBIS3.EDO.BaseFilter.LimitationOverdueSelector','Elektronnyj_dokumentooborot_localization'],function(e,t){var r=e.extend({_dotTplFn:t,$protected:{_options:{}},$constructor:function(){},init:function(){r.superclass.init.call(this);}});return r;});
define("tmpl!SBIS3.EDO.FilterTasksMine",["Core/tmpl/js/tclosure","js!SBIS3.EDO.BaseFilter.Period","js!SBIS3.EDO.BaseFilter.LimitationOverdue","js!SBIS3.EDO.BaseFilter.Milestone","js!SBIS3.EDO.BaseFilter.Project","js!SBIS3.EDO.BaseFilter.Face1","js!SBIS3.EDO.BaseFilter.Marks","js!SBIS3.EDO.BaseFilter.Regulation","js!SBIS3.EDO.BaseFilter.AuthorOrResponsible","js!SBIS3.EDO.BaseFilter.Sender","js!SBIS3.EDO.BaseFilter.WorkingArea","js!SBIS3.EDO.BaseFilter.Unread"],function(){var e=Array.prototype.slice.call(arguments),r=e[0],t={};t["js!SBIS3.EDO.BaseFilter.Period"]=e[1],t["js!SBIS3.EDO.BaseFilter.LimitationOverdue"]=e[2],t["js!SBIS3.EDO.BaseFilter.Milestone"]=e[3],t["js!SBIS3.EDO.BaseFilter.Project"]=e[4],t["js!SBIS3.EDO.BaseFilter.Face1"]=e[5],t["js!SBIS3.EDO.BaseFilter.Marks"]=e[6],t["js!SBIS3.EDO.BaseFilter.Regulation"]=e[7],t["js!SBIS3.EDO.BaseFilter.AuthorOrResponsible"]=e[8],t["js!SBIS3.EDO.BaseFilter.Sender"]=e[9],t["js!SBIS3.EDO.BaseFilter.WorkingArea"]=e[10],t["js!SBIS3.EDO.BaseFilter.Unread"]=e[11];var o=function e(o,i,n,a,s){function l(){}var c=0,d=void 0!==r&&r?r:arguments[arguments.length-1];void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure"));var S={};s&&s.isSetts&&(S=s.fullContext||{});var u="string"==typeof n?n:"",B=void 0===t?void 0:t,p={id:[],def:void 0},m=d.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),f=this&&this.includedTemplates?this.includedTemplates:{},F=d.getMarkupGenerator(a);try{var v=F.joinElements([F.createTag("div",{class:"edo-BaseFilter__filterPicker  edo-twoColumnSelectors"},[F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Period",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},n,B,f,d.config,S),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.LimitationOverdue",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},n,B,f,d.config,S),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Milestone",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},n,B,f,d.config,S),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Project",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},n,B,f,d.config,S),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Face1",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},n,B,f,d.config,S),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Marks",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},n,B,f,d.config,S),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Regulation",{multiselect:!0},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},n,B,f,d.config,S),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.AuthorOrResponsible",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},n,B,f,d.config,S),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Sender",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},n,B,f,d.config,S),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.WorkingArea",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},n,B,f,d.config,S),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Unread",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},n,B,f,d.config,S)],i,p,this)],u,p);p.def&&(v=F.chain(v,p,i),p=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/Filtry/FilterTasksMine/FilterTasksMine.tmpl",e,o)}return v||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FilterTasksMine"}},o});
define('js!SBIS3.EDO.FilterTasksMine',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FilterTasksMine','i18n!SBIS3.EDO.FilterTasksMine','js!SBIS3.EDO.BaseFilter.Period','js!SBIS3.EDO.BaseFilter.Milestone','js!SBIS3.EDO.BaseFilter.Regulation','js!SBIS3.EDO.BaseFilter.Marks','js!SBIS3.EDO.BaseFilter.Project','js!SBIS3.EDO.BaseFilter.Face1','js!SBIS3.EDO.BaseFilter.AuthorOrResponsible','js!SBIS3.EDO.BaseFilter.Sender','js!SBIS3.EDO.BaseFilter.WorkingArea','js!SBIS3.EDO.BaseFilter.Unread','js!SBIS3.EDO.BaseFilter.LimitationOverdue','Elektronnyj_dokumentooborot_localization'],function(e,s){var i=e.extend({_dotTplFn:s,$protected:{_options:{}},$constructor:function(){},init:function(){i.superclass.init.call(this);}});return i;});
define("tmpl!SBIS3.EDO.FilterTasksMineSelector",["Core/tmpl/js/tclosure","js!SBIS3.EDO.BaseFilter.LimitationOverdueSelector","js!SBIS3.EDO.BaseFilter.MilestoneSelector","js!SBIS3.EDO.BaseFilter.ProjectSelector","js!SBIS3.EDO.BaseFilter.MarksSelector","js!SBIS3.EDO.BaseFilter.Face1","js!SBIS3.EDO.BaseFilter.RegulationSelector","js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleSelector","js!SBIS3.EDO.BaseFilter.SenderSelector","js!SBIS3.EDO.BaseFilter.WorkingAreaSelector","js!SBIS3.EDO.BaseFilter.UnreadSelector"],function(){var e=Array.prototype.slice.call(arguments),r=e[0],t={};t["js!SBIS3.EDO.BaseFilter.LimitationOverdueSelector"]=e[1],t["js!SBIS3.EDO.BaseFilter.MilestoneSelector"]=e[2],t["js!SBIS3.EDO.BaseFilter.ProjectSelector"]=e[3],t["js!SBIS3.EDO.BaseFilter.MarksSelector"]=e[4],t["js!SBIS3.EDO.BaseFilter.Face1"]=e[5],t["js!SBIS3.EDO.BaseFilter.RegulationSelector"]=e[6],t["js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleSelector"]=e[7],t["js!SBIS3.EDO.BaseFilter.SenderSelector"]=e[8],t["js!SBIS3.EDO.BaseFilter.WorkingAreaSelector"]=e[9],t["js!SBIS3.EDO.BaseFilter.UnreadSelector"]=e[10];var o=function e(o,l,i,n,a){function s(){}var c=0,S=void 0!==r&&r?r:arguments[arguments.length-1];void 0===S&&(eval("var thelpers = null;"),S=global.requirejs("View/Runner/tclosure"));var d={};a&&a.isSetts&&(d=a.fullContext||{});var u="string"==typeof i?i:"",B=void 0===t?void 0:t,p={id:[],def:void 0},m=S.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),f=this&&this.includedTemplates?this.includedTemplates:{},F=S.getMarkupGenerator(n);try{var v=F.joinElements([F.createTag("div",{class:"edo-BaseFilter__filterPicker edo-twoColumnSelectors"},[F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.LimitationOverdueSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},i,B,f,S.config,d),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.MilestoneSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},i,B,f,S.config,d),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ProjectSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},i,B,f,S.config,d),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.MarksSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},i,B,f,S.config,d),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Face1",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},i,B,f,S.config,d),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.RegulationSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},i,B,f,S.config,d),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.AuthorOrResponsibleSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},i,B,f,S.config,d),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.SenderSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},i,B,f,S.config,d),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.WorkingAreaSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},i,B,f,S.config,d),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.UnreadSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},i,B,f,S.config,d)],l,p,this)],u,p);p.def&&(v=F.chain(v,p,l),p=void 0)}catch(e){S.templateError("resources/Elektronnyj_dokumentooborot/Filtry/FilterTasksMine/FilterTasksMineSelector/FilterTasksMineSelector.tmpl",e,o)}return v||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FilterTasksMineSelector"}},o});
define('js!SBIS3.EDO.FilterTasksMineSelector',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FilterTasksMineSelector','i18n!SBIS3.EDO.FilterTasksMine','js!SBIS3.EDO.BaseFilter.MilestoneSelector','js!SBIS3.EDO.BaseFilter.RegulationSelector','js!SBIS3.EDO.BaseFilter.MarksSelector','js!SBIS3.EDO.BaseFilter.Face1Selector','js!SBIS3.EDO.BaseFilter.ProjectSelector','js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleSelector','js!SBIS3.EDO.BaseFilter.SenderSelector','js!SBIS3.EDO.BaseFilter.WorkingAreaSelector','js!SBIS3.EDO.BaseFilter.UnreadSelector','js!SBIS3.EDO.BaseFilter.LimitationOverdueSelector','Elektronnyj_dokumentooborot_localization'],function(e,t){var r=e.extend({_dotTplFn:t,$protected:{_options:{}},$constructor:function(){},init:function(){r.superclass.init.call(this);}});return r;});
define("tmpl!SBIS3.EDO.FilterTasksReturn",["Core/tmpl/js/tclosure","js!SBIS3.EDO.BaseFilter.Period","js!SBIS3.EDO.BaseFilter.LimitationOverdue","js!SBIS3.EDO.BaseFilter.Marks","js!SBIS3.EDO.BaseFilter.Regulation","js!SBIS3.EDO.BaseFilter.Face1","js!SBIS3.EDO.BaseFilter.Sender","js!SBIS3.EDO.BaseFilter.ListDispatch","js!SBIS3.EDO.BaseFilter.Unread"],function(){var e=Array.prototype.slice.call(arguments),r=e[0],t={};t["js!SBIS3.EDO.BaseFilter.Period"]=e[1],t["js!SBIS3.EDO.BaseFilter.LimitationOverdue"]=e[2],t["js!SBIS3.EDO.BaseFilter.Marks"]=e[3],t["js!SBIS3.EDO.BaseFilter.Regulation"]=e[4],t["js!SBIS3.EDO.BaseFilter.Face1"]=e[5],t["js!SBIS3.EDO.BaseFilter.Sender"]=e[6],t["js!SBIS3.EDO.BaseFilter.ListDispatch"]=e[7],t["js!SBIS3.EDO.BaseFilter.Unread"]=e[8];var o=function e(o,i,a,n,s){function l(){}var c=0,d=void 0!==r&&r?r:arguments[arguments.length-1];void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure"));var u={};s&&s.isSetts&&(u=s.fullContext||{});var S="string"==typeof a?a:"",B=void 0===t?void 0:t,p={id:[],def:void 0},m=d.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),f=this&&this.includedTemplates?this.includedTemplates:{},v=d.getMarkupGenerator(n);try{var F=v.joinElements([v.createTag("div",{class:"edo-BaseFilter__filterPicker"},[v.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Period",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,B,f,d.config,u),v.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.LimitationOverdue",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,B,f,d.config,u),v.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Marks",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,B,f,d.config,u),v.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Regulation",{multiselect:!0},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,B,f,d.config,u),v.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Face1",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,B,f,d.config,u),v.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Sender",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,B,f,d.config,u),v.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ListDispatch",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,B,f,d.config,u),v.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Unread",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,B,f,d.config,u)],i,p,this)],S,p);p.def&&(F=v.chain(F,p,i),p=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/Filtry/FilterTasksReturn/FilterTasksReturn.tmpl",e,o)}return F||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FilterTasksReturn"}},o});
define('js!SBIS3.EDO.FilterTasksReturn',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FilterTasksReturn','i18n!SBIS3.EDO.FilterTasksReturn','js!SBIS3.EDO.BaseFilter.Period','js!SBIS3.EDO.BaseFilter.Face1','js!SBIS3.EDO.BaseFilter.Regulation','js!SBIS3.EDO.BaseFilter.ListDispatch','js!SBIS3.EDO.BaseFilter.Marks','js!SBIS3.EDO.BaseFilter.Sender','js!SBIS3.EDO.BaseFilter.Unread','js!SBIS3.EDO.BaseFilter.LimitationOverdue','Elektronnyj_dokumentooborot_localization'],function(e,t){var s=e.extend({_dotTplFn:t,$protected:{_options:{}},$constructor:function(){},init:function(){s.superclass.init.call(this);}});return s;});
define("tmpl!SBIS3.EDO.FilterTasksReturnSelector",["Core/tmpl/js/tclosure","js!SBIS3.EDO.BaseFilter.LimitationOverdueSelector","js!SBIS3.EDO.BaseFilter.MarksSelector","js!SBIS3.EDO.BaseFilter.RegulationSelector","js!SBIS3.EDO.BaseFilter.Face1Selector","js!SBIS3.EDO.BaseFilter.SenderSelector","js!SBIS3.EDO.BaseFilter.ListDispatchSelector","js!SBIS3.EDO.BaseFilter.UnreadSelector"],function(){var e=Array.prototype.slice.call(arguments),r=e[0],t={};t["js!SBIS3.EDO.BaseFilter.LimitationOverdueSelector"]=e[1],t["js!SBIS3.EDO.BaseFilter.MarksSelector"]=e[2],t["js!SBIS3.EDO.BaseFilter.RegulationSelector"]=e[3],t["js!SBIS3.EDO.BaseFilter.Face1Selector"]=e[4],t["js!SBIS3.EDO.BaseFilter.SenderSelector"]=e[5],t["js!SBIS3.EDO.BaseFilter.ListDispatchSelector"]=e[6],t["js!SBIS3.EDO.BaseFilter.UnreadSelector"]=e[7];var o=function e(o,l,i,a,n){function s(){}var c=0,S=void 0!==r&&r?r:arguments[arguments.length-1];void 0===S&&(eval("var thelpers = null;"),S=global.requirejs("View/Runner/tclosure"));var d={};n&&n.isSetts&&(d=n.fullContext||{});var u="string"==typeof i?i:"",p=void 0===t?void 0:t,B={id:[],def:void 0},m=S.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),f=this&&this.includedTemplates?this.includedTemplates:{},v=S.getMarkupGenerator(a);try{var F=v.joinElements([v.createTag("div",{class:"edo-BaseFilter__filterPicker edo-twoColumnSelectors"},[v.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.LimitationOverdueSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},i,p,f,S.config,d),v.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.MarksSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},i,p,f,S.config,d),v.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.RegulationSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},i,p,f,S.config,d),v.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Face1Selector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},i,p,f,S.config,d),v.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.SenderSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},i,p,f,S.config,d),v.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ListDispatchSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},i,p,f,S.config,d),v.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.UnreadSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},i,p,f,S.config,d)],l,B,this)],u,B);B.def&&(F=v.chain(F,B,l),B=void 0)}catch(e){S.templateError("resources/Elektronnyj_dokumentooborot/Filtry/FilterTasksReturn/FilterTasksReturnSelector/FilterTasksReturnSelector.tmpl",e,o)}return F||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FilterTasksReturnSelector"}},o});
define('js!SBIS3.EDO.FilterTasksReturnSelector',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FilterTasksReturnSelector','i18n!SBIS3.EDO.FilterTasksReturn','js!SBIS3.EDO.BaseFilter.Face1Selector','js!SBIS3.EDO.BaseFilter.RegulationSelector','js!SBIS3.EDO.BaseFilter.MarksSelector','js!SBIS3.EDO.BaseFilter.SenderSelector','js!SBIS3.EDO.BaseFilter.ListDispatchSelector','js!SBIS3.EDO.BaseFilter.UnreadSelector','js!SBIS3.EDO.BaseFilter.LimitationOverdueSelector','Elektronnyj_dokumentooborot_localization'],function(e,t){var r=e.extend({_dotTplFn:t,$protected:{_options:{}},$constructor:function(){},init:function(){r.superclass.init.call(this);}});return r;});
define("tmpl!SBIS3.EDO.FilterTasksUnallocated/FilterTasksUnallocated",["Core/tmpl/js/tclosure","js!SBIS3.EDO.BaseFilter.Period","js!SBIS3.EDO.BaseFilter.LimitationOverdue","js!SBIS3.EDO.BaseFilter.Regulation","js!SBIS3.EDO.BaseFilter.Marks","js!SBIS3.EDO.BaseFilter.Sender","js!SBIS3.EDO.BaseFilter.Face1","js!SBIS3.EDO.BaseFilter.AuthorOrResponsible","js!SBIS3.EDO.BaseFilter.Milestone","js!SBIS3.EDO.BaseFilter.WorkingArea"],function(){var e=Array.prototype.slice.call(arguments),r=e[0],t={};t["js!SBIS3.EDO.BaseFilter.Period"]=e[1],t["js!SBIS3.EDO.BaseFilter.LimitationOverdue"]=e[2],t["js!SBIS3.EDO.BaseFilter.Regulation"]=e[3],t["js!SBIS3.EDO.BaseFilter.Marks"]=e[4],t["js!SBIS3.EDO.BaseFilter.Sender"]=e[5],t["js!SBIS3.EDO.BaseFilter.Face1"]=e[6],t["js!SBIS3.EDO.BaseFilter.AuthorOrResponsible"]=e[7],t["js!SBIS3.EDO.BaseFilter.Milestone"]=e[8],t["js!SBIS3.EDO.BaseFilter.WorkingArea"]=e[9];var o=function e(o,a,i,n,l){function s(){}var c=0,d=void 0!==r&&r?r:arguments[arguments.length-1];void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure"));var u={};l&&l.isSetts&&(u=l.fullContext||{});var S="string"==typeof i?i:"",B=void 0===t?void 0:t,p={id:[],def:void 0},m=d.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),f=this&&this.includedTemplates?this.includedTemplates:{},F=d.getMarkupGenerator(n);try{var v=F.joinElements([F.createTag("div",{class:"edo-BaseFilter__filterPicker  edo-twoColumnSelectors"},[F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Period",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},i,B,f,d.config,u),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.LimitationOverdue",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},i,B,f,d.config,u),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Regulation",{multiselect:!0,phaseMultiselect:!0},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},i,B,f,d.config,u),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Marks",{multiDocsReestr:!0},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},i,B,f,d.config,u),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Sender",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},i,B,f,d.config,u),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Face1",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},i,B,f,d.config,u),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.AuthorOrResponsible",{showCustom:!0},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},i,B,f,d.config,u),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Milestone",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},i,B,f,d.config,u),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.WorkingArea",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},i,B,f,d.config,u)],a,p,this)],S,p);p.def&&(v=F.chain(v,p,a),p=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/Filtry/FilterTasksUnallocated/FilterTasksUnallocated.tmpl",e,o)}return v||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FilterTasksUnallocated/FilterTasksUnallocated"}},o});
define('js!SBIS3.EDO.FilterTasksUnallocated',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FilterTasksUnallocated/FilterTasksUnallocated','js!SBIS3.EDO.BaseFilter.LimitationOverdue','js!SBIS3.EDO.BaseFilter.Regulation','js!SBIS3.EDO.BaseFilter.Marks','js!SBIS3.EDO.BaseFilter.Sender','js!SBIS3.EDO.BaseFilter.Face1','js!SBIS3.EDO.BaseFilter.AuthorOrResponsible','js!SBIS3.EDO.BaseFilter.Milestone','js!SBIS3.EDO.BaseFilter.WorkingArea','Elektronnyj_dokumentooborot_localization'],function(e,t){var s=e.extend({_dotTplFn:t,$protected:{_options:{autoHeight:true,autoWidth:true}},$constructor:function(){},init:function(){s.superclass.init.call(this);}});return s;});
define("tmpl!SBIS3.EDO.FilterTasksUnallocatedSelector/FilterTasksUnallocatedSelector",["Core/tmpl/js/tclosure","js!SBIS3.EDO.BaseFilter.LimitationOverdueSelector","js!SBIS3.EDO.BaseFilter.RegulationSelector","js!SBIS3.EDO.BaseFilter.MarksSelector","js!SBIS3.EDO.BaseFilter.Face1Selector","js!SBIS3.EDO.BaseFilter.SenderSelector","js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleSelector","js!SBIS3.EDO.BaseFilter.MilestoneSelector","js!SBIS3.EDO.BaseFilter.WorkingAreaSelector"],function(){var e=Array.prototype.slice.call(arguments),r=e[0],t={};t["js!SBIS3.EDO.BaseFilter.LimitationOverdueSelector"]=e[1],t["js!SBIS3.EDO.BaseFilter.RegulationSelector"]=e[2],t["js!SBIS3.EDO.BaseFilter.MarksSelector"]=e[3],t["js!SBIS3.EDO.BaseFilter.Face1Selector"]=e[4],t["js!SBIS3.EDO.BaseFilter.SenderSelector"]=e[5],t["js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleSelector"]=e[6],t["js!SBIS3.EDO.BaseFilter.MilestoneSelector"]=e[7],t["js!SBIS3.EDO.BaseFilter.WorkingAreaSelector"]=e[8];var o=function e(o,l,a,i,n){function s(){}var c=0,S=void 0!==r&&r?r:arguments[arguments.length-1];void 0===S&&(eval("var thelpers = null;"),S=global.requirejs("View/Runner/tclosure"));var d={};n&&n.isSetts&&(d=n.fullContext||{});var u="string"==typeof a?a:"",B=void 0===t?void 0:t,p={id:[],def:void 0},m=S.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),f=this&&this.includedTemplates?this.includedTemplates:{},F=S.getMarkupGenerator(i);try{var v=F.joinElements([F.createTag("div",{class:"edo-BaseFilter__filterPicker edo-twoColumnSelectors"},[F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.LimitationOverdueSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,B,f,S.config,d),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.RegulationSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,B,f,S.config,d),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.MarksSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,B,f,S.config,d),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Face1Selector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,B,f,S.config,d),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.SenderSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,B,f,S.config,d),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.AuthorOrResponsibleSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,B,f,S.config,d),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.MilestoneSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,B,f,S.config,d),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.WorkingAreaSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,B,f,S.config,d)],l,p,this)],u,p);p.def&&(v=F.chain(v,p,l),p=void 0)}catch(e){S.templateError("resources/Elektronnyj_dokumentooborot/Filtry/FilterTasksUnallocated/FilterTasksUnallocatedSelector/FilterTasksUnallocatedSelector.tmpl",e,o)}return v||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FilterTasksUnallocatedSelector/FilterTasksUnallocatedSelector"}},o});
define('js!SBIS3.EDO.FilterTasksUnallocatedSelector',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FilterTasksUnallocatedSelector/FilterTasksUnallocatedSelector','i18n!SBIS3.EDO.FilterTasksUnallocatedSelector','js!SBIS3.EDO.BaseFilter.LimitationOverdueSelector','js!SBIS3.EDO.BaseFilter.RegulationSelector','js!SBIS3.EDO.BaseFilter.Face1Selector','js!SBIS3.EDO.BaseFilter.MarksSelector','js!SBIS3.EDO.BaseFilter.SenderSelector','js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleSelector','js!SBIS3.EDO.BaseFilter.MilestoneSelector','js!SBIS3.EDO.BaseFilter.WorkingAreaSelector','Elektronnyj_dokumentooborot_localization'],function(e,t){var l=e.extend({_dotTplFn:t,$protected:{_options:{}},$constructor:function(){},init:function(){l.superclass.init.call(this);}});return l;});
define("tmpl!SBIS3.EDO.UnallocatedFilterNew",["Core/tmpl/js/tclosure","js!SBIS3.EDO.BaseFilter.Period","js!SBIS3.EDO.BaseFilter.AuthorOrResponsible","js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleMe","js!SBIS3.EDO.BaseFilter.Deleted","js!SBIS3.EDO.BaseFilter.Registered"],function(){var e=Array.prototype.slice.call(arguments),r=e[0],t={};t["js!SBIS3.EDO.BaseFilter.Period"]=e[1],t["js!SBIS3.EDO.BaseFilter.AuthorOrResponsible"]=e[2],t["js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleMe"]=e[3],t["js!SBIS3.EDO.BaseFilter.Deleted"]=e[4],t["js!SBIS3.EDO.BaseFilter.Registered"]=e[5];var o=function e(o,i,l,n,a){function s(){}var d=0,c=void 0!==r&&r?r:arguments[arguments.length-1];void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure"));var u={};a&&a.isSetts&&(u=a.fullContext||{});var p="string"==typeof l?l:"",S=void 0===t?void 0:t,B={id:[],def:void 0},f=c.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),m=this&&this.includedTemplates?this.includedTemplates:{},v=c.getMarkupGenerator(n);try{var y=v.joinElements([v.createTag("div",{class:"edo-BaseFilter__filterPicker"},[v.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Period",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},l,S,m,c.config,u),v.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.AuthorOrResponsible",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},l,S,m,c.config,u),v.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.AuthorOrResponsibleMe",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},l,S,m,c.config,u),v.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Deleted",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},l,S,m,c.config,u),v.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Registered",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},l,S,m,c.config,u)],i,B,this)],p,B);B.def&&(y=v.chain(y,B,i),B=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/Filtry/UnallocatedFilterNew/UnallocatedFilterNew.tmpl",e,o)}return y||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.UnallocatedFilterNew"}},o});
define('js!SBIS3.EDO.UnallocatedFilterNew',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.UnallocatedFilterNew','js!SBIS3.EDO.BaseFilter.Period','js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleMe','js!SBIS3.EDO.BaseFilter.AuthorOrResponsible','js!SBIS3.EDO.BaseFilter.Deleted','js!SBIS3.EDO.BaseFilter.Registered','Elektronnyj_dokumentooborot_localization'],function(e,t){var i=e.extend({_dotTplFn:t,$protected:{_options:{autoHeight:true,autoWidth:true}},$constructor:function(){},init:function(){i.superclass.init.call(this);}});return i;});
define("tmpl!SBIS3.EDO.UnallocatedFilterNewSelector",["Core/tmpl/js/tclosure","js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleSelector","js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleMeSelector","js!SBIS3.EDO.BaseFilter.DeletedSelector","js!SBIS3.EDO.BaseFilter.RegisteredSelector"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleSelector"]=e[1],r["js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleMeSelector"]=e[2],r["js!SBIS3.EDO.BaseFilter.DeletedSelector"]=e[3],r["js!SBIS3.EDO.BaseFilter.RegisteredSelector"]=e[4];var o=function e(o,l,i,n,a){function s(){}var c=0,d=void 0!==t&&t?t:arguments[arguments.length-1];void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure"));var S={};a&&a.isSetts&&(S=a.fullContext||{});var u="string"==typeof i?i:"",p=void 0===r?void 0:r,B={id:[],def:void 0},f=d.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),m=this&&this.includedTemplates?this.includedTemplates:{},v=d.getMarkupGenerator(n);try{var y=v.joinElements([v.createTag("div",{class:"edo-BaseFilter__filterPicker  edo-twoColumnSelectors"},[v.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.AuthorOrResponsibleSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},i,p,m,d.config,S),v.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.AuthorOrResponsibleMeSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},i,p,m,d.config,S),v.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.DeletedSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},i,p,m,d.config,S),v.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.RegisteredSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},i,p,m,d.config,S)],l,B,this)],u,B);B.def&&(y=v.chain(y,B,l),B=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/Filtry/UnallocatedFilterNew/UnallocatedFilterNewSelector/UnallocatedFilterNewSelector.tmpl",e,o)}return y||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.UnallocatedFilterNewSelector"}},o});
define('js!SBIS3.EDO.UnallocatedFilterNewSelector',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.UnallocatedFilterNewSelector','js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleMeSelector','js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleSelector','js!SBIS3.EDO.BaseFilter.DeletedSelector','js!SBIS3.EDO.BaseFilter.RegisteredSelector','Elektronnyj_dokumentooborot_localization'],function(e,t){var o=e.extend({_dotTplFn:t,$protected:{_options:{autoHeight:true,autoWidth:true}},$constructor:function(){},init:function(){o.superclass.init.call(this);}});return o;});
define('js!SBIS3.EDO.doc_filters',['Lib/Control/Control','Core/core-instance','Elektronnyj_dokumentooborot_localization'],function(e,t){var o;return o={setDocBookmark:function(t){if(e.ControlStorage.containsByName('ПанельОпераций'))e.ControlStorage.getByName('ПанельОпераций').show();if(e.ControlStorage.containsByName('ОбластьКоманд'))e.ControlStorage.getByName('ОбластьКоманд').show();var a=e.ControlStorage.containsByName('ШаблонСтатистики')?e.ControlStorage.getByName('ШаблонСтатистики'):null,r=e.ControlStorage.containsByName('ОбластьКомандСКнопкой')?e.ControlStorage.getByName('ОбластьКомандСКнопкой'):null;if(a&&r)var n=a.getLinkedContext().getValue('ИсходныйШаблонОбластиКоманд');if(r)r.show();if('tabs_select_link_ot_contr'===t)r.hide();if(e.ControlStorage.containsByName('ЗакладкиЭДО'))e.ControlStorage.getByName('ЗакладкиЭДО').setCurrentTab('ОткрытьЗакладкуДокументы');if(e.ControlStorage.containsByName('ЗакладкиМойКабинет'))e.ControlStorage.getByName('ЗакладкиМойКабинет').setCurrentTab('ОткрытьЗакладкуДокументы');if(e.ControlStorage.containsByName('ЗакладкиЭДОИсх')&&'tabs_select_link_ot_contr'!==t)e.ControlStorage.getByName('ЗакладкиЭДОИсх').setCurrentTab('ОткрытьЗакладкуДокументы');if(e.ControlStorage.containsByName('ЗакладкиРабочегоСтола'))e.ControlStorage.getByName('ЗакладкиРабочегоСтола').setCurrentTab('Документы');else{var l=o.getCurrentBrowser();if(l&&l.getName().indexOf('Рекламации')>=0){reloadFlag=false;var i=e.ControlStorage.getByName('ШаблонБраузеров').getLinkedContext();if(ctxStat.getValue('ДатаНач')!=list_filter['ДатаНач'])i.setValue('ДатаНач',ctxStat.getValue('ДатаНач')),reloadFlag=true;if(ctxStat.getValue('ДатаКнц')!=list_filter['ДатаКнц'])i.setValue('ДатаКнц',ctxStat.getValue('ДатаКнц')),reloadFlag=true;if(ctxStat.getValue('Отбираются')!=list_filter['Отбираются'])i.setValue('Отбираются',ctxStat.getValue('Отбираются')),reloadFlag=true;if(reloadFlag)l.reload();}if(e.ControlStorage.containsByName('ШаблонБраузеров'))e.ControlStorage.getByName('ШаблонБраузеров').show();if(e.ControlStorage.containsByName('ШаблонСтатистики'))e.ControlStorage.getByName('ШаблонСтатистики').hide();if(e.ControlStorage.containsByName('ОбластьДляВставкиДокументовОтдела'))e.ControlStorage.getByName('ОбластьДляВставкиДокументовОтдела').hide();}if(o.clearEDOTabsClass(),!t)$('.tabs_select_link_doc').addClass('tabs_selected_link');else $('.'+t).addClass('tabs_selected_link');if($('.searchInput').css({display:'block'}),$('.searchButton').css({display:'block'}),e.ControlStorage.containsByName('ФильтрДокументовПоМаске'))if(null!==o.getCurrentBrowser()&&!o.getCurrentBrowser().getQuery()['ФильтрПоМаске'])if(e.ControlStorage.getByName('ФильтрДокументовПоМаске').setValue(''),e.ControlStorage.containsByName('ОчиститьФильтрПоМаске'))e.ControlStorage.getByName('ОчиститьФильтрПоМаске').hide();if(-1!==window.location.toString().indexOf('mydoc.html'))o.hideComponentsForMyDoc(false);var s=$('[name = "tab-buttons"]'),g=s.length?s:$('div#content');if(0!==g.length)g.find('div#stat_print_button').remove(),g.find('div#stat_save_button').remove();},clearEDOTabsClass:function(){$('.tabs_select_link_st').removeClass('tabs_selected_link'),$('.tabs_select_link_doc').removeClass('tabs_selected_link'),$('.tabs_select_link_ot').removeClass('tabs_selected_link'),$('.tabs_select_link_ot_contr').removeClass('tabs_selected_link');},generateBrowserFilterParameterName:function(e,t){var o;if(null!==e&&void 0!==e)if(o='ФильтрБраузера_\''+e+'\'',null!==t&&void 0!==t)o+='_ТД'+t;return o;},createMenuOfReglaments:function(e){},filterSerialize:function(e){var t;if(t=o.serialize(e),null!==t&&0!==t.indexOf('('))t='('+t+')';return t;},serialize:function(e){if(void 0===e)return'';switch(typeof e){case'number':case'boolean':case'function':return e;case'string':return'\''+e+'\'';case'object':var t;if(e.constructor===Array||'undefined'!==typeof e.callee){t='[';var a,r=e.length;for(a=0;a<r-1;a++)t+=o.serialize(e[a])+',';t+=o.serialize(e[a])+']';}else{t='{';var n;for(n in e){if(void 0===e[n])continue;t+=n+':'+(null===e[n]?'null':o.serialize(e[n]))+',';}t=t.replace(/\,$/,'')+'}';}return t;default:return'UNKNOWN';}},makeFilterPure:function(e){var t={};if(e)var o=e['Регламент'];for(var a in e)if(0===a.indexOf('Фильтр')&&-1===a.indexOf('.')){var r=typeof e[a];if('string'==r){if(null!==e[a]&&''!==e[a])t[a]=e[a];}else if('object'==r){if(null!==e[a]&&void 0!==e[a]||'ФильтрДатаС'===a||'ФильтрДатаП'===a)if(e[a]instanceof Date)t[a]=e[a].strftime('%e.%m.%Y').trim();else t[a]=e[a];}else t[a]=e[a];}if(o)t['Регламент']=o;if(false===t['ФильтрВОбработке'])delete t['ФильтрВОбработке'];if(!!t['ФильтрПоМаске'])delete t['ФильтрПоМаске'];if(!!t['ФильтрИзСписка'])delete t['ФильтрИзСписка'];if(!!t['ФильтрОтветыКонтрагентов'])delete t['ФильтрОтветыКонтрагентов'];return t;},getDefaultFilterForBrowser:function(e){return{};},getCurrentBrowser:function(){if(e.ControlStorage.containsByName('ОбластьРеестра'))for(var o=e.ControlStorage.getByName('ОбластьРеестра').getChildControls(),a=0;a<o.length;a++)if(t.instanceOfModule(o[a],'Deprecated/Controls/TableView/TableView'))return o[a];var r='';if(e.ControlStorage.containsByName('EDORegistry'))return e.ControlStorage.getByName(e.ControlStorage.getByName('EDORegistry').getBrowserName());if(e.ControlStorage.containsByName('ШаблонБраузеров'))r='ШаблонБраузеров';if(e.ControlStorage.containsByName('ШаблонБраузеровПредприятия'))r='ШаблонБраузеровПредприятия';if(e.ControlStorage.containsByName('Шаблон денег'))r='Шаблон денег';if(0===r.length){if(e.ControlStorage.containsByName('Рабочая область персонала'))r='Рабочая область персонала';if(0===r.length)return null;}var n=e.ControlStorage.getByName(r).getCurrentTemplateName();if(null!==n&&void 0!==n&&'ПустойШаблон'!=n&&''!==n)if(n='Реестр поощрений и взысканий'!==n?n:'ПоощренияИВзысканияРеестр',n='Банк'!==n?n:'РеестрИтогиПоДням',n='Касса'!==n?n:'ПриходРасходОрдера',n='Заявки на оплату'!==n?n:'Реестр заявок на оплату',n='АктыИнвентаризацииОсновное'!==n?n:'АктыИнвентаризации',e.ControlStorage.containsByName(n))return e.ControlStorage.getByName(n);else return null;return null;},hideComponentsForMyDoc:function(t){if(t){if(e.ControlStorage.containsByName('ФильтрДокументовПоМаске'))e.ControlStorage.getByName('ФильтрДокументовПоМаске').getContainer().hide();if(e.ControlStorage.containsByName('НайтиДокумент'))e.ControlStorage.getByName('НайтиДокумент').getContainer().hide();if(e.ControlStorage.containsByName('ОчиститьФильтрПоМаске'))e.ControlStorage.getByName('ОчиститьФильтрПоМаске').getContainer().hide();$('.ramka').hide();}else{if(e.ControlStorage.containsByName('ФильтрДокументовПоМаске'))e.ControlStorage.getByName('ФильтрДокументовПоМаске').getContainer().show();if(e.ControlStorage.containsByName('НайтиДокумент'))e.ControlStorage.getByName('НайтиДокумент').getContainer().show();if(e.ControlStorage.containsByName('ПанельСФильтром'))e.ControlStorage.getByName('ПанельСФильтром').getContainer().show();$('.ramka').show();}}};});
define("html!SBIS3.EDO.DetalizationEvents",function(){var o=function(o){var t=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;o.test(t);)t=t.replace(o,"&#123;&#123;$1&#125;&#125;");return t}}(),n=function(o){return o.join?o.join(""):o.toString()},e=function(o){return void 0===o?"":o&&"object"==typeof o?n(o):""+o},i="undefined"!=typeof process,a=("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),p=function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,s='<div style="width:790px;" class="DetalizationEvents ws-flexbox ws-flex-column"> <div class="ws-float-area__close-button-wrapper" style="min-height: 34px;"> <component data-component="SBIS3.EDO.DetalizationHead" name="DetalizationHead"> </component> </div> <div class="detalization_brw_tabs"> <component data-component="SBIS3.Engine.BrowserTabs" name="DetalizationBrowserTabs"> <option name="className">DetalizationEvents-DetalizationBrowserTabs</option> <options name="mainArea" type="array"> <options> <option name="id">detGroup</option> <option name="content"> <component data-component="SBIS3.EDO.FMyTasks" name="'+t(e(o.brwName))+'"> <option name="objectName">'+t(e(o.docTypeString))+'</option> <option name="method">ПолучитьДокументыПоОтработке</option> <option name="idProperty">@Событие</option> <option name="dateColTemplate">tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TDateDoneColumn</option> <option name="showHead">true</option> <option name="noScrollHeight">true</option> <options name="massActionsVisibility"> <option name="edoPrintDocumentMass">false</option> </options> <option name="taskColHeadTemplate"> <component data-component="SBIS3.CONTROLS/Link" name="DetalizationSrokSortChange" class="ctrFilterLinkDate"> <option name="icon">sprite:icon-16 icon-Trend'+t(e(o.sortSrokIcon))+' icon-primary</option> <option name="caption">'+t(e(rk("Заголовок@@Срок")))+'</option> <option name="tooltip">'+t(e(rk("Заголовок@@Срок")))+'</option> <options name="handlers"> <option name="onActivated" type="function">js!SBIS3.EDO.DetalizationEvents:prototype.onClickSortSrokChange</option> </options> </component> </option> <option name="dateColTitle">'+t(e(o.dateColTitle))+'</option> <option name="statusPictureTitle">'+t(e(o.statusPictureTitle))+'</option> <option name="cssStatus">fieldStatusAlign</option> <option name="dateColWidth">100</option> <option name="dateColHeadTemplate"> <component data-component="SBIS3.CONTROLS/Link" name="DetalizationSortChange" class="ctrFilterLinkReceived"> <option name="icon">sprite:icon-16 icon-Trend'+t(e(o.sortReceivedIcon))+' icon-primary</option> <option name="caption">'+t(e(o.dateColTitle))+'</option> <options name="handlers"> <option name="onActivated" type="function">js!SBIS3.EDO.DetalizationEvents:prototype.onClickSortChange</option> </options> </component> </option> <options name="additionalColumn"> <option name="width">100</option> <option name="title">'+t(e(rk("Ответственный")))+'</option> <option name="headTemplate">'+t(e(rk("Ответственный")))+'</option> <option name="cellTemplate">tmpl!SBIS3.EDO2.Browser/resources/columns/tmpl/ResponsibleColumn</option> </options> <option name="onChangeHoveredItemHandler">onChangeHoveredItemDetalization</option> <option name="hierAllow" type="boolean">false</option> <option name="isDetalization" type="boolean">true</option> <option name="isSetFiltersUnreaded" type="boolean">false</option> <option name="descColTemplate">tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TDetalizationColumn</option> <option name="additionalTaskColTemplate">tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TMainColumn</option> <option name="detalizationTitlePrefix">'+t(e(o.detalizationTitlePrefix))+"</option> <option name=\"statusColTemplate\">html!SBIS3.EDO.RegistryColumns/resources/TasksStateDetalizationColumn</option> <option name='personId'>"+t(e(o.personId))+'</option> <options name="filterParams"> '+t(e(o.filterParams))+' </options> <option name="breadCrumbsConfig"> <option name="visible" type="boolean">false</option> <option name="className">Detalization__breadCrumbsConfig</option> </option> <option name="backButtonConfig"> <option name="visible" type="boolean">false</option> <option name="className">Detalization__backButtonConfig</option> </option> <option name="operationsPanelConfig"> <options name="items" type="array"> <options> <option name="name">print</option> <option name="componentType">js!SBIS3.EDO.OperationPrintDetalization</option> <options name="type"> <option name="mass">true</option> <option name="selection" type="boolean">true</option> </options> <options name="options"> ';return o.maPrintId&&(s+=' <option name="documentIdField">'+t(e(o.maPrintId))+"</option> "),s+=' <options name="handlers"> <option name="onApplyOperation" type="function">js!SBIS3.EDO.DetalizationEvents:prototype.setPrintColumns</option> <option name="onPrepareData" type="function">js!SBIS3.EDO.DetalizationEvents:prototype.addColumnsToData</option> </options> </options> </options> <options> <option name="name">unload</option> <option name="componentType">js!SBIS3.EDO.OperationUnloadDetalization</option> <options name="type"> <option name="mass">true</option> <option name="selection" type="boolean">true</option> </options> </options> </options> </option> <option name="doNotUseHistoryId">true</option> <options name="ignoreFiltersList" type="array"> <option>ФильтрВладелец</option> </options> <option name="filterButtonConfig"> <option name="template"> <component data-component="SBIS3.EDO.FilterEventDetalization"> <options name="componentOptions"> <option name="docTypeString">'+t(e(o.docTypeString))+'</option> <option name="subDocTypeString">'+t(e(o.subDocTypeString))+'</option> <option name="FilterPassageStatus">'+t(e(o.FilterPassageStatus))+'</option> <option name="FilterRepeatStages">'+t(e(o.FilterRepeatStages))+'</option> <option name="showPhaseWhenInitThroughCtx">'+t(e(o.showPhaseWhenInitThroughCtx))+'</option> <option name="filterDatePeriodVisibility">'+t(e(!!o.filterDatePeriodVisibility))+'</option> <option name="FilterLimitationDateProc">'+t(e(o.FilterLimitationDateProc))+'</option> </options> </component> </option> <option name="additionalFilterParamsTemplate"> <component data-component="SBIS3.EDO.FilterEventDetalizationSelector"> <options name="componentOptions"> <option name="docTypeString">'+t(e(o.docTypeString))+'</option> <option name="subDocTypeString">'+t(e(o.subDocTypeString))+'</option> <option name="FilterPassageStatus">'+t(e(o.FilterPassageStatus))+'</option> <option name="FilterRepeatStages">'+t(e(o.FilterRepeatStages))+'</option> <option name="showPhaseWhenInitThroughCtx">'+t(e(o.showPhaseWhenInitThroughCtx))+' </option> <option name="filterDatePeriodVisibility">'+t(e(!!o.filterDatePeriodVisibility))+' </option> <option name="FilterLimitationDateProc">'+t(e(o.FilterLimitationDateProc))+' </option> </options> </component> </option> <option name="resetLinkText">'+t(e(o.resetLinkText))+'</option> <option name="filterStructure" type="ref">'+t(e(function(o,t){var n=a.randomId();return o[n]=t,n}(p,o.filterStructure)))+"</option> </option> ",o.additionalItemsActions&&(s+=' <option name="additionalItemsActions">'+t(e(o.additionalItemsActions))+"</option> "),s+=' <option name="useAutoRefresh">true</option> <opts name="partialReloader"> <opt name="filterName" value="СписокИдОДок"/> <opt name="forbidSubtasksAdd" value="true"/> <opt name="turnOffSort" value="true"/> </opts> </component> </option> </options> </options> <options name="tabs" type="array"> <options> <option name="id">DetTab</option> <option name="title">'+t(e(rk("Детализация")))+'</option> <option name="mainArea">detGroup</option> <option name="visible">false</option> </options> </options> <option name="defaultTab">DetTab</option> <option name="tabsName">DetalizationTabs</option> <options name="handlers"> <option name="onTabAndMainLoaded" type="function">js!SBIS3.EDO.DetalizationEvents:prototype.onTabAndMainLoaded</option> </options> </component> </div> </div>',(s=t(s))+(i&&-1!==s.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.DetalizationEvents"}},o});
define('js!SBIS3.EDO.FilterHandlers',['Lib/Control/Control','Core/core-functions','Core/core-attach','Core/core-instance','Transport/BLObject','Core/helpers/transport-helpers','Core/helpers/fast-control-helpers','Core/Context','Core/Deferred','js!SBIS3.Navigation.LeftNavigation','Elektronnyj_dokumentooborot_localization'],function(e,t,a,n,i,s,l,r,o,g){'use strict';var f={linkButtonChoose:function(e){var t=this.getLinkedContext().getValue('Справочник');$('.select-filter-type-from-reestr').attr('faceID',t);},CloseDateNumberDialog:function(){if(this.getParent().validate())this.sendCommand('close'),u('ДатаНомер');},onBeforeShowRecordOurOrg:function(e,a){var n=new o();e.setResult(n.addCallbacks());var i='НашаОрганизация',l='Контрагент.Контрагент_';if(!a.hasColumn(l))l='Контрагент_';if(a.hasColumn('ДокументНашаОрганизация.Контрагент.Контрагент_'))l='ДокументНашаОрганизация.Контрагент.Контрагент_';if('"Предприниматель"'===a.get(l))i='НашаОрганизацияПредприниматель';s.newRecordSet(i,'Список',{},void 0,false,'').addCallbacks(function(e){e.readRecord(a.getKey(),null).addCallbacks(function(e){if(void 0!==e&&null!==e)n.callback(e);},function(e){t.alert(rk('Ошибка при формировании запроса на определение записи нашей организации! Описание:')+e);});},function(e){t.alert(rk('Ошибка при формировании запроса на получение списочного метода для определения нашей организации! Описание:')+e);});},onChangeNOLink:function(t,a){var n=this.getLinkedContext().getFieldOrigin('@Документ'),i=parseInt(n.getValue('Лицо1'),10);if(a[0].get('ДокументНашаОрганизация.@Лицо')===i)l.alert(rk('Отправитель и получатель документа должны отличаться!'),{},this),this.setValue(null);else{var s=a[0].get('ДокументНашаОрганизация.Контрагент.ИНН');e.ControlStorage.getByName('ДокументНашаОрганизация').getLinkedContext().getFieldOrigin('@Документ').setValue('РП.НОИНН',s);}},onOurOrgLinkSelected:function(e,t){var a='КарточкаЮЛ',n='Контрагент.Контрагент_';if(!t.hasColumn(n))n='Контрагент_';if(t.hasColumn('ДокументНашаОрганизация.Контрагент.Контрагент_'))n='ДокументНашаОрганизация.Контрагент.Контрагент_';if('"Предприниматель"'===t.get(n))a='КарточкаИП';e.setResult(a);},onFaceLinkSelected:function(e,t){var a='';if(t.hasColumn('Контрагент_'))a=t.get('Контрагент_');else if(t.hasColumn('Контрагент.Контрагент_'))a=t.get('Контрагент.Контрагент_');if('"Предприниматель"'===a)e.setResult('Добавление контрагента ИП');else e.setResult('Добавление контрагента');},onShowSuggest:function(){var e=this,t=e.getContainer();if(0===t.find('.suggest_addon_bottom').length){var a=$('<div class=\'suggest_addon_bottom\' id=\'egrul_suggest_btn\' style=\'padding-right:5px;\' />');t.append(a);}if('Везде'===e.getLinkedContext().getValue('ГдеИскать'))$('.ws-suggest-container .suggest_addon_bottom').hide();else $('.ws-suggest-container .suggest_addon_bottom').show();},onSuggestFace:function(e,t,a){c(this.getOwner(),e,t);},renderSuggestName:function(e){if('undefined'===typeof this.sflag)this.sflag=false;if(-47===e.getKey()||-48===e.getKey())this.once('onAfterRender',function(e){if(this.sflag)$('.ws-suggest-container .suggest_addon_bottom').hide();if(this.sflag=false,!$('.show_more_row').length){$('.ws-suggest-browser tr[rowkey=\'-47\'], .ws-suggest-browser tr[rowkey=\'-48\']').addClass('show_more_row'),$('.show_more_row div').addClass('show_more_div');var t=$('<div class=\'ws-suggest-hasmore\'><span class=\'ws-suggest-hasmore-link\'>Показать все</span></div>');$('.show_more_row div').eq(0).append(t),$('.show_more_row a').hide();}});if(e.get('Название')===rk('Все известные (ЕГРЮЛ и ЕГРИП)'))this.sflag=true;},onBeforeApplyFilterByMask:function(e,t){var a=this.getLinkedBrowser().getLinkedContext().getValue('inn_find');if(a&&false!==a&&a.length>0)t['ФильтрПоМаске']=a,t['ФильтрИзСписка']='Да';else delete t['ФильтрИзСписка'];e.setResult(t);},filterByMask:function(e,t,a){e.getLinkedContext().setValue('inn_find',t),a.applySearch();},onReestrFilterKeySuggest:function(e,t,a){var n=this.getTopParent();if(!n)return;var i=n.getChildControlByName('ФильтрДокументовПоМаске');if(i){var s=i.getLinkedBrowser();i.setValue(t.get('НазваниеИНН')),f.filterByMask(s,t.get('ИНН'),i);}},addFiltersSelected:function(e,t){var a=e.getFloatArea();if(a&&a.hasChildControlByName('FilterViewEDO'))a.getChildControlByName('FilterViewEDO').getParent().addFiltersSelected(t).addCallback(function(){e.applyFilter(true);});},onInitEDOFilterMyBusiness:function(){for(var t=e.ControlStorage.getByName('ОбластьРеестра').getChildControls(),a=0;a<t.length;a++)if(n.instanceOfModule(t[a],'Deprecated/Controls/TableView/TableView'))if('РеестрОтМеня'===t[a].getName())this._options.filtersEDO.FilterSender.kitTitle='Исполнителю',this._options.filtersEDO.FilterSender.title='Исполнитель';},hidePeriodPhaseReport:function(e,t,a,n){var i=this._FilterView.getQuery(),s='ФильтрПоКраткомуСостоянию'===t?a:i['ФильтрПоКраткомуСостоянию'];if('4'===s||4===s)this.enableFilterPeriod(false,rk('Нельзя выбирать период для документов "В обработке"'));if('4'!==s&&4!==s)this.enableFilterPeriod(true);},onBeforeShowPhaseFilter:function(){var e=this.getFloatArea().getChildControlByName('FilterViewEDO').getQuery(),t=this.getBrowser()?this.getBrowser().getQuery():void 0,a=this.getFloatArea().hasChildControlByName('ФильтрЭДОСтатистика')?this.getFloatArea().getChildControlByName('ФильтрЭДОСтатистика'):null;if(e&&('4'===e['ФильтрПоКраткомуСостоянию']||4===e['ФильтрПоКраткомуСостоянию']||'4'===t['ФильтрПоКраткомуСостоянию']||4===t['ФильтрПоКраткомуСостоянию'])&&!t['ФильтрВнешняяСтатистика']){if(a.enableFilterPeriod(false,rk('Нельзя выбирать период для документов "В обработке"')),a._templateBottom&&a._templateBottom.hasChildControlByName('FilterRepeatStages'))a._templateBottom.getChildControlByName('FilterRepeatStages').hide();}else if(a)a.enableFilterPeriod(true);if(t&&(true===t['ФильтрСтатистикаТекущие']||'Выполнено'!==t['ФильтрСтатистикаПериод']))a._options.filtersEDO.FilterRegulations.hidePhase=true;else a._options.filtersEDO.FilterRegulations.hidePhase=false;var n=g.getInstance(),i=n&&n.getActiveElement(),s=i&&i['elementId'];if('work_plans'===s)a.toggleFilter('ФильтрПриоритет',false),a.toggleFilter('ФильтрСрокДата',false),a.toggleFilter('ФильтрПоВехе',false),a.toggleFilter('ФильтрЛицо1',false),a.toggleFilter('ФильтрСписокРассылки',false);if('business_works'===s)a.toggleFilter('ФильтрПриоритет',false),a.toggleFilter('ФильтрПоВехе',false);var l=this.getParentByClass('SBIS3.EDO.StatTemplate');if(l&&l._options['filter_options']&&l._options['filter_options']['ИдРегламента'])if(a.hasChildControlByName('ИдРегламента'))a.getChildControlByName('ИдРегламента').setEnabled(false);f.new_filter_button_styles(this);},renderDocStats:function(e,t){var a=SBIS3.Navigation.LeftNavigation.getInstance().getActiveElement()['data']['ТипДокумента'];if(('КоррВх'===a||'КоррИсх'===a)&&'7'===e)return rk('Завершенные');},showHideStatFilters:function(e){var t=this._FilterButton,a=t?t.getParentByName('ШаблонСтатистики'):null,n=a?a.getCurrentTemplateName():'';if('js!SBIS3.EDO.StatisticsIncomingDocsOurOrganizations'===n||'js!SBIS3.EDO.StatisticsOutgoingDocsOurOrganizations'===n||'js!SBIS3.EDO.StatisticsIncomingEventsOurOrganizations'===n||'js!SBIS3.EDO.StatisticsOutgoingEventsOurOrganizations'===n)this.toggleFilter('ФильтрСостояние',false),this.toggleFilter('ФильтрУдаленные',false),this.toggleFilter('ФильтрДокументНашаОрганизация',false);if('СтатистикаСкладских'===n||'js!SBIS3.EDO.StatOutgoingEvents'===n||'js!SBIS3.EDO.StatIncomingEvents'===n||'js!SBIS3.EDO.StatIncoming'===n||'js!SBIS3.EDO.StatOutgoing'===n)this.toggleFilter('ФильтрСостояние',false),this.toggleFilter('ФильтрУдаленные',false);if('js!SBIS3.EDO.StatOutgoingEvents'===n||'js!SBIS3.EDO.StatIncomingEvents'===n||'js!SBIS3.EDO.StatisticsIncomingEventsOurOrganizations'===n||'js!SBIS3.EDO.StatisticsOutgoingEventsOurOrganizations'===n||'js!SBIS3.EDO.StatisticsIncomingEventsContragents'===n||'js!SBIS3.EDO.StatisticsOutgoingEventsContragents'===n)this.toggleFilter('Регламент',false);},new_filter_button_styles:function(e){var t=e.getFloatArea(),a=t&&t.getContainer()?t.getContainer().find('.ws-filter-button-area-header'):'',n=t&&t.getContainer()?t.getContainer().find('.ws-filter-button-area-content'):'';if(a.length>0)a.addClass('edo-external-stat-filter-header');if(n.length>0)n.addClass('edo-external-stat-filter-content');}};return f;function d(e,t,n,s,l,r,o,g){new i(e).query(t,n).addCallback(function(e){for(var t=$('<table width="100%"></table>'),n='',i=e.next();false!==i;i=e.next())n=l(i),t.append($('<tr height="20px"></td><td>&nbsp;<a href="#" class="select-filter-type asLink" faceId="'+i.get(s)+'"  >'+n+'</a></td><td></td></tr>'));$('#containerFilter').html(t);var f=$('#containerFilter').height();g.getContainer().find('.dt_grid_cell_1_1').height(f);var d=$('<table width="100%"></table>');if(null!==o)d.append($('<tr height="30px"><td id="choose"></td><td style="vertical-align:middle"><a href="#" class="select-filter-type-from-reestr asLink" faceId="'+null+'" >'+rk('Выбрать')+'</a></td></tr>'));if(d.append($('<tr height="20px"></td><td>&nbsp;<a href="#" class="select-filter-type asLink" faceId="'+null+'" >'+rk('Показать все')+'</a></td><td></td></tr>')),$('#reestrChooseFilter').html(d),g.getContainer().find('.dt_grid_cell_2_1').css('top',f),null!==o)a.attachInstance('Control/Area:TemplatedArea',{template:o,element:'choose',page:true});$('.select-filter-type').bind('click',r),$('.select-filter-type-from-reestr').bind('click',r);});}function u(t){var a=e.ControlStorage.getByName(t),n=a.getParent(),i=a.getParent().getLinkedContext(),s=i.getValue('Дата');if(void 0===s)s=i.getValue('Документ.Дата');var l=s.getDate().toString();l=1==l.length?'0'+l:l;var r=(s.getMonth()+1).toString();r=1==r.length?'0'+r:r;var o=s.getFullYear().toString(),g=l+'.'+r+'.'+(o=o.slice(2)),f=i.getValue('Номер');if(void 0===f)f=i.getValue('Документ.Номер');if(!f)f='';var d='\u2116 '+f+' '+rk('от','конкретной даты')+' '+g,u='АвансОтчет'===i.getValue('ТипДокумента.ТипДокумента')?false:true,c=u?i.getValue('ЛицоСоздал.Название'):'',h=u?'<a href="#" class="auth asLink" style="font-size:12px" faceID = '+i.getValue('ЛицоСоздал')+'>'+c+'</a>':'';if(null===c)c=rk('не известен'),h='<span href="#" class="auth ws-field-label" style="font-size:12px" faceID = '+i.getValue('ЛицоСоздал')+'>'+c+'</span>';_getOurOrgName(i).addCallback(function(e){var t=false,a=false;if(void 0!==i.getValue('ДокументРасширение.Состояние'))t=i.getValue('ДокументРасширение.Состояние').get('ЗакрытОтРедактирования'),a=i.getValue('ДокументРасширение.Состояние').get('Запущен');var s=$('<table width="100%"></table>'),l=$('<table width="100%"></table>'),r='';if(null!==e)r='&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ws-field-label">'+rk('Наша организация')+'</span>&nbsp;&nbsp;<a href="#" class="ourorg asLink" style="font-size:12px" ourorgID = '+i.getValue('ДокументНашаОрганизация')+'>'+e+'</a>';var o,g=u?'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ws-field-label" style="display:inline;">'+rk('Автор')+'</span>&nbsp;&nbsp;'+h:'';if(true===t||true===a)o='<tr><td nowrap><span class="ws-field-label" style="display:inline;">'+d+'</span>'+g+'</td></tr>',s.append($(o)),l.append($('<tr><td nowrap><span class="ws-field-label" style="display:inline;">'+d+'</span>'+g+r+'</td></tr>'));else o='<tr><td nowrap><a href="#" class="num asLink" style="font-size:12px" dlgname ='+n.getName()+' >'+d+'</a>'+g+'</td></tr>',s.append($(o)),l.append($('<tr><td nowrap><a href="#" class="num asLink" style="font-size:12px" dlgname ='+n.getName()+' >'+d+'</a>'+g+r+'</td></tr>'));$('.datenum').html(s),$('.datenum_ourorg').html(l),$('.num').bind('click',showDateNumDialog),$('.auth').bind('click',showAuthorDialog),$('.ourorg').bind('click',showOurOrgDialog);});}function c(e,a,n,s){var l=e.getLinkedContext(),o=n.get('ИНН');if(o&&'Лицо1'===e.getName())r.global.setValue('Лицо1ИНН',o),h(o);if(n.get('@Лицо')>=-49&&n.get('@Лицо')<=-47){if(l.setValue('НемедленныйПоиск',l.getValue('Лицо1.Название')),a.setResult(true),a.cancelBubble(),-48===n.get('@Лицо'))l.setValue('ЕГРЮЛ',false),e.processClick();if(-47===n.get('@Лицо'))l.setValue('ЕГРЮЛ',true),e.processClick();return;}if(n.get('Локальный')){var g=n.get('@Лицо');if(l)l.setValue('Лицо1',g),l.setValue('ФильтрЛицо1',g);if(!!s){if('Грузоотправитель'==s)ChangeGruzo(g,'Грузоотправитель.Адрес','Грузополучатель.Контрагент');if('Грузополучатель'==s)ChangeGruzo(g,'Грузополучатель.Адрес','Грузоотправитель.Контрагент');}a.setResult(true),a.cancelBubble();}else a.setResult(true),a.cancelBubble(),new i('Контрагент').call('СоздатьПоСПП',{'ИдСПП':n.get('@Лицо')},i.RETURN_TYPE_ASIS).addCallback(function(e){var t=e.get('Запись').get('@Лицо');if(l)l.setValue('Лицо1',t),l.setValue('ФильтрЛицо1',t);if(!!s){if('Грузоотправитель'==s)ChangeGruzo(t,'Грузоотправитель.Адрес','Грузополучатель.Контрагент');if('Грузополучатель'==s)ChangeGruzo(t,'Грузополучатель.Адрес','Грузоотправитель.Контрагент');}}).addErrback(function(e){t.alert(rk('Ошибки при сохранении контрагента из ЕГРЮЛ:')+' '+e,'error');});}function h(t){var a=t||e.ControlStorage.getByName('Лицо1').getSelectedRecords()[0].get('Контрагент.ИНН'),n=new i('СервисПрофилей');if($('#chFace').after('<img style=\'margin-left: 7px; margin-bottom: -2px;\' id=\'faceSmallIndic\' src=\'/ws/img/ajax-loader-small.v1516270649826335cf4508dd597be4bfc9caa3e08b901.gif\'>'),e.ControlStorage.containsByName('кнВыбратьОфЛицо'))e.ControlStorage.getByName('кнВыбратьОфЛицо').hide();if(a&&e.ControlStorage.containsByName('Лицо1'))n.call('ПоискКонтактовОрганизацийСписок',{'ДопПоля':[],'Сортировка':null,'Навигация':null,'Фильтр':{d:[a],s:[{n:'ИНН',t:'Строка'}]}},i.RETURN_TYPE_RECORDSET).addCallback(function(t){if($('#faceSmallIndic').remove(),checkRecHasLeaves(t))if(e.ControlStorage.containsByName('кнВыбратьОфЛицо'))e.ControlStorage.getByName('кнВыбратьОфЛицо').show();}).addErrback(function(e){$('#faceSmallIndic').remove();});}});
define('js!SBIS3.EDO.StatFuncs',['Lib/Control/Control','Core/helpers/helpers','Core/core-functions','Core/core-attach','Core/core-instance','Transport/BLObject','Core/helpers/string-helpers-min','Core/helpers/string-helpers','Core/helpers/fast-control-helpers','Core/UserConfig','Core/Context','Core/Deferred','js!SBIS3.EDO.doc_filters','Elektronnyj_dokumentooborot_localization'],function(t,e,r,a,n,i,o,s,l,g,u,c,S){var d;return d={cFunctions:r,updateStatTemplate:function(e,r,a){if(!r)r=false;var n=S.getCurrentBrowser(),i=null;if(null===n||void 0===n)return;if(!i||!n.getRecordSet())return;var o=n.getQuery(),s,l,g='-2 ТД'===i.get('@Ид')||'-3 ТД'===i.get('@Ид'),c='Исходящие'===i.get('ТипРаздела')||'ДокОтгрИсх'===i.get('ТипРаздела'),f='Входящие'===i.get('ТипРаздела')||'ДокОтгрВх'===i.get('ТипРаздела'),m=n.getLinkedContext(),p='ШаблонСтатистики',B=t.ControlStorage.containsByName(p)?t.ControlStorage.getByName(p).getCurrentTemplateName():null,C=false,v=t.ControlStorage.containsByName(p)?t.ControlStorage.getByName(p):null,h=d.getCurrentStatBrowser(),y=h?h.getQuery&&h.getQuery():new Object(),O=null!==v?v.getLinkedContext():new u(),F=SBIS3.Navigation.LeftNavigation.getInstance()?SBIS3.Navigation.LeftNavigation.getInstance().getActiveElement()['data']['ТипДокумента']:void 0,I;if(g&&f)s='js!SBIS3.EDO.StatIncomingEvents',l='js!SBIS3.EDO.StatIncomingEvents';else if(g&&c)s='js!SBIS3.EDO.StatOutgoingEvents',l='js!SBIS3.EDO.StatOutgoingEvents';var N=e||B||m.getValue('ШаблонСтатистики');if(null!==N&&void 0!==N&&N.length>0)s=N;if(O&&o['ТипДокумента']!==O.getValue('ТипДокумента'))if(g)s=l;else s=e||m.getValue('ШаблонСтатистики')||'СтатистикаСкладских';if('js!SBIS3.BUH.ExpRepStatMain'===s)if(!t.ControlStorage.containsByName('РазделыДокументооборота'))return;else if('МоиДокументы'===t.ControlStorage.getByName('РазделыДокументооборота').getActiveElement())s='СтатистикаВнутренних';switch(s){case'СтатистикаПоВсемНашимОрганизациям':s=f?'СтатистикаВхПоВсемНашимОрганизациям':'СтатистикаИсхПоВсемНашимОрганизациям';break;case'СтатистикаСобытийПоКонтрагентам':s=f?'js!SBIS3.EDO.StatisticsIncomingEventsContragents':'js!SBIS3.EDO.StatisticsOutgoingEventsContragents';break;case'СтатистикаСкладскиеПоТоварам':s=f?'СтатистикаСкладВхПоТоварам':'СтатистикаСкладИсхПоТоварам';break;case'СтатистикаСкладскиеПоКонтрагентам':s=f?'js!SBIS3.EDO.StatisticsIncomingDocsContragents':'js!SBIS3.EDO.StatisticsOutgoingDocsContragents';break;case'СтатистикаПоСотрудникам':s='СчетИсх'===i.get('ТипДокумента')||'ФактураИсх'===i.get('ТипДокумента')?'СтатистикаПоСотрудникамСчет':'СтатистикаПоСотрудникамРеализация';}if('СтатистикаИсходящих'===s)s='js!SBIS3.EDO.StatOutgoing';if('СтатистикаВходящих'===s)s='js!SBIS3.EDO.StatIncoming';if('СтатистикаВнутренних'===s)s='js!SBIS3.EDO.StatInternalReport';var _=d.getStatFiltersList(s);C=d.compareFilters(o,y,_);for(I in O.toObject())if(-1!==jQuery.inArray(I,_))y[I]=O.getValue(I);for(I in y)if(-1===jQuery.inArray(I,_)&&'ИсходныйШаблонОбластиКоманд'!==I)delete y[I];if(false!==a){if(y=new Object(),-2===o['ФильтрНезакрепленные'])o['ФильтрСостояние']='-2';d.copyFilters(o,y,_);}if(d.reloadStatContextValues(O,y,_),-2===O.getValue('ФильтрОтветственноеЛицо')&&-1===jQuery.inArray('ФильтрСостояние',_))O.setValue('ФильтрОтветственноеЛицо',null);if('js!SBIS3.EDO.StatisticsReportByPhase'===s)C=false,r=false;if(C||r)d.getOurOrgCountByTemplate(s).addCallback(function(e){t.ControlStorage.waitChildByName(p).addCallback(function(e){d.reloadStatContextValues(e.getLinkedContext(),y,_),e.setTemplate(s).addCallback(function(){if(d.reloadStatContextValues(e.getLinkedContext(),y,_),'СтатистикаСкладских'===s)t.ControlStorage.waitChildByName('ШаблонСтатистикаИсхВхСклад').addCallback(function(t){if(f)t.setTemplate('js!SBIS3.EDO.StatIncomingDocs').addCallback(function(){if(d.reloadStatContextValues(e.getLinkedContext(),y,_),d.getStatFilterButton()&&d.getStatFilterButton().applyFilter)d.getStatFilterButton().applyFilter(true);});else if(c)t.setTemplate('js!SBIS3.EDO.StatOutgoingDocs').addCallback(function(){if(d.reloadStatContextValues(e.getLinkedContext(),y,_),d.getStatFilterButton()&&d.getStatFilterButton().applyFilter)d.getStatFilterButton().applyFilter(true);});return t;});else if(d.getStatFilterButton()&&d.getStatFilterButton().applyFilter)d.getStatFilterButton().applyFilter(true);});});});if('СтатистикаВнутренних'!==s&&'js!SBIS3.EDO.StatisticsReportByPhase'!==s&&'СтатистикаВнутреннихНовая'!==s&&'js!SBIS3.EDO.StatisticsInnerCurrent'!==s)d.addStatPrintButton();if('js!SBIS3.EDO.StatisticsOutgoingEventsContragents'===s||'js!SBIS3.EDO.StatisticsIncomingEventsContragents'===s||'js!SBIS3.EDO.StatisticsIncomingDocsContragents'===s||'js!SBIS3.EDO.StatisticsOutgoingDocsContragents'===s)d.addStatSaveButton();},reloadStatContextValues:function(t,e,r,a){if(!e['ФильтрДатаПериод']||'Все'===e['ФильтрДатаПериод'])e['ФильтрДатаПериод']='Месяц';if(-2===e['ФильтрОтветственноеЛицо'])delete e['ФильтрОтветственноеЛицо'];t.removeValue('Строка поиска');for(var n=0;n<r.length;n++)t.removeValue(r[n]);for(var i in e)if(e.hasOwnProperty(i))t.setValue(i,e[i]);if(e['ФильтрВнешняяСтатистика'])e['ФильтрПоКраткомуСостоянию']=4;if(!t.getValue('ТипДокумента')||'string'===typeof t.getValue('ТипДокумента')){var o=null,s=a?a.getFilter():S.getCurrentBrowser()?S.getCurrentBrowser().getQuery():{},l=s['ТипДокумента']?s['ТипДокумента']:o&&o.hasColumn('@ТипДокумента')?o.get('@ТипДокумента'):-2;t.setValue('ТипДокумента',l);}},addStatPrintButton:function(){var t=$('<div id="stat_print_button" style="top:3px;left:8px;float:left;z-index:100;"></div>'),e=$('div.browserTabs__middle-area'),n=e.length?e:$('div#content');if(e.length)t.css('top','-1px');if(0!==n.length)n.find('div#stat_print_button').remove();if(0!==n.length&&0===n.find('div#stat_print_button').length)n.append(t);a.attachInstance('Control/Button',{element:t,image:'sprite:icon-24 icon-Print icon-primary',name:'Распечатать',caption:rk('Распечатать'),parent:n,renderStyle:'asLink',handlers:{onActivated:function(){var t=d.getCurrentStatBrowser(),e;if(t)e=t.getReports(false)[0];else return void r.alert(rk('Для данного вида статистики отчета нет'));t.printReport(e,false);}}});},removeStatPrintButton:function(){var t=$('div.browserTabs__middle-area'),e=t.length?t:$('div#content');if(0!==e.length){var r=e.find('div#stat_print_button'),a=e.find('div#stat_save_button'),n={p:!!r.length,s:!!a.length};return r.remove(),a.remove(),n;}},addStatSaveButton:function(){var r=$('<div id="stat_save_button" style="top:3px;left:12px;float:left;z-index:100;"></div>'),n=$('div.browserTabs__middle-area'),i=n.length?n:$('div#content');if(n.length)r.css('top','-1px');if(0!==i.length)i.find('div#stat_save_button').remove();if(0!==i.length&&0===i.find('div#stat_save_button').length)i.append(r);a.attachInstance('Control/Button',{element:r,image:'sprite:icon-24 icon-Save icon-primary',name:'Сохранить',caption:rk('Сохранить'),parent:i,renderStyle:'asLink',handlers:{onActivated:function(){var r=d.getCurrentStatBrowser().getContainer().find('div.ws-browser-data-container').clone(),a='',n='ШаблонСтатистики';if(r.find('.ws-browser-footer').remove(),r.find('.ws-browser-empty').remove(),r.find('.ws-browser-results-block').remove(),'js!SBIS3.EDO.StatisticsOutgoingEventsContragents'===t.ControlStorage.getByName(n).getCurrentTemplateName()||'js!SBIS3.EDO.StatisticsIncomingEventsContragents'===t.ControlStorage.getByName(n).getCurrentTemplateName())a=rk('Сводная ведомость по контрагентам');else a=rk('Сводная ведомость по контрагентам и документам');e.saveToFile('Excel','СохранитьПоHTML',{html:r.html(),'Название':a,fileDownloadToken:1});}}});},removeStatSaveButton:function(){var t=$('div.browserTabs__middle-area'),e=t.length?t:$('div#content');if(0!==e.length)e.find('div#stat_save_button').remove();},goToInnerStatReport:function(e,r,a){if(a){var i=null;if(i&&'js!SBIS3.BUH.ExpRepStatMain'===i.get('ШаблонСтатистики')||r['ФильтрВнешняяСтатистика'])(a=t.ControlStorage.getByName('ШаблонСтатистики')).getLinkedContext().setValue('ФильтрПоКраткомуСостоянию','4');for(var o=d.getStatFiltersList(e),s=0;s<o.length;s++)a.getLinkedContext().setValue(o[s],r[o[s]]);if('js!SBIS3.EDO.StatisticsInnerCurrent'===e)if(r&&r['ИдРегламента'])if('По ответственному'!==r['ФильтрРазрезСтатистики'])return d.goToInnerStatReport('js!SBIS3.EDO.StatisticsReportByPhase',r,a);else return d.goToInnerStatReport('js!SBIS3.EDO.ReportStatResult',r,a);if(n.instanceOfModule(a,'SBIS3.EDO.StatTemplate'))a.setStatisticsTemplate(e);else a.setTemplate(e);}return;},saveFilterParametersForBrowser:function(e,r,a){try{var n,i=a||t.ControlStorage.getByName(e),o=i.getQuery?i.getQuery()['ТипДокумента']:i.getFilter?i.getFilter()['ТипДокумента']:{},s=S.makeFilterPure(r),l=S.filterSerialize(s),u=S.filterSerialize(S.getDefaultFilterForBrowser(e)),c=S.generateBrowserFilterParameterName(e||i.getName(),o),f=!r['ФильтрДатаПериод']&&!r['ФильтрДатаП']&&!r['ФильтрДатаС'];if(null===l||void 0===l||''===l||l===u)g.removeParam(c);else g.setParam(c,l);}catch(t){}},goToInnerDocsFromStat:function(e,r){var a=r||S.getCurrentBrowser();if(null!==a&&void 0!==a){var i={},o='ШаблонСтатистики',s=d.getCurrentStatBrowser()?d.getCurrentStatBrowser().getQuery():t.ControlStorage.getByName(o).getLinkedContext().toObject(),l=d.getStatFiltersList(t.ControlStorage.getByName(o).getCurrentTemplateName());switch(e){case'Всего':delete i['ФильтрПоКраткомуСостоянию'];break;case'В обработке':i['ФильтрПоКраткомуСостоянию']='4';break;case'Завершено':i['ФильтрПоКраткомуСостоянию']='1';break;case'Черновики':i['ФильтрПоКраткомуСостоянию']='5';}if(d.copyFilters(s,i,l),d.saveFilterParametersForBrowser(null,i,a),r)d.setFilterForNewBrowser(r,i),d.setActiveTabNewRegistry(r);else{if(a.setQuery(i),t.ControlStorage.containsByName('ПанельСФильтром')&&n.instanceOfModule(t.ControlStorage.getByName('ПанельСФильтром'),'SBIS3.EDO.FilterController'))if(t.ControlStorage.getByName('ПанельСФильтром').getPathFilter())t.ControlStorage.getByName('ПанельСФильтром').getPathFilter().setFilter('ФильтрПоКраткомуСостоянию',i['ФильтрПоКраткомуСостоянию'],true),t.ControlStorage.getByName('ПанельСФильтром').getPathFilter().setFilter('ФильтрВладелец',i['ФильтрВладелец'],true);d.setActiveTab('ОткрытьЗакладкуДокументы');}}},goToInnerStat:function(e){var r='ШаблонСтатистики',a='js!SBIS3.EDO.StatisticsInnerCurrent';t.ControlStorage.getByName(r).getLinkedContext().setValue('ФильтрПоКраткомуСостоянию',4),t.ControlStorage.getByName(r).getLinkedContext().setValue('ФильтрСостояние',10),e?d.updateStatTemplateNew(a,e):d.updateStatTemplate(a,true,false),d.removeStatPrintButton();},goToDocsFromStat:function(e,r,a){var n=r||S.getCurrentBrowser();if(null!==n&&void 0!==n){var i=d.getCurrentStatBrowser(),o={},s='ШаблонСтатистики',l=d.getStatFiltersList(t.ControlStorage.getByName(s).getCurrentTemplateName()),g={};if(i)o=i.getQuery();d.copyFilters(o,g,l),g['ФильтрОтветыКонтрагентов']=false;var u='string'===typeof e?e:e.id,c=SBIS3.Navigation&&SBIS3.Navigation.LeftNavigation,f=null,m=a||(c&&c.getInstance()?c.getInstance().getActiveElement()['data']['ТипДокумента']:void 0)||(f?f.get('ТипДокумента'):'');switch(u){case'all_docs':delete g['ФильтрСостояние'];break;case'send_docs':g['ФильтрСостояние']='2,3,4,7,9';break;case'deliv_docs':g['ФильтрСостояние']='4,7,9';break;case'recv_docs':case'recv_docs_in':g['ФильтрСостояние']='7';break;case'decl_docs':case'decl_docs_in':g['ФильтрСостояние']='9';break;case'on_checking_docs':g['ФильтрСостояние']='4';break;case'no_deliv_docs':g['ФильтрСостояние']='2,3';break;case'proc_docs':case'no_send_docs':g['ФильтрСостояние']='10';break;case'kon_del_docs':case'kon_del_docs_in':g['ФильтрСостояние']='19,20';break;case'ann_docs':g['ФильтрСостояние']='22';break;case'error_docs':g['ФильтрСостояние']='6';break;case'rough_docs':g['ФильтрСостояние']='0,1';break;case'end_docs':g['ФильтрСостояние']='7,9';}if(d.saveFilterParametersForBrowser(null,g,n),d.setStatePathFilter(g),!r)n.setQuery(g),d.setActiveTab('ОткрытьЗакладкуДокументы');else d.setFilterForNewBrowser(r,g),d.setActiveTabNewRegistry(r);}},applyFiltersToFS:function(t,e,r,a,n){for(f in e)if(e[f]['filterField']in t){if(void 0!==t[e[f]['filterField']]&&null!==t[e[f]['filterField']]&&t[e[f]['filterField']]!==e[f]['resetValue']){if(e[f]['value']=t[e[f]['filterField']],e[f]['visibilityValue']=true,'ФильтрДатаПериод'===e[f]['filterField'])e[f]['caption']=r;if('ФильтрСостояние'===e[f]['filterField'])e[f]['caption']=a;if(n&&e[f]['filterField']in n)e[f]['caption']=n[e[f]['filterField']];}else if(e[f]['value']=e[f]['resetValue'],e[f]['visibilityValue']=false,'caption'in e[f])e[f]['caption']=null;}else if(e[f]['value']=e[f]['resetValue'],e[f]['visibilityValue']='resetVisibilityValue'in e[f]?e[f]['resetVisibilityValue']:false,'caption'in e[f])e[f]['caption']=null;return d.cFunctions.clone(e);},setFilterForNewBrowser:function(t,e,r){if('Период'!==e['ФильтрДатаПериод'])delete e['ФильтрДатаС'],delete e['ФильтрДатаП'];if(!('ФильтрНеотвеченные'in e))e['ФильтрНеотвеченные']=false;var a=d.getCurrentStatBrowser(),n=a&&a.getParent(),i=n&&n.hasChildControlByName('ПанельСФильтромСтат')?n.getChildControlByName('ПанельСФильтромСтат'):null,o=i&&i.getFilterButton(),s=o&&o.getFloatArea(),l={},g=['ФильтрЛицо1','ФильтрДокументНашаОрганизация','ФильтрОтветственноеЛицо'],u,c='';if(s)if(l['ФильтрДатаПериод']=d.getFilterDatePeriodString(s),'ФильтрСостояние'in e&&s.hasChildControlByName('ФильтрЭДОСтатистика')){var S=s.getChildControlByName('ФильтрЭДОСтатистика')._options;if(S)if(S=S.filtersEDO,S)if(S=S.FilterState,S)if(S=S.filterStateData,S)for(st in S)if(S[st]['key']===e['ФильтрСостояние']){c=S[st]['value'];break;}}var f=t.getParent().getParent();if(f._options&&f._options.browserOptions&&'browser.filter'==f._options.browserOptions.bind){f.setFilter(e);var m=f._getFilterButton(),p=f._getFastDataFilter(),B=m.getFilterStructure(),C=p.getFilterStructure();m.setFilterStructure(d.applyFiltersToFS(e,B,l['ФильтрДатаПериод'],c,r)),p.setFilterStructure(d.applyFiltersToFS(e,C,l['ФильтрДатаПериод'],c,r));}else t.setFilter(e);if(s){for(u in g)if(g.hasOwnProperty(u)&&s.hasChildControlByName(g[u]))l[g[u]]=s.getChildControlByName(g[u]).getStringValue();if(l['ФильтрДатаПериод']=d.getFilterDatePeriodString(s),e['ФильтрНеотвеченные'])l['ФильтрНеотвеченные']=rk('Не получен ответ');if(e['ФильтрНезакрепленные'])l['ФильтрНезакрепленные']=rk('Незакрепленные');if(e['ФильтрВладелец'])l['ФильтрВладелец']=e['ФильтрВладелец'];}},getFilterDatePeriodString:function(t){if(t&&t.hasChildControlByName('ФильтрДатаПериод'))return d.getFilterDatePeriodStringFromValues(t.getChildControlByName('ФильтрДатаПериод').getStringValue(),t.hasChildControlByName('ФильтрДатаС')&&t.getChildControlByName('ФильтрДатаС').getValue(),t.hasChildControlByName('ФильтрДатаП')&&t.getChildControlByName('ФильтрДатаП').getValue());return'';},getFilterDatePeriodStringFromValues:function(t,e,r){var a=['Января','Февраля','Марта','Апреля','Мая','Июня','Июля','Августа','Сентября','Октября','Ноября','Декабря'];if('За период'!==t)return t;else{var n=e?e.strftime('%e ')+a[e.getMonth()]+e.strftime(' %Y'):'',i=r?r.strftime('%e ')+a[r.getMonth()]+r.strftime(' %Y'):'';if(n&&i)return t+' С '+n+' - По '+i;else if(n)return t+' С '+n;else if(i)return t+' По '+i;}},customizeFiltersToObject:function(t){var e={};if(t&&t.length>0)for(var r in t)if(t.hasOwnProperty(r)&&'object'===typeof t[r]){var a=t[r];e[a['name']]=a['enable'];}return e;},getBrowserFromNewRegistry:function(){var t=this.getParentByClass('SBIS3.EDO.StatTemplate'),e=t&&t._options&&t._options['registryBrowserName'],r=this.getParentByClass('SBIS3.Engine.BrowserTabs')||null,a=r?r.hasChildControlByName(e)?r.getChildControlByName(e):null:null,n=a?a.hasChildControlByName('browserView')?a.getChildControlByName('browserView'):null:null;if(!n&&'browserView'===e)n=a;return n;},setActiveTabNewRegistry:function(t){var e=t.getParentByClass('SBIS3.Engine.BrowserTabs'),r=e&&e.getTabButtons();if(r){var a=e.getChildControls(),i;for(var o in a)if(a.hasOwnProperty(o)&&n.instanceOfModule(a[o],'SBIS3.EDO.StatTemplate')){i=a[o];break;}if(i){var s=i&&i._options&&i._options['registryTabID'];s&&r.setSelectedKey(s);}}},updateStatTemplateNew:function(e,r){var a='ШаблонСтатистики',n=d.getStatFiltersList(e),i=d.getCurrentStatBrowser(),o=i&&i.getQuery()||{},s=t.ControlStorage.containsByName(a)?t.ControlStorage.getByName(a):null,l=null!==s?s.getLinkedContext():new u(),g=l&&l.getValue('ТипРаздела'),c='Исходящие'===g||'ДокОтгрИсх'===g,S='Входящие'===g||'ДокОтгрВх'===g,f;if('СтатистикаСобытийПоКонтрагентам'===e)e='js!SBIS3.EDO.Statistics'+('Входящие'===g?'Incoming':'Outgoing')+'EventsContragents';if('СтатистикаСкладскиеПоКонтрагентам'===e)e='js!SBIS3.EDO.Statistics'+('Входящие'===g?'Incoming':'Outgoing')+'DocsContragents';for(f in l.toObject())if(-1!==jQuery.inArray(f,n))o[f]=l.getValue(f);for(f in o)if(-1===jQuery.inArray(f,n)&&'ИсходныйШаблонОбластиКоманд'!==f)delete o[f];if(d.getOurOrgCountByTemplate(e).addCallback(function(r){t.ControlStorage.waitChildByName(a).addCallback(function(r){d.reloadStatContextValues(r.getLinkedContext(),o,n),r.setTemplate(e).addCallback(function(){if(d.reloadStatContextValues(r.getLinkedContext(),o,n),'СтатистикаСкладских'===e)t.ControlStorage.waitChildByName('ШаблонСтатистикаИсхВхСклад').addCallback(function(t){if(S)t.setTemplate('js!SBIS3.EDO.StatIncomingDocs').addCallback(function(){if(d.reloadStatContextValues(r.getLinkedContext(),o,n),d.getStatFilterButton()&&d.getStatFilterButton().applyFilter)d.getStatFilterButton().applyFilter(true);});else if(c)t.setTemplate('js!SBIS3.EDO.StatOutgoingDocs').addCallback(function(){if(d.reloadStatContextValues(r.getLinkedContext(),o,n),d.getStatFilterButton()&&d.getStatFilterButton().applyFilter)d.getStatFilterButton().applyFilter(true);});return t;});else if(d.getStatFilterButton()&&d.getStatFilterButton().applyFilter)d.getStatFilterButton().applyFilter(true);});});}),'СтатистикаВнутренних'!==e&&'js!SBIS3.EDO.StatisticsReportByPhase'!==e&&'СтатистикаВнутреннихНовая'!==e)d.addStatPrintButton();if('js!SBIS3.EDO.StatisticsOutgoingEventsContragents'===e||'js!SBIS3.EDO.StatisticsIncomingEventsContragents'===e||'js!SBIS3.EDO.StatisticsOutgoingDocsContragents'===e||'js!SBIS3.EDO.StatisticsIncomingDocsContragents'===e)d.addStatSaveButton();},goToOurOrgReport:function(t,e){var r=e||S.getCurrentBrowser(),a;if(r)if(e)d.updateStatTemplateNew(t,e);else a=r.getQuery(),g.setParam('nextStatTemplate',t),r.setQuery(a);},goToReestrFromOurOrgReport:function(e,r,a,n){if(!n)d.removeStatPrintButton();var i=0;switch(e){case'Название':case'Всего':i='-1';break;case'В_обработке':case'Обработка_внутри_компании':i='10';break;case'Утверждено':case'Принято':i='7';break;case'Отклонено':i='9';break;case'Не_получен_ответ':i='4';break;case'Не_доставлено':i='2,3';break;case'Аннулировано':i='22';break;case'Удалено мной/контрагентом':i='19,20';break;case'С_ошибками':i='6';break;case'Черновики':i='0,1';}if(0===i)return;var o=n||S.getCurrentBrowser();if(!o)return;var s=d.getCurrentStatBrowser(),l={},g='ШаблонСтатистики',u=d.getStatFiltersList(t.ControlStorage.getByName(g).getCurrentTemplateName()),c={};if(null!==s)l=s.getQuery();if(d.copyFilters(l,c,u),r)c['ФильтрДокументНашаОрганизация']=[r];else delete c['ФильтрДокументНашаОрганизация'];if('-1'!==i)c['ФильтрСостояние']=i;else delete c['ФильтрСостояние'];if(n)d.setFilterForNewBrowser(n,c,{'ФильтрДокументНашаОрганизация':a}),d.setActiveTabNewRegistry(n);else o.setQuery(c),d.setStatePathFilter(c),d.setActiveTab('ОткрытьЗакладкуДокументы');d.saveFilterParametersForBrowser(null,c,o);},goToKontr:function(e,r,a){var n=a||getCurrentBrowser(),i='ШаблонСтатистики';if(null!==n&&void 0!==n){var o='',s=o=a?n.getFilter():n.getQuery();if(r&&r>0)s['Регламент']=r;else delete s['Регламент'];switch('string'===typeof e?e:e.id){case'all_docs':delete s['ФильтрСостояние'];break;case'send_docs':s['ФильтрСостояние']='2,3,4,7,9';break;case'deliv_docs':s['ФильтрСостояние']='4,7,9';break;case'recv_docs':case'recv_docs_in':s['ФильтрСостояние']='7';break;case'decl_docs':case'decl_docs_in':s['ФильтрСостояние']='9';break;case'on_checking_docs':s['ФильтрСостояние']='4';break;case'no_deliv_docs':s['ФильтрСостояние']='2,3';break;case'regl_docs':case'proc_docs':case'no_send_docs':s['ФильтрСостояние']='10';break;case'kon_del_docs':case'kon_del_docs_in':s['ФильтрСостояние']='19,20,22';break;case'error_docs':s['ФильтрСостояние']='6';break;case'rough_docs':s['ФильтрСостояние']='0,1';}d.saveFilterParametersForBrowser(null,s,n);var l;if(''!==t.ControlStorage.getByName(i).getCurrentTemplateName()){if('СтатистикаСкладских'!=t.ControlStorage.getByName(i).getCurrentTemplateName()&&'js!SBIS3.EDO.StatIncoming'!=t.ControlStorage.getByName(i).getCurrentTemplateName()&&'js!SBIS3.EDO.StatOutgoing'!=t.ControlStorage.getByName(i).getCurrentTemplateName())l='СтатистикаСобытийПоКонтрагентам';else l='СтатистикаСкладскиеПоКонтрагентам';if(t.ControlStorage.getByName(i).getLinkedContext().setValue('ФильтрСостояние',s['ФильтрСостояние']),a)d.setFilterForNewBrowser(a,s),d.updateStatTemplateNew(l,a);else n.setQuery(s),g.setParam('nextStatTemplate',l);}}},goToReestrFilter:function(e,r,a,n){var i=a||S.getCurrentBrowser(),o={},s=d.getCurrentStatBrowser(),l={},g='ШаблонСтатистики',u=d.getStatFiltersList(t.ControlStorage.getByName(g).getCurrentTemplateName());if(s)l=s.getQuery();if(l[e]=r,s.setQuery(l),d.copyFilters(l,o,u),o[e]=r,d.saveFilterParametersForBrowser(null,o,i),null!==i)if(a){var c={};c[e]=n,d.setFilterForNewBrowser(a,o,c),d.setActiveTabNewRegistry(a);}else i.setQuery(o),d.setStatePathFilter(o),d.setActiveTab('ОткрытьЗакладкуДокументы');},setActiveTab:function(e){if(t.ControlStorage.containsByName('ЗакладкиЭДО'))return void t.ControlStorage.getByName('ЗакладкиЭДО').setCurrentTab(e);if(t.ControlStorage.containsByName('engineRegistry'))return e='ОткрытьЗакладкуДокументы'==e?'reestrGroup':e,void t.ControlStorage.getByName('engineRegistry').getTabButtons().setCurrentTab(e);if(t.ControlStorage.containsByName('ЗакладкиЭДОИсх'))return void t.ControlStorage.getByName('ЗакладкиЭДОИсх').setCurrentTab(e);if(t.ControlStorage.containsByName(e))t.ControlStorage.getByName(e).getContainer().find('a').click();},setStatFilter:function(t,e){if(t.getFilterButton().getTemplateName()!==d.getCurrentStatFilterTemplate(e))t.setTemplate(d.getCurrentStatFilterTemplate(e));},getCurrentStatFilterTemplate:function(t){var e='',r,a=null,n=SBIS3.Navigation&&SBIS3.Navigation.LeftNavigation,i;if(t&&t.getValue('ТипДокумента.Название')&&t.getValue('ТипРаздела'))i=t.getValue('ТипДокумента.Название'),r=t.getValue('ТипРаздела');else{i=(n&&n.getInstance()?n.getInstance().getActiveElement()['data']['ТипДокумента']:void 0)||(a?a.get('ТипДокумента'):'');try{r=null;}catch(t){}}switch(r){case'Входящие':if('КоррВх'===i)e='js!SBIS3.EDO.FilterStatIncomingCorr';else e='js!SBIS3.EDO.FilterStatIncoming';break;case'Исходящие':if('КоррИсх'===i)e='js!SBIS3.EDO.FilterStatOutgoingCorr';else e='js!SBIS3.EDO.FilterStatOutgoing';break;default:e='js!SBIS3.EDO.FilterStatInternal';}return e;},getStatFiltersList:function(t){var e=['ФильтрДатаПериод','ФильтрДатаС','ФильтрДатаП','ФильтрНеотвеченные','ФильтрВладелец','ФильтрАвторИлиОтвОтдел','ФильтрНезакрепленные','ФильтрАвторИлиОтветственный','ТипДокумента','ФильтрУдаленные','ФильтрОтветственноеЛицо','ФильтрСобытий','ФильтрЛицо1','ФильтрТипСобытия','ФильтрТипыДокументов'];if('СтатистикаВнутренних'===t)return e.push('ФильтрАвтор'),e;if('СтатистикаСкладских'!==t&&'js!SBIS3.EDO.StatOutgoingEvents'!==t&&'js!SBIS3.EDO.StatIncomingEvents'!==t&&'js!SBIS3.EDO.StatisticsIncomingDocsOurOrganizations'!==t&&'js!SBIS3.EDO.StatisticsOutgoingDocsOurOrganizations'!==t&&'js!SBIS3.EDO.StatisticsIncomingEventsOurOrganizations'!==t&&'js!SBIS3.EDO.StatisticsOutgoingEventsOurOrganizations'!==t&&'js!SBIS3.EDO.StatOutgoing'!==t&&'js!SBIS3.EDO.StatIncoming'!==t)e.push('ФильтрСостояние'),e.push('ФильтрНезакрепленные');if('СтатистикаСкладских'===t||'js!SBIS3.EDO.StatOutgoingEvents'===t||'js!SBIS3.EDO.StatIncomingEvents'===t||'js!SBIS3.EDO.StatOutgoing'===t||'js!SBIS3.EDO.StatIncoming'===t)e.push('ФильтрДокументНашаОрганизация');if('СтатистикаВнутреннихНовая'===t||'js!SBIS3.EDO.StatisticsReportByPhase'===t||'js!SBIS3.EDO.StatisticsInnerCurrent'===t||'js!SBIS3.EDO.StatisticsReportTransitions'===t||'js!SBIS3.EDO.ReportStatResult'===t||'js!SBIS3.EDO.PeriodStatReport'===t||'js!SBIS3.EDO.PeriodStatReportNew'===t)e.push('ФильтрПриоритет'),e.push('ФильтрСписокРассылки'),e.push('ФильтрОтветственноеЛицо'),e.push('ФильтрАвтор'),e.push('ФильтрДиапазонДокументов'),e.push('ФильтрПоВехе'),e.push('ФильтрСрокДата'),e.push('ФильтрПовторные'),e.push('ФильтрРазрезСтатистики'),e.push('ФильтрСтатусПерехода');if('js!SBIS3.EDO.StatisticsReportByPhase'===t||'js!SBIS3.EDO.StatisticsReportTransitions'===t||'js!SBIS3.EDO.StatisticsInnerCurrent'===t||'js!SBIS3.EDO.ReportStatResult'===t)e.push('ФильтрВнешняяСтатистика'),e.push('ФильтрСтатистикаТекущие'),e.push('ФильтрПоКраткомуСостоянию'),e.push('ФильтрСостояние'),e.push('ФильтрСтатистикаПериод');if('js!SBIS3.EDO.StatisticsReportByPhase'===t||'js!SBIS3.EDO.StatisticsReportTransitions'===t||'js!SBIS3.EDO.ReportStatResult'===t||'js!SBIS3.EDO.PeriodStatReport'===t||'js!SBIS3.EDO.PeriodStatReportNew'===t)e.push('Регламент'),e.push('ФильтрФаза'),e.push('ИдРегламента'),e.push('ФильтрИдФазы');return e;},copyFilters:function(t,e,r){for(var a=0;a<r.length;a++)if(void 0!==t[r[a]])e[r[a]]=t[r[a]];if(e['ФильтрВнешняяСтатистика']&&e['ФильтрПоКраткомуСостоянию'])delete e['ФильтрПоКраткомуСостоянию'];},compareFilters:function(t,e,r){for(var a=false,n=0;n<r.length;n++)if(t[r[n]]!==e[r[n]])a=true;return a;},getOurOrgCountByTemplate:function(t){if('js!SBIS3.EDO.StatIncomingEvents'===t||'js!SBIS3.EDO.StatOutgoingEvents'===t||'СтатистикаСкладских'===t||'js!SBIS3.EDO.StatOutgoing'===t||'js!SBIS3.EDO.StatIncoming'===t)return i('НашаОрганизация').call('КоличествоПолное',{'СФилиалами':true},i.RETURN_TYPE_ASIS).addCallback(function(t){g.setParam('КоличествоНашихОрганизацийСФилиалами',t.toString());});else return g.removeParam('КоличествоНашихОрганизацийСФилиалами'),new c().callback();},getCurrentStatBrowser:function(){var e=t.ControlStorage.containsByName('ШаблонСтатистики')?t.ControlStorage.getByName('ШаблонСтатистики').getCurrentTemplateName():void 0;if(!e)return null;if('СтатистикаСкладских'===e&&t.ControlStorage.containsByName('ШаблонСтатистикаИсхВхСклад'))e=t.ControlStorage.getByName('ШаблонСтатистикаИсхВхСклад').getCurrentTemplateName();if(-1!==e.indexOf('js!'))e=e.slice(e.lastIndexOf('.')+1);if(!t.ControlStorage.containsByName(e)){for(var r=t.ControlStorage.getByName('ШаблонСтатистики')?t.ControlStorage.getByName('ШаблонСтатистики').getChildControls():[],a=null,i=0;i<r.length;i++)if(n.instanceOfModule(r[i],'Deprecated/Controls/TableView/TableView'))a=r[i];return a;}else return t.ControlStorage.getByName(e);},addStringFilter:function(t,e){var a=r.clone(t);for(var n in e)if(e.hasOwnProperty(n))a[n+'Текст']=e[n];return a;},generateHref:function(t,e,r,a,n,i,o,s,l){var g=t.find('.phase-report-count'),u=d.generateHrefValue(e,r,a,n,i,o,false,s,l);if(d.changeSpanToA(g,u),!i){var c=t.find('.phase-report-overdue'),S=d.generateHrefValue(e,r,a,n,null,null,false,s,l);d.changeSpanToA(c,S);}},generateHrefValue:function(t,e,r,a,n,i,l,g,u){function c(t,e){if(e in t&&t[e])if('string'===typeof t[e])return t[e];else return t[e].toSQL();else return null;}var S=[],f=[],m=u?d.addStringFilter(t.getQuery(),u):t.getQuery();if(e='Название'===e?'Итого':e,n='Название'===n?'Итого':n,!n)S=r.get(e).length>=5?r.get(e).split(','):r.get(e),f='Итого'===e||'Название'===e||'ПросроченныхПоСроку'===e||'УникальныхДокументов'===e?void 0:t.phases.getPhaseIdList(e);else f=m['ФильтрИдФазы'];var p=n?r.get(n)[0]:S[0],B=n?r.get(n)[1]:S[1],C=n?0:S[2],v=a?m['Раздел']?[m['Раздел']]:null:r.get('@Лицо')?[parseInt(r.get('@Лицо'),10)]:null,h=a?true:r.get('Раздел@'),y=a?m['Раздел']?m['Раздел']:'Всего':r.hasColumn('Название')&&r.get('Название')?s.escapeHtml(r.get('Название')):null,O=g?true:m['ФильтрПросроченные'],F={face:v,isDivision:h,phaseId:f,count:p,overdue:B,overdue_h:C,title:y,fromBrowser:t.getName(),filter:{}};for(var I in m)if(m.hasOwnProperty(I))F.filter[I]=m[I];return F.filter['ИдРегламента']=m['ИдРегламента'],F.filter['ФильтрИдФазы']=m['ИдРегламента']&&f?m['ИдРегламента']+':'+f:f,F.filter['ФильтрДатаС']=c(m,'ФильтрДатаС'),F.filter['ФильтрДатаП']=c(m,'ФильтрДатаП'),F.filter['ФильтрСрокДата']=m['ФильтрСрокДата']?new Date(m['ФильтрСрокДата']).toSQL():void 0,F.filter['ФильтрПросроченные']=O,F.filter['ФильтрНераспределенные']=r.hasColumn('Название')&&'Нераспределенные'===r.get('Название')?true:false,F.filter['ФильтрУдаленные']=false,F.filter['ФильтрСтатистикаПериод']=m['ФильтрСтатистикаПериод'],F.filter['ФильтрНеПустойПереход']='StatisticsReportTransitionsBrowser'===t.getName()?true:void 0,F.filter['ФильтрИдПерехода']=i,delete F.filter['ФильтрАвторИлиОтветственный'],delete F.filter['ФильтрАвторИлиОтвОтдел'],encodeURIComponent(o.serializeURLData(F));},changeSpanToA:function(t,e){var r=$('<a class="phase-report-link"></a>').attr({href:e,target:'_blank'});t.attr('class','phase-report-link'),t.attr('params',e);},onItemClick:function(t,e,a,n){var i=$(n).closest('td')[0];if(i&&$(i).hasClass('Название')&&a.get('Раздел@'));else if(t.setResult(false),'SPAN'===n.nodeName){var o=r.clone(this.getFilter()),s=i.cellIndex,l=this._options.columns[s],g=-1===$.inArray('edo-statistics-overdue-count',n.classList)?false:true,u=n.attributes['param_value']?n.attributes['param_value'].value:null,c=l.field,S=l.templateBinding.filterName,f,m=this.getParentByClass('SBIS3.EDO.StatEDOBrowserPP')?this.getParentByClass('SBIS3.EDO.StatEDOBrowserPP').getParent():null;if(S&&u)if(-1===u||'-1'===u)if(!o['ИдРегламента'])o['ФильтрПрочиеРегламенты']=m?m._options.other_elements_id:null;else o['ФильтрПрочиеФазы']=m?m._options.other_elements_id:null;else o[S]='ФильтрИдФазы'===S?o['ИдРегламента']+':'+u:u,o[S+'Текст']=l.title;if(a.get('Раздел'))o['Раздел']=a.get('Раздел');f=d.generateHrefParamsNew(o,a,false,g,null,c),d.goToPhasesWork(t,f,this.getParentByClass('SBIS3.EDO.StatTemplateNew'),this);}},getFilterPeriod:function(t){switch(t){case'НаНачало':case'НаНачалоПросрочено':return'На начало';case'Получено':return'Получено';case'Выполнено':case'ВыполненоПросрочено':return'Выполнено';case'Осталось':case'ОсталосьПросрочено':return'Осталось';default:return'На начало';}},getStringFilterFromStatReport:function(t){var e=['ФильтрСрокДата','ФильтрЛицо1','ФильтрОтветственноеЛицо','ФильтрВладелец','ФильтрСписокРассылки','ФильтрПриоритет','ФильтрПоВехе','ФильтрИдФазы','ИдРегламента','ФильтрПереход','ФильтрПометкиВкл','ФильтрПометкиИскл'],r={},a=t&&t.getLinkedContext(),n=a&&a.getValue('FilterPeriodStatReportNew'),i=n&&n['caption'],o=n&&n['button'];if(i){for(var s in e)if(e.hasOwnProperty(s)&&e[s]in i)r[e[s]]=i[e[s]];if(o)r['ФильтрДатаПериод']=d.getFilterDatePeriodStringFromValues(i['ФильтрДатаПериод'],o['ФильтрДатаС'],o['ФильтрДатаП']);if(a)a.setValue('filtersForNewDetalization',r);}},onItemClickPeriod:function(t,e,a,n){var i=$(n).closest('td');if(i.hasClass('Название')&&a.get('Раздел@'));else if(t.setResult(false),'SPAN'===n.nodeName){var o=r.clone(this.getFilter()),s=-1===$.inArray('edo-statistics-overdue-count',n.classList)?false:true,l=i.index(),g=l&&this._options.columns[l].field,u=null,c=null,S;if(g){var f=g;if(-1!==f.indexOf('Просрочено'))c=a.get(f),f=f.replace('Просрочено',''),u=a.get(f);else u=a.get(f),f+='Просрочено',c=a.get(f);}if(a.get('Раздел'))o['Раздел']=a.get('Раздел');S=d.generateHrefParamsNew(o,a,false,s,null,g,u,c,d.getFilterPeriod(g));var m=$(n).closest('div.statistics-browser'),p=m.length>0?m.wsControl().getParent().getParent():null;d.getStringFilterFromStatReport(this),d.goToPhasesWork(t,S,p,this);}},onCaptionClickPeriod:function(t){var e=$(t.target).closest('div.statistics-browser').length>0?$(t.target).closest('div.statistics-browser').wsControl().getChildControlByName('browserView'):null,a=e&&r.clone(e.getFilter()),n=$(t.target).closest('div.statistics-browser').wsControl().getParentByClass('SBIS3.EDO.StatTemplate');a['ФильтрСтатистикаПериод']=$(t.target).text().trim(),d.goToInnerStatReport('js!SBIS3.EDO.StatisticsInnerCurrent',a,n);},goToPhasesWork:function(e,r,a,n){var o=e.target?$(e.target).closest('div.statistics-browser'):e._target.getContainer().closest('div.statistics-browser'),s=o.attr('name'),g=n||t.ControlStorage.containsByName(s)&&t.ControlStorage.getByName(s),S=o.length>0?o.wsControl().getParent().getParent():a,f=new c(),d=u.createContext(f);d.setValue('phaseReportParams',r);var m=g.getParentByClass('SBIS3.EDO.StatTemplate')||g.getParentByClass('SBIS3.EDO.StatTemplateNew');if(!m){var p=g.getTopParent&&g.getTopParent(),B=p&&p.getOpener&&p.getOpener();m=B.getParentByClass&&(B.getParentByClass('SBIS3.EDO.StatTemplate')||B.getParentByClass('SBIS3.EDO.StatTemplateNew'));}var C=m?m._options.docType:'Документ';if(d.setValue('docTypeString',C),i('ПользовательскиеПараметры').call('ПолучитьЗначение',{'Путь':'ДетализацияСтатистикиСортировка'},i.RETURN_TYPE_ASIS).addCallback(function(t){var e=(t||'').split('$$');if(2==e.length)d.setValue('phaseReportSortReceived',e[0]||'DESC'),d.setValue('phaseReportSortSrok',e[1]||'');else d.setValue('phaseReportSortReceived','DESC'),d.setValue('phaseReportSortSrok','');l.showFloatArea({name:'Детализация этапов статистики',opener:S,template:'js!SBIS3.EDO.DetalizationEvents',autoCloseOnHide:true,className:'ws-float-area__block-layout',isStack:true,componentOptions:{statTemplateOptions:m&&m._options||{},fromBrowser:g&&g.getName(),className:'ws-float-area__block-layout',personId:'userPhotoData'},context:d,handlers:{onDestroy:function(){f.callback();}}});}),e.target)e.stopImmediatePropagation();},statReportItemsSortMethod:function(t,e){var r=t&&t.item&&t.item.isNode&&t.item.isNode(),a=e&&e.item&&e.item.isNode&&e.item.isNode();if(r===a&&r)return t.index>e.index?1:-1;else{var n=t&&t.item&&t.item.getContents&&t.item.getContents(),i=e&&e.item&&e.item.getContents&&e.item.getContents(),o=n&&n.get('Руководитель'),s=i&&i.get('Руководитель'),l=n&&n.get('@Лицо')&&-1===n.get('@Лицо'),g=i&&i.get('@Лицо')&&-1===i.get('@Лицо');if(o||s)return o?-1:1;else if(l||g)return l?-1:1;else if(r||a)return r?-1:1;else return t.index>e.index?1:-1;}},isEmptyObject:function(t){var e;for(e in t)if(t.hasOwnProperty(e))return false;return true;},goToOtherRegls:function(e,a,n){var i=a?e._target.getParentByClass('SBIS3.EDO.StatEDOBrowserPP'):$(e.target).closest('div.statistics-browser').wsControl(),o=a?i.getView():t.ControlStorage.getByName('StatisticsInnerCurrentBrowser'),s=a?r.clone(o.getFilter()):o.getQuery(),g=a?o.getDataSet().getMetaData().results:o.getRecordSet().getResults(),u=n._options.other_elements,c=n._options.other_elements_id,S={onInit:function(t){this.getLinkedContext().setValue('Итоги',g),this.getLinkedContext().setValue('brw_filter',s),this.getLinkedContext().setValue('isReglaments',!s['ИдРегламента']),this.getLinkedContext().setValue('stringFilter',a?i.getLinkedContext().getValue('filter'):o.stringFilter),this.getLinkedContext().setValue('isNewDataStructure',a),this.getLinkedContext().setValue('other_elements',u),this.getLinkedContext().setValue('other_elements_id',c);}};if(l.showFloatArea({name:'ПрочиеРегламентыСтатистики',opener:i,template:'js!SBIS3.EDO.OtherReglaments',autoCloseOnHide:true,isStack:true,handlers:S}),!a)e.stopImmediatePropagation();},goToMainInnerStatReport:function(e,r,a,n){var i=null;if(d.removeStatPrintButton(),i&&'js!SBIS3.BUH.ExpRepStatMain'===i.get('ШаблонСтатистики')){if(r.setTemplate('js!SBIS3.BUH.ExpRepStatMain'),t.ControlStorage.containsByName('ЗакладкиСтатистики'))t.ControlStorage.getByName('PathTab').tab=t.ControlStorage.getByName('ЗакладкиСтатистики');}else if(i&&'СтатистикаВнутренних'===i.get('ШаблонСтатистики')){if(t.ControlStorage.containsByName('ПанельСФильтромСтат'))t.ControlStorage.getByName('ПанельСФильтромСтат').show();d.updateStatTemplate('СтатистикаВнутренних',true,false);}else if(r){var o=r.getLinkedContext(),s,l=n?n:a.getQuery(),g=e,u=o.getValue('ТекущееПодразделение');if(!e)if(l['ФильтрСтатистикаТекущие']||l['ФильтрВнешняяСтатистика'])g='js!SBIS3.EDO.StatisticsInnerCurrent';else if(l['ФильтрСтатистикаПериод'])g='js!SBIS3.EDO.StatisticsInnerCurrent';else g='js!SBIS3.EDO.PeriodStatReport';s=d.getStatFiltersList(g),o.setContextData(null);for(var c=0;c<s.length;c++)o.setValue(s[c],l[s[c]]);return o.setValue('ТекущееПодразделение',u),void r.setTemplate(g);}},getStatFilterButton:function(){var e=t.ControlStorage.getByName('ШаблонСтатистики');if(!e||!e.hasChildControlByName('ПанельСФильтромСтат'))return null;if(e.hasChildControlByName('ПанельСФильтромСтат')&&n.instanceOfModule(e.getChildControlByName('ПанельСФильтромСтат'),'SBIS3.EDO.FilterController'))return e.getChildControlByName('ПанельСФильтромСтат').getFilterButton();else return e.getChildControlByName('ПанельСФильтромСтат');},setStatePathFilter:function(e){if(t.ControlStorage.containsByName('ПанельСФильтром')&&n.instanceOfModule(t.ControlStorage.getByName('ПанельСФильтром'),'SBIS3.EDO.FilterController'))if(t.ControlStorage.getByName('ПанельСФильтром').getPathFilter())t.ControlStorage.getByName('ПанельСФильтром').getPathFilter().setFilter('ФильтрСостояние',e['ФильтрСостояние'],true),t.ControlStorage.getByName('ПанельСФильтром').getPathFilter().setFilter('ФильтрВладелец',e['ФильтрВладелец'],true);},columnWidth:function(t){for(var e=t.split(' '),r='',a=0;a<e.length;a++)if(r.length<e[a].length)r=e[a];return d.textWidth(r,'12px')+15;},textWidth:function(t,e){var r=$('<span>');r.text(t),r.css('font-size',e),r.css('font-family','\'TensorFont Regular\', \'TensorFont\''),r.hide(),$('body').append(r);var a=r.width();return r.remove(),a;},formPathSelectorNodes:function(t,e){var r=[{title:e,id:null}],a=t.getPath();if(a.length>1)r=r.concat(a);t.setRootNodeView('icon'),t.setPath(r),t.getPath()[0].id=-1000,t.getContainer().find('span').first().attr({title:'К выбору отчета'});},declOfNum:function(t,e){var r=[2,0,1,1,1,2];return e[t%1!==0?0:t%100>4&&t%100<20?2:r[t%10<5?t%10:5]];},saveLastStatisticsFilter:function(t,e){var a=new c(),n=r.clone(t);if(n['ФильтрДатаП']&&'object'==typeof n['ФильтрДатаП']&&'toSQL'in n['ФильтрДатаП'])n['ФильтрДатаП']=n['ФильтрДатаП'].toSQL();if(n['ФильтрДатаС']&&'object'==typeof n['ФильтрДатаС']&&'toSQL'in n['ФильтрДатаС'])n['ФильтрДатаС']=n['ФильтрДатаС'].toSQL();if(n['ФильтрСрокДата']&&'object'==typeof n['ФильтрСрокДата']&&'toSQL'in n['ФильтрСрокДата'])n['ФильтрСрокДата']=n['ФильтрСрокДата'].toSQL();n['ФильтрСортировкаКолонок']=null;var i=[{viewFilter:n,isActiveFilter:true}];if(e.exclude_filters)for(var o in e.exclude_filters)if(e.exclude_filters.hasOwnProperty(o))if(n[o]===e.exclude_filters[o])delete n[o];return e.setHistory(i,true),a.callback(e.isNowSaving());},generateHrefParamsNew:function(t,e,r,a,n,i,l,g,u,c){function S(t,e){if(e in t&&t[e])if('string'===typeof t[e])return t[e];else return t[e].toSQL();else return null;}function f(t,e,r,a){if(r&&'Просрочено'!==r&&'Название'!==r)return t.has(r)&&t.get(r)?(e?t.get(r).toString().split(','):t.get(r))[a]:null;else return t.has('Итого')&&t.get('Итого')?(e?t.get('Итого').toString().split(','):t.get('Итого'))[a]:null;}var d=r?t['Раздел']?[t['Раздел']]:null:e.has('@Лицо')&&e.get('@Лицо')?[parseInt(e.get('@Лицо'),10)]:null,m=r?t['Раздел']?t['Раздел']:'Всего':e.has('Название')&&e.get('Название')?s.escapeHtml(e.get('Название')):null,p=r?true:e.has('Раздел@')&&e.get('Раздел@')?e.get('Раздел@'):null,B={face:d,count:!!l||0===l?l:f(e,r,i,0),overdue:!!g||0===g?g:f(e,r,i,1),title:'other_elements'===i?r?'Прочих':'Всего':m,isDivision:'other_elements'===i?r?false:p:p,filter:{}};for(var C in t)if(t.hasOwnProperty(C))B.filter[C]=t[C];return B.filter['ИдРегламента']=t['ИдРегламента']?t['ИдРегламента']:n,B.filter['ФильтрДатаС']=S(t,'ФильтрДатаС'),B.filter['ФильтрДатаП']=S(t,'ФильтрДатаП'),B.filter['ФильтрСрокДата']=t['ФильтрСрокДата']?new Date(t['ФильтрСрокДата']).toSQL():void 0,B.filter['ФильтрПросроченные']=a,B.filter['ФильтрНераспределенные']=e.has('Название')&&'Нераспределенные'===e.get('Название')?true:false,B.filter['ФильтрУдаленные']=false,B.filter['ФильтрСтатистикаПериод']=u?u:t['ФильтрСтатистикаПериод'],B.filter['ФильтрНеПустойПереход']=c&&'StatisticsReportTransitionsBrowser'===c.getName()?true:void 0,encodeURIComponent(o.serializeURLData(B));},getFilterStateByName:function(t){switch(t){case'all_docs':return;case'send_docs':return'2,3,4,7,9';case'deliv_docs':return'4,7,9';case'recv_docs':case'recv_docs_in':return'7';case'decl_docs':case'decl_docs_in':return'9';case'on_checking_docs':return'4';case'no_deliv_docs':return'2,3';case'regl_docs':case'proc_docs':case'no_send_docs':return'10';case'kon_del_docs':case'kon_del_docs_in':return'19,20,22';case'error_docs':return'6';case'rough_docs':return'0,1';default:return;}}};});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.Filters", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".filter_title{font-size:18px!important;font-family:Tahoma!important;color:#000!important}.contragent_field_link .ws-FieldLink__link{float:left;margin-left:0;margin-top:-1px;text-align:left;width:90px}"));head.appendChild(style);});}
define('js!SBIS3.EDO.Filters',['Lib/Control/Control','Core/core-instance','Deprecated/Controls/TemplatedArea/TemplatedArea','Core/helpers/string-helpers','Core/Context','js!SBIS3.EDO.FilterHandlers','js!SBIS3.EDO.StatFuncs','js!SBIS3.EDO.doc_filters','css!SBIS3.EDO.Filters','Elektronnyj_dokumentooborot_localization'],function(e,t,r,l,a,n,i,o){'use strict';return{renderPhaseTitle:function(e,t){return l.escapeHtml(e.get('Название'));},onChangeFilterPeriod:function(){var e=this;this.getParent().waitChildControlByName('ФильтрДат').addCallback(function(t){if('Период'===e.getValue())t.show();else t.setRange(null,null),t.validate(),t.hide();var r=e.getValue(),l=e.getLinkedContext();if(l['ФильтрДатаПериод']='Все'===r||'Период'===r?null:r,e.getLinkedContext().setValue('ПараметрыФильтра',l),'Период'!==r)l.setValue('ФильтрДатаС',null),l.setValue('ФильтрДатаП',null);else u(l,this);return l.setValue('ФильтрДатаНеПоУмолчанию','1'),t;});},onChangePeriodDates:function(e,t,r,l){var a=(l?l:this).getLinkedContext(),n=a.getValue('ПараметрыФильтра');if(n)n['ФильтрДатаС']=t?t.toSQL():null,n['ФильтрДатаП']=r?r.toSQL():null,n['ФильтрДатаНеПоУмолчанию']='1',a.setValue('ПараметрыФильтра',n);},onVisualizeKontragentLink:function(e,t){var r=t.get('Название');if(null===r||void 0===r||0===r.length)e.setResult('название не указано');},periodAndDateValidation:function(){if(!this.getTopParent().hasChildControlByName('ФильтрДатаПериод'))return true;if('Период'===this.getTopParent().getChildControlByName('ФильтрДатаПериод').getValue()&&!this.getValue())return rk('Заполните период!');return true;},onResetFiltersWithFast:function(e,t){var r;if(o.getCurrentBrowser)r=o.getCurrentBrowser();else r=this.getBrowser();var l=r?r.getSelection(true):'',a=[];if(l.length)for(var n=0;n<l.length;n++)if(l[n])a.push(l[n].getKey());if(a.length)r.clearSelection(a);if(t){var i=this.getParent().getPathFilter().getQuery();this.getLinkedContext().setValue('EDOFastfiltersToRestore',i);}},onFilterChange:function(e,t,r){g(this,t,r);},onFilterReestrChange:function(e,t,r){$(this.getContainer()).removeClass('autotests-textready'),g(this,t,r);},onSetQueryBrowser:function(e,r){if(t.instanceOfModule(this.getParent(),'SBIS3.EDO.FilterController')||t.instanceOfModule(this.getParent(),'Deprecated/Controls/FilterController/FilterController'))if(this.getParent().getPathFilter()){var l=this.getParent().getPathFilter(),a=l.getQuery();for(var n in a)if(a.hasOwnProperty(n))l.setFilter(n,r[n],true);}},onRestoreFilter:function(t,r){if(r['ФильтрОтветственноеЛицо']&&-2===r['ФильтрОтветственноеЛицо'])r['ФильтрОтветственноеЛицо']=null;if(e.ControlStorage.containsByName('ФильтрДатаПериод')&&'Период'===r['ФильтрДатаПериод']&&e.ControlStorage.containsByName('ФильтрДат')&&r['ФильтрДатаС']&&!r['ФильтрДатаП'])u(r,this);},onFilterPanelBeforeShow:function(){var e=this.getFloatArea().hasChildControlByName('ФильтрОтветственноеЛицо')?this.getFloatArea().getChildControlByName('ФильтрОтветственноеЛицо'):null,t=this.getFloatArea().hasChildControlByName('ФильтрСостояние')?this.getFloatArea().getChildControlByName('ФильтрСостояние'):null;if(e)if(!t||-2!==t.getValue())e.show();else e.hide();var r=this.getFloatArea().hasChildControlByName('ФильтрЛицо1')?this.getFloatArea().getChildControlByName('ФильтрЛицо1'):null,l=this.getFloatArea().hasChildControlByName('ФильтрСостояние')?this.getFloatArea().getChildControlByName('ФильтрСостояние'):null;if(r)r.setEnabled(true);if(l)l.setEnabled(true);n.new_filter_button_styles(this);},renderFilterDate:function(e,t,r){if('За период'===r['ФильтрДатаПериод'])u(t,this),r['ФильтрДатаПериод']+=r['ФильтрДат']?' '+r['ФильтрДат']:'',delete r['ФильтрДат'];},saveFilterIntoContext:function(e,t,l){if(this.getBrowser()){var a='ШаблонСтатистикаИсхВхСклад'===this.getBrowser().getParentByClass(r).getName()?this.getBrowser().getParentByClass(r).getParentByClass(r):this.getBrowser().getParentByClass(r),n=a.getLinkedContext();delete t['_Итоги'],delete t['Раздел'],delete t['Разворот'],delete t['ПутьКУзлу'],delete t['ВидДерева'],delete t['HierarchyField'],delete t['ЗаголовокИерархии'];var o=i.getStatFiltersList(a.getCurrentTemplateName()),s={'ТипДокумента.Название':n.getValue('ТипДокумента.Название'),'ТипРаздела':n.getValue('ТипРаздела'),'ТекущееПодразделение':n.getValue('ТекущееПодразделение')};n.setContextData(s);for(var u=0;u<o.length;u++)n.setValue(o[u],t[o[u]]);}},generateBrowserFilterParameterName:function(e,t){var r;if(null!==e&&void 0!==e)if(r='ФильтрБраузера_\''+e+'\'',null!==t&&void 0!==t)r+='_ТД'+t;return r;}};function s(e,t,r){if(null!==r){var l=e[t];if(e[t]=r,'ФильтрПоказатель'===t)return playPokazatelFiltr(r),false;if('ФильтрЗначимость'===t)return playZnachFiltr(r),false;if(l===r)return false;else return true;}else{if(void 0===e[t])return false;if(0===e[t])return delete e[t],false;if(delete e[t],'ФильтрПоказатель'===t)return playPokazatelFiltr(r),false;if('ФильтрЗначимость'===t)return playZnachFiltr(r),false;return true;}}function u(t,r){var l=r&&r.getFloatArea&&r.getFloatArea()?r.getFloatArea().getChildControlByName('ФильтрДат').getValue():e.ControlStorage.getByName('ФильтрДат').getValue(),n=new Date(),i=n.getFullYear(),o=n.getMonth()+1,s=[new Date(i,0).toDateString().substr(4,6),new Date(i,3).toDateString().substr(4,6),new Date(i,6).toDateString().substr(4,6),new Date(i,9).toDateString().substr(4,6)],u=[new Date(i,0),new Date(i,3),new Date(i,6),new Date(i,9)],g=t instanceof a;if(!l&&void 0!==t['ФильтрДатаС']&&void 0!==t['ФильтрДатаП'])l=[t['ФильтрДатаС'],t['ФильтрДатаП']];if(!l){var f=u[Math.ceil(4*o/12)-1];if(g)t.setValue('ФильтрДатаС',f);else t['ФильтрДатаС']=f;}}function g(e,t,r){var l=e;if(!l.getBrowser())return;var i=l.getLinkedContext().getValue('EDOFastfiltersToRestore');if(i){l.getLinkedContext().setValue('EDOFastfiltersToRestore',void 0);for(var o in i)if(i.hasOwnProperty(o))t[o]=i[o];}if(t['ФильтрВладелец']&&'Все'!=t['ФильтрВладелец'])delete t['ФильтрОтветственноеЛицо'],delete t['ФильтрАвтор'],delete t['ФильтрНезакрепленные'];n.addFiltersSelected(l,t);var s=t['ФильтрУдаленные'],g=t['ФильтрНезакрепленные'];if('За период'===r['ФильтрДатаПериод'])u(t,e),r['ФильтрДатаПериод']+=r['ФильтрДат']?' '+r['ФильтрДат']:'';if(delete r['ФильтрДат'],r['ФильтрДоставка']&&t['ФильтрДоставка']>-1)r['ФильтрДоставка']='Доставлено '+r['ФильтрДоставка'];var f=t['ФильтрСостояние']?t['ФильтрСостояние']:t['ФильтрПоКраткомуСостоянию'];if(f){if(f=f.toString(),'-2'===f){if(delete t['ФильтрОтветственноеЛицо'],t['ФильтрНезакрепленные']=-2,r['ФильтрОтветственноеЛицо'])delete r['ФильтрОтветственноеЛицо'];if(l.getFloatArea().hasChildControlByName('ФильтрОтветственноеЛицо'))l.getFloatArea().getChildControlByName('ФильтрОтветственноеЛицо').setValue(null),l.getFloatArea().getChildControlByName('ФильтрОтветственноеЛицо').setEnabled(false);}else{if(t['ФильтрНезакрепленные']=null,t['ФильтрОтветственноеЛицо']&&-2==t['ФильтрОтветственноеЛицо'])if(delete t['ФильтрОтветственноеЛицо'],r['ФильтрОтветственноеЛицо'])delete r['ФильтрОтветственноеЛицо'];if(l.getFloatArea().hasChildControlByName('ФильтрОтветственноеЛицо'))l.getFloatArea().getChildControlByName('ФильтрОтветственноеЛицо').setEnabled(true);}if('-3'===f)t['ФильтрУдаленные']=true;else t['ФильтрУдаленные']=false;}else t['ФильтрУдаленные']=false;if(s)t['ФильтрУдаленные']=s;if(g&&'ПанельСФильтромСтат'!==l.getParent().getName())t['ФильтрНезакрепленные']=g;if('Истекает'===t['ФильтрСрок'])r['ФильтрСрок']='Истекает '+r['ФильтрСрокЗначение'],delete r['ФильтрСрокЗначение'];if(t['ФильтрОтветственноеЛицо']||t['ФильтрАвтор'])t['ФильтрАвторИлиОтвОтдел']=-1,t['ФильтрАвторИлиОтветственный']=-1,t['ФильтрВладелец']='Все';else if(!t['ФильтрВладелец']||'Все'===t['ФильтрВладелец'])t['ФильтрАвторИлиОтвОтдел']=-1,t['ФильтрАвторИлиОтветственный']=-1;if(!t['ФильтрКонкретныйИсполнитель'])t['ФильтрКонкретныйИсполнительID']=void 0;else switch(t['ФильтрКонкретныйИсполнитель']){case'На мне':t['ФильтрКонкретныйИсполнительID']=a.global.getValue('PrivatePerson');break;case'На моем отделе':t['ФильтрКонкретныйИсполнительID']=a.global.getValue('StructureCompany');break;case'Без исполнителя':t['ФильтрКонкретныйИсполнительID']=-1;}if('-1'===t['ФильтрСостояние'])delete t['ФильтрСостояние'];}});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.FieldLinksCfg", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo_field_link{height:24px;left:12px;width:346px!important}.edo_field_link .ws-FieldLink__link{float:left;margin-left:0;margin-top:-1px;text-align:right;line-height:32px}.edo_field_link .ws-FieldLink__inputContainer{display:inline-block;position:relative;text-align:left;padding-top:0!important;top:4px}.edo_field_link .input-string-field{margin-top:-1px}.edo_field_link .ws-FieldLink__delete-allLinks{margin-top:7px}"));head.appendChild(style);});}
define('js!SBIS3.EDO.FieldLinksCfg',['js!SBIS3.EDO.Filters','js!SBIS3.EDO.ScopeFilters','optional!browser!js!SBIS3.Contragents.AddresseeChoice/resources/handlers','css!SBIS3.EDO.FieldLinksCfg','i18n!SBIS3.EDO.FieldLinksCfg','Elektronnyj_dokumentooborot_localization'],function(e,t,i){'use strict';return{getCfgByName:function(l){return{'ФильтрЛицо1':{title:'ФильтрЛицо1',config:['js!SBIS3.Contragents.AddresseeChoice',{title:rk('Получатель'),name:'ФильтрЛицо1',readLink:false,className:'edo_field_link',linkName:'ФильтрЛицо1',linkTextAlign:'top',labelPosition:'inline',canNotBeEmpty:false,multiSelect:true,returnFolders:true,contragentChoice:true,suggestSettings:{tooltipInside:true,inputTooltip:rk('укажите название, ИНН или КПП'),display:{columns:[{className:'ContragentChoice-topAlign',field:'Название',title:rk('Название'),width:'130'},{className:'ContragentChoice-topAlign',field:'ИНН',title:rk('ИНН/КПП'),width:'94',render:i.innKppColumnRender,fixedSize:true}],showHead:true},browserWidth:'232'},element:$('<div></div>')}]},'ТипДокументаВД':{title:'ТипДокументаВД',config:['Deprecated/Controls/FieldLink/FieldLink',{title:rk('Тип документа'),name:'ТипДокументаВД',className:'edo_field_link',renderStyle:'inputAndLink',readLink:false,selectionType:'all',allowChangeEnable:false,isRelative:true,isRecordPath:false,selectRecordsMode:'newFloatArea',linkName:'ТипДокументаВД',linkedDisplayField:'Название',multiSelect:true,dictionaries:[{name:'Выбор типа документа',keyField:'ТипДокумента',template:'js!SBIS3.EDO.TypeExternalDocumentLV',editMode:'newFloatArea',readMethodName:'Документ.СписокТиповВДДляФильтраИзИстории',objectName:'Документ'}],suggestSettings:{keyField:'ТипДокумента',browserWidth:'354',rowsCount:'10',delay:'500',filterParams:{'ТипРеестра':''},dataSource:{readerParams:{queryName:'СписокТиповВДДляФильтра',linkedObject:'Документ'}},display:{columns:[{field:'Название',title:rk('Название'),width:'130'}]},processField:['Название'],filter:['Название']},element:$('<div></div>')}]},'ФильтрОтветственноеЛицо':{title:'ФильтрОтветственноеЛицо',config:['js!SBIS3.Staff.Choice',{title:rk('Ответственный'),name:'ФильтрОтветственноеЛицо',readLink:false,className:'edo_field_link edo_field_link_resp',linkName:'ФильтрОтветственноеЛицо',nameKeyLink:'ФильтрОтветственноеЛицо',multiselect:true,showOtherEmployees:true,organization:-2,element:$('<div></div>'),handlers:{onInit:t.onEmployeeFieldInit,onValueChange:t.onEmployeeFieldValueChange}}]},'ФильтрДокументНашаОрганизация':{title:'ФильтрДокументНашаОрганизация',config:['Deprecated/Controls/FieldLink/FieldLink',{autoWidth:true,width:'100%',className:'edo_field_link',height:'100%',name:'ФильтрДокументНашаОрганизация',readLink:false,tooltip:rk('Выбрать из справочника'),extendedTooltip:false,linkName:'ФильтрДокументНашаОрганизация',linkedDisplayField:'Название',owner:'ФильтрДокументНашаОрганизация.Название',title:rk('Организация'),isRecordPath:false,renderStyle:'inputAndLink',selectRecordsMode:'newFloatArea',multiSelect:true,withAffiliates:true,dictionaries:[{name:'Наши организации',template:'js!SBIS3.Contragents.ListOurOrganizationsFillial',objectName:'НашаОрганизация',formatMethod:'',keyField:'Лицо',editMode:'newFloatArea'}],element:$('<div></div>'),handlers:{onInit:t.onOurOrgFieldInit,onVisualizeLink:e.onVisualizeKontragentLink,onBeforeDictionaryOpen:t.onBeforeDictionaryOpenOurOrgField,onValueChange:t.onEmployeeFieldValueChange},suggestSettings:{tooltipInside:true,inputTooltip:rk('укажите название, ИНН или КПП'),browserWidth:'214',browserHeight:'72',delay:'500',autoShow:false,filterParams:{'СтрокаПоиска':{fieldName:'ФильтрДокументНашаОрганизация.Название'}},dataSource:{readerType:'ReaderUnifiedSBIS',readerParams:{queryName:'Список',linkedObject:'НашаОрганизация',createMethodName:'Создать',readMethodName:'Прочитать',updateMethodName:'Записать',destroyMethodName:'Удалить'}},filter:['Маска'],processField:['Название'],display:{columns:[{title:rk('Название'),width:126,fixedSize:true},{className:'ContragentChoice-topAlign',field:'ИНН',title:rk('ИНН/КПП'),width:'94',render:i.innKppColumnRender,fixedSize:true}],cutLongRows:false},keyField:'@Лицо'}}]},'ФильтрОтправитель':{},'ФильтрПолучатель':{},'ФильтрИсполнительСобытия':{},'ФильтрСписокРассылки':{},'Регламент':{title:'Регламент',config:[]},'ИдРегламента':{title:'ИдРегламента',config:[]},'ФильтрИдФазы':{title:'ФильтрИдФазы',config:[]},'ФильтрФаза':{title:'ФильтрФаза',config:[]},'ФильтрПереход':{title:'ФильтрПереход',config:[]},'ФильтрАвтор':{},'ФильтрСрокДата':{title:'ФильтрСрокДата',config:['js!SBIS3.EDO.FilterLimitation',{name:'ФильтрСрокДата',className:'edo_field_link'}]},'ФильтрПоВехе':{title:'ФильтрПоВехе',titleWidth:91,config:['Deprecated/Controls/FieldLink/FieldLink',{autoWidth:true,width:'100%',height:'100%',className:'edo_field_link',name:'ФильтрПоВехе',readLink:false,extendedTooltip:false,linkName:'ФильтрПоВехе',linkedDisplayField:'ДокументРасширение.Название',owner:'Веха.Название',title:rk('Веха'),isRecordPath:false,renderStyle:'inputAndLink',multiSelect:true,selectRecordsMode:'newFloatArea',dictionaries:[{name:'Веха',template:'js!SBIS3.Milestones.MilestoneSelectorDialog',objectName:'Веха',readOnly:true,editMode:'newFloatArea',selectionType:'all',keyField:'@Документ'}],suggestSettings:{tooltipInside:true,inputTooltip:rk('укажите веху'),browserWidth:'282',browserHeight:'72',delay:'500',autoShow:false,filterParams:{'ФильтрПоМаске':{fieldName:'ДокументРасширение.Название'},'ПолучитьПлоскийСписок':true},dataSource:{readerType:'ReaderUnifiedSBIS',readerParams:{queryName:'СписокPy',linkedObject:'Веха',createMethodName:'Создать',readMethodName:'Прочитать',updateMethodName:'Записать',destroyMethodName:'Удалить'}},filter:['ФильтрПоМаске'],processField:['ДокументРасширение.Название'],display:{columns:[{title:'ДокументРасширение.Название',width:220,fixedSize:true}],cutLongRows:true,hasMoreLinkText:rk('Показать все.'),usePaging:'parts'},keyField:'@Документ'},element:$('<div></div>')}]}}[l];}};});
define('js!SBIS3.EDO.FastFilters',['Core/core-instance','Core/helpers/date-helpers','js!SBIS3.Navigation.LeftNavigation','i18n!SBIS3.EDO.FastFilters','Elektronnyj_dokumentooborot_localization'],function(cInstance,dateHelpers,leftNav){'use strict';var incoming_stats=[{key:'-1',value:rk('В любом состоянии'),level:0},{key:'10',value:rk('Требующие ответа'),level:0},{key:'7',value:rk('Утвержденные'),level:0},{key:'9',value:rk('Отклоненные'),level:0},{key:'6',value:rk('С ошибками'),level:0},{key:'-2',value:rk('Незакрепленные'),level:0},{key:'-3',value:rk('Удаленные'),level:0},{key:'19,20,22',value:rk('Аннулированные'),level:0},{key:'0,1',value:rk('Черновики'),level:0}],incoming_stats_fsnp=[{key:'-1',value:rk('В любом состоянии'),level:0},{key:'10',value:rk('Внутренняя обработка'),level:0},{key:'7',value:rk('Утвержденные'),level:0},{key:'9',value:rk('Отклоненные'),level:0},{key:'19,20,22',value:rk('Аннулированные'),level:0},{key:'0,1',value:rk('Черновики'),level:0}],incoming_supply_fsnp=[{key:'-1',value:rk('В любом состоянии'),level:0},{key:'10',value:rk('Требующие ответа'),level:0},{key:'7',value:rk('Утвержденные'),level:0},{key:'9',value:rk('Отклоненные'),level:0},{key:'20',value:rk('Удаленные поставщиком'),level:0},{key:'19',value:rk('Удаленные'),level:0},{key:'0,1',value:rk('Черновики'),level:0}],outgoing_stats=[{key:'-1',value:rk('В любом состоянии'),level:0},{key:'10',value:rk('Внутренняя обработка'),level:0},{key:'2,3',value:rk('Недоставленные'),level:0},{key:'4',value:rk('Не получен ответ'),level:0},{key:'7',value:rk('Утвержденные'),level:0},{key:'9',value:rk('Отклоненные'),level:0},{key:'6',value:rk('С ошибками'),level:0},{key:'-2',value:rk('Незакрепленные'),level:0},{key:'-3',value:rk('Удаленные'),level:0},{key:'19,20,22',value:rk('Аннулированные'),level:0},{key:'0,1',value:rk('Черновики'),level:0}],outgoing_stats_fsnp=[{key:'-1',value:rk('В любом состоянии'),level:0},{key:'10',value:rk('Внутренняя обработка'),level:0},{key:'2,3',value:rk('Недоставленные'),level:0},{key:'4',value:rk('Не получен ответ'),level:0},{key:'7',value:rk('Утвержденные'),level:0},{key:'9',value:rk('Отклоненные'),level:0},{key:'6',value:rk('С ошибками'),level:0},{key:'19,20,22',value:rk('Аннулированные'),level:0},{key:'0,1',value:rk('Черновики'),level:0}],outgoing_stats_fsnp_corr=[{key:'-1',value:rk('В любом состоянии'),level:0},{key:'10',value:rk('Внутренняя обработка'),level:0},{key:'2,3',value:rk('Недоставленные'),level:0},{key:'7',value:rk('Утвержденные'),level:0},{key:'9',value:rk('Отклоненные'),level:0},{key:'6',value:rk('С ошибками'),level:0},{key:'19,20,22',value:rk('Аннулированные'),level:0},{key:'0,1',value:rk('Черновики'),level:0},{key:'4',value:rk('Не получен ответ'),level:0}],inner_stats=[{key:'-1',value:rk('В любом состоянии'),level:0},{key:'4',value:rk('В обработке'),level:0},{key:'1',value:rk('Завершенные'),level:0},{key:'2',value:rk('Положительно'),level:1,title:rk('Завершенные положительно')},{key:'3',value:rk('Отрицательно'),level:1,title:rk('Завершенные отрицательно')},{key:'5',value:rk('Черновики'),level:0}],inner_stats_for_statistics=[{key:'-1',value:rk('В любом состоянии'),level:0},{key:'4',value:rk('В обработке'),level:0},{key:'1',value:rk('Завершенные'),level:0},{key:'2',value:rk('Положительно'),level:1,title:rk('Завершенные положительно')},{key:'3',value:rk('Отрицательно'),level:1,title:rk('Завершенные отрицательно')}],owner_obj_outgoing=[{key:'Все',value:rk('Все')},{key:'От меня',value:rk('От меня')},{key:'От моего отдела',value:rk('От моего отдела')}],owner_obj_incoming=[{key:'Все',value:rk('Все')},{key:'От меня',value:rk('Мои')},{key:'От моего отдела',value:rk('Моего отдела')}],avans_stats=[{key:'-1',value:rk('В любом состоянии'),level:0},{key:'4',value:rk('В обработке'),level:0},{key:'1',value:rk('Завершенные'),level:0},{key:'2',value:rk('Завершенные положительно'),level:0},{key:'3',value:rk('Завершенные отрицательно'),level:0},{key:'-3',value:rk('Удаленные'),level:0},{key:'5',value:rk('Черновики'),level:0}],price_approval_stats=[{key:'-1',value:rk('В любом состоянии'),level:0},{key:'2,3',value:rk('Недоставленные'),level:0},{key:'6',value:rk('С ошибками'),level:0},{key:'19,20,22',value:rk('Аннулированные'),level:0},{key:'0,1',value:rk('Черновики'),level:0}];function getFastFilterState(e,t,l){for(var r,a=l?l['ТипДокумента.Название']:leftNav.getInstance()&&leftNav.getInstance().getActiveElement()?leftNav.getInstance().getActiveElement()['data']['ТипДокумента']:void 0,i=0;i<e.length;i++)if(e[i].key===t||e[i].key===t.toString())if(('КоррИсх'===a||'КоррВх'===a)&&'7'===t)r={value:rk('Завершенные'),level:0};else r=e[i];return r;}function getDataFromStatTemplateContext(e){var t=e&&e.getParentByClass&&e.getParentByClass('SBIS3.EDO.StatTemplate'),l=t&&t._options||{},r=t&&t.hasChildControlByName(l['StatTemplateName'])?t.getChildControlByName(l['StatTemplateName']):null,a=r&&r.getLinkedContext(),i;if(a){var n=['ТипРаздела','ТипДокумента.Название'];for(var s in n)if(n.hasOwnProperty(s)&&a.getValue(n[s])){if(!i)i={};i[n[s]]=a.getValue(n[s]);}}return i;}function getFastFilterObj(filter_name,flag_fsnp,ctx_data,selfCtrl){var type_of_section=ctx_data?ctx_data['ТипРаздела']:leftNav.getInstance()&&leftNav.getInstance().getActiveElement()?leftNav.getInstance().getActiveElement()['data']['ТипРаздела']:void 0,type=leftNav.getInstance()&&leftNav.getInstance().getActiveElement()?leftNav.getInstance().getActiveElement()['data']['forFastFilters']:void 0,type_of_doc=ctx_data?ctx_data['ТипДокумента.Название']:(leftNav.getInstance()&&leftNav.getInstance().getActiveElement()?leftNav.getInstance().getActiveElement()['data']['ТипДокумента']:void 0)||'',res,fsnpTypeDocIn=['ДоговорВх','Входящие','КоррВх','АктСверВх','ЗаказВх','СчетВх','ФактураВх','ДоговорДок','АктСверкиДок'],fsnpTypeDocOut=['ДоговорИсх','Исходящие','КоррИсх','АктСверИсх','ДокОтгрИсх','ЗаказИсх','СчетИсх','ФактураИсх','ДоговорДок','АктСверкиДок'],fsnpTypePriceDoc=['PriceChangeOut','PriceChange','PriceNotificationOut','PriceNotificationIn'];if(selfCtrl&&(!type_of_section||!type_of_doc)){var reg=selfCtrl.getParentByClass('SBIS3.WTM.DocBaseTemplate');if(reg){var docType=reg.getTopParent().getProperty('docType');switch(docType){case'menu-dogVh':type_of_section='Входящие',type_of_doc='ДоговорВх';break;case'menu-dogIsh':type_of_section='Исходящие',type_of_doc='ДоговорИсх';}}}switch(filter_name){case'ФильтрВладелец':if('Входящие'===type_of_section)res='owner_obj_incoming';else res='owner_obj_outgoing';break;case'ФильтрСостояние':if(-1!=Array.indexOf(fsnpTypePriceDoc,type_of_doc)&&flag_fsnp)res='price_approval_stats';else if('Исходящие'===type_of_section)if('КоррИсх'==type_of_doc&&flag_fsnp)res='outgoing_stats_fsnp_corr';else if(-1!=Array.indexOf(fsnpTypeDocOut,type_of_doc)&&flag_fsnp)res='outgoing_stats_fsnp';else res='outgoing_stats';else if('Входящие'===type_of_section)if(-1!=Array.indexOf(fsnpTypeDocIn,type_of_doc)&&flag_fsnp)res='incoming_stats_fsnp';else if('ДокОтгрВх'===type_of_doc&&flag_fsnp)res='incoming_supply_fsnp';else res='incoming_stats';else res='inner_stats';break;case'ФильтрПоКраткомуСостоянию':if('АвансОтчет'===type)res='avans_stats';else res='inner_stats';break;case'ФильтрПоКраткомуСостояниюСтатистика':res='inner_stats_for_statistics';break;default:res='null';}return eval(res);}function cutHtmlTags(e){for(var t in e)if(-1!==e[t].toString().indexOf('span'))e[t]=$(e[t].toString()).text();return e;}var FastFilterModule={FormFilterTooltip:function(e,t){var l={},r='';l.visual=e;var a,i=this.getPathFilter?this.getPathFilter():null;if(i)a=i.getQuery();for(var n in e)if(!a||!a.hasOwnProperty(n)){var s='';switch(n){case'ФильтрАвтор':s=rk('Автор')+': ';break;case'ФильтрЛицо1':var v='';if(t.getFloatArea().hasChildControlByName('FilterViewEDO')&&t.getFloatArea().getChildControlByName('FilterViewEDO').getParent()._options.hasOwnProperty('filtersEDO'))v=t.getFloatArea().getChildControlByName('FilterViewEDO').getParent()._options.filtersEDO.FilterFace1.title;if(v)s=v+': ';else s=rk('Контрагент')+': ';break;case'ФильтрОтправитель':s=rk('Отправитель')+': ';break;case'ФильтрИсполнительСобытия':s=rk('Тек.исполнитель')+': ';break;case'ФильтрОтветственноеЛицо':s=rk('Ответственный')+': ';break;case'ФильтрСписокРассылки':s=rk('Исполнитель документа')+': ';break;case'Регламент':s=rk('Регламент')+': ';break;case'ФильтрФаза':s=rk('Этап')+': ';break;case'ФильтрДокументНашаОрганизация':s=rk('Наша организация')+': ';break;case'ФильтрПользователь':case'ФильтрПолучатель':s=rk('Получатель')+': ';break;case'ФильтрСрокДата':s=rk('Срок','Заголовок')+': ';}r+=s+e[n]+', ';}if(r.length>2)r=r.substr(0,r.length-2);return l.title=r,l;},filterLineRender:function(e,t){if(t=cutHtmlTags(t),Object.isEmpty(t))if(cInstance.instanceOfModule(this.getParent(),'SBIS3.EDO.FilterController')||cInstance.instanceOfModule(this.getParent(),'Deprecated/Controls/FilterController/FilterController'))if(jQuery.isEmptyObject(this.getParent().getPathFilter().getQuery()))return'';else return null;else return null;return t;},_filterViewLineRender:function(e,t){$(this.getContainer()).addClass('autotests-textready');var l=this.getBrowser(),r=l?l.getQuery():{};if(t=cutHtmlTags(t),this.getFloatArea().hasChildControlByName('FilterViewEDO')){var a=this.getFloatArea().getChildControlByName('FilterViewEDO').getQueryWithTextValues();for(var i in a)if(a.hasOwnProperty(i))t[i]=a[i];delete t['FilterViewEDO'];}if(t['ФильтрВключаяСкрытые'])t['ФильтрВключаяСкрытые']=rk('Включая скрытые');if(t['ФильтрВключаяНеактуальные'])t['ФильтрВключаяНеактуальные']=rk('Включая неактуальные');if(t['ФильтрВладелец']&&'Все'!=t['ФильтрВладелец'])delete t['ФильтрОтветственноеЛицо'],delete t['ФильтрАвтор'],delete t['ФильтрНезакрепленные'];if(e.hasOwnProperty('ФильтрСрокДата')&&!t.hasOwnProperty('ФильтрСрокДата')){var n=this.getFloatArea();if(n&&n.hasChildControlByName('ФильтрСрокДата'))t['ФильтрСрокДата']=n.getChildControlByName('ФильтрСрокДата').getStringValue();}if(t['ФильтрУдаленные'])t['ФильтрУдаленные_']=t['ФильтрУдаленные'],delete t['ФильтрУдаленные'];if(t['ФильтрНезакрепленные'])t['ФильтрНезакрепленные_']=t['ФильтрНезакрепленные'],delete t['ФильтрНезакрепленные'];if('Период'===e['ФильтрДатаПериод'])t['ФильтрДатаПериод']=dateHelpers.getFormattedDateRange(e['ФильтрДатаС'],e['ФильтрДатаП']);if(delete t['ФильтрДат'],cInstance.instanceOfModule(this.getParent(),'SBIS3.EDO.FilterController')){var s=this.getParent().getPathFilter()?this.getParent().getPathFilter().getQuery():null;for(var v in s)if(t.hasOwnProperty(v))delete t[v];}var o=this.getFloatArea().hasChildControlByName('ФильтрДатаПериод')?this.getFloatArea().getChildControlByName('ФильтрДатаПериод').getDefaultValue():null;if(Object.isEmpty(t)&&'Все'!==o)if(cInstance.instanceOfModule(this.getParent(),'SBIS3.EDO.FilterController')||cInstance.instanceOfModule(this.getParent(),'Deprecated/Controls/FilterController/FilterController'))if(l&&!Object.isEmpty(r)&&o&&'Месяц'===o&&!r['ФильтрСтатистикаТекущие']&&!r['ФильтрВнешняяСтатистика'])return rk('За последний месяц');else return'';else return'';if(this.getFloatArea().hasChildControlByName('ФильтрДатаПериод')&&'Месяц'===this.getFloatArea().getChildControlByName('ФильтрДатаПериод').getDefaultValue()&&'4'!==e['ФильтрПоКраткомуСостоянию']&&!r['ФильтрСтатистикаТекущие']||r['ФильтрВнешняяСтатистика'])t['ФильтрДатаПериод']=t['ФильтрДатаПериод']?t['ФильтрДатаПериод']:rk('За последний месяц');return t;},filterViewLineRender:function(e,t,l){if(t=void 0!==l?l:FastFilterModule._filterViewLineRender.apply(this,[e,t]),'object'===typeof t)return FastFilterModule.FormFilterTooltip(t,this);else return t;},onVisualizeFilter:function(e,t,l){var r=this.getParent().getName(),a=getDataFromStatTemplateContext(this),i=getFastFilterObj(t,true,a,this);if(i)if(-1===l)return e.setResult(rk('В любом состоянии'));else{var n=getFastFilterState(i,l,a);return e.setResult(n?n.title?n.title:n.value:rk('В любом состоянии'));}},onCreateOwnerPoint:function(e,t){var l={},r=this.getParent().getName(),a=getDataFromStatTemplateContext(this),i=getFastFilterObj(t.title,true,a,this),n=[],s=[];if(i){for(var v=0;v<i.length;v++)n.push(v),s.push(i[v].key);l={data:{keys:n,values:s},render:function(e,t){if(-1===t)return $('<div>'+rk('В любом состоянии')+'</div>');else if(getFastFilterState(i,t,a))if(getFastFilterState(i,t,a).level>0)return $('<div style="padding-left:'+(16*getFastFilterState(i,t,a).level+16)+'px;padding-right:16px;">'+getFastFilterState(i,t,a).value+'</div>');else return $('<div>'+getFastFilterState(i,t,a).value+'</div>');}};}e.setResult(l);},onCreateSortPoint:function(e,t){var l={};if('СортироватьПо'===t.title)l={data:{keys:[1,2],values:[rk('Сортировать по названию'),rk('Сортировать по дате изменения')]}};e.setResult(l);},onChangeFastFilter:function(e,t,l){if(!t['ФильтрВладелец']||'Все'===t['ФильтрВладелец'])t['ФильтрАвторИлиОтветственный']=-1,t['ФильтрАвторИлиОтвОтдел']=-1;if('-3'===(t['ФильтрСостояние']?t['ФильтрСостояние']:t['ФильтрПоКраткомуСостоянию']))t['ФильтрУдаленные']=true;else t['ФильтрУдаленные']=false;},onChangeFastFilterInner:function(e,t,l){if(!t['ФильтрВладелец']||'Все'===t['ФильтрВладелец'])t['ФильтрАвторИлиОтветственный']=-1,t['ФильтрАвторИлиОтвОтдел']=-1;if(this.getParent().getFilterButton())if(this.getParent().getFilterButton().getFloatArea().hasChildControlByName('FilterViewEDO')){var r=this.getParent().getFilterButton().getFloatArea().getChildControlByName('FilterViewEDO');r.deleteFilter('ФильтрПоКраткомуСостоянию'),r.deleteFilter('ФильтрСостояние'),r.deleteFilter('ФильтрВладелец'),r.addFilter({'ФильтрПоКраткомуСостоянию':t['ФильтрПоКраткомуСостоянию']}),r.addFilter({'ФильтрСостояние':t['ФильтрСостояние']}),r.addFilter({'ФильтрВладелец':t['ФильтрВладелец']});}},onCreatePointInnerStat:function(e,t){var l={},r,a=[],i=[];if('ФильтрВладелец'===t.title)r=getFastFilterObj(t.title);if('ФильтрПоКраткомуСостоянию'===t.title)r=getFastFilterObj('ФильтрПоКраткомуСостояниюСтатистика');if('ФильтрСтатистикаПериод'===t.title)r=[{key:'На начало',value:rk('На начало')},{key:'Получено',value:rk('Получено')},{key:'Выполнено',value:rk('Выполнено')},{key:'Осталось',value:rk('Осталось')}];if('ФильтрРазрезСтатистики'===t.title)r=[{key:'По исполнителю',value:rk('По исполнителю')},{key:'По ответственному',value:rk('По ответственному')}];if(r){for(var n=0;n<r.length;n++)a.push(n),i.push(r[n].key);l={data:{keys:a,values:i},render:function(e,t){if(-1===t)return $('<div>'+rk('В любом состоянии')+'</div>');else if(getFastFilterState(r,t))if(getFastFilterState(r,t).level>0)return $('<div style="padding-left:'+(16*getFastFilterState(r,t).level+16)+'px;padding-right:16px;">'+getFastFilterState(r,t).value+'</div>');else return $('<div>'+getFastFilterState(r,t).value+'</div>');}},e.setResult(l);}}};return FastFilterModule;});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.InnerStat", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".stat_template{position:relative!important}.inner-stat-browser .inner-stat-report-left-border{border-left:1px solid #eaeaea!important}.inner-stat-browser .ws-browser-container .ws-browser-cell-container:hover{text-decoration:underline}.inner-stat-browser .ws-browser-container .common_underline{text-decoration:underline;cursor:pointer!important}.common_not_underline .ws-browser-cell-container{text-decoration:none!important;cursor:default!important}.inner-stat-browser .inner-stat-report-top-border{border-top:1px solid #eaeaea!important}.inner-stat-browser .inner-stat-report-head-nobottom-border{border-bottom:none!important}.inner-stat-browser .column-head-black{color:#000}.inner-stat-browser .ws-browser-head-bottom-border .inner-stat-report-draft{color:#999}.inner-stat-browser .column-red{color:red;padding-right:4px}.inner-stat-browser .column-gray{color:#999}.inner-stat-browser .ws-browser-results{background-color:#fff}.inner-stat-browser .inner-stat-report-draft{color:#999;cursor:pointer}.inner-stat-browser .no-empty-column{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;cursor:pointer!important}.inner-stat-browser .empty-column{cursor:default!important;width:100%;height:100%}.inner-stat-browser .inner-stat-report-hidden{display:none}.click_element{cursor:pointer}.phase_overdue_link{color:red}.phase_link{color:#000}.inner-stat-browser .regl-overdue-value{padding-bottom:4px}.stat_total:hover{text-decoration:underline!important;cursor:pointer!important}.inner-stat-browser .ws-browser-cell{cursor:default!important}.compl_phase_title{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.compl_phase_title:hover{text-decoration:underline;cursor:pointer!important}.regl-report-hierarchy-view .ws-browser-results{background-color:rgba(0,0,0,0)}.regl-report-hierarchy-view .ws-browser-cell{cursor:default!important}.phase-report-hierarchy-view .ws-browser-cell{cursor:default!important}.prev_comment{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-left:16px;font-size:12px;color:grey;display:block}.phases_work .past{color:#ef463a}.browser-link{text-decoration:none;cursor:auto;width:100%;display:inline-block}.browser-link:hover:not(.without_underline){text-decoration:underline;cursor:pointer}.without_underline{text-decoration:none;cursor:pointer}.statistics-browser .ws-browser-hierarchy-padding{margin-left:0!important}.bold_boss{font-weight:700}.statistics-browser .folder_font{font-size:15px}.statistics-browser .overdue-stat-count{color:#ef463a!important}.statistics-browser .controls-DataGridView__results{background-color:rgba(0,0,0,0);border-bottom:1px solid #eaeaea!important}.statistics-browser .controls-DataGridView .controls-DataGridView__table .controls-DataGridView__td{cursor:default!important}.StatTemplateNew .edo-Browser .controls-Browser__view table.controls-DataGridView__table{table-layout:fixed!important}.phase-report-link-title{text-decoration:none;cursor:auto;width:100%}.phase-report-link-title:hover{cursor:pointer}.regulation-caption{float:right!important;text-align:right!important;line-height:12px!important;color:#8991a9!important;font-size:12px;max-width:100%}.regulation-caption:hover{text-decoration:underline!important;cursor:pointer;color:#8991a9!important}.statistics-browser .controls-DataGridView__results{background-color:rgba(0,0,0,0);border-bottom:1px solid #eaeaea!important}.statistics-browser .controls-DataGridView .controls-DataGridView__table .controls-DataGridView__td{cursor:default!important}.bold_boss{font-weight:700}.statistics-browser .folder_font{font-size:15px}.phase-report-link{text-decoration:none;width:100%;display:inline-block;color:#000;text-align:right}.regl_title .phase-report-link{text-align:left}.phase-report-link:hover{text-decoration:underline;cursor:pointer;color:#000!important}th.edo_stat_report_caption_border{border-right:1px solid #eaeaea!important}.external-statistics-indent{top:1px}@-moz-document url-prefix(){.external-statistics-indent{top:2px}}.edo-statistics-overdue-count{color:#ef463a!important}.edo-statistics-overdue-count:hover{color:#ef463a!important}.phase-report-link .controls-Button__text,.statistics-browser .regulation-caption .controls-Button__text{white-space:normal!important;overflow:visible}.statistics-browser .phase-report-link .controls-Button__wrapper{justify-content:flex-end;-ms-flex-pack:end}.edo-StatisticsReport,.edo-StatisticsReport .edo-BrowserWrapper,.edo-StatisticsReport .edo-BrowserWrapper .controls-ScrollContainer{display:flex;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;flex-direction:column;-webkit-flex-direction:column;-moz-flex-direction:column;-ms-flex-direction:column;flex-grow:1;-webkit-flex-grow:1;-ms-flex-grow:1;flex-shrink:1}.edo-StatisticsReport .controls-DataGridView__th .controls-Button__wrapper{min-height:24px}.edo-StatisticsReport .controls-DataGridView__th .controls-Link{height:auto}.edo-StatisticsReport .controls-DataGridView__th{padding-bottom:2px}.edo-StatisticsReport .controls-DataGridView__results .controls-Link{font-weight:700}.edo-StatisticsReport .edo-Browser .controls-Browser__view table.controls-DataGridView__table td.controls-DataGridView__td{padding-top:4px;padding-left:12px!important}.stat_edo__fastDataFilterEmpty .controls-Browser__tableCell-fastDataFilter{min-width:2px}"));head.appendChild(style);});}
define('js!SBIS3.EDO.InnerStat',['Lib/Control/Control','Core/core-functions','Core/core-attach','Core/core-instance','Core/helpers/string-helpers-min','Core/helpers/string-helpers','Core/defaultRenders','js!SBIS3.EDO.FieldLinksCfg','js!SBIS3.EDO.FastFilters','js!SBIS3.EDO.StatFuncs','js!SBIS3.EDO2.OpenDialogAction','html!SBIS3.PersonCore.Photo/photoTpl','css!SBIS3.PersonCore.Photo','css!SBIS3.EDO.InnerStat','i18n!SBIS3.EDO.InnerStat','Elektronnyj_dokumentooborot_localization'],function(e,t,i,l,r,a,n,o,s,p,u,d){'use strict';var m={onInitStatBrowser:function(){for(var e=this.getColumnMap(),t=0;t<e.length;t++)this.toggleColumn(e[t].field,false);},renderCaptionProgressTotal:function(e){return $('<div class="inner-stat-report-inprogress" id="isc0">'+rk('Всего')+'</div>');},renderCaptionProgressLate:function(){return $('<div class="icon-16 icon-Time icon-disabled" title="'+rk('Нарушен срок')+'" style="padding-left:15px"></div>');},renderCaptionFinishedTotal:function(e){if('Завершено'===e)return $('<div class="inner-stat-report-need-border">'+rk('Завершено')+'</div>');else return $('<div class="inner-stat-report-need-border" id="isc1" >'+rk('Всего')+'</div>');},renderCaptionFinishedLate:function(){return $('<div class="icon-16 icon-Time icon-disabled" title="'+rk('Нарушен срок')+'" style="padding-right:3px"></div>');},renderCaptionFinishedPos:function(){return $('<div class="inner-stat-report-need-border" >'+rk('Положительно')+'</div>');},renderCaptionFinishedNeg:function(){return $('<div class="inner-stat-report-need-border" >'+rk('Отрицательно')+'</div>');},renderCaptionFinishedManually:function(){return $('<div class="inner-stat-report-need-border">'+rk('Закрыто вручную')+'</div>');},renderCaptionDraft:function(){return $('<div class="inner-stat-report-draft" >'+rk('Черновики')+'</div>');},renderColumnWithHint:function(e,t,i){var l=e.get(t),r='';if(!l)return'<div class="empty-column"></div>';return l=n.real(l,0,true),r=F(e,t),'<div class = "no-empty-column" title="'+r+'">'+l+'</div>';},renderRow:function(e,t){},onAfterRender:function(e){for(var t=0;t<$('.common_cell').length;t+=2){var i=$($('.common_cell')[t]),l=$($('.common_cell')[t+1]),r=function(e,t){t.bind('mouseenter',function(){$('tr.ws-browser-table-row:hover').addClass('tr_common_underline'),t.addClass('common_underline'),e.addClass('common_underline');}),t.bind('mouseleave',function(){$('.tr_common_underline').removeClass('tr_common_underline'),t.removeClass('common_underline'),e.removeClass('common_underline');}),e.bind('mouseenter',function(){$('tr.ws-browser-table-row:hover').addClass('tr_common_underline'),t.addClass('common_underline'),e.addClass('common_underline');}),e.bind('mouseleave',function(){$('.tr_common_underline').removeClass('tr_common_underline'),t.removeClass('common_underline'),e.removeClass('common_underline');});};if('0'!==l.text().trim()&&''!==l.text().trim())r(l,i);else i.addClass('common_not_underline'),l.addClass('common_not_underline');}if(!$('#in_prog_header').closest('td').hasClass('ws-browser-right'))$('#in_prog_header').css('padding-right','12px');else $('#in_prog_header').css('padding-right','0px');},onAfterLoadBrowser:function(t){e.ControlStorage.getByName('ПанельСФильтромСтат').getFilterButton().applyFilter(true);for(var i=this,l=i.getQuery(),r=i.getContainer(),a=i.getRecordSet().getResults(),n=['ЗавершеноПросрочено','Положительно','Отрицательно'],o=0;o<n.length;o++){var s=n[o];i.toggleColumn(s,a.hasColumn(s)&&a.get(s)>0);}i.toggleColumn('Завершено',a.hasColumn('Завершено')&&true&&true!==l['ФильтрВнешняяСтатистика']);var p=i.getColumns(),u=a.hasColumn('ЗавершеноПросрочено')&&a.get('ЗавершеноПросрочено')<=0&&a.hasColumn('Положительно')&&a.get('Положительно')<=0&&a.hasColumn('Отрицательно')&&a.get('Отрицательно')<=0;if(i.setColumns(p),u)$('#isc1').text('');$.each(i.getContainer().find('.ws-browser-head-bottom .ws-browser-header-cell'),function(e,t){var i=$(t).find('div.inner-stat-report-need-border');if(i&&i.length>0&&'isc1'!==i.attr('id'))$(t).addClass('inner-stat-report-left-border');}),$.each(r.find('.ws-browser-cell'),function(e,t){$(t).addClass('inner-stat-report-top-border');}),$.each(r.find('.ws-browser-head-top .ws-browser-header-cell'),function(e,t){$(t).addClass('inner-stat-report-head-nobottom-border');}),$.each(r.find('.no-empty-column'),function(e,t){var i=$(t).attr('title');$(t).parent('div').attr('title',i);}),$.each(r.find('.empty-column'),function(e,t){$(t).parent('div').addClass('empty-column');}),this.recalcBrowserOnDOMChange();},onRowClickRegl:function(e,t,i,l,r){},renderTotalRow:function(e,t){var i=this;if(null===t)return;var l=this.getColumns();$.each(e.find('td.ws-browser-cell-cut'),function(e,i){if($(i).addClass('resultTD'),'НазваниеРегламента'!==l[e].field){var r=$(i).find('div'),a=null;if(t.hasColumn(l[e].field))a=t.get(l[e].field);if(a&&0!==parseInt(a,10)){var o=F(t,l[e].field);$(r).html(n.real(a,0,true)),r.attr('title',o);}else $(r).html(''),$(i).attr('title','');}});},onBeforeShowFilterView:function(){this.addFilter(o.getCfgByName('ФильтрЛицо1'));},filterLineRender:function(e,t){if(t=g(t),'За период'!==t['ФильтрДатаПериод'])delete t['ФильтрДат'];if(Object.isEmpty(t))if(l.instanceOfModule(this.getParent(),'SBIS3.EDO.FilterController')||l.instanceOfModule(this.getParent(),'Deprecated/Controls/FilterController/FilterController'))if(this.getFloatArea().hasChildControlByName('ФильтрДатаПериод')&&'Месяц'===this.getFloatArea().getChildControlByName('ФильтрДатаПериод').getDefaultValue())return rk('За последний месяц');else return rk('Нужно отобрать?');else return null;if(!t['ФильтрДатаПериод']&&this.getFloatArea().hasChildControlByName('ФильтрДатаПериод')&&'Месяц'===this.getFloatArea().getChildControlByName('ФильтрДатаПериод').getDefaultValue())t['ФильтрДатаПериод']=rk('За последний месяц');return s.FormFilterTooltip(t,this);},onBeforeShowFilter:function(){if(this.getFloatArea().hasChildControlByName('ФильтрПереход'))this.getFloatArea().getChildControlByName('ФильтрПереход').getLinkedContext().setValue('ФильтрФаза',this.getBrowser().getQuery()['ФильтрФаза']);},renderColumnReglTitle:function(e,t){if(!e.get('НазваниеРегламента')||''===e.get('НазваниеРегламента'))return rk('Регламент без названия');else return c(e.get('НазваниеРегламента'));},setLimitedDatePeriod:function(){},setFilterOverdueDetalization:function(e,t){if(!t['ФильтрПросроченные'])delete t['ФильтрПросроченоПоФазе'],delete t['ФильтрПросроченоПоСроку'];},onFilterStatPeriodChange:function(e,t,i){if(t['ФильтрСтатистикаПериод'])return e.setResult(false),p.goToInnerStatReport('js!Sbis3.EDO.StatisticsInnerCurrent',t,this.getParent().getParent().getParent()),false;},generateHrefParams:function(e,t,i,l,n,o,s,p,u,d){function m(e,t){if(t in e&&e[t])if('string'===typeof e[t])return e[t];else return e[t].toSQL();else return null;}function f(e,t,i,l){if(i&&'Просрочено'===i)i='Итого';if(i)return e.hasColumn(i)&&e.get(i)?(t?e.get(i).split(','):e.get(i))[l]:null;else return e.hasColumn('Итого')&&e.get('Итого')?(t?e.get('Итого').split(','):e.get('Итого'))[l]:null;}var F=i||'other_elements'==o?e['Раздел']?[e['Раздел']]:null:t.hasColumn('@Лицо')&&t.get('@Лицо')?[parseInt(t.get('@Лицо'),10)]:null,c=i?e['Раздел']?e['Раздел']:rk('Всего'):t.hasColumn('Название')&&t.get('Название')?a.escapeHtml(t.get('Название')):null,g=i?true:t.hasColumn('Раздел@')&&t.get('Раздел@')?t.get('Раздел@'):null,h={face:F,count:!!s||0===s?s:f(t,i,o,0),overdue:!!p||0===p?p:f(t,i,o,1),title:'other_elements'===o?i?rk('Прочих'):rk('Всего'):c,isDivision:'other_elements'===o?i?false:g:g,filter:{}};for(var y in e)if(e.hasOwnProperty(y))h.filter[y]=e[y];return h.filter['Регламент']=e['Регламент']?e['Регламент']:n,h.filter['ИдРегламента']=e['ИдРегламента']?e['ИдРегламента']:n,h.filter['ФильтрДатаС']=m(e,'ФильтрДатаС'),h.filter['ФильтрДатаП']=m(e,'ФильтрДатаП'),h.filter['ФильтрСрокДата']=e['ФильтрСрокДата']?new Date(e['ФильтрСрокДата']).toSQL():void 0,h.filter['ФильтрПросроченные']=l,h.filter['ФильтрНераспределенные']=t.hasColumn('Название')&&'Нераспределенные'===t.get('Название')?true:false,h.filter['ФильтрУдаленные']=false,h.filter['ФильтрСтатистикаПериод']=u?u:e['ФильтрСтатистикаПериод'],h.filter['ФильтрНеПустойПереход']=d&&'StatisticsReportTransitionsBrowser'===d.getName()?true:void 0,delete h.filter['ФильтрАвторИлиОтветственный'],delete h.filter['ФильтрАвторИлиОтвОтдел'],encodeURIComponent(r.serializeURLData(h));},renderTitleColumn:function(e,t,i,l){var r=$('<span></span>'),n=e.get(t)?e.get(t):'без имени',o;if(-1!==['без исполнителя','Нераспределенные','без имени'].indexOf(n))n=rk(n);if(o=$('<span title="'+n+'">'+a.escapeHtml(n)+'</span>'),r.attr('title',c(e.get(t))),e.get('Руководитель'))$(o).addClass('bold_boss');if(r.append($(o)),!e.get('Раздел@')){var s='',p=e.hasColumn('Должность')&&e.get('Должность')?e.get('Должность'):'',u='<br><span title="'+p+'" '+'style="font-size: 12px; color: #999999;">'+a.escapeHtml(p)+'</span>';if('без исполнителя'!==n&&'Нераспределенные'!==n&&p)r.append(u);if(!l||l&&e.get('НаНачало'))s=m.generateHrefParams(this.getQuery(),e,false,false,void 0,void 0,l?e.get('НаНачало'):void 0,l?e.get('НаНачалоПросрочено'):void 0,l?'На начало':void 0,this);if(s)r.addClass('phase-report-link-title'),r.addClass('browser-link'),r.addClass('without_underline'),r.attr('params',s),i.className=-1===i.className.indexOf('phase-report-performer')?i.className+' phase-report-performer ':i.className;else i.className=i.className.replace('phase-report-performer','');if(-1!==e.get('@Лицо')){var f=d({cssClasses:'person-photo-mini-large',photoData:e.get('userPhotoData')});if(''!==$(f).find('img').attr('src'))r.prepend('<div style="float: left; margin-right: 4px;">'+f+'</div>');}else r.css({'margin-left':'43px'});}return r;},changeDefaultFilterPeriodStat:function(e,t){if(!t['ФильтрДатаПериод'])t['ФильтрДатаПериод']='Месяц';},onRowClickStat:function(e,t,i,l,r){if('Название'!=r)e.setResult(false);},makeColumn:function(e,t,i,l,r,a,n,o){return{captionAlign:'right',className:o,title:e,field:t,width:i,fixedSize:true,textAlign:'right',isResultField:true,isSortable:false,useForFolder:true,verticalAlign:n,render:l[r?1:0],is_overdue:r,is_not_overdue:a};},onBrowserFolderEnterStat:function(e,t){this.getParent().getParent().getLinkedContext().setValue('ТекущееПодразделение',t);},onInitDetalizationEvents:function(){var e=this;e.subscribe('onAfterRender',function(){var t=e.getRecordSet();e.getContainer().find('.compl_phase_title').each(function(t){var i=jQuery(this).closest('td'),l=jQuery(this).closest('tr').attr('rowkey'),r=e.getRecordSet().getRecordByPrimaryKey(parseInt(l,10)).get('@Документ');jQuery(i).removeClass('.pereh_col'),jQuery(i).click(function(t){editDoc(e,r),t.stopImmediatePropagation();});});});},onInitShablonCreateMenu:function(){i.attachInstance('Control/Menu',{name:'КонтекстноеМенюОтметкиДокументов',data:[{id:'plus',caption:rk('Пометить плюсом'),handlers:{onActivated:function(){refreshLabel(1);}}},{id:'minus',caption:rk('Пометить минусом'),handlers:{onActivated:function(){refreshLabel(2);}}},{id:'clear_plus',caption:rk('Снять пометку плюсом'),handlers:{onActivated:function(){refreshLabel(3);}}},{id:'clear_minus',caption:rk('Снять пометку минусом'),handlers:{onActivated:function(){refreshLabel(4);}}}]});},setPlusMinusHandler:function(){var t=this;this.delegateUserEvent('.edo-plus-minus-trigger','click',function(i){t.setActiveRow(jQuery(this).closest('tr'));var l=e.ControlStorage.getByName('КонтекстноеМенюОтметкиДокументов');return openDocMarkMenu(l,i,this.getAttribute('data-state')),false;});},onRowClickDetalization:function(e,t,i){e.setResult(false);var l=this,r=i.get('@Документ');new u().execute({id:parseInt(r,10),openMode:4});},onInitStatFastFilters:function(e){var t=this,i=this.getParent().getParent().getParent().getLinkedContext(),l=this.getParent().getParent()._options.fastFilters;t.hide(),t.once('onReady',function(e){this.setPath(l);var t=this.getQuery();for(var r in t)if(t.hasOwnProperty(r)&&i.getValue(r))this.setFilter(r,i.getValue(r),true);this.show();});},setClickToDetalization:function(e,t){for(var i=e.getContainer().find(t),l=0;l<i.length;l++){var r=$(i[l]);(function(e,t){e.click(function(e){p.goToPhasesWork(e,t);});var i=parseInt(e.text(),10);if(!isNaN(i)&&e.hasClass('overdue-stat-count'))e.attr('title',i+p.declOfNum(i,[' '+rk('просрочено'),' '+rk('просроченных'),' '+rk('просроченных')]));else if(!isNaN(i))e.attr('title',i);}(r,r.attr('params')));}},filterReglLineRender:function(e,t){var i=this.getParentByClass('SBIS3.EDO.StatTemplate'),l=i&&i._options&&i._options['filter_options']||{},r=s.filterViewLineRender.apply(this,[e,t]);if(l['ИдРегламента'])if(''===r)r=l['ИдРегламента.Название'];else if(r.title)r=l['ИдРегламента.Название']+', '+r.title;else r=l['ИдРегламента.Название']+', '+r;return r;},synchStatFilters:function(e,t,i){var l=e._options.lastSavedFilters,r=m.getFullFilterStructure(t),a=m.getFilterStructureBLArray(r);for(var n in l)if(l.hasOwnProperty(n))i.setValue('filter/'+n,l[n]),t.getLinkedContext().setValue(t._options.browserOptions.bind+'/'+n,l[n]);for(n in i.getValue('filter'))if(i.getValue('filter').hasOwnProperty(n)&&(-1!==$.inArray(n.replace('Текст',''),a)||'ФильтрСтатистикаПериод'===n||'Раздел'==n))t.getLinkedContext().setValue(t._options.browserOptions.bind+'/'+n,i.getValue('filter')[n]);},getFullFilterStructure:function(e){var t={},i=e._getFastDataFilter()?e._getFastDataFilter().getFilterStructure():{},l=e._getFilterButton().getFilterStructure();return jQuery.extend(t,i,l),t;},getFilterStructureBLArray:function(e){var t=[];for(var i in e)if(e.hasOwnProperty(i))t.push(e[i]['filterBLName']);return t;},onActivateColumnCaption:function(e){var i=this._options.componentOptions.columnId,l=this._options.componentOptions.filterName,r=this._options.componentOptions.nextReportName,a=this.getParentByClass('SBIS3.EDO.StatTemplateNew'),n=this.getParentByClass('SBIS3.EDO.StatEDOBrowserPP')?this.getParentByClass('SBIS3.EDO.StatEDOBrowserPP').getView():this.getParentByClass('SBIS3.EDO2.Browser').getView(),o=t.clone(n.getFilter());if(i&&-1===i)p.goToOtherRegls(e,true,n.getParent().getParent().getParent());else if(''===r||''===i){var s=n.getItems().getMetaData().results,u=this._options.componentOptions.columnField,d='';if(i){if('ФильтрИдФазы'===l)o[l]=o['ИдРегламента']+':'+i;else o[l]=i;o[l+'Текст']=u.split('##')[1];}d=p.generateHrefParamsNew(o,s,true,false,null,u),p.goToPhasesWork(e,d,n.getParentByClass('SBIS3.EDO.StatTemplateNew'),n);}else if(i){if(o[l]='ФильтрИдФазы'==l?a.getLinkedContext().getValue('filter/ИдРегламента')+':'+i:i,o[l+'Текст']=this.getCaption(),o['ИдРегламента']&&'StatisticsInnerCurrent'===r&&'StatisticsPeriodReport'===a._options.currentReportName)r='StatisticsPhaseReport';p.saveLastStatisticsFilter(o,a.historyStorage).addCallback(function(){a.setStatisticsTemplate(r);});}},onActivateResult:function(e){var i=this.getParentByClass('SBIS3.EDO.StatEDOBrowserPP')?this.getParentByClass('SBIS3.EDO.StatEDOBrowserPP').getView():this.getParentByClass('SBIS3.EDO2.Browser').getView(),l=t.clone(i.getFilter()),r=this._options.componentOptions.columnId,a=this._options.componentOptions.filterName,n=this._options.componentOptions.isOverdue,o=this._options.componentOptions.isPeriodReport,s=i.getItems().getMetaData().results,u=this.getParentByClass('SBIS3.EDO.StatEDOBrowserPP')?this.getParentByClass('SBIS3.EDO.StatEDOBrowserPP').getParent():null,d;if(r&&-1===r){if(!l['ИдРегламента'])l['ФильтрПрочиеРегламенты']=u?u._options.other_elements_id:null;else l['ФильтрПрочиеФазы']=u?u._options.other_elements_id:null;d=p.generateHrefParamsNew(l,s,true,n,null,'other_elements',s.get('-1##Прочее').split(',')[0],s.get('-1##Прочее').split(',')[1]);}else{var m=this._options.componentOptions.columnField;if(r){if('ФильтрИдФазы'===a)l[a]=l['ИдРегламента']+':'+r;else l[a]=r;l[a+'Текст']=m.split('##')[1];}if(o){var f,F;if(n)F=s.get(m);else f=s.get(m);d=p.generateHrefParamsNew(l,s,true,n,null,m,f,F);}else d=p.generateHrefParamsNew(l,s,true,n,null,m);}p.goToPhasesWork(e,d,i.getParentByClass('SBIS3.EDO.StatTemplateNew'),i);},onBeforeSetRoot:function(e){delete this.getFilter()['ФильтрСортировкаКолонок'];},onReadyEdoBrowser:function(e){this.getParent()._options['applyHistoryFilterOnLoad']=false;},getStatisticsFilterStructure:function(e){return'<opts><opt name="internalValueField">FilterDatePeriod</opt>'+'<opt name="internalCaptionField">FilterDatePeriodText</opt>'+'<opt name="value" bind="filter/ФильтрДатаПериод"></opt>'+'<opt name="caption" bind="filter/ФильтрДатаПериодТекст"></opt>'+'<opt name="resetValue">'+'Месяц'+'</opt>'+'<opt name="filterBLName" value="ФильтрДатаПериод"></opt>'+'<opt name="itemTemplate" type="function" value="html!SBIS3.EDO.DetalizationEvents/tplFilterDatePeriod"/>'+'</opts>'+'<opts>'+'<opt name="internalValueField">FilterDateFrom</opt>'+'<opt name="internalCaptionField">FilterDateFromEmptyText</opt>'+'<opt name="value" bind="filter/ФильтрДатаС"></opt>'+'<opt name="caption" bind="filter/ФильтрДатаСТекст"></opt>'+'<opt name="resetValue" type="null">null</opt>'+'<opt name="filterBLName" value="ФильтрДатаС"></opt>'+'<opt name="itemTemplate" type="null">null</opt>'+'<opt name="historyItemTemplate" type="null">null</opt>'+'</opts>'+'<opts>'+'<opt name="internalValueField">FilterDateTo</opt>'+'<opt name="internalCaptionField">FilterDateToEmptyText</opt>'+'<opt name="value" bind="filter/ФильтрДатаП"></opt>'+'<opt name="caption" bind="filter/ФильтрДатаПТекст"></opt>'+'<opt name="resetValue" type="null">null</opt>'+'<opt name="filterBLName" value="ФильтрДатаП"></opt>'+'<opt name="itemTemplate" type="null">null</opt>'+'<opt name="historyItemTemplate" type="null">null</opt>'+'</opts>'+'<opts>'+'<opt name="internalValueField">FilterFace1</opt>'+'<opt name="internalCaptionField">FilterFace1Text</opt>'+'<opt name="internalVisibilityField">FilterFace1Visibility</opt>'+'<opt name="value" bind="filter/ФильтрЛицо1"></opt>'+'<opt name="caption" bind="filter/ФильтрЛицо1Текст"></opt>'+'<opts name="resetValue" type="array"></opts>'+'<opt name="resetVisibilityValue">false</opt>'+'<opt name="itemTemplate" type="function" value="tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterFace1"/>'+'<opt name="historyItemTemplate" type="function" value="tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterFace1"/>'+'<opt name="filterBLName" value="ФильтрЛицо1"></opt>'+'</opts>'+'<opts>'+'<opt name="internalValueField">FilterIdRegulation</opt>'+'<opt name="internalCaptionField">FilterIdRegulationText</opt>'+'<opt name="internalVisibilityField">FilterRegulationVisibility</opt>'+'<opt name="value" bind="filter/ИдРегламента"></opt>'+'<opt name="caption" bind="filter/ИдРегламентаТекст"></opt>'+'<opt name="filterBLName" value="ИдРегламента"></opt>'+'<opt name="resetVisibilityValue">false</opt>'+(e&&e['ИдРегламента']?'<opt name="resetValue" type="string">'+e['ИдРегламента']+'</opt>':'<opt name="resetValue" type="null">null</opt>')+(e&&e['ИдРегламентаТекст']?'<opt name="resetCaption" type="string">'+e['ИдРегламентаТекст']+'</opt>':'<opt name="resetCaption" type="null">null</opt>')+(e&&e['ИдРегламента']?'<opt name="itemTemplate" type="function" value="tmpl!SBIS3.EDO.StatEDOBrowserPP/resources/tplFilterIdRegulations"/>':'<opt name="itemTemplate" type="function" value="tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterIdRegulations"/>')+'</opts>'+'<opts>'+'<opt name="internalValueField">FilterLimitation</opt>'+'<opt name="internalCaptionField">FilterLimitationText</opt>'+'<opt name="internalVisibilityField">FilterLimitationVisibility</opt>'+'<opt name="value" bind="filter/ФильтрСрокДата"></opt>'+'<opt name="caption" bind="filter/ФильтрСрокДатаТекст"></opt>'+'<opt name="resetValue" type="null">null</opt>'+'<opt name="resetVisibilityValue">false</opt>'+'<opt name="filterBLName" value="ФильтрСрокДата"></opt>'+'</opts>'+'<opts>'+'<opt name="internalValueField">FilterResponsibleFace</opt>'+'<opt name="internalCaptionField">FilterResponsibleFaceText</opt>'+'<opt name="internalVisibilityField">FilterResponsibleFaceVisibility</opt>'+'<opt name="value" bind="filter/ФильтрОтветственноеЛицо"></opt>'+'<opt name="caption" bind="filter/ФильтрОтветственноеЛицоТекст"></opt>'+'<opts name="resetValue" type="array"></opts>'+'<opt name="resetVisibilityValue">false</opt>'+'<opt name="filterBLName" value="ФильтрОтветственноеЛицо"></opt>'+'<opt name="itemTemplate" type="function" value="tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterResp"/>'+'<opt name="historyItemTemplate" type="function" value="tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterResp"/>'+'</opts>'+'<opts>'+'<opt name="internalValueField">FilterListDispatch</opt>'+'<opt name="internalCaptionField">FilterListDispatchText</opt>'+'<opt name="internalVisibilityField">FilterListDispatchVisibility</opt>'+'<opt name="value" bind="filter/ФильтрСписокРассылки"></opt>'+'<opt name="caption" bind="filter/ФильтрСписокРассылкиТекст"></opt>'+'<opts name="resetValue" type="array"></opts>'+'<opt name="resetVisibilityValue">false</opt>'+'<opt name="filterBLName" value="ФильтрСписокРассылки"></opt>'+'<opt name="itemTemplate" type="function" value="tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterListDispatch"/>'+'<opt name="historyItemTemplate" type="function" value="tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterListDispatch"/>'+'</opts>'+'<opts>'+'<opt name="internalValueField" type="array">FilterMilestone</opt>'+'<opt name="internalCaptionField">FilterMilestoneText</opt>'+'<opt name="internalVisibilityField">FilterMilestoneVisibility</opt>'+'<opts name="value" bind="filter/ФильтрПоВехе" type="array"></opts>'+'<opts name="caption" bind="filter/ФильтрПоВехеТекст"></opts>'+'<opts name="resetValue" type="array"></opts>'+'<opt name="resetVisibilityValue">false</opt>'+'<opt name="itemTemplate" type="function" value="tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterMilestone"/>'+'<opt name="filterBLName" value="ФильтрПоВехе"></opt>'+'</opts>'+'<opts>'+'<opt name="internalValueField">FilterRepeatStages</opt>'+'<opt name="internalCaptionField">FilterRepeatStagesText</opt>'+'<opt name="internalVisibilityField">FilterRepeatStagesVisibility</opt>'+'<opt name="value" bind="filter/ФильтрПовторные"></opt>'+'<opt name="resetValue" type="null">null</opt>'+'<opt name="resetVisibilityValue">false</opt>'+'<opt name="filterBLName" value="ФильтрПовторные"></opt>'+'</opts>'+'<opts>'+'<opt name="internalValueField">FilterPassageStatus</opt>'+'<opt name="internalCaptionField">FilterPassageStatusText</opt>'+'<opt name="internalVisibilityField">FilterPassageStatusVisibility</opt>'+'<opt name="value" bind="filter/ФильтрСтатусПерехода"></opt>'+'<opt name="caption" bind="filter/ФильтрСтатусПереходаТекст"></opt>'+'<opt name="resetValue" type="null">null</opt>'+'<opt name="resetVisibilityValue">false</opt>'+'<opt name="filterBLName" value="ФильтрСтатусПерехода"></opt>'+'</opts>'+'<opts>'+'<opt name="internalValueField">FilterMarksIncluded</opt>'+'<opt name="internalCaptionField">FilterMarksIncludedText</opt>'+'<opt name="internalVisibilityField">FilterMarksVisibility</opt>'+'<opt name="value" bind="filter/ФильтрПометкиВкл"></opt>'+'<opt name="caption" bind="filter/ФильтрПометкиВклТекст"></opt>'+'<opts name="resetValue" type="array"></opts>'+'<opt name="resetVisibilityValue">false</opt>'+'<opt name="itemTemplate" type="function" value="tmpl!SBIS3.EDO2.MarksFilterRowTemplate/tmpl/MarksFilterRowTemplate"/>'+'<opt name="filterBLName" value="ФильтрПометкиВкл"></opt>'+'</opts>'+'<opts>'+'<opt name="internalValueField">FilterMarksExcluded</opt>'+'<opt name="internalCaptionField">FilterMarksExcludedText</opt>'+'<opt name="value" bind="filter/ФильтрПометкиИскл"></opt>'+'<opt name="caption" bind="filter/ФильтрПометкиИсклТекст"></opt>'+'<opts name="resetValue" type="array"></opts>'+'<opt name="resetVisibilityValue">false</opt>'+'<opt name="itemTemplate" type="function" value="tmpl!SBIS3.EDO2.MarksFilterRowTemplate/tmpl/MarksFilterRowTemplate"/>'+'<opt name="filterBLName" value="ФильтрПометкиИскл"></opt>'+'</opts>'+'<opts>'+'<opt name="internalValueField">FilterAuthorOrResponsible</opt>'+'<opt name="internalCaptionField">FilterAuthorOrResponsibleText</opt>'+'<opt name="internalVisibilityField">FilterAuthorOrResponsibleVisibility</opt>'+'<opt name="value" bind="filter/ФильтрАвторИлиОтветственный"></opt>'+'<opt name="caption" bind="filter/ФильтрАвторИлиОтветственныйТекст"></opt>'+'<opts name="resetValue"  type="array"></opts>'+'<opt name="resetCaption" value=""></opt>'+'<opt name="resetVisibilityValue">false</opt>'+'<opt name="itemTemplate" type="function" value="tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterAuthor"/>'+'<opt name="historyItemTemplate" type="function" value="tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterAuthor"/>'+'<opt name="filterBLName" value="ФильтрАвторИлиОтветственный"></opt>'+'</opts>';},getFilterStructure:function(e,t){var i=[{internalValueField:'FilterDatePeriod',internalCaptionField:'FilterDatePeriodText',filterField:'ФильтрДатаПериод',resetValue:'Месяц',value:null,itemTemplate:'html!SBIS3.EDO.DetalizationEvents/tplFilterDatePeriod'},{internalValueField:'FilterDateFrom',internalCaptionField:'FilterDateFromText',filterField:'ФильтрДатаС',resetValue:null,itemTemplate:null,historyItemTemplate:null,value:null},{internalValueField:'FilterDateTo',internalCaptionField:'FilterDateToText',filterField:'ФильтрДатаП',resetValue:null,itemTemplate:null,historyItemTemplate:null,value:null},{internalValueField:'FilterIdRegulation',internalCaptionField:'FilterIdRegulationText',filterField:'ИдРегламента',resetValue:null,value:null,itemTemplate:t&&t['ИдРегламента']?'tmpl!SBIS3.EDO.StatEDOBrowserPP/resources/tplFilterIdRegulations':'tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterIdRegulations',internalVisibilityField:'FilterRegulationVisibility',resetVisibilityValue:false},{internalValueField:'FilterLimitationDate',internalCaptionField:'FilterLimitationDateText',filterField:'ФильтрСрокДата',resetValue:null,value:null,internalVisibilityField:'FilterLimitationDateVisibility',resetVisibilityValue:false},{internalValueField:'FilterFace1',internalCaptionField:'FilterFace1Text',filterField:'ФильтрЛицо1',resetValue:[],itemTemplate:'tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterFace1',historyItemTemplate:'tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterFace1',value:[],internalVisibilityField:'FilterFace1Visibility',resetVisibilityValue:false},{internalValueField:'FilterAuthorOrResponsible',internalCaptionField:'FilterAuthorOrResponsibleText',filterField:'ФильтрАвторИлиОтветственный',resetValue:[],value:[],itemTemplate:'tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterAuthor',historyItemTemplate:'tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterAuthor',internalVisibilityField:'FilterAuthorOrResponsibleVisibility',resetVisibilityValue:false},{internalValueField:'FilterListDispatch',internalCaptionField:'FilterListDispatchText',filterField:'ФильтрСписокРассылки',resetValue:[],value:[],itemTemplate:'tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterListDispatch',historyItemTemplate:'tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterListDispatch',internalVisibilityField:'FilterListDispatchVisibility',resetVisibilityValue:false},{internalValueField:'FilterMilestone',internalCaptionField:'FilterMilestoneText',filterField:'ФильтрПоВехе',resetValue:[],value:[],itemTemplate:'tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterMilestone',internalVisibilityField:'FilterMilestoneVisibility',resetVisibilityValue:false},{internalValueField:'FilterMarksIncluded',internalCaptionField:'FilterMarksIncludedText',filterField:'ФильтрПометкиВкл',resetValue:[],value:[],itemTemplate:'tmpl!SBIS3.EDO2.MarksFilterRowTemplate/tmpl/MarksFilterRowTemplate',internalVisibilityField:'FilterMarksVisibility',resetVisibilityValue:false},{internalValueField:'FilterMarksExcluded',internalCaptionField:'FilterMarksExcludedText',filterField:'ФильтрПометкиИскл',resetValue:[],value:[],itemTemplate:'tmpl!SBIS3.EDO2.MarksFilterRowTemplate/tmpl/MarksFilterRowTemplate'},{internalValueField:'FilterResponsibleFace',internalCaptionField:'FilterResponsibleFaceText',filterField:'ФильтрОтветственноеЛицо',resetValue:[],value:[],itemTemplate:'tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterResp',historyItemTemplate:'tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterResp',internalVisibilityField:'FilterResponsibleFaceVisibility',resetVisibilityValue:false},{internalValueField:'FilterRepeatStages',internalCaptionField:'FilterRepeatStagesText',filterField:'ФильтрПовторные',resetValue:null,value:null,internalVisibilityField:'FilterRepeatStagesVisibility',resetVisibilityValue:false},{internalValueField:'FilterPassageStatus',internalCaptionField:'FilterPassageStatusText',filterField:'ФильтрСтатусПерехода',resetValue:null,value:null,internalVisibilityField:'FilterPassageStatusVisibility',resetVisibilityValue:false},{internalValueField:'FilterOverdue',internalCaptionField:'FilterOverdueText',filterField:'ФильтрПросроченные',resetValue:null,value:null,internalVisibilityField:'FilterLimitationOverdueVisibility',resetVisibilityValue:false},{internalValueField:'FilterPriority',internalCaptionField:'FilterPriorityText',filterField:'ФильтрПриоритет',resetValue:null,value:null,internalVisibilityField:'FilterPriorityVisibility',resetVisibilityValue:false},{internalValueField:'FilterSender',internalCaptionField:'FilterSenderText',filterField:'ФильтрОтправитель',resetValue:[],value:[],internalVisibilityField:'FilterSenderVisibility',resetVisibilityValue:false},{internalValueField:'FilterReceiver',internalCaptionField:'FilterReceiverText',filterField:'ФильтрПолучатель',resetValue:[],value:[],internalVisibilityField:'FilterReceiverVisibility',resetVisibilityValue:false},{internalValueField:'FilterIdPhase',internalCaptionField:'FilterIdPhaseText',filterField:'ФильтрИдФазы',resetValue:null,value:null,internalVisibilityField:'FilterIdPhaseVisibility',resetVisibilityValue:false},{internalValueField:'FilterTransition',internalCaptionField:'FilterTransitionText',filterField:'ФильтрПереход',resetValue:null,value:null,internalVisibilityField:'FilterTransitionVisibility',resetVisibilityValue:false}];if(e['ФильтрСтатистикаТекущие'])i=i.slice(3);for(var l=0;l<i.length;l++){if(e.hasOwnProperty(i[l].filterField)&&e[i[l].filterField])i[l].value=e[i[l].filterField],i[l].caption=e[i[l].filterField+'Текст'];if(t&&t.hasOwnProperty(i[l].filterField)&&t[i[l].filterField])i[l].resetValue=t[i[l].filterField],i[l].resetVisibilityValue=true;if(t&&t.hasOwnProperty(i[l].filterField+'Текст')&&t[i[l].filterField+'Текст'])i[l].resetCaption=t[i[l].filterField+'Текст'];}return i;},getStatisticsBrowserColumns:function(e,t,i,l,r){var a=[{title:'  ',field:'Название',className:'Название controls-DataGridView-cell-overflow-ellipsis',cellTemplate:'tmpl!SBIS3.EDO.StatEDOBrowserPP/resources/TitleCell',includedTemplates:[{photoTpl:'html!SBIS3.PersonCore.Photo/photoCellTpl'}],templateBinding:{photoFieldName:'userPhotoData',cssClass:'person-photo-mini-large'}}];if(e&&e.getCount()>0){var n=function(e,r,a,n,s,p){var u='Просрочено'===r?'<div title="{[Нарушен срок]}" style="margin-top: 3px;float: right;" class="icon-16 icon-Time icon-disabled edo-statistics-overdue-count"></div>':'tmpl!SBIS3.EDO.StatEDOBrowserPP/resources/CaptionCell';return o+=t?2*e:e,{width:t?2*e:e,title:r,field:a,cellTemplate:'tmpl!SBIS3.EDO.StatEDOBrowserPP/resources/DataCell',templateBinding:{isOverdue:n,fieldName:a,isTotal:s,nextReportName:!s?i:'',filterName:l,columnId:p,hideOverdueColumn:t},resultTemplate:'tmpl!SBIS3.EDO.StatEDOBrowserPP/resources/ResultCell',headTemplate:u,className:'phase-report-fix-font-weight'+((!n||t)&&'Прочее'!==r?' phase-report-total-right-border':'')+((n||t)&&'Просрочено'!==r?' edo_stat_report_caption_border':'')};},o=0,s=e.getMetaData().results,p=s.has('-1##Прочее')&&3===s.get('-1##Прочее').split(',').length?parseInt(s.get('-1##Прочее').split(',')[2],10):5,u=e.getFormat()._$items||[],d;if(!t&&parseInt(s.get('Итого').split(',')[1],10)&&0!==parseInt(s.get('Итого').split(',')[1],10))a.push(n(parseInt(s.get('Итого').split(',')[3],10),'Просрочено','Итого',true,true));a.push(n(parseInt(s.get('Итого').split(',')[2],10),rk('Всего'),'Итого',false,true));for(var m=11,f=11+p;m<f&&m<u.length-1;++m)if(u.hasOwnProperty(m))if('userPhotoData'!==u[m]._$name){var F=u[m]._$name.split('##')[1].substr(0,60).replace(/\./gi,'&#046;'),c=Math.floor(parseInt(s.get(u[m]._$name).split(',')[4],10)/2),g='';if(d=s.has(u[m]._$name)?s.get(u[m]._$name).split(',')[0]:null,'0'!==d){if(g=u[m]._$name,!t)a.push(n(c,F,g,true,false,g.split('##')[0]));a.push(n(c,F,g,false,false,g.split('##')[0]));}}if(d=s.has(u[10]._$name)?s.get(u[10]._$name).split(',')[0]:null,d&&'0'!==d){if(!t)a.push(n(45,'Прочее','-1##Прочее',true,false,-1));a.push(n(45,'Прочее','-1##Прочее',false,false,-1));}if(r-o<o)a[0].width=r-o;}return a;}};function f(e){var t=[{title:rk('Обработка внутри компании'),id:null}],i=e.getPath();if(i.shift(),i.length>=1)t=t.concat(i);e.setRootNodeView('icon'),e.setPath(t),e.getPath()[0].id=-1000,e.getContainer().find('span').first().attr({title:rk('К выбору отчета')});}function F(e,t){var i='';switch(t){case'ВОбработкеПросрочено':case'ВОбработке':if(i=rk('В обработке')+' '+n.real(e.get('ВОбработке'),0,true),e.get('ВОбработкеПросрочено'))i+=' ('+rk('в т.ч.')+' '+n.real(e.get('ВОбработкеПросрочено'),0,true)+' '+rk('нарушен срок')+')';break;case'Завершено':case'ЗавершеноПросрочено':if(i=rk('Завершено')+' '+n.real(e.get('Завершено'),0,true),e.get('ЗавершеноПросрочено'))i+=' ('+rk('в т.ч.')+' '+n.real(e.get('ЗавершеноПросрочено'),0,true)+' '+rk('нарушен срок')+')';break;case'Положительно':i=rk('Завершено положительно')+' '+n.real(e.get('Положительно'),0,true);break;case'Отрицательно':i=rk('Завершено отрицательно')+' '+n.real(e.get('Отрицательно'),0,true);}return i;}function c(e){var t={'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;','\'':'&#39;','/':'&#x2F;'};return String(e).replace(/[&<>"'\/]/g,function(e){return t[e];});}function g(e){for(var t in e)if(-1!==e[t].indexOf('span'))e[t]=$(e[t]).text();return e;}return m;});
define('js!SBIS3.EDO.FolderDialogAction',['js!SBIS3.Engine.SBISOpenDialogAction','Elektronnyj_dokumentooborot_localization'],function(e){'use strict';return e.extend({$protected:{_options:{template:'js!SBIS3.EDO.UserFolderDialog'}}});});
define("tmpl!SBIS3.EDO.FMyTasks/FMyTasks",["Core/tmpl/js/tclosure","js!SBIS3.EDO.BrowserWrapperPP","js!SBIS3.EDO2.OpenDialogAction","js!SBIS3.EDO.FolderDialogAction","js!SBIS3.EDO.FEdoPartialReloader"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.EDO.BrowserWrapperPP"]=e[1],r["js!SBIS3.EDO2.OpenDialogAction"]=e[2],r["js!SBIS3.EDO.FolderDialogAction"]=e[3],r["js!SBIS3.EDO.FEdoPartialReloader"]=e[4];var a=function e(a,i,o,s,n){function l(){}var d=0,g=void 0!==t&&t?t:arguments[arguments.length-1];void 0===g&&(eval("var thelpers = null;"),g=global.requirejs("View/Runner/tclosure"));var c={};n&&n.isSetts&&(c=n.fullContext||{});var m="string"==typeof o?o:"",p=void 0===r?void 0:r,y={id:[],def:void 0},_=g.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,a),h=this&&this.includedTemplates?this.includedTemplates:{},f=g.getMarkupGenerator(s);try{var u=f.joinElements([f.createTag("div",{class:"edo-FMyTasks__wrapper"},[f.createControl("wsControl","ws:SBIS3.EDO.BrowserWrapperPP",{browserOptions:{hierarchy:{allow:!!g.getter(a,["hierAllow"])||"",parentProperty:g.getter(a,["parentProperty"])||"ПапкаДокументов",displayProperty:g.getter(a,["displayProperty"])||"Название",arrowActivatedHandler:g.getter(a,["arrowActivatedHandler"])},common:{filterParams:g.getter(a,["filterParams"]),firstRequest:!g.getter(a,["serverSideRendering"])&&(void 0===g.getter(a,["firstRequestStatus"])||g.getter(a,["firstRequestStatus"])),navigationType:"Offset",objectName:g.getter(a,["objectName"])||"СвязьПапок",method:g.getter(a,["method"])||"ДокументыВПапке",model:g.getter(a,["model"])||"TaskRegistryModel"},itemsActionsVisibility:g.getter(a,["itemsActionsVisibility"]),massActionsVisibility:g.getter(a,["massActionsVisibility"]),massActionsSettings:g.getter(a,["massActionsSettings"]),allowEmptySelection:!1,allowToggleHead:!1,className:"edo-MyTasks__view controls-TreeDataGridView__withPhoto "+g.getter(a,["addBrowserClass"]),isFolderOnTop:!0,hasSeparator:!1,infiniteScrollContainer:g.getter(a,["infiniteScrollContainer"]),showHead:g.getter(a,["showHead"]),viewMode:"table",idProperty:g.getter(a,["idProperty"])||"@СвязьПапок",bind:"browser.filter",ladder:g.getter(a,["ladder"]),emptyHTML:global.rk("Нет задач"),itemsDragNDrop:void 0!==g.getter(a,["itemsDragNDrop"])?g.getter(a,["itemsDragNDrop"]):!!g.getter(a,["allowDragNDropMove"])||"",itemsActions:g.getter(a,["itemsActions"]),handlers:g.getter(a,["handlers"]),pageSize:21,navigation:{lastPage:!0},columns:g.getter(a,["columns"])},name:g.getter(a,["myTaskBrName"])||"MyTasks",useScrollContainer:g.getter(a,["useScrollContainer"]),noScrollHeight:g.getter(a,["noScrollHeight"]),tapeReestr:g.getter(a,["tapeReestr"]),tapeContent:g.getter(a,["tapeContent"]),searchConfig:g.getter(a,["searchConfig"]),historyId:g.getter(a,["historyId"])?g.getter(a,["historyId"]):g.getter(a,["doNotUseHistoryId"])?"":"MyTasks",backButtonEditing:!!g.getter(a,["backButtonEditing"])||"",useScope:!!g.getter(a,["useScope"])||"",listMethodByScope:g.getter(a,["listMethodByScope"]),isSingleTypeBrowser:!1,listData:g.getter(a,["listData"]),tasksExists:g.getter(a,["tasksExists"]),foldersExists:g.getter(a,["foldersExists"]),serverSideRendering:g.getter(a,["serverSideRendering"]),ignoreFiltersList:g.getter(a,["ignoreFiltersList"]),fastDataFilterConfig:g.getter(a,["fastDataFilterConfig"]),filterButtonConfig:g.getter(a,["filterButtonConfig"]),operationsPanelConfig:g.getter(a,["operationsPanelConfig"]),esc:!1,bindings:[{fieldName:""+g.getter(a,["dataField"]),propName:"browserOptions/common/filterParams/Лицо",propPath:["common","filterParams","Лицо"],fullPropName:"browserOptions/common/filterParams/Лицо",propPathStr:"common/filterParams/Лицо",oneWay:!0,direction:"fromContext",bindNonExistent:!1}]},{class:"MyTasks "+g.utils.escape(g.getter(a,["addClass"])||""),name:g.getter(a,["myTaskBrName"])||"MyTasks",sbisname:g.getter(a,["myTaskBrName"])||"MyTasks"},{data:a,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:_,internal:{__dirtyCheckingVars_0:!!g.getter(a,["hierAllow"])||"",__dirtyCheckingVars_1:g.getter(a,["parentProperty"])||"ПапкаДокументов",__dirtyCheckingVars_2:g.getter(a,["displayProperty"])||"Название",__dirtyCheckingVars_3:g.getter(a,["arrowActivatedHandler"]),__dirtyCheckingVars_4:g.getter(a,["filterParams"]),__dirtyCheckingVars_5:!g.getter(a,["serverSideRendering"])&&(void 0===g.getter(a,["firstRequestStatus"])||g.getter(a,["firstRequestStatus"])),__dirtyCheckingVars_6:g.getter(a,["objectName"])||"СвязьПапок",__dirtyCheckingVars_7:g.getter(a,["method"])||"ДокументыВПапке",__dirtyCheckingVars_8:g.getter(a,["model"])||"TaskRegistryModel",__dirtyCheckingVars_9:g.getter(a,["itemsActionsVisibility"]),__dirtyCheckingVars_10:g.getter(a,["massActionsVisibility"]),__dirtyCheckingVars_11:g.getter(a,["massActionsSettings"]),__dirtyCheckingVars_14:"edo-MyTasks__view controls-TreeDataGridView__withPhoto "+g.getter(a,["addBrowserClass"]),__dirtyCheckingVars_17:g.getter(a,["infiniteScrollContainer"]),__dirtyCheckingVars_18:g.getter(a,["showHead"]),__dirtyCheckingVars_19:g.getter(a,["idProperty"])||"@СвязьПапок",__dirtyCheckingVars_20:g.getter(a,["ladder"]),__dirtyCheckingVars_22:void 0!==g.getter(a,["itemsDragNDrop"])?g.getter(a,["itemsDragNDrop"]):!!g.getter(a,["allowDragNDropMove"])||"",__dirtyCheckingVars_23:g.getter(a,["itemsActions"]),__dirtyCheckingVars_24:g.getter(a,["handlers"]),__dirtyCheckingVars_27:g.getter(a,["columns"])}},o,p,h,g.config,c),f.createControl("wsControl","ws:SBIS3.EDO2.OpenDialogAction",{name:"MyTasksAction",isEventsReestr:g.getter(a,["isEventsReestr"]),tabindex:"0"},{name:"MyTasksAction",sbisname:"MyTasksAction"},{data:a,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:_},o,p,h,g.config,c),f.createControl("wsControl","ws:SBIS3.EDO.FolderDialogAction",{name:"FolderAction",tabindex:"0"},{name:"FolderAction",sbisname:"FolderAction"},{data:a,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:_},o,p,h,g.config,c),g.getter(a,["useAutoRefresh"])?[f.createControl("wsControl","ws:SBIS3.EDO.FEdoPartialReloader",{actionEventsToListen:["onUpdateModel","onDestroyModel"],tabindex:"0",name:"PartialReloader",objectName:g.getter(a,["objectName"])||"СвязьПапок",method:g.getter(a,["method"])||"ДокументыВПапке",filterName:g.getter(a,["partialReloader","filterName"])||"СписокИдО",sortField:g.getter(a,["partialReloader","turnOffSort"])?"":g.getter(a,["partialReloader","sortField"])||"ПорНомер",overrideItemsSortMethod:!0,updateOnDeleteAndAdd:g.getter(a,["partialReloader","updateOnDeleteAndAdd"])||!1,addServerChannelName:g.getter(a,["partialReloader","addServerChannelName"])||"",fixServerChannelName:g.getter(a,["partialReloader","fixServerChannelName"])||"",deleteServerChannelName:g.getter(a,["partialReloader","deleteServerChannelName"])||"",nameTaskHier:g.getter(a,["partialReloader","nameTaskHier"])||"",analyzeHierFieldOnTaskAdd:g.getter(a,["parentProperty"])||"ПапкаДокументов",forbidSubtasksAdd:g.getter(a,["partialReloader","forbidSubtasksAdd"])||!1,updateAccordeonCountersEventName:"",esc:!1},{name:"PartialReloader",sbisname:"PartialReloader"},{data:a,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:_},o,p,h,g.config,c)]:f.createText("")],i,y,this)],m,y);y.def&&(u=f.chain(u,y,i),y=void 0)}catch(e){g.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/FMyTasks/FMyTasks.tmpl",e,a)}return u||""};return a.includedFunctions={},a.stable=!0,a.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FMyTasks/FMyTasks"}},a});
define('js!SBIS3.EDO.Modificators.MyTasks.List',['js!SBIS3.EDO.Modificators.DefaultModificator','Elektronnyj_dokumentooborot_localization'],function(e){'use strict';function t(){e.apply(this,arguments),this._allowedItems=['edoReadDocument','edoMoveDocument','edoRemoveTransferredTasks','edoDeleteUserFolder'],this._allowedMOPItems=['edoSetControlDocumentMass'];}return t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.prototype.getFilterButtonConfig=function(){return{template:'SBIS3.EDO.FilterTasksMine',additionalFilterParamsTemplate:'SBIS3.EDO.FilterTasksMineSelector',filterStructure:this._getFilterStructure(['ФильтрДатаПериод','ФильтрДатаС','ФильтрДатаП','ФильтрПросроченные','ИдРегламента','ФильтрИдФазы','ФильтрСрокДата','ФильтрЛицо1','ФильтрОтправитель','ФильтрАвторИлиОтветственный','ФильтрПоВехе','Проект','ФильтрНепрочитанные','ФильтрПометкиВкл','ФильтрПометкиИскл','ФильтрЗонаОтветственности','ПапкаДокументов','ПростыеВД','РассчитатьФото','ПоказИерархии','ВключитьСписокИсполнителей','ВнешняяИерархия'])};},t.prototype.modifyFilterConfigs=function(e){return delete e[9].itemTemplate,e;},t;});
define('js!SBIS3.EDO.FMyTasksHandlers',['i18n!SBIS3.EDO.FMyTasksHandlers','Elektronnyj_dokumentooborot_localization'],function(){'use strict';var t;return t={setPrintColumns:function(t){t.setResult([{field:'Документ.Дата',title:rk('Дата')},{field:'Документ.Номер',title:rk('Номер')},{field:'РазличныеДокументы.Информация',title:rk('Описание')},{field:'РП.АктивнаяФаза',title:rk('Статус')},{field:'Сотрудник.Название',title:rk('Ответственный')}]);},setPrintColumns_executed:function(t){t.setResult([{field:'Дата',title:rk('Дата')},{field:'Документ.Номер',title:rk('Номер')},{field:'РазличныеДокументы.Информация',title:rk('Описание')},{field:'Переход.Название',title:rk('Статус')},{field:'Сотрудник.Название',title:rk('Ответственный')}]);},setPrintColumns_tab:function(t){t.setResult([{field:'Дата',title:rk('Дата')},{field:'Документ.Номер',title:rk('Номер')},{field:'РазличныеДокументы.Информация',title:rk('Описание')},{field:'РП.АктивнаяФаза',title:rk('Статус')},{field:'Лицо.Название',title:rk('Ответственный')}]);}};});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.FMyTasks", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".MyTasks.edo-Browser .controls-Browser__view table.controls-DataGridView__table{table-layout:fixed}.MyTasks .controls-ListView__item-type-hidden .controls-TreeView__expand{display:none}.MyTasks .rt_subtasks{display:none}.MyTasks .filterLine__itemTemplate{display:inline}.ctrFilterLinkDate{float:right;color:#05b;font-size:12px;height:15px}.ws-is-firefox .ctrFilterLinkDate{height:17px}.ctrFilterLinkReceived{color:#05b;font-size:12px;height:14px}.ctrFilterLinkDate .controls-Link__field{margin-left:0!important}.ctrFilterLinkReceived .controls-Link__field{margin-left:0!important}.fieldStatusAlign{height:24px;line-height:24px}.edo-MyTasks__view th .controls-Link,.edo-MyTasks__view th div{line-height:normal}#edoBrowserArea{height:100%}.edo-Browser .text-base-line.first-base-line{line-height:18px}.edo-Browser .first-base-line:before{font-size:18px;line-height:18px}.edo-Browser .text-base-line.second-base-line{line-height:18px}.edo-Browser .second-base-line:before{font-size:16px;line-height:18px}.mytask_area_caption.controls-Link{font-size:18px;margin-left:8px;margin-top:3px;margin-bottom:2px;font-weight:700;height:34px}.edo-FMyTaskTapeTab__floatArea,.edo-FMyTaskTapeTab__wrapper{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-moz-flex-direction:column;-ms-flex-direction:column;flex-direction:column;height:100%;position:relative}.edo-FMyTaskTapeTab__floatArea{position:absolute}.edo-FMyTasks__wrapper{height:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-moz-flex-direction:column;-ms-flex-direction:column;flex-direction:column}.MyTasks .controls-ListView__EmptyData{padding:15px 16px 0 16px}"));head.appendChild(style);});}
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.FTasksGroupByType", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".tgs-milestones{width:calc(100% - 57px)}.tgs-projects{width:calc(100% - 76px)}.tgs-types{width:calc(100% - 59px)}.controls-GroupBy{border-right:1px solid #f4f4f4}.TaskGroupItem{white-space:nowrap}.controls-ListView .controls-ListView__item.TaskGroupItem{height:30px;line-height:30px;cursor:pointer;padding:0 10px}.TaskGroupItem_new{color:#ff7033}.TaskGroupItem_all{color:#587ab0;padding-right:2px}.TaskGroupItem_delim{color:#f4f4f4}.TaskGroupItem_new_counters{padding:0 6px;position:absolute;top:0;right:0;background-color:#fff;min-width:8px;min-height:30px;display:inline-block}.TaskGroupItem_title:after{padding:3px 6px;content:\"\\00a0\";box-sizing:content-box;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;position:absolute;width:20px;line-height:30px;right:0;text-align:right;background-size:100% 100%;background:-moz-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,1) 45%);background:-webkit-gradient(linear,left top,right top,color-stop(0,rgba(255,255,255,0)),color-stop(45%,rgba(255,255,255,1)));background:-webkit-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,1) 45%);background:-o-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,1) 45%);background:-ms-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,1) 45%);background:linear-gradient(to right,rgba(255,255,255,0) 0,rgba(255,255,255,1) 45%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#00ffffff', endColorstr='#ffffff', GradientType=1)}.TaskGroupItem_title.TaskGroupItem_title_length2:after{width:30px}.TaskGroupItem_title.TaskGroupItem_title_length3:after{width:40px}.controls-ListView__hoveredItem .TaskGroupItem_title:after{background:-moz-linear-gradient(left,rgba(255,255,255,0) 0,rgba(240,245,251,1) 45%);background:-webkit-gradient(linear,left top,right top,color-stop(0,rgba(255,255,255,0)),color-stop(45%,rgba(240,245,251,1)));background:-webkit-linear-gradient(left,rgba(255,255,255,0) 0,rgba(240,245,251,1) 45%);background:-o-linear-gradient(left,rgba(255,255,255,0) 0,rgba(240,245,251,1) 45%);background:-ms-linear-gradient(left,rgba(255,255,255,0) 0,rgba(240,245,251,1) 45%);background:linear-gradient(to right,rgba(255,255,255,0) 0,rgba(240,245,251,1) 45%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#00ffffff', endColorstr='#F0F5FB', GradientType=1)}.TaskGroupItem:hover div{background-color:transparent}.edo-TasksGroupByType-sep{text-align:right;font-size:12px;color:#8991a9;padding-right:5px;border-right:1px solid #f4f4f4}.edo-TasksGroupByType-sep .delimiter:hover .arr,.edo-TasksGroupByType-sep .delimiter:hover .groupTypeName{color:#313e78;cursor:pointer}.edo-TasksGroupByType-sep em{display:inline-block;border-bottom:1px solid #eaeaea;margin-right:8px;margin-bottom:3px}.edo-TasksGroupByType-sep span.arr{display:inline-block;width:12px;height:24px;font-size:15px;vertical-align:middle;cursor:pointer;margin-right:4px}.edo-TasksGroupByType-sep span.arr:before{content:'\\E013'}.edo-TasksGroupByType-sep span.arr.exp:before{content:'\\E000'}.edo-TasksGroupByType .TaskGroupItem_title{font-size:15px;margin-left:2px;max-width:130px;display:inline-block}.edo-TasksGroupByType .TaskGroupItem{border-top:1px solid transparent;border-bottom:1px solid transparent}.edo-TasksGroupByType .TaskGroupItem{border-right:1px solid #f4f4f4}.edo-TasksGroupByType .controls-ListView__item__selected{border-bottom:1px solid #f4f4f4!important;border-top:1px solid #f4f4f4!important;border-right:1px solid #fff!important}.TaskGroupItem .Person-PersonPhoto{margin-left:3px;margin-right:6px;vertical-align:middle;margin-bottom:4px}"));head.appendChild(style);});}
define('js!SBIS3.EDO.FMyTasks',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FMyTasks/FMyTasks','js!SBIS3.EDO.Modificators','js!SBIS3.EDO.Modificators.MyTasks.List','js!SBIS3.EDO.FMyTasksHandlers','js!SBIS3.EDO.EdoCommon','js!SBIS3.EDO.EdoRecOptions','js!SBIS3.EDO.EdoClicks','WS.Data/Source/SbisService','Core/Context','SBIS3.CONTROLS/Action/List/InteractiveMove','js!SBIS3.EDO.TaskRegistryModel','tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/THeadMainColumn','tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TMainColumn','tmpl!SBIS3.EDO2.Browser/resources/columns/tmpl/StateColumn','tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TStateColumn','tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/THeadStateWithReceived','tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TStateWithReceivedColumn','tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TDateColumn','tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TDocDateColumn','tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/THeadDateDone','tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/THeadDateRecieved','js!SBIS3.EDO.BrowserWrapperPP','css!SBIS3.EDO.FMyTasks','js!SBIS3.EDO2.OpenDialogAction','js!SBIS3.EDO.FolderDialogAction','js!SBIS3.EDO.FEdoPartialReloader','css!SBIS3.EDO.TaskCol','css!SBIS3.EDO.DateCol','css!SBIS3.EDO.BrowserWrapperPP/resources/columnStyles','SBIS3.CONTROLS/Link','i18n!SBIS3.EDO.FMyTasks','css!SBIS3.EDO.FTasksGroupByType','Elektronnyj_dokumentooborot_localization'],function(e,t,o,s,a,r,l,i,n,d,p){'use strict';var m=e.extend({_dotTplFn:t,$protected:{_options:{listData:null,showUnread:false,informers:{},itemsActionsVisibility:{edoSaveDocumentOnDisk:false,edoSendDocument:false,edoDeleteDocument:false,edoShowDkPanel:false,edoPostDocument:false,edoRestoreDocument:false},massActionsSettings:{edoPrintDocumentMass:{recursive:false,minPrintWindowWidth:666,handlers:{onApplyOperation:a.setPrintColumns},items:[],documentIdField:'@Документ'},edoMoveDocumentMass:{filter:{'ПоказИерархии':true,'СписокДляПеремещения':true}}},ignoreFiltersList:['Лицо','ПапкаДокументов','ФильтрПриоритет','ПоказИерархии','ФильтрЛицо1','ВнешняяИерархия','ФильтрУдаленные','ФильтрИсполнительСобытия','ФильтрКонкретныйИсполнитель','ФильтрКонкретныйИсполнительID','ФильтрВладелец','ФильтрНезакрепленные'],columns:[]}},$constructor:function(){this._lazyLoading();},_lazyLoading:function(){var e=[],t=function(e){return e=e||'',0===e.indexOf('tmpl');};if(t(this._options.dateColTemplate))e.push(this._options.dateColTemplate);if(t(this._options.descColTemplate))e.push(this._options.descColTemplate);if(t(this._options.additionalTaskColTemplate))e.push(this._options.additionalTaskColTemplate);if(t(this._options.dateColHeadTemplate))e.push(this._options.dateColHeadTemplate);if(e.length)require(e);},destroy:function(){if(this.hasChildControlByName('browserView'))this.getChildControlByName('browserView')._options.interactiveMoveObject.destroy();m.superclass.destroy.apply(this,arguments);},init:function(){m.superclass.init.call(this);var e=this,t=e.hasChildControlByName('browserView')?e.getChildControlByName('browserView'):null;if(new n({endpoint:'ПапкаДокументов'}).call('ИдентификаторыСлужебных',{fid:'МоиЗадачи',face:null}).addCallback(function(e){d.global.setValue('ПапкиТекущегоПользователя',e.getRow());}),t)t._options.interactiveMoveObject=new p({linkedObject:t,componentOptions:{filter:{'ПоказИерархии':true,'СписокДляПеремещения':true}}});},_modifyOptions:function(){var e=m.superclass._modifyOptions.apply(this,arguments),t=new o(new s()),a={};if(e&&e.listData&&e.listData.filter)a=e.listData.filter;if(e.showUnread)e.filterParams['ФильтрНепрочитанные']=true,a['ФильтрНепрочитанные']=true;if(e.handlers=this._getHandlers(e),e.itemsActions=e.itemsActions||t.getActions(),e.operationsPanelConfig=e.operationsPanelConfig||t.getMOPActions()||{},e.massActionsVisibility=e.massActionsVisibility||{edoSetCloseStatusMass:false,edoPostsMass:false,edoRestoreDocumentMass:false,edoSetDocumentReadedMass:true,edoDeleteDocumentMass:false,edoMoveDocumentMass:e.showMoveTasksMass},'object'==typeof e.operationsPanelConfig)e.operationsPanelConfig.hasItemsMenu=true;return e.filterButtonConfig=e.filterButtonConfig||t.getFilterButtonConfig(a),e.columns=this.getColumns(e),e;},getColumns:function(e){var t=[],o,s,a,r=false;if(o={className:'controls-DataGridView-cell-overflow-ellipsis',cellTemplate:e.descColTemplate||'tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TMainColumn',headTemplate:e.taskColHeadTemplate||'tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/THeadMainColumn',includedTemplates:{TaskCol:e.additionalTaskColTemplate||''},templateBinding:{personId:e.personId,photoId:e.photoId,photoFldName:'erPhotoDa',cssClass:'rson-photo-mini-lar',useFaceField:true,isNotCheckShortStateForPeriodRender:!!e.isNotCheckShortStateForPeriodRender,detalizationTitlePrefix:e.detalizationTitlePrefix?e.detalizationTitlePrefix:'',needCommentPrevStage:!!e.needCommentPrevStage,isMakeCustomPeriodRender:!!(e.isDetalization||e.isExecuted)}},!e.dateColHeadTemplate&&!e.dateColTitle)r=true;if(s={width:164,title:e.dateColTitle||rk('Получено'),headTemplate:'tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/THeadStateWithReceived',cellTemplate:'tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TStateWithReceivedColumn',includedTemplates:{additionalStateColumn:e.statusColTemplate,edoStateColumn:'tmpl!SBIS3.EDO2.Browser/resources/columns/tmpl/StateColumn',DateCol:'tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TDateColumn'},templateBinding:{showRule:false,stateWidth:164,date_field:e.dateColField||'Начало',ladderField:e.ladderField,dateHeadTitle:e.dateColTitle,dateCellTemplate:e.dateColTemplate||null,dateHeadTemplate:r?'tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/THeadDateRecieved':e.dateColHeadTemplate,closedEventsBrowser:!!e.isExecuted||!!e.closedEventsBrowser,dateTitle:rk('Получено')+': '}},a=e.additionalColumn,t.push(o),t.push(s),a)t.push(a);return t;},_getHandlers:function(e){if('string'===typeof e.onChangeHoveredItemHandler&&e.onChangeHoveredItemHandler in l)e.onChangeHoveredItemHandler=l[e.onChangeHoveredItemHandler];var t={onReady:[e.addMoveStrategy||r.addMoveStrategy],onItemClick:[i.clickDisp],onBeforeProviderCall:[r.onBeforeDataLoadEvent],onChangeHoveredItem:[e.onChangeHoveredItemHandler||l.onChangeHoveredItem]};if(e.needDataLoadHandler)t.onReady.push(r.setDataLoadHandler);if(!e.tapeReestr)t.onReady.push(r.addRefresh);return t;}});return m;});
define("tmpl!SBIS3.EDO.PassageStatus",["Core/tmpl/js/tclosure","js!SBIS3.CONTROLS/Filter/Button/Dropdown"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.CONTROLS/Filter/Button/Dropdown"]=e[1];var o=function e(o,i,a,n,l){function s(){}var d=0,u=void 0!==t&&t?t:arguments[arguments.length-1];void 0===u&&(eval("var thelpers = null;"),u=global.requirejs("View/Runner/tclosure"));var p={};l&&l.isSetts&&(p=l.fullContext||{});var c="string"==typeof a?a:"",m=void 0===r?void 0:r,S={id:[],def:void 0},f=u.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),y=this&&this.includedTemplates?this.includedTemplates:{},v=u.getMarkupGenerator(n);try{var P=v.joinElements([v.createTag("div",{},[v.createControl("wsControl","ws:SBIS3.CONTROLS/Filter/Button/Dropdown",{items:[{key:"1,3",title:global.rk("Положительный статус перехода")},{key:"2,4",title:global.rk("Отрицательный статус перехода")}],SelectedKeys:[],commandArgs:["FilterPassageStatusVisibility",Boolean(!1)],resetKey:null,multiselect:!1,allowEmptyMultiSelection:!0,bindings:[{fieldName:"FilterPassageStatusVisibility",propName:"visible",propPath:[],fullPropName:"visible",propPathStr:"",oneWay:!0,direction:"fromContext",bindNonExistent:!0},{fieldName:"FilterPassageStatusText",propName:"text",propPath:[],fullPropName:"text",propPathStr:"",oneWay:!1,direction:"fromContext",bindNonExistent:!1},{fieldName:"FilterPassageStatus",propName:"SelectedKeys/0",propPath:["0"],fullPropName:"SelectedKeys/0",propPathStr:"0",oneWay:!1,direction:"fromContext",bindNonExistent:!1}],visible:"",text:void 0,command:"change-field-internal",esc:!1},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},a,m,y,u.config,p)],i,S,this)],c,S);S.def&&(P=v.chain(P,S,i),S=void 0)}catch(e){u.templateError("resources/Elektronnyj_dokumentooborot/Statistika/Filtry/PassageStatus/PassageStatus.tmpl",e,o)}return P||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.PassageStatus"}},o});
define('js!SBIS3.EDO.PassageStatus',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.PassageStatus','SBIS3.CONTROLS/Filter/Button/Dropdown','Elektronnyj_dokumentooborot_localization'],function(t,n){var o=t.extend({_dotTplFn:n,$protected:{_options:{}},$constructor:function(){},init:function(){o.superclass.init.call(this);}});return o;});
define("html!SBIS3.EDO.FilterDateLimitation",function(){var t=function(t){var n=function(){var t=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;t.test(n);)n=n.replace(t,"&#123;&#123;$1&#125;&#125;");return n}}(),e=function(t){return t.join?t.join(""):t.toString()},o=function(t){return void 0===t?"":t&&"object"==typeof t?e(t):""+t},i="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div style="height:32px;" class="edo-filterDateLimitation"> <div style="float:left;height:24px;line-height:24px;margin-right:8px;text-align:right;"> '+n(o(rk("Срок выполнения")))+' </div> <component class="ws-hidden" data-component="SBIS3.CONTROLS/Link" name="DatePickerLink" style="float:left;height:24px;"> <option name="caption">'+n(o(rk("не выбран")))+'</option> </component> <component data-component="SBIS3.CONTROLS/Date/Picker" name="ФильтрСрокДата" style="float:left;height:24px;"> <option name="mask">DD.MM.YY</option> <option name="class">ws-hidden</option> <option name="isCalendarIconShown">true</option> <option name="allowChangeEnable">true</option> <option name="date" bind="FilterLimitationDate"></option> </component> <component data-component="SBIS3.CONTROLS/Button/IconButton" name="IconButton" class="position" style="line-height:24px;margin-left:4px;margin-top:2px;"> <option name="icon">sprite:icon-16 icon-Close icon-disabled</option> </component> </div> ');return(a=n(a))+(i&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return t.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.FilterDateLimitation"}},t});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.FilterDateLimitation", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-filterDateLimitation .controls-Button__text:hover{color:#05b!important}"));head.appendChild(style);});}
define('js!SBIS3.EDO.FilterDateLimitation',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.FilterDateLimitation','css!SBIS3.EDO.FilterDateLimitation','SBIS3.CONTROLS/Date/Picker','SBIS3.CONTROLS/Link','SBIS3.CONTROLS/Button/IconButton','Elektronnyj_dokumentooborot_localization'],function(e,t){var i=e.extend({_dotTplFn:t,init:function(){i.superclass.init.call(this);var e=this;e._datePicker=this.getChildControlByName('ФильтрСрокДата'),e._datePickerClear=this.getChildControlByName('IconButton'),e._datePickerLink=this.getChildControlByName('DatePickerLink');function t(){e._datePicker.hide(),e._datePickerLink.show(),e._datePickerClear.hide(),e._datePicker.setDate(null);}if(null===e._datePicker.getDate())t();else e._datePickerClear.show(),e._datePickerLink.hide();e._datePicker.subscribe('onDateChange',function(t){var i=e._datePicker.getDate();if(null!==i)e._datePicker.getLinkedContext().setValue('FilterLimitationDateText',i.strftime('%e %q %Y')),e._datePicker.getLinkedContext().setValue('FilterLimitationDate',new Date(e._datePicker.getDate()).toSQL());}),e._datePickerLink.subscribe('onActivated',function(t){e._datePickerLink.hide(),e._datePicker.show(),e._datePicker.setActive(true),e._datePickerClear.show();}),e._datePickerClear.subscribe('onActivated',function(e){t();});}});return i;});
define("tmpl!SBIS3.EDO.RepeatStages",["Core/tmpl/js/tclosure","js!SBIS3.CONTROLS/Filter/Button/Text"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.CONTROLS/Filter/Button/Text"]=e[1];var i=function e(i,o,a,n,l){function p(){}var s=0,u=void 0!==t&&t?t:arguments[arguments.length-1];void 0===u&&(eval("var thelpers = null;"),u=global.requirejs("View/Runner/tclosure"));var d={};l&&l.isSetts&&(d=l.fullContext||{});var c="string"==typeof a?a:"",f=void 0===r?void 0:r,m={id:[],def:void 0},S=u.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,i),v=this&&this.includedTemplates?this.includedTemplates:{},N=u.getMarkupGenerator(n);try{var y=N.joinElements([N.createTag("div",{},[N.createControl("wsControl","ws:SBIS3.CONTROLS/Filter/Button/Text",{caption:u.getter(i,["caption"]),bindings:[{fieldName:"FilterRepeatStagesText",propName:"textValue",propPath:[],fullPropName:"textValue",propPathStr:"",oneWay:!0,direction:"fromProperty",bindNonExistent:!0},{fieldName:"FilterRepeatStages",propName:"filterValue",propPath:[],fullPropName:"filterValue",propPathStr:"",oneWay:!0,direction:"fromProperty",bindNonExistent:!0},{fieldName:"FilterRepeatStagesVisibility",propName:"visible",propPath:[],fullPropName:"visible",propPathStr:"",oneWay:!1,direction:"fromContext",bindNonExistent:!1}],textValue:"",filterValue:!1,visible:void 0,visibleFilterValue:!0},{},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:S},a,f,v,u.config,d)],o,m,this)],c,m);m.def&&(y=N.chain(y,m,o),m=void 0)}catch(e){u.templateError("resources/Elektronnyj_dokumentooborot/Statistika/Filtry/RepeatStages/RepeatStages.tmpl",e,i)}return y||""};return i.includedFunctions={},i.stable=!0,i.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.RepeatStages"}},i});
define('js!SBIS3.EDO.RepeatStages',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.RepeatStages','SBIS3.CONTROLS/Filter/Button/Text','Elektronnyj_dokumentooborot_localization'],function(t,n){var e=t.extend({_dotTplFn:n,$protected:{_options:{caption:rk('Убрать повторную обработку')}},$constructor:function(){},init:function(){e.superclass.init.call(this);}});return e;});
define("tmpl!SBIS3.EDO.FilterEventDetalization",["Core/tmpl/js/tclosure","js!SBIS3.EDO.BaseFilter.Period","js!SBIS3.EDO.PassageStatus","js!SBIS3.EDO.FilterDateLimitation","js!SBIS3.EDO.BaseFilter.Limitation","js!SBIS3.EDO.BaseFilter.Overdue","js!SBIS3.EDO.BaseFilter.Face1","js!SBIS3.EDO.BaseFilter.ResponsibleFace","js!SBIS3.EDO.BaseFilter.ListDispatch","js!SBIS3.EDO.BaseFilter.AuthorOrResponsible","js!SBIS3.EDO.BaseFilter.Milestone","js!SBIS3.EDO.BaseFilter.Marks","js!SBIS3.EDO.BaseFilter.Regulation","js!SBIS3.EDO.RepeatStages","js!SBIS3.EDO.BaseFilter.RightsLimText"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.EDO.BaseFilter.Period"]=e[1],r["js!SBIS3.EDO.PassageStatus"]=e[2],r["js!SBIS3.EDO.FilterDateLimitation"]=e[3],r["js!SBIS3.EDO.BaseFilter.Limitation"]=e[4],r["js!SBIS3.EDO.BaseFilter.Overdue"]=e[5],r["js!SBIS3.EDO.BaseFilter.Face1"]=e[6],r["js!SBIS3.EDO.BaseFilter.ResponsibleFace"]=e[7],r["js!SBIS3.EDO.BaseFilter.ListDispatch"]=e[8],r["js!SBIS3.EDO.BaseFilter.AuthorOrResponsible"]=e[9],r["js!SBIS3.EDO.BaseFilter.Milestone"]=e[10],r["js!SBIS3.EDO.BaseFilter.Marks"]=e[11],r["js!SBIS3.EDO.BaseFilter.Regulation"]=e[12],r["js!SBIS3.EDO.RepeatStages"]=e[13],r["js!SBIS3.EDO.BaseFilter.RightsLimText"]=e[14];var o=function e(o,i,a,n,s){function l(){}var c=0,S=void 0!==t&&t?t:arguments[arguments.length-1];void 0===S&&(eval("var thelpers = null;"),S=global.requirejs("View/Runner/tclosure"));var p={};s&&s.isSetts&&(p=s.fullContext||{});var d="string"==typeof a?a:"",B=void 0===r?void 0:r,u={id:[],def:void 0},m=S.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),D=this&&this.includedTemplates?this.includedTemplates:{},F=S.getMarkupGenerator(n);try{var O=F.joinElements([F.createTag("div",{class:"edo-BaseFilter__filterPicker"},[S.getter(o,["componentOptions","filterDatePeriodVisibility"])?[F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Period",{name:"BaseFilterPeriod",limited:!0},{name:"BaseFilterPeriod",sbisname:"BaseFilterPeriod"},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,B,D,S.config,p)]:F.createText(""),S.getter(o,["componentOptions","FilterPassageStatus"])?[F.createControl("wsControl","ws:SBIS3.EDO.PassageStatus",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,B,D,S.config,p)]:F.createText(""),S.getter(o,["componentOptions","FilterLimitationDateProc"])?[F.createControl("wsControl","ws:SBIS3.EDO.FilterDateLimitation",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,B,D,S.config,p)]:F.createText(""),S.getter(o,["componentOptions","FilterLimitationDate"])?[F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Limitation",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,B,D,S.config,p)]:F.createText(""),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Overdue",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,B,D,S.config,p),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Face1",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,B,D,S.config,p),S.getter(o,["isTask"])?F.createText(""):[F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ResponsibleFace",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,B,D,S.config,p)],S.getter(o,["isExternalStat"])?F.createText(""):[F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ListDispatch",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,B,D,S.config,p)],S.getter(o,["isTask"])?[F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.AuthorOrResponsible",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,B,D,S.config,p)]:F.createText(""),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Milestone",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,B,D,S.config,p),S.getter(o,["isTask"])?[F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Marks",{reestrName:S.getter(o,["componentOptions","docTypeString"])},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,B,D,S.config,p)]:F.createText(""),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Regulation",{docTypes:S.getter(o,["docTypes"])},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,B,D,S.config,p),S.getter(o,["componentOptions","FilterRepeatStages"])?[F.createControl("wsControl","ws:SBIS3.EDO.RepeatStages",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,B,D,S.config,p)]:F.createText(""),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.RightsLimText",{textRender:S.getTypeFunc("js!SBIS3.EDO.ScopeFilters:setScopeTextForFilter ",{}),esc:!1},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,B,D,S.config,p)],i,u,this)],d,u);u.def&&(O=F.chain(O,u,i),u=void 0)}catch(e){S.templateError("resources/Elektronnyj_dokumentooborot/Statistika/DetalizationEvents/FilterEventDetalization/FilterEventDetalization.tmpl",e,o)}return O||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FilterEventDetalization"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.FilterEventDetalization", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(""));head.appendChild(style);});}
define("html!SBIS3.EDO.FilterPassageStatusNew",function(){var t=function(t){var e=function(){var t=/\{\{([\s\S]+?)\}\}/g;return function(e){for(;t.test(e);)e=e.replace(t,"&#123;&#123;$1&#125;&#125;");return e}}(),o=function(t){return t.join?t.join(""):t.toString()},n=function(t){return void 0===t?"":t&&"object"==typeof t?o(t):""+t},r="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div> <component data-component="SBIS3.EDO.DropdownFilter" name="FilterPassageStatus"> <opts name="items" type="array"> <opts> <opt name="key">null</opt> <opt name="title">'+e(n(rk("Статусу перехода")))+'</opt> </opts> <opts> <opt name="key">1,3</opt> <opt name="title">'+e(n(rk("Положительный")))+'</opt> </opts> <opts> <opt name="key">2,4</opt> <opt name="title">'+e(n(rk("Отрицательный")))+'</opt> </opts> </opts> <opt name="value" bind="FilterPassageStatus"/> <opt name="stringValue" bind="FilterPassageStatusText" direction="fromProperty" oneWay="true" value=""/> </component> </div>');return(a=e(a))+(r&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return t.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.FilterPassageStatusNew"}},t});
define('js!SBIS3.EDO.FilterPassageStatusNew',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.FilterPassageStatusNew','js!SBIS3.EDO.DropdownFilter','i18n!SBIS3.EDO.FilterPassageStatusNew','Elektronnyj_dokumentooborot_localization'],function(t,e){var n=t.extend({_dotTplFn:e,$protected:{_options:{}},$constructor:function(){},init:function(){n.superclass.init.call(this);}});return n;});
define("html!SBIS3.EDO.FilterPassageStatusSelectorNew",function(){var t=function(t){var e=function(){var t=/\{\{([\s\S]+?)\}\}/g;return function(e){for(;t.test(e);)e=e.replace(t,"&#123;&#123;$1&#125;&#125;");return e}}(),o=function(t){return t.join?t.join(""):t.toString()},n=function(t){return void 0===t?"":t&&"object"==typeof t?o(t):""+t},r="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="FilterPlused filtersKitFlat-divFilterContainer"> <component data-component="SBIS3.EDO.DropdownSelector" name="FilterPassageStatusBtn"> <opts name="items" type="array"> <opts> <opt name="key">null</opt> <opt name="title">'+e(n(rk("Статусу перехода")))+'</opt> </opts> <opts> <opt name="key">1,3</opt> <opt name="title">'+e(n(rk("Положительный")))+'</opt> </opts> <opts> <opt name="key">2,4</opt> <opt name="title">'+e(n(rk("Отрицательный")))+'</opt> </opts> </opts> <opt name="value" bind="FilterPassageStatus"/> </component> </div>');return(a=e(a))+(r&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return t.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.FilterPassageStatusSelectorNew"}},t});
define('js!SBIS3.EDO.FilterPassageStatusSelectorNew',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.FilterPassageStatusSelectorNew','js!SBIS3.EDO.DropdownSelector','i18n!SBIS3.EDO.FilterPassageStatusSelectorNew','Elektronnyj_dokumentooborot_localization'],function(t,e){var s=t.extend({_dotTplFn:e,$protected:{_options:{}},$constructor:function(){var t=this.getLinkedContext();if(t&&!t.getValue('FilterPassageStatus'))t.setValue('FilterPassageStatus',null);},init:function(){s.superclass.init.call(this);}});return s;});
define("html!SBIS3.EDO.FilterRepeatStagesSelectorNew",function(){var e=function(e){var t=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;e.test(t);)t=t.replace(e,"&#123;&#123;$1&#125;&#125;");return t}}(),n=function(e){return e.join?e.join(""):e.toString()},o=function(e){return void 0===e?"":e&&"object"==typeof e?n(e):""+e},r="undefined"!=typeof process,i=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div> <component data-component="SBIS3.EDO.FilterLinkButtonCtx" name="FilterRepeatStagesBtn" style="display:inline-block;padding-left:16px;"> <option name="fValue">true</option> <option name="fText">'+t(o(rk("Убрать повторную обработку")))+'</option> <option name="fTitle">ФильтрПовторные</option> <option name="value" bind="FilterRepeatStages" value=""></option> </component> </div>');return(i=t(i))+(r&&-1!==i.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.FilterRepeatStagesSelectorNew"}},e});
define('js!SBIS3.EDO.FilterRepeatStagesSelectorNew',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.FilterRepeatStagesSelectorNew','js!SBIS3.EDO.FilterLinkButtonCtx','i18n!SBIS3.EDO.FilterRepeatStagesSelectorNew','Elektronnyj_dokumentooborot_localization'],function(e,t){var n=e.extend({_dotTplFn:t,$protected:{_options:{}},$constructor:function(){var e=this.getLinkedContext();if(e&&!e.getValue('FilterRepeatStages'))e.setValue('FilterRepeatStages',null);},init:function(){n.superclass.init.call(this);}});return n;});
define('js!SBIS3.EDO.FilterEventDetalization',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FilterEventDetalization','js!SBIS3.Navigation.LeftNavigation','css!SBIS3.EDO.FilterEventDetalization','js!SBIS3.EDO.BaseFilter.Period','js!SBIS3.EDO.BaseFilter.LimitationOverdue','js!SBIS3.EDO.BaseFilter.Overdue','js!SBIS3.EDO.BaseFilter.Marks','js!SBIS3.EDO.BaseFilter.ResponsibleFace','js!SBIS3.EDO.BaseFilter.Face1','js!SBIS3.EDO.BaseFilter.ListDispatch','js!SBIS3.EDO.BaseFilter.AuthorOrResponsible','js!SBIS3.EDO.BaseFilter.Regulation','js!SBIS3.EDO.BaseFilter.Milestone','js!SBIS3.EDO.BaseFilter.RightsLimText','js!SBIS3.EDO.BaseFilter.Limitation','js!SBIS3.EDO.PassageStatus','js!SBIS3.EDO.RepeatStages','js!SBIS3.EDO.FilterPassageStatusNew','js!SBIS3.EDO.FilterPassageStatusSelectorNew','js!SBIS3.EDO.FilterRepeatStagesSelectorNew','js!SBIS3.EDO.ScopeFilters','js!SBIS3.EDO.FilterDateLimitation','Elektronnyj_dokumentooborot_localization'],function(e,t,i){var s=e.extend({_dotTplFn:t,$protected:{_options:{autoHeight:true,autoWidth:true,isExternalStat:true}},$constructor:function(){},_modifyOptions:function(e){if(e=s.superclass._modifyOptions.call(this,e),e.componentOptions.FilterLimitationDateProc)e.componentOptions.FilterLimitationDate=false;else e.componentOptions.FilterLimitationDate=true;return e.isTask='СлужЗап'===e.componentOptions.docTypeString,e;},init:function(){s.superclass.init.call(this);var e=this;function t(t){if(e.hasChildControlByName('BaseFilterPeriod'))e.getChildControlByName('BaseFilterPeriod').setVisible(t);}function l(t){if(e.hasChildControlByName('FilterIdPhase'))e.getChildControlByName('FilterIdPhase').setVisible(t);}var a=this.getParent().getLinkedContext();if(a.getValue('sbis3-controls-filter-button/filter/FilterTransition'))a.setValue('FilterRegulationVisibility',false);else a.setValue('FilterTransitionVisibility',false);if(!a.getValue('sbis3-controls-filter-button/filter/FilterDatePeriod'))t(false);var r=true,o=this.getParentByClass('SBIS3.EDO2.Browser'),n=o&&o.getFilter()||{};if(('4'===n['ФильтрПоКраткомуСостоянию']||4===n['ФильтрПоКраткомуСостоянию'])&&!r)a.setValue('FilterRepeatStagesVisibility',false);if(('4'===n['ФильтрПоКраткомуСостоянию']||4===n['ФильтрПоКраткомуСостоянию'])&&!r)t(false),a.setValue('FilterRepeatStagesVisibility',false);else t(true);if(true===n['ФильтрСтатистикаТекущие']||'Выполнено'!==n['ФильтрСтатистикаПериод'])l(false);else l(true);var S=i.getInstance(),B=S&&S.getActiveElement(),u=B&&B['elementId'];if('work_plans'===u)a.setValue('FilterLimitationDateVisibility',false),a.setValue('FilterMilestoneVisibility',false),a.setValue('FilterFace1Visibility',false),a.setValue('FilterListDispatchVisibility',false);if('business_works'===u)a.setValue('FilterMilestoneVisibility',false);var f=this.getTopParent(),F=f&&f.getOpener(),O=F&&F.getParentByClass('SBIS3.EDO.StatTemplate')||F;if(O&&O._options['filter_options']&&O._options['filter_options']['ИдРегламента'])if(this.hasChildControlByName('ИдРегламента'))this.getChildControlByName('ИдРегламента').setEnabled(false),this.getChildControlByName('ИдРегламентаМетка').setEnabled(false);}});return s;});
define("tmpl!SBIS3.EDO.PassageStatusSelector",["Core/tmpl/js/tclosure","js!SBIS3.CONTROLS/Filter/Button/Dropdown"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.CONTROLS/Filter/Button/Dropdown"]=e[1];var o=function e(o,l,i,s,a){function n(){}var d=0,u=void 0!==t&&t?t:arguments[arguments.length-1];void 0===u&&(eval("var thelpers = null;"),u=global.requirejs("View/Runner/tclosure"));var c={};a&&a.isSetts&&(c=a.fullContext||{});var p="string"==typeof i?i:"",S=void 0===r?void 0:r,m={id:[],def:void 0},y=u.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),f=this&&this.includedTemplates?this.includedTemplates:{},v=u.getMarkupGenerator(s);try{var g=v.joinElements([v.createTag("div",{class:"edo-BaseFilter_flbColumn"},[v.createControl("wsControl","ws:SBIS3.CONTROLS/Filter/Button/Dropdown",{items:[{key:null,title:global.rk("По статусу перехода")},{key:"1,3",title:global.rk("Положительный")},{key:"2,4",title:global.rk("Отрицательный")}],SelectedKeys:[],displayField:"title",keyField:"key",resetKey:"null",multiselect:!1,showSelectedInList:!1,allowEmptyMultiSelection:!0,bindings:[{fieldName:"FilterPassageStatusVisibility",propName:"invertedVisible",propPath:[],fullPropName:"invertedVisible",propPathStr:"",oneWay:!0,direction:"fromContext",bindNonExistent:!0},{fieldName:"FilterPassageStatus",propName:"SelectedKeys/0",propPath:["0"],fullPropName:"SelectedKeys/0",propPathStr:"0",oneWay:!1,direction:"fromContext",bindNonExistent:!1}],invertedVisible:"",esc:!1},{class:"controls-DropdownList__withoutCross"},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},i,S,f,u.config,c)],l,m,this)],p,m);m.def&&(g=v.chain(g,m,l),m=void 0)}catch(e){u.templateError("resources/Elektronnyj_dokumentooborot/Statistika/Filtry/PassageStatus/PassageStatusSelector/PassageStatusSelector.tmpl",e,o)}return g||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.PassageStatusSelector"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.PassageStatusSelector", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-BaseFilter_flbColumn .controls-DropdownList .controls-DropdownList__selectedItem .controls-DropdownList__textWrapper{color:#313e78}"));head.appendChild(style);});}
define('js!SBIS3.EDO.PassageStatusSelector',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.PassageStatusSelector','css!SBIS3.EDO.PassageStatusSelector','SBIS3.CONTROLS/Filter/Button/Dropdown','Elektronnyj_dokumentooborot_localization'],function(t,e){var s=t.extend({_dotTplFn:e,$protected:{_options:{},_firstSelect:true},$constructor:function(){},init:function(){s.superclass.init.call(this);var t=this,e=this.getChildControls()[0].getSelectedKeys();if(e.length>0&&null!=e[0])this.sendCommand('change-field-internal','FilterPassageStatusVisibility',true);t.subscribe('onAfterShow',function(){this.getChildControls()[0].subscribe('onSelectedItemsChange',function(e,s){if(t._firstSelect)t._firstSelect=false;else if(s.length>0&&null!=s[0])this.sendCommand('change-field-internal','FilterPassageStatusVisibility',true);});});}});return s;});
define("tmpl!SBIS3.EDO.RepeatStagesSelector",["Core/tmpl/js/tclosure","js!SBIS3.CONTROLS/Filter/Button/Link"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.CONTROLS/Filter/Button/Link"]=e[1];var i=function e(i,o,n,a,l){function s(){}var c=0,d=void 0!==t&&t?t:arguments[arguments.length-1];void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure"));var p={};l&&l.isSetts&&(p=l.fullContext||{});var u="string"==typeof n?n:"",S=void 0===r?void 0:r,m={id:[],def:void 0},v=d.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,i),f=this&&this.includedTemplates?this.includedTemplates:{},g=d.getMarkupGenerator(a);try{var y=g.joinElements([g.createTag("div",{class:"edo-BaseFilter_flbColumn"},[g.createControl("wsControl","ws:SBIS3.CONTROLS/Filter/Button/Link",{commandArgs:["FilterRepeatStagesVisibility",Boolean(!0)],caption:d.getter(i,["caption"]),command:"change-field-internal",bindings:[{fieldName:"FilterRepeatStagesVisibility",propName:"invertedVisible",propPath:[],fullPropName:"invertedVisible",propPathStr:"",oneWay:!0,direction:"fromContext",bindNonExistent:!1}],invertedVisible:void 0,esc:!1},{},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:v},n,S,f,d.config,p)],o,m,this)],u,m);m.def&&(y=g.chain(y,m,o),m=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/Statistika/Filtry/RepeatStages/RepeatStagesSelector/RepeatStagesSelector.tmpl",e,i)}return y||""};return i.includedFunctions={},i.stable=!0,i.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.RepeatStagesSelector"}},i});
define('js!SBIS3.EDO.RepeatStagesSelector',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.RepeatStagesSelector','SBIS3.CONTROLS/Filter/Button/Link','Elektronnyj_dokumentooborot_localization'],function(t,e){var n=t.extend({_dotTplFn:e,$protected:{_options:{caption:rk('Убрать повторную обработку')}},$constructor:function(){},init:function(){n.superclass.init.call(this);}});return n;});
define("tmpl!SBIS3.EDO.FilterEventDetalizationSelector",["Core/tmpl/js/tclosure","js!SBIS3.EDO.BaseFilter.LimitationSelector","js!SBIS3.EDO.BaseFilter.OverdueSelector","js!SBIS3.EDO.BaseFilter.Face1Selector","js!SBIS3.EDO.BaseFilter.ResponsibleFaceSelector","js!SBIS3.EDO.BaseFilter.ListDispatchSelector","js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleSelector","js!SBIS3.EDO.BaseFilter.MilestoneSelector","js!SBIS3.EDO.BaseFilter.MarksSelector","js!SBIS3.EDO.BaseFilter.RegulationSelector","js!SBIS3.EDO.PassageStatusSelector","js!SBIS3.EDO.RepeatStagesSelector"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.EDO.BaseFilter.LimitationSelector"]=e[1],r["js!SBIS3.EDO.BaseFilter.OverdueSelector"]=e[2],r["js!SBIS3.EDO.BaseFilter.Face1Selector"]=e[3],r["js!SBIS3.EDO.BaseFilter.ResponsibleFaceSelector"]=e[4],r["js!SBIS3.EDO.BaseFilter.ListDispatchSelector"]=e[5],r["js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleSelector"]=e[6],r["js!SBIS3.EDO.BaseFilter.MilestoneSelector"]=e[7],r["js!SBIS3.EDO.BaseFilter.MarksSelector"]=e[8],r["js!SBIS3.EDO.BaseFilter.RegulationSelector"]=e[9],r["js!SBIS3.EDO.PassageStatusSelector"]=e[10],r["js!SBIS3.EDO.RepeatStagesSelector"]=e[11];var o=function e(o,a,i,l,n){function s(){}var c=0,S=void 0!==t&&t?t:arguments[arguments.length-1];void 0===S&&(eval("var thelpers = null;"),S=global.requirejs("View/Runner/tclosure"));var p={};n&&n.isSetts&&(p=n.fullContext||{});var d="string"==typeof i?i:"",u=void 0===r?void 0:r,B={id:[],def:void 0},m=S.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),v=this&&this.includedTemplates?this.includedTemplates:{},f=S.getMarkupGenerator(l);try{var D=f.joinElements([f.createTag("div",{class:"edo-BaseFilter__filterPicker  edo-twoColumnSelectors"},[S.getter(o,["componentOptions","FilterLimitationDate"])?[f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.LimitationSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},i,u,v,S.config,p)]:f.createText(""),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.OverdueSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},i,u,v,S.config,p),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Face1Selector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},i,u,v,S.config,p),S.getter(o,["isTask"])?f.createText(""):[f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ResponsibleFaceSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},i,u,v,S.config,p)],S.getter(o,["isExternalStat"])?f.createText(""):[f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ListDispatchSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},i,u,v,S.config,p)],S.getter(o,["isTask"])?[f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.AuthorOrResponsibleSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},i,u,v,S.config,p)]:f.createText(""),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.MilestoneSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},i,u,v,S.config,p),S.getter(o,["isTask"])?[f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.MarksSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},i,u,v,S.config,p)]:f.createText(""),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.RegulationSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},i,u,v,S.config,p),S.getter(o,["componentOptions","FilterPassageStatus"])?[f.createControl("wsControl","ws:SBIS3.EDO.PassageStatusSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},i,u,v,S.config,p)]:f.createText(""),S.getter(o,["componentOptions","FilterRepeatStages"])?[f.createControl("wsControl","ws:SBIS3.EDO.RepeatStagesSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},i,u,v,S.config,p)]:f.createText("")],a,B,this)],d,B);B.def&&(D=f.chain(D,B,a),B=void 0)}catch(e){S.templateError("resources/Elektronnyj_dokumentooborot/Statistika/DetalizationEvents/FilterEventDetalization/FilterEventDetalizationSelector/FilterEventDetalizationSelector.tmpl",e,o)}return D||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FilterEventDetalizationSelector"}},o});
define('js!SBIS3.EDO.FilterEventDetalizationSelector',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FilterEventDetalizationSelector','js!SBIS3.EDO.BaseFilter.LimitationSelector','js!SBIS3.EDO.BaseFilter.OverdueSelector','js!SBIS3.EDO.BaseFilter.MarksSelector','js!SBIS3.EDO.BaseFilter.ResponsibleFaceSelector','js!SBIS3.EDO.BaseFilter.Face1Selector','js!SBIS3.EDO.BaseFilter.ListDispatchSelector','js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleSelector','js!SBIS3.EDO.BaseFilter.RegulationSelector','js!SBIS3.EDO.BaseFilter.MilestoneSelector','js!SBIS3.EDO.BaseFilter.OurOrganisationSelector','js!SBIS3.EDO.PassageStatusSelector','js!SBIS3.EDO.RepeatStagesSelector','Elektronnyj_dokumentooborot_localization'],function(e,t){var i=e.extend({_dotTplFn:t,$protected:{_options:{autoHeight:true,autoWidth:true,isExternalStat:true}},$constructor:function(){},_modifyOptions:function(e){if(e=i.superclass._modifyOptions.call(this,e),e.componentOptions.FilterLimitationDateProc)e.componentOptions.FilterLimitationDate=false;else e.componentOptions.FilterLimitationDate=true;return e.isTask='СлужЗап'===e.componentOptions.docTypeString,e;},init:function(){i.superclass.init.call(this);}});return i;});
define("html!SBIS3.EDO.TaskColDetalization",function(){var e=function(e){var t=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;e.test(t);)t=t.replace(e,"&#123;&#123;$1&#125;&#125;");return t}}(),i=function(e){return e.join?e.join(""):e.toString()},n=function(e){return void 0===e?"":e&&"object"==typeof e?i(e):""+e},r="undefined"!=typeof process,o=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,"");return o+=" ",e.templateBinding&&e.templateBinding.isMakeCustomPeriodRender&&(o+=" ",e.externalSrokObj=function(e){var t=e.get("Конец")?e.get("Конец"):new Date,i=e.get("Событие.Срок"),n={};if(i){var r=i.strftime("%d.%m"),o=i.strftime("%H:%M");n.srok=r,n.title=r+" "+o,n.srok_class=i<t?"rt_red":"",n.icon_class=""===n.srok_class?"icon-16 icon-Time icon-disabled":"icon-16 icon-Time icon-error"}return n}(e.item),o+=" "),o+=" ",e.templateBinding&&e.templateBinding.detalizationTitlePrefix&&(o+=" ",e.detalizationTitlePrefix=e.templateBinding.detalizationTitlePrefix,o+=" "),o+=" "+t(n(e.included.TaskCol(e)))+" ",(o=t(o))+(r&&-1!==o.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.TaskColDetalization"}},e});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.TaskColDetalization", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".DetalizationEvents .rt_right{width:calc(100% - 42px)}.DetalizationEvents .rt_currcond,.DetalizationEvents .rt_desc,.DetalizationEvents .rt_prevcomment{margin-right:0!important}.DetalizationEvents .rt_datelimit_red{color:#e22323}.DetalizationEvents .rt_desc{position:relative;z-index:2}.DetalizationEvents .controls-AjaxLoader{z-index:3}"));head.appendChild(style);});}
define('js!SBIS3.EDO.TaskColDetalization',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.TaskColDetalization','css!SBIS3.EDO.TaskColDetalization','Elektronnyj_dokumentooborot_localization'],function(t,n){'use strict';var o=t.extend({_dotTplFn:n,$protected:{_options:{name:'TaskColDetalization'}},$constructor:function(){},init:function(){var t=this;o.superclass.init.call(t);}});return o;});
define("html!SBIS3.EDO.RegistryColumns/resources/TasksStateDetalizationColumn",function(){var e=function(e){var t=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;e.test(t);)t=t.replace(e,"&#123;&#123;$1&#125;&#125;");return t}}(),n=function(e){return e.join?e.join(""):e.toString()},r=function(e){return void 0===e?"":e&&"object"==typeof e?n(e):""+e},o="undefined"!=typeof process,i=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,"");if(!e.isNode){i+=" ",e.showRule=e.templateBinding.showRule,e.showPhaseExecutor=e.templateBinding.showPhaseExecutor;var s=e.item.get("Переход.Название");e.closedEventsBrowser=!(!s||""===s.replace(/\s+/g,"")),e.stateWidth=e.templateBinding.stateWidth,i+=" "+t(r(e.included.edoStateColumn(e)))+" "}return(i=t(i))+(o&&-1!==i.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.RegistryColumns/resources/TasksStateDetalizationColumn"}},e});
define("html!SBIS3.EDO.DetalizationHead",function(){var t=function(t){var e=function(){var t=/\{\{([\s\S]+?)\}\}/g;return function(e){for(;t.test(e);)e=e.replace(t,"&#123;&#123;$1&#125;&#125;");return e}}(),s=function(t){return t.join?t.join(""):t.toString()},a=function(t){return void 0===t?"":t&&"object"==typeof t?s(t):""+t},i="undefined"!=typeof process,l=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="detalization_head" style="height: auto; padding-top: 8px;"> <div class="stat_title_phase" style="'+e(a(t.stat_title_phase.style))+'"> <span> <div style="float: left; padding-right: 7px;"> '+e(a(t.stat_title_phase.foto))+' </div> </span> <span class="title_name" title="'+e(a(t.stat_title_phase.name))+'" style="font-weight: bold;"> '+e(a(t.stat_title_phase.name_short))+' </span> <span class="title_counters"> <span class="title_count_txt"> '+e(a(t.stat_title_phase.count_txt))+' </span> <span class="title_count" style="font-weight: bold;">'+e(a(t.stat_title_phase.count))+'</span><span class="title_sep">'+e(a(t.stat_title_phase.sep))+'</span> <span class="title_overdue_txt" style="color: #EF463A;"> '+e(a(t.stat_title_phase.overdue_txt))+' </span> <span class="title_overdue" style="color: #EF463A; font-weight: bold;"> '+e(a(t.stat_title_phase.overdue))+' </span> </span> <span class="user_podr_title_phase cutted_text" title="'+e(a(t.stat_title_phase.work))+'"> '+e(a(t.stat_title_phase.work))+' </span> </div> <div class="stat_title_boss_info" style="'+e(a(t.stat_title_boss_info.style))+'"> <div style="display: block"> <span> <div style="float: left; padding-right: 7px;"> '+e(a(t.stat_title_boss_info.foto))+' </div> </span> <span style="display: block; font-size: 15px; padding-top: 3px;" title="'+e(a(t.stat_title_boss_info.name))+'"> '+e(a(t.stat_title_boss_info.name))+' </span> <span class="cutted_text" title="'+e(a(t.stat_title_boss_info.job))+'" style="display: block; font-size: 12px; color: #999999;"> '+e(a(t.stat_title_boss_info.job))+' </span> </div> </div> <div class="stat_title_phase_norm" style="'+e(a(t.stat_title_phase_norm.style))+'"> <span title="'+e(a(t.stat_title_phase_norm.title))+'"> '+e(a(t.stat_title_phase_norm.prefix))+' </span> <span title="'+e(a(t.stat_title_phase_norm.title))+'" style="font-weight: bold;"> '+e(a(t.stat_title_phase_norm.norm))+' </span> <span title="'+e(a(t.stat_title_phase_norm.title))+'"> '+e(a(t.stat_title_phase_norm.suffix))+" </span> </div> </div> ");return(l=e(l))+(i&&-1!==l.indexOf("{{")?String.fromCharCode(8203,8203):"")};return t.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.DetalizationHead"}},t});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.DetalizationEvents", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".stat_title_phase{color:#000!important;text-decoration:none!important;cursor:default!important;font-family:TensorFont!important;font-size:15px!important;font-style:normal!important;font-weight:400!important;width:677px;height:43px;margin-left:12px}.stat_title_boss_info{width:677px;height:43px;margin-left:12px;padding-bottom:4px}.stat_title_phase_norm{width:677px;height:20px;margin-left:12px;padding-bottom:4px}.detalization_brw_tabs{width:790px;height:100%;min-height:50px;position:relative;margin-bottom:0;bottom:auto;padding-bottom:0;padding-top:0;margin-top:0;top:0;left:0;right:auto}.user_podr_title_phase{font-size:12px;display:block;padding-left:0!important;color:#999;max-width:80%}.detalization_head .cutted_text{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.rt_rightside div{text-overflow:ellipsis;white-space:nowrap;max-width:230px}.rt_overtask{margin-right:56px}.detalization_filterLine_maxWidth{max-width:434px}.detalizationPeriodColumnHead{color:#999!important}.DetalizationEvents{height:100%}.DetalizationEvents .browserTabs__page-title{display:none!important}.ctrFilterLinkDate{float:right;color:#05b;font-size:12px}.ws-is-firefox .ctrFilterLinkDate{height:17px}.ctrFilterLinkReceived{color:#05b;font-size:12px}.ctrFilterLinkDate .controls-Link__field{margin-left:0!important}.ctrFilterLinkReceived .controls-Link__field{margin-left:0!important}.detalization_brw_tabs .edo-Browser-Responsible,.detalization_brw_tabs .edo-Browser-Responsible .edo-Browser-Responsible__text-row{width:86px;line-height:18px}.detalization_brw_tabs .edo-Browser-Responsible .edo-Browser-Responsible__text-row:first-child{top:1px;position:relative;line-height:19px}.detalization_brw_tabs .edo-Browser-Responsible .edo-Browser-Responsible__additional-row{line-height:20px}.detalization_brw_tabs .edo-Browser-Responsible .edo-Browser-Responsible__text-row:before{content:none}.DetalizationEvents-DetalizationBrowserTabs{height:100%}.ws-is-old-webkit .height_34_for_old_webkit{height:calc(100% - 34px)}.ws-is-old-webkit .height_52_for_old_webkit{height:calc(100% - 52px)}.ws-is-old-webkit .height_78_for_old_webkit{height:calc(100% - 78px)}.DetalizationEvents .controls-OperationsPanelButton{margin-left:6px}.DetalizationEvents .controls-OperationsPanelButton__showSeparator:after{display:none}"));head.appendChild(style);});}
define('js!SBIS3.EDO.DetalizationHead',['Core/core-functions','Core/helpers/string-helpers','SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.DetalizationHead','css!SBIS3.EDO.DetalizationEvents','Elektronnyj_dokumentooborot_localization'],function(t,e,s,o){var n=s.extend({_dotTplFn:o,$protected:{_options:{stat_title_phase:{style:'',foto:'',name:'',name_short:'',count_txt:'',count:'',sep:'',overdue_txt:'',overdue:'',work:''},stat_title_boss_info:{style:'',foto:'',name:'',job:''},stat_title_phase_norm:{style:'',title:'',prefix:'',norm:'',suffix:''}}},$constructor:function(){},init:function(){var t=this;n.superclass.init.call(this);},_setGroup:function(t,e,s){var o=this;if('object'!==typeof o._options[e])return;for(var n in t)if(t.hasOwnProperty(n))o._options[e][n]=t[n]||'';if(!s)o.rebuildMarkup();},_correctTitleLength:function(t){var s=this,o=75,n=s._options['stat_title_phase'],r=n&&n['name'],i=n&&n['style'];if(r&&'display: none;'!==i){r=r.replace(/&lt;/g,'<').replace(/&gt;/g,'>').replace(/&quot;/g,'"');var _=(n['count_txt']?n['count_txt'].toString().length:0)+(n['count']?n['count'].toString().length:0)+(n['sep']?n['sep'].toString().length:0)+(n['overdue_txt']?n['overdue_txt'].toString().length:0)+(n['overdue']?n['overdue'].toString().length:0),a;if(_+r.length>o)a=r.substr(0,o-_)+'...';else a=r;s._options['stat_title_phase']['name']=e.escapeHtml(r),s._options['stat_title_phase']['name_short']=e.escapeHtml(a);}if(!t)s.rebuildMarkup();},setTitlePhase:function(e,s){if(this._options.bkp_stat_title_phase=t.clone(e),0===e['count']&&0!==e['overdue'])e['count_txt']='',e['sep']='';this._setGroup(e,'stat_title_phase',true),this._correctTitleLength(s);},setTitlePhaseNorm:function(t,e){this._setGroup(t,'stat_title_phase_norm',e);},setBossInfo:function(t,e){this._setGroup(t,'stat_title_boss_info',e);},refreshTitleCounters:function(e,s){var o=this;if(o._options.stat_title_phase=t.clone(o._options.bkp_stat_title_phase),0===e)o._options.stat_title_phase['count_txt']=0===s?r(o._options.stat_title_phase['count_txt']):'',o._options.stat_title_phase['count']='',o._options.stat_title_phase['sep']='';else o._options.stat_title_phase['count']=e;if(0===s)o._options.stat_title_phase['sep']='',o._options.stat_title_phase['overdue_txt']='',o._options.stat_title_phase['overdue']='';else{var n=o.getParent(),i=n&&n.hasChildControlByName('browserView')&&n.getChildControlByName('browserView');if('Получено'!==(i&&i.getFilter()||{})['ФильтрСтатистикаПериод'])o._options.stat_title_phase['overdue']=s,o._options.stat_title_phase['overdue_txt']=rk('нарушен срок');}o._correctTitleLength();}});return n;function r(t){switch(t){case rk('завершено документов'):return rk('нет завершенных документов');case rk('завершено документов положительно'):return rk('нет завершенных документов положительно');case rk('завершено документов отрицательно'):return rk('нет завершенных документов отрицательно');case rk('документов на начало периода'):return rk('нет документов на начало периода');case rk('документов получено'):return rk('нет полученных документов');case rk('документов выполнено за период'):return rk('нет выполненных документов за период');case rk('документов осталось за период'):return rk('нет оставшихся документов за период');default:return rk('нет документов в обработке');}}});
define("html!SBIS3.EDO.DetalizationEvents/tplFilterDatePeriod",function(){var e=function(e){var t=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;e.test(t);)t=t.replace(e,"&#123;&#123;$1&#125;&#125;");return t}}(),n=function(e){return e.join?e.join(""):e.toString()},r=function(e){return void 0===e?"":e&&"object"==typeof e?n(e):""+e},i="undefined"!=typeof process,o=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,""),a=rk("За последний месяц");return e.caption&&(a=rk(e.caption)),o+=" <div style='display:inline;' class='filterLine__itemTemplate'>"+t(r(a))+"</div>",(o=t(o))+(i&&-1!==o.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.DetalizationEvents/tplFilterDatePeriod"}},e});
define('js!SBIS3.EDO.DetalizationEvents',['Lib/Control/Control','Core/core-functions','WS.Data/Source/SbisService','WS.Data/Query/Query','Core/Deferred','Core/helpers/string-helpers-min','Core/helpers/string-helpers','Core/EventBus','Core/ParallelDeferred','SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.DetalizationEvents','js!SBIS3.Person.PersonPhotoTemplateHelper','tmpl!SBIS3.Person.PersonPhotoTemplateHelper','js!SBIS3.EDO.EdoCommon','WS.Data/Format/StringField','js!SBIS3.EDO.InnerStat','Core/detection','js!SBIS3.Engine.BrowserTabs','js!SBIS3.EDO.FMyTasks','js!SBIS3.EDO.FilterEventDetalization','js!SBIS3.EDO.FilterEventDetalizationSelector','js!SBIS3.EDO.TaskColDetalization','html!SBIS3.EDO.RegistryColumns/resources/TasksStateDetalizationColumn','js!SBIS3.EDO.DetalizationHead','SBIS3.CONTROLS/Link','css!SBIS3.EDO.DetalizationEvents','html!SBIS3.EDO.DetalizationEvents/tplFilterDatePeriod','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterListDispatch','tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TDateDoneColumn','tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TDetalizationColumn','tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TMainColumn','i18n!SBIS3.EDO.DetalizationEvents','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterAuthor','tmpl!SBIS3.EDO2.Browser/resources/columns/tmpl/ResponsibleColumn','Elektronnyj_dokumentooborot_localization'],function(e,t,i,n,o,r,a,l,s,d,c,f,u,p,g,h,m){var S=d.extend({_dotTplFn:c,$protected:{_options:{autoHeight:true,filterParams:'',resetLinkText:'',filterDatePeriodVisibility:false,detalizationTitlePrefix:'',dateColTitle:'',statusPictureTitle:'',sortReceivedIcon:'',sortSrokIcon:'',brwName:'DetalizationEventsBrowser',additionalItemsActions:'',showPhaseNorm:false,docTypeString:'',subDocTypeString:'',FilterPassageStatus:false,FilterRepeatStages:false,filterStructure:[],maPrintId:'@Документ'}},$constructor:function(){},_modifyOptions:function(e){e=S.superclass._modifyOptions.call(this,e);var t='',i=['_ЕстьДочерние','ВидДерева','HierarchyField','Разворот','ПутьКУзлу','ЗаголовокИерархии','_Итоги','ФильтрСортировкаКолонок'],n=this.getLinkedContext()||this.getParent()&&this.getParent().getLinkedContext(),o=y.apply(this,[]),r,a='ФильтрРазрезСтатистики'in o&&'По ответственному'===o['ФильтрРазрезСтатистики'];if(true===o['isDivision'])e['detalizationTitlePrefix']=rk('Исполнитель этапа');else if(a)e['detalizationTitlePrefix']=rk('Исполнитель этапа');else e['detalizationTitlePrefix']=rk('Отправитель этапа');if(a)e['dateColTitle']=rk('Дата');else if('ФильтрСтатистикаПериод'in o&&'Выполнено'===o['ФильтрСтатистикаПериод'])e['dateColTitle']=rk('Выполнено');else e['dateColTitle']=rk('Получено');if('ФильтрСтатистикаПериод'in o&&'Выполнено'===o['ФильтрСтатистикаПериод'])e['statusPictureTitle']='';else e['statusPictureTitle']=rk('Состояние');if('Период'!==o['ФильтрДатаПериод'])o['ФильтрДатаС']=void 0,o['ФильтрДатаП']=void 0;if('ФильтрПереход'in o&&o['ФильтрПереход']);var l='';if(!('ФильтрСтатистикаТекущие'in o&&o['ФильтрСтатистикаТекущие']))l=rk('За последний месяц'),e['filterDatePeriodVisibility']=true;else e['FilterLimitationDateProc']=true;var s=e['statTemplateOptions'];if(s&&s['show_phase_norm'])e['showPhaseNorm']=s['show_phase_norm'];if(s&&s['docType']){if(e['docTypeString']=s['docType'],s['docSubType'])e['subDocTypeString']=s['docSubType'];}else e['docTypeString']=n.getValue('docTypeString');e['showPhaseWhenInitThroughCtx']=!!o['ИдРегламента'];var d='',c={};if(s&&s['filter_options']&&s['filter_options']['ИдРегламента'])c['ИдРегламента']=s['filter_options']['ИдРегламента'],c['ИдРегламентаТекст']=s['filter_options']['ИдРегламентаТекст'],d=s['filter_options']['ИдРегламентаТекст'];if(o['ФильтрПросроченные']&&!('ФильтрПросроченныеТекст'in o))o['ФильтрПросроченныеТекст']=rk('Просроченные');var f=h.getFilterStructure(o,c);for(r in o)if(-1===i.indexOf(r)&&o.hasOwnProperty(r)&&o[r])if(-1===r.indexOf('Текст')){var u='';if(o[r]instanceof Array){if(o[r].length>0){var p='';for(var g in o[r])if(o[r].hasOwnProperty(g)){if(u='','string'===typeof o[r][g]&&parseInt(o[r][g]))u='type="string"';p+='<option value="'+o[r][g]+'" '+u+'></option>';}t+='<options name="'+r+'" type="array">'+p+'</options>';}}else{if('string'===typeof o[r]&&parseInt(o[r]))u='type="string"';t+='<option name="'+r+'" value="'+o[r]+'" '+u+'></option>';}}var m=n&&n.getValue('phaseReportSortReceived')||'DESC',C=n&&n.getValue('phaseReportSortSrok')||'';if(t+='<option name="СортировкаПолучено" value="'+m+'"></option>',t+='<option name="СортировкаСрок" value="'+C+'"></option>',C)e['sortSrokIcon']='ASC'===C?'Up':'Down';else e['sortReceivedIcon']='ASC'===m?'Up':'Down';e['FilterPassageStatus']=s['customizeFilters']&&s['customizeFilters']['FilterPassageStatus']?s['customizeFilters']['FilterPassageStatus']:false,e['FilterRepeatStages']=s['customizeFilters']&&s['customizeFilters']['FilterRepeatStages']?s['customizeFilters']['FilterRepeatStages']:false,e['filterParams']=t,e['additionalItemsActions']='<options>'+'<option name="icon">sprite:icon-16 icon-EmptyMessage icon-primary</option>'+'<option name="name">send_msg_detalization</option>'+'<option name="tooltip">'+rk('Написать сообщение')+'</option>'+'<option name="caption">'+rk('Написать сообщение')+'</option>'+'<option name="isMainAction">true</option>'+'<option name="onActivated" type="function">js!SBIS3.EDO.DetalizationEvents:prototype.sendMessageTo</option>'+'</options>';var k=s&&s['detalization_row_actions'];if(k&&k.length){var w='';for(var v in k)if(k.hasOwnProperty(v)){w+='<options>';for(r in k[v])if(k[v].hasOwnProperty(r))if('function'===typeof k[v][r])w+='<option name="'+r+'" type="function">'+k[v][r]['wsHandlerPath']+'</option>';else w+='<option name="'+r+'">'+k[v][r]+'</option>';w+='</options>';}e['additionalItemsActions']+=w;}if(e['resetLinkText']=l+(l&&d?', ':'')+d,e['filterStructure']=f,s['maPrintId'])e['maPrintId']=s['maPrintId'];return e;},init:function(){var e=this;S.superclass.init.call(this),e.subscribeTo(e,'onReady',e.onReady);var t=e.getChildControlByName(e._options.brwName).getChildControlByName('MyTasks'),i=t._getFastDataFilter();if(i)i.setItems([]);var n=t&&t.hasChildControlByName('filterLine')&&t.getChildControlByName('filterLine');if(n)n.setClassName('detalization_filterLine_maxWidth');var o=t&&t.getView();o&&o.subscribeTo(l.channel('EdoPartialReloader'),'onItemsCountChange',function(t,i){if(i&&i['count']&&parseInt(i['count'],10))e.onExecuted();});var r=t._getFilterButton(),a=function(t){var i={FilterDateFrom:'ФильтрДатаС',FilterDateTo:'ФильтрДатаП',FilterFace1:'ФильтрЛицо1',FilterOverdue:'ФильтрПросроченные',FilterRepeatStages:'ФильтрПовторные',FilterMilestone:'ФильтрПоВехе',FilterResponsibleFace:'ФильтрОтветственноеЛицо',FilterPriority:'ФильтрПриоритет',FilterLimitationDate:'ФильтрСрокДата',FilterListDispatch:'ФильтрСписокРассылки',FilterAuthorOrResponsibleMe:'ФильтрВладелец',FilterSender:'ФильтрОтправитель',FilterReceiver:'ФильтрПолучатель',FilterIdPhase:'ФильтрИдФазы',FilterIdRegulations:'ИдРегламента',FilterTransition:'ФильтрПереход',FilterPassageStatus:'ФильтрСтатусПерехода',FilterMarksIncluded:'ФильтрПометкиВкл',FilterMarksExcluded:'ФильтрПометкиИскл',FilterAuthorOrResponsible:'ФильтрАвторИлиОтветственный'},n={};for(var o in t)if(t.hasOwnProperty(o))n[i[o]]=t[o];e.onExecuted(n);};if(r)e.subscribeTo(r,'onApplyFilter',function(){a(this.getFilter());}),e.subscribeTo(r,'onResetFilter',function(){a(this.getFilter());});},sendMessageTo:function(e,t,n){var o=this;new i({endpoint:'Документ'}).call('ИдентификаторДляОтправкиСообщений',{'ИдО':parseInt(n.get('@Документ'),10)}).addCallback(function(e){require(['js!SBIS3.Contacts.MessagePanel'],function(t){t.open({parent:o.getTopParent(),messageRecievers:[{faceID:parseInt(n.get('Исполнитель'),10)}],docGUID:e.getRawData()});});}).addErrback(function(e){return e;});},openCardWI:function(e,n,o){new i({endpoint:'ЗаявкаСертификата'}).call('Прочитать',{'ИдО':o.get('@Документ'),'ИмяМетода':''}).addCallback(function(e){var i=e.getRow(0).get('ЗаявкаСертификата.ИНН');if(i&&i.length)window.open('http://wi.tensor.ru/kilor/?rpt=ClientSearch&flt-rg=*&flt-cln-inn='+i);else t.alert(rk('Не удалось открыть данные по клиенту'),rk('В заявке не указан ИНН'));}).addErrback(function(){t.alert(rk('Не удалось открыть данные по клиенту'),rk('Не найдена заявка'));});},onChangeHoveredItemDetalization:function(e,t){var i=this,n=i.getItemsActions(),o=n&&n.getItemsInstances();if(!(i.getItems()?i.getItems().getRecordById(t['key']):false))return;for(var r in o)if(o.hasOwnProperty(r))switch(r){case'send_msg_detalization':case'open_card_wi_detalization':o[r].show();break;default:o[r].hide();}},onTabAndMainLoaded:function(e,t){p.initTaskButtons({mainObject:this.getCurrentTabArea('main'),tabsObject:this.getCurrentTabArea('tabs'),brwName:'MyTasks',actionName:'MyTasksAction'});},onExecuted:function(o){var r=e.ControlStorage.getByName('DetalizationEventsBrowser').getChildControlByName('browserView'),a=t.clone(r.getFilter()),l=e.ControlStorage.getByName('DetalizationBrowserTabs'),s=l&&l.getParent(),d=s&&s._options;if(o)for(var c in o)if(o.hasOwnProperty(c))a[c]=o[c];a['ФильтрПолучитьСчетчики']=true;var f=new n();f.where(a);var u=new i({endpoint:d&&d.docTypeString||'Документ',binding:{query:'ПолучитьДокументыПоОтработке'}}).query(f);return u.addCallback(function(e){var t=e.getAll();if(t.getCount()>0){var i=t.at(0).has('overdue')?t.at(0).get('overdue'):0,n=t.at(0).has('count')?t.at(0).get('count'):0,o=r.getTopParent().getChildControlByName('DetalizationHead');if(true===a['ФильтрПросроченные'])n=0;o.refreshTitleCounters(n,i);}}).addErrback(function(e){return e;}),u;},setPrintColumns:function(e){e.setResult([{field:'Исполнитель.Название',title:'Исполнитель.Название'},{field:'Отправитель.Название',title:'Отправитель.Название'},{field:'РП.НазваниеПодразделенияСП',title:'РП.НазваниеПодразделенияСП'},{field:'РП.НазваниеПодразделенияИсп',title:'РП.НазваниеПодразделенияИсп'},{field:'Лицо1.Название',title:'Лицо1.Название'},{field:'РП.РазделТипаДокумента',title:'РП.РазделТипаДокумента'},{field:'Регламент.Название',title:'Регламент.Название'},{field:'ДокументРасширение.Название',title:'ДокументРасширение.Название'},{field:'РазличныеДокументы.Информация',title:'РазличныеДокументы.Информация'},{field:'ДокументРасширение.СостояниеКраткое',title:'ДокументРасширение.СостояниеКраткое'},{field:'Конец',title:'Конец'},{field:'Начало',title:'Начало'},{field:'Событие.Срок',title:'Событие.Срок'},{field:'Сотрудник.Название',title:'Сотрудник.Название'},{field:'РП.НазваниеПодразделения',title:'РП.НазваниеПодразделения'},{field:'Фаза.Название',title:'Фаза.Название'},{field:'Переход.Название',title:'Переход.Название'},{field:'СрокПечать',title:''},{field:'ДатаПечать',title:''}]);},addColumnsToData:function(e,t){var i=new o(),n=['СрокПечать','ДатаПечать'],r;for(r=0;r<n.length;r++)if(-1===t.getFormat().getFieldIndex(n[r]))t.addField(new g({name:n[r]}));for(r=0;r<t.getCount();r++){var a=t.at(r),l='',s='';if(a.get('Событие.Срок'))l=rk('Срок','Заголовок')+': '+a.get('Событие.Срок').strftime('%d.%m.%y');var d=a.get('ДокументДатаВремя')?a.get('ДокументДатаВремя'):a.get('Конец');if('ВОбработке'===a.get('ДокументРасширение.СостояниеКраткое').toString()||!d){if(a.get('Начало'))s=a.get('Начало').strftime('%d.%m.%y');}else if(d)s=d.strftime('%d.%m.%y');a.set('СрокПечать',l),a.set('ДатаПечать',s);}e.setResult(i),i.callback(t);},onClickSortChange:function(){var e=this.getParent(),t=e.getFilter(),i,n;if('ASC'===t['СортировкаПолучено'])t['СортировкаПолучено']='DESC',t['СортировкаСрок']='',i='Down',n='';else t['СортировкаПолучено']='ASC',t['СортировкаСрок']='',i='Up',n='';S.prototype.changeSort(e,t,i,n);},onClickSortSrokChange:function(){var e=this.getParent(),t=e.getFilter(),i,n;if('ASC'===t['СортировкаСрок'])t['СортировкаПолучено']='',t['СортировкаСрок']='DESC',i='',n='Down';else t['СортировкаПолучено']='',t['СортировкаСрок']='ASC',i='',n='Up';S.prototype.changeSort(e,t,i,n,true);},changeSort:function(e,t,n,o,r){e.getChildControlByName('DetalizationSortChange').setIcon('sprite:icon-16 icon-Trend'+n+' icon-primary'),e.getChildControlByName('DetalizationSrokSortChange').setIcon('sprite:icon-16 icon-Trend'+o+' icon-primary'),e.subscribe('onDrawHead',function(){e.getChildControlByName('DetalizationSortChange').setIcon('sprite:icon-16 icon-Trend'+n+' icon-primary'),e.getChildControlByName('DetalizationSrokSortChange').setIcon('sprite:icon-16 icon-Trend'+o+' icon-primary');}),e.setFilter(t,false);var a=t['СортировкаПолучено']+'$$'+t['СортировкаСрок'];new i({endpoint:'ПользовательскиеПараметры'}).call('ВставитьЗначение',{'Путь':'ДетализацияСтатистикиСортировка','ЗначениеПараметра':a});},onReady:function(){var e=this.getLinkedContext()||this.getParent()&&this.getParent().getLinkedContext(),t=e?r.deserializeURLData(decodeURIComponent(e.getValue('phaseReportParams'))):{},n=y.apply(this,[t]),o=this.getChildControlByName('DetalizationHead'),l=34,d={},c={},p=null!==t.title?t.title:'',g='',h='',S=null,w=new s(),v='',D='',b='',P=false,I=this;if(o&&o.setVisible(false),('StatisticsReportByPhaseBrowser'===I._options['fromBrowser']||'StatisticsReportByPhaseNewBrowser'===I._options['fromBrowser'])&&I._options['showPhaseNorm']&&n['ФильтрИдФазы']){if(n['ФильтрПросроченные']){var F=n['ФильтрИдФазы'];if(-1===F.indexOf(':'))F=n['ИдРегламента']+':'+F;w.push(new i({endpoint:'Regulation'}).call('PhaseRead',{'ИдО':F,'ИмяМетода':''}).addCallback(function(e){k(e,o);}).addErrback(function(e){return e;}));}else o.setTitlePhaseNorm({style:'display: none;'});var T=this.getParent().getChildControlByName('MyTasks');I.subscribeTo(T._getFilterButton().getLinkedContext(),'onFieldChange',function(e,t,r){if('filterStructure'===t)for(var a in r)if(r.hasOwnProperty(a)&&'FilterOverdue'===r[a]['internalValueField'])if(r[a]['value']){var l=n['ФильтрИдФазы'];if(-1===l.indexOf(':'))l=n['ИдРегламента']+':'+l;new i({endpoint:'Regulation'}).call('PhaseRead',{'ИдО':l,'ИмяМетода':''}).addCallback(function(e){k(e,o);}).addErrback(function(e){return e;});}else o.setTitlePhaseNorm({style:'display: none;'});});}else o.setTitlePhaseNorm({style:'display: none;'});if(!!t.count&&'0'!==t.count){var B=t.count;if(!!t.overdue&&'0'!==t.overdue)v=', ',D=rk('нарушен срок')+' ',b=t.overdue;if(true===n['ФильтрПросроченные'])B=0;d={count_txt:C(n['ФильтрПоКраткомуСостоянию'],n['ФильтрСтатистикаПериод']),count:B,sep:v,overdue_txt:D,overdue:b};}if(!!t.isDivision){if(null!==t.title&&!!parseInt(t.title,10))w.push(new i({endpoint:'Лицо'}).call('НазваниеЛица',{'Лицо':n['ФильтрИсполнительСобытия'][0]}).addCallback(function(e){p=e.getRawData();}).addErrback(function(e){return e;}));if(null!==t.title&&'Всего'!==t.title)w.push(new i({endpoint:'СтруктураПредприятия'}).call('Руководитель',{'ИдО':n['ФильтрИсполнительСобытия'][0]}).addCallback(function(e){if(e.getRow(0)&&e.getRow(0).has('@Лицо')&&e.getRow(0).get('@Лицо'))S=e.getRow(0).get('@Лицо'),new i({endpoint:'ЧастноеЛицо'}).call('ПодробнаяИнформация',{'ИдО':S+''}).addCallback(function(e){c['foto']=u({photoData:f.getPhotoData({data:{personId:S,photoId:e.getRow().get('Фото')}})}),l=78;});}).addErrback(function(e){return e;}));}else if(null!==t.title&&'Нераспределенные'!==t.title&&'без исполнителя'!==t.title&&'Прочих'!==t.title&&'Всего'!==t.title){if(null!==t.face)w.push(new i({endpoint:'ЧастноеЛицо'}).call('ПодробнаяИнформация',{'ИдО':t.face[0]+''}).addCallback(function(e){d['foto']=u({photoData:f.getPhotoData({data:{personId:e.getRow().get('@Лицо'),photoId:e.getRow().get('Фото')}})}),l=52;}));if(n['ФильтрИсполнительСобытия'])w.push(new i({endpoint:'ЧастноеЛицо'}).call('ОсновнаяИнформация',{'Лица':n['ФильтрИсполнительСобытия']}).addCallback(function(e){if(e.getAll()&&e.getAll().getCount()>=1)g=a.escapeHtml(e.getRow(0).get('Должность'))||'',h=(a.escapeHtml(e.getRow(0).get('Подразделение'))||'').split('/')[0].trim();}).addErrback(function(e){return e;}));}else if('Нераспределенные'===t.title)P=true,w.push(new i({endpoint:'Лицо'}).call('НазваниеЛица',{'Лицо':t.filter['Раздел']}).addCallback(function(e){p=e.getRawData();}).addErrback(function(e){return e;})),w.push(new i({endpoint:'СтруктураПредприятия'}).call('Руководитель',{'ИдО':t.filter['Раздел']}).addCallback(function(e){if(e.getRow(0)&&e.getRow(0).has('@Лицо')&&e.getRow(0).get('@Лицо'))S=e.getRow(0).get('@Лицо'),new i({endpoint:'ЧастноеЛицо'}).call('ПодробнаяИнформация',{'ИдО':S+''}).addCallback(function(e){c['foto']=u({photoData:f.getPhotoData({data:{personId:S,photoId:e.getRow().get('Фото')}})}),l=78;});}).addErrback(function(e){return e;}));w.done().getResult().addCallback(function(){d['name']=-1!==['Нераспределенные','без исполнителя','Прочих','Всего'].indexOf(p)?rk(p):p,d['work']=h+(h&&g?' / ':'')+g;var e=function(e,t){if(o.setBossInfo(e,true),o.setTitlePhase(t),o.setVisible(true),m.isMobileIOS&&m.isOldWebKit){var i=I.getContainer().find('.detalization_brw_tabs');if(0!==i.length)switch(l){case 52:i.addClass('height_52_for_old_webkit');break;case 78:i.addClass('height_78_for_old_webkit');break;default:i.addClass('height_34_for_old_webkit');}}};if(null!==S)new i({endpoint:'ЧастноеЛицо'}).call('ОсновнаяИнформация',{'Лица':[S]}).addCallback(function(t){var i=t.getAll();if(i&&i.getCount()>=1){var n=i.at(0).get('Фамилия'),o=i.at(0).get('Имя'),r=i.at(0).get('Отчество');c['name']=a.escapeHtml(n+' '+(o&&o.length>0?o[0]+'.':'')+(r&&r.length>0?r[0]+'.':'')),c['job']=a.escapeHtml(i.at(0).get('Должность'))||rk('Руководитель');}d['style']='height: 20px; padding-bottom: 4px;',e(c,d);}).addErrback(function(e){return e;});else{if('Всего'===p||P||'Прочих'===p||'без исполнителя'===p||!!t.isDivision)d['style']='height: 20px; padding-bottom: 4px;';e({style:'display: none;'},d);}}).addErrback(function(e){return e;});}});return S;function C(e,t){switch(e=e?e:'',e.toString()){case'1':case'2,3':return rk('завершено документов');case'2':return rk('завершено документов положительно');case'3':return rk('завершено документов отрицательно');case'4':return rk('документов в обработке');case'':switch(t){case'На начало':return rk('документов на начало периода');case'Получено':return rk('документов получено');case'Выполнено':return rk('документов выполнено за период');case'Осталось':return rk('документов осталось за период');default:return'';}default:return rk('документов в обработке');}}function y(e){var t=this.getLinkedContext()||this.getParent()&&this.getParent().getLinkedContext(),i=e||(t?r.deserializeURLData(decodeURIComponent(t.getValue('phaseReportParams'))):null),n={};if(!i)return n;for(var o in i.filter)if(i.filter.hasOwnProperty(o))n[o]=i.filter[o];if(n['ФильтрИсполнительСобытия']=-1!=w(-1,i.face)&&i.filter['Раздел']?i.filter['Раздел']:i.face,!n['ФильтрИсполнительСобытия'])n['ФильтрИсполнительСобытия']=i.filter['ФильтрИсполнительСобытия'];if(-1!=w(-1,n['ФильтрИсполнительСобытия']))delete n['ФильтрИсполнительСобытия'],n['ФильтрКонкретныйИсполнитель']='Без исполнителя',n['ФильтрКонкретныйИсполнительID']=-1;if('number'!==typeof n['ИдРегламента']&&'string'!==typeof n['ИдРегламента']&&void 0!==n['ИдРегламента'])n['ИдРегламента']=void 0;return n['isDivision']=i.isDivision,n;}function k(e,t){var i={style:'display: none;'};if(e.getRow(0)&&e.getRow(0).get('Срок')){var n=e.getRow(0).get('Срок'),o=rk('Норма по фазе')+' ',r=' '+rk('ч.');if(n>=24)n/=24,r=' '+rk('д.');i={title:o+n+r,prefix:rk('Норма по фазе'),norm:n,suffix:r};}t.setTitlePhaseNorm(i);}function w(e,t){if(t){if(t.indexOf)return t.indexOf(e);for(var i=0,n=t.length;i<n;i++)if(t[i]===e)return i;}return-1;}});
define("html!SBIS3.EDO.FilterPassageStatus",function(){var t=function(t){var n=function(){var t=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;t.test(n);)n=n.replace(t,"&#123;&#123;$1&#125;&#125;");return n}}(),e=function(t){return t.join?t.join(""):t.toString()},o=function(t){return void 0===t?"":t&&"object"==typeof t?e(t):""+t},i="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div> <div style="height: 24px; padding-right: 16px; padding-left: 32px;"> <component data-component="Deprecated/Controls/LinkButton/LinkButton" style="display:inline-block;" name="filterByScan" class="not-a-filter"> <option name="caption">'+n(o(rk("Статусу перехода")))+':</option> </component> </div> <div style="padding-left: 48px; height: 24px;"> <component data-component="SBIS3.EDO.FilterLinkButton" name="FilterPassageStatusAccepted" style="display: inline-block;"> <option name="fText">'+n(o(rk("Положительный")))+'</option> <option name="fTitle">ФильтрСтатусПерехода</option> <option name="fValue" type="string">1,3</option> </component> <div style="display: inline-block; position: relative; top: 4px; padding-left: 3px; padding-right: 3px; vertical-align: top;"> '+n(o(rk("/")))+' </div> <component data-component="SBIS3.EDO.FilterLinkButton" name="FilterPassageStatusRejected" style="display: inline-block;"> <option name="fText">'+n(o(rk("Отрицательный")))+'</option> <option name="fTitle">ФильтрСтатусПерехода</option> <option name="fValue" type="string">2,4</option> </component> </div> </div>');return(a=n(a))+(i&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return t.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.FilterPassageStatus"}},t});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.FilterPassageStatus", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".not-a-filter:hover{color:#05b!important;text-decoration:none!important;cursor:text!important}"));head.appendChild(style);});}
define('js!SBIS3.EDO.FilterViewHandlers',['Transport/BLObject','Elektronnyj_dokumentooborot_localization'],function(e){'use strict';var t={placePhaseToRegl:function(e){var t=e._findIndexByFilterName('Регламент'),n=e._findIndexByFilterName('ФильтрФаза');if(t>=0&&n>=0&&n!=t+1)if(t<n)e.changeFilterPosition('ФильтрФаза',t+1);else e.changeFilterPosition('Регламент',n);},onInitRegulationsFieldLink:function(){var n=this;if(n.getLinkedContext().getValue('ТипДокумента'))new e('Регламент').query('СписокПоТипуДокумента',{'ТипДокумента':n.getLinkedContext().getValue('ТипДокумента'),'ВключаяНедействующие':true}).addCallback(function(e){if(n.getParent()){var i=e.getRecords(),l=n.getParent().getChildControlByName('FilterViewEDO');if(1===i.length){var a=n.getParent();if(!l.getParent()._options.filtersEDO.FilterRegulations.hidePhase)l.getParent().addFilterInFW(l,{title:'ФильтрФаза',value:'isFieldLink'}),a.waitChildControlByName('ФильтрФаза').addCallback(function(e){if(t.placePhaseToRegl(e.getParent().getChildControlByName('FilterViewEDO')),i[0].hasColumn('@Регламент'))e.getLinkedContext().setValue('Регламент',i[0].get('@Регламент'));return e.resetSuggestInputValue(''),e;});}}});},onChangeRegulationsFieldLink:function(e,n){var i=this.getParent(),l=i.getChildControlByName('FilterViewEDO'),a=l.getParent();if(!l.getParent()._options.filtersEDO.FilterRegulations.hidePhase)if(null===n||0===n.length){if(i.hasChildControlByName('ФильтрФаза')){var o=i.getChildControlByName('ФильтрФаза');o.setValue(null),o.getLinkedContext().setValue('Регламент',null),i.getChildControlByName('ФильтрФаза').getContainer().parent().hide(),i.getChildControlByName('ФильтрФаза').hide();}}else if(!i.hasChildControlByName('ФильтрФаза'))a.addFilterInFW(l,{title:'ФильтрФаза',value:'isFieldLink'}),i.waitChildControlByName('ФильтрФаза').addCallback(function(e){return t.placePhaseToRegl(e.getParent().getChildControlByName('FilterViewEDO')),i.getChildControlByName('Регламент').once('onFocusIn',function(){var e=void 0;if(this.getParent()&&this.getParent().hasChildControlByName('ФильтрФаза'))e=this.getParent().getChildControlByName('ФильтрФаза');if(e)e.resetSuggestInputValue(''),e.setActive(true);}),e;});else{i.getChildControlByName('ФильтрФаза').show(),i.getChildControlByName('ФильтрФаза').getContainer().parent().show();var r=this.getValue(),g=i.getChildControlByName('ФильтрФаза'),s=g.getValue()?g.getSelectedRecords()[0].get('Регламент'):null;if(r!==s){if(s)g.setValue(null);i.getChildControlByName('Регламент').once('onFocusIn',function(){g.setActive(true);}),g.getLinkedContext().setValue('Регламент',r);}}},onInitIDRegulationsFieldLink:function(){var e=this,t=e.getSuggest(),n=e.getLinkedContext().getValue('ТипДокумента'),i=[];if(n)i.push(n);if(t)t.setParams({'Действующий':true,'ИсключитьВсеПапки':true,'СпособыСоздания':[0,1,2],'КлючиТиповДокументов':i});},onChangeIDRegulationsFieldLink:function(e,n){var i=this.getParent(),l=i.getChildControlByName('FilterViewEDO'),a=l.getParent();if(!l.getParent()._options.filtersEDO.FilterIDRegulations.hidePhase)if(null===n||0===n.length){if(i.hasChildControlByName('ФильтрИдФазы')){var o=i.getChildControlByName('ФильтрИдФазы');o.setValue(null),o.getLinkedContext().setValue('ИдРегламента',null),i.getChildControlByName('ФильтрИдФазы').getContainer().parent().hide(),i.getChildControlByName('ФильтрИдФазы').hide();}}else{var r=this.getValue();if(!i.hasChildControlByName('ФильтрИдФазы'))a.addFilterInFW(l,{title:'ФильтрИдФазы',value:'isFieldLink'}),i.waitChildControlByName('ФильтрИдФазы').addCallback(function(e){var n=[];return n.push(r),e.getLinkedContext().setValue('ИдРегламентов',n),t.placePhaseToRegl(e.getParent().getChildControlByName('FilterViewEDO')),e;});else{i.getChildControlByName('ФильтрИдФазы').show(),i.getChildControlByName('ФильтрИдФазы').getContainer().parent().show();var g=i.getChildControlByName('ФильтрИдФазы'),s=g.getValue()&&g.getLinkedContext()?g.getLinkedContext().getValue('ИдРегламента'):null;if(r!==s){if(s)g.setValue(null);var C=[];C.push(r),g.getLinkedContext().setValue('ИдРегламентов',C),g.getLinkedContext().setValue('ИдРегламента',r);}}}}};return t;});
define("html!SBIS3.EDO.EDOFilter",function(){var e=function(e){var o=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(o){for(;e.test(o);)o=o.replace(e,"&#123;&#123;$1&#125;&#125;");return o}}(),t=function(e){return e.join?e.join(""):e.toString()},i=function(e){return void 0===e?"":e&&"object"==typeof e?t(e):""+e},n="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="edo-EDOFilter" style="width:auto;height:auto;"> <div id="GridPeriod"> <div style="position:relative;left:8px;width:120px;height:auto;"> <component name="ФильтрДатаПериод" data-component="Deprecated/Controls/FieldDropdown/FieldDropdown" style="line-height:24px;height:24px;" class="edo-EDOFilter__FilterDataPeriod__"> <option name="name">ФильтрДатаПериод</option> <option name="tabindex" value="1"></option> <option name="renderStyle" value="simple"></option> <option name="isRelative" type="boolean" value="true"></option> <option name="showSelectedInList">false</option> <option name="saveState">true</option> </component> </div> <component data-component="Deprecated/Controls/DateRange/DateRange" name="ФильтрДат" style="position:absolute;top:1px;left:86px;width:160px;display:inline;"> <option name="mask">DD.MM.YY</option> <option name="dateFromName">ФильтрДатаС</option> <option name="dateToName">ФильтрДатаП</option> <option name="visible">false</option> <options name="validators" type="array"> <options> <option name="validator" type="function">js!SBIS3.EDO.Filters:periodAndDateValidation</option> <option name="errorMessage">'+o(i(rk("Заполните период!")))+'</option> <option name="failOnError">true</option> </options> </options> </component> </div> <component data-component="Deprecated/Controls/FilterView/FilterView" name="FilterViewEDO" style="width:360px;min-height:32px;"> <options name="linkText"> <option name="emptyFilterText">'+o(i(rk("Все документы...")))+'</option> <option name="filledFilterText">'+o(i(rk("другие параметры...")))+'</option> </options> </component> <div class="divRightsLim padding16"> <div class="divRightsLimHeader"> '+o(i(rk("Внимание! Действуют ограничения прав.")))+' </div> <div class="divRightsLimText"> '+o(i(e.rightsLimText))+" </div> </div> </div>");return(a=o(a))+(n&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.EDOFilter"}},e});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.EDOFilter", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-EDOFilter{position:relative;left:-8px}.edo-EDOFilter .edo_field_link{padding-left:12px}.filter_title{font-size:18px!important;font-family:Tahoma,Geneva,sans-serif!important;color:#000!important;left:16px}.padding16{padding-left:16px}.divRightsLimHeader{color:#ff7033}.divRightsLimText{color:#ff7033}.ws-FilterView__link{line-height:32px!important}.edo-EDOFilter__FilterDataPeriod__ .ws-field-dropdown{background-color:transparent}.AddresseeChoice-SecondLine{color:#999;font-size:12px;line-height:12px}"));head.appendChild(style);});}
define("html!SBIS3.EDO.FilterLinkButton",function(){var t=function(t){var n=function(){var t=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;t.test(n);)n=n.replace(t,"&#123;&#123;$1&#125;&#125;");return n}}(),e=function(t){return t.join?t.join(""):t.toString()},o=function(t){return void 0===t?"":t&&"object"==typeof t?e(t):""+t},r="undefined"!=typeof process,i=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div style="height:24px;width:auto;"> <component data-component="Deprecated/Controls/LinkButton/LinkButton" name="FilterSelector"> <option name="caption">'+n(o(t.fText))+"</option> </component> </div>");return(i=n(i))+(r&&-1!==i.indexOf("{{")?String.fromCharCode(8203,8203):"")};return t.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.FilterLinkButton"}},t});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.FilterLinkButton", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(""));head.appendChild(style);});}
define('js!SBIS3.EDO.FilterLinkButton',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.FilterLinkButton','css!SBIS3.EDO.FilterLinkButton','Deprecated/Controls/LinkButton/LinkButton','Deprecated/Controls/Button/Button','Elektronnyj_dokumentooborot_localization'],function(t,i){'use strict';var e=t.extend({_dotTplFn:i,$protected:{_options:{fTitle:'',fValue:'',fText:'Набираемый фильтр',fTextValue:'',excludedFilters:[],configGetter:void 0,filterSettings:{},fTooltip:'',outerTooltip:'',defaultValue:''},_btn:void 0},$constructor:function(){this._publish('onClick'),this._publish('onSelectFilter');},setFText:function(t){this._options.fText=t,this._options.filterSettings['fText']=t,this._btn.setCaption(t);},setFValue:function(t){if(!this._options.fText)this._options.fText=t;this._options.filterSettings['fValue']=t,this._options.fValue=t;},setFilterSettings:function(t){if(this._options.filterSettings=t,t.hasOwnProperty('fText')&&t['fText'])this._btn.setCaption(t['fText']);},setFTooltip:function(t){this._btn.setTooltip(t);},getFSettingsByValue:function(t){if(this._options.fValue==t||'isFieldLink'==this._options.fValue)return this._packFSettings();else return;},getFSettingsByNameAndValue:function(t,i){if(this._options.fTitle==t)return this.getFSettingsByValue(i);else return;},_packFSettings:function(){var t={};if(t['title']=this._options.fTitle,t['value']=this._options.fValue,t['textValue']=this._options.fTextValue?this._options.fTextValue:this._options.fText,t['excludedFilters']=this._options.excludedFilters,t['tooltip']=this._options.ftooltip,t['outerTooltip']=this._options.outerTooltip,t['defaultValue']=this._options.defaultValue,this._options.configGetter)t['configGetter']=this._options.configGetter;return t;},init:function(){var t=this;e.superclass.init.call(t),this._btn=t.getChildControlByName('FilterSelector'),this.setFTooltip(this._options.fTooltip),this._btn.subscribe('onClick',function(){t._notify('onClick',t._options.fTitle,t._options.fValue,t._options.fText),t._notify('onSelectFilter',t._packFSettings());});}});return e;});
define('js!SBIS3.EDO.EDOFilter',['Lib/Control/FloatArea/FloatArea','Deprecated/Controls/FilterFloatArea/FilterFloatArea','Core/core-merge','Core/constants','Core/helpers/fast-control-helpers','Core/helpers/additional-helpers','Core/moduleStubs','Core/ParallelDeferred','Core/Deferred','Core/IoC','SBIS3.CONTROLS/CompoundControl','js!SBIS3.EDO.FieldLinksCfg','js!SBIS3.EDO.FilterViewHandlers','html!SBIS3.EDO.EDOFilter','css!SBIS3.EDO.EDOFilter','Deprecated/Controls/Label/Label','Deprecated/Controls/FieldDropdown/FieldDropdown','Deprecated/Controls/DateRange/DateRange','Deprecated/Controls/DialogAlert/DialogAlert','Deprecated/Controls/SearchString/SearchString','Deprecated/Controls/FieldDate/FieldDate','Deprecated/Controls/FilterView/FilterView','Deprecated/Controls/LinkButton/LinkButton','Deprecated/Controls/Button/Button','js!SBIS3.EDO.FilterLinkButton','Deprecated/Controls/FilterFloatArea/FilterFloatArea','Deprecated/Controls/FieldLink/FieldLink','i18n!SBIS3.EDO.EDOFilter','Elektronnyj_dokumentooborot_localization'],function(e,t,i,r,l,a,o,s,n,f,u,d,h,c){'use strict';var p=u.extend({_dotTplFn:c,$protected:{templateReadyDeferred:void 0,_options:{autoHeight:true,autoWidth:true,emptyLinkText:rk('Все документы...'),filterKitLinkText:'',filtersEDO:{FilterState:{fName:'ФильтрСостояние',show:false,filterStateData:[],defaultValue:null},FilterShortState:{fName:'ФильтрПоКраткомуСостоянию',show:false,filterStateData:[],defaultValue:null},FilterRegulations:{fName:'Регламент',show:false,kitTitle:rk('Операции (этапу)'),noDocType:false,defaultValue:null,hidePhase:false,subFilters:['ФильтрФаза']},FilterIDRegulations:{fName:'ИдРегламента',show:false,kitTitle:rk('Операции (этапу)'),noDocType:false,defaultValue:null,hidePhase:false,subFilters:['ИДФазы']},FilterTransition:{fName:'ФильтрПереход',show:false,kitTitle:rk('Результату'),defaultValue:null},FilterFace1:{fName:'ФильтрЛицо1',show:false,title:rk('Контрагент'),kitTitle:rk('Контрагенту'),defaultValue:-1},FilterOurOrganisation:{fName:'ФильтрДокументНашаОрганизация',show:false,title:rk('Наша организ-я'),kitTitle:rk('Нашей организации'),defaultValue:-1},FilterOwner:{fName:'ФильтрВладелец',show:false,defaultValue:'Все',titleFromValue:true},FilterResponsibleFace:{fName:'ФильтрОтветственноеЛицо',show:false,title:rk('Ответственный'),kitTitle:rk('Ответственному'),defaultValue:-1},FilterAuthorOrResponsible:{fName:'ФильтрАвторИлиОтветственный',show:false,defaultValue:-1,hidePerformer:false,hideAuthor:false,subFilters:['ФильтрАвтор','ФильтрОтветственноеЛицо','ФильтрСписокРассылки']},FilterAuthorOrResponsibleMe:{fName:'ФильтрОтМеня/ОтОтдела',show:false,unitNamesArr:['FilterOwner','FilterOwnerUnit'],titleArr:[],kitTitleArr:[],valueArr:[],defaultValue:-1,subFilters:['ФильтрВладелец']},FilterTypeDocVD:{fName:'ТипДокументаВД',show:false,title:rk('Тип документа'),kitTitle:rk('Типу документа'),defaultValue:-1},FilterEventPerformer:{fName:'ФильтрИсполнительСобытия',show:false,title:rk('Тек. исполнит.'),kitTitle:rk('Исполнителю текущего этапа'),defaultValue:-1},FilterSpecificPerformer:{fName:'ФильтрКонкретныйИсполнитель',show:false,defaultValue:-1,showNoPerformer:false},FilterListDispatch:{fName:'ФильтрСписокРассылки',show:false,title:rk('Исполнитель'),kitTitle:rk('Исполнителю документа'),defaultValue:-1},FilterAuthor:{fName:'ФильтрАвтор',show:false,title:rk('Автор'),kitTitle:rk('Автору'),defaultValue:-1},FilterSender:{fName:'ФильтрОтправитель',show:false,title:rk('Отправитель'),kitTitle:rk('Отправителю'),multiselect:true,groupselect:true,defaultValue:-1},FilterPhase:{fName:'ФильтрФаза',show:false,title:rk('Этап'),kitTitle:rk('Этапу'),defaultValue:-1},FilterOverdue:{fName:'ФильтрПросроченные',show:false,title:rk('Просроченные'),kitTitle:rk('Просроченные'),value:true,defaultValue:false,hideDeadline:false,subFilters:['ФильтрСрокДата']},FilterLimitationDate:{fName:'ФильтрСрокДата',show:false,title:rk('Срок выполнения'),kitTitle:rk('Сроку выполнения'),defaultValue:-1},FilterDeleted:{fName:'ФильтрУдаленные',show:false,title:rk('Удаленные'),kitTitle:rk('Удаленные'),value:true,defaultValue:false,hideDraft:true,showShort:false,subFilters:['ФильтрУдаленные','ФильтрСостояние','ФильтрПоКраткомуСостоянию']},FilterUnanswered:{fName:'ФильтрНеотвеченные',show:false,title:rk('Неотвеченные'),kitTitle:rk('Неотвеченные'),value:true,defaultValue:false},FilterPosted:{fName:'ФильтрПроведенные',show:false,defaultValue:-1},FilterPriority:{fName:'ФильтрПриоритет',show:false,title:rk('Важные'),kitTitle:rk('Важным'),value:1,defaultValue:0},FilterUnfixed:{fName:'ФильтрНезакрепленные',show:false,title:rk('Незакрепленные'),kitTitle:rk('Незакрепленные'),value:-2,defaultValue:false},FilterPayment:{fName:'ФильтрОплата',show:false,defaultValue:-1},FilterShipping:{fName:'ФильтрПоставка',show:false,defaultValue:-1},FilterMilestone:{fName:'ФильтрПоВехе',show:false,title:rk('Веха'),kitTitle:rk('Вехе'),defaultValue:-1},FilterReceiver:{fName:'ФильтрПолучатель',show:false,title:rk('Получатель'),kitTitle:rk('Получателю'),multiselect:true,groupselect:true,defaultValue:-1}},filterDataPeriodLimited:false,filtersCustom:{templateTop:'',templateBottom:''},rightsLim:{show:false,text:'',textRender:void 0}},_filtersSet:[],_FloatPanel:void 0,_FilterView:void 0,_FilterButton:void 0,_manualAdd:false,_templateTop:void 0,_templateBottom:void 0},$constructor:function(){this._publish('onInit'),this._publish('onSelectFilter'),this._publish('onBeforeControlsLoad'),f.resolve('ILogger').log('EDOFilter','Контрол является устаревшим и будет удален в 3.17.20, используйте BaseFilters и платформенный механизм наборности');},setFilterDataPeriodLimited:function(e){if(e)this._setDataPeriodLimData();else this._setDataPeriodFullData();},setRightsLim:function(e){setRightsLimShow(e.show),setRightsLimText(e.text);},getTemplateReadyDeferred:function(){return this.templateReadyDeferred.getResult();},setRightsLimShow:function(e){if(this._options.rightsLim.text)this.getContainer().find('.divRightsLim').toggle(e);else this.getContainer().find('.divRightsLim').toggle(false);},setRightsLimText:function(e){if(e)this._options.rightsLim.text=e,this.setRightsLimShow(this._options.rightsLim.show),this.getContainer().find('.divRightsLimText').text(e);else this.setRightsLimShow(false);},setEmptyLinkText:function(e){this.waitChildControlByName('FilterViewEDO').addCallback(function(t){t.setLinkTexts(e);});},setFilterKitLinkText:function(e){this.waitChildControlByName('FiltersKit').addCallback(function(t){return t.setLinkTitle(e),t;});},setFiltersEDO:function(e){if(!('ProjectManagement'in r.modules))e.FilterMilestone.show=false;this._generateFiltersSet(e);},_filterTypeByName:function(e){var t=this._options.filtersEDO;for(var i in t)if(t.hasOwnProperty(i)&&t[i].fName===e)return i;return;},_filterDefaultValueByName:function(e){var t=this._options.filtersEDO;for(var i in t)if(t.hasOwnProperty(i)&&t[i].fName===e)return t[i].defaultValue;return;},_filterTextByName:function(e){var t=this._options.filtersEDO;for(var i in t)if(t.hasOwnProperty(i)&&t[i].fName===e&&t[i].hasOwnProperty('title'))return t[i].title;return;},_filterTextByNameAndValue:function(e,t){var i=this._options.filtersEDO;for(var r in i)if(i.hasOwnProperty(r)&&i[r].fName===e)if(i[r].hasOwnProperty('title')&&i[r].hasOwnProperty('value')&&i[r].value===t)return i[r].title;else if(i[r].hasOwnProperty('titleFromValue')&&i[r].titleFromValue)return t;else if(i[r].hasOwnProperty('filterStateData'))for(var l=i[r].filterStateData,a=0;a<l.length;a++)if(l[a].isMul){var o=l[a].key.split(';'),s=l[a].value.split(';'),n=[];if(l[a].valueOnSelect)n=l[a].valueOnSelect.split(';');for(var f=0;f<o.length;f++)if(o[f]==t)return n[f]||s[f]||o[f];}else if(l[a].key==t)return l[a].valueOnSelect||l[a].value||l[a].key;return;},toggleFilter:function(e,t){var i=this._filterTypeByName(e);if(i){if(this._options.filtersEDO[i].hasOwnProperty('show'))this._options.filtersEDO[i].show=t;else this._options.filtersEDO[i]=t;this._generateFiltersSet(this._options.filtersEDO);}},showFilter:function(e){this.toggleFilter(e,true);},hideFilter:function(e){this.toggleFilter(e,false);},toggleFilterContainer:function(e,t){this._FloatPanel.getChildControlByName('FiltersKit')._makeVisible(e,t);},enableFilterPeriod:function(e,t){var i=this.getChildControlByName('ФильтрДатаПериод');if(e)i.show();else i.hide();},setDataFilterPeriod:function(e){this.getChildControlByName('ФильтрДатаПериод').setData(e);var t=e[0].key;this.getChildControlByName('ФильтрДатаПериод').setValue(t);},_generateFiltersSet:function(e){this._filtersSet=[];for(var t in e)if(e.hasOwnProperty(t)){var i=false;if(e[t].hasOwnProperty('show'))i=e[t].show;else i=e[t];if(i)this._filtersSet.push(t.toString());}if(this._FloatPanel)this._FloatPanel.getChildControlByName('FiltersKit').setFiltersSet(this._filtersSet);},_getFilterTitle:function(e){var t=this._options.filtersEDO;for(var i in t)if(t.hasOwnProperty(i)&&t[i].fName===e&&t[i].hasOwnProperty('show')&&t[i].show&&t[i].hasOwnProperty('title'))return t[i].title;return;},_getCustomFilter:function(e,t){for(var i=e.getChildControls(),r=0;r<i.length;r++)if(i[r]._options.fTitle&&i[r]._options.fTitle===t){var l={};return l['title']=i[r]._options.fTitle,l['value']=i[r]._options.fValue,l['textValue']=i[r]._options.fText,l['excludedFilters']=i[r]._options.excludedFilters,l;}},_getfSettingFromKit:function(e,t,i){for(var r=e.getChildControls(),l=r.length-1;l>=0;l--)if(r[l].getFSettingsByNameAndValue){var a=r[l].getFSettingsByNameAndValue(t,i);if(a)return a;}return;},_loadTemplateArea:function(e,t,i){var r=e.getContainer().find(t),l=this;return o.require(i).addCallback(function(t){var i=new t[0]({element:r,parent:e});return e.subscribeChildrenSelectFilter(i),i;});},_applyFiltersKitSettings:function(e){var t=this;e.setFiltersSet(this._filtersSet);for(var i=this._options.filtersEDO,r,l=0;l<this._filtersSet.length;l++)if(r=this._filtersSet[l],i.hasOwnProperty(r)){if(i[r].hasOwnProperty('filterStateData'))e.setFilterData(r,i[r].filterStateData);if(i[r].hasOwnProperty('kitTitle'))e.setFieldLinkTitle(r,i[r].kitTitle);if(i[r].hasOwnProperty('value'))e.setFilterValue(r,i[r].value);if(i[r].hasOwnProperty('unitNamesArr'))for(var a=0;a<i[r].unitNamesArr.length;a++){var o=i[r].unitNamesArr[a];if(!o)continue;if(i[r].hasOwnProperty('kitTitleArr')&&i[r].kitTitleArr[a])e.setFieldLinkTitle(o,i[r].kitTitleArr[a]);if(i[r].hasOwnProperty('valueArr')&&i[r].valueArr[a])e.setFilterValue(o,i[r].valueArr[a]);}}if(e.setHidePerformer(i.FilterAuthorOrResponsible.hidePerformer),e.setHideAuthor(i.FilterAuthorOrResponsible.hideAuthor),e.setHideDraft(i.FilterDeleted.hideDraft,i.FilterDeleted.showShort),e.setHideDeadline(i.FilterOverdue.hideDeadline),e.setShowNoPerformer(i.FilterSpecificPerformer.showNoPerformer),this._options.filtersCustom['templateBottom'])this.templateReadyDeferred.push(this._loadTemplateArea(e,'.divTemplatedAreaBottom',this._options.filtersCustom['templateBottom']).addCallback(function(e){t._templateBottom=e;}));if(this._options.filtersCustom['templateTop'])this.templateReadyDeferred.push(this._loadTemplateArea(e,'.divTemplatedAreaTop',this._options.filtersCustom['templateTop']).addCallback(function(e){t._templateTop=e;}));this.templateReadyDeferred.done();},_showFloatPanel:function(e){var t=this,i=t._options.filterKitLinkText?-7:-5;l.showFloatArea({template:'js!SBIS3.EDO.FiltersKit',target:e.getContainer(),parent:t,autoShow:false,autoCloseOnHide:false,animation:'fade',side:'left',offset:{x:12,y:i},verticalAlign:'top'}).addCallback(function(i){i.getReadyDeferred().addCallback(function(){if(t._FloatPanel=i,i.hasChildControlByName('FiltersKit')){var r=i.getChildControlByName('FiltersKit');t._applyFiltersKitSettings(r),r.subscribe('onSelectFilter',function(r,l){i.hide(),t._manualAdd=true,t.addFilterInFW(e,l);}),r.subscribe('onTitleClick',function(){i.hide();});}});});},_waitControlAndSetValue:function(e,t,i){var r=new n();return e.waitChildControlByName(t).addCallback(function(e){if(e.getValue()!==i&&e.setValue){var t=e.setValue(i);if(t&&t instanceof n)t.addCallback(function(){r.callback(true);}).addErrback(function(e){r.callback(true);});else r.callback(true);}else r.callback(true);return e;}),r;},_clearFW:function(e,t){if(!e)return;var i=e.getQuery(true);for(var r in i)if(!t.hasOwnProperty(r)||t.hasOwnProperty(r)&&'undefined'!==typeof i[r]&&null!==i[r]&&!this._sameValues(t[r],i[r]))e.deleteFilter(r);},_notToShowFilter:function(e){var t=this,i=t._options.filtersEDO,r=false,l=false,a;if(t._options.filtersCustom.templateTop&&t._templateTop)a=t._getCustomFilter(t._templateTop,e);if(!a&&t._options.filtersCustom.templateBottom&&t._templateBottom)a=t._getCustomFilter(t._templateBottom,e);if(a)return false;for(var o in i)if(i[o].hasOwnProperty('fName')&&i[o].fName==e||i[o].hasOwnProperty('subFilters')&&Array.indexOf(i[o].subFilters,e)>=0)if(l=true,i[o].hasOwnProperty('show'))r=r||i[o].show;if(l)return!r;else return false;},_sameValues:function(e,t){if('undefined'===typeof e||'undefined'===typeof t)return true;var i=a.type(e);if(i!=a.type(t))return false;if('array'==i){var r=false;if(e.length==t.length){r=true;for(var l=0;l<e.length;l++){for(var o=false,s=0;s<t.length;s++)if(e[l]==t[s]){o=true;break;}if(!o){r=false;break;}}}}else r=e===t;return r;},addFiltersSelected:function(t){var r=new n(),l=new s(),a=this,o=i({},t),f;return a.waitChildControlByName('FilterViewEDO').addCallback(function(t){a._clearFW(t,o);var i=t.getQuery();return a.waitChildControlByName('FiltersKit').addCallback(function(s){return a.getTemplateReadyDeferred().addCallback(function(){for(var n in o){if(!o.hasOwnProperty(n))continue;if(i.hasOwnProperty(n)&&a._sameValues(o[n],i[n]))continue;var u=o[n],d=a._filterTypeByName(n);if(a._notToShowFilter(n))continue;if('ФильтрДатаПериод'===n&&a.hasChildControlByName('ФильтрДатаПериод'))a.getChildControlByName('ФильтрДатаПериод').setValue(o[n]);if(f=a._getfSettingFromKit(s,n,u),!f)continue;var h=f.textValue;if(d){var c=a._filterTextByNameAndValue(n,u),p=a._filterDefaultValueByName(n);if(h)f.textValue=h;if(c)h=c;}if('isFieldLink'==f.value){if(void 0!==u){a.addFilterInFW(t,f);var m=a.getParentByClass(e);l.push(a._waitControlAndSetValue(m,n,u));}}else if(h)a.addFilterInFW(t,f);}l.done().getResult().addCallback(function(){r.callback();}).addErrback(function(){r.callback();});}),s;}),t;}),r;},addFilterInFW:function(e,t){var i=this,l=t.title,a=t.value,o=t.textValue;if(void 0===l)return;if(void 0===e)return;if('ФильтрПоВехе'==l&&!('ProjectManagement'in r.modules))return;i._notify('onSelectFilter',t.title,t.value);var s=e.getQuery();if(t.hasOwnProperty('excludedFilters'))for(var n=0;n<t.excludedFilters.length;n++){var f=t.excludedFilters[n].toString().split(':'),u=f[0];if(f.length>1){var h=f[1].toString().split(',');if(s.hasOwnProperty(u)){for(var c=s[u].toString().split(','),p=true,m=0;m<c.length;m++){for(var F=false,g=0;g<h.length;g++)if(c[m]==h[g])F=true;p=p&&F;}if(p){if(e.getLinkedContext().hasField(u))e.getLinkedContext().setValue(u,null);e.deleteFilter(u);continue;}}}else{if(e.getLinkedContext().hasField(u))e.getLinkedContext().setValue(u,null);e.deleteFilter(u);}}if(t.hasOwnProperty('defaultValue'))if(t.defaultValue&&a==t.defaultValue)return void e.deleteFilter(l);var k=i._getFilterTitle(l);if('isFieldLink'===a){if(t.hasOwnProperty('configGetter'))var w=t.configGetter(l);else w=d.getCfgByName(l);if(!w)return;if('undefined'!==typeof k)w.config[1].title=k;var y=this._options.filtersEDO;for(var v in y)if(y.hasOwnProperty(v)&&y[v].fName===l){if(y[v].hasOwnProperty('multiselect'))w.config[1].multiSelect=y[v].multiselect;if(y[v].hasOwnProperty('groupselect'))w.config[1].selectionType=y[v].groupselect?'all':'leaf';}var _=e.getLinkedContext().toObject();for(var C in _)if(0===C.indexOf(l))e.getLinkedContext().setValue(C,null);if(w.config[1].linkedContext=e.getLinkedContext(),'Регламент'==l&&i._options.filtersEDO.FilterRegulations.noDocType)w.config[1].linkedContext.setValue('ТипДокумента',void 0);if('undefined'!==typeof w)e.addFilter(w),i._notifyOnSizeChanged(true);}else{switch(a){case'true':a=true;break;case'false':a=false;}if('undefined'!==typeof k)o=k;var D=t.outerTooltip;if(e.getQuery(true).hasOwnProperty(l))e.changeSimpleFilter(l,{title:l,value:a,textValue:o,toolTipText:D});else e.addFilter({title:l,value:a,textValue:o,toolTipText:D});i._notifyOnSizeChanged(true);}},_onFilterPeriodValueChange:function(e,t){var i=e.getParent(),r=this.getChildControlByName('ФильтрДат');if('Период'===t)r.validate(),r.show(),setTimeout(function(){r.setActive(true);},0);else{var l=r.getValidators();r.setValidators([]),r.validate(),r.setValidators(l),r.hide();}},_setDataPeriodFullData:function(){this.getChildControlByName('ФильтрДатаПериод').setData([{key:'Все',value:rk('За весь период')},{key:'Сегодня',value:rk('За сегодня')},{key:'Месяц',value:rk('За последний месяц')},{key:'Полгода',value:rk('За последние полгода')},{key:'Год',value:rk('За последний год')},{key:'Период',value:rk('За период')}]);var e=this.getChildControlByName('ФильтрДатаПериод').getDefaultValue();this.getChildControlByName('ФильтрДатаПериод').setValue(e);},_setDataPeriodLimData:function(){this.getChildControlByName('ФильтрДатаПериод').setData([{key:'Месяц',value:rk('За последний месяц')},{key:'Сегодня',value:rk('За сегодня')},{key:'Полгода',value:rk('За последние полгода')},{key:'Год',value:rk('За последний год')},{key:'Период',value:rk('За период')}]);var e=this.getChildControlByName('ФильтрДатаПериод').getDefaultValue();this.getChildControlByName('ФильтрДатаПериод').setValue(e);},_phaseKeeper:function(){var t=this;if(!t._FilterView)return;var i=t._FilterView.getQuery();if(i['Регламент'])t.getParentByClass(e).getChildControlByName('Регламент').setValue(i['Регламент']);},_cutHtmlTags:function(e){for(var t in e)if(-1!==e[t].indexOf('span'))e[t]=$(e[t]).text();return e;},_makeStrArr:function(e){for(var t in e)if(e.hasOwnProperty(t))e[t]=e[t].toString();return;},_subscribeFBEvents:function(e){var t=this;e.subscribe('onBeforeShow',function(){if(this.getBrowser()){var e=this.getBrowser().getQuery(true);t.addFiltersSelected(e);}}),e.subscribe('onCreateRequest',function(e,i,r){r=t._cutHtmlTags(r);var l=t._FilterView.getQueryWithTextValues();for(var a in l)if(l.hasOwnProperty(a))r[a]=l[a];delete r['FilterViewEDO'];var o='';for(var s in r)if(r.hasOwnProperty(s)){if(o)o+=', ';var n='',f='';switch(s){case'ФильтрАвтор':n=rk('Автор')+': ';break;case'ФильтрЛицо1':if(f=t._options.filtersEDO.FilterFace1.title,f)n=f+': ';else n=rk('Контрагент')+': ';break;case'ФильтрОтправитель':n=rk('Отправитель')+': ';break;case'ФильтрИсполнительСобытия':n=rk('Тек.исполнитель')+': ';break;case'ФильтрОтветственноеЛицо':if(f=t._options.filtersEDO.FilterResponsibleFace.title,f)n=f+': ';else n=rk('Ответственный')+': ';break;case'ФильтрСписокРассылки':n=rk('Исполнитель документа')+': ';break;case'ФильтрДокументНашаОрганизация':n=rk('Наша организация')+': ';break;case'ФильтрПользователь':case'ФильтрПолучатель':n=rk('Получатель')+': ';}o+=n+r[s];}e.setResult(o);}),e.subscribe('onBeforeAddHistoryRequest',function(e,r){if(r){var l=i({},r);if(t._FilterView){var a=t._FilterView.getQuery();for(var o in l)if(!('ФильтрДатаПериод'==o||'ФильтрДатаС'==o||'ФильтрДатаП'==o||a.hasOwnProperty(o)))delete l[o];if(!l['ФильтрДатаПериод'])l['ФильтрДатаПериод']=t.getChildControlByName('ФильтрДатаПериод').getDefaultValue();if(!l['ФильтрДатаС'])l['ФильтрДатаС']=null;if(!l['ФильтрДатаП'])l['ФильтрДатаП']=null;if(l['ФильтрСостояние'])l['ФильтрСостояние']=l['ФильтрСостояние'].toString();if(l['ФильтрПоКраткомуСостоянию'])l['ФильтрПоКраткомуСостоянию']=l['ФильтрПоКраткомуСостоянию'].toString();if(l['ФильтрВладелец'])delete l['ФильтрОтветственноеЛицо'],delete l['ФильтрАвтор'],delete l['ФильтрНезакрепленные'];if(l['ФильтрПоВехе']&&Array.isArray(l['ФильтрПоВехе']))t._makeStrArr(l['ФильтрПоВехе']);var s=false;if(l['ФильтрИдФазы'])s=true;if(s)e.setResult(false);else e.setResult(l);}}}),e.subscribe('onBeforeHistoryRender',function(e,t){for(var i in t){if(t.hasOwnProperty(i)&&t[i].hasOwnProperty('ФильтрПоВехе')){var r=false;for(var l in t[i]['ФильтрПоВехе'])if(t[i]['ФильтрПоВехе'].hasOwnProperty(l))if('number'==typeof t[i]['ФильтрПоВехе'][l]){r=true;break;}if(r)delete t[i];}if(t.hasOwnProperty(i)&&t[i].hasOwnProperty('ИДРегламента'))if(t[i].hasOwnProperty('Регламент'))delete t[i];}e.setResult(t);});},_subscribeBrowEvents:function(e,t){var i=this;e.subscribe('onKeyPressed',function(e,i){if(this._isCtrl(i)&&i.which===r.key.q)t.showFloatArea();});},init:function(){p.superclass.init.call(this);var e=this;if(e.templateReadyDeferred=new s(),e._FilterView=e.getChildControlByName('FilterViewEDO'),e.setEmptyLinkText(e._options.emptyLinkText),e.setFilterKitLinkText(e._options.filterKitLinkText),e.setFiltersEDO(this._options.filtersEDO),e.setRightsLimShow(e._options.rightsLim.show),void 0!==e._options.rightsLim.textRender)e.setRightsLimText(e._options.rightsLim.textRender());e.getChildControlByName('ФильтрДатаПериод').subscribe('onValueChange',function(t,i){e._onFilterPeriodValueChange(this,i);}),e.setFilterDataPeriodLimited(e._options.filterDataPeriodLimited),this._showFloatPanel(this.getChildControlByName('FilterViewEDO')),e._FilterView.subscribe('onClickLink',function(){e._FloatPanel.show();}),e._FilterView.subscribe('onAddNewControl',function(t,i){if(i&&'ИдРегламента'==i.getName()&&!i.hasEventHandlers('onInit'))h.onInitIDRegulationsFieldLink.call(i),i.subscribe('onValueChange',h.onChangeIDRegulationsFieldLink);if(e._manualAdd)e._manualAdd=false,i.setActive(true);}),e._FilterView.subscribe('onBeforeShow',function(t){e._phaseKeeper();});var i=e.getParentByClass(t);if(i)if(e._FilterButton=i.getOpener(),e._FilterButton)if(e._subscribeFBEvents(e._FilterButton),e._FilterButton.getBrowser())e._subscribeBrowEvents(e._FilterButton.getBrowser(),e._FilterButton);var r=e._FilterView.getContainer().find('.ws-FilterView__link');if(r)r.css('text-align','left'),r.css('padding-left','12px');e._notify('onInit');}});return p;});
define('js!SBIS3.EDO.FilterPassageStatus',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.FilterPassageStatus','css!SBIS3.EDO.FilterPassageStatus','js!SBIS3.EDO.EDOFilter','js!SBIS3.EDO.FilterLinkButton','i18n!SBIS3.EDO.FilterPassageStatus','Deprecated/Controls/LinkButton/LinkButton','Elektronnyj_dokumentooborot_localization'],function(t,e){var n=t.extend({_dotTplFn:e,$protected:{_options:{autoHeight:true,autoWidth:true}},$constructor:function(){},init:function(){n.superclass.init.call(this);}});return n;});
define("html!SBIS3.EDO.FilterRepeatStages",function(){var e=function(e){var t=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;e.test(t);)t=t.replace(e,"&#123;&#123;$1&#125;&#125;");return t}}(),n=function(e){return e.join?e.join(""):e.toString()},o=function(e){return void 0===e?"":e&&"object"==typeof e?n(e):""+e},r="undefined"!=typeof process,i=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div> <div style="padding-left:32px;"> <component data-component="SBIS3.EDO.FilterLinkButton" name="FilterRepeatStages" style="display:inline-block;height:22px"> <option name="fText">'+t(o(rk("Убрать повторную обработку")))+'</option> <option name="fTitle">ФильтрПовторные</option> <option name="fValue">true</option> </component> </div> </div>');return(i=t(i))+(r&&-1!==i.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.FilterRepeatStages"}},e});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.FilterRepeatStages", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(""));head.appendChild(style);});}
define('js!SBIS3.EDO.FilterRepeatStages',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.FilterRepeatStages','css!SBIS3.EDO.FilterRepeatStages','js!SBIS3.EDO.EDOFilter','js!SBIS3.EDO.FilterLinkButton','i18n!SBIS3.EDO.FilterRepeatStages','Elektronnyj_dokumentooborot_localization'],function(t,e){var i=t.extend({_dotTplFn:e,$protected:{_options:{autoHeight:true,autoWidth:true}},$constructor:function(){},init:function(){i.superclass.init.call(this);}});return i;});
define("html!SBIS3.EDO.FilterStatIncoming",function(){var o=function(o){var t=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;o.test(t);)t=t.replace(o,"&#123;&#123;$1&#125;&#125;");return t}}(),n=function(o){return o.join?o.join(""):o.toString()},e=function(o){return void 0===o?"":o&&"object"==typeof o?n(o):""+o},i="undefined"!=typeof process,p=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div> <component data-component="SBIS3.EDO.EDOFilter" name="ФильтрЭДОСтатистика"> <options name="rightsLim"> <option name="show">true</option> <option name="textRender" type="function">js!SBIS3.EDO.ScopeFilters:setScopeTextForFilter</option> </options> <option name="filterDataPeriodLimited">true</option> <options name="filtersEDO"> <options name="FilterDeleted"> <option name="show">true</option> </options> <options name="FilterState"> <option name="show">true</option> <options name="filterStateData" type="array"> <options> <option name="key" type="string">10</option> <option name="value">'+t(e(rk("Внутренняя обработка")))+'</option> </options> <options> <option name="key" type="string">7</option> <option name="value">'+t(e(rk("Утвержденные")))+'</option> <option name="valueOnSelect">'+t(e(rk("Утвержденные")))+'</option> <options name="excludedFilters" type="array"> <option>ФильтрСрокДата</option> <option>ФильтрПросроченные</option> </options> </options> <options> <option name="key" type="string">9</option> <option name="value">'+t(e(rk("Отклоненные")))+'</option> <option name="valueOnSelect">'+t(e(rk("Отклоненные")))+'</option> <options name="excludedFilters" type="array"> <option>ФильтрСрокДата</option> <option>ФильтрПросроченные</option> </options> </options> <options> <option name="key" type="string">22</option> <option name="value">'+t(e(rk("Аннулированные")))+'</option> </options> <options> <option name="key" type="string">19,20</option> <option name="value">'+t(e(rk("Удалено мной/контрагентом")))+'</option> </options> <options> <option name="key" type="string">0,1</option> <option name="value">'+t(e(rk("Черновики")))+'</option> </options> </options> </options> <options name="FilterFace1"> <option name="show">true</option> <option name="kitTitle">'+t(e(rk("Отправителю")))+'</option> <option name="title">'+t(e(rk("Отправитель")))+'</option> </options> <options name="FilterUnfixed"> <option name="show">true</option> </options> <options name="FilterResponsibleFace"> <option name="show">true</option> </options> <options name="FilterAuthorOrResponsibleMe"> <option name="show">true</option> <options name="kitTitleArr" type="array"> <option>'+t(e(rk("Мои")))+"</option> <option>"+t(e(rk("Моего отдела")))+'</option> </options> </options> <options name="FilterOurOrganisation"> <option name="show">true</option> </options> <options name="FilterRegulations"> <option name="show">false</option> </options> </options> <options name="handlers"> <options name="onBeforeControlsLoad" type="array"> <option type="function" value="js!SBIS3.EDO.ScopeFilters:onInitFilterArea"></option> <option type="function" value="js!SBIS3.EDO.FilterHandlers:showHideStatFilters"></option> </options> </options> </component> </div>');return(p=t(p))+(i&&-1!==p.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.FilterStatIncoming"}},o});
define('js!SBIS3.EDO.FilterStatIncoming',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.FilterStatIncoming','js!SBIS3.EDO.EDOFilter','js!SBIS3.EDO.ScopeFilters','Elektronnyj_dokumentooborot_localization'],function(t,n){var i=t.extend({_dotTplFn:n,$protected:{_options:{autoHeight:true,autoWidth:true}},$constructor:function(){},init:function(){i.superclass.init.call(this);}});return i;});
define("html!SBIS3.EDO.FilterStatIncomingCorr",function(){var o=function(o){var t=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;o.test(t);)t=t.replace(o,"&#123;&#123;$1&#125;&#125;");return t}}(),n=function(o){return o.join?o.join(""):o.toString()},e=function(o){return void 0===o?"":o&&"object"==typeof o?n(o):""+o},i="undefined"!=typeof process,p=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div> <component data-component="SBIS3.EDO.EDOFilter" name="ФильтрЭДОСтатистика"> <options name="rightsLim"> <option name="show">true</option> <option name="textRender" type="function">js!SBIS3.EDO.ScopeFilters:setScopeTextForFilter</option> </options> <option name="filterDataPeriodLimited">true</option> <options name="filtersEDO"> <options name="FilterDeleted"> <option name="show">true</option> </options> <options name="FilterState"> <option name="show">true</option> <options name="filterStateData" type="array"> <options> <option name="key" type="string">10</option> <option name="value">'+t(e(rk("Внутренняя обработка")))+'</option> </options> <options> <option name="key" type="string">7</option> <option name="value">'+t(e(rk("Завершенные")))+'</option> <option name="valueOnSelect">'+t(e(rk("Завершенные")))+'</option> <options name="excludedFilters" type="array"> <option>ФильтрСрокДата</option> <option>ФильтрПросроченные</option> </options> </options> <options> <option name="key" type="string">9</option> <option name="value">'+t(e(rk("Отклоненные")))+'</option> <option name="valueOnSelect">'+t(e(rk("Отклоненные")))+'</option> <options name="excludedFilters" type="array"> <option>ФильтрСрокДата</option> <option>ФильтрПросроченные</option> </options> </options> <options> <option name="key" type="string">22</option> <option name="value">'+t(e(rk("Аннулированные")))+'</option> </options> <options> <option name="key" type="string">19,20</option> <option name="value">'+t(e(rk("Удалено мной/контрагентом")))+'</option> </options> <options> <option name="key" type="string">0,1</option> <option name="value">'+t(e(rk("Черновики")))+'</option> </options> </options> </options> <options name="FilterFace1"> <option name="show">true</option> <option name="kitTitle">'+t(e(rk("Отправителю")))+'</option> <option name="title">'+t(e(rk("Отправитель")))+'</option> </options> <options name="FilterUnfixed"> <option name="show">true</option> </options> <options name="FilterResponsibleFace"> <option name="show">true</option> </options> <options name="FilterAuthorOrResponsibleMe"> <option name="show">true</option> <options name="kitTitleArr" type="array"> <option>'+t(e(rk("Мои")))+"</option> <option>"+t(e(rk("Моего отдела")))+'</option> </options> </options> <options name="FilterOurOrganisation"> <option name="show">true</option> </options> <options name="FilterUnanswered"> <option name="show">false</option> </options> <options name="FilterRegulations"> <option name="show">false</option> </options> </options> <options name="handlers"> <options name="onBeforeControlsLoad" type="array"> <option type="function" value="js!SBIS3.EDO.ScopeFilters:onInitFilterArea"></option> <option type="function" value="js!SBIS3.EDO.FilterHandlers:showHideStatFilters"></option> </options> </options> </component> </div>');return(p=t(p))+(i&&-1!==p.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.FilterStatIncomingCorr"}},o});
define('js!SBIS3.EDO.FilterStatIncomingCorr',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.FilterStatIncomingCorr','js!SBIS3.EDO.EDOFilter','js!SBIS3.EDO.ScopeFilters','Elektronnyj_dokumentooborot_localization'],function(t,n){var o=t.extend({_dotTplFn:n,$protected:{_options:{autoHeight:true,autoWidth:true}},$constructor:function(){},init:function(){o.superclass.init.call(this);}});return o;});
define("html!SBIS3.EDO.FilterStatInternal",function(){var o=function(o){var e=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(e){for(;o.test(e);)e=e.replace(o,"&#123;&#123;$1&#125;&#125;");return e}}(),t="undefined"!=typeof process,n=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div> <component data-component="SBIS3.EDO.EDOFilter" name="ФильтрЭДОСтатистика"> <options name="rightsLim"> <option name="show">true</option> <option name="textRender" type="function">js!SBIS3.EDO.ScopeFilters:setScopeTextForFilter</option> </options> <option name="filterDataPeriodLimited">false</option> <options name="filtersEDO"> <options name="FilterAuthor"> <option name="show">true</option> </options> </options> <options name="handlers"> <options name="onBeforeControlsLoad" type="array"> <option type="function" value="js!SBIS3.EDO.ScopeFilters:onInitFilterArea"></option> </options> </options> </component> </div>');return(n=e(n))+(t&&-1!==n.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.FilterStatInternal"}},o});
define('js!SBIS3.EDO.FilterStatInternal',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.FilterStatInternal','js!SBIS3.EDO.EDOFilter','js!SBIS3.EDO.ScopeFilters','Elektronnyj_dokumentooborot_localization'],function(t,n){var e=t.extend({_dotTplFn:n,$protected:{_options:{autoHeight:true,autoWidth:true}},$constructor:function(){},init:function(){e.superclass.init.call(this);}});return e;});
define("html!SBIS3.EDO.FilterStatOutgoing",function(){var o=function(o){var t=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;o.test(t);)t=t.replace(o,"&#123;&#123;$1&#125;&#125;");return t}}(),n=function(o){return o.join?o.join(""):o.toString()},i=function(o){return void 0===o?"":o&&"object"==typeof o?n(o):""+o},e="undefined"!=typeof process,p=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div> <component data-component="SBIS3.EDO.EDOFilter" name="ФильтрЭДОСтатистика"> <options name="rightsLim"> <option name="show">true</option> <option name="textRender" type="function">js!SBIS3.EDO.ScopeFilters:setScopeTextForFilter</option> </options> <option name="filterDataPeriodLimited">true</option> <options name="filtersEDO"> <options name="FilterDeleted"> <option name="show">true</option> </options> <options name="FilterState"> <option name="show">true</option> <options name="filterStateData" type="array"> <options> <option name="key" type="string">10</option> <option name="value">'+t(i(rk("Внутренняя обработка")))+'</option> </options> <options> <option name="key" type="string">2,3</option> <option name="value">'+t(i(rk("Недоставленные")))+'</option> </options> <options> <option name="key" type="string">4</option> <option name="value">'+t(i(rk("Не получен ответ")))+'</option> </options> <options> <option name="key" type="string">7</option> <option name="value">'+t(i(rk("Утвержденные")))+'</option> <option name="valueOnSelect">'+t(i(rk("Утвержденные")))+'</option> <options name="excludedFilters" type="array"> <option>ФильтрСрокДата</option> <option>ФильтрПросроченные</option> </options> </options> <options> <option name="key" type="string">9</option> <option name="value">'+t(i(rk("Отклоненные")))+'</option> <option name="valueOnSelect">'+t(i(rk("Отклоненные")))+'</option> <options name="excludedFilters" type="array"> <option>ФильтрСрокДата</option> <option>ФильтрПросроченные</option> </options> </options> <options> <option name="key" type="string">6</option> <option name="value">'+t(i(rk("С ошибками")))+'</option> </options> <options> <option name="key" type="string">22</option> <option name="value">'+t(i(rk("Аннулированные")))+'</option> </options> <options> <option name="key" type="string">19,20</option> <option name="value">'+t(i(rk("Удалено мной/контрагентом")))+'</option> </options> <options> <option name="key" type="string">0,1</option> <option name="value">'+t(i(rk("Черновики")))+'</option> </options> </options> </options> <options name="FilterFace1"> <option name="show">true</option> <option name="kitTitle">'+t(i(rk("Покупателю")))+'</option> <option name="title">'+t(i(rk("Покупатель")))+'</option> </options> <options name="FilterUnfixed"> <option name="show">true</option> </options> <options name="FilterResponsibleFace"> <option name="show">true</option> </options> <options name="FilterAuthorOrResponsibleMe"> <option name="show">true</option> <options name="kitTitleArr" type="array"> <option>'+t(i(rk("От меня")))+"</option> <option>"+t(i(rk("От моего отдела")))+'</option> </options> </options> <options name="FilterOurOrganisation"> <option name="show">true</option> </options> <options name="FilterRegulations"> <option name="show">false</option> </options> </options> <options name="handlers"> <options name="onBeforeControlsLoad" type="array"> <option type="function" value="js!SBIS3.EDO.ScopeFilters:onInitFilterArea"></option> <option type="function" value="js!SBIS3.EDO.FilterHandlers:showHideStatFilters"></option> </options> </options> </component> </div>');return(p=t(p))+(e&&-1!==p.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.FilterStatOutgoing"}},o});
define('js!SBIS3.EDO.FilterStatOutgoing',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.FilterStatOutgoing','js!SBIS3.EDO.EDOFilter','js!SBIS3.EDO.ScopeFilters','Elektronnyj_dokumentooborot_localization'],function(t,i){var n=t.extend({_dotTplFn:i,$protected:{_options:{autoHeight:true,autoWidth:true}},$constructor:function(){},init:function(){n.superclass.init.call(this);}});return n;});
define("html!SBIS3.EDO.FilterStatOutgoingCorr",function(){var o=function(o){var t=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;o.test(t);)t=t.replace(o,"&#123;&#123;$1&#125;&#125;");return t}}(),n=function(o){return o.join?o.join(""):o.toString()},i=function(o){return void 0===o?"":o&&"object"==typeof o?n(o):""+o},e="undefined"!=typeof process,p=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div> <component data-component="SBIS3.EDO.EDOFilter" name="ФильтрЭДОСтатистика"> <options name="rightsLim"> <option name="show">true</option> <option name="textRender" type="function">js!SBIS3.EDO.ScopeFilters:setScopeTextForFilter</option> </options> <option name="filterDataPeriodLimited">true</option> <options name="filtersEDO"> <options name="FilterDeleted"> <option name="show">true</option> </options> <options name="FilterState"> <option name="show">true</option> <options name="filterStateData" type="array"> <options> <option name="key" type="string">10</option> <option name="value">'+t(i(rk("Внутренняя обработка")))+'</option> </options> <options> <option name="key" type="string">2,3</option> <option name="value">'+t(i(rk("Недоставленные")))+'</option> </options> <options> <option name="key" type="string">4</option> <option name="value">'+t(i(rk("Не получен ответ")))+'</option> </options> <options> <option name="key" type="string">7</option> <option name="value">'+t(i(rk("Завершенные")))+'</option> <option name="valueOnSelect">'+t(i(rk("Завершенные")))+'</option> <options name="excludedFilters" type="array"> <option>ФильтрСрокДата</option> <option>ФильтрПросроченные</option> </options> </options> <options> <option name="key" type="string">9</option> <option name="value">'+t(i(rk("Отклоненные")))+'</option> <option name="valueOnSelect">'+t(i(rk("Отклоненные")))+'</option> <options name="excludedFilters" type="array"> <option>ФильтрСрокДата</option> <option>ФильтрПросроченные</option> </options> </options> <options> <option name="key" type="string">6</option> <option name="value">'+t(i(rk("С ошибками")))+'</option> </options> <options> <option name="key" type="string">22</option> <option name="value">'+t(i(rk("Аннулированные")))+'</option> </options> <options> <option name="key" type="string">19,20</option> <option name="value">'+t(i(rk("Удалено мной/контрагентом")))+'</option> </options> <options> <option name="key" type="string">0,1</option> <option name="value">'+t(i(rk("Черновики")))+'</option> </options> </options> </options> <options name="FilterFace1"> <option name="show">true</option> <option name="kitTitle">'+t(i(rk("Покупателю")))+'</option> <option name="title">'+t(i(rk("Покупатель")))+'</option> </options> <options name="FilterUnfixed"> <option name="show">true</option> </options> <options name="FilterResponsibleFace"> <option name="show">true</option> </options> <options name="FilterAuthorOrResponsibleMe"> <option name="show">true</option> <options name="kitTitleArr" type="array"> <option>'+t(i(rk("От меня")))+"</option> <option>"+t(i(rk("От моего отдела")))+'</option> </options> </options> <options name="FilterOurOrganisation"> <option name="show">true</option> </options> <options name="FilterUnanswered"> <option name="show">false</option> <option name="kitTitle">'+t(i(rk("Не получен ответ")))+'</option> <option name="title">'+t(i(rk("Не получен ответ")))+'</option> </options> <options name="FilterRegulations"> <option name="show">false</option> </options> </options> <options name="handlers"> <options name="onBeforeControlsLoad" type="array"> <option type="function" value="js!SBIS3.EDO.ScopeFilters:onInitFilterArea"></option> <option type="function" value="js!SBIS3.EDO.FilterHandlers:showHideStatFilters"></option> </options> </options> </component> </div>');return(p=t(p))+(e&&-1!==p.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.FilterStatOutgoingCorr"}},o});
define('js!SBIS3.EDO.FilterStatOutgoingCorr',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.FilterStatOutgoingCorr','js!SBIS3.EDO.EDOFilter','js!SBIS3.EDO.ScopeFilters','Elektronnyj_dokumentooborot_localization'],function(t,o){var i=t.extend({_dotTplFn:o,$protected:{_options:{autoHeight:true,autoWidth:true}},$constructor:function(){},init:function(){i.superclass.init.call(this);}});return i;});
define("html!SBIS3.EDO.TemplateMainStatFilter",function(){var e=function(e){var n=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;e.test(n);)n=n.replace(e,"&#123;&#123;$1&#125;&#125;");return n}}(),t="undefined"!=typeof process,o=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div data-lmtype="Dialog"> <component data-component="SBIS3.EDO.FilterController" name="ПанельСФильтромСтат"> <option name="filterLine" type="function" value="js!SBIS3.EDO.FastFilters:filterViewLineRender"></option> <options name="filters"> <options name="ФильтрВладелец"> <option name="defaultValue">Все</option> <options name="value"> <option name="fieldName" value="ФильтрВладелец"></option> </options> </options> </options> <option name="mode" value="hover"></option> <options name="filterButtonHandlers"> <options name="onChange" type="array"> <option type="function" value="js!SBIS3.EDO.Filters:onFilterReestrChange"></option> </options> <option name="onBeforeShow" type="function" value="js!SBIS3.EDO.FilterHandlers:onBeforeShowPhaseFilter"></option> <options name="onSetQuery" type="array"> <option type="function" value="js!SBIS3.EDO.Filters:saveFilterIntoContext"></option> <option type="function" value="js!SBIS3.EDO.InnerStat:changeDefaultFilterPeriodStat"></option> </options> </options> <options name="pathFilterHandlers"> <option name="onVisualizeFilter" type="function" value="js!SBIS3.EDO.FastFilters:onVisualizeFilter"></option> <option name="onCreatePoint" type="function" value="js!SBIS3.EDO.FastFilters:onCreateOwnerPoint"></option> <option name="onFilterChange" type="function" value="js!SBIS3.EDO.FastFilters:onChangeFastFilterInner"></option> </options> </component> </div>');return(o=n(o))+(t&&-1!==o.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.TemplateMainStatFilter"}},e});
define('js!SBIS3.EDO.FilterController',['Deprecated/Controls/FilterController/FilterController','Deprecated/Controls/FilterButton/plugins/RequestHistory-plugin','Elektronnyj_dokumentooborot_localization'],function(t){'use strict';var e=t.extend({$protected:{_options:{}},$constructor:function(){},init:function(){e.superclass.init.call(this);}});return e;});
define('js!SBIS3.EDO.TemplateMainStatFilter',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.TemplateMainStatFilter','js!SBIS3.EDO.FilterController','js!SBIS3.EDO.FilterHandlers','js!SBIS3.EDO.FastFilters','js!SBIS3.EDO.InnerStat','js!SBIS3.EDO.FilterHandlers','Elektronnyj_dokumentooborot_localization'],function(t,e){var n=t.extend({_dotTplFn:e,$protected:{_options:{}},$constructor:function(){},init:function(){n.superclass.init.call(this);}});return n.title='',n.dimensions={autoWidth:true,autoHeight:true,resizable:false},n;});
define("html!SBIS3.EDO.TemplateStatFilter",function(){var e=function(e){var o=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(o){for(;e.test(o);)o=o.replace(e,"&#123;&#123;$1&#125;&#125;");return o}}(),t="undefined"!=typeof process,n=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div data-lmtype="Dialog"> <component data-component="SBIS3.EDO.FilterController" name="ПанельСФильтромСтат"> <option name="filterLine" type="function" value="js!SBIS3.EDO.FastFilters:filterViewLineRender"></option> <options name="filters"> <options name="ФильтрВладелец"> <option name="defaultValue">Все</option> <options name="value"> <option name="fieldName" value="ФильтрВладелец"></option> </options> </options> <options name="ФильтрСостояние"> <option name="defaultValue">-1</option> <options name="value"> <option name="fieldName" value="ФильтрСостояние"></option> </options> </options> </options> <option name="mode" value="hover"></option> <option name="template" value=""></option> <options name="filterButtonHandlers"> <option name="onChange" type="function" value="js!SBIS3.EDO.Filters:onFilterChange"></option> <option name="onRestoreFilter" type="function" value="js!SBIS3.EDO.Filters:onRestoreFilter"></option> <option name="onBeforeShow" type="function" value="js!SBIS3.EDO.Filters:onFilterPanelBeforeShow"></option> <option name="onResetFilter" type="function" value="js!SBIS3.EDO.Filters:onResetFiltersWithFast"></option> <options name="onSetQuery" type="array"> <option type="function" value="js!SBIS3.EDO.Filters:saveFilterIntoContext"></option> <option type="function" value="js!SBIS3.EDO.Filters:onSetQueryBrowser"></option> <option type="function" value="js!SBIS3.EDO.InnerStat:changeDefaultFilterPeriodStat"></option> </options> </options> <options name="pathFilterHandlers"> <option name="onVisualizeFilter" type="function" value="js!SBIS3.EDO.FastFilters:onVisualizeFilter"></option> <option name="onCreatePoint" type="function" value="js!SBIS3.EDO.FastFilters:onCreateOwnerPoint"></option> <option name="onFilterChange" type="function" value="js!SBIS3.EDO.FastFilters:onChangeFastFilterInner"></option> </options> </component> </div>');return(n=o(n))+(t&&-1!==n.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.TemplateStatFilter"}},e});
define('js!SBIS3.EDO.TemplateStatFilter',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.TemplateStatFilter','js!SBIS3.EDO.FilterController','js!SBIS3.EDO.FilterHandlers','js!SBIS3.EDO.FastFilters','js!SBIS3.EDO.InnerStat','js!SBIS3.EDO.FilterHandlers','js!SBIS3.EDO.Filters','Elektronnyj_dokumentooborot_localization'],function(t,e){var i=t.extend({_dotTplFn:e,$protected:{_options:{}},$constructor:function(){},init:function(){i.superclass.init.call(this);}});return i.title='',i.dimensions={autoWidth:true,autoHeight:true,resizable:false},i;});
define("html!SBIS3.EDO.MainExternalStatistics",function(){var o=function(o){var t=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;o.test(t);)t=t.replace(o,"&#123;&#123;$1&#125;&#125;");return t}}(),n=function(o){return o.join?o.join(""):o.toString()},e=function(o){return void 0===o?"":o&&"object"==typeof o?n(o):""+o},i="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,"<div> "+t(e(o.beforeTemplatedArea))+' <component data-component="Deprecated/Controls/TemplatedArea/TemplatedArea" style="width:100px;height:100px;" name="Область по шаблону 1"> <option name="template">js!SBIS3.EDO.TemplateMainStatFilter</option> </component> '+t(e(o.afterTemplatedArea))+' <component data-component="Deprecated/Controls/TableView/TableView" name="'+t(e(o.browserName))+'" style="width:480px;" class="external_stat_browser"> <option name="autoHeight">true</option> <option name="autoWidht">true</option> <options name="display"> <options name="columns" type="array"> <options> <option name="field">Состояние</option> <option name="title" value="'+t(e(rk("Текущее состояние")))+'"></option> <option name="width">250</option> <option name="textAlign">left</option> <option name="textHeadAlign">Top</option> <option name="verticalAlign">bottom</option> <option name="textVerticalAlign">center</option> <option name="titleAlign">left</option> <option name="titleVerticalAlign">center</option> <option name="className">column_underline</option> <option name="render" type="function">js!SBIS3.EDO.MainExternalStatistics:prototype.renderTitleColumn'+t(e(o.statType))+'</option> <option name="captionRender" type="function">js!SBIS3.EDO.MainExternalStatistics:prototype.captionRender</option> </options> <options> <option name="field">Документы</option> <option name="title">'+t(e(rk("Документы")))+'</option> <option name="width">70</option> <option name="textAlign">right</option> <option name="textHeadAlign">Top</option> <option name="verticalAlign">bottom</option> <option name="textVerticalAlign">center</option> <option name="titleAlign">right</option> <option name="titleVerticalAlign">center</option> <option name="className">column_underline</option> <option name="render" type="function">js!SBIS3.EDO.MainExternalStatistics:prototype.renderNumColumn'+t(e(o.statType))+'</option> <option name="captionRender" type="function">js!SBIS3.EDO.MainExternalStatistics:prototype.captionRender</option> </options> <options> <option name="field">Проценты</option> <option name="title">%</option> <option name="width">70</option> <option name="textAlign">right</option> <option name="textHeadAlign">Top</option> <option name="verticalAlign">bottom</option> <option name="textVerticalAlign">center</option> <option name="titleAlign">right</option> <option name="titleVerticalAlign">center</option> <option name="className">column_underline</option> <option name="render" type="function">js!SBIS3.EDO.MainExternalStatistics:prototype.renderPercColumn</option> <option name="captionRender" type="function">js!SBIS3.EDO.MainExternalStatistics:prototype.captionRender</option> </options> <options> <option name="field">Контрагенты</option> <option name="title" value="'+t(e(rk("Контрагенты")))+'"></option> <option name="width">70</option> <option name="textAlign">right</option> <option name="textHeadAlign">Top</option> <option name="verticalAlign">bottom</option> <option name="textVerticalAlign">center</option> <option name="titleAlign">right</option> <option name="titleVerticalAlign">center</option> <option name="render" type="function">js!SBIS3.EDO.MainExternalStatistics:prototype.renderNumColumn'+t(e(o.statType))+'</option> <option name="captionRender" type="function">js!SBIS3.EDO.MainExternalStatistics:prototype.captionRender</option> </options> </options> <option name="hasZebra">false</option> <option name="showPaging">false</option> <option name="usePageSizeSelect">false</option> <option name="showRecordsCount">false</option> <option name="emptyHtml">'+t(e(rk("Нет данных")))+'</option> </options> <options name="filterParams"> <options name="ТипДокумента"> <option name="saveToState">false</option> <option name="fieldName">ТипДокумента</option> </options> <options name="ФильтрАвторИлиОтвОтдел"> <option name="saveToState">false</option> <option name="fieldName">ФильтрАвторИлиОтвОтдел</option> </options> <options name="ФильтрАвторИлиОтветственный"> <option name="saveToState">false</option> <option name="fieldName">ФильтрАвторИлиОтветственный</option> </options> <options name="ФильтрВладелец"> <option name="saveToState">false</option> <option name="fieldName">ФильтрВладелец</option> </options> <options name="ФильтрДатаП"> <option name="saveToState">false</option> <option name="fieldName">ФильтрДатаП</option> </options> <options name="ФильтрДатаПериод"> <option name="saveToState">false</option> <option name="fieldName">ФильтрДатаПериод</option> </options> <options name="ФильтрДатаС"> <option name="saveToState">false</option> <option name="fieldName">ФильтрДатаС</option> </options> <options name="ФильтрДокументНашаОрганизация"> <option name="saveToState">false</option> <option name="fieldName">ФильтрДокументНашаОрганизация</option> </options> <options name="ФильтрЛицо1"> <option name="saveToState">false</option> <option name="fieldName">ФильтрЛицо1</option> </options> <options name="ФильтрНезакрепленные"> <option name="saveToState">false</option> <option name="fieldName">ФильтрНезакрепленные</option> </options> <options name="ФильтрОтветственноеЛицо"> <option name="saveToState">false</option> <option name="fieldName">ФильтрОтветственноеЛицо</option> </options> <options name="ФильтрСобытий"> <option name="saveToState">false</option> <option name="fieldName">ФильтрСобытий</option> </options> <options name="ФильтрУдаленные"> <option name="saveToState">false</option> <option name="fieldName">ФильтрУдаленные</option> </options> '+t(e(o.additionalFilterParams))+' </options> <options name="handlers"> <option name="onInit" type="function">js!SBIS3.EDO.StatisticsEDOHandlers:setStatFilterBrowser</option> <option name="onAfterRender" type="function">js!SBIS3.EDO.StatisticsEDOHandlers:renderCommonUnderline</option> <option name="onPrepareReportData" type="function">js!SBIS3.EDO.StatisticsEDOHandlers:printRazvReport</option> <option name="onRowClick" type="function">js!SBIS3.EDO.MainExternalStatistics:prototype.onRowClick</option> '+t(e(o.additionalRenders))+' </options> <options name="reports"> <option name="Статистика" value="Elektronnyj_dokumentooborot/Statistika/Pechatnye_formy/'+t(e(o.statType))+'Main.xsl"></option> </options> <options name="dataSource"> <options name="readerParams"> <option name="nameApplication">Основной сервис</option> <option name="nameService">Основной сервис</option> <option name="queryName" value="'+t(e(o.methodName))+'"></option> <option name="createMethodName" value="'+t(e(o.createMethodName))+'"></option> <option name="updateMethodName" value="'+t(e(o.updateMethodName))+'"></option> <option name="readMethodName" value="'+t(e(o.readMethodName))+'"></option> <option name="destroyMethodName" value="'+t(e(o.destroyMethodName))+'"></option> <option name="linkedObject">'+t(e(o.objectName))+'</option> </options> </options> <option name="useSelection">false</option> </component> </div>');return(a=t(a))+(i&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.MainExternalStatistics"}},o});
define('js!SBIS3.EDO.StatisticsEDOHandlers',['Lib/Control/Control','Core/core-instance','Transport/BLObject','Transport/Record','Transport/RecordSetStatic','Core/defaultRenders','js!SBIS3.EDO.StatFuncs','js!SBIS3.EDO.doc_filters','Elektronnyj_dokumentooborot_localization'],function(e,t,a,r,n,s,o,l){return StatisticsEDOHandlers={renderCommonUnderline:function(){var e=jQuery('.common_underline');e.mouseenter(function(){jQuery(this).parents('tr.sel_row').addClass('tr_common_underline');}),e.mouseleave(function(){jQuery('.tr_common_underline').removeClass('tr_common_underline');});var t=this.getContainer().find('td.column_underline');t.mouseenter(function(){if($(this).find('span.stat_docs').length>0)$(this).closest('tr').find('.column_underline span').addClass('common_underline');}),t.mouseleave(function(){if($(this).find('span.stat_docs').length>0)$(this).closest('tr').find('.column_underline span').removeClass('common_underline');}),this.getContainer().find('span.deliv_docs').closest('tr').attr('style','cursor:default !important'),this.getContainer().find('span.send_docs').closest('tr').attr('style','cursor:default !important');},setStatFilterBrowser:function(){var r=e.ControlStorage.getByName('ШаблонСтатистики').getLinkedContext();if(r&&!r.getValue('ТипДокумента')){var n=null,s=l.getCurrentBrowser()?l.getCurrentBrowser():this.getTopParent().hasChildControlByName('browserView')?this.getTopParent().getChildControlByName('browserView'):null,u=s&&s.getQuery?s.getQuery():s&&s.getFilter?s.getFilter:{},i=u['ТипДокумента']?u['ТипДокумента']:n.hasColumn('@ТипДокумента')?n.get('ТипДокумента'):-2;r.setValue('ТипДокумента',i);}var d=this;if('СтатистикаСкладИсхПоКонтрагентам'===d.getName()||'СтатистикаСкладВхПоКонтрагентам'===d.getName())a('ПараметрыДокументооборота').call('ВедетсяУчет',{},a.RETURN_TYPE_ASIS).addCallback(function(e){var t=null;if(t&&t.hasColumn('ШаблонСтатистики')){if('СтатистикаИсходящих'===t.get('ШаблонСтатистики')||'СтатистикаВходящих'===t.get('ШаблонСтатистики'))d.toggleColumn('СуммаНДС',false),d.toggleColumn('Сумма',false);}else d.toggleColumn('СуммаНДС',e),d.toggleColumn('Сумма',e);});e.ControlStorage.waitChildByName('ПанельСФильтромСтат').addCallback(function(e){if(t.instanceOfModule(e,'SBIS3.EDO.FilterController')&&!e.getFilterButton().getTemplateName())o.setStatFilter(e,r);return e.setLinkedView(d),e;});},onKontrRowClick:function(e,t,a,r,n){if(null===a.get('@Лицо'))return;var s=parseInt(a.get('@Лицо'),10),l=a.get('Контрагент'),u=o.getBrowserFromNewRegistry.call(this);if(!u)o.removeStatPrintButton();if(s)o.goToReestrFilter('ФильтрЛицо1',s,u,l);},onOurOrgRowClick:function(e,t,a,r,n){if(a.hasColumn('@Лицо')){var s=parseInt(a.get('@Лицо'),10),l=o.getBrowserFromNewRegistry.call(this);if(isFinite(s)&&s>-1&&null!==s){var u=[s];o.goToReestrFilter('ФильтрДокументНашаОрганизация',u,l);}}},loadTotalSums:function(){var t=null,n=false,l=this;if(t.hasColumn('ТипРаздела'))n='Входящие'===t.get('ТипРаздела');if(t.hasColumn('ТипДокумента')&&('ФактураИсх'===t.get('ТипДокумента')||'ФактураВх'===t.get('ТипДокумента')))return;new a('ПараметрыДокументооборота').call('ВедетсяУчет',{},a.RETURN_TYPE_ASIS).addCallback(function(c){if(!c)return;var g=l.getQuery(),f;if(t.get('ТипДокумента'))f=t.get('ТипДокумента');var m=new r();m.addColumn('ТипДокумента',r.FIELD_TYPE_INTEGER),m.addColumn('ФильтрАвторИлиОтветственный',r.FIELD_TYPE_INTEGER),m.addColumn('ФильтрУдаленные',r.FIELD_TYPE_BOOLEAN),m.addColumn('ФильтрДатаП',r.FIELD_TYPE_DATE),m.addColumn('ФильтрДатаС',r.FIELD_TYPE_DATE),m.addColumn('ФильтрДатаПериод',r.FIELD_TYPE_STRING),m.addColumn('ФильтрЛицо1',r.FIELD_TYPE_INTEGER),m.addColumn('ФильтрОтветственноеЛицо',r.FIELD_TYPE_INTEGER),m.addColumn('ФильтрАвторИлиОтвОтдел',r.FIELD_TYPE_INTEGER),m.addColumn('ФильтрДокументНашаОрганизация',r.FIELD_TYPE_INTEGER),m.addColumn('ФильтрВладелец',r.FIELD_TYPE_STRING),m.set('ТипДокумента',g['ТипДокумента']),m.set('ФильтрВладелец',void 0===g['ФильтрВладелец']?'Все':g['ФильтрВладелец']),m.set('ФильтрАвторИлиОтвОтдел',void 0===g['ФильтрАвторИлиОтвОтдел']?-1:g['ФильтрАвторИлиОтвОтдел']),m.set('ФильтрАвторИлиОтветственный',void 0===g['ФильтрАвторИлиОтветственный']?-1:g['ФильтрАвторИлиОтветственный']),m.set('ФильтрУдаленные',void 0===g['ФильтрУдаленные']?false:g['ФильтрУдаленные']),m.set('ФильтрДатаП',void 0===g['ФильтрДатаП']?null:g['ФильтрДатаП']),m.set('ФильтрДатаС',void 0===g['ФильтрДатаС']?null:g['ФильтрДатаС']),m.set('ФильтрДатаПериод',!g['ФильтрДатаПериод']?'Месяц':g['ФильтрДатаПериод']),m.set('ФильтрЛицо1',void 0===g['ФильтрЛицо1']?-1:g['ФильтрЛицо1']),m.set('ФильтрОтветственноеЛицо',void 0===g['ФильтрОтветственноеЛицо']?-1:g['ФильтрОтветственноеЛицо']),m.set('ФильтрДокументНашаОрганизация',void 0===g['ФильтрДокументНашаОрганизация']?null:g['ФильтрДокументНашаОрганизация']),new a(n?'СтатистикаСкладВх':'СтатистикаСкладИсх').call('СтатистикаСуммы',{'Фильтр':m},a.RETURN_TYPE_RECORD).addCallback(function(t){var a=null===t||void 0===t;if(null!==l&&void 0!==l.getTopParent)l.getTopParent().waitChildControlByName('СеткаШапкаСтатистикиСкладских').addCallback(function(e){var t=e.getChildControlByName('СтатистикаСкладскихHTML');if(a)t.hide(),e.getContainer().css({height:'32px'}),t.getContainer().css({height:'32px'});else t.show(),e.getContainer().css({height:'129px'}),t.getContainer().css({height:'129px'});return e;});if(a)return;var r=t.hasColumn('ИтогСумма')&&t.get('ИтогСумма')?t.get('ИтогСумма'):0,n=t.hasColumn('ИтогКоличество')&&t.get('ИтогКоличество')?t.get('ИтогКоличество'):0,c=t.hasColumn('КоличествоКонтрагентов')&&t.get('КоличествоКонтрагентов')?t.get('КоличествоКонтрагентов'):0,g=t.hasColumn('КоличествоСотрудников')&&t.get('КоличествоСотрудников')?t.get('КоличествоСотрудников'):0,m=u(f,n),C=i(f),T=d(f,c),E=d(f,c,true),S=o.declOfNum(g,[' сотрудник оформлял документы',' сотрудника оформляли документы',' сотрудников оформляли документы']);if(jQuery('#statOtgruzkaCustomersDocs').unbind('click'),jQuery('#statOtgruzkaCustomersDocs').click(function(){if(c>0)o.updateStatTemplate('СтатистикаСкладскиеПоКонтрагентам',true,false);return false;}),jQuery('#statOtgruzkaGoods').unbind('click'),jQuery('#statOtgruzkaGoods').click(function(){if(n>0)o.updateStatTemplate('СтатистикаСкладскиеПоТоварам',true,false);return false;}),jQuery('#totalStatlink').unbind('click'),jQuery('#totalStatlink').click(function(){if(c>0)o.updateStatTemplate('СтатистикаПоВсемНашимОрганизациям',true,false);return false;}),jQuery('#statTotalStaffDocs').unbind('click'),jQuery('#statTotalStaffDocs').click(function(){if(g>0)o.updateStatTemplate('СтатистикаПоСотрудникам',true,false);return false;}),jQuery('#TotalStatCaption').attr('hidden',false),!c)jQuery('#totalStatlink').removeClass('asLink'),jQuery('#totalStatlink').addClass('empty_stat');else jQuery('#totalStatlink').removeClass('empty_stat'),jQuery('#totalStatlink').addClass('asLink');if(jQuery('#TotalColBefore').text(C),jQuery('#TotalCol').text(n),jQuery('#TitleNomCol').text(m),jQuery('#TotalSum').text('на сумму '+s.money(r)+' руб.'),jQuery('#TotalNomDescription').attr('hidden',false),!n)jQuery('#statOtgruzkaGoods').removeClass('asLink'),jQuery('#statOtgruzkaGoods').addClass('empty_stat');else jQuery('#statOtgruzkaGoods').removeClass('empty_stat'),jQuery('#statOtgruzkaGoods').addClass('asLink');if(jQuery('#TotalContr').text(c),jQuery('#SpecInfo').text(T),jQuery('#ContrInfo').text(E),jQuery('#TotalSumDescription').attr('hidden',false),!c)jQuery('#statOtgruzkaCustomersDocs').removeClass('asLink'),jQuery('#statOtgruzkaCustomersDocs').addClass('empty_stat');else jQuery('#statOtgruzkaCustomersDocs').removeClass('empty_stat'),jQuery('#statOtgruzkaCustomersDocs').addClass('asLink');if('СчетИсх'==f||'НакладнаяИсх'==f||'ФактураИсх'==f||'ДокОтгрИсх'==f||'АктВрИсх'==f)if(e.ControlStorage.waitChildByName('СтатистикаСкладскихHTML').addCallback(function(t){return t.show(),t.getContainer().css({height:'180px'}),e.ControlStorage.getByName('СеткаШапкаСтатистикиСкладских').getContainer().css({height:'180px'}),t;}),jQuery('#TotalStaff').text(g),jQuery('#StaffInfo').text(S),jQuery('#TotalStaffDescription').attr('hidden',false),!g)jQuery('#statTotalStaffDocs').removeClass('asLink'),jQuery('#statTotalStaffDocs').addClass('empty_stat');else jQuery('#statTotalStaffDocs').removeClass('empty_stat'),jQuery('#statTotalStaffDocs').addClass('asLink');});});},showTitleCutTotalDiv:function(e){jQuery.each(e.find('td.ws-browser-cell-cut'),function(e,t){var a=jQuery(t).find('div.ws-browser-div-cut').text();if(a&&''!==a)t.title=a;});},onBrowserFolderEnter:function(e,t){if(-1000===t||null===t)e.setResult(false);else{var a=this.getPathSelector();if(null!==a.getPath()[1].id)g(a,i(null));else a.getContainer().find('span').first().attr({title:'К выбору отчета'});}},printOrgReport:function(t,a,s){var o=this,l=new r(),u=o.getRecordSet().getResults(),i=null,d=C(o),c=f(),g=o.getRecordSet(),T=e.ControlStorage.getByName('ШаблонСтатистики').getLinkedContext().getValue('НазваниеОтчетаСтатистики')?e.ControlStorage.getByName('ШаблонСтатистики').getLinkedContext().getValue('НазваниеОтчетаСтатистики'):'Статистика';l.addColumn('Заголовок',r.FIELD_TYPE_STRING),l.addColumn('ИмяОтчета',r.FIELD_TYPE_STRING),l.addColumn('Итоги',r.FIELD_TYPE_RECORD),l.addColumn('Данные',r.FIELD_TYPE_QUERY),o.getRecordSet().getColumns()['Уровень']={index:18,title:'Уровень',type:'Число целое'};var E=new n({defaultColumns:o.getRecordSet().getColumns()});g.rewind();var S=g.next();while(S){var y=m(g,S.get('@Лицо'),0),_=S.cloneRecord();_.setRecordSet(null,true),_.addColumn('Уровень',r.FIELD_TYPE_INTEGER),_.set('Уровень',y),E.addRecords(_),S=g.next();}if(l.set('Данные',E),l.set('Заголовок',d),l.set('ИмяОтчета',T),l.set('Итоги',u),c&&''!==c)l.addColumn('ФильтрыОтчета',r.FIELD_TYPE_STRING),l.set('ФильтрыОтчета',c);t.setResult(l);},printReportWithSumms:function(t,a,s){var l=this,u=new r(),i=null,d=i?i.get('ТипДокумента'):null,g=i?C(l):'',m=f(),E=0===s.length?l.getRecordSet():s,S=e.ControlStorage.getByName('ШаблонСтатистики').getLinkedContext().getValue('НазваниеОтчетаСтатистики')?e.ControlStorage.getByName('ШаблонСтатистики').getLinkedContext().getValue('НазваниеОтчетаСтатистики'):'Статистика',y=e.ControlStorage.getByName('ШаблонСтатистики').getCurrentTemplateName();u.addColumn('Заголовок',r.FIELD_TYPE_STRING),u.addColumn('ИмяОтчета',r.FIELD_TYPE_STRING),u.addColumn('Итоги',r.FIELD_TYPE_RECORD),u.addColumn('Данные',r.FIELD_TYPE_QUERY);var _=new r();for(var h in E.getColumns())if(E.getColumns().hasOwnProperty(h))_.addColumn(E.getColumns()[h].title,E.getColumns()[h].type);for(var R=0;R<E.getRecords().length;R++){i=E.getRecords()[R];for(var v=0;v<i.getColumns().length;v++)if('number'===typeof i.get(i.getColumns()[v]))_.set(i.getColumns()[v],_.get(i.getColumns()[v])+i.get(i.getColumns()[v]));}if('СтатистикаСкладВхПоТоварам'===y||'СтатистикаСкладИсхПоТоварам'===y){var p=new n({defaultColumns:l.getRecordSet().getColumns()});E.rewind();var I=E.next();while(I){if(I.get('Раздел')===l.getQuery()['Раздел']||l.getQuery()['СтрокаПоиска'])p.addRecords(I);I=E.next();}u.set('Данные',p),u.set('Итоги',_);}else if('СтатистикаПоСотрудникамСчет'===y||'СтатистикаПоСотрудникамРеализация'===y){var N=new n({defaultColumns:l.getRecordSet().getColumns()}),D=l.getRecordSet().getResults().cloneRecord();E.rewind();var Q=E.next(),L=Q.cloneRecord();while(Q){if(L.get('Раздел')==l.getQuery()['Раздел']||l.getQuery()['СтрокаПоиска']){if(null!==L.get('КоличествоСотрудников'))L.set('Название',Q.get('Название')+'('+Q.get('КоличествоСотрудников')+')');N.addRecords(L);}if(Q=E.next(),Q)L=Q.cloneRecord();}D.set('КоличествоСотрудников',D.get('КоличествоСотрудников')+o.declOfNum(D.get('КоличествоСотрудников'),[' сотрудник',' сотрудника',' сотрудников'])),u.set('Данные',N),u.set('Итоги',D);}else u.set('Данные',E),u.set('Итоги',_);if('СтатистикаСкладВхПоТоварам'===y||'СтатистикаСкладИсхПоТоварам'===y||'СтатистикаВхПоВсемНашимОрганизациям'===y||'СтатистикаИсхПоВсемНашимОрганизациям'===y||'СтатистикаСотрудникамСчет'===y||'СтатистикаПоСотрудникамРеализация'===y||'СтатистикаСкладВхПоКонтрагентам'===y||'СтатистикаСкладИсхПоКонтрагентам'===y)S=c(d);if('СтатистикаВхПоВсемНашимОрганизациям'===y||'СтатистикаИсхПоВсемНашимОрганизациям'===y)u.addColumn('Контрагент',r.FIELD_TYPE_STRING),u.set('Контрагент',T());if(u.set('Заголовок',g),u.set('ИмяОтчета',S),m&&''!==m)u.addColumn('ФильтрыОтчета',r.FIELD_TYPE_STRING),u.set('ФильтрыОтчета',m);t.setResult(u);},printRazvReport:function(t,a,n){var s=new r(),o=C(this),l=f(),u=e.ControlStorage.getByName('ШаблонСтатистики').getLinkedContext().getValue('НазваниеОтчетаСтатистики')?e.ControlStorage.getByName('ШаблонСтатистики').getLinkedContext().getValue('НазваниеОтчетаСтатистики'):'';if(s.addColumn('Заголовок',r.FIELD_TYPE_STRING),s.addColumn('ИмяОтчета',r.FIELD_TYPE_STRING),s.addColumn('Данные',r.FIELD_TYPE_QUERY),s.set('Заголовок',o),s.set('ИмяОтчета',u),e.ControlStorage.containsByName('СтатистикаСкладскихHTML')&&e.ControlStorage.getByName('СтатистикаСкладскихHTML').isVisible())s.addColumn('СуммыПоНоменклатурам',r.FIELD_TYPE_STRING),s.addColumn('СуммыПоКонтрагентам',r.FIELD_TYPE_STRING),s.addColumn('СуммыПоСотрудникам',r.FIELD_TYPE_STRING),s.set('СуммыПоНоменклатурам',jQuery('#statOtgruzkaGoods').text()),s.set('СуммыПоКонтрагентам',jQuery('#statOtgruzkaCustomersDocs').text()),s.set('СуммыПоСотрудникам',jQuery('#statTotalStaffDocs').text());if(s.set('Данные',this.getRecordSet()),l&&''!==l)s.addColumn('ФильтрыОтчета',r.FIELD_TYPE_STRING),s.set('ФильтрыОтчета',l);t.setResult(s);},passDataToReport:function(e,t,a){var n=new r();n.addColumn('Данные',r.FIELD_TYPE_QUERY),n.set('Данные',this.getRecordSet()),e.setResult(n);}};function u(e,t){return'АктВрВх'===e||'АктВрИсх'===e?o.declOfNum(t,[' вид услуги ',' вида услуг ',' видов услуг ']):o.declOfNum(t,[' позиция ',' позиции ',' позиций ']);}function i(t,a){var r=e.ControlStorage.getByName('ШаблонСтатистики').getCurrentTemplateName();if('СтатистикаПоСотрудникамСчет'===r||'СтатистикаПоСотрудникамРеализация'===r)switch(t){case'СчетИсх':case'СчетВх':return a?'Счета оформляли':'';case'НакладнаяИсх':case'ФактураИсх':case'ДокОтгрИсх':return'Продажу оформляли'+(a?'':' ');case'НакладнаяВх':case'ФактураВх':case'ДокОтгрВх':return'Покупки оформляли'+(a?'':' ');case'АктВрИсх':case'АктВрВх':return a?'Услуги оформляли':'';case'ЗаказИсх':case'ЗаказВх':return'Услуги оформляли'+(a?'':' ');}else switch(t){case'СчетИсх':return a?'Отгружено':'';case'СчетВх':return a?'Получено':'';case'НакладнаяИсх':case'ФактураИсх':case'ДокОтгрИсх':return'Отгружено'+(a?'':' ');case'НакладнаяВх':case'ФактураВх':case'ДокОтгрВх':return'Получено'+(a?'':' ');case'АктВрИсх':case'АктВрВх':return a?'Оказано услуг':'Оказано ';case'ЗаказИсх':case'ЗаказВх':return'Заказано'+(a?'':' ');}return'';}function d(e,t,a){switch(e){case'НакладнаяИсх':case'ФактураИсх':case'СчетИсх':case'ДокОтгрИсх':case'АктВрИсх':case'ЗаказВх':return a?'покупателям':o.declOfNum(t,[' покупатель ',' покупателя',' покупателей']);case'НакладнаяВх':case'ФактураВх':case'СчетВх':case'ДокОтгрВх':case'АктВрВх':case'ЗаказИсх':return a?'поставщикам':o.declOfNum(t,[' поставщик ',' поставщика',' поставщиков']);}return'';}function c(t){var a=e.ControlStorage.getByName('ШаблонСтатистики').getCurrentTemplateName();if('СтатистикаВхПоВсемНашимОрганизациям'===a||'СтатистикаИсхПоВсемНашимОрганизациям'===a)switch(t){case'НакладнаяИсх':case'ФактураИсх':case'СчетИсх':case'ДокОтгрИсх':case'АктВрИсх':case'ЗаказВх':return'По нашим организациям продано';case'НакладнаяВх':case'ФактураВх':case'СчетВх':case'ДокОтгрВх':case'АктВрВх':case'ЗаказИсх':return'По нашим организациям закуплено';}else if('СтатистикаСкладВхПоТоварам'===a)if('ЗаказВх'===t)return'Продано';else return'Закуплено';else if('СтатистикаСкладИсхПоТоварам'===a)if('ЗаказИсх'===t)return'Закуплено';else return'Продано';else if('СтатистикаПоСотрудникамСчет'===a)return'Счета оформляли';else if('СтатистикаПоСотрудникамРеализация'===a)switch(t){case'НакладнаяИсх':case'ФактураИсх':case'СчетИсх':case'ДокОтгрИсх':case'АктВрИсх':case'ЗаказИсх':return'Продажу оформляли';case'НакладнаяВх':case'ФактураВх':case'СчетВх':case'ДокОтгрВх':case'АктВрВх':case'ЗаказВх':return'Закупку оформляли';}else if('СтатистикаСкладВхПоКонтрагентам'===a){if('ЗаказВх'===t)return'Покупатели';return'Поставщики';}else if('СтатистикаСкладИсхПоКонтрагентам'===a){if('ЗаказИсх'===t)return'Поставщики';return'Покупатели';}return'';}function g(e,t){var a=[{title:t,id:null}],r=e.getPath();if(r.length>1)a=a.concat(r);e.setRootNodeView('icon'),e.setPath(a),e.getPath()[0].id=-1000,e.getContainer().find('span').first().attr({title:'К выбору отчета'});}function f(){function t(t){var a=e.ControlStorage.getByName('ПанельСФильтромСтат').getFilterButton().getFloatArea();return a.hasChildControlByName(t)?a.getChildControlByName(t):void 0;}var a='',r=t('ФильтрДатаПериод'),n=t('ФильтрДатаС'),s=t('ФильтрДатаП'),o=t('ФильтрОтветственноеЛицо'),l=t('ФильтрДокументНашаОрганизация'),u=t('ФильтрСостояние');if(a+=r.getStringValue(),'За период'==r.getStringValue()){if(n&&null!==n.getValue())a+=' с '+n.getValue().strftime('%d %m %Y ');if(s&&null!==s.getValue())a+=' по '+s.getValue().strftime('%d %m %Y ');}if(o&&o.getValue()&&-2!==o.getValue()&&-1!==o.getValue())a+=', ответственный '+E(o.getStringValue());if(l&&l.getValue())a+=', по организации '+E(l.getStringValue());if(u&&'Все документы'!==u.getStringValue())a+=', по состоянию документов - '+u.getStringValue().toLowerCase();return a;}function m(e,t,a){var r=e.getRecordByPrimaryKey(t);return null===r.get('Раздел')?a:m(e,r.get('Раздел'),a+1);}function C(e){var t=null,a=e.getParentByClass('SBIS3.EDO.StatTemplate'),r='';if(t)switch(r=t.get('ТипРаздела')+(t.get('ТипРаздела')!==t.get('Название')?'/'+t.get('Название'):' документы'),t.get('Название')){case'Реализация':r='Исходящие / Реализация товаров и услуг';break;case'Поступление':r='Входящие / Поступление товаров и услуг';}else if(a)r=(-1!==a._options.template.indexOf('Outgoing')?'Исходящие':'Входящие')+' документы';return r;}function T(){var e=null;if(e.hasColumn('ИмяБраузера'))if('ЗаказВх'===e.get('ТипДокумента'))return'Покупатели';else if('ЗаказИсх'===e.get('ТипДокумента'))return'Поставщики';if(e.hasColumn('ТипРаздела'))if('Входящие'===e.get('ТипРаздела'))return'Поставщики';else if('Исходящие'===e.get('ТипРаздела'))return'Покупатели';return'Контрагенты';}function E(e){if(-1!==e.indexOf('span'))e=jQuery(e).text();return e;}});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.MainExternalStatistics", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".tarea100{height:100%}.external_stat_browser .all_docs{font-weight:700;padding-left:18px!important}.external_stat_browser .no_send_docs{font-weight:700;padding-left:18px!important}.external_stat_browser .stat_docs:hover{cursor:pointer!important;text-decoration:underline!important}.external_stat_browser .send_docs{font-weight:700;padding-left:18px!important}.external_stat_browser .rough_docs{color:grey!important;padding-left:18px!important}.external_stat_browser .ann_docs,.external_stat_browser .decl_docs,.external_stat_browser .kon_del_docs,.external_stat_browser .on_checking_docs,.external_stat_browser .recv_docs{color:grey!important;float:right!important;padding-left:18px!important}.external_stat_browser .error_docs{font-weight:700;color:red!important;padding-left:18px!important}.external_stat_browser .decl_docs_in,.external_stat_browser .deliv_docs,.external_stat_browser .no_deliv_docs,.external_stat_browser .proc_docs,.external_stat_browser .recv_docs_in{padding-left:18px!important}.external_stat_browser .common_underline{text-decoration:underline!important}.external_stat_browser .kon_del_docs_in{color:grey!important;padding-left:18px!important}.external-statistics-indent .ws-FilterButton__filterLine{margin-top:-2px;margin-right:-3px}.external-statistics-indent .ws-PathSelector{margin-top:6px!important}.external-statistics-indent .ws-field-dropdown-container .ws-field-dropdown .custom-select-text{line-height:22px}.external-statistics-indent .ws-field-dropdown-container.ws-field-dropdown-hover .ws-field-dropdown .custom-select-arrow{margin-top:1px}@media screen and (-ms-high-contrast:active),(-ms-high-contrast:none){.external-statistics-indent .ws-PathSelector{margin-top:5px!important}}.edo-external-stat-filter-header{border-bottom:none!important}.edo-external-stat-filter-content{padding-top:0!important}"));head.appendChild(style);});}
define('js!SBIS3.EDO.MainExternalStatistics',['Core/UserConfig','SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.MainExternalStatistics','js!SBIS3.EDO.StatFuncs','Deprecated/Controls/TableView/TableView','Deprecated/Controls/TemplatedArea/TemplatedArea','js!SBIS3.EDO.StatisticsEDOHandlers','js!SBIS3.EDO.TemplateMainStatFilter','Deprecated/Controls/TableView/plugins/Results-plugin','css!SBIS3.EDO.MainExternalStatistics','Deprecated/Controls/DataViewAbstract/plugins/Print-plugin','Elektronnyj_dokumentooborot_localization'],function(t,e,a,n){var s=e.extend({_dotTplFn:a,$protected:{_options:{autoHeight:true,autoWidth:true,browserName:'',methodName:'',objectName:'',statType:'',ourOrganizationReportName:''}},$constructor:function(){},init:function(){s.superclass.init.call(this);},renderTitleColumnOutgoing:function(e){var a=e.get('Состояние'),n=s.prototype._getStatClass(a),r=$('<div><span class="stat_docs"></span></div>'),o=null,i=this.getParentByClass('SBIS3.EDO.StatTemplate'),p=t.getParam('КоличествоНашихОрганизацийСФилиалами'),l=o&&o.get('ТипДокумента')||i&&i._options&&i._options.docType;switch(a){case'Всего':r.find('span').text(rk('Всего по нашим организациям'));var d=$('<hr style="display: block;margin-left: 18px;margin-top: 5px;background-color: #000000;border: none;height: 1px;margin-right:-5px">');r.append(d);break;case'НеОтправлено':r.find('span').text(rk('Обработка внутри компании'));break;case'Отправлено':r.find('span').text(rk('Отправлено')),r.find('span').removeClass('stat_docs');break;case'НеДоставлено':r.find('span').text(rk('Не доставлено')),r.attr('style','padding-left:50px !important;');break;case'Доставлено':r.find('span').text(rk('Доставлено, из них')),r.attr('style','padding-left:50px !important;'),r.find('span').removeClass('stat_docs');break;case'На проверке':r.find('span').text(rk('Не получен ответ'));break;case'Принято':r.find('span').text('КоррИсх'!==l?rk('Утверждено'):rk('Завершено'));break;case'Отклонено':r.find('span').text(rk('Отклонено'));break;case'УдаленоКонтрагентом':r.find('span').text(rk('Удалено мной/контрагентом'));break;case'Аннулировано':r.find('span').text(rk('Аннулировано'));break;case'СОшибками':r.find('span').text(rk('С ошибками'));break;case'Черновики':r.find('span').text(rk('Черновики'));}return r.find('span').addClass(n),r.find('span').attr('stat_id',n),r;},renderTitleColumnIncoming:function(t){var e=t.get('Состояние'),a=s.prototype._getStatClassIncoming(e),n=$('<div><span class="stat_docs"></span></div>'),r=null,o=this.getParentByClass('SBIS3.EDO.StatTemplate'),i=r&&r.get('ТипДокумента')||o&&o._options&&o._options.docType;switch(e){case'Всего':n.find('span').text(rk('Всего по нашим организациям'));var p=$('<hr style="display: block;margin-left: 18px;margin-top: 5px;background-color: #000000;border: none;height: 1px;margin-right:-5px">');n.append(p);break;case'ВОбработке':n.find('span').text(rk('В обработке'));break;case'Принято':n.find('span').text('КоррВх'!==i?rk('Утверждено'):rk('Завершено'));break;case'Отклонено':n.find('span').text(rk('Отклонено'));break;case'Черновики':n.find('span').text(rk('Черновики'));break;case'УдаленоКонтр':n.find('span').text(rk('Удалено мной/контрагентом'));}return n.find('span').addClass(a),n.find('span').attr('stat_id',a),n;},renderNumColumnOutgoing:function(t,e){var a=t.get('Состояние'),n=t.get(e),r=$('<div><span class="stat_docs"></span></div>'),o=null,i=this.getParentByClass('SBIS3.EDO.StatTemplate'),p=o&&o.get('ТипДокумента')||i&&i._options&&i._options.docType;if(r.find('span').addClass(s.prototype._getStatClass(a)),r.find('span').attr('stat_id',s.prototype._getStatClass(a)),'Всего'===a){var l=$('<hr style="display: block;margin-left: 0px;margin-top: 5px;background-color: #000000;border: none;height: 1px;margin-right:-5px;margin-left:-5px">');r.append(l);}else if('Доставлено'===a||'Отправлено'===a)r.find('span').removeClass('stat_docs');if('Документы'===e)r.attr('title',rk('Перейти к документам'));else r.attr('title',rk('Перейти к списку')+' '+('ЗаказИсх'!==p?rk('покупателей'):rk('поставщиков')));return r.find('span').text(n),r;},renderNumColumnIncoming:function(t,e){var a=t.get('Состояние'),n=t.get(e),r=$('<div><span class="stat_docs"></span></div>'),o=null,i=this.getParentByClass('SBIS3.EDO.StatTemplate'),p=o&&o.get('ТипДокумента')||i&&i._options&&i._options.docType;if(r.find('span').addClass(s.prototype._getStatClassIncoming(a)),r.find('span').attr('stat_id',s.prototype._getStatClassIncoming(a)),'Всего'===a){var l=$('<hr style="display: block;margin-left: 0px;margin-top: 5px;background-color: #000000;border: none;height: 1px;margin-right:-5px;margin-left:-5px">');r.append(l);}if('Документы'===e)r.attr('title',rk('Перейти к документам'));else r.attr('title',rk('Перейти к списку')+' '+('ЗаказВх'!==p?rk('поставщиков'):rk('покупателей')));return r.find('span').text(n),r;},captionRender:function(t){var e=null,a=this.getParentByClass('SBIS3.EDO.StatTemplate'),n=a&&a._options||{},s=a&&a.hasChildControlByName(n['StatTemplateName'])?a.getChildControlByName(n['StatTemplateName']):null,r=s&&s.getLinkedContext(),o=e&&e.get('ТипДокумента')||r&&r.getValue('ТипДокумента.Название'),i=e&&e.get('ТипРаздела')?'Входящие'===e.get('ТипРаздела')?rk('Поставщики'):rk('Покупатели'):r&&'Входящие'===r.getValue('ТипРаздела')?rk('Поставщики'):rk('Покупатели');if('ЗаказВх'===o)i=rk('Покупатели');if('ЗаказИсх'===o)i=rk('Поставщики');switch(t){case'Текущее состояние':return $('<span style="font-size:13px;font-weight:700;color:#000000;">'+rk('Текущее состояние')+'</span>');case'Документы':return $('<span style="font-size:13px;color:#808080">'+rk('Документы')+'</span>');case'Контрагенты':return $('<span style="font-size:13px;color:#808080">'+i+'</span>');case'%':return $('<span style="font-size:13px;padding-right:20px;color:#808080">%</span>');}},renderPercColumn:function(t,e){var a=t.get('Состояние'),n='Всего'===a?'':t.get(e).toFixed(1),r=$('<div><span class="stat_docs" style="padding-right:20px"></span></div>'),o='Incoming'===this.getParent()._options.statType?s.prototype._getStatClassIncoming(a):s.prototype._getStatClass(a);if(r.find('span').addClass(o),r.find('span').attr('stat_id',o),'Всего'===a){var i=$('<hr style="display: block;margin-left: 0px;margin-top: 5px;background-color: #000000;border: none;height: 1px;margin-right:-5px;margin-left:-5px">');r.append(i);}else if('Доставлено'===a||'Отправлено'===a)r.find('span').removeClass('stat_docs');return r.attr('title',rk('Перейти к документам')),r.find('span').text(n),r;},_getStatClass:function(t){switch(t){case'Всего':return'all_docs';case'НеОтправлено':return'no_send_docs';case'Отправлено':return'send_docs';case'НеДоставлено':return'no_deliv_docs';case'Доставлено':return'deliv_docs';case'На проверке':return'on_checking_docs';case'Принято':return'recv_docs';case'Отклонено':return'decl_docs';case'УдаленоКонтрагентом':return'kon_del_docs';case'Аннулировано':return'ann_docs';case'СОшибками':return'error_docs';case'Черновики':return'rough_docs';}},_getStatClassIncoming:function(t){switch(t){case'Всего':return'all_docs';case'ВОбработке':return'proc_docs';case'Принято':return'recv_docs_in';case'Отклонено':return'decl_docs_in';case'Черновики':return'rough_docs';case'УдаленоКонтр':return'kon_del_docs_in';}},onRowClick:function(e,a,s,r,o){var i=null,p=this.getParentByClass('SBIS3.EDO.StatTemplate'),l=i&&i.get('ТипДокумента')||p&&p._options&&p._options.docType,d=p&&p._options&&p._options['registryBrowserName'],c=n.getBrowserFromNewRegistry.call(this),g=s.get('Состояние'),u=t.getParam('КоличествоНашихОрганизацийСФилиалами'),f=this.findCell(g,o);if('Доставлено'===g||'Отправлено'===g)return;if('Контрагенты'!==o)if('Всего'===g)n.goToOurOrgReport(this.getParent()._options.ourOrganizationReportName,c,l);else if(('НеОтправлено'===g||'ВОбработке'===g)&&l&&-1!==['ДоговорВх','ДоговорИсх'].indexOf(l))n.goToInnerStat(c);else n.goToDocsFromStat(f.find('span').attr('stat_id'),c,l);else n.goToKontr(f.find('span').attr('stat_id'),void 0,c);},makeFilterParam:function(t){return'<options name="'+t+'">'+'<option name="saveToState">false</option>'+'<option name="fieldName">'+t+'</option>'+'</options>';}});return s.title='Статистика исходящих событий',s.dimensions={autoWidth:true,autoHeight:true,resizable:false},s;});
define('js!SBIS3.EDO.StatIncoming',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.MainExternalStatistics','js!SBIS3.EDO.MainExternalStatistics','js!SBIS3.EDO.StatFuncs','Deprecated/Controls/TableView/TableView','Deprecated/Controls/TemplatedArea/TemplatedArea','js!SBIS3.EDO.StatisticsEDOHandlers','js!SBIS3.EDO.TemplateMainStatFilter','Deprecated/Controls/TableView/plugins/Results-plugin','Elektronnyj_dokumentooborot_localization'],function(e,t,a){var o=e.extend({_dotTplFn:t,$protected:{_options:{browserName:'StatIncoming',methodName:'СтатистикаВходящих',objectName:'Документ',createMethodName:'FormatKeyByDocumentId',updateMethodName:'Записать',readMethodName:'getTypeDocAndReglament',destroyMethodName:'ЕстьРасширение',additionalRenders:'',beforeTemplatedArea:'',afterTemplatedArea:'',statType:'Incoming',ourOrganizationReportName:'js!SBIS3.EDO.StatisticsIncomingDocsOurOrganizations',additionalFilterParams:''+a.prototype.makeFilterParam('Регламент')+a.prototype.makeFilterParam('ФильтрНеотвеченные')+a.prototype.makeFilterParam('ФильтрФаза')}},$constructor:function(){},init:function(){o.superclass.init.call(this);}});return o.title='Статистика входящих документов',o.dimensions={autoWidth:true,autoHeight:true,resizable:false},o;});
define('js!SBIS3.EDO.StatIncomingDocs',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.MainExternalStatistics','js!SBIS3.EDO.MainExternalStatistics','js!SBIS3.EDO.StatFuncs','Deprecated/Controls/TableView/TableView','Deprecated/Controls/TemplatedArea/TemplatedArea','js!SBIS3.EDO.StatisticsEDOHandlers','js!SBIS3.EDO.TemplateMainStatFilter','Deprecated/Controls/TableView/plugins/Results-plugin','js!SBIS3.EDO.MainExternalStatistics','Elektronnyj_dokumentooborot_localization'],function(e,t){var a=e.extend({_dotTplFn:t,$protected:{_options:{browserName:'StatIncomingDocs',methodName:'СтатистикаВходящих',objectName:'Документ',createMethodName:'ReadFileInfo',updateMethodName:'Записать',readMethodName:'getTypeDocAndReglament',destroyMethodName:'ЕстьРасширение',additionalRenders:'<option name="onBeforeLoad" type="function">js!SBIS3.EDO.StatisticsEDOHandlers:loadTotalSums</option>',beforeTemplatedArea:'<!--',afterTemplatedArea:'!-->',statType:'Incoming',ourOrganizationReportName:'js!SBIS3.EDO.StatisticsIncomingDocsOurOrganizations',additionalFilterParams:''}},$constructor:function(){},init:function(){a.superclass.init.call(this);}});return a.title='Статистика входящих документов',a.dimensions={autoWidth:true,autoHeight:true,resizable:false},a;});
define('js!SBIS3.EDO.StatIncomingEvents',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.MainExternalStatistics','Deprecated/Controls/TableView/TableView','Deprecated/Controls/TemplatedArea/TemplatedArea','js!SBIS3.EDO.StatisticsEDOHandlers','js!SBIS3.EDO.TemplateMainStatFilter','Deprecated/Controls/TableView/plugins/Results-plugin','js!SBIS3.EDO.MainExternalStatistics','Elektronnyj_dokumentooborot_localization'],function(t,e){var a=t.extend({_dotTplFn:e,$protected:{_options:{browserName:'StatisticsIncomingEvents',methodName:'СтатистикаСобытий',objectName:'РеестрВходящих',createMethodName:'Создать',updateMethodName:'Записать',readMethodName:'Прочитать',destroyMethodName:'Удалить',additionalRenders:'',statType:'Incoming',ourOrganizationReportName:'js!SBIS3.EDO.StatisticsIncomingEventsOurOrganizations',additionalFilterParams:''}},$constructor:function(){},init:function(){a.superclass.init.call(this);}});return a.title='Статистика исходящих событий',a.dimensions={autoWidth:true,autoHeight:true,resizable:false},a;});
define('js!SBIS3.EDO.StatOutgoing',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.MainExternalStatistics','js!SBIS3.EDO.MainExternalStatistics','js!SBIS3.EDO.StatFuncs','Deprecated/Controls/TableView/TableView','Deprecated/Controls/TemplatedArea/TemplatedArea','js!SBIS3.EDO.StatisticsEDOHandlers','js!SBIS3.EDO.TemplateMainStatFilter','Deprecated/Controls/TableView/plugins/Results-plugin','js!SBIS3.EDO.MainExternalStatistics','Elektronnyj_dokumentooborot_localization'],function(t,e,a){var i=t.extend({_dotTplFn:e,$protected:{_options:{browserName:'StatOutgoing',methodName:'СтатистикаИсходящих',objectName:'Документ',createMethodName:'FormatKeyByDocumentId',updateMethodName:'Записать',readMethodName:'getTypeDocAndReglament',destroyMethodName:'ЕстьРасширение',additionalRenders:'',beforeTemplatedArea:'',afterTemplatedArea:'',statType:'Outgoing',ourOrganizationReportName:'js!SBIS3.EDO.StatisticsOutgoingDocsOurOrganizations',additionalFilterParams:''+a.prototype.makeFilterParam('Регламент')+a.prototype.makeFilterParam('ФильтрНеотвеченные')+a.prototype.makeFilterParam('ФильтрФаза')}},$constructor:function(){},init:function(){i.superclass.init.call(this);}});return i.title='Статистика исходящих документов',i.dimensions={autoWidth:true,autoHeight:true,resizable:false},i;});
define('js!SBIS3.EDO.StatOutgoingDocs',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.MainExternalStatistics','js!SBIS3.EDO.MainExternalStatistics','js!SBIS3.EDO.StatFuncs','Deprecated/Controls/TableView/TableView','Deprecated/Controls/TemplatedArea/TemplatedArea','js!SBIS3.EDO.StatisticsEDOHandlers','js!SBIS3.EDO.TemplateMainStatFilter','Deprecated/Controls/TableView/plugins/Results-plugin','js!SBIS3.EDO.MainExternalStatistics','Elektronnyj_dokumentooborot_localization'],function(t,e){var a=t.extend({_dotTplFn:e,$protected:{_options:{browserName:'StatOutgoingDocs',methodName:'СтатистикаИсходящих',objectName:'Документ',createMethodName:'ReadFileInfo',updateMethodName:'Записать',readMethodName:'getTypeDocAndReglament',destroyMethodName:'ЕстьРасширение',additionalRenders:'<option name="onBeforeLoad" type="function">js!SBIS3.EDO.StatisticsEDOHandlers:loadTotalSums</option>',beforeTemplatedArea:'<!--',afterTemplatedArea:'!-->',statType:'Outgoing',ourOrganizationReportName:'js!SBIS3.EDO.StatisticsOutgoingDocsOurOrganizations',additionalFilterParams:''}},$constructor:function(){},init:function(){a.superclass.init.call(this);}});return a.title='Статистика исходящих документов',a.dimensions={autoWidth:true,autoHeight:true,resizable:false},a;});
define('js!SBIS3.EDO.StatOutgoingEvents',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.MainExternalStatistics','Deprecated/Controls/TableView/TableView','Deprecated/Controls/TemplatedArea/TemplatedArea','js!SBIS3.EDO.StatisticsEDOHandlers','js!SBIS3.EDO.TemplateMainStatFilter','Deprecated/Controls/TableView/plugins/Results-plugin','js!SBIS3.EDO.MainExternalStatistics','Elektronnyj_dokumentooborot_localization'],function(t,e){var a=t.extend({_dotTplFn:e,$protected:{_options:{browserName:'StatisticsOutgoingEvents',methodName:'СтатистикаСобытий',objectName:'РеестрИсходящих',createMethodName:'Создать',updateMethodName:'Записать',readMethodName:'Прочитать',destroyMethodName:'Удалить',additionalRenders:'',beforeTemplatedArea:'',afterTemplatedArea:'',statType:'Outgoing',ourOrganizationReportName:'js!SBIS3.EDO.StatisticsOutgoingEventsOurOrganizations',additionalFilterParams:''}},$constructor:function(){},init:function(){a.superclass.init.call(this);}});return a.title='Статистика исходящих событий',a.dimensions={autoWidth:true,autoHeight:true,resizable:false},a;});
define("html!SBIS3.EDO.OtherReglaments",function(){var o=function(o){var e=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(e){for(;o.test(e);)e=e.replace(o,"&#123;&#123;$1&#125;&#125;");return e}}(),t=function(o){return o.join?o.join(""):o.toString()},n=function(o){return void 0===o?"":o&&"object"==typeof o?t(o):""+o},i="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div style="width:416px;height:auto;overflow: auto !important" class="stat_other_relaments"> <div style="display: inline"> <component data-component="Deprecated/Controls/SearchString/SearchString" name="ПоискПоРегламентам" style="height: 32px; margin-left: 8px; min-width: 250px;"> <option name="resetRoot">true</option> <option name="linkedBrowser">СписокРегламентов</option> <option name="tooltip">'+e(n(rk("найти...")))+'</option> <option name="startSearch">0</option> <option name="filterName">РегламентНазвание</option> </component> <div id="results" class="tableview_results" style="margin-top: 2px;"> <span class="icon-16 icon-Time icon-disabled" style="color: #EF463A !important;margin-right: 2px;"></span> <div class="overdue_result"></div> <div class="total_result" style="margin-right: 8px"></div> </div> </div> <component data-component="Deprecated/Controls/TreeView/TreeView" name="СписокРегламентов" class="ReglamentsList"> <options name="display"> <option name="hierColumn" value="Раздел"></option> <option name="titleColumn" value="Раздел"></option> <option name="emptyHtml">'+e(n(rk("Нет данных")))+'</option> <option name="emptyTableHtml">'+e(n(rk("Нет данных")))+'</option> <option name="useSorting">true</option> <option name="showHead">false</option> <options name="columns" type="array"> <options> <option name="title" value=""></option> <option name="field">Название</option> <option name="width" type="string">350</option> <option name="fixedSize">true</option> <option name="type" value=""></option> <option name="filterDialog" value=""></option> </options> </options> </options> <option name="resultAlign" value="top"></option> <options name="filterParams"> <options name="РегламентНазвание"> <option name="saveToState">false</option> <option name="fieldName">РегламентНазвание</option> </options> </options> <options name="dataSource"> <options name="readerParams"> <option name="createMethodName" value=""></option> <option name="readMethodName" value=""></option> <option name="updateMethodName" value=""></option> <option name="destroyMethodName" value=""></option> </options> <option name="firstRequest">false</option> </options> </component> </div>');return(a=e(a))+(i&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.OtherReglaments"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.OtherReglaments", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".ReglamentsList{margin-left:0;margin-right:0;height:auto;position:relative;margin-top:5px;width:416px}.tableview_results{font-family:'TensorFont Bold',TensorFont;font-size:13px;color:#000;margin-bottom:-21px;float:right;font-weight:700;position:relative;z-index:1000}.overdue-column span{color:#ef463a!important}.stat_other_relaments .overdue_result{color:#ef463a;display:inline-block}.stat_other_relaments .total_result{display:inline-block;width:43px;text-align:right}.stat_other_relaments .total_result:hover{cursor:pointer;text-decoration:underline}.stat_other_relaments .overdue_result:hover{cursor:pointer;text-decoration:underline}.stat_other_relaments .regl_title .ws-browser-text-container{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.stat_other_relaments .count-column{padding-right:4px}"));head.appendChild(style);});}
define('js!SBIS3.EDO.OtherReglaments',['Transport/Record','Transport/RecordSetStatic','Core/helpers/string-helpers','SBIS3.CONTROLS/CompoundControl','js!SBIS3.EDO.InnerStat','js!SBIS3.EDO.StatFuncs','html!SBIS3.EDO.OtherReglaments','Core/core-functions','css!SBIS3.EDO.OtherReglaments','Deprecated/Controls/TreeView/TreeView','Deprecated/Controls/SearchString/SearchString','i18n!SBIS3.EDO.OtherReglaments','Elektronnyj_dokumentooborot_localization'],function(e,t,i,r,n,s,l,a){function o(e,t){var i=e.get(t),r=this.getParent().getLinkedContext().getValue('brw_filter'),s='Просрочено'===t,l=this.getParent().getLinkedContext().getValue('isReglaments'),a=l?'ИдРегламента':'ФильтрИдФазы',o,d=$('<span></span>');if(r[a]=l?e.get('@Регламент'):r['ИдРегламента']+':'+e.get('@Регламент'),r[a+'Текст']=e.get('Название'),o=n.generateHrefParams(r,e,false,s,null,'other_elements',e.get('Итого'),e.get('Просрочено')),null!==i&&0!==i){if(o&&!e.get('Раздел@'))d.attr('class','phase-report-link'),d.attr('params',o);return d.text(i),d;}else return'';}function d(e,t){var r=$('<span></span>'),n=e.get(t);return r.attr('title',i.escapeHtml(n)),r.text(n),r;}var u=r.extend({_dotTplFn:l,$protected:{_options:{autoHeight:true,autoWidth:true,isNewDataStructure:false}},$constructor:function(){},init:function(){var i=this;u.superclass.init.call(this);var r=this.getLinkedContext().getValue('other_elements'),l=this.getLinkedContext().getValue('other_elements_id'),d=this.getLinkedContext().getValue('isReglaments'),g=this.getLinkedContext().getValue('Итоги'),f=this.getLinkedContext().getValue('isNewDataStructure'),c=f?g.getEnumerator()._items:g.getColumns(),h=this.getChildControlByName('СписокРегламентов'),p=this.getLinkedContext().getValue('brw_filter'),v=this.getLinkedContext().getValue('stringFilter'),_={'@key':{type:'Идентификатор',title:'@Регламент',index:0},'Название':{type:'Строка',title:'Название',index:1},'Просрочено':{type:'Число целое',title:'Просрочено',index:2},'Итого':{type:'Число целое',title:'Итого',index:3},'Раздел':{type:'Идентификатор',title:'Раздел',index:4},'Раздел@':{type:'Логическое',title:'Раздел@',index:5}},m=[],C=new t({defaultColumns:_});this._options.isNewDataStructure=f;for(var S=function(e,t){var i=false,r=0;while(!i&&r<e.length){if(-1!==e[r].indexOf(t))i=true;r+=1;}return i;},x=0;x<c.length;x++){var I=c[x],O=g.get(I).split(','),y=new e(),E=0,P=0;if(-1===['Итого','Просрочено','-1##Прочее'].indexOf(I)){var w=I.split('##'),D=w[0],T=w[1];if(-1!==r.indexOf(I)){if(d&&1===parseInt(O[3],10)){var b=N(D,l);E=b[0],P=b[1];}else E=parseInt(O[0],10),P=parseInt(O[1],10);if(null!==E&&0!==E)y.addColumn('@Регламент',e.FIELD_TYPE_UUID),y.addColumn('Название',e.FIELD_TYPE_STRING),y.addColumn('Просрочено',e.FIELD_TYPE_INTEGER),y.addColumn('Итого',e.FIELD_TYPE_INTEGER),y.addColumn('Раздел',e.FIELD_TYPE_UUID),y.addColumn('Раздел@',e.FIELD_TYPE_BOOLEAN),y.set('@Регламент',D),y.set('Название',T),y.set('Раздел','-1'!==O[2]&&'null'!==O[2]&&d&&S(c,O[2])?O[2]:null),y.set('Раздел@',d?1===parseInt(O[3],10):false),y.set('Итого',E),y.set('Просрочено',P),y.setKey(D),y.commit(),m.push(y);}}}if(h.unfiltered_records=m,C.setRecords(m),d)p['ФильтрПрочиеРегламенты']=l;else p['ФильтрПрочиеФазы']=l;var R=g.get('-1##Прочее').split(',')[0],k=g.get('-1##Прочее').split(',')[1],F=n.generateHrefParams(p,y,true,true,l,'other_elements',R,k);this.getContainer().find('div.overdue_result').text(k);function L(e,t,i,r){e.click(function(e){s.goToPhasesWork(e,t,i,r);});}L(this.getContainer().find('div.overdue_result'),F,h,h),F=n.generateHrefParams(p,y,true,false,l,'other_elements',R,k),this.getContainer().find('div.total_result').text(R),L(this.getContainer().find('div.total_result'),F,h,h);var B=[{captionAlign:'left',title:'',field:'Название',width:150,fixedSize:false,textAlign:'left',isResultField:false,isSortable:false,verticalAlign:'top',className:'regl_title',render:o},{captionAlign:'left',title:'',className:'overdue-column',field:'Просрочено',width:50,fixedSize:true,textAlign:'right',isResultField:false,isSortable:false,verticalAlign:'top',render:o},{captionAlign:'left',title:'',className:'count-column',field:'Итого',width:50,fixedSize:true,textAlign:'right',isResultField:false,isSortable:false,verticalAlign:'top',render:o}];h.setColumns(B),h.setData(C),h.subscribe('onRowClick',function(e,t,i,r,n){if(e.setResult(false),'Название'===n&&!i.get('Раздел@')&&d){if(f){var l=this.getTopParent().getOpener(),o=l?l.getParentByClass('SBIS3.EDO.StatTemplateNew'):null,u=l&&a.clone(l.getFilter)?l.getFilter():null;u['ИдРегламента']=i.get('@Регламент'),u['ИдРегламентаТекст']=i.get('Название'),s.saveLastStatisticsFilter(u,o.historyStorage).addCallback(function(){o.setStatisticsTemplate('StatisticsPhaseReport');});}else{var g=this.getTopParent().getOpener().getQuery();g['ИдРегламента']=i.get('@Регламент'),s.goToInnerStatReport('js!SBIS3.EDO.StatisticsReportByPhase',g,this.getTopParent().getOpener().getParent().getParent());}this.getTopParent().close();}else if(!i.get('Раздел@')){var c=this.findCell(i.getKey(),n).find('span.phase-report-link').attr('params');if(c)s.goToPhasesWork(e,c,this,this);}}),this.getChildControlByName('ПоискПоРегламентам').subscribe('onChange',function(r,a){if(''===a){var o=jQuery('#results');o.find('span').css('visibility','visible'),o.find('div.overdue_result').css('visibility','visible'),o.find('div.total_result').css('visibility','visible');var d=g.get('-1##Прочее').split(','),u=n.generateHrefParams(s.addStringFilter(p,v),new e(),true,true,l,'other_elements',d[0],d[1]);i.getContainer().find('div.overdue_result').text(d[1]),L(h.getContainer().find('div.overdue_result'),u),u=n.generateHrefParams(s.addStringFilter(p,v),new e(),true,false,l,'other_elements',d[0],d[1]),i.getContainer().find('div.total_result').text(d[0]),L(h.getContainer().find('div.total_result'),u);var f=new t({defaultColumns:_});f.setRecords(h.unfiltered_records),h.setData(f);}}),this.getChildControlByName('ПоискПоРегламентам').subscribe('onBeforeApplyFilter',function(r,l){var a=[],o=[],d;for(d=0;d<h.unfiltered_records.length;d++)if(!h.unfiltered_records[d].get('Раздел@')&&-1!==h.unfiltered_records[d].get('Название').toLowerCase().indexOf(l['РегламентНазвание'].toLowerCase()))a.push(h.unfiltered_records[d]),o.push(h.unfiltered_records[d].get('@Регламент'));var u=a;for(d=0;d<a.length;d++){var g=a[d],f=false;while(!f){if(-1===o.indexOf(g.get('@Регламент')))u.push(g),o.push(g.get('@Регламент'));f=true;for(var c=0;c<h.unfiltered_records.length;c++)if(g.get('Раздел')===h.unfiltered_records[c].get('@Регламент')){g=h.unfiltered_records[c],f=false;break;}}}var m=0,C=0;for(d=0;d<u.length;d++)if(u[d].get('Раздел@')){var S=N(u[d].get('@Регламент'),o),x=0,I=0;x=S[0],I=S[1],u[d].set('Итого',x),u[d].set('Просрочено',I),u[d].commit();}else m+=u[d].get('Итого'),C+=u[d].get('Просрочено');var O;if(0!==C)O=n.generateHrefParams(s.addStringFilter(p,v),new e(),true,true,o,'other_elements',m,C),i.getContainer().find('div.overdue_result').text(C),L(h.getContainer().find('div.overdue_result'),O);else{var y=jQuery('#results');y.find('span').css('visibility','hidden'),y.find('div.overdue_result').css('visibility','hidden');}if(0!==m)O=n.generateHrefParams(s.addStringFilter(p,v),new e(),true,false,o,'other_elements',m,C),i.getContainer().find('div.total_result').text(m),L(h.getContainer().find('div.total_result'),O);else jQuery('#results').find('div.total_result').css('visibility','hidden');var E=new t({defaultColumns:_});E.setRecords(u),h.setData(E);});function N(e,t){var i=[0,0],r=[],n,s,l;for(l=0;l<c.length;l++)if(n=c[l],-1===['Итого','Просрочено','-1##Прочее'].indexOf(n))if(s=n.split('##')[0],s===e){r=g.get(n).split(',');break;}if(r===[])return i;if(1===parseInt(r[3],10)){for(l=0;l<c.length;l++)if(n=c[l],-1===['Итого','Просрочено','-1##Прочее'].indexOf(n))if(s=n.split('##')[0],-1!==t.indexOf(s))if(r=g.get(n).split(','),r[2]===e){var a=[parseInt(r[0],10),parseInt(r[1],10)];if(s!==parseInt(r[2],10))a=N(s,t);i[0]+=a[0],i[1]+=a[1];}}else i[0]=parseInt(r[0],10),i[1]=parseInt(r[1],10);return i;}}});return u.title=rk('Прочее'),u;});
define("tmpl!SBIS3.EDO.FilterPeriodStatReportNew",["Core/tmpl/js/tclosure","js!SBIS3.EDO.BaseFilter.Period","js!SBIS3.EDO.PassageStatus","js!SBIS3.EDO.BaseFilter.Limitation","js!SBIS3.EDO.BaseFilter.Face1","js!SBIS3.EDO.BaseFilter.ResponsibleFace","js!SBIS3.EDO.BaseFilter.ListDispatch","js!SBIS3.EDO.BaseFilter.AuthorOrResponsible","js!SBIS3.EDO.BaseFilter.Milestone","js!SBIS3.EDO.BaseFilter.Marks","js!SBIS3.EDO.BaseFilter.Regulation","js!SBIS3.EDO.RepeatStages","js!SBIS3.EDO.BaseFilter.RightsLimText"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.EDO.BaseFilter.Period"]=e[1],r["js!SBIS3.EDO.PassageStatus"]=e[2],r["js!SBIS3.EDO.BaseFilter.Limitation"]=e[3],r["js!SBIS3.EDO.BaseFilter.Face1"]=e[4],r["js!SBIS3.EDO.BaseFilter.ResponsibleFace"]=e[5],r["js!SBIS3.EDO.BaseFilter.ListDispatch"]=e[6],r["js!SBIS3.EDO.BaseFilter.AuthorOrResponsible"]=e[7],r["js!SBIS3.EDO.BaseFilter.Milestone"]=e[8],r["js!SBIS3.EDO.BaseFilter.Marks"]=e[9],r["js!SBIS3.EDO.BaseFilter.Regulation"]=e[10],r["js!SBIS3.EDO.RepeatStages"]=e[11],r["js!SBIS3.EDO.BaseFilter.RightsLimText"]=e[12];var o=function e(o,i,s,n,a){function l(){}var c=0,p=void 0!==t&&t?t:arguments[arguments.length-1];void 0===p&&(eval("var thelpers = null;"),p=global.requirejs("View/Runner/tclosure"));var S={};a&&a.isSetts&&(S=a.fullContext||{});var u="string"==typeof s?s:"",d=void 0===r?void 0:r,m={id:[],def:void 0},B=p.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),F=this&&this.includedTemplates?this.includedTemplates:{},O=p.getMarkupGenerator(n);try{var f=O.joinElements([O.createTag("div",{class:"edo-BaseFilter__filterPicker"},[O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Period",{limited:!0},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},s,d,F,p.config,S),p.getter(o,["componentOptions","customizeFilters","FilterPassageStatus"])?[O.createControl("wsControl","ws:SBIS3.EDO.PassageStatus",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},s,d,F,p.config,S)]:O.createText(""),p.getter(o,["componentOptions","customizeFilters","FilterLimitationDate"])?[O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Limitation",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},s,d,F,p.config,S)]:O.createText(""),p.getter(o,["componentOptions","customizeFilters","FilterFace1"])?[O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Face1",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},s,d,F,p.config,S)]:O.createText(""),p.getter(o,["componentOptions","customizeFilters","FilterResponsibleFace"])?[O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ResponsibleFace",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},s,d,F,p.config,S)]:O.createText(""),p.getter(o,["componentOptions","customizeFilters","FilterListDispatch"])?[O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ListDispatch",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},s,d,F,p.config,S)]:O.createText(""),p.getter(o,["componentOptions","customizeFilters","FilterAuthorOrResponsible"])?[O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.AuthorOrResponsible",{showCustom:p.getter(o,["componentOptions","customizeFilters","FilterAuthorOrResponsibleMe"])},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},s,d,F,p.config,S)]:O.createText(""),p.getter(o,["componentOptions","customizeFilters","FilterMilestone"])?[O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Milestone",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},s,d,F,p.config,S)]:O.createText(""),p.getter(o,["componentOptions","customizeFilters","FilterMarks"])?[O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Marks",{reestrName:p.getter(o,["componentOptions","docType"]),multiDocsReestr:!!p.getter(o,["componentOptions","docTypes"])},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},s,d,F,p.config,S)]:O.createText(""),p.getter(o,["componentOptions","customizeFilters","FilterIdRegulations"])?[O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Regulation",{docTypes:p.getter(o,["idRegulationsDocTypes"]),hidePhase:!0},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},s,d,F,p.config,S)]:O.createText(""),p.getter(o,["componentOptions","customizeFilters","FilterRepeatStages"])?[O.createControl("wsControl","ws:SBIS3.EDO.RepeatStages",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},s,d,F,p.config,S)]:O.createText(""),O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.RightsLimText",{textRender:p.getTypeFunc("js!SBIS3.EDO.ScopeFilters:setScopeTextForFilter ",{}),esc:!1},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},s,d,F,p.config,S)],i,m,this)],u,m);m.def&&(f=O.chain(f,m,i),m=void 0)}catch(e){p.templateError("resources/Elektronnyj_dokumentooborot/Statistika/PeriodStatReport/FilterPeriodStatReport/FilterPeriodStatReportNew.tmpl",e,o)}return f||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FilterPeriodStatReportNew"}},o});
define('js!SBIS3.EDO.FilterPeriodStatReportNew',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FilterPeriodStatReportNew','js!SBIS3.EDO.BaseFilter.Period','js!SBIS3.EDO.BaseFilter.Limitation','js!SBIS3.EDO.BaseFilter.Overdue','js!SBIS3.EDO.BaseFilter.Marks','js!SBIS3.EDO.BaseFilter.ResponsibleFace','js!SBIS3.EDO.BaseFilter.Face1','js!SBIS3.EDO.BaseFilter.ListDispatch','js!SBIS3.EDO.BaseFilter.AuthorOrResponsible','js!SBIS3.EDO.BaseFilter.Regulation','js!SBIS3.EDO.BaseFilter.Milestone','js!SBIS3.EDO.BaseFilter.RightsLimText','js!SBIS3.EDO.PassageStatus','js!SBIS3.EDO.RepeatStages','i18n!SBIS3.EDO.FilterPeriodStatReportNew','js!SBIS3.EDO.ScopeFilters','Elektronnyj_dokumentooborot_localization'],function(e,t){var i=e.extend({_dotTplFn:t,$protected:{_options:{autoHeight:true,autoWidth:true,FilterIdRegulations:true,componentOptions:{customizeFilters:{FilterFace1:true,FilterIdRegulations:true,FilterLimitationDate:true,FilterResponsibleFace:true,FilterAuthorOrResponsibleMe:true,FilterListDispatch:true,FilterPriority:true,FilterMilestone:true,FilterPassageStatus:false,FilterRepeatStages:false,FilterMarks:false,FilterAuthorOrResponsible:false}}}},$constructor:function(){},_modifyOptions:function(e){var t=[];if((e=i.superclass._modifyOptions.call(this,e)).componentOptions.docTypes){for(var s=e.componentOptions.docTypes.split(','),r=0;r<s.length;r++)if(s.hasOwnProperty(r))t.push({docTypeString:s[r],subDocTypeString:''});}else if(e.componentOptions.docType)t.push({docTypeString:e.componentOptions.docType,subDocTypeString:e.componentOptions.docSubType});return e.idRegulationsDocTypes=t,e;},init:function(){i.superclass.init.call(this);}});return i;});
define("tmpl!SBIS3.EDO.FilterPeriodStatReportNewSelector",["Core/tmpl/js/tclosure","js!SBIS3.EDO.PassageStatusSelector","js!SBIS3.EDO.BaseFilter.LimitationSelector","js!SBIS3.EDO.BaseFilter.Face1Selector","js!SBIS3.EDO.BaseFilter.ResponsibleFaceSelector","js!SBIS3.EDO.BaseFilter.ListDispatchSelector","js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleSelector","js!SBIS3.EDO.BaseFilter.MilestoneSelector","js!SBIS3.EDO.BaseFilter.MarksSelector","js!SBIS3.EDO.BaseFilter.RegulationSelector","js!SBIS3.EDO.RepeatStagesSelector"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.EDO.PassageStatusSelector"]=e[1],r["js!SBIS3.EDO.BaseFilter.LimitationSelector"]=e[2],r["js!SBIS3.EDO.BaseFilter.Face1Selector"]=e[3],r["js!SBIS3.EDO.BaseFilter.ResponsibleFaceSelector"]=e[4],r["js!SBIS3.EDO.BaseFilter.ListDispatchSelector"]=e[5],r["js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleSelector"]=e[6],r["js!SBIS3.EDO.BaseFilter.MilestoneSelector"]=e[7],r["js!SBIS3.EDO.BaseFilter.MarksSelector"]=e[8],r["js!SBIS3.EDO.BaseFilter.RegulationSelector"]=e[9],r["js!SBIS3.EDO.RepeatStagesSelector"]=e[10];var o=function e(o,i,s,a,l){function n(){}var c=0,S=void 0!==t&&t?t:arguments[arguments.length-1];void 0===S&&(eval("var thelpers = null;"),S=global.requirejs("View/Runner/tclosure"));var p={};l&&l.isSetts&&(p=l.fullContext||{});var u="string"==typeof s?s:"",d=void 0===r?void 0:r,m={id:[],def:void 0},F=S.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),B=this&&this.includedTemplates?this.includedTemplates:{},O=S.getMarkupGenerator(a);try{var f=O.joinElements([O.createTag("div",{class:"edo-BaseFilter__filterPicker edo-twoColumnSelectors"},[S.getter(o,["componentOptions","customizeFilters","FilterPassageStatus"])?[O.createControl("wsControl","ws:SBIS3.EDO.PassageStatusSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:F},s,d,B,S.config,p)]:O.createText(""),S.getter(o,["componentOptions","customizeFilters","FilterLimitationDate"])?[O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.LimitationSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:F},s,d,B,S.config,p)]:O.createText(""),S.getter(o,["componentOptions","customizeFilters","FilterFace1"])?[O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Face1Selector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:F},s,d,B,S.config,p)]:O.createText(""),S.getter(o,["componentOptions","customizeFilters","FilterResponsibleFace"])?[O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ResponsibleFaceSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:F},s,d,B,S.config,p)]:O.createText(""),S.getter(o,["componentOptions","customizeFilters","FilterListDispatch"])?[O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ListDispatchSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:F},s,d,B,S.config,p)]:O.createText(""),S.getter(o,["componentOptions","customizeFilters","FilterAuthorOrResponsible"])?[O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.AuthorOrResponsibleSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:F},s,d,B,S.config,p)]:O.createText(""),S.getter(o,["componentOptions","customizeFilters","FilterMilestone"])?[O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.MilestoneSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:F},s,d,B,S.config,p)]:O.createText(""),S.getter(o,["componentOptions","customizeFilters","FilterMarks"])?[O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.MarksSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:F},s,d,B,S.config,p)]:O.createText(""),S.getter(o,["componentOptions","customizeFilters","FilterIdRegulations"])?[O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.RegulationSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:F},s,d,B,S.config,p)]:O.createText(""),S.getter(o,["componentOptions","customizeFilters","FilterRepeatStages"])?[O.createControl("wsControl","ws:SBIS3.EDO.RepeatStagesSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:F},s,d,B,S.config,p)]:O.createText("")],i,m,this)],u,m);m.def&&(f=O.chain(f,m,i),m=void 0)}catch(e){S.templateError("resources/Elektronnyj_dokumentooborot/Statistika/PeriodStatReport/FilterPeriodStatReport/FilterPeriodStatReportNewSelector/FilterPeriodStatReportNewSelector.tmpl",e,o)}return f||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FilterPeriodStatReportNewSelector"}},o});
define('js!SBIS3.EDO.FilterPeriodStatReportNewSelector',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FilterPeriodStatReportNewSelector','js!SBIS3.EDO.BaseFilter.LimitationSelector','js!SBIS3.EDO.BaseFilter.OverdueSelector','js!SBIS3.EDO.BaseFilter.MarksSelector','js!SBIS3.EDO.BaseFilter.ResponsibleFaceSelector','js!SBIS3.EDO.BaseFilter.Face1Selector','js!SBIS3.EDO.BaseFilter.ListDispatchSelector','js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleSelector','js!SBIS3.EDO.BaseFilter.RegulationSelector','js!SBIS3.EDO.BaseFilter.MilestoneSelector','js!SBIS3.EDO.BaseFilter.OurOrganisationSelector','js!SBIS3.EDO.PassageStatusSelector','js!SBIS3.EDO.RepeatStagesSelector','i18n!SBIS3.EDO.FilterPeriodStatReportNewSelector','js!SBIS3.EDO.ScopeFilters','Elektronnyj_dokumentooborot_localization'],function(e,t){var o=e.extend({_dotTplFn:t,$protected:{_options:{autoHeight:true,autoWidth:true,FilterIdRegulations:true,componentOptions:{customizeFilters:{FilterFace1:true,FilterIdRegulations:true,FilterLimitationDate:true,FilterResponsibleFace:true,FilterAuthorOrResponsibleMe:true,FilterListDispatch:true,FilterPriority:true,FilterMilestone:true,FilterPassageStatus:false,FilterRepeatStages:false,FilterMarks:false,FilterAuthorOrResponsible:false}}}},$constructor:function(){},_modifyOptions:function(e){var t='';if((e=o.superclass._modifyOptions.call(this,e)).componentOptions.docTypes){for(var i=e.componentOptions.docTypes.split(','),r=0;r<i.length;r++)if(i.hasOwnProperty(r))t+='<opts><option name="docTypeString" value="'+i[r]+'"></option><option name="subDocTypeString" value=""></option></opts>';}else if(e.componentOptions.docType)t='<opts><option name="docTypeString" value="'+e.componentOptions.docType+'"></option><option name="subDocTypeString" value="'+e.componentOptions.docSubType+'"></option></opts>';return e.idRegulationsDocTypes=t,e;},init:function(){o.superclass.init.call(this);}});return o;});
define("html!SBIS3.EDO.PeriodStatReportNew",function(){var o=function(o){var t=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;o.test(t);)t=t.replace(o,"&#123;&#123;$1&#125;&#125;");return t}}(),n=function(o){return o.join?o.join(""):o.toString()},e=function(o){return void 0===o?"":o&&"object"==typeof o?n(o):""+o},i="undefined"!=typeof process,a=("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),p=function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,r='<div style="height:100%" class="';return o.stickyHeader&&(r+="edo-StatisticsReport"),r+='"> <component data-component="SBIS3.EDO.StatEDOBrowser" name="PeriodStatReportNewBrowser" class="regl-report-hierarchy-view statistics-browser"> <option name="historyId">'+t(e(o.historyId))+'</option> <option name="applyHistoryFilterOnLoad">false</option> <options name="browserOptions"> <option name="idProperty">Идентификатор</option> <option name="stickyHeader">'+t(e(o.stickyHeader))+'</option> <option name="bind">StatisticsFilter/button</option> <option name="multiselect">false</option> <option name="showPaging">false</option> <option name="paging">false</option> <option name="infiniteScroll">false</option> <option name="resultsPosition">top</option> <option name="combineHead">true</option> <option name="resultsText" value="  "></option> <option name="itemsDragNDrop">false</option> <options name="itemsActionsVisibility"> <option name="edoPrintDocument" value="false"></option> <option name="edoSaveDocumentOnDisk" value="false"></option> <option name="edoSendDocument" value="false"></option> <option name="edoSendMessage" value="false"></option> <option name="edoGetLink" value="false"></option> <option name="edoOpenInNewTab" value="false"></option> <option name="edoDeleteDocument" value="false"></option> <option name="edoCopyDocument" value="false"></option> <option name="edoShowMonitoringDialog" value="false"></option> <option name="edoShowDkPanel" value="false"></option> <option name="edoShowMarksPanel" value="false"></option> <option name="edoPostDocument" value="false"></option> <option name="edoRestoreDocument" value="false"></option> <option name="edoShowDkPanel" value="false"></option> </options> <options name="columns" type="array"> <options> <option name="field">Название</option> <option name="title" value=" "></option> <option name="className">phase-report-performer Название controls-DataGridView-cell-overflow-ellipsis</option> <option name="cellTemplate">tmpl!SBIS3.EDO.StatEDOBrowserPP/resources/TitleCell</option> <options name="templateBinding"> <option name="photoFldName">userPhotoData</option> <option name="cssClass">person-photo-mini-large</option> <option name="isPeriodStatReport">true</option> </options> </options> </options> <options name="handlers"> <options name="onDataLoad" type="array"> <option name="onDataLoad" type="function">js!SBIS3.EDO.PeriodStatReportNew:prototype.onDataLoad</option> </options> <options name="onItemClick" type="array"> <option name="onItemClick" type="function">js!SBIS3.EDO.StatFuncs:onItemClickPeriod</option> </options> <options name="onBeforeSetRoot" type="array"> <option name="onBeforeSetRoot" type="function">js!SBIS3.EDO.InnerStat:onBeforeSetRoot</option> </options> <options name="onReady" type="array"> <option name="onReady" type="function">js!SBIS3.EDO.InnerStat:onReadyEdoBrowser</option> </options> </options> <option name="viewMode">table</option> <options name="hierarchy"> <option name="allow">true</option> <option name="parentProperty">Раздел</option> <option name="displayProperty">Название</option> </options> <option name="showHead">true</option> </options> <option name="fastDataFilterConfig"> </option> <option name="searchConfig"> </option> <options name="ignoreFiltersList" type="array"> <option>ФильтрВладелец</option> </options> <option name="operationsPanelConfig">false</option> ',o.filterButtonConfig?r+=' <option name="filterButtonConfig" type="ref">'+t(e(function(o,t){var n=a.randomId();return o[n]=t,n}(p,o.filterButtonConfig)))+"</option> ":r+=' <option name="filterButtonConfig"> <option name="template"> <component data-component="SBIS3.EDO.FilterPeriodStatReportNew"> <options name="componentOptions"> '+t(e(o.filterComponentOptions))+' </options> </component> </option> <option name="additionalFilterParamsTemplate"> <component data-component="SBIS3.EDO.FilterPeriodStatReportNewSelector"> <options name="componentOptions"> '+t(e(o.filterComponentOptions))+' </options> </component> </option> <option name="resetLinkText">'+t(e(o.resetLinkText))+'</option> <options name="filterStructure" type="array"> '+t(e(o.filterStructure))+" </options> </option> ",r+=" </component> </div> ",(r=t(r))+(i&&-1!==r.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.PeriodStatReportNew"}},o});
define("html!SBIS3.EDO.Statistics.ColumnsTemplate.PeriodDataCell",function(){var e=function(e){var t=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;e.test(t);)t=t.replace(e,"&#123;&#123;$1&#125;&#125;");return t}}(),n=function(e){return e.join?e.join(""):e.toString()},r=function(e){return void 0===e?"":e&&"object"==typeof e?n(e):""+e},i="undefined"!=typeof process,o=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,""),a=e.templateBinding.fieldName,s=a&&-1!==a.indexOf("Просрочено"),l=s?"edo-statistics-overdue-count ":"",u=e.item.get(a)||"",d=s?"":"Осталось"===a?"margin-right: 4px;":"";return l+=0!==u&&"0"!==u?"phase-report-link":"",o+=' <span class="',0!==u&&"0"!==u&&(o+=t(r(l))),o+='" style="text-align: right; '+t(r(d))+'"> ',0!==u&&"0"!==u&&(o+=t(r(u))),o+=" </span> ",(o=t(o))+(i&&-1!==o.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.Statistics.ColumnsTemplate.PeriodDataCell"}},e});
define('js!SBIS3.EDO.Statistics.ColumnsTemplate.PeriodDataCell',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.Statistics.ColumnsTemplate.PeriodDataCell','Elektronnyj_dokumentooborot_localization'],function(t,e){'use strict';var i=t.extend({_dotTplFn:e,$protected:{_options:{name:'Statistics.ColumnsTemplate.PeriodDataCell'}},$constructor:function(){},init:function(){var t=this;i.superclass.init.call(t);}});return i;});
define("tmpl!SBIS3.EDO.StatEDOBrowserPP/resources/TitleCell",["Core/tmpl/js/tclosure","js!SBIS3.Person.PersonPhoto"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.Person.PersonPhoto"]=e[1];var o=function e(o,a,s,i,l){function n(){}var p=0,c=void 0!==t&&t?t:arguments[arguments.length-1];void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure"));var d={};l&&l.isSetts&&(d=l.fullContext||{});var u="string"==typeof s?s:"",g=void 0===r?void 0:r,m={id:[],def:void 0},f=c.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),v=this&&this.includedTemplates?this.includedTemplates:{},h=c.getMarkupGenerator(i);try{var S=h.joinElements([h.createTag("span",{title:""+c.wrapUndef(c.utils.escape(c.getDecorators().escapeTagsFromStr.apply(void 0,[c.getter(o,["item","Название"])]))),class:"phase-report-link-title"},[!0!==c.getter(o,["item","Раздел@"])&&-1!==c.getter(o,["item","@Лицо"])?[h.createTag("div",{style:"float:left;margin-right:5px;"},[h.createControl("wsControl","ws:SBIS3.Person.PersonPhoto",{data:{personId:c.getter(o,["item","@Лицо"]),photoId:c.getter(o,["item","photoId"])},settings:{size:40,showMiniCard:!0}},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},s,g,v,c.config,d)],{},m,this)]:h.createText(""),h.createTag("span",{title:""+c.wrapUndef(c.utils.escape(c.getDecorators().escapeTagsFromStr.apply(void 0,[c.getter(o,["item","Название"])]))),style:""+c.wrapUndef(c.utils.escape(c.getter(o,["item","Руководитель"])?"font-weight: 700;":""))},[h.createText(" "+c.wrapUndef(c.utils.escape(c.getDecorators().escapeTagsFromStr.apply(void 0,[c.getter(o,["item","Название"])])))+" ")],{},m,this),h.createTag("br",{},[],{},m,this),h.createTag("div",{style:"text-overflow: ellipsis;overflow: hidden;white-space: nowrap;color: #999999;"},[h.createTag("span",{style:"font-size: 12px;",title:""+c.wrapUndef(c.utils.escape(c.getDecorators().escapeTagsFromStr.apply(void 0,[c.getter(o,["item","Должность"])])))},[h.createText(""+c.wrapUndef(c.utils.escape(c.getDecorators().escapeTagsFromStr.apply(void 0,[c.getter(o,["item","Должность"])]))))],{},m,this)],{},m,this)],a,m,this)],u,m);m.def&&(S=h.chain(S,m,a),m=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/Statistika/StatTemplateNew/StatEdoBrowserPP/resources/TitleCell.tmpl",e,o)}return S||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.StatEDOBrowserPP/resources/TitleCell"}},o});
define("html!SBIS3.EDO.Statistics.ColumnsTemplate.PeriodResultRender",function(){var e=function(e){var n=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;e.test(n);)n=n.replace(e,"&#123;&#123;$1&#125;&#125;");return n}}(),o=function(e){return e.join?e.join(""):e.toString()},t=function(e){return void 0===e?"":e&&"object"==typeof e?o(e):""+e},i="undefined"!=typeof process,r=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,""),a=e.column.field,l=a&&-1!==a.indexOf("Просрочено"),u=e.item.get(a),p=(0!==u&&"0"!==u?u:"")?"phase-report-link":"";return l&&(p+=" edo-statistics-overdue-count"),r+=' <component data-component="SBIS3.CONTROLS/Link" class="'+n(t(p))+'" style="text-align:right;"> <option name="caption">',0!==u&&(r+=n(t(u))),r+='</option> <options name="componentOptions"> <option name="columnId" value="'+n(t(e.column.templateBinding.columnId))+'"></option> <option name="columnField" value="'+n(t(e.column.field))+'"></option> <option name="isOverdue" value="'+n(t(e.column.templateBinding.isOverdue))+'"></option> <option name="filterName" value="'+n(t(e.column.templateBinding.filterName))+'"></option> <option name="isPeriodReport" value="true"></option> </options> <options name="handlers"> <option name="onActivated" type="function">js!SBIS3.EDO.InnerStat:onActivateResult</option> </options> </component> ',(r=n(r))+(i&&-1!==r.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.Statistics.ColumnsTemplate.PeriodResultRender"}},e});
define('js!SBIS3.EDO.Statistics.ColumnsTemplate.PeriodResultRender',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.Statistics.ColumnsTemplate.PeriodResultRender','html!SBIS3.PersonCore.Photo/photoCellTpl','js!SBIS3.EDO.InnerStat','css!SBIS3.EDO.InnerStat','SBIS3.CONTROLS/Link','Elektronnyj_dokumentooborot_localization'],function(t,e){'use strict';var n=t.extend({_dotTplFn:e,$protected:{_options:{name:'Statistics.ColumnsTemplate.PeriodResultRender'}},$constructor:function(){},init:function(){var t=this;n.superclass.init.call(t);}});return n;});
define("html!SBIS3.EDO.Statistics.ColumnsTemplate.CaptionRender",function(){var n=function(n){var e=function(){var n=/\{\{([\s\S]+?)\}\}/g;return function(e){for(;n.test(e);)e=e.replace(n,"&#123;&#123;$1&#125;&#125;");return e}}(),o=function(n){return n.join?n.join(""):n.toString()},t=function(n){return void 0===n?"":n&&"object"==typeof n?o(n):""+n},i="undefined"!=typeof process,l=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,""),a="Просрочено"==n.column.field,r=!!n.column.templateBinding.isOverdue,m=a?"":"Итого"==n.column.field?rk("Всего"):n.column.title,c="Просрочено"==n.column.field?"Нарушен срок":m,u="Просрочено"==n.column.field?"edo-statistics-overdue-count icon-16 icon-Time icon-disabled":"regulation-caption",p=(n.column.nextReportName,!!n.column.templateBinding.filter["ФильтрСрокДата"]);n.column.field;return l+=" ",0!=a||!1===r&&c!==rk("Всего")&&c!==rk("Получено")&&!p||(l+=' <component data-component="SBIS3.CONTROLS/Link" class="'+e(t(u))+'" style="font-size:12px;"> <option name="caption">'+e(t(m))+'</option> <options name="componentOptions"> <option name="columnId" value="'+e(t(n.column.templateBinding.columnId))+'"></option> <option name="columnField" value="'+e(t(n.column.field))+'"></option> <option name="nextReportName" value="'+e(t(n.column.templateBinding.nextReportName))+'"></option> <option name="filterName" value="'+e(t(n.column.templateBinding.filterName))+'"></option> </options> <options name="handlers"> <option name="onActivated" type="function">js!SBIS3.EDO.InnerStat:onActivateColumnCaption</option> </options> </component> '),l+=" ",a&&(l+=' <div title="'+e(t(rk("Нарушен срок")))+'" style="margin-top: 3px;float: right;" class="icon-16 icon-Time icon-disabled edo-statistics-overdue-count"></div> '),l+=" ",(l=e(l))+(i&&-1!==l.indexOf("{{")?String.fromCharCode(8203,8203):"")};return n.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.Statistics.ColumnsTemplate.CaptionRender"}},n});
define('js!SBIS3.EDO.Statistics.ColumnsTemplate.CaptionRender',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.Statistics.ColumnsTemplate.CaptionRender','html!SBIS3.PersonCore.Photo/photoCellTpl','css!SBIS3.EDO.InnerStat','SBIS3.CONTROLS/Link','js!SBIS3.EDO.InnerStat','Elektronnyj_dokumentooborot_localization'],function(t,n){'use strict';var e=t.extend({_dotTplFn:n,$protected:{_options:{name:'Statistics.ColumnsTemplate.CaptionRender'}},$constructor:function(){},init:function(){var t=this;e.superclass.init.call(t);}});return e;});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.StatisticsReportByPhase", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode("tbody .phase-report-total-right-border,thead .phase-report-total-right-border{border-right:1px solid #eaeaea!important}.phase-report-total-right-border .cut-column-caption{padding-right:1px!important}.phase-report-hierarchy-view .ws-browser-header-cell{text-align:right}.phase-report-hierarchy-view .ws-browser-header-cell div.one-transition-caption,.phase-report-hierarchy-view .ws-browser-header-cell div.one-transition-caption div{display:block}.phase-report-hierarchy-view .ws-browser-header-cell div.many-transition-caption{display:inline!important}.ws-browser-cell.phase-report-fix-font-weight{font-weight:400}.cut-column-caption{overflow:hidden;text-overflow:ellipsis;vertical-align:bottom}.cut-column-caption:hover{color:#ff7033!important}.phase-report-count,.phase-report-separator{color:#000}.phase-report-overdue{color:#000}.phase-report-total-comment{text-align:right;font-weight:400}.phase-report-button-reload{position:absolute;top:3px;left:0}.ws-browser-table-row .phase-report-performer div{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;cursor:pointer!important}.phase-report-hierarchy-view{max-width:100%!important}.phase-report-cut-div div{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.phase-report-hierarchy-view .ws-browser-head-scroller.phase-report-magic-head{height:20px;overflow:visible}.phase-report-hierarchy-view .ws-browser-cell{cursor:default!important}.phase-report-hierarchy-view .ws-browser-results{background-color:rgba(0,0,0,0)}.phase-report-hierarchy-view .ws-browser-container-wrapper-zebra{border-top:0}.phase-report-hierarchy-view .ws-browser-results-block{border-bottom:1px solid #eaeaea}.phase-report-latetime-header-cell{color:#000;padding-top:2px;font-weight:400;margin-right:3px}.phase-report-hierarchy-view .cell-inline{display:inline-block!important}.phase-report-hierarchy-view .result-value{height:16px;padding:0 4px}.phase-report-hierarchy-view .result-title{position:absolute;color:#999;font-weight:400;right:0;height:16px;font-size:11px;top:2px}.phase-report-hierarchy-view .result-title-container{position:relative;height:16px;vertical-align:middle}.phase-report-hierarchy-view .result-title-container2{position:relative;padding-bottom:5px;padding-top:0;height:20px}.phase-report-hierarchy-view .result-title-container2 div{vertical-align:middle}.phase-report-hierarchy-view .result-title-icon{position:relative;float:right;margin-right:72px;top:2px}.phase-report-hierarchy-view .phase-report-total-row{vertical-align:bottom}.phase-report-hierarchy-view span.many-transition{cursor:pointer!important;vertical-align:top}.phase-report-hierarchy-view span.many-transition span.cut-column-caption:hover{text-decoration:underline!important}.phase-report-hierarchy-view .ws-browser-head{border-collapse:separate!important}.hiddenBrowser{visibility:hidden}.showBrowser{visibility:visible}.bottom-caption{vertical-align:bottom}.edo-StatisticsReport .lvl1.controls-TreeView__expand.controls-TreeView__expand__leaf{width:0;margin:0}.edo-StatisticsReport .lvl1.controls-TreeView__expand.has-child{margin-right:17px;margin-left:12px}"));head.appendChild(style);});}
define("html!SBIS3.EDO.StatTemplateNew/BrowserTemplate",function(){var o=function(o){var n=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;o.test(n);)n=n.replace(o,"&#123;&#123;$1&#125;&#125;");return n}}(),e=function(o){return o.join?o.join(""):o.toString()},t=function(o){return void 0===o?"":o&&"object"==typeof o?e(o):""+o},i="undefined"!=typeof process,r=("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),a=function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,p='<div style="height:100%" class="edo-BrowserWrapper"> <component data-component="SBIS3.CONTROLS/ScrollContainer" style="height:100%" class="controls-ScrollContainer-flex"> <option name="stickyContainer">true</option> <option name="content"> <component data-component="';if(o.browserOptions.hierarchy.allow?p+="SBIS3.CONTROLS/Tree/CompositeView":p+="SBIS3.CONTROLS/CompositeView",p+='" name="browserView" class="controls-DataGridView__hasSeparator"> <option name="stickyHeader">'+n(t(o.browserOptions.stickyHeader))+'</option> <option name="viewMode">'+n(t(o.browserOptions.viewMode))+'</option> <option name="allowChangeEnable">'+n(t(o.browserOptions.allowChangeEnable))+'</option> <option name="filter" bind="'+n(t(o.browserOptions.bind))+'"></option> <option name="showPaging" type="boolean">false</option> <option name="showHead">'+n(t(o.browserOptions.showHead))+'</option> <option name="pageSize">null</option> <option name="transformHead">true</option> <option name="editArrow">false</option> <option name="paging">false</option> <option name="startScrollColumn">1</option> <option name="infiniteScrollContainer">.controls-ScrollContainer</option> <option name="multiselect">'+n(t(o.browserOptions.multiselect))+'</option> <option name="resultsPosition">'+n(t(o.browserOptions.resultsPosition))+'</option> <option name="resultsText">'+n(t(o.browserOptions.resultsText))+'</option> <option name="infiniteScroll">false</option> <option name="idProperty">'+n(t(o.browserOptions.idProperty))+'</option> <option name="highlightEnabled">'+n(t(o.browserOptions.highlightEnabled))+'</option> <option name="allowEmptySelection">'+n(t(o.browserOptions.allowEmptySelection))+'</option> <option name="emptyHTML">'+n(t(o.browserOptions.emptyHTML))+'</option> <option name="ignoreLocalPageSize">false</option> <option name="itemsDragNDrop">'+n(t(o.browserOptions.itemsDragNDrop))+"</option> ",o.browserOptions.tileTemplate&&(p+=' <option name="tileTemplate" type="ref">'+n(t(function(o,n){var e=r.randomId();return o[e]=n,e}(a,o.browserOptions.tileTemplate)))+"</option> "),p+=" ",o.browserOptions.listTemplate&&(p+=' <option name="listTemplate" type="ref">'+n(t(function(o,n){var e=r.randomId();return o[e]=n,e}(a,o.browserOptions.listTemplate)))+"</option> "),p+=" ",o.browserOptions.listFolderTemplate&&(p+=' <option name="listFolderTemplate" type="ref">'+n(t(function(o,n){var e=r.randomId();return o[e]=n,e}(a,o.browserOptions.listFolderTemplate)))+"</option> "),p+=" ",void 0!==o.browserOptions.templateBinding){p+=' <options name="templateBinding"> ';for(var s in o.browserOptions.templateBinding)p+=' <option name="'+n(t(s))+'">'+n(t(o.browserOptions.templateBinding[s]))+"</option> ";p+=" </options> "}if(p+=" ",void 0!==o.browserOptions.includedTemplates){p+=' <options name="includedTemplates"> ';for(var l in o.browserOptions.includedTemplates)p+=' <option name="'+n(t(l))+'">'+n(t(o.browserOptions.includedTemplates[l]))+"</option> ";p+=" </options> "}p+=" ",o.browserOptions.hierarchy.allow&&(p+=' <option name="parentProperty">'+n(t(o.browserOptions.hierarchy.parentProperty))+'</option> <option name="displayProperty">'+n(t(o.browserOptions.hierarchy.displayProperty))+'</option> <option name="imageField">Image</option> <option name="allowEnterToFolder">true</option> ',o.browserOptions.hierarchy.arrowActivatedHandler&&(p+=' <option name="arrowActivatedHandler" type="ref">'+n(t(function(o,n){var e=r.randomId();return o[e]=n,e}(a,o.browserOptions.hierarchy.arrowActivatedHandler)))+"</option> "),p+=" "),p+=' <option name="editInPlaceEnabled" type="boolean">'+n(t(o.browserOptions.editInPlace.enabled))+'</option> <option name="editInPlaceGetModelFromSource" type="boolean">'+n(t(o.browserOptions.editInPlace.getModelFromSource))+'</option> <option name="editInPlaceMode">'+n(t(o.browserOptions.editInPlace.mode))+'</option> <option name="editInPlaceOnFieldChangeHandler" type="ref">'+n(t(function(o,n){var e=r.randomId();return o[e]=n,e}(a,o.browserOptions.editInPlace.onFieldChangeHandler)))+'</option> <option name="editInPlaceTemplate" type="ref">'+n(t(function(o,n){var e=r.randomId();return o[e]=n,e}(a,o.browserOptions.editInPlace.template)))+'</option> <options name="ladder" type="array"> ';var d=o.browserOptions.ladder;if(d)for(var m=-1,f=d.length-1;m<f;)p+=" <option> "+n(t(_=d[m+=1]))+" </option> ";p+=' </options> <options name="columns" type="array"> ';var c=o.browserOptions.columns;if(c)for(var m=-1,h=c.length-1;m<h;){if(_=c[m+=1],p+=" <options> ",void 0!==_.title&&(p+=' <option name="title" value="'+n(t(_.title))+'"></option> '),p+=" ",void 0!==_.field&&(p+=' <option name="field">'+n(t(_.field))+"</option> "),p+=" ",void 0!==_.cellTemplate&&(p+=' <option name="cellTemplate">'+n(t(_.cellTemplate))+"</option> "),p+=" ",void 0!==_.fixedSize&&(p+=' <option name="fixedSize">'+n(t(_.fixedSize))+"</option> "),p+=" ",void 0!==_.width&&(p+=' <option name="width">'+n(t(_.width))+"</option> "),p+=" ",void 0!==_.highlight&&(p+=' <option name="highlight">'+n(t(_.highlight))+"</option> "),p+=" ",void 0!==_.className&&(p+=' <option name="className">'+n(t(_.className))+"</option> "),p+=" ",void 0!==_.headTemplate&&(p+=' <option name="headTemplate">'+n(t(_.headTemplate))+"</option> "),p+=" ",void 0!==_.resultTemplate&&(p+=' <option name="resultTemplate">'+n(t(_.resultTemplate))+"</option> "),p+=" ",void 0!==_.headTooltip&&(p+=' <option name="headTooltip">'+n(t(_.headTooltip))+"</option> "),p+=" ",void 0!==_.templateBinding){p+=' <options name="templateBinding"> ';for(var s in _.templateBinding)p+=' <option name="'+n(t(s))+'">'+n(t(_.templateBinding[s]))+"</option> ";p+=" </options> "}if(p+=" ",void 0!==_.includedTemplates){p+=' <options name="includedTemplates"> ';for(var l in _.includedTemplates)p+=' <option name="'+n(t(l))+'">'+n(t(_.includedTemplates[l]))+"</option> ";p+=" </options> "}p+=" </options> "}p+=' </options> <options name="itemsActions" type="array"> ';var v=o.browserOptions.itemsActions;if(v)for(var m=-1,w=v.length-1;m<w;)p+=" <options> ",void 0!==(_=v[m+=1]).name&&(p+=' <option name="name">'+n(t(_.name))+"</option> "),p+=" ",void 0!==_.icon&&(p+=' <option name="icon">'+n(t(_.icon))+"</option> "),p+=" ",void 0!==_.caption&&(p+=' <option name="caption">'+n(t(_.caption))+"</option> "),p+=" ",void 0!==_.tooltip&&(p+=' <option name="tooltip">'+n(t(_.tooltip))+"</option> "),p+=" ",void 0!==_.isMainAction&&(p+=' <option name="isMainAction">'+n(t(_.isMainAction))+"</option> "),p+=" ",void 0!==_.onActivated&&(p+=' <option name="onActivated" type="ref">'+n(t(function(o,n){var e=r.randomId();return o[e]=n,e}(a,_.onActivated)))+"</option> "),p+=" </options> ";if(p+=' </options> <options name="handlers"> ',o.browserOptions.handlers.onInit){p+=' <options name="onInit" type="array"> ';var u=o.browserOptions.handlers.onInit;if(u)for(var m=-1,y=u.length-1;m<y;)p+=' <option type="ref">'+n(t(function(o,n){var e=r.randomId();return o[e]=n,e}(a,_=u[m+=1])))+"</option> ";p+=" </options> "}if(p+=" ",o.browserOptions.handlers.onReady){p+=' <options name="onReady" type="array"> ';var b=o.browserOptions.handlers.onReady;if(b)for(var m=-1,O=b.length-1;m<O;)p+=' <option type="ref">'+n(t(function(o,n){var e=r.randomId();return o[e]=n,e}(a,_=b[m+=1])))+"</option> ";p+=" </options> "}if(p+=" ",o.browserOptions.handlers.onDrawItems){p+=' <options name="onDrawItems" type="array"> ';var g=o.browserOptions.handlers.onDrawItems;if(g)for(var m=-1,I=g.length-1;m<I;)p+=' <option type="ref">'+n(t(function(o,n){var e=r.randomId();return o[e]=n,e}(a,_=g[m+=1])))+"</option> ";p+=" </options> "}if(p+=" ",o.browserOptions.handlers.onBeforeDataLoad){p+=' <options name="onBeforeDataLoad" type="array"> ';var T=o.browserOptions.handlers.onBeforeDataLoad;if(T)for(var m=-1,S=T.length-1;m<S;)p+=' <option type="ref">'+n(t(function(o,n){var e=r.randomId();return o[e]=n,e}(a,_=T[m+=1])))+"</option> ";p+=" </options> "}if(p+=" ",o.browserOptions.handlers.onDataLoad){p+=' <options name="onDataLoad" type="array"> ';var B=o.browserOptions.handlers.onDataLoad;if(B)for(var m=-1,C=B.length-1;m<C;)p+=' <option type="ref">'+n(t(function(o,n){var e=r.randomId();return o[e]=n,e}(a,_=B[m+=1])))+"</option> ";p+=" </options> "}if(p+=" ",o.browserOptions.handlers.onDataLoadError){p+=' <options name="onDataLoadError" type="array"> ';var D=o.browserOptions.handlers.onDataLoadError;if(D)for(var m=-1,P=D.length-1;m<P;)p+=' <option type="ref">'+n(t(function(o,n){var e=r.randomId();return o[e]=n,e}(a,_=D[m+=1])))+"</option> ";p+=" </options> "}if(p+=" ",o.browserOptions.handlers.onChangeHoveredItem){p+=' <options name="onChangeHoveredItem" type="array"> ';var L=o.browserOptions.handlers.onChangeHoveredItem;if(L)for(var m=-1,H=L.length-1;m<H;)p+=' <option type="ref">'+n(t(function(o,n){var e=r.randomId();return o[e]=n,e}(a,_=L[m+=1])))+"</option> ";p+=" </options> "}if(p+=" ",o.browserOptions.handlers.onItemClick){p+=' <options name="onItemClick" type="array"> ';var A=o.browserOptions.handlers.onItemClick;if(A)for(var m=-1,E=A.length-1;m<E;)p+=' <option type="ref">'+n(t(function(o,n){var e=r.randomId();return o[e]=n,e}(a,_=A[m+=1])))+"</option> ";p+=" </options> "}if(p+=" ",o.browserOptions.handlers.onItemsReady){p+=' <options name="onItemsReady" type="array"> ';var M=o.browserOptions.handlers.onItemsReady;if(M)for(var m=-1,F=M.length-1;m<F;)p+=' <option type="ref">'+n(t(function(o,n){var e=r.randomId();return o[e]=n,e}(a,_=M[m+=1])))+"</option> ";p+=" </options> "}if(p+=" ",o.browserOptions.handlers.onAfterLoad){p+=' <options name="onAfterLoad" type="array"> ';var R=o.browserOptions.handlers.onAfterLoad;if(R)for(var m=-1,N=R.length-1;m<N;)p+=' <option type="ref">'+n(t(function(o,n){var e=r.randomId();return o[e]=n,e}(a,_=R[m+=1])))+"</option> ";p+=" </options> "}if(p+=" ",o.browserOptions.handlers.onPrepareFilterOnMove){p+=' <options name="onPrepareFilterOnMove" type="array"> ';var x=o.browserOptions.handlers.onPrepareFilterOnMove;if(x)for(var m=-1,k=x.length-1;m<k;)p+=' <option type="ref">'+n(t(function(o,n){var e=r.randomId();return o[e]=n,e}(a,_=x[m+=1])))+"</option> ";p+=" </options> "}if(p+=" ",o.browserOptions.handlers.onBeforeDataLoad){p+=' <options name="onBeforeDataLoad" type="array"> ';var z=o.browserOptions.handlers.onBeforeDataLoad;if(z)for(var m=-1,V=z.length-1;m<V;)p+=' <option type="ref">'+n(t(function(o,n){var e=r.randomId();return o[e]=n,e}(a,_=z[m+=1])))+"</option> ";p+=" </options> "}if(p+=" ",o.browserOptions.handlers.onBeforeSetRoot){p+=' <options name="onBeforeSetRoot" type="array"> ';var j=o.browserOptions.handlers.onBeforeSetRoot;if(j)for(var _,m=-1,$=j.length-1;m<$;)p+=' <option type="ref">'+n(t(function(o,n){var e=r.randomId();return o[e]=n,e}(a,_=j[m+=1])))+"</option> ";p+=" </options> "}return p+=" </options> </component> </option> </component> </div>",(p=n(p))+(i&&-1!==p.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.StatTemplateNew/BrowserTemplate"}},o});
define('js!SBIS3.EDO.StatEDOBrowser',['js!SBIS3.EDO2.Browser','html!SBIS3.EDO.StatTemplateNew/BrowserTemplate','SBIS3.CONTROLS/ScrollContainer','Elektronnyj_dokumentooborot_localization'],function(e,t){var r=e.extend({$protected:{_options:{contentTpl:t}}});return r.title='Title',r.dimensions={autoWidth:true,autoHeight:true,resizable:false},r;});
define("tmpl!SBIS3.EDO.StatEDOBrowserPP/resources/tplFilterIdRegulations",["Core/tmpl/js/tclosure"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={},i=function e(i,o,l,n,a){function s(){}var u=0,c=void 0!==t&&t?t:arguments[arguments.length-1];void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure"));var d={};a&&a.isSetts&&(d=a.fullContext||{});var p="string"==typeof l?l:"",v=void 0===r?void 0:r,f={id:[],def:void 0},m=c.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,i),g=this&&this.includedTemplates?this.includedTemplates:{},S=c.getMarkupGenerator(n);try{var y=S.joinElements([c.getter(i,["resetCaption"])?[S.createTag("div",{style:"display:inline;",class:"filterLine__itemTemplate"},[S.createText(""+c.wrapUndef(c.utils.escape(c.getter(i,["resetCaption"]))))],{},f,this)]:S.createText("")],p,f);f.def&&(y=S.chain(y,f,o),f=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/Statistika/StatTemplateNew/StatEdoBrowserPP/resources/tplFilterIdRegulations.tmpl",e,i)}return y||""};return i.includedFunctions={},i.stable=!0,i.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.StatEDOBrowserPP/resources/tplFilterIdRegulations"}},i});
define('js!SBIS3.EDO.PeriodStatReportNew',['Core/core-functions','Core/helpers/string-helpers-min','SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.PeriodStatReportNew','WS.Data/Source/SbisService','js!SBIS3.EDO.InnerStat','js!SBIS3.EDO.StatFuncs','js!SBIS3.EDO.Photo','js!SBIS3.EDO.Statistics.ColumnsTemplate.PeriodDataCell','tmpl!SBIS3.EDO.StatEDOBrowserPP/resources/TitleCell','js!SBIS3.EDO.Statistics.ColumnsTemplate.PeriodResultRender','js!SBIS3.EDO.Statistics.ColumnsTemplate.CaptionRender','js!SBIS3.EDO.FilterPeriodStatReportNew','js!SBIS3.EDO.FilterPeriodStatReportNewSelector','css!SBIS3.EDO.StatisticsReportByPhase','i18n!SBIS3.EDO.PeriodStatReportNew','js!SBIS3.EDO.StatEDOBrowser','html!SBIS3.EDO.DetalizationEvents/tplFilterDatePeriod','tmpl!SBIS3.EDO.StatEDOBrowserPP/resources/tplFilterIdRegulations','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterIdRegulations','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterListDispatch','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterMilestone','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterAuthor','tmpl!SBIS3.EDO2.MarksFilterRowTemplate/tmpl/MarksFilterRowTemplate','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterFace1','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterResp','Elektronnyj_dokumentooborot_localization'],function(t,e,r,s,l,o,a){var n=r.extend({_dotTplFn:s,_self:void 0,$protected:{_options:{autoHeight:true,autoWidth:true,statisticsType:null}},_modifyOptions:function(t){var i,r='';if(r+='<option name="docType" value="'+(t=n.superclass._modifyOptions.call(this,t)).docType+'"></option>',r+='<option name="docSubType" value="'+t.docSubType+'"></option>',t.initialFilters['ФильтрТипыДокументов'])r+='<option name="docTypes" value="'+t.initialFilters['ФильтрТипыДокументов']+'"></option>';if(!a.isEmptyObject(t['customizeFilters'])){var s='<options name="customizeFilters">';for(var l in t['customizeFilters'])if(t['customizeFilters'].hasOwnProperty(l))s+='<option name="'+l+'" value="'+t['customizeFilters'][l]+'"></option>';r+=s+='</options>';}return t['resetLinkText']=rk('За последний месяц')+(t['resetLinkText']?', '+t['resetLinkText']:''),t['historyId']='PeriodStatReport'+t.statisticsType.toUpperCase()+e.transliterate(t.docType),t['filterComponentOptions']=r,t['filterStructure']=o.getStatisticsFilterStructure(t.initialFilters),t;},$constructor:function(){},init:function(){var t=this,e=t._options,i=t.getParent().getLinkedContext();n.superclass.init.call(this),n._self=this;var r=t.getChildControlByName('PeriodStatReportNewBrowser'),s=r._getView(),p=r._getFilterButton();s._options.enabledMove=false,s&&s.setItemsSortMethod&&s.setItemsSortMethod(a.statReportItemsSortMethod),o.synchStatFilters(t,r,i),s.initial_columns=s.getColumns();var S=new l({endpoint:t._options.docType,binding:{read:'Прочитать',query:'СтатистикаСобытияЗаПериод',format:t._options.docType+'.СтатистикаСобытияЗаПериод'}});s.setDataSource(S),p.subscribe('onApplyFilter',function(t){for(var i=s.getFilter(),r=this.getFilterStructure(),l=0;l<r.length;l++)if(r.hasOwnProperty(l))if(r[l]['filterBLName'])i[r[l]['filterBLName']+'Текст']=r[l].caption,i[r[l]['filterBLName']]=r[l].value;delete(i=jQuery.extend(i,e.initialFilters))['ФильтрСортировкаКолонок'],i['ФильтрНеСохранятьСортировку']=true,s.setFilter(i);}),p.subscribe('onResetFilter',function(t,i){if(!i){for(var r=s.getFilter(),l=this.getFilterStructure(),o=0;o<l.length;o++)if(l.hasOwnProperty(o))if(l[o]['filterBLName'])r[l[o]['filterBLName']]=l[o].value,r[l[o]['filterBLName']+'Текст']=l[o].caption;delete(r=jQuery.extend(r,e.initialFilters))['ФильтрСортировкаКолонок'],r['ФильтрНеСохранятьСортировку']=true,s.setFilter(r);}});},onDataLoad:function(e,r){var s=this,l=t.clone(s.initial_columns),o=s.getFilter(),p=r.getMetaData().results,S,u=r.getFormat()._$items||[],m=r.getMetaData().path,c=m.getCount()>0?m.at(m.getCount()-1).get('Идентификатор'):null;for(s.setCurrentRoot(c),a.saveLastStatisticsFilter(o,n._self.getParent().historyStorage),i=2;i<9;i++)if(u.hasOwnProperty(i)){var d=u[i]._$name,h='НаНачало'===d.replace('Просрочено','')?rk('На начало'):rk(d.replace('Просрочено','')),F=Math.floor(a.columnWidth(h)/2),f=-1!==d.indexOf('Просрочено')?true:false,S=p.has(u[i]._$name)?p.get(u[i]._$name):null;if(F=Math.max(F,12*S.toString().length,65),!o['ФильтрСрокДата']||!f)l.push(n.prototype._makeColumn(d,o,h,F,f,false,h));}s.isOther=false,s.setColumns(l),this.getFilter()['ФильтрСортировкаКолонок']=this.reglaments;},_makeColumn:function(t,e,i,r,s,l,o){return{field:t,title:i,highlight:true,width:e['ФильтрСрокДата']&&'Получено'!==t?2*r:r,verticalAlign:'bottom',className:'phase-report-fix-font-weight '+(s?'':'phase-report-total-right-border')+(!s?'':'edo_stat_report_caption_border'),resultTemplate:'html!SBIS3.EDO.Statistics.ColumnsTemplate.PeriodResultRender',cellTemplate:'html!SBIS3.EDO.Statistics.ColumnsTemplate.PeriodDataCell',headTemplate:'html!SBIS3.EDO.Statistics.ColumnsTemplate.CaptionRender',templateBinding:{isOverdue:s,fieldName:t,isTotal:l,nextReportName:'StatisticsInnerCurrent',filterName:'ФильтрСтатистикаПериод',columnId:o,filter:e}};}});return n.title='Задачи->Все->Статистика',n;});
define("html!SBIS3.EDO.FilterReportStatResult",function(){var o=function(o){var t=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;o.test(t);)t=t.replace(o,"&#123;&#123;$1&#125;&#125;");return t}}(),e=function(o){return o.join?o.join(""):o.toString()},n=function(o){return void 0===o?"":o&&"object"==typeof o?e(o):""+o},i="undefined"!=typeof process,r=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div> <component data-component="SBIS3.EDO.EDOFilter" name="ФильтрЭДОСтатистика"> <options name="rightsLim"> <option name="show">true</option> <option name="textRender" type="function">js!SBIS3.EDO.ScopeFilters:setScopeTextForFilter</option> </options> <options name="filtersCustom"> ');return o.FilterPassageStatus&&(r+=' <option name="templateTop">js!SBIS3.EDO.FilterPassageStatus</option> '),r+=' <option name="templateBottom">js!SBIS3.EDO.FilterRepeatStages</option> </options> <option name="filterDataPeriodLimited">true</option> <options name="filtersEDO"> <options name="FilterFace1"> <option name="show">true</option> </options> <options name="FilterIDRegulations"> <option name="show">true</option> <option name="hidePhase">true</option> </options> <options name="FilterLimitationDate"> <option name="show">true</option> </options> <options name="FilterResponsibleFace"> <option name="show">true</option> </options> <options name="FilterAuthorOrResponsibleMe"> <option name="show">true</option> </options> <options name="FilterListDispatch"> <option name="show">'+t(n(o.hideListPerformer))+'</option> </options> <options name="FilterPriority"> <option name="show">'+t(n(o.showFilterPriority))+'</option> </options> <options name="FilterMilestone"> <option name="show">true</option> </options> </options> </component> </div>',(r=t(r))+(i&&-1!==r.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.FilterReportStatResult"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.FilterReportStatResult", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(""));head.appendChild(style);});}
define('js!SBIS3.EDO.FilterReportStatResult',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.FilterReportStatResult','js!SBIS3.EDO.StatFuncs','css!SBIS3.EDO.FilterReportStatResult','js!SBIS3.EDO.EDOFilter','js!SBIS3.EDO.ScopeFilters','Elektronnyj_dokumentooborot_localization'],function(t,e,s){var r=true,i=t.extend({_dotTplFn:e,$protected:{_options:{autoHeight:true,autoWidth:true,datePeriodLimited:r?false:true,hideListPerformer:r?false:true,showFilterPriority:r?false:true,FilterPassageStatus:false}},$constructor:function(){},_modifyOptions:function(t){t=i.superclass._modifyOptions.call(this,t);var e=this.getTopParent(),r=e&&e.getOpener(),o=r&&r.getParentByClass('SBIS3.EDO.StatTemplate'),a=o&&o._options;if(true===s.customizeFiltersToObject(a&&a['customizeFilters']||{})['ФильтрСтатусПерехода'])t['FilterPassageStatus']=true;return t;},init:function(){i.superclass.init.call(this);}});return i;});
define("html!SBIS3.EDO.ReportStatResult",function(){var o=function(o){var t=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;o.test(t);)t=t.replace(o,"&#123;&#123;$1&#125;&#125;");return t}}(),n="undefined"!=typeof process,e=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div> <component data-component="SBIS3.EDO.FilterController" name="ПанельСФильтромСтат"> <option name="filterLine" type="function" value="js!SBIS3.EDO.FastFilters:filterViewLineRender"></option> <options name="filters"> <options name="ФильтрСтатистикаПериод"> <option name="defaultValue">Период</option> <options name="value"> <option name="fieldName" value="ФильтрСтатистикаПериод"></option> </options> </options> </options> <option name="mode" value="hover"></option> <option name="template" value="js!SBIS3.EDO.FilterReportStatResult"></option> <options name="filterButtonHandlers"> <options name="onChange" type="array"> <option type="function" value="js!SBIS3.EDO.Filters:onFilterReestrChange"></option> </options> <options name="onSetQuery" type="array"> <option type="function">js!SBIS3.EDO.ReportStatResult:prototype.onSetQuery</option> <option type="function" value="js!SBIS3.EDO.Filters:onSetQueryBrowser"></option> <option type="function" value="js!SBIS3.EDO.Filters:saveFilterIntoContext"></option> </options> <option name="onBeforeShow" type="function" value="js!SBIS3.EDO.FilterHandlers:onBeforeShowPhaseFilter"></option> </options> <options name="pathFilterHandlers"> <option name="onVisualizeFilter" type="function" value="js!SBIS3.EDO.FastFilters:onVisualizeFilter"></option> <option name="onCreatePoint" type="function" value="js!SBIS3.EDO.FastFilters:onCreatePointInnerStat"></option> <option name="onFilterChange" type="function" value="js!SBIS3.EDO.FastFilters:onChangeFastFilterInner"></option> </options> </component> <component data-component="Deprecated/Controls/HierarchyView/HierarchyView" name="ReportStatResultBrowser" style="width:auto;height:auto;" class="regl-report-hierarchy-view statistics-browser"> <options name="dataSource"> <options name="readerParams"> <option name="nameApplication">Основной сервис</option> <option name="nameService">Основной сервис</option> <option name="queryName" value="СтатистикаСобытияРезультатПерехода"></option> <option name="createMethodName" value="Создать"></option> <option name="updateMethodName" value="Записать"></option> <option name="readMethodName" value="Прочитать"></option> <option name="destroyMethodName" value="Удалить"></option> <option name="linkedObject">Документ</option> <option name="format" value=""></option> </options> <option name="firstRequest">false</option> </options> <option name="autoHeight">true</option> <options name="display"> <option name="partiallyLoad" value="true"></option> <options name="columns" type="array"> <options> <option name="className" value="phase-report-performer"></option> <option name="title" value=""></option> <option name="field">Название</option> <option name="width">200</option> <option name="isResultField">false</option> <option name="fixedSize">false</option> <option name="render" type="function" value="js!SBIS3.EDO.InnerStat:renderTitleColumn"></option> </options> <options> <option name="field">ИтогоПросрочено</option> <option name="width">53</option> <option name="fixedSize">true</option> <option name="isResultField">true</option> <option name="isSortable">false</option> <option name="useForFolder">true</option> <option name="captionAlign">right</option> <option name="render" type="function">js!SBIS3.EDO.ReportStatResult:prototype.statColumnsRender</option> <option name="verticalAlign">bottom</option> </options> <options> <option name="title">Итого</option> <option name="field">Итого</option> <option name="width">53</option> <option name="fixedSize">true</option> <option name="isResultField">true</option> <option name="isSortable">false</option> <option name="useForFolder">true</option> <option name="captionAlign">right</option> <option name="className">phase-report-total-right-border</option> <option name="render" type="function">js!SBIS3.EDO.ReportStatResult:prototype.statColumnsRender</option> <option name="verticalAlign">bottom</option> </options> <options> <option name="title">Положительно</option> <option name="field">ПоложительноПроср</option> <option name="width">80</option> <option name="fixedSize">true</option> <option name="isResultField">true</option> <option name="isSortable">false</option> <option name="useForFolder">true</option> <option name="captionAlign">right</option> <option name="render" type="function">js!SBIS3.EDO.ReportStatResult:prototype.statColumnsRender</option> <option name="verticalAlign">bottom</option> </options> <options> <option name="title">Положительно</option> <option name="field">Положительно</option> <option name="width">53</option> <option name="fixedSize">true</option> <option name="isResultField">true</option> <option name="isSortable">false</option> <option name="useForFolder">true</option> <option name="captionAlign">right</option> <option name="className">phase-report-total-right-border</option> <option name="render" type="function">js!SBIS3.EDO.ReportStatResult:prototype.statColumnsRender</option> <option name="verticalAlign">bottom</option> </options> <options> <option name="title">Отрицательно</option> <option name="field">ОтрицательноПроср</option> <option name="width">53</option> <option name="fixedSize">true</option> <option name="isResultField">true</option> <option name="isSortable">false</option> <option name="useForFolder">true</option> <option name="captionAlign">right</option> <option name="render" type="function">js!SBIS3.EDO.ReportStatResult:prototype.statColumnsRender</option> <option name="verticalAlign">bottom</option> </options> <options> <option name="title">Отрицательно</option> <option name="field">Отрицательно</option> <option name="width">53</option> <option name="fixedSize">true</option> <option name="isResultField">true</option> <option name="isSortable">false</option> <option name="useForFolder">true</option> <option name="captionAlign">right</option> <option name="render" type="function">js!SBIS3.EDO.ReportStatResult:prototype.statColumnsRender</option> <option name="verticalAlign">bottom</option> </options> </options> <option name="alwaysDisplayResults">true</option> <option name="resultText" value=""></option> <option name="resultType">foldersAndLeaves</option> <option name="resultsRender" type="function">js!SBIS3.EDO.ReportStatResult:prototype.resultsRender</option> <option name="rootName" value=""></option> <option name="rowRender" type="function">js!SBIS3.EDO.ReportStatResult:prototype.rowRender</option> <option name="headColumnRender" type="function">js!SBIS3.EDO.ReportStatResult:prototype.headColumnRender</option> </options> <options name="filterParams"> <options name="ТипДокумента"> <option name="saveToState">false</option> <option name="fieldName">ТипДокумента</option> </options> <options name="ФильтрДатаПериод"> <option name="saveToState">false</option> <option name="fieldName">ФильтрДатаПериод</option> </options> <options name="ФильтрДатаС"> <option name="saveToState">false</option> <option name="fieldName">ФильтрДатаС</option> </options> <options name="ФильтрЛицо1"> <option name="saveToState">false</option> <option name="fieldName">ФильтрЛицо1</option> </options> <options name="ФильтрДатаП"> <option name="saveToState">false</option> <option name="fieldName">ФильтрДатаП</option> </options> <options name="ФильтрОтветственноеЛицо"> <option name="saveToState">false</option> <option name="fieldName">ФильтрОтветственноеЛицо</option> </options> <options name="ФильтрПоВехе"> <option name="saveToState">false</option> <option name="fieldName">ФильтрПоВехе</option> </options> <options name="ФильтрПоКраткомуСостоянию"> <option name="saveToState">false</option> <option name="fieldName">ФильтрПоКраткомуСостоянию</option> </options> <options name="ФильтрПриоритет"> <option name="saveToState">false</option> <option name="fieldName">ФильтрПриоритет</option> </options> <options name="ФильтрДиапазонДокументов"> <option name="saveToState">false</option> <option name="fieldName">ФильтрДиапазонДокументов</option> </options> <options name="ФильтрСписокРассылки"> <option name="saveToState">false</option> <option name="fieldName">ФильтрСписокРассылки</option> </options> <options name="ФильтрСрокДата"> <option name="saveToState">false</option> <option name="fieldName">ФильтрСрокДата</option> </options> <options name="ФильтрАвторИлиОтвОтдел"> <option name="saveToState">false</option> <option name="fieldName">ФильтрАвторИлиОтвОтдел</option> </options> <options name="ФильтрАвторИлиОтветственный"> <option name="saveToState">false</option> <option name="fieldName">ФильтрАвторИлиОтветственный</option> </options> <options name="ИдРегламента"> <option name="saveToState">false</option> <option name="fieldName">ИдРегламента</option> </options> <options name="ФильтрСтатистикаПериод"> <option name="saveToState">false</option> <option name="fieldName">ФильтрСтатистикаПериод</option> </options> <options name="ФильтрСтатусПерехода"> <option name="saveToState">false</option> <option name="fieldName">ФильтрСтатусПерехода</option> </options> </options> <options name="sumFields"> <option name="НаНачало">НаНачало</option> <option name="НаНачалоПросрочено">НаНачалоПросрочено</option> <option name="Получено">Получено</option> <option name="ПолученоПросрочено">ПолученоПросрочено</option> <option name="Выполнено">Выполнено</option> <option name="ВыполненоПросрочено">ВыполненоПросрочено</option> <option name="Осталось">Осталось</option> <option name="ОсталосьПросрочено">ОсталосьПросрочено</option> </options> <options name="handlers"> <option name="onAfterRender" type="function">js!SBIS3.EDO.ReportStatResult:prototype.onAfterRender</option> <option name="onInit" type="function">js!SBIS3.EDO.ReportStatResult:prototype.onInit</option> <option name="onRowClick" type="function" value="js!SBIS3.EDO.InnerStat:onRowClickStat"></option> <option name="onFolderEnter" type="function" value="js!SBIS3.EDO.InnerStat:onBrowserFolderEnterStat"></option> </options> </component> </div>');return(e=t(e))+(n&&-1!==e.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.ReportStatResult"}},o});
define('js!SBIS3.EDO.ReportStatResult',['Core/helpers/string-helpers','SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.ReportStatResult','js!SBIS3.EDO.InnerStat','js!SBIS3.EDO.StatFuncs','js!SBIS3.EDO.FastFilters','Deprecated/Controls/HierarchyView/HierarchyView','js!SBIS3.EDO.FilterController','js!SBIS3.EDO.Filters','js!SBIS3.EDO.FilterHandlers','css!SBIS3.EDO.StatisticsReportByPhase','Elektronnyj_dokumentooborot_localization'],function(t,e,r,n,i){var s=e.extend({_dotTplFn:r,$protected:{_options:{autoHeight:true,autoWidth:true}},$constructor:function(){},init:function(){s.superclass.init.call(this),this.getChildControlByName('ПанельСФильтромСтат').setLinkedView(this.getChildControlByName('ReportStatResultBrowser'));},renderTitleColumn:function(){return n.renderTitleColumn.apply(this,[].slice.call(arguments).concat([true]));},statColumnsRender:function(t,e){var r=this,n=r.getQuery();return s.prototype.generateAttributedCell(t,e,n,false,r.stringFilter);},generateAttributedCell:function(e,r,s,l,a){var o=jQuery('<span/>'),u=e.get(r),d=false,f=null,g=null,c='';if(!!u){if(o.text(u),o.attr('title',t.escapeHtml(u)),-1!==r.indexOf('Проср')){if(d=true,o.addClass('overdue-stat-count'),g=u,c=r.replace('Просрочено','').replace('Проср',''),f=e.hasColumn(c)?e.get(c):null,s['ФильтрСрокДата'])o.text('');}else f=u,c=r+'Проср',g=e.hasColumn(c)?e.get(c):0;if('Положительно'===r)s['ФильтрРезультатПерехода']=7;if('Отрицательно'===r)s['ФильтрРезультатПерехода']=9;var p=n.generateHrefParams(i.addStringFilter(s,a),e,l,d,s['ИдРегламента'],r,f,g);if(p)if(o.addClass('browser-link'),o.attr('params',p),e.hasColumn('Раздел@')&&e.get('Раздел@'))o.addClass('folder_font');}return o;},rowRender:function(t,e){if(!t.get('Раздел@')&&-1!==t.get('@Лицо'))e.find('.ws-browser-cell-container').css('height','40px');},resultsRender:function(t,e){if(!e)return;for(var r=this,l=r.getColumns(),a,o=r.getQuery(),u=1;u<l.length;u++){var d=$(t.find('td.ws-browser-type-integer')[u-1]).find('div'),f=0;if(e.hasColumn(l[u].field))f=e.get(l[u].field);if(f&&0!==parseInt(f,10)){var g=s.prototype.generateAttributedCell(e,l[u].field,r.getQuery(),true,r.stringFilter);jQuery(d).html(g);}else jQuery(d).empty(),jQuery(d).attr('title','');var c=r.getContainer().find('tr.ws-browser-head-top td[columnid='+u+']'),p=c.find('div'),S=r.getColumns()[u].title,h=r.getColumns()[u].field,C=$('<div class="browser-column-title" title = "'+S+'"> '+S+'</div>');if(c.attr('style','border-right: 1px solid #EAEAEA !important;'),$(C).attr('class','regulation-caption'),'ОтрицательноПроср'!==h)$(C).attr('style','margin-right: 3px;');if(-1!==h.indexOf('Положительно'))o['ФильтрРезультатПерехода']=7;if(-1!==h.indexOf('Отрицательно'))o['ФильтрРезультатПерехода']=9;a=n.generateHrefParams(i.addStringFilter(o,r.stringFilter),e,true,false,o['ИдРегламента'],h,f,f),$(C).attr('params',a),p.html(C);}},headColumnRender:function(t){var e=jQuery('<div/>');if(e.text(t),t)if(e.addClass('browser-column-title'),'На начало'!==t);return e;},onAfterRender:function(t){n.setClickToDetalization(this,'span.browser-link,div.regulation-caption');},onInit:function(t){var e=this,r=e.getQuery(),n=e.getParent().getParent().getLinkedContext(),s=i.getStatFiltersList('js!SBIS3.EDO.ReportStatResult');r['Раздел']=n.getValue('ТекущееПодразделение');for(var l=0;l<s.length;l++)r[s[l]]=n.getValue(s[l]);e.setQuery(r);},onSetQuery:function(t,e){if(!e['ФильтрСтатистикаПериод']||'Выполнено'!==e['ФильтрСтатистикаПериод']||!e['ФильтрСтатистикаПериод']||'По ответственному'!==e['ФильтрРазрезСтатистики'])return i.goToMainInnerStatReport('js!SBIS3.EDO.PeriodStatReport',this.getParent().getParent().getParent(),this.getBrowser(),e),t.setResult(false),false;else if(!e['ИдРегламента'])return i.goToMainInnerStatReport(null,this.getParent().getParent().getParent(),this.getBrowser()),t.setResult(false),false;}});return s.title='Задачи->Все->Статистика',s;});
define("html!SBIS3.EDO.StatInternalReport",function(){var o=function(o){var t=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;o.test(t);)t=t.replace(o,"&#123;&#123;$1&#125;&#125;");return t}}(),n=function(o){return o.join?o.join(""):o.toString()},e=function(o){return void 0===o?"":o&&"object"==typeof o?n(o):""+o},a="undefined"!=typeof process,i=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,""),p=o.withoutFilterButton?"":'<option name="onInit" type="function">js!SBIS3.EDO.StatisticsEDOHandlers:setStatFilterBrowser</option>';return i+=' <div> <component data-component="Deprecated/Controls/TemplatedArea/TemplatedArea" style="width:100px;height:100px;display:'+t(e(o.withoutFilterButton?"none":"block"))+'" name="FilterStatTemplatedArea"> <option name="template">js!SBIS3.EDO.TemplateMainStatFilter</option> </component> <component data-component="Deprecated/Controls/TableView/TableView" name="StatInternalReport" style="width:500px;height:auto;" class="internal_stat statistics-browser"> <options name="display"> <options name="columns" type="array"> <options> <option name="field">Всего</option> <option name="title" value=""></option> <option name="width" type="string">400</option> <option name="render" type="function">js!SBIS3.EDO.StatInternalReport:prototype.drawTotalColumnInternalStat</option> </options> </options> <option name="usePageSizeSelect">false</option> <option name="showPaging">false</option> <option name="pagesLeftRight">3</option> <option name="showRecordsCount">false</option> <option name="hasZebra">false</option> <option name="showHead">false</option> </options> <option name="autoHeight">true</option> <option name="autoWidth">true</option> <options name="dataSource"> <options name="readerParams"> <option name="linkedObject" value="Документ"></option> <option name="queryName" value="СтатистикаВнутренних"></option> <option name="createMethodName" value="Создать"></option> <option name="format" value="Документ.С"></option> <option name="updateMethodName" value="Записать"></option> <option name="readMethodName" value="Прочитать"></option> <option name="destroyMethodName" value="Удалить"></option> <option name="nameApplication">Основной сервис</option> <option name="nameService">Основной сервис</option> </options> </options> <options name="filterParams"> <options name="ТипДокумента"> <option name="saveToState">false</option> <option name="fieldName">ТипДокумента</option> </options> <options name="ФильтрАвторИлиОтвОтдел"> <option name="saveToState">false</option> <option name="fieldName">ФильтрАвторИлиОтвОтдел</option> </options> <options name="ФильтрАвторИлиОтветственный"> <option name="saveToState">false</option> <option name="fieldName">ФильтрАвторИлиОтветственный</option> </options> <options name="ФильтрВладелец"> <option name="saveToState">false</option> <option name="fieldName">ФильтрВладелец</option> </options> <options name="ФильтрДатаП"> <option name="saveToState">false</option> <option name="fieldName">ФильтрДатаП</option> </options> <options name="ФильтрДатаПериод"> <option name="saveToState">false</option> <option name="fieldName">ФильтрДатаПериод</option> </options> <options name="ФильтрДатаС"> <option name="saveToState">false</option> <option name="fieldName">ФильтрДатаС</option> </options> <options name="ФильтрДокументНашаОрганизация"> <option name="saveToState">false</option> <option name="fieldName">ФильтрДокументНашаОрганизация</option> </options> <options name="ФильтрОтветственноеЛицо"> <option name="saveToState">false</option> <option name="fieldName">ФильтрОтветственноеЛицо</option> </options> <options name="ФильтрСобытий"> <option name="saveToState">false</option> <option name="fieldName">ФильтрСобытий</option> </options> <options name="ФильтрУдаленные"> <option name="saveToState">false</option> <option name="fieldName">ФильтрУдаленные</option> </options> </options> <options name="handlers"> '+t(e(p))+' <options name="onAfterRender" type="array"> <option type="function" value="js!SBIS3.EDO.StatisticsEDOHandlers:renderCommonUnderline"></option> <option type="function" value="js!SBIS3.EDO.StatInternalReport:prototype.onAfterRender"></option> </options> <option name="onPrepareReportData" type="function">js!SBIS3.EDO.StatisticsEDOHandlers:passDataToReport</option> </options> <option name="useSelection">false</option> <option name="setCursorOnLoad">false</option> </component> </div>',(i=t(i))+(a&&-1!==i.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.StatInternalReport"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.StatInternalReport", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".internal_stat .docs_title{font-weight:700}.internal_stat .col_title{padding-left:30px!important;text-align:center;color:grey}.internal_stat .col_title_hidden{visibility:hidden}.internal_stat .docflow_stat tr{height:30px}.internal_stat .docs_count_cap{padding-left:18px!important}.internal_stat .docs_count .asLink,.internal_stat .docs_count_cap .asLink{text-decoration:none!important;color:#000!important}.internal_stat .docs_count .asLink:hover,.internal_stat .docs_count_cap .asLink:hover{text-decoration:underline!important;color:#05b!important}.internal_stat .regl_docs .docs_count_cap{padding-left:36px!important}.internal_stat .regl_docs .docs_count_cap div{max-width:180px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.internal_stat .regl_docs,.internal_stat .regl_docs a{font-size:13px;line-height:18px;color:grey!important;text-align:right}.internal_stat .no_send_docs,.internal_stat .no_send_docs a{color:#000;font-weight:700}.internal_stat .rough_docs,.internal_stat .rough_docs a{font-size:13px;line-height:18px;color:grey!important;text-align:left}.internal_stat .end_docs,.internal_stat .end_docs a{font-size:13px;line-height:18px;text-align:left;color:#000!important}.internal_stat .docs_count{padding-left:30px!important;text-align:right}.internal_stat .docflow_stat_browser .ws-browser tbody tr.ws-browser-table-row td{border:none!important}.internal_stat .docflow_stat_browser .ws-browser.ws-one-click-browser tbody tr{cursor:default!important}.internal_stat .docflow_stat{text-align:left}.internal_stat .docflow_stat table{float:left}.internal_stat .all_docs,.internal_stat .all_docs a{font-weight:700;color:#000}.internal_stat .docs_count .asLink,.internal_stat .docs_count_cap .asLink{text-decoration:none!important;color:#000!important}.internal_stat .docs_count .asLink:hover,.internal_stat .docs_count_cap .asLink:hover{text-decoration:underline!important;color:#05b!important}.internal_stat .ws-browser-cell{cursor:default!important}"));head.appendChild(style);});}
define('js!SBIS3.EDO.StatInternalReport',['Lib/Control/Control','SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.StatInternalReport','js!SBIS3.EDO.StatFuncs','Deprecated/Controls/TableView/TableView','Deprecated/Controls/TableView/plugins/Results-plugin','js!SBIS3.EDO.StatisticsEDOHandlers','js!SBIS3.EDO.FilterController','Deprecated/Controls/TemplatedArea/TemplatedArea','css!SBIS3.EDO.StatInternalReport','Elektronnyj_dokumentooborot_localization'],function(t,e,n,r){function o(t,e,n,r,o,s,a,l){'use strict';this.getName=function(){return''+t;},this.getStateType=function(){return''+e;},this.getCountDocument=function(){return+n;},this.getCountEmployee=function(){return+r;},this.getId=function(){return+o;},this.getCountDocumentOverdue=function(){return+s;},this.getCountEmployeeOverdue=function(){return+a;},this.getPercent=function(){if(0===l)return 0;return Math.round(1000*n/l)/10;},this.changeId=function(t){o=t;};}function s(t,e,n,r,o,s){var a='<a class="common_underline" title="'+n+'" reg_name="'+r+'" params="'+o+'" nextReport="'+s+'">'+t+'</a>',l='<a class="common_underline" title="'+n+'" reg_name="'+r+'" style="color: red !important;" params="'+o+'" nextReport="'+s+'">'+e+'</a>';if(0===e)return a;if(t===e)return l;return a+'&nbsp;/&nbsp;'+l;}var a=e.extend({_dotTplFn:n,$protected:{_options:{withoutFilterButton:false}},$constructor:function(){},init:function(){a.superclass.init.call(this);},drawTotalColumnInternalStat:function(t){var e=jQuery('<div class="docflow_stat"/>'),n=jQuery('<table/>'),r=t.get('ВОбработке')?'col_title':'col_title_hidden',a=this;e.append(n.append(jQuery('<colgroup/>').append(jQuery('<col width="300">'),jQuery('<col>'),jQuery('<col>'),jQuery('<col>')),jQuery('<tr class="all_docs sel_row">').append(jQuery('<td class="docs_title">Текущее состояние</td>'),jQuery('<td class="col_title" style="font-weight:100">Документы</td>'),jQuery('<td/>'),jQuery('<td class="'+r+'" style="font-weight:100">Сотрудники</td>'))));var l=t.get('Всего'),c=[new o('Всего','all_docs',t.get('Всего'),0,null,0,0,l),new o('В обработке','no_send_docs',t.get('ВОбработке'),t.get('кВОбработке'),null,t.get('ВОбработкеПросроченных'),0,l),new o('Завершено','end_docs',t.get('Завершено'),0,null,0,0,l),new o('Черновики','rough_docs',t.get('Черновики'),0,null,0,0,l)],u=t.get('Регламенты'),i,d;if(1===u.length)i=u[0].split(':'),c[1].changeId(i[3]),d=i[0];else for(var p=u.length-1;p>=0;--p)i=u[p].split(':'),c.splice(2,0,new o(i[0],'regl_docs',i[1],i[2],i[3],i[4],i[5],l));for(p=0;p<c.length;++p){var g=c[p],m=g.getName(),f='В обработке'===m&&1===u.length?d:m,_=!('Всего'===m||'Завершено'===m||'Черновики'===m||'В обработке'===m&&u.length>1),h=g.getStateType(),y=g.getCountDocument(),S=_?g.getCountEmployee():0,j=g.getId(),Q=g.getCountDocumentOverdue(),C=g.getCountEmployeeOverdue(),w=g.getPercent(),I=_?j+','+f:m,D=_?'phaseReport':'innerDocs',R=_?'Перейти к отчету по фазам':'Перейти к документам',v=_?m:'Перейти к документам';if(!(('Черновики'===m||'Завершено'===m)&&0===y))n.append(jQuery('<tr class="sel_row"></tr>').addClass(h).append(y>0?jQuery('<td class="docs_count_cap">'+'<div><a class="common_underline" title="'+v+'" reg_name="'+f+'"  params="'+I+'" nextReport="'+D+'">'+m+'</a></div>'+'</td>'):jQuery('<td class="docs_count_cap">'+m+'</td>'),y>0?jQuery('<td class="docs_count sel_row">'+s(y,Q,R,f,I,D)+'</td>'):jQuery('<td class="docs_count sel_row">-</td>'),w>0?jQuery('<td class="docs_count"><a class="common_underline" title="'+R+'" reg_name="'+f+'" id="'+h+'" params="'+I+'" nextReport="'+D+'">'+w+'%</a></td>'):jQuery('<td class="docs_count">-</td>'),S>0?jQuery('<td class="docs_count">'+s(S,C,R,m,I,D)+'</td>'):jQuery('<td class="docs_count"></td>')));}return e;},onAfterRender:function(e){var n=this.getQuery(),o=r.getBrowserFromNewRegistry.call(this);this.getContainer().find('a').each(function(e,s){function a(t,e){t.click(function(t){r.goToInnerDocsFromStat(e,o);});}function l(e,n,o){e.click(function(e){o['Регламент']=parseInt(n.split(',')[0],10),r.goToInnerStatReport('js!SBIS3.EDO.StatisticsReportByPhase',o,t.ControlStorage.getByName('ШаблонСтатистики'));});}if('phaseReport'===$(s).attr('nextReport'))l($(s),$(s).attr('params'),n);else a($(s),$(s).attr('params'),n);});}});return a.title='СтатистикаВнутренних',a.dimensions={autoWidth:true,autoHeight:true,resizable:false},a;});
define("html!SBIS3.EDO.StatTemplate",function(){var e=function(e){var t=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;e.test(t);)t=t.replace(e,"&#123;&#123;$1&#125;&#125;");return t}}(),n=function(e){return e.join?e.join(""):e.toString()},o=function(e){return void 0===e?"":e&&"object"==typeof e?n(e):""+e},r="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div style="height:100%;position:relative;" class="'+t(o(e.className))+'"> <component data-component="Deprecated/Controls/TemplatedArea/TemplatedArea" style="width:100px;height:100%;position:relative;" name="'+t(o(e.StatTemplateName))+'"> <options name="handlers"> <option name="onInit" type="function">js!SBIS3.EDO.StatTemplate:prototype.onInit</option> </options> <option name="className">tarea100</option> </component> </div>');return(a=t(a))+(r&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.StatTemplate"}},e});
define('js!SBIS3.EDO.StatTemplate',['WS.Data/Source/SbisService','WS.Data/Query/Query','Core/ParallelDeferred','Core/Deferred','SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.StatTemplate','js!SBIS3.EDO.StatFuncs','Deprecated/Controls/TemplatedArea/TemplatedArea','Elektronnyj_dokumentooborot_localization'],function(t,e,i,n,o,a,s){var l=o.extend({_dotTplFn:a,$protected:{_options:{name:'',StatTemplateName:'StatTemplate1',docType:'',docSubType:'',loadOnDemand:false,statisticsType:'',filterDocTypes:void 0,visibility:'block',filter_options:{},set_user_dep:false,detalization_row_actions:[],show_phase_norm:false,template:'',registryBrowserName:'browserView',registryTabID:'ListTab',StatTabID:'StatTab',needStatPrintBtn:false,needStatSaveBtn:false,customizeFilters:[{name:'ФильтрСтатусПерехода',enable:false}],className:''}},$constructor:function(){},init:function(){if(l.superclass.init.call(this),'none'===this._options.visibility)this.hide();},getCurrentTemplateName:function(){return this.getChildControlByName(this._options.StatTemplateName).getCurrentTemplateName();},onInit:function(){var t=this;if(false===t.getParent()._options.loadOnDemand)t.getParent()._loadStatistics(t.getParent()._options);},setStatisticsTemplate:function(t){var e=this;if(t)this.waitChildControlByName(e._options.StatTemplateName).addCallback(function(e){e.setTemplate(t);});else if(false!==e._options.loadOnDemand)e._loadStatistics(e._options);},_loadStatistics:function(o){this.waitChildControlByName(o.StatTemplateName).addCallback(function(a){var l=new e();l.where({'ТипДокумента':o.docType,'ПодТипДокумента':''!==o.docSubType?o.docSubType:null}),new t({endpoint:'ТипДокумента',binding:{query:'Найти'}}).query(l).addCallback(function(e){if(e.getAll()&&e.getAll().getCount()>0){var l='',r={},p='';if(!o.template)if('current'===o.statisticsType)l='js!SBIS3.EDO.StatisticsInnerCurrent',r['ФильтрПоКраткомуСостоянию']=4,r['ФильтрСтатистикаТекущие']=true,a.getLinkedContext().setValue('ФильтрПоКраткомуСостоянию',4),a.getLinkedContext().setValue('ФильтрСтатистикаТекущие',true);else l='js!SBIS3.EDO.PeriodStatReport';else l=o.template,p=-1!==o.template.indexOf('Incoming')?'Входящие':-1!==o.template.indexOf('Outgoing')?'Исходящие':'';if(r['ТипДокумента']=parseInt(e.getRow(0).get('@ТипДокумента'),10),o.filterDocTypes)r['ФильтрТипыДокументов']=o.filterDocTypes;a.getLinkedContext().setValue('ТипДокумента',parseInt(e.getRow(0).get('@ТипДокумента'),10)),a.getLinkedContext().setValue('ФильтрТипыДокументов',o.filterDocTypes),a.getLinkedContext().setValue('ФильтрДатаПериод','Месяц'),a.getLinkedContext().setValue('ТипРаздела',p),a.getLinkedContext().setValue('ТипДокумента.Название',o.docType);var d=new i(),c=new n();if(d.push(c),!s.isEmptyObject(o.filter_options)){for(var f in o.filter_options)if(o.filter_options.hasOwnProperty(f))a.getLinkedContext().setValue(f,o.filter_options[f]);if(void 0!==o.filter_options['ИдРегламента']&&null!==o.filter_options['ИдРегламента'])l=l='period'===o.statisticsType?l:'js!SBIS3.EDO.StatisticsReportByPhase',c.callback(false);else if(void 0!==o.filter_options['Регламент']&&null!==o.filter_options['Регламент'])new t({endpoint:'Регламент'}).call('Прочитать',{'ИдО':o.filter_options['Регламент'],'ИмяМетода':null}).addCallback(function(t){return c.callback(t),t;}),l='period'===o.statisticsType?l:'js!SBIS3.EDO.StatisticsReportByPhase';}else c.callback(false);return a._options.componentOptions['initial_filters']=r,a._options.componentOptions['docType']=o.docType,a._options.componentOptions['docSubType']=o.docSubType,d.done().getResult().addCallback(function(t){if(false!==t[0])if(t[0].getRow(0).has('Идентификатор'))a.getLinkedContext().setValue('ИдРегламента',t[0].getRow(0).get('Идентификатор')),delete o.filter_options['Регламент'],o.filter_options['ИдРегламента']=t[0].getRow(0).get('Идентификатор'),o.filter_options['ИдРегламента.Название']=t[0].getRow(0).get('Название');a.setTemplate(l).addCallback(function(){if(o.needStatPrintBtn)s.addStatPrintButton();if(o.needStatSaveBtn)s.addStatSaveButton();});}),a;}});});},setVisibility:function(t){if(t)this.show();else this.hide();},setDocType:function(t){this._options.docType=t;},getDocType:function(){return this._options.docType;},setFilterOptions:function(t){this._options.filter_options=t;}});return l.title='Title',l.dimensions={autoWidth:true,autoHeight:true,resizable:false},l;});
define("tmpl!SBIS3.EDO.StatEDOBrowserPP",["Core/tmpl/js/tclosure","js!SBIS3.CONTROLS/ScrollContainer"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.CONTROLS/ScrollContainer"]=e[1];var o=function e(o,i,s,n,a){function l(){}var d=0,g=void 0!==t&&t?t:arguments[arguments.length-1];void 0===g&&(eval("var thelpers = null;"),g=global.requirejs("View/Runner/tclosure"));var p={};a&&a.isSetts&&(p=a.fullContext||{});var c="string"==typeof s?s:"",w=void 0===r?void 0:r,h={id:[],def:void 0},_=g.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),O=this&&this.includedTemplates?this.includedTemplates:{},b=g.getMarkupGenerator(n);try{var y=b.joinElements([b.createTag("div",{style:"height:100%",class:"edo-BrowserWrapper"},[b.createControl("wsControl","ws:SBIS3.CONTROLS/ScrollContainer",{content:(new function(){var e=Object.create(o),t=function e(t,r,o,i,s){if(void 0===o)var o=arguments[2];var n=0,a="content";void 0===g&&(eval("var thelpers = null;"),g=global.requirejs("View/Runner/tclosure"));var l=this&&this.includedTemplates?this.includedTemplates:{},d=g.getMarkupGenerator(i);try{var O=d.joinElements([d.createControl("resolver",g.getter(t,["browserOptions","hierarchy","allow"])?"SBIS3.CONTROLS/Tree/CompositeView":"SBIS3.CONTROLS/CompositeView",{name:"browserView",viewMode:g.getter(t,["browserOptions","viewMode"]),allowToggleHead:g.getter(t,["browserOptions","allowToggleHead"]),className:g.getter(t,["browserOptions","className"]),allowChangeEnable:g.getter(t,["browserOptions","allowChangeEnable"]),bindings:[{fieldName:""+g.getter(t,["browserOptions","bind"]),propName:"filter",propPath:[],fullPropName:"filter",propPathStr:"",oneWay:!1,direction:"fromContext",bindNonExistent:!1}],filter:void 0,currentRoot:g.getter(t,["browserOptions","currentRoot"]),root:null,showPaging:!1,itemsSortMethod:g.getter(t,["browserOptions","itemsSortMethod"]),showHead:g.getter(t,["browserOptions","showHead"]),headTpl:g.getter(t,["browserOptions","headTpl"]),stickyHeader:g.getter(t,["browserOptions","stickyHeader"]),pageSize:null,paging:!1,transformHead:!0,startScrollColumn:1,multiselect:g.getter(t,["browserOptions","multiselect"]),scrollPaging:g.getter(t,["browserOptions","scrollPaging"]),isFolderOnTop:g.getter(t,["browserOptions","isFolderOnTop"]),resultsPosition:g.getter(t,["browserOptions","resultsPosition"]),resultsText:g.getter(t,["browserOptions","resultsText"]),infiniteScroll:!1,idProperty:g.getter(t,["browserOptions","idProperty"]),highlightEnabled:g.getter(t,["browserOptions","highlightEnabled"]),allowEmptySelection:g.getter(t,["browserOptions","allowEmptySelection"]),emptyHTML:g.getter(t,["browserOptions","emptyHTML"]),contextMenu:g.getter(t,["browserOptions","contextMenu"]),ignoreLocalPageSize:!1,customPickerTemplate:g.getter(t,["customPickerTemplate"]),itemsDragNDrop:!1,editInPlaceEnabled:g.getter(t,["browserOptions","editInPlace","enabled"]),editInPlaceGetModelFromSource:g.getter(t,["browserOptions","editInPlace","getModelFromSource"]),editInPlaceOnFieldChangeHandler:g.getter(t,["browserOptions","editInPlace","onFieldChangeHandler"]),editMode:g.getter(t,["browserOptions","editInPlace","enabled"])?g.getter(t,["browserOptions","editInPlace","mode"]):"",editingTemplate:g.getter(t,["browserOptions","editInPlace","template"]),itemsActions:g.getter(t,["browserOptions","itemsActions"]),columns:g.getter(t,["browserOptions","columns"]),ladder:g.getter(t,["browserOptions","ladder"]),includedTemplates:g.getter(t,["browserOptions","includedTemplates"]),templateBinding:g.getter(t,["browserOptions","templateBinding"]),partialyReload:g.getter(t,["browserOptions","hierarchy","allow"])?g.getter(t,["browserOptions","partialyReload"]):void 0,parentProperty:g.getter(t,["browserOptions","hierarchy","allow"])?g.getter(t,["browserOptions","hierarchy","parentProperty"]):void 0,displayProperty:g.getter(t,["browserOptions","hierarchy","allow"])?g.getter(t,["browserOptions","hierarchy","displayProperty"]):void 0,imageField:g.getter(t,["browserOptions","hierarchy","allow"])?"Image":void 0,allowEnterToFolder:g.getter(t,["browserOptions","hierarchy","allow"])||void 0,arrowActivatedHandler:g.getter(t,["browserOptions","hierarchy","allow"])?g.getter(t,["browserOptions","hierarchy","arrowActivatedHandler"]):void 0,tileTemplate:g.getter(t,["browserOptions","tileTemplate"])||null,listTemplate:g.getter(t,["browserOptions","listTemplate"])||null,items:g.getter(t,["listData"])?g.getter(t,["listData","items"]):void 0,listFolderTemplate:!g.getter(t,["listData"])&&g.getter(t,["browserOptions","listFolderTemplate"])||void 0,handlers:g.getter(t,["$computed","handlers"])},{class:"controls-DataGridView__hasSeparator "+g.utils.escape(g.getter(t,["dataLoadedClass"])),name:"browserView",sbisname:"browserView"},{data:t,ctx:this,pName:void 0!==a?a:void 0,viewController:_},o,w,l,g.config,p,h)],c,h);h.def&&(O=d.chain(O,h,r),h=void 0)}catch(e){g.templateError("resources/Elektronnyj_dokumentooborot/Statistika/StatTemplateNew/StatEdoBrowserPP/StatEdoBrowserPP.tmpl",e,t)}return O||""};this.func=g.makeFunctionSerializable(t,e)}).func(Object.create(o),null,s),stickyContainer:!0,className:"edo-StatEdoBrowser-scrollContainer controls-ScrollContainer-flex",esc:!1},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:_,internal:{__dirtyCheckingVars_0:g.getter(o,["browserOptions","hierarchy","allow"])?"SBIS3.CONTROLS/Tree/CompositeView":"SBIS3.CONTROLS/CompositeView",__dirtyCheckingVars_1:g.getter(o,["dataLoadedClass"]),__dirtyCheckingVars_2:g.getter(o,["browserOptions","viewMode"]),__dirtyCheckingVars_3:g.getter(o,["browserOptions","allowToggleHead"]),__dirtyCheckingVars_4:g.getter(o,["browserOptions","className"]),__dirtyCheckingVars_5:g.getter(o,["browserOptions","allowChangeEnable"]),__dirtyCheckingVars_6:g.getter(o,["browserOptions","currentRoot"]),__dirtyCheckingVars_9:g.getter(o,["browserOptions","itemsSortMethod"]),__dirtyCheckingVars_10:g.getter(o,["browserOptions","showHead"]),__dirtyCheckingVars_11:g.getter(o,["browserOptions","headTpl"]),__dirtyCheckingVars_12:g.getter(o,["browserOptions","stickyHeader"]),__dirtyCheckingVars_17:g.getter(o,["browserOptions","multiselect"]),__dirtyCheckingVars_18:g.getter(o,["browserOptions","scrollPaging"]),__dirtyCheckingVars_19:g.getter(o,["browserOptions","isFolderOnTop"]),__dirtyCheckingVars_20:g.getter(o,["browserOptions","resultsPosition"]),__dirtyCheckingVars_21:g.getter(o,["browserOptions","resultsText"]),__dirtyCheckingVars_23:g.getter(o,["browserOptions","idProperty"]),__dirtyCheckingVars_24:g.getter(o,["browserOptions","highlightEnabled"]),__dirtyCheckingVars_25:g.getter(o,["browserOptions","allowEmptySelection"]),__dirtyCheckingVars_26:g.getter(o,["browserOptions","emptyHTML"]),__dirtyCheckingVars_27:g.getter(o,["browserOptions","contextMenu"]),__dirtyCheckingVars_29:g.getter(o,["customPickerTemplate"]),__dirtyCheckingVars_31:g.getter(o,["browserOptions","editInPlace","enabled"]),__dirtyCheckingVars_32:g.getter(o,["browserOptions","editInPlace","getModelFromSource"]),__dirtyCheckingVars_33:g.getter(o,["browserOptions","editInPlace","onFieldChangeHandler"]),__dirtyCheckingVars_34:g.getter(o,["browserOptions","editInPlace","enabled"])?g.getter(o,["browserOptions","editInPlace","mode"]):"",__dirtyCheckingVars_35:g.getter(o,["browserOptions","editInPlace","template"]),__dirtyCheckingVars_36:g.getter(o,["browserOptions","itemsActions"]),__dirtyCheckingVars_37:g.getter(o,["browserOptions","columns"]),__dirtyCheckingVars_38:g.getter(o,["browserOptions","ladder"]),__dirtyCheckingVars_39:g.getter(o,["browserOptions","includedTemplates"]),__dirtyCheckingVars_40:g.getter(o,["browserOptions","templateBinding"]),__dirtyCheckingVars_41:g.getter(o,["browserOptions","hierarchy","allow"])?g.getter(o,["browserOptions","partialyReload"]):void 0,__dirtyCheckingVars_42:g.getter(o,["browserOptions","hierarchy","allow"])?g.getter(o,["browserOptions","hierarchy","parentProperty"]):void 0,__dirtyCheckingVars_43:g.getter(o,["browserOptions","hierarchy","allow"])?g.getter(o,["browserOptions","hierarchy","displayProperty"]):void 0,__dirtyCheckingVars_44:g.getter(o,["browserOptions","hierarchy","allow"])?"Image":void 0,__dirtyCheckingVars_45:g.getter(o,["browserOptions","hierarchy","allow"])||void 0,__dirtyCheckingVars_46:g.getter(o,["browserOptions","hierarchy","allow"])?g.getter(o,["browserOptions","hierarchy","arrowActivatedHandler"]):void 0,__dirtyCheckingVars_47:g.getter(o,["browserOptions","tileTemplate"])||null,__dirtyCheckingVars_48:g.getter(o,["browserOptions","listTemplate"])||null,__dirtyCheckingVars_49:g.getter(o,["listData"])?g.getter(o,["listData","items"]):void 0,__dirtyCheckingVars_50:!g.getter(o,["listData"])&&g.getter(o,["browserOptions","listFolderTemplate"])||void 0,__dirtyCheckingVars_51:g.getter(o,["$computed","handlers"]),__dirtyCheckingVars_52:g.getter(o,["browserOptions","hierarchy","allow"])?"SBIS3.CONTROLS/Tree/CompositeView":"SBIS3.CONTROLS/CompositeView"}},s,w,O,g.config,p)],i,h,this)],c,h);h.def&&(y=b.chain(y,h,i),h=void 0)}catch(e){g.templateError("resources/Elektronnyj_dokumentooborot/Statistika/StatTemplateNew/StatEdoBrowserPP/StatEdoBrowserPP.tmpl",e,o)}return y||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.StatEDOBrowserPP"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.StatEDOBrowserPP", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-StatEdoBrowser-scrollContainer{height:100%}"));head.appendChild(style);});}
define('js!SBIS3.EDO.StatEDOBrowserPP',['js!SBIS3.EDO2.Browser','tmpl!SBIS3.EDO.StatEDOBrowserPP','SBIS3.CONTROLS/ScrollContainer','css!SBIS3.EDO.StatEDOBrowserPP','Elektronnyj_dokumentooborot_localization'],function(t,e){var r=t.extend({$protected:{_options:{contentTpl:e,searchConfig:''}}});return r.title='Title',r.dimensions={autoWidth:true,autoHeight:true,resizable:false},r;});
define("tmpl!SBIS3.EDO.StatisticsInnerCurrentNew",["Core/tmpl/js/tclosure","js!SBIS3.EDO.StatEDOBrowserPP"],function(){var t=Array.prototype.slice.call(arguments),e=t[0],r={};r["js!SBIS3.EDO.StatEDOBrowserPP"]=t[1];var i=function t(i,a,s,n,o){function l(){}var d=0,c=void 0!==e&&e?e:arguments[arguments.length-1];void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure"));var g={};o&&o.isSetts&&(g=o.fullContext||{});var u="string"==typeof s?s:"",p=void 0===r?void 0:r,S={id:[],def:void 0},y=c.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,i),m=this&&this.includedTemplates?this.includedTemplates:{},h=c.getMarkupGenerator(n);try{var _=h.joinElements([h.createTag("div",{style:"height:100%;",class:""+c.wrapUndef(c.utils.escape((c.getter(i,["stickyHeader"])?"edo-StatisticsReport":"")+c.getter(i,["noFastDataFilterClass"])))},[h.createControl("wsControl","ws:SBIS3.EDO.StatEDOBrowserPP",{fastDataFilterConfig:{filterStructure:[{filterField:"ФильтрСтатистикаПериод",internalCaptionField:"FilterStatPeriodText",internalValueField:"FilterStatPeriod",resetValue:"Все",value:c.getter(i,["FilterStatPeriodValue"])}],className:"stat_edo__fastDataFilter",idProperty:"name"},filterButtonConfig:{resetLinkText:c.getter(i,["resetLinkText"]),filterStructure:c.getter(i,["filterStructure"]),componentOptions:c.getter(i,["filterComponentOptions"]),template:"SBIS3.EDO.FilterInnerStatCurrentNew",additionalFilterParamsTemplate:"SBIS3.EDO.FilterInnerStatCurrentNewSelector"},browserOptions:{hierarchy:{allow:!0,parentProperty:"Раздел",displayProperty:"Название"},common:{firstRequest:!1,filterParams:c.getter(i,["listData"])?c.getter(i,["listData","filter"]):c.getter(i,["lastSavedFilters"]),objectName:"СлужЗап",method:"СтатистикаВнутрТекущие",navigationType:null},itemsActionsVisibility:c.getter(i,["itemsActionsVisibility"]),allowToggleHead:!0,stickyHeader:c.getter(i,["stickyHeader"]),multiselect:!1,isFolderOnTop:!0,hasSeparator:!1,showHead:!0,viewMode:"table",idProperty:"Идентификатор",bind:"filter",emptyHTML:global.rk("Нет задач"),itemsDragNDrop:!1,showPaging:!1,paging:!1,infiniteScroll:!1,resultsPosition:"top",resultsText:" ",columns:c.getter(i,["columns"]),handlers:c.getter(i,["handlers"]),currentRoot:c.getter(i,["currentRoot"]),itemsSortMethod:c.getter(i,["itemsSortMethod"])},name:"StatisticsInnerCurrentNewBrowser",dataLoadedClass:c.getter(i,["listData"])?"controls-ListView__dataLoaded":"",useScrollContainer:!0,useScope:!1,isSingleTypeBrowser:!1,listData:c.getter(i,["listData"]),serverSideRendering:c.getter(i,["serverSideRendering"]),historyId:c.getter(i,["historyId"]),operationsPanelConfig:!1,applyHistoryFilterOnLoad:!1,esc:!1},{class:"regl-report-hierarchy-view statistics-browser",name:"StatisticsInnerCurrentNewBrowser",sbisname:"StatisticsInnerCurrentNewBrowser"},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y,internal:{__dirtyCheckingVars_0:c.getter(i,["FilterStatPeriodValue"]),__dirtyCheckingVars_1:c.getter(i,["resetLinkText"]),__dirtyCheckingVars_2:c.getter(i,["filterStructure"]),__dirtyCheckingVars_3:c.getter(i,["filterComponentOptions"]),__dirtyCheckingVars_8:c.getter(i,["listData"])?c.getter(i,["listData","filter"]):c.getter(i,["lastSavedFilters"]),__dirtyCheckingVars_12:c.getter(i,["itemsActionsVisibility"]),__dirtyCheckingVars_14:c.getter(i,["stickyHeader"]),__dirtyCheckingVars_26:c.getter(i,["columns"]),__dirtyCheckingVars_27:c.getter(i,["handlers"]),__dirtyCheckingVars_28:c.getter(i,["currentRoot"]),__dirtyCheckingVars_29:c.getter(i,["itemsSortMethod"])}},s,p,m,c.config,g)],a,S,this)],u,S);S.def&&(_=h.chain(_,S,a),S=void 0)}catch(t){c.templateError("resources/Elektronnyj_dokumentooborot/Statistika/StatisticsInnerCurrent/StatisticsInnerCurrentNew.tmpl",t,i)}return _||""};return i.includedFunctions={},i.stable=!0,i.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.StatisticsInnerCurrentNew"}},i});
define("tmpl!SBIS3.EDO.FilterInnerStatCurrentNew",["Core/tmpl/js/tclosure","js!SBIS3.EDO.BaseFilter.Period","js!SBIS3.EDO.PassageStatus","js!SBIS3.EDO.FilterDateLimitation","js!SBIS3.EDO.BaseFilter.Face1","js!SBIS3.EDO.BaseFilter.ResponsibleFace","js!SBIS3.EDO.BaseFilter.ListDispatch","js!SBIS3.EDO.BaseFilter.Limitation","js!SBIS3.EDO.BaseFilter.AuthorOrResponsible","js!SBIS3.EDO.BaseFilter.Milestone","js!SBIS3.EDO.BaseFilter.Marks","js!SBIS3.EDO.BaseFilter.Regulation","js!SBIS3.EDO.RepeatStages","js!SBIS3.EDO.BaseFilter.RightsLimText"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.EDO.BaseFilter.Period"]=e[1],r["js!SBIS3.EDO.PassageStatus"]=e[2],r["js!SBIS3.EDO.FilterDateLimitation"]=e[3],r["js!SBIS3.EDO.BaseFilter.Face1"]=e[4],r["js!SBIS3.EDO.BaseFilter.ResponsibleFace"]=e[5],r["js!SBIS3.EDO.BaseFilter.ListDispatch"]=e[6],r["js!SBIS3.EDO.BaseFilter.Limitation"]=e[7],r["js!SBIS3.EDO.BaseFilter.AuthorOrResponsible"]=e[8],r["js!SBIS3.EDO.BaseFilter.Milestone"]=e[9],r["js!SBIS3.EDO.BaseFilter.Marks"]=e[10],r["js!SBIS3.EDO.BaseFilter.Regulation"]=e[11],r["js!SBIS3.EDO.RepeatStages"]=e[12],r["js!SBIS3.EDO.BaseFilter.RightsLimText"]=e[13];var i=function e(i,o,s,a,n){function l(){}var c=0,S=void 0!==t&&t?t:arguments[arguments.length-1];void 0===S&&(eval("var thelpers = null;"),S=global.requirejs("View/Runner/tclosure"));var u={};n&&n.isSetts&&(u=n.fullContext||{});var p="string"==typeof s?s:"",d=void 0===r?void 0:r,m={id:[],def:void 0},F=S.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,i),B=this&&this.includedTemplates?this.includedTemplates:{},f=S.getMarkupGenerator(a);try{var D=f.joinElements([f.createTag("div",{class:"edo-BaseFilter__filterPicker"},[S.getter(i,["filterPeriod"])?[f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Period",{defaultValue:"Месяц"},{},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:F},s,d,B,S.config,u)]:f.createText(""),S.getter(i,["customizeFilters","FilterPassageStatus"])?[f.createControl("wsControl","ws:SBIS3.EDO.PassageStatus",{},{},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:F},s,d,B,S.config,u)]:f.createText(""),S.getter(i,["FilterLimitationDateProc"])?[f.createControl("wsControl","ws:SBIS3.EDO.FilterDateLimitation",{},{},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:F},s,d,B,S.config,u)]:f.createText(""),S.getter(i,["customizeFilters","FilterFace1"])?[f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Face1",{},{},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:F},s,d,B,S.config,u)]:f.createText(""),S.getter(i,["customizeFilters","FilterResponsibleFace"])?[f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ResponsibleFace",{},{},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:F},s,d,B,S.config,u)]:f.createText(""),S.getter(i,["customizeFilters","FilterListDispatch"])?[f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ListDispatch",{},{},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:F},s,d,B,S.config,u)]:f.createText(""),S.getter(i,["customizeFilters","FilterLimitationDate"])?[f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Limitation",{},{},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:F},s,d,B,S.config,u)]:f.createText(""),S.getter(i,["customizeFilters","FilterAuthorOrResponsible"])?[f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.AuthorOrResponsible",{showCustom:S.getter(i,["customizeFilters","FilterAuthorOrResponsibleMe"])},{},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:F},s,d,B,S.config,u)]:f.createText(""),S.getter(i,["customizeFilters","FilterMilestone"])?[f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Milestone",{},{},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:F},s,d,B,S.config,u)]:f.createText(""),S.getter(i,["customizeFilters","FilterMarks"])?[f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Marks",{reestrName:S.getter(i,["docType"]),multiDocsReestr:!!S.getter(i,["docTypes"])},{},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:F},s,d,B,S.config,u)]:f.createText(""),S.getter(i,["customizeFilters","FilterIdRegulations"])?[f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Regulation",{docTypes:S.getter(i,["idRegulationsDocTypes"]),hidePhase:!0},{},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:F},s,d,B,S.config,u)]:f.createText(""),S.getter(i,["customizeFilters","FilterRepeatStages"])?[f.createControl("wsControl","ws:SBIS3.EDO.RepeatStages",{},{},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:F},s,d,B,S.config,u)]:f.createText(""),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.RightsLimText",{textRender:S.getTypeFunc("js!SBIS3.EDO.ScopeFilters:setScopeTextForFilter ",{}),esc:!1},{},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:F},s,d,B,S.config,u)],o,m,this)],p,m);m.def&&(D=f.chain(D,m,o),m=void 0)}catch(e){S.templateError("resources/Elektronnyj_dokumentooborot/Statistika/StatisticsInnerCurrent/FilterInnerStatCurrent/FilterInnerStatCurrentNew.tmpl",e,i)}return D||""};return i.includedFunctions={},i.stable=!0,i.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FilterInnerStatCurrentNew"}},i});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.FilterInnerStatCurrentNew", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(""));head.appendChild(style);});}
define('js!SBIS3.EDO.FilterInnerStatCurrentNew',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FilterInnerStatCurrentNew','css!SBIS3.EDO.FilterInnerStatCurrentNew','js!SBIS3.EDO.BaseFilter.Limitation','js!SBIS3.EDO.BaseFilter.Overdue','js!SBIS3.EDO.BaseFilter.Marks','js!SBIS3.EDO.BaseFilter.ResponsibleFace','js!SBIS3.EDO.BaseFilter.Face1','js!SBIS3.EDO.BaseFilter.ListDispatch','js!SBIS3.EDO.BaseFilter.AuthorOrResponsible','js!SBIS3.EDO.BaseFilter.Regulation','js!SBIS3.EDO.BaseFilter.Milestone','js!SBIS3.EDO.BaseFilter.OurOrganisation','js!SBIS3.EDO.PassageStatusSelector','js!SBIS3.EDO.RepeatStagesSelector','js!SBIS3.EDO.ScopeFilters','js!SBIS3.EDO.FilterDateLimitation','Elektronnyj_dokumentooborot_localization'],function(e,t){var i=e.extend({_dotTplFn:t,$protected:{_options:{autoHeight:true,autoWidth:true,isExternalStat:true,docType:'',docSubType:'',customizeFilters:{FilterFace1:true,FilterIdRegulations:true,FilterLimitationDate:true,FilterResponsibleFace:true,FilterAuthorOrResponsibleMe:true,FilterListDispatch:true,FilterPriority:true,FilterMilestone:true,FilterPassageStatus:false,FilterRepeatStages:false,FilterMarks:false,FilterAuthorOrResponsible:false,FilterDateLimitation:false}}},$constructor:function(){},_modifyOptions:function(e){var t=[];if((e=i.superclass._modifyOptions.call(this,e)).docTypes){for(var s=e.docTypes.split(','),r=0;r<s.length;r++)if(s.hasOwnProperty(r))t.push({docTypeString:s[r],subDocTypeString:''});}else if(e.docType)t.push({docTypeString:e.docType,subDocTypeString:e.docSubType});if(e.idRegulationsDocTypes=t,e.FilterLimitationDateProc)e.customizeFilters.FilterLimitationDate=false;return e;},init:function(){i.superclass.init.call(this);}});return i;});
define("tmpl!SBIS3.EDO.FilterInnerStatCurrentNewSelector",["Core/tmpl/js/tclosure","js!SBIS3.EDO.PassageStatusSelector","js!SBIS3.EDO.BaseFilter.Face1Selector","js!SBIS3.EDO.BaseFilter.ResponsibleFaceSelector","js!SBIS3.EDO.BaseFilter.ListDispatchSelector","js!SBIS3.EDO.BaseFilter.LimitationSelector","js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleSelector","js!SBIS3.EDO.BaseFilter.MilestoneSelector","js!SBIS3.EDO.BaseFilter.MarksSelector","js!SBIS3.EDO.BaseFilter.RegulationSelector","js!SBIS3.EDO.RepeatStagesSelector"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.EDO.PassageStatusSelector"]=e[1],r["js!SBIS3.EDO.BaseFilter.Face1Selector"]=e[2],r["js!SBIS3.EDO.BaseFilter.ResponsibleFaceSelector"]=e[3],r["js!SBIS3.EDO.BaseFilter.ListDispatchSelector"]=e[4],r["js!SBIS3.EDO.BaseFilter.LimitationSelector"]=e[5],r["js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleSelector"]=e[6],r["js!SBIS3.EDO.BaseFilter.MilestoneSelector"]=e[7],r["js!SBIS3.EDO.BaseFilter.MarksSelector"]=e[8],r["js!SBIS3.EDO.BaseFilter.RegulationSelector"]=e[9],r["js!SBIS3.EDO.RepeatStagesSelector"]=e[10];var o=function e(o,i,a,l,s){function n(){}var c=0,S=void 0!==t&&t?t:arguments[arguments.length-1];void 0===S&&(eval("var thelpers = null;"),S=global.requirejs("View/Runner/tclosure"));var u={};s&&s.isSetts&&(u=s.fullContext||{});var p="string"==typeof a?a:"",d=void 0===r?void 0:r,F={id:[],def:void 0},m=S.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),B=this&&this.includedTemplates?this.includedTemplates:{},f=S.getMarkupGenerator(l);try{var C=f.joinElements([f.createTag("div",{class:"edo-BaseFilter__filterPicker edo-twoColumnSelectors"},[S.getter(o,["customizeFilters","FilterPassageStatus"])?[f.createControl("wsControl","ws:SBIS3.EDO.PassageStatusSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,d,B,S.config,u)]:f.createText(""),S.getter(o,["customizeFilters","FilterFace1"])?[f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Face1Selector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,d,B,S.config,u)]:f.createText(""),S.getter(o,["customizeFilters","FilterResponsibleFace"])?[f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ResponsibleFaceSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,d,B,S.config,u)]:f.createText(""),S.getter(o,["customizeFilters","FilterListDispatch"])?[f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ListDispatchSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,d,B,S.config,u)]:f.createText(""),S.getter(o,["customizeFilters","FilterLimitationDate"])?[f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.LimitationSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,d,B,S.config,u)]:f.createText(""),S.getter(o,["customizeFilters","FilterAuthorOrResponsible"])?[f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.AuthorOrResponsibleSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,d,B,S.config,u)]:f.createText(""),S.getter(o,["customizeFilters","FilterMilestone"])?[f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.MilestoneSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,d,B,S.config,u)]:f.createText(""),S.getter(o,["customizeFilters","FilterMarks"])?[f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.MarksSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,d,B,S.config,u)]:f.createText(""),S.getter(o,["customizeFilters","FilterIdRegulations"])?[f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.RegulationSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,d,B,S.config,u)]:f.createText(""),S.getter(o,["customizeFilters","FilterRepeatStages"])?[f.createControl("wsControl","ws:SBIS3.EDO.RepeatStagesSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,d,B,S.config,u)]:f.createText("")],i,F,this)],p,F);F.def&&(C=f.chain(C,F,i),F=void 0)}catch(e){S.templateError("resources/Elektronnyj_dokumentooborot/Statistika/StatisticsInnerCurrent/FilterInnerStatCurrent/FilterInnerStatCurrentNewSelector/FilterInnerStatCurrentNewSelector.tmpl",e,o)}return C||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FilterInnerStatCurrentNewSelector"}},o});
define('js!SBIS3.EDO.FilterInnerStatCurrentNewSelector',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FilterInnerStatCurrentNewSelector','js!SBIS3.EDO.BaseFilter.LimitationSelector','js!SBIS3.EDO.BaseFilter.OverdueSelector','js!SBIS3.EDO.BaseFilter.MarksSelector','js!SBIS3.EDO.BaseFilter.ResponsibleFaceSelector','js!SBIS3.EDO.BaseFilter.Face1Selector','js!SBIS3.EDO.BaseFilter.ListDispatchSelector','js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleSelector','js!SBIS3.EDO.BaseFilter.RegulationSelector','js!SBIS3.EDO.BaseFilter.MilestoneSelector','js!SBIS3.EDO.BaseFilter.OurOrganisationSelector','js!SBIS3.EDO.PassageStatusSelector','js!SBIS3.EDO.RepeatStagesSelector','i18n!SBIS3.EDO.FilterInnerStatCurrentNewSelector','js!SBIS3.EDO.ScopeFilters','Elektronnyj_dokumentooborot_localization'],function(e,t){var r=e.extend({_dotTplFn:t,$protected:{_options:{autoHeight:true,autoWidth:true,FilterIdRegulations:true,customizeFilters:{FilterFace1:true,FilterIdRegulations:true,FilterLimitationDate:true,FilterResponsibleFace:true,FilterAuthorOrResponsibleMe:true,FilterListDispatch:true,FilterPriority:true,FilterMilestone:true,FilterPassageStatus:false,FilterRepeatStages:false,FilterMarks:false,FilterAuthorOrResponsible:false}}},$constructor:function(){},_modifyOptions:function(e){if(e=r.superclass._modifyOptions.call(this,e),e.FilterLimitationDateProc)e.customizeFilters.FilterLimitationDate=false;return e;},init:function(){r.superclass.init.call(this);}});return r;});
define("tmpl!SBIS3.EDO.StatEDOBrowserPP/resources/DataCell",["Core/tmpl/js/tclosure"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={},a=function e(a,i,n,l,s){function o(){}var d=0,c=void 0!==t&&t?t:arguments[arguments.length-1];void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure"));var u={};s&&s.isSetts&&(u=s.fullContext||{});var p="string"==typeof n?n:"",m=void 0===r?void 0:r,g={id:[],def:void 0},f=c.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,a),v=this&&this.includedTemplates?this.includedTemplates:{},B=c.getMarkupGenerator(l);try{var h=B.joinElements([c.getter(a,["templateBinding","isOverdue"])&&c.getter(a,["item",c.getter(a,["templateBinding","fieldName"]),1])?[B.createTag("span",{class:"phase-report-link edo-statistics-overdue-count",param_value:""+c.wrapUndef(c.utils.escape(c.getter(a,["column","templateBinding","columnId"])))},[B.createText(""+c.wrapUndef(c.utils.escape(c.getter(a,["item",c.getter(a,["templateBinding","fieldName"]),1]))))],{},g,this)]:B.createText(""),!c.getter(a,["templateBinding","isOverdue"])&&c.getter(a,["item",c.getter(a,["templateBinding","fieldName"]),0])?[B.createTag("span",{class:"phase-report-link",param_value:""+c.wrapUndef(c.utils.escape(c.getter(a,["column","templateBinding","columnId"])))},[B.createText(""+c.wrapUndef(c.utils.escape(c.getter(a,["item",c.getter(a,["templateBinding","fieldName"]),0]))))],{},g,this)]:B.createText("")],p,g);g.def&&(h=B.chain(h,g,i),g=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/Statistika/StatTemplateNew/StatEdoBrowserPP/resources/DataCell.tmpl",e,a)}return h||""};return a.includedFunctions={},a.stable=!0,a.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.StatEDOBrowserPP/resources/DataCell"}},a});
define("tmpl!SBIS3.EDO.StatEDOBrowserPP/resources/ResultCell",["Core/tmpl/js/tclosure","js!SBIS3.CONTROLS/Link"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.CONTROLS/Link"]=e[1];var i=function e(i,l,n,o,c){function a(){}var u=0,d=void 0!==t&&t?t:arguments[arguments.length-1];void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure"));var s={};c&&c.isSetts&&(s=c.fullContext||{});var m="string"==typeof n?n:"",g=void 0===r?void 0:r,p={id:[],def:void 0},f=d.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,i),v=this&&this.includedTemplates?this.includedTemplates:{},S=d.getMarkupGenerator(o);try{var y=S.joinElements([d.getter(i,["item",d.getter(i,["column","field"])])&&""!==d.getter(i,["item",d.getter(i,["column","field"])])?[S.createControl("wsControl","ws:SBIS3.CONTROLS/Link",{componentOptions:{columnField:d.getter(i,["column","field"]),isOverdue:d.getter(i,["column","templateBinding","isOverdue"]),filterName:d.getter(i,["column","templateBinding","filterName"]),columnId:d.getter(i,["column","templateBinding","columnId"])},handlers:{onActivated:d.getTypeFunc("js!SBIS3.EDO.InnerStat:onActivateResult",{})},caption:d.getter(i,["column","templateBinding","isOverdue"])?"0"!==d.getter(d.getter(i,["item",d.getter(i,["column","field"]),"split"]).apply(d.getter(i,["item",d.getter(i,["column","field"])]),[","]),[1])?d.getter(d.getter(i,["item",d.getter(i,["column","field"]),"split"]).apply(d.getter(i,["item",d.getter(i,["column","field"])]),[","]),[1]):"":"0"!==d.getter(d.getter(i,["item",d.getter(i,["column","field"]),"split"]).apply(d.getter(i,["item",d.getter(i,["column","field"])]),[","]),[0])?d.getter(d.getter(i,["item",d.getter(i,["column","field"]),"split"]).apply(d.getter(i,["item",d.getter(i,["column","field"])]),[","]),[0]):"",className:"phase-report-link "+(d.getter(i,["column","templateBinding","isOverdue"])?"edo-statistics-overdue-count":""),esc:!1},{},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f,internal:{__dirtyCheckingVars_0:d.getter(i,["column","field"]),__dirtyCheckingVars_1:d.getter(i,["column","templateBinding","isOverdue"]),__dirtyCheckingVars_2:d.getter(i,["column","templateBinding","filterName"]),__dirtyCheckingVars_3:d.getter(i,["column","templateBinding","columnId"])}},n,g,v,d.config,s)]:S.createText("")],m,p);p.def&&(y=S.chain(y,p,l),p=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/Statistika/StatTemplateNew/StatEdoBrowserPP/resources/ResultCell.tmpl",e,i)}return y||""};return i.includedFunctions={},i.stable=!0,i.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.StatEDOBrowserPP/resources/ResultCell"}},i});
define("tmpl!SBIS3.EDO.StatEDOBrowserPP/resources/CaptionCell",["Core/tmpl/js/tclosure","js!SBIS3.CONTROLS/Link"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],n={};n["js!SBIS3.CONTROLS/Link"]=e[1];var r=function e(r,o,l,i,a){function c(){}var u=0,m=void 0!==t&&t?t:arguments[arguments.length-1];void 0===m&&(eval("var thelpers = null;"),m=global.requirejs("View/Runner/tclosure"));var s={};a&&a.isSetts&&(s=a.fullContext||{});var d="string"==typeof l?l:"",p=void 0===n?void 0:n,g={id:[],def:void 0},v=m.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,r),S=this&&this.includedTemplates?this.includedTemplates:{},f=m.getMarkupGenerator(i);try{var O=f.joinElements([m.getter(r,["column","templateBinding","isOverdue"])||"Всего"===m.getter(r,["column","title"])?f.createText(""):[],m.getter(r,["column","templateBinding","isOverdue"])||m.getter(r,["column","title"])===global.rk.apply(r,["Всего"])||m.getter(r,["column","templateBinding","hideOverdueColumn"])?[f.createControl("wsControl","ws:SBIS3.CONTROLS/Link",{componentOptions:{columnField:m.getter(r,["column","field"]),isOverdue:m.getter(r,["column","templateBinding","isOverdue"]),filterName:m.getter(r,["column","templateBinding","filterName"]),columnId:m.getter(r,["column","templateBinding","columnId"]),nextReportName:m.getter(r,["column","templateBinding","nextReportName"])},handlers:{onActivated:m.getTypeFunc("js!SBIS3.EDO.InnerStat:onActivateColumnCaption",{})},caption:m.getter(r,["column","title"]),className:"regulation-caption",name:m.getter(r,["column","title"]),esc:!1},{name:m.getter(r,["column","title"]),sbisname:m.getter(r,["column","title"])},{data:r,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:v},l,p,S,m.config,s)]:f.createText("")],d,g);g.def&&(O=f.chain(O,g,o),g=void 0)}catch(e){m.templateError("resources/Elektronnyj_dokumentooborot/Statistika/StatTemplateNew/StatEdoBrowserPP/resources/CaptionCell.tmpl",e,r)}return O||""};return r.includedFunctions={},r.stable=!0,r.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.StatEDOBrowserPP/resources/CaptionCell"}},r});
define('js!SBIS3.EDO.StatisticsInnerCurrentNew',['Core/helpers/string-helpers-min','SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.StatisticsInnerCurrentNew','js!SBIS3.EDO.InnerStat','js!SBIS3.EDO.StatFuncs','WS.Data/Source/SbisService','js!SBIS3.EDO.FilterInnerStatCurrentNew','js!SBIS3.EDO.FilterInnerStatCurrentNewSelector','css!SBIS3.EDO.StatisticsReportByPhase','js!SBIS3.EDO.StatEDOBrowserPP','tmpl!SBIS3.EDO.StatEDOBrowserPP/resources/DataCell','tmpl!SBIS3.EDO.StatEDOBrowserPP/resources/ResultCell','tmpl!SBIS3.EDO.StatEDOBrowserPP/resources/CaptionCell','tmpl!SBIS3.EDO.StatEDOBrowserPP/resources/TitleCell','js!SBIS3.Person.PersonPhoto','html!SBIS3.EDO.DetalizationEvents/tplFilterDatePeriod','tmpl!SBIS3.EDO.StatEDOBrowserPP/resources/tplFilterIdRegulations','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterIdRegulations','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterListDispatch','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterMilestone','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterAuthor','tmpl!SBIS3.EDO2.MarksFilterRowTemplate/tmpl/MarksFilterRowTemplate','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterFace1','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterResp','Elektronnyj_dokumentooborot_localization'],function(t,e,i,s,r,l){var a=e.extend({_dotTplFn:i,_self:void 0,$protected:{_options:{filterParams:'',initialFilters:{},customizeFilters:{},showFilterStatPeriod:false,FilterRepeatStages:false,listData:null,serverSideRendering:null,statisticsType:null,itemsActionsVisibility:{edoPrintDocument:false,edoSaveDocumentOnDisk:false,edoSendDocument:false,edoOpenInNewTab:false,edoDeleteDocument:false,edoShowDkPanel:false,edoPostDocument:false,edoRestoreDocument:false,edoSendMessage:false,edoGetLink:false,edoCopyDocument:false,edoShowMonitoringDialog:false,edoShowMarksPanel:false},handlers:null,fastDataFilterConfig:{data:[{keyField:'key',displayField:'title',name:'FilterStatPeriod',multiselect:false,className:'controls-DropdownList__linkStyle',values:[{key:'Все',title:rk('Все')},{key:'На начало',title:rk('На начало')},{key:'Получено',title:rk('Получено')},{key:'Выполнено',title:rk('Выполнено')},{key:'Осталось',title:rk('Осталось')}]}]}}},_modifyOptions:function(e){var i=(e=a.superclass._modifyOptions.call(this,e)).listData&&e.listData.filter?e.listData.filter:e.lastSavedFilters,l={};if(e['historyId']='StatisticsInnerRegulations'+e.statisticsType.toUpperCase()+t.transliterate(e.docType),e.noFastDataFilterClass='','current'==e.statisticsType)l['filterPeriod']=false,l['FilterLimitationDateProc']=true,e.fastDataFilterConfig={},e.noFastDataFilterClass=' stat_edo__fastDataFilterEmpty';else e['resetLinkText']=rk('За последний месяц')+(e['resetLinkText']?', '+e['resetLinkText']:''),l['filterPeriod']=true;if(l['docType']=e.docType,l['docSubType']=e.docSubType,i['ФильтрТипыДокументов'])l['docTypes']=i['ФильтрТипыДокументов'];if(l['customizeFilters']=e.customizeFilters,e['filterComponentOptions']=l,e.columns=s.getStatisticsBrowserColumns(e.listData&&e.listData.items?e.listData.items:null,e.listData?e.listData.filter['ФильтрСрокДата']:false,'StatisticsPhaseReport','ИдРегламента',e.listData&&e.listData.filter['СтолбцовСРегламентами']),e.listData&&e.listData.items){var o=e.listData.items.getMetaData().path,n=o.getCount()>0?o.at(o.getCount()-1).get('Идентификатор'):null;e.currentRoot=n;for(var S=e.listData.items.getFormat()._$items||[],u=e.listData.items.getMetaData().results,p=u.has('-1##Прочее')&&3===u.get('-1##Прочее').split(',').length?parseInt(u.get('-1##Прочее').split(',')[2],10):5,c=[],d=[],f=[],F=11;F<S.length;F++)if(S.hasOwnProperty(F))if(-1!==S[F]._$name.indexOf('##'))if(c.push(S[F]._$name),F>=11+p)d.push(S[F]._$name),f.push(S[F]._$name.split('##')[0]);e.listData.filter['ФильтрСортировкаКолонок']=c,e.other_elements=d,e.other_elements_id=f;}if(e.handlers={onItemClick:[r.onItemClick],onBeforeSetRoot:[s.onBeforeSetRoot],onReady:[s.onReadyEdoBrowser]},e.filterStructure=s.getFilterStructure(i,e.initialFilters),i['ФильтрСтатистикаПериод'])e.FilterStatPeriodValue=e.lastSavedFilters['ФильтрСтатистикаПериод'];return e.itemsSortMethod=r.statReportItemsSortMethod,e;},$constructor:function(){},init:function(){var t=this,e=t._options,i=t.getParent(),s=i.getLinkedContext();a.superclass.init.call(t),a._self=t;var o=t.getChildControlByName('StatisticsInnerCurrentNewBrowser'),n=t.getChildControlByName('browserFastDataFilter'),S=o._getView();if(S._options.enabledMove=false,n&&t._options.fastDataFilterConfig.data)n.setItems(t._options.fastDataFilterConfig.data);S.subscribe('onDataLoad',a.prototype.onDataLoad);var u=new l({endpoint:t._options.docType,binding:{read:'Прочитать',query:'СтатистикаВнутрТекущие',format:t._options.docType+'.СтатистикаВнутрТекущие'}});if(!this._options.listData){t._options.totalReportWidth=o.getTopParent().getContainer().width();var p=t._options.totalReportWidth;S.setFilter(jQuery.extend(S.getFilter(),{'СтолбцовСРегламентами':p}),true),S.setDataSource(u);}o._getFilterButton().subscribe('onApplyFilter',function(t){for(var s=S.getFilter(),l=this.getFilterStructure(),a=0;a<l.length;a++)if(l.hasOwnProperty(a))if(l[a]['filterField'])s[l[a]['filterField']+'Текст']=l[a].caption,s[l[a]['filterField']]=l[a].value;if(s=jQuery.extend(s,e.initialFilters),delete s['ФильтрСортировкаКолонок'],s['ФильтрНеСохранятьСортировку']=true,s['ИдРегламента'])r.saveLastStatisticsFilter(s,i.historyStorage).addCallback(function(){i.setStatisticsTemplate('StatisticsPhaseReport');});else S.setFilter(s);}),n.subscribe('onApplyFilter',function(t){var e=S.getFilter();if(e['ФильтрСтатистикаПериод']=this.getFilterStructure()[0].value,delete e['ФильтрСортировкаКолонок'],this.getFilterStructure()&&this.getFilterStructure()[0]&&'Все'!==this.getFilterStructure()[0].value)S.setFilter(e);else r.saveLastStatisticsFilter(e,i.historyStorage).addCallback(function(){i.setStatisticsTemplate('StatisticsPeriodReport');});}),o._getFilterButton().subscribe('onResetFilter',function(t,i){if(!i){for(var s=S.getFilter(),r=this.getFilterStructure(),l=0;l<r.length;l++)if(r.hasOwnProperty(l))if(r[l]['filterField'])s[r[l]['filterField']]=r[l].value,s[r[l]['filterField']+'Текст']=r[l].caption;delete(s=jQuery.extend(s,e.initialFilters))['ФильтрСортировкаКолонок'],s['ФильтрНеСохранятьСортировку']=true,S.setFilter(s);}});},onDataLoad:function(t,e){var i=this,l=i.getFilter(),o=e.getMetaData().results,n=o.has('-1##Прочее')&&3===o.get('-1##Прочее').split(',').length?parseInt(o.get('-1##Прочее').split(',')[2],10):5,S=[],u=[],p=[],c=e.getFormat()._$items||[],d=e.getMetaData().path,f=d.getCount()>0?d.at(d.getCount()-1).get('Идентификатор'):null;i.setCurrentRoot(f),r.saveLastStatisticsFilter(l,a._self.getParent().historyStorage);for(var F=11;F<c.length;F++)if(c.hasOwnProperty(F))if(-1!==c[F]._$name.indexOf('##'))if(S.push(c[F]._$name),F>=11+n)u.push(c[F]._$name),p.push(c[F]._$name.split('##')[0]);a._self._options.other_elements=u,a._self._options.other_elements_id=p,this.getFilter()['ФильтрСортировкаКолонок']=S,i.setColumns(s.getStatisticsBrowserColumns(e,!!l['ФильтрСрокДата'],'StatisticsPhaseReport','ИдРегламента',l['СтолбцовСРегламентами']));}});return a;});
define("tmpl!SBIS3.EDO.StatisticsReportByPhaseNew",["Core/tmpl/js/tclosure","js!SBIS3.EDO.StatEDOBrowserPP"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.EDO.StatEDOBrowserPP"]=e[1];var i=function e(i,a,s,o,n){function l(){}var d=0,c=void 0!==t&&t?t:arguments[arguments.length-1];void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure"));var g={};n&&n.isSetts&&(g=n.fullContext||{});var p="string"==typeof s?s:"",u=void 0===r?void 0:r,y={id:[],def:void 0},S=c.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,i),h=this&&this.includedTemplates?this.includedTemplates:{},m=c.getMarkupGenerator(o);try{var _=m.joinElements([m.createTag("div",{style:"height:100%;",class:""+c.wrapUndef(c.utils.escape((c.getter(i,["stickyHeader"])?"edo-StatisticsReport":"")+c.getter(i,["noFastDataFilterClass"])))},[m.createControl("wsControl","ws:SBIS3.EDO.StatEDOBrowserPP",{fastDataFilterConfig:{filterStructure:[{filterField:"ФильтрСтатистикаПериод",internalCaptionField:"FilterStatPeriodText",internalValueField:"FilterStatPeriod",resetValue:"Все",value:c.getter(i,["FilterStatPeriodValue"])}],className:"stat_edo__fastDataFilter",idProperty:"name"},filterButtonConfig:{resetLinkText:c.getter(i,["resetLinkText"]),filterStructure:c.getter(i,["filterStructure"]),template:"SBIS3.EDO.FilterInnerStatPhaseNew",additionalFilterParamsTemplate:"SBIS3.EDO.FilterInnerStatPhaseNewSelector",componentOptions:c.getter(i,["filterComponentOptions"])},browserOptions:{hierarchy:{allow:!0,parentProperty:"Раздел",displayProperty:"Название"},common:{firstRequest:!1,filterParams:c.getter(i,["listData"])?c.getter(i,["listData","filter"]):c.getter(i,["lastSavedFilters"]),objectName:"СлужЗап",method:"СтатистикаОтчетПоФазам",navigationType:null},itemsActionsVisibility:c.getter(i,["itemsActionsVisibility"]),allowToggleHead:!0,stickyHeader:c.getter(i,["stickyHeader"]),multiselect:!1,isFolderOnTop:!0,hasSeparator:!1,showHead:!0,viewMode:"table",idProperty:"Идентификатор",bind:"filter",emptyHTML:global.rk("Нет задач"),itemsDragNDrop:!1,showPaging:!1,paging:!1,infiniteScroll:!1,resultsPosition:"top",resultsText:" ",columns:c.getter(i,["columns"]),handlers:c.getter(i,["handlers"]),currentRoot:c.getter(i,["currentRoot"]),itemsSortMethod:c.getter(i,["itemsSortMethod"])},name:"StatisticsReportByPhaseNewBrowser",dataLoadedClass:c.getter(i,["listData"])?"controls-ListView__dataLoaded":"",useScrollContainer:!0,useScope:!1,isSingleTypeBrowser:!1,listData:c.getter(i,["listData"]),serverSideRendering:c.getter(i,["serverSideRendering"]),historyId:c.getter(i,["historyId"]),operationsPanelConfig:!1,applyHistoryFilterOnLoad:!1,esc:!1},{class:"regl-report-hierarchy-view statistics-browser",name:"StatisticsReportByPhaseNewBrowser",sbisname:"StatisticsReportByPhaseNewBrowser"},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:S,internal:{__dirtyCheckingVars_0:c.getter(i,["FilterStatPeriodValue"]),__dirtyCheckingVars_1:c.getter(i,["resetLinkText"]),__dirtyCheckingVars_2:c.getter(i,["filterStructure"]),__dirtyCheckingVars_3:c.getter(i,["filterComponentOptions"]),__dirtyCheckingVars_8:c.getter(i,["listData"])?c.getter(i,["listData","filter"]):c.getter(i,["lastSavedFilters"]),__dirtyCheckingVars_12:c.getter(i,["itemsActionsVisibility"]),__dirtyCheckingVars_14:c.getter(i,["stickyHeader"]),__dirtyCheckingVars_26:c.getter(i,["columns"]),__dirtyCheckingVars_27:c.getter(i,["handlers"]),__dirtyCheckingVars_28:c.getter(i,["currentRoot"]),__dirtyCheckingVars_29:c.getter(i,["itemsSortMethod"])}},s,u,h,c.config,g)],a,y,this)],p,y);y.def&&(_=m.chain(_,y,a),y=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/Statistika/StatisticsReportByPhase/StatisticsReportByPhaseNew.tmpl",e,i)}return _||""};return i.includedFunctions={},i.stable=!0,i.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.StatisticsReportByPhaseNew"}},i});
define("tmpl!SBIS3.EDO.FilterInnerStatPhaseNew",["Core/tmpl/js/tclosure","js!SBIS3.EDO.BaseFilter.Period","js!SBIS3.EDO.PassageStatus","js!SBIS3.EDO.FilterDateLimitation","js!SBIS3.EDO.BaseFilter.Face1","js!SBIS3.EDO.BaseFilter.ResponsibleFace","js!SBIS3.EDO.BaseFilter.ListDispatch","js!SBIS3.EDO.BaseFilter.Limitation","js!SBIS3.EDO.BaseFilter.AuthorOrResponsible","js!SBIS3.EDO.BaseFilter.Milestone","js!SBIS3.EDO.BaseFilter.Marks","js!SBIS3.EDO.BaseFilter.Regulation","js!SBIS3.EDO.RepeatStages","js!SBIS3.EDO.BaseFilter.RightsLimText"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.EDO.BaseFilter.Period"]=e[1],r["js!SBIS3.EDO.PassageStatus"]=e[2],r["js!SBIS3.EDO.FilterDateLimitation"]=e[3],r["js!SBIS3.EDO.BaseFilter.Face1"]=e[4],r["js!SBIS3.EDO.BaseFilter.ResponsibleFace"]=e[5],r["js!SBIS3.EDO.BaseFilter.ListDispatch"]=e[6],r["js!SBIS3.EDO.BaseFilter.Limitation"]=e[7],r["js!SBIS3.EDO.BaseFilter.AuthorOrResponsible"]=e[8],r["js!SBIS3.EDO.BaseFilter.Milestone"]=e[9],r["js!SBIS3.EDO.BaseFilter.Marks"]=e[10],r["js!SBIS3.EDO.BaseFilter.Regulation"]=e[11],r["js!SBIS3.EDO.RepeatStages"]=e[12],r["js!SBIS3.EDO.BaseFilter.RightsLimText"]=e[13];var i=function e(i,o,s,a,n){function l(){}var c=0,S=void 0!==t&&t?t:arguments[arguments.length-1];void 0===S&&(eval("var thelpers = null;"),S=global.requirejs("View/Runner/tclosure"));var p={};n&&n.isSetts&&(p=n.fullContext||{});var u="string"==typeof s?s:"",d=void 0===r?void 0:r,m={id:[],def:void 0},B=S.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,i),F=this&&this.includedTemplates?this.includedTemplates:{},f=S.getMarkupGenerator(a);try{var y=f.joinElements([f.createTag("div",{class:"edo-BaseFilter__filterPicker"},[S.getter(i,["filterPeriod"])?[f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Period",{limited:!0},{},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},s,d,F,S.config,p)]:f.createText(""),S.getter(i,["customizeFilters","FilterPassageStatus"])?[f.createControl("wsControl","ws:SBIS3.EDO.PassageStatus",{},{},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},s,d,F,S.config,p)]:f.createText(""),S.getter(i,["FilterLimitationDateProc"])?[f.createControl("wsControl","ws:SBIS3.EDO.FilterDateLimitation",{},{},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},s,d,F,S.config,p)]:f.createText(""),S.getter(i,["customizeFilters","FilterFace1"])?[f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Face1",{},{},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},s,d,F,S.config,p)]:f.createText(""),S.getter(i,["customizeFilters","FilterResponsibleFace"])?[f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ResponsibleFace",{},{},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},s,d,F,S.config,p)]:f.createText(""),S.getter(i,["customizeFilters","FilterListDispatch"])?[f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ListDispatch",{},{},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},s,d,F,S.config,p)]:f.createText(""),S.getter(i,["customizeFilters","FilterLimitationDate"])?[f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Limitation",{},{},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},s,d,F,S.config,p)]:f.createText(""),S.getter(i,["customizeFilters","FilterAuthorOrResponsible"])?[f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.AuthorOrResponsible",{showCustom:S.getter(i,["customizeFilters","FilterAuthorOrResponsibleMe"])},{},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},s,d,F,S.config,p)]:f.createText(""),S.getter(i,["customizeFilters","FilterMilestone"])?[f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Milestone",{},{},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},s,d,F,S.config,p)]:f.createText(""),S.getter(i,["customizeFilters","FilterMarks"])?[f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Marks",{reestrName:S.getter(i,["docType"]),multiDocsReestr:!!S.getter(i,["docTypes"])},{},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},s,d,F,S.config,p)]:f.createText(""),S.getter(i,["customizeFilters","FilterIdRegulations"])?[f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Regulation",{docTypes:S.getter(i,["idRegulationsDocTypes"]),hidePhase:!0},{},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},s,d,F,S.config,p)]:f.createText(""),S.getter(i,["customizeFilters","FilterRepeatStages"])?[f.createControl("wsControl","ws:SBIS3.EDO.RepeatStages",{},{},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},s,d,F,S.config,p)]:f.createText(""),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.RightsLimText",{textRender:S.getTypeFunc("js!SBIS3.EDO.ScopeFilters:setScopeTextForFilter ",{}),esc:!1},{},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},s,d,F,S.config,p)],o,m,this)],u,m);m.def&&(y=f.chain(y,m,o),m=void 0)}catch(e){S.templateError("resources/Elektronnyj_dokumentooborot/Statistika/StatisticsReportByPhase/FilterInnerStatPhase/FilterInnerStatPhaseNew.tmpl",e,i)}return y||""};return i.includedFunctions={},i.stable=!0,i.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FilterInnerStatPhaseNew"}},i});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.FilterInnerStatPhaseNew", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(""));head.appendChild(style);});}
define('js!SBIS3.EDO.FilterInnerStatPhaseNew',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FilterInnerStatPhaseNew','css!SBIS3.EDO.FilterInnerStatPhaseNew','js!SBIS3.EDO.BaseFilter.Limitation','js!SBIS3.EDO.BaseFilter.Overdue','js!SBIS3.EDO.BaseFilter.Marks','js!SBIS3.EDO.BaseFilter.ResponsibleFace','js!SBIS3.EDO.BaseFilter.Face1','js!SBIS3.EDO.BaseFilter.ListDispatch','js!SBIS3.EDO.BaseFilter.AuthorOrResponsible','js!SBIS3.EDO.BaseFilter.Regulation','js!SBIS3.EDO.BaseFilter.Milestone','js!SBIS3.EDO.BaseFilter.OurOrganisation','js!SBIS3.EDO.ScopeFilters','js!SBIS3.EDO.FilterDateLimitation','Elektronnyj_dokumentooborot_localization'],function(e,t){var i=e.extend({_dotTplFn:t,$protected:{_options:{autoHeight:true,autoWidth:true,docType:'',docSubType:'',customizeFilters:{FilterFace1:true,FilterIdRegulations:true,FilterLimitationDate:true,FilterResponsibleFace:true,FilterAuthorOrResponsibleMe:true,FilterListDispatch:true,FilterPriority:true,FilterMilestone:true,FilterPassageStatus:false,FilterRepeatStages:false,FilterMarks:false,FilterAuthorOrResponsible:false}}},$constructor:function(){},_modifyOptions:function(e){var t=[];if((e=i.superclass._modifyOptions.call(this,e)).docTypes){for(var s=e.docTypes.split(','),r=0;r<s.length;r++)if(s.hasOwnProperty(r))t.push({docTypeString:s[r],subDocTypeString:''});}else if(e.docType)t.push({docTypeString:e.docType,subDocTypeString:e.docSubType});if(e.idRegulationsDocTypes=t,e.FilterLimitationDateProc)e.customizeFilters.FilterLimitationDate=false;return e;},init:function(){i.superclass.init.call(this);}});return i;});
define("tmpl!SBIS3.EDO.FilterInnerStatPhaseNewSelector",["Core/tmpl/js/tclosure","js!SBIS3.EDO.PassageStatusSelector","js!SBIS3.EDO.BaseFilter.Face1Selector","js!SBIS3.EDO.BaseFilter.ResponsibleFaceSelector","js!SBIS3.EDO.BaseFilter.ListDispatchSelector","js!SBIS3.EDO.BaseFilter.LimitationSelector","js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleSelector","js!SBIS3.EDO.BaseFilter.MilestoneSelector","js!SBIS3.EDO.BaseFilter.MarksSelector","js!SBIS3.EDO.BaseFilter.RegulationSelector","js!SBIS3.EDO.RepeatStagesSelector"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.EDO.PassageStatusSelector"]=e[1],r["js!SBIS3.EDO.BaseFilter.Face1Selector"]=e[2],r["js!SBIS3.EDO.BaseFilter.ResponsibleFaceSelector"]=e[3],r["js!SBIS3.EDO.BaseFilter.ListDispatchSelector"]=e[4],r["js!SBIS3.EDO.BaseFilter.LimitationSelector"]=e[5],r["js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleSelector"]=e[6],r["js!SBIS3.EDO.BaseFilter.MilestoneSelector"]=e[7],r["js!SBIS3.EDO.BaseFilter.MarksSelector"]=e[8],r["js!SBIS3.EDO.BaseFilter.RegulationSelector"]=e[9],r["js!SBIS3.EDO.RepeatStagesSelector"]=e[10];var o=function e(o,i,a,s,l){function n(){}var c=0,S=void 0!==t&&t?t:arguments[arguments.length-1];void 0===S&&(eval("var thelpers = null;"),S=global.requirejs("View/Runner/tclosure"));var u={};l&&l.isSetts&&(u=l.fullContext||{});var p="string"==typeof a?a:"",d=void 0===r?void 0:r,F={id:[],def:void 0},B=S.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),m=this&&this.includedTemplates?this.includedTemplates:{},f=S.getMarkupGenerator(s);try{var y=f.joinElements([f.createTag("div",{class:"edo-BaseFilter__filterPicker edo-twoColumnSelectors"},[S.getter(o,["customizeFilters","FilterPassageStatus"])?[f.createControl("wsControl","ws:SBIS3.EDO.PassageStatusSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},a,d,m,S.config,u)]:f.createText(""),S.getter(o,["customizeFilters","FilterFace1"])?[f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Face1Selector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},a,d,m,S.config,u)]:f.createText(""),S.getter(o,["customizeFilters","FilterResponsibleFace"])?[f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ResponsibleFaceSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},a,d,m,S.config,u)]:f.createText(""),S.getter(o,["customizeFilters","FilterListDispatch"])?[f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ListDispatchSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},a,d,m,S.config,u)]:f.createText(""),S.getter(o,["customizeFilters","FilterLimitationDate"])?[f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.LimitationSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},a,d,m,S.config,u)]:f.createText(""),S.getter(o,["customizeFilters","FilterAuthorOrResponsible"])?[f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.AuthorOrResponsibleSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},a,d,m,S.config,u)]:f.createText(""),S.getter(o,["customizeFilters","FilterMilestone"])?[f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.MilestoneSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},a,d,m,S.config,u)]:f.createText(""),S.getter(o,["customizeFilters","FilterMarks"])?[f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.MarksSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},a,d,m,S.config,u)]:f.createText(""),S.getter(o,["customizeFilters","FilterIdRegulations"])?[f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.RegulationSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},a,d,m,S.config,u)]:f.createText(""),S.getter(o,["customizeFilters","FilterRepeatStages"])?[f.createControl("wsControl","ws:SBIS3.EDO.RepeatStagesSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},a,d,m,S.config,u)]:f.createText("")],i,F,this)],p,F);F.def&&(y=f.chain(y,F,i),F=void 0)}catch(e){S.templateError("resources/Elektronnyj_dokumentooborot/Statistika/StatisticsReportByPhase/FilterInnerStatPhase/FilterInnerStatPhaseNewNewSelector/FilterInnerStatPhaseNewSelector.tmpl",e,o)}return y||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FilterInnerStatPhaseNewSelector"}},o});
define('js!SBIS3.EDO.FilterInnerStatPhaseNewSelector',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FilterInnerStatPhaseNewSelector','js!SBIS3.EDO.BaseFilter.LimitationSelector','js!SBIS3.EDO.BaseFilter.OverdueSelector','js!SBIS3.EDO.BaseFilter.MarksSelector','js!SBIS3.EDO.BaseFilter.ResponsibleFaceSelector','js!SBIS3.EDO.BaseFilter.Face1Selector','js!SBIS3.EDO.BaseFilter.ListDispatchSelector','js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleSelector','js!SBIS3.EDO.BaseFilter.RegulationSelector','js!SBIS3.EDO.BaseFilter.MilestoneSelector','js!SBIS3.EDO.BaseFilter.OurOrganisationSelector','js!SBIS3.EDO.PassageStatusSelector','js!SBIS3.EDO.RepeatStagesSelector','i18n!SBIS3.EDO.FilterInnerStatPhaseNewSelector','js!SBIS3.EDO.ScopeFilters','Elektronnyj_dokumentooborot_localization'],function(e,t){var r=e.extend({_dotTplFn:t,$protected:{_options:{autoHeight:true,autoWidth:true,FilterIdRegulations:true,customizeFilters:{FilterFace1:true,FilterIdRegulations:true,FilterLimitationDate:true,FilterResponsibleFace:true,FilterAuthorOrResponsibleMe:true,FilterListDispatch:true,FilterPriority:true,FilterMilestone:true,FilterPassageStatus:false,FilterRepeatStages:false,FilterMarks:false,FilterAuthorOrResponsible:false}}},$constructor:function(){},_modifyOptions:function(e){if(e=r.superclass._modifyOptions.call(this,e),e.FilterLimitationDateProc)e.customizeFilters.FilterLimitationDate=false;return e;},init:function(){r.superclass.init.call(this);}});return r;});
define('js!SBIS3.EDO.StatisticsReportByPhaseNew',['Core/helpers/string-helpers-min','SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.StatisticsReportByPhaseNew','js!SBIS3.EDO.InnerStat','js!SBIS3.EDO.StatFuncs','WS.Data/Source/SbisService','js!SBIS3.EDO.StatEDOBrowserPP','tmpl!SBIS3.EDO.StatEDOBrowserPP/resources/DataCell','tmpl!SBIS3.EDO.StatEDOBrowserPP/resources/ResultCell','tmpl!SBIS3.EDO.StatEDOBrowserPP/resources/CaptionCell','tmpl!SBIS3.EDO.StatEDOBrowserPP/resources/TitleCell','html!SBIS3.EDO.DetalizationEvents/tplFilterDatePeriod','tmpl!SBIS3.EDO.StatEDOBrowserPP/resources/tplFilterIdRegulations','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterIdRegulations','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterListDispatch','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterMilestone','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterAuthor','tmpl!SBIS3.EDO2.MarksFilterRowTemplate/tmpl/MarksFilterRowTemplate','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterFace1','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterResp','js!SBIS3.EDO.FilterInnerStatPhaseNew','js!SBIS3.EDO.FilterInnerStatPhaseNewSelector','css!SBIS3.EDO.StatisticsReportByPhase','js!SBIS3.Person.PersonPhoto','Elektronnyj_dokumentooborot_localization'],function(t,e,s,i,a,l){var r=e.extend({_dotTplFn:s,_self:void 0,$protected:{_options:{autoHeight:true,autoWidth:true,filterParams:'',customizeFilters:{},showFilterStatPeriod:false,listData:null,serverSideRendering:null,statisticsType:null,itemsActionsVisibility:{edoPrintDocument:false,edoSaveDocumentOnDisk:false,edoSendDocument:false,edoOpenInNewTab:false,edoDeleteDocument:false,edoShowDkPanel:false,edoPostDocument:false,edoRestoreDocument:false,edoSendMessage:false,edoGetLink:false,edoCopyDocument:false,edoShowMonitoringDialog:false,edoShowMarksPanel:false},handlers:null,resetLinkText:null,fastDataFilterConfig:{data:[{keyField:'key',displayField:'title',name:'FilterStatPeriod',multiselect:false,className:'controls-DropdownList__linkStyle',values:[{key:'Все',title:rk('Все')},{key:'На начало',title:rk('На начало')},{key:'Получено',title:rk('Получено')},{key:'Выполнено',title:rk('Выполнено')},{key:'Осталось',title:rk('Осталось')}]}]}}},_modifyOptions:function(e){var s=(e=r.superclass._modifyOptions.call(this,e)).listData&&e.listData.filter?e.listData.filter:e.lastSavedFilters,l={};if(e['historyId']='StatisticsPhaseReport'+e.statisticsType.toUpperCase()+t.transliterate(e.docType),e.noFastDataFilterClass='','current'==e.statisticsType)l['filterPeriod']=false,l['FilterLimitationDateProc']=true,e.fastDataFilterConfig={},e.noFastDataFilterClass=' stat_edo__fastDataFilterEmpty';else e['resetLinkText']=rk('За последний месяц')+(e['resetLinkText']?', '+e['resetLinkText']:''),l['filterPeriod']=true;if(l['docType']=e.docType,l['docSubType']=e.docSubType,s['ФильтрТипыДокументов'])l['docTypes']=s['ФильтрТипыДокументов'];l['customizeFilters']=e.customizeFilters,e['filterComponentOptions']=l,e.handlers={onItemClick:[a.onItemClick],onBeforeSetRoot:[i.onBeforeSetRoot],onReady:[i.onReadyEdoBrowser]};var o=e.listData&&'Выполнено'===e.listData.filter['ФильтрСтатистикаПериод']?'StatisticsTransReport':'';if(e.columns=i.getStatisticsBrowserColumns(e.listData&&e.listData.items?e.listData.items:null,e.listData?e.listData.filter['ФильтрСрокДата']:false,o,'ФильтрИдФазы',e.listData&&e.listData.filter['СтолбцовСРегламентами']),e.listData&&e.listData.items){var n=e.listData.items.getMetaData().path,S=n.getCount()>0?n.at(n.getCount()-1).get('Идентификатор'):null;e.currentRoot=S;for(var p=e.listData.items.getFormat()._$items||[],u=e.listData.items.getMetaData().results,c=u.has('-1##Прочее')&&3===u.get('-1##Прочее').split(',').length?parseInt(u.get('-1##Прочее').split(',')[2],10):5,d=[],f=[],F=[],D=11;D<p.length;D++)if(p.hasOwnProperty(D))if(-1!==p[D]._$name.indexOf('##'))if(d.push(p[D]._$name),D>=11+c)f.push(p[D]._$name),F.push(p[D]._$name.split('##')[0]);e.listData.filter['ФильтрСортировкаКолонок']=d,e.other_elements=f,e.other_elements_id=F;}if(e.filterStructure=i.getFilterStructure(s,e.initialFilters),s['ФильтрСтатистикаПериод'])e.FilterStatPeriodValue=e.lastSavedFilters['ФильтрСтатистикаПериод'];return e.itemsSortMethod=a.statReportItemsSortMethod,e;},$constructor:function(){},init:function(){var t=this,e=t._options,s=t.getParent(),i=s.getLinkedContext();r.superclass.init.call(t),r._self=this;var o=t.getChildControlByName('StatisticsReportByPhaseNewBrowser'),n=t.getChildControlByName('browserFastDataFilter'),S=o._getView();if(n&&t._options.fastDataFilterConfig.data)n.setItems(t._options.fastDataFilterConfig.data);S.subscribe('onDataLoad',r.prototype.onDataLoad);var p=new l({endpoint:t._options.docType,binding:{read:'Прочитать',query:'СтатистикаОтчетПоФазам',format:t._options.docType+'.СтатистикаОтчетПоФазам'}});if(!this._options.listData){t._options.totalReportWidth=o.getTopParent().getContainer().width();var u=t._options.totalReportWidth,c=t._options.lastSavedFilters;c['СтолбцовСРегламентами']=u,S.setFilter(jQuery.extend(S.getFilter(),c),true),S.setDataSource(p);}o._getFilterButton().subscribe('onApplyFilter',function(t){for(var i=S.getFilter(),l=this.getFilterStructure(),r=0;r<l.length;r++)if(l.hasOwnProperty(r))if(l[r]['filterField'])i[l[r]['filterField']+'Текст']=l[r].caption,i[l[r]['filterField']]=l[r].value;if(i=jQuery.extend(i,e.initialFilters),delete i['ФильтрСортировкаКолонок'],i['ФильтрНеСохранятьСортировку']=true,!i['ИдРегламента'])a.saveLastStatisticsFilter(i,s.historyStorage).addCallback(function(){s.setStatisticsTemplate('StatisticsInnerCurrent');});else S.setFilter(i);}),n.subscribe('onApplyFilter',function(t){var e=S.getFilter();if(e['ФильтрСтатистикаПериод']=this.getFilterStructure()[0].value,delete e['ФильтрСортировкаКолонок'],this.getFilterStructure()&&this.getFilterStructure()[0]&&'Все'!==this.getFilterStructure()[0].value)S.setFilter(e);else a.saveLastStatisticsFilter(e,s.historyStorage).addCallback(function(){s.setStatisticsTemplate('StatisticsPeriodReport');});}),o._getFilterButton().subscribe('onResetFilter',function(t,i){if(!i){for(var l=S.getFilter(),r=this.getFilterStructure(),o=0;o<r.length;o++)if(r.hasOwnProperty(o))if(r[o]['filterField'])l[r[o]['filterField']]=r[o].value,l[r[o]['filterField']+'Текст']=r[o].caption;if(l=jQuery.extend(l,e.initialFilters),delete l['ФильтрСортировкаКолонок'],l['ФильтрНеСохранятьСортировку']=true,!l['ИдРегламента'])a.saveLastStatisticsFilter(l,s.historyStorage).addCallback(function(){s.setStatisticsTemplate('StatisticsInnerCurrent');});else S.setFilter(l);}});},onDataLoad:function(t,e){var s=this,l=s.getFilter(),o=e.getMetaData().results,n=[],S=[],p=[],u=e.getFormat()._$items||[],c='Выполнено'===l['ФильтрСтатистикаПериод']?'StatisticsTransReport':'',d=o.has('-1##Прочее')&&3===o.get('-1##Прочее').split(',').length?parseInt(o.get('-1##Прочее').split(',')[2],10):5,f=e.getMetaData().path,F=f.getCount()>0?f.at(f.getCount()-1).get('Идентификатор'):null;s.setCurrentRoot(F),a.saveLastStatisticsFilter(l,r._self.getParent().historyStorage);for(var D=11;D<u.length;D++)if(u.hasOwnProperty(D))if(-1!==u[D]._$name.indexOf('##'))if(n.push(u[D]._$name),D>=11+d)S.push(u[D]._$name),p.push(u[D]._$name.split('##')[0]);r._self._options.other_elements=S,r._self._options.other_elements_id=p,this.getFilter()['ФильтрСортировкаКолонок']=n,s.setColumns(i.getStatisticsBrowserColumns(e,l['ФильтрСрокДата'],c,'ФильтрИдФазы',l['СтолбцовСРегламентами']));}});return r;});
define("html!SBIS3.EDO.StatisticsReportTransitionsNew",function(){var o=function(o){var t=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;o.test(t);)t=t.replace(o,"&#123;&#123;$1&#125;&#125;");return t}}(),n=function(o){return o.join?o.join(""):o.toString()},e=function(o){return void 0===o?"":o&&"object"==typeof o?n(o):""+o},i="undefined"!=typeof process,a=("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),p=function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,s='<div class="';return o.stickyHeader&&(s+="edo-StatisticsReport"),s+='" style="height:100%"> <component data-component="SBIS3.EDO.StatEDOBrowser" name="StatisticsReportTransitionsNewBrowser" class="regl-report-hierarchy-view statistics-browser"> <option name="historyId">'+t(e(o.historyId))+'</option> <option name="applyHistoryFilterOnLoad">false</option> <options name="browserOptions"> <option name="idProperty">Идентификатор</option> <option name="stickyHeader">'+t(e(o.stickyHeader))+'</option> <option name="bind">StatisticsFilter/button</option> <option name="multiselect">false</option> <option name="showPaging">false</option> <option name="paging">false</option> <option name="infiniteScroll">false</option> <option name="resultsPosition">top</option> <option name="resultsText" value="  "></option> <option name="itemsDragNDrop">false</option> <options name="itemsActionsVisibility"> <option name="edoPrintDocument" value="false"></option> <option name="edoSaveDocumentOnDisk" value="false"></option> <option name="edoSendDocument" value="false"></option> <option name="edoSendMessage" value="false"></option> <option name="edoGetLink" value="false"></option> <option name="edoOpenInNewTab" value="false"></option> <option name="edoDeleteDocument" value="false"></option> <option name="edoCopyDocument" value="false"></option> <option name="edoShowMarksPanel" value="false"></option> <option name="edoShowMonitoringDialog" value="false"></option> <option name="edoPostDocument" value="false"></option> <option name="edoRestoreDocument" value="false"></option> <option name="edoShowDkPanel" value="false"></option> </options> <options name="columns" type="array"> <options> <option name="field">Название</option> <option name="title" value=" "></option> <option name="className">controls-DataGridView-cell-overflow-ellipsis Название</option> <option name="cellTemplate">tmpl!SBIS3.EDO.StatEDOBrowserPP/resources/TitleCell</option> <option name="resultTemplate">html!SBIS3.EDO.Statistics.ColumnsTemplate.ResultRender</option> <options name="templateBinding"> <option name="photoFldName">userPhotoData</option> <option name="cssClass">person-photo-mini-large</option> <option name="isPeriodStatReport">false</option> </options> </options> </options> <options name="handlers"> <options name="onDataLoad" type="array"> <option name="onDataLoad" type="function">js!SBIS3.EDO.StatisticsReportTransitionsNew:prototype.onDataLoad</option> </options> <options name="onItemClick" type="array"> <option name="onItemClick" type="function">js!SBIS3.EDO.StatFuncs:onItemClick</option> </options> <options name="onBeforeSetRoot" type="array"> <option name="onBeforeSetRoot" type="function">js!SBIS3.EDO.InnerStat:onBeforeSetRoot</option> </options> <options name="onReady" type="array"> <option name="onReady" type="function">js!SBIS3.EDO.InnerStat:onReadyEdoBrowser</option> </options> </options> <option name="viewMode">table</option> <options name="hierarchy"> <option name="allow">true</option> <option name="parentProperty">Раздел</option> <option name="displayProperty">Название</option> </options> <option name="showHead">true</option> </options> <option name="fastDataFilterConfig"> </option> <option name="searchConfig"> </option> <options name="ignoreFiltersList" type="array"> <option>ФильтрВладелец</option> </options> <option name="operationsPanelConfig">false</option> ',o.filterButtonConfig?s+=' <option name="filterButtonConfig" type="ref">'+t(e(function(o,t){var n=a.randomId();return o[n]=t,n}(p,o.filterButtonConfig)))+"</option> ":s+=' <option name="filterButtonConfig"> <option name="template"><component data-component="SBIS3.EDO.FilterInnerStatTransNew"> <options name="componentOptions"> '+t(e(o.filterComponentOptions))+' </options> </component></option> <option name="resetLinkText">'+t(e(rk("За последний месяц")))+'</option> <options name="filterStructure" type="array"> '+t(e(o.filterStructure))+' <opts> <opt name="internalValueField">FilterIdPhase</opt> <opt name="internalCaptionField">FilterIdPhaseText</opt> <opt name="value" bind="filter/ФильтрИдФазы"></opt> <opt name="caption" bind="filter/ФильтрИдФазыТекст"></opt> <opt name="resetValue" type="null">null</opt> <opt name="filterBLName" value="ФильтрИдФазы"></opt> </opts> </options> </option> ',s+=" </component> </div> ",(s=t(s))+(i&&-1!==s.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.StatisticsReportTransitionsNew"}},o});
define("html!SBIS3.EDO.Statistics.ColumnsTemplate.DataCell",function(){var e=function(e){var t=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;e.test(t);)t=t.replace(e,"&#123;&#123;$1&#125;&#125;");return t}}(),n=function(e){return e.join?e.join(""):e.toString()},i=function(e){return void 0===e?"":e&&"object"==typeof e?n(e):""+e},r="undefined"!=typeof process,o=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,""),a="Просрочено"==e.templateBinding.fieldName?"Итого":e.templateBinding.fieldName,l=!!e.templateBinding.isOverdue,s=(e.templateBinding.isTotal,l?"edo-statistics-overdue-count ":""),u=(e.item.get(a)||"")[l?1:0],d="Просрочено"!==a&&"Итого"!==a?a.split("##")[0]:void 0,p=l?"":"-1##Прочее"===a?"margin-right: 4px;":"";return s+=0!==u?"phase-report-link":"",o+=' <span class="',0!==u&&(o+=t(i(s))),o+='" style="text-align: right; '+t(i(p))+'" ',0!==u&&void 0!==d&&(o+=' param_value="'+t(i(d))+'" '),o+="> ",0!==u&&(o+=t(i(u))),o+=" </span> ",(o=t(o))+(r&&-1!==o.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.Statistics.ColumnsTemplate.DataCell"}},e});
define('js!SBIS3.EDO.Statistics.ColumnsTemplate.DataCell',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.Statistics.ColumnsTemplate.DataCell','Elektronnyj_dokumentooborot_localization'],function(t,n){'use strict';var e=t.extend({_dotTplFn:n,$protected:{_options:{name:'Statistics.ColumnsTemplate.DataCell'}},$constructor:function(){},init:function(){var t=this;e.superclass.init.call(t);}});return e;});
define("html!SBIS3.EDO.Statistics.ColumnsTemplate.ResultRender",function(){var e=function(e){var n=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;e.test(n);)n=n.replace(e,"&#123;&#123;$1&#125;&#125;");return n}}(),t=function(e){return e.join?e.join(""):e.toString()},o=function(e){return void 0===e?"":e&&"object"==typeof e?t(e):""+e},i="undefined"!=typeof process,r=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,"");if("Название"!==e.column.field){var l="Просрочено"===e.column.field?"Итого":e.column.field,a=e.column.templateBinding.isOverdue?1:0,s=e.item.has(l)&&e.item.get(l)?e.item.get(l):null,u=s?"ФильтрИдПерехода"===e.column.templateBinding.filterName?parseInt(s[a],10):parseInt(s.split(",")[a],10):0,m=("Просрочено"!==l&&"Итого"!==l&&l.split("##")[0],0!==parseInt(u,10)?"phase-report-link":"");1===a&&(m+=" edo-statistics-overdue-count")}else var u="",m="";return r+=' <component data-component="SBIS3.CONTROLS/Link" class="'+n(o(m))+' controls-Link__disabledHover" style="text-align:right;"> <option name="caption">',0!==u&&(r+=n(o(u))),r+='</option> <options name="componentOptions"> <option name="columnId" value="'+n(o(e.column.templateBinding.columnId))+'"></option> <option name="columnField" value="'+n(o(e.column.field))+'"></option> <option name="isOverdue" value="'+n(o(e.column.templateBinding.isOverdue))+'"></option> <option name="filterName" value="'+n(o(e.column.templateBinding.filterName))+'"></option> </options> <options name="handlers"> <option name="onActivated" type="function">js!SBIS3.EDO.InnerStat:onActivateResult</option> </options> </component> ',(r=n(r))+(i&&-1!==r.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.Statistics.ColumnsTemplate.ResultRender"}},e});
define('js!SBIS3.EDO.Statistics.ColumnsTemplate.ResultRender',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.Statistics.ColumnsTemplate.ResultRender','html!SBIS3.PersonCore.Photo/photoCellTpl','css!SBIS3.EDO.InnerStat','SBIS3.CONTROLS/Link','js!SBIS3.EDO.InnerStat','Elektronnyj_dokumentooborot_localization'],function(t,e){'use strict';var n=t.extend({_dotTplFn:e,$protected:{_options:{name:'Statistics.ColumnsTemplate.ResultRender'}},$constructor:function(){},init:function(){var t=this;n.superclass.init.call(t);}});return n;});
define("tmpl!SBIS3.EDO.FilterInnerStatTransNew",["Core/tmpl/js/tclosure","js!SBIS3.EDO.BaseFilter.Period","js!SBIS3.EDO.PassageStatus","js!SBIS3.EDO.BaseFilter.Face1","js!SBIS3.EDO.BaseFilter.ResponsibleFace","js!SBIS3.EDO.BaseFilter.ListDispatch","js!SBIS3.EDO.BaseFilter.Limitation","js!SBIS3.EDO.BaseFilter.AuthorOrResponsible","js!SBIS3.EDO.BaseFilter.Milestone","js!SBIS3.EDO.BaseFilter.Marks","js!SBIS3.EDO.BaseFilter.Regulation","js!SBIS3.EDO.RepeatStages","js!SBIS3.EDO.BaseFilter.RightsLimText"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.EDO.BaseFilter.Period"]=e[1],r["js!SBIS3.EDO.PassageStatus"]=e[2],r["js!SBIS3.EDO.BaseFilter.Face1"]=e[3],r["js!SBIS3.EDO.BaseFilter.ResponsibleFace"]=e[4],r["js!SBIS3.EDO.BaseFilter.ListDispatch"]=e[5],r["js!SBIS3.EDO.BaseFilter.Limitation"]=e[6],r["js!SBIS3.EDO.BaseFilter.AuthorOrResponsible"]=e[7],r["js!SBIS3.EDO.BaseFilter.Milestone"]=e[8],r["js!SBIS3.EDO.BaseFilter.Marks"]=e[9],r["js!SBIS3.EDO.BaseFilter.Regulation"]=e[10],r["js!SBIS3.EDO.RepeatStages"]=e[11],r["js!SBIS3.EDO.BaseFilter.RightsLimText"]=e[12];var o=function e(o,i,s,n,a){function l(){}var c=0,p=void 0!==t&&t?t:arguments[arguments.length-1];void 0===p&&(eval("var thelpers = null;"),p=global.requirejs("View/Runner/tclosure"));var S={};a&&a.isSetts&&(S=a.fullContext||{});var u="string"==typeof s?s:"",d=void 0===r?void 0:r,m={id:[],def:void 0},B=p.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),F=this&&this.includedTemplates?this.includedTemplates:{},O=p.getMarkupGenerator(n);try{var f=O.joinElements([O.createTag("div",{class:"edo-BaseFilter__filterPicker"},[p.getter(o,["componentOptions","filterPeriod"])?[O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Period",{limited:!0},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},s,d,F,p.config,S)]:O.createText(""),p.getter(o,["componentOptions","customizeFilters","FilterPassageStatus"])?[O.createControl("wsControl","ws:SBIS3.EDO.PassageStatus",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},s,d,F,p.config,S)]:O.createText(""),p.getter(o,["componentOptions","customizeFilters","FilterFace1"])?[O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Face1",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},s,d,F,p.config,S)]:O.createText(""),p.getter(o,["componentOptions","customizeFilters","FilterResponsibleFace"])?[O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ResponsibleFace",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},s,d,F,p.config,S)]:O.createText(""),p.getter(o,["componentOptions","customizeFilters","FilterListDispatch"])?[O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ListDispatch",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},s,d,F,p.config,S)]:O.createText(""),p.getter(o,["componentOptions","customizeFilters","FilterLimitationDate"])?[O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Limitation",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},s,d,F,p.config,S)]:O.createText(""),p.getter(o,["componentOptions","customizeFilters","FilterAuthorOrResponsible"])?[O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.AuthorOrResponsible",{showCustom:p.getter(o,["customizeFilters","FilterAuthorOrResponsibleMe"])},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},s,d,F,p.config,S)]:O.createText(""),p.getter(o,["componentOptions","customizeFilters","FilterMilestone"])?[O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Milestone",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},s,d,F,p.config,S)]:O.createText(""),p.getter(o,["componentOptions","customizeFilters","FilterMarks"])?[O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Marks",{reestrName:p.getter(o,["docType"]),multiDocsReestr:!!p.getter(o,["docTypes"])},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},s,d,F,p.config,S)]:O.createText(""),p.getter(o,["componentOptions","customizeFilters","FilterIdRegulations"])?[O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Regulation",{docTypes:p.getter(o,["idRegulationsDocTypes"])},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},s,d,F,p.config,S)]:O.createText(""),p.getter(o,["componentOptions","customizeFilters","FilterRepeatStages"])?[O.createControl("wsControl","ws:SBIS3.EDO.RepeatStages",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},s,d,F,p.config,S)]:O.createText(""),O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.RightsLimText",{textRender:p.getTypeFunc("js!SBIS3.EDO.ScopeFilters:setScopeTextForFilter ",{}),esc:!1},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:B},s,d,F,p.config,S)],i,m,this)],u,m);m.def&&(f=O.chain(f,m,i),m=void 0)}catch(e){p.templateError("resources/Elektronnyj_dokumentooborot/Statistika/StatisticsReportTransitions/FilterInnerStatTrans/FilterInnerStatTransNew.tmpl",e,o)}return f||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FilterInnerStatTransNew"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.FilterInnerStatTransNew", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(""));head.appendChild(style);});}
define('js!SBIS3.EDO.FilterInnerStatTransNew',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FilterInnerStatTransNew','css!SBIS3.EDO.FilterInnerStatTransNew','js!SBIS3.EDO.BaseFilter.Limitation','js!SBIS3.EDO.BaseFilter.Overdue','js!SBIS3.EDO.BaseFilter.Marks','js!SBIS3.EDO.BaseFilter.ResponsibleFace','js!SBIS3.EDO.BaseFilter.Face1','js!SBIS3.EDO.BaseFilter.ListDispatch','js!SBIS3.EDO.BaseFilter.AuthorOrResponsible','js!SBIS3.EDO.BaseFilter.Regulation','js!SBIS3.EDO.BaseFilter.Milestone','js!SBIS3.EDO.BaseFilter.OurOrganisation','js!SBIS3.EDO.ScopeFilters','Elektronnyj_dokumentooborot_localization'],function(e,t){var i=e.extend({_dotTplFn:t,$protected:{_options:{autoHeight:true,autoWidth:true,docType:'',docSubType:'',componentOptions:{filterPeriod:true,customizeFilters:{FilterFace1:true,FilterIdRegulations:true,FilterLimitationDate:true,FilterResponsibleFace:true,FilterAuthorOrResponsibleMe:true,FilterListDispatch:true,FilterPriority:true,FilterMilestone:true,FilterPassageStatus:false,FilterRepeatStages:false,FilterMarks:false,FilterAuthorOrResponsible:false}}}},$constructor:function(){},_modifyOptions:function(e){var t=[];if((e=i.superclass._modifyOptions.call(this,e)).docTypes){for(var s=e.docTypes.split(','),r=0;r<s.length;r++)if(s.hasOwnProperty(r))t.push({docTypeString:s[r],subDocTypeString:''});}else if(e.docType)t.push({docTypeString:e.docType,subDocTypeString:e.docSubType});return e.idRegulationsDocTypes=t,e;},init:function(){i.superclass.init.call(this);}});return i;});
define("tmpl!SBIS3.EDO.FilterInnerStatTransNewSelector",["Core/tmpl/js/tclosure","js!SBIS3.EDO.PassageStatusSelector","js!SBIS3.EDO.BaseFilter.Face1Selector","js!SBIS3.EDO.BaseFilter.ResponsibleFaceSelector","js!SBIS3.EDO.BaseFilter.ListDispatchSelector","js!SBIS3.EDO.BaseFilter.LimitationSelector","js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleSelector","js!SBIS3.EDO.BaseFilter.MilestoneSelector","js!SBIS3.EDO.BaseFilter.MarksSelector","js!SBIS3.EDO.BaseFilter.RegulationSelector","js!SBIS3.EDO.RepeatStagesSelector"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.EDO.PassageStatusSelector"]=e[1],r["js!SBIS3.EDO.BaseFilter.Face1Selector"]=e[2],r["js!SBIS3.EDO.BaseFilter.ResponsibleFaceSelector"]=e[3],r["js!SBIS3.EDO.BaseFilter.ListDispatchSelector"]=e[4],r["js!SBIS3.EDO.BaseFilter.LimitationSelector"]=e[5],r["js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleSelector"]=e[6],r["js!SBIS3.EDO.BaseFilter.MilestoneSelector"]=e[7],r["js!SBIS3.EDO.BaseFilter.MarksSelector"]=e[8],r["js!SBIS3.EDO.BaseFilter.RegulationSelector"]=e[9],r["js!SBIS3.EDO.RepeatStagesSelector"]=e[10];var o=function e(o,i,s,n,a){function l(){}var c=0,S=void 0!==t&&t?t:arguments[arguments.length-1];void 0===S&&(eval("var thelpers = null;"),S=global.requirejs("View/Runner/tclosure"));var p={};a&&a.isSetts&&(p=a.fullContext||{});var u="string"==typeof s?s:"",m=void 0===r?void 0:r,d={id:[],def:void 0},F=S.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),B=this&&this.includedTemplates?this.includedTemplates:{},O=S.getMarkupGenerator(n);try{var f=O.joinElements([O.createTag("div",{class:"edo-BaseFilter__filterPicker edo-twoColumnSelectors"},[S.getter(o,["componentOptions","customizeFilters","FilterPassageStatus"])?[O.createControl("wsControl","ws:SBIS3.EDO.PassageStatusSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:F},s,m,B,S.config,p)]:O.createText(""),S.getter(o,["componentOptions","customizeFilters","FilterFace1"])?[O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Face1Selector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:F},s,m,B,S.config,p)]:O.createText(""),S.getter(o,["componentOptions","customizeFilters","FilterResponsibleFace"])?[O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ResponsibleFaceSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:F},s,m,B,S.config,p)]:O.createText(""),S.getter(o,["componentOptions","customizeFilters","FilterListDispatch"])?[O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ListDispatchSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:F},s,m,B,S.config,p)]:O.createText(""),S.getter(o,["componentOptions","customizeFilters","FilterLimitationDate"])?[O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.LimitationSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:F},s,m,B,S.config,p)]:O.createText(""),S.getter(o,["componentOptions","customizeFilters","FilterAuthorOrResponsible"])?[O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.AuthorOrResponsibleSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:F},s,m,B,S.config,p)]:O.createText(""),S.getter(o,["componentOptions","customizeFilters","FilterMilestone"])?[O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.MilestoneSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:F},s,m,B,S.config,p)]:O.createText(""),S.getter(o,["componentOptions","customizeFilters","FilterMarks"])?[O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.MarksSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:F},s,m,B,S.config,p)]:O.createText(""),S.getter(o,["componentOptions","customizeFilters","FilterIdRegulations"])?[O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.RegulationSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:F},s,m,B,S.config,p)]:O.createText(""),S.getter(o,["componentOptions","customizeFilters","FilterRepeatStages"])?[O.createControl("wsControl","ws:SBIS3.EDO.RepeatStagesSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:F},s,m,B,S.config,p)]:O.createText("")],i,d,this)],u,d);d.def&&(f=O.chain(f,d,i),d=void 0)}catch(e){S.templateError("resources/Elektronnyj_dokumentooborot/Statistika/StatisticsReportTransitions/FilterInnerStatTrans/FilterInnerStatTransNewSelector/FilterInnerStatTransNewSelector.tmpl",e,o)}return f||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FilterInnerStatTransNewSelector"}},o});
define('js!SBIS3.EDO.FilterInnerStatTransNewSelector',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FilterInnerStatTransNewSelector','js!SBIS3.EDO.BaseFilter.LimitationSelector','js!SBIS3.EDO.BaseFilter.OverdueSelector','js!SBIS3.EDO.BaseFilter.MarksSelector','js!SBIS3.EDO.BaseFilter.ResponsibleFaceSelector','js!SBIS3.EDO.BaseFilter.Face1Selector','js!SBIS3.EDO.BaseFilter.ListDispatchSelector','js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleSelector','js!SBIS3.EDO.BaseFilter.RegulationSelector','js!SBIS3.EDO.BaseFilter.MilestoneSelector','js!SBIS3.EDO.BaseFilter.OurOrganisationSelector','js!SBIS3.EDO.PassageStatusSelector','js!SBIS3.EDO.RepeatStagesSelector','i18n!SBIS3.EDO.FilterInnerStatTransNewSelector','js!SBIS3.EDO.ScopeFilters','Elektronnyj_dokumentooborot_localization'],function(e,t){var r=e.extend({_dotTplFn:t,$protected:{_options:{autoHeight:true,autoWidth:true,FilterIdRegulations:true,componentOptions:{customizeFilters:{FilterFace1:true,FilterIdRegulations:true,FilterLimitationDate:true,FilterResponsibleFace:true,FilterAuthorOrResponsibleMe:true,FilterListDispatch:true,FilterPriority:true,FilterMilestone:true,FilterPassageStatus:false,FilterRepeatStages:false,FilterMarks:false,FilterAuthorOrResponsible:false}}}},$constructor:function(){},init:function(){r.superclass.init.call(this);}});return r;});
define('js!SBIS3.EDO.StatisticsReportTransitionsNew',['Lib/Control/Control','Core/core-functions','Core/helpers/string-helpers-min','SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.StatisticsReportTransitionsNew','js!SBIS3.EDO.InnerStat','js!SBIS3.EDO.StatFuncs','WS.Data/Source/SbisService','js!SBIS3.EDO.Statistics.ColumnsTemplate.DataCell','tmpl!SBIS3.EDO.StatEDOBrowserPP/resources/TitleCell','js!SBIS3.EDO.Statistics.ColumnsTemplate.ResultRender','js!SBIS3.EDO.Statistics.ColumnsTemplate.CaptionRender','js!SBIS3.EDO.FilterInnerStatTransNew','js!SBIS3.EDO.FilterInnerStatTransNewSelector','css!SBIS3.EDO.StatisticsReportByPhase','js!SBIS3.EDO.StatEDOBrowser','html!SBIS3.EDO.DetalizationEvents/tplFilterDatePeriod','tmpl!SBIS3.EDO.StatEDOBrowserPP/resources/tplFilterIdRegulations','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterIdRegulations','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterListDispatch','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterMilestone','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterAuthor','tmpl!SBIS3.EDO2.MarksFilterRowTemplate/tmpl/MarksFilterRowTemplate','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterFace1','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterResp','Elektronnyj_dokumentooborot_localization'],function(t,e,s,a,l,r,o,n){var u=a.extend({_dotTplFn:l,_self:void 0,$protected:{_options:{autoHeight:true,autoWidth:true,customizeFilters:{},statisticsType:null}},_modifyOptions:function(t){var e,i='';if(i+='<option name="docType" value="'+(t=u.superclass._modifyOptions.call(this,t)).docType+'"></option>',i+='<option name="docSubType" value="'+t.docSubType+'"></option>',t.initialFilters['ФильтрТипыДокументов'])i+='<option name="docTypes" value="'+t.initialFilters['ФильтрТипыДокументов']+'"></option>';if(!o.isEmptyObject(t['customizeFilters'])){var a='<options name="customizeFilters">';for(var l in t['customizeFilters'])if(t['customizeFilters'].hasOwnProperty(l))a+='<option name="'+l+'" value="'+t['customizeFilters'][l]+'"></option>';i+=a+='</options>';}return t['historyId']='StatisticsTransReport'+t.statisticsType.toUpperCase()+s.transliterate(t.docType),t['filterComponentOptions']=i,t['filterStructure']=r.getStatisticsFilterStructure(t.initialFilters),t;},$constructor:function(){},init:function(){var t=this,i=t._options,s=t.getParent(),a=s.getLinkedContext();u.superclass.init.call(t),u._self=this;var l=t.getChildControlByName('StatisticsReportTransitionsNewBrowser'),p=l._getView(),S=t._options.showFilterStatPeriod?t.getChildControlByName('browserFastDataFilter'):null;p&&p.setItemsSortMethod&&p.setItemsSortMethod(o.statReportItemsSortMethod),r.synchStatFilters(t,l,a),p.initial_columns=p.getColumns();var m=new n({endpoint:t._options.docType,binding:{read:'Прочитать',query:'СтатистикаОтчетПоПереходам',format:t._options.docType+'.СтатистикаОтчетПоПереходам'}});if(S)S.setItems(t._options.fastDataFilterConfig.data);p.setDataSource(m),l._getFilterButton().subscribe('onApplyFilter',function(t){for(var e=this.getFilterStructure(),l=0;l<e.length;l++)if(e.hasOwnProperty(l))if(e[l]['filterBLName'])a.setValue('filter/'+e[l]['filterBLName'],e[l]['value']?e[l]['value']:e[l]['resetValue']),a.setValue('filter/'+e[l]['filterBLName']+'Текст',e[l]['caption']);for(var r in i.initialFilters)if(i.initialFilters.hasOwnProperty(r))a.setValue('filter/'+r,i.initialFilters[r]);a.removeValue('filter/ФильтрСортировкаКолонок');var n=a.getValue('filter');if(!n['ИдРегламента'])o.saveLastStatisticsFilter(n,s.historyStorage).addCallback(function(){s.setStatisticsTemplate('StatisticsInnerCurrent');});else if(!n['ФильтрИдФазы'])o.saveLastStatisticsFilter(n,s.historyStorage).addCallback(function(){s.setStatisticsTemplate('StatisticsPhaseReport');});else p.setFilter(n);}),l._getFilterButton().subscribe('onResetFilter',function(t,e){if(!e){var l=this.getFilterStructure();for(var r in l)if(l.hasOwnProperty(r))a.removeValue('filter/'+l[r]['filterBLName']);for(var n in i.initialFilters)if(i.initialFilters.hasOwnProperty(n))a.setValue('filter/'+n,i.initialFilters[n]);a.removeValue('filter/ФильтрСортировкаКолонок'),o.saveLastStatisticsFilter(a.getValue('filter'),s.historyStorage).addCallback(function(){if(!a.getValue('filter/ИдРегламента'))s.setStatisticsTemplate('StatisticsInnerCurrent');else if(!a.getValue('filter/ФильтрИдФазы'))s.setStatisticsTemplate('StatisticsPhaseReport');else if(!a.getValue('filter/ФильтрСтатистикаПериод'))s.setStatisticsTemplate('StatisticsPeriodReport');});}}),l.getLinkedContext().subscribe('onFieldChange',function(t,r,n){if('filter/ФильтрСтатистикаПериод'===r&&p.getFilter()['ИдРегламента']===a.getValue('filter/ИдРегламента')){var u=l._getFilterButton().getFilter(),S=e.clone(i.initialFilters);for(var m in u)if(u.hasOwnProperty(m))S[m]=u[m];if('Выполнено'===n)S['ФильтрСтатистикаПериод']=n,a.setValue(r,n),p.setFilter(S);else o.saveLastStatisticsFilter(S,i.filterParamName).addCallback(function(){s.setStatisticsTemplate('StatisticsPeriodReport');});}});},onDataLoad:function(t,s){var a=this,l=e.clone(a.initial_columns),r=a.getFilter(),n=s.getMetaData().results,p,S=s.getFormat()._$items||[],m=s.getMetaData().path,c=m.getCount()>0?m.at(m.getCount()-1).get('Идентификатор'):null;if(a.setCurrentRoot(c),a.getLinkedContext().setValue('filter/Раздел',c),o.saveLastStatisticsFilter(r,u._self.getParent().historyStorage),n.get('Итого')){a.total_count=n.has('Итого')?n.get('Итого')[0]:null,a.total_overdued=n.has('Итого')?n.get('Итого')[1]:null;var p=n.get('Итого')[0],f=Math.max(Math.floor(o.columnWidth('Всего')/2),o.columnWidth(p.toString())+8,40);if(!r['ФильтрСрокДата'])l.push(u.prototype._makeColumn('Просрочено',r,'  ',f,true));if(l.push(u.prototype._makeColumn('Итого',r,'Всего',f,false)),n.has('Итого'))if(0===n.get('Итого')[1])l.splice(1,1);var h='';for(i=0;i<S.length;i++)if(S.hasOwnProperty(i))if(-1!==S[i]._$name.indexOf('##')){var d=S[i]._$name.split('##'),F=d[1].substr(0,60).replace(/\./gi,'&#046;'),f=Math.floor(o.columnWidth(d[1].substr(0,60))/2);if(p=n.has(S[i]._$name)?n.get(S[i]._$name)[0]:null,0!==p){if(f=Math.max(f,o.columnWidth(p.toString())+8,38),h=S[i]._$name,!r['ФильтрСрокДата'])l.push(u.prototype._makeColumn(h,r,F,f,true,false,d[0]));l.push(u.prototype._makeColumn(h,r,F,f,false,false,d[0]));}}a.isOther=false,a.setColumns(l);}this.getFilter()['ФильтрСортировкаКолонок']=this.reglaments;},_makeColumn:function(t,e,i,s,a,l,r,o){return{field:t,title:i,highlight:true,width:e['ФильтрСрокДата']?2*s:s,verticalAlign:'bottom',className:'phase-report-fix-font-weight '+(a?'':'phase-report-total-right-border')+(!a||'Просрочено'==t?'':'edo_stat_report_caption_border'),resultTemplate:'html!SBIS3.EDO.Statistics.ColumnsTemplate.ResultRender',cellTemplate:'html!SBIS3.EDO.Statistics.ColumnsTemplate.DataCell',headTemplate:'html!SBIS3.EDO.Statistics.ColumnsTemplate.CaptionRender',templateBinding:{isOverdue:a,fieldName:t,isTotal:l,nextReportName:o,filterName:'ФильтрИдПерехода',columnId:r,filter:e}};},sendAvailableAreaWidth:function(t){return 1400-300-120-120;},onFolderEnter:function(e,i){var s=this.getParent().getParent().getParent(),a=s._options.StatTemplateName?s._options.StatTemplateName:'ШаблонСтатистики';if(t.ControlStorage.getByName(a).getLinkedContext().setValue('ТекущееПодразделение',i),this.getQuery()['ФильтрВнешняяСтатистика']&&(-1000===i||null===i))e.setResult(false);}});return u;});
define("tmpl!SBIS3.EDO.StatTemplateNew",["Core/tmpl/js/tclosure","js!SBIS3.EDO.PeriodStatReportNew","js!SBIS3.EDO.StatisticsInnerCurrentNew","js!SBIS3.EDO.StatisticsReportByPhaseNew","js!SBIS3.EDO.StatisticsReportTransitionsNew"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.EDO.PeriodStatReportNew"]=e[1],r["js!SBIS3.EDO.StatisticsInnerCurrentNew"]=e[2],r["js!SBIS3.EDO.StatisticsReportByPhaseNew"]=e[3],r["js!SBIS3.EDO.StatisticsReportTransitionsNew"]=e[4];var i=function e(i,s,a,o,c){function l(){}var n=0,d=void 0!==t&&t?t:arguments[arguments.length-1];void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure"));var p={};c&&c.isSetts&&(p=c.fullContext||{});var S="string"==typeof a?a:"",g=void 0===r?void 0:r,y={id:[],def:void 0},u=d.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,i),T=this&&this.includedTemplates?this.includedTemplates:{},m=d.getMarkupGenerator(o);try{var v=m.joinElements([m.createTag("div",{style:"position:relative;height:100%;",class:""+d.wrapUndef(d.utils.escape(d.getter(i,["stickyHeader"])?"StatTemplateNew edo-StatisticsReport":"StatTemplateNew"))},[d.getter(i,["StatisticsPeriodReport"])?[m.createTag("div",{style:"height:100%",class:""+d.wrapUndef(d.utils.escape(d.getter(i,["stickyHeader"])?"edo-StatisticsReport":""))},[m.createControl("wsControl","ws:SBIS3.EDO.PeriodStatReportNew",{initialFilters:d.getter(i,["initialFilters"]),customizeFilters:d.getter(i,["customizeFilters"]),docType:d.getter(i,["docType"]),docSubType:d.getter(i,["docSubType"]),filterParamName:d.getter(i,["filterParamName"]),statisticsType:d.getter(i,["statisticsType"]),lastSavedFilters:d.getter(i,["lastSavedFilters"]),resetLinkText:d.getter(i,["resetLinkText"]),stickyHeader:d.getter(i,["stickyHeader"])},{},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:u},a,g,T,d.config,p)],{},y,this)]:m.createText(""),d.getter(i,["StatisticsInnerCurrent"])?[m.createTag("div",{style:"height:100%",class:""+d.wrapUndef(d.utils.escape(d.getter(i,["stickyHeader"])?"edo-StatisticsReport":""))},[m.createControl("wsControl","ws:SBIS3.EDO.StatisticsInnerCurrentNew",{initialFilters:d.getter(i,["initialFilters"]),lastSavedFilters:d.getter(i,["lastSavedFilters"]),customizeFilters:d.getter(i,["customizeFilters"]),docType:d.getter(i,["docType"]),docSubType:d.getter(i,["docSubType"]),listData:d.getter(i,["listData_StatisticsInnerCurrent"]),serverSideRendering:d.getter(i,["serverSideRendering"]),statisticsType:d.getter(i,["statisticsType"]),resetLinkText:d.getter(i,["resetLinkText"]),stickyHeader:d.getter(i,["stickyHeader"])},{},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:u},a,g,T,d.config,p)],{},y,this)]:m.createText(""),d.getter(i,["StatisticsPhaseReport"])?[m.createTag("div",{style:"height:100%",class:""+d.wrapUndef(d.utils.escape(d.getter(i,["stickyHeader"])?"edo-StatisticsReport":""))},[m.createControl("wsControl","ws:SBIS3.EDO.StatisticsReportByPhaseNew",{initialFilters:d.getter(i,["initialFilters"]),lastSavedFilters:d.getter(i,["lastSavedFilters"]),customizeFilters:d.getter(i,["customizeFilters"]),docType:d.getter(i,["docType"]),docSubType:d.getter(i,["docSubType"]),listData:d.getter(i,["listData_StatisticsPhaseReport"]),statisticsType:d.getter(i,["statisticsType"]),resetLinkText:d.getter(i,["resetLinkText"]),stickyHeader:d.getter(i,["stickyHeader"])},{},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:u},a,g,T,d.config,p)],{},y,this)]:m.createText(""),d.getter(i,["StatisticsTransReport"])?[m.createTag("div",{style:"height:100%",class:""+d.wrapUndef(d.utils.escape(d.getter(i,["stickyHeader"])?"edo-StatisticsReport":""))},[m.createControl("wsControl","ws:SBIS3.EDO.StatisticsReportTransitionsNew",{initialFilters:d.getter(i,["initialFilters"]),customizeFilters:d.getter(i,["customizeFilters"]),docType:d.getter(i,["docType"]),docSubType:d.getter(i,["docSubType"]),filterParamName:d.getter(i,["filterParamName"]),statisticsType:d.getter(i,["statisticsType"]),lastSavedFilters:d.getter(i,["lastSavedFilters"]),resetLinkText:d.getter(i,["resetLinkText"]),stickyHeader:d.getter(i,["stickyHeader"])},{},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:u},a,g,T,d.config,p)],{},y,this)]:m.createText("")],s,y,this)],S,y);y.def&&(v=m.chain(v,y,s),y=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/Statistika/StatTemplateNew/StatTemplateNew.tmpl",e,i)}return v||""};return i.includedFunctions={},i.stable=!0,i.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.StatTemplateNew"}},i});
define('js!SBIS3.EDO.StatTemplateNew',['Core/helpers/string-helpers-min','Core/ParallelDeferred','Core/Deferred','SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.StatTemplateNew','js!SBIS3.EDO.StatFuncs','js!SBIS3.EDO.ScopeFilters','Lib/StickyHeader/StickyHeaderManager/StickyHeaderManager','Core/EventBus','SBIS3.CONTROLS/Storages/SBIS/SBISHistoryStorage','Core/core-functions','WS.Data/Source/SbisService','js!SBIS3.EDO.StatisticsInnerCurrentNew','js!SBIS3.EDO.PeriodStatReportNew','js!SBIS3.EDO.StatisticsReportByPhaseNew','js!SBIS3.EDO.StatisticsReportTransitionsNew','Elektronnyj_dokumentooborot_localization'],function(t,e,i,s,r,o,a,n,l,p,c,S){var f=s.extend({_dotTplFn:r,$protected:{_options:{name:'',StatTemplateName:'StatTemplate1',docType:'',docSubType:'',loadOnDemand:false,statisticsType:'period',filterDocTypes:void 0,visibility:'block',filter_options:{},set_user_dep:false,detalization_row_actions:[],show_phase_norm:false,template:'',registryBrowserName:'browserView',registryTabID:'ListTab',StatTabID:'StatTab',needStatPrintBtn:false,maPrintId:'',needStatSaveBtn:false,currentReportName:'',StatisticsInnerCurrent:false,StatisticsPeriodReport:false,StatisticsPhaseReport:false,StatisticsTransReport:false,customizeFilters:{},initialFilters:{},listData:null,serverSideRendering:null,lastSavedFilters:{},stickyHeader:true}},$constructor:function(){},_modifyOptions:function(e){if(e.filterParamName='StatisticsFilters'+e.statisticsType.toUpperCase()+t.transliterate(e.docType),e.listData&&e.listData.items)e.listData.items.setIdProperty('Идентификатор'),f.prototype.initStatisticsOptions(e);return e;},init:function(){var t=this;if(t.historyStorage=new p({historyId:t._options.filterParamName,name:'historyStorage'}),t.historyStorage.exclude_filters=t._options.filter_options,f.superclass.init.call(this),'current'===this._options.statisticsType)a.readCurListScopes(this._options.docType+'.СтатистикаВнутрТекущие',true,true);else a.readCurListScopes(this._options.docType+'.СтатистикаСобытияЗаПериод',true,true);if('none'===this._options.visibility)this.hide();if(!this._options.loadOnDemand&&!(this._options.listData&&this._options.listData.items))this.setStatisticsTemplate();this._options.listData=null,this._options.listData_StatisticsPhaseReport=null,this._options.listData_StatisticsInnerCurrent=null;},setVisibility:function(t){if(t)this.show();else this.hide();},setDocType:function(t){this._options.docType=t;},getDocType:function(){return this._options.docType;},setFilterOptions:function(t){this._options.filter_options=t;},setStatisticsTemplate:function(t){var s=this,r=new e(),a=new i();if(s._options.lastSavedFilters={},r.push(a),t)s._options[t]=true,s._options[s._options.currentReportName]=false,s._options.currentReportName=t,a.callback(false);else if(f.prototype.initStatisticsOptions(s._options),!o.isEmptyObject(s._options.filter_options))if(s._options.filter_options['ИдРегламента'])new S({endpoint:'Regulation'}).call('Read',{'ИдО':s._options.filter_options['ИдРегламента'],'ИмяМетода':null}).addCallback(function(t){return a.callback(t),t;});else a.callback(false);else a.callback(false);r.done().getResult().addCallback(function(t){if(false!==t[0]){var e=t[0].getRow(0);if(e&&e.has('Идентификатор'))s._options.filter_options['ИдРегламента']=e.get('Идентификатор'),s._options.filter_options['ИдРегламентаТекст']=e.get('Название'),s._options.initialFilters['ИдРегламента']=e.get('Идентификатор'),s._options.initialFilters['ИдРегламентаТекст']=e.get('Название'),s._options.resetLinkText=e.get('Название');}if(s.historyStorage.getHistory()&&s.historyStorage.getHistory()[0].viewFilter){var i=s.historyStorage.getHistory()[0].viewFilter;if('period'===s._options.statisticsType)delete i['ФильтрСтатистикаТекущие'],delete i['ФильтрПоКраткомуСостоянию'];if(i['ФильтрИдФазы'])s._options[s._options.currentReportName]=false,s._options.currentReportName='StatisticsTransReport',s._options.StatisticsTransReport=true;else if(i['ИдРегламента']){if('current'===s._options.statisticsType||i['ФильтрСтатистикаПериод']&&'Все'!==i['ФильтрСтатистикаПериод'])s._options[s._options.currentReportName]=false,s._options.currentReportName='StatisticsPhaseReport',s._options.StatisticsPhaseReport=true;}else if(i['ФильтрСтатистикаПериод']&&'Все'!==i['ФильтрСтатистикаПериод'])s._options[s._options.currentReportName]=false,s._options.currentReportName='StatisticsInnerCurrent',s._options.StatisticsInnerCurrent=true;for(var r in i)if(i.hasOwnProperty(r))s._options.lastSavedFilters[r]=i[r];}s._options.lastSavedFilters=c.merge(s._options.lastSavedFilters,s._options.initialFilters),n.unfixAllChildren(s.getContainer(),true),s.rebuildMarkup(),l.channel('stickyHeader').notify('onForcedStickHeader',s.getContainer());});},initStatisticsOptions:function(t){if(t.listData&&t.listData.items){if('СтатистикаВнутрТекущие'===t.listData.dataSource.getBinding().query)t['listData_StatisticsInnerCurrent']=t.listData;if('СтатистикаОтчетПоФазам'===t.listData.dataSource.getBinding().query)t['listData_StatisticsPhaseReport']=t.listData;}if('current'===t.statisticsType){if(t.currentReportName)t[t.currentReportName]=false;if(t.StatisticsInnerCurrent=true,t.currentReportName='StatisticsInnerCurrent',t.initialFilters['ФильтрПоКраткомуСостоянию']=4,t.initialFilters['ФильтрСтатистикаТекущие']=true,!o.isEmptyObject(t.filter_options)||t.listData&&t.listData.filter)if((t.listData&&t.listData.filter?t.listData.filter:t.filter_options)['ИдРегламента'])t.StatisticsInnerCurrent=false,t.StatisticsPhaseReport=true,t.currentReportName='StatisticsPhaseReport';}else{if(t.currentReportName)t[t.currentReportName]=false;t.StatisticsPeriodReport=true,t.currentReportName='StatisticsPeriodReport';}t.initialFilters['ТипДокумента']=t.docType,t.initialFilters['ФильтрТипыДокументов']=t.filterDocTypes;for(var e in t.filter_options)if(t.filter_options.hasOwnProperty(e))t.initialFilters[e]=t.filter_options[e];if(t.listData&&t.listData.filter)t.listData.filter=c.merge(t.listData.filter,t.initialFilters);}});return f.title='Title',f;});
define("html!SBIS3.EDO.FilterInnerStatCurrent",function(){var o=function(o){var t=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;o.test(t);)t=t.replace(o,"&#123;&#123;$1&#125;&#125;");return t}}(),e=function(o){return o.join?o.join(""):o.toString()},n=function(o){return void 0===o?"":o&&"object"==typeof o?e(o):""+o},i="undefined"!=typeof process,r=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div> <component data-component="SBIS3.EDO.EDOFilter" name="ФильтрЭДОСтатистика"> <options name="rightsLim"> <option name="show">true</option> <option name="textRender" type="function">js!SBIS3.EDO.ScopeFilters:setScopeTextForFilter</option> </options> <options name="filtersCustom"> ');return o.FilterPassageStatus&&(r+=' <option name="templateTop">js!SBIS3.EDO.FilterPassageStatus</option> '),r+=' <option name="templateBottom">js!SBIS3.EDO.FilterRepeatStages</option> </options> <option name="filterDataPeriodLimited">true</option> <options name="filtersEDO"> <options name="FilterFace1"> <option name="show">true</option> </options> <options name="FilterIDRegulations"> <option name="show">true</option> <option name="hidePhase">true</option> </options> <options name="FilterLimitationDate"> <option name="show">true</option> </options> <options name="FilterResponsibleFace"> <option name="show">true</option> </options> <options name="FilterAuthorOrResponsibleMe"> <option name="show">true</option> </options> <options name="FilterListDispatch"> <option name="show">'+t(n(o.hideListPerformer))+'</option> </options> <options name="FilterPriority"> <option name="show">'+t(n(o.showFilterPriority))+'</option> </options> <options name="FilterMilestone"> <option name="show">true</option> </options> </options> </component> </div>',(r=t(r))+(i&&-1!==r.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.FilterInnerStatCurrent"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.FilterInnerStatCurrent", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(""));head.appendChild(style);});}
define('js!SBIS3.EDO.FilterInnerStatCurrent',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.FilterInnerStatCurrent','js!SBIS3.EDO.StatFuncs','css!SBIS3.EDO.FilterInnerStatCurrent','js!SBIS3.EDO.EDOFilter','i18n!SBIS3.EDO.FilterInnerStatCurrent','js!SBIS3.EDO.ScopeFilters','Elektronnyj_dokumentooborot_localization'],function(t,e,r){var i=true,s=t.extend({_dotTplFn:e,$protected:{_options:{autoHeight:true,autoWidth:true,datePeriodLimited:i?false:true,hideListPerformer:i?false:true,showFilterPriority:i?false:true,FilterPassageStatus:false}},$constructor:function(){},_modifyOptions:function(t){t=s.superclass._modifyOptions.call(this,t);var e=this.getTopParent(),i=e&&e.getOpener(),n=i&&i.getParentByClass('SBIS3.EDO.StatTemplate'),o=n&&n._options;if(true===r.customizeFiltersToObject(o&&o['customizeFilters']||{})['ФильтрСтатусПерехода'])t['FilterPassageStatus']=true;return t;},init:function(){this.getLinkedContext().setRestriction('set'),s.superclass.init.call(this);}});return s;});
define("html!SBIS3.EDO.StatisticsInnerCurrent",function(){var o=function(o){var n=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;o.test(n);)n=n.replace(o,"&#123;&#123;$1&#125;&#125;");return n}}(),t=function(o){return o.join?o.join(""):o.toString()},e=function(o){return void 0===o?"":o&&"object"==typeof o?t(o):""+o},i="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div> <component data-component="SBIS3.EDO.FilterController" name="ПанельСФильтромСтат"> <option name="filterLine" type="function" value="js!SBIS3.EDO.FastFilters:filterViewLineRender"></option> <option name="mode" value="hover"></option> <option name="template" value="js!SBIS3.EDO.FilterInnerStatCurrent"></option> <options name="filterButtonHandlers"> <options name="onChange" type="array"> <option type="function">js!SBIS3.EDO.StatisticsInnerCurrent:prototype.onChange</option> <option type="function" value="js!SBIS3.EDO.Filters:onFilterReestrChange"></option> </options> <option name="onBeforeShow" type="function" value="js!SBIS3.EDO.FilterHandlers:onBeforeShowPhaseFilter"></option> <options name="onSetQuery" type="array"> <option type="function" value="js!SBIS3.EDO.Filters:onSetQueryBrowser"></option> <option type="function" value="js!SBIS3.EDO.StatisticsInnerCurrent:prototype.onSetQuery"></option> <option type="function" value="js!SBIS3.EDO.InnerStat:changeDefaultFilterPeriodStat"></option> <option type="function" value="js!SBIS3.EDO.Filters:saveFilterIntoContext"></option> </options> </options> <options name="pathFilterHandlers"> <option name="onVisualizeFilter" type="function" value="js!SBIS3.EDO.FastFilters:onVisualizeFilter"></option> <option name="onCreatePoint" type="function" value="js!SBIS3.EDO.FastFilters:onCreatePointInnerStat"></option> <option name="onFilterChange" type="function" value="js!SBIS3.EDO.FastFilters:onChangeFastFilterInner"></option> <option name="onInit" type="function" value="js!SBIS3.EDO.InnerStat:onInitStatFastFilters"></option> </options> </component> <component data-component="Deprecated/Controls/HierarchyView/HierarchyView" name="StatisticsInnerCurrentBrowser" style="width:auto;height:auto;" class="regl-report-hierarchy-view statistics-browser"> <options name="dataSource"> <options name="readerParams"> <option name="nameApplication">Основной сервис</option> <option name="nameService">Основной сервис</option> <option name="queryName" value="СтатистикаВнутрТекущие"></option> <option name="createMethodName" value="Создать"></option> <option name="updateMethodName" value="Записать"></option> <option name="readMethodName" value="Прочитать"></option> <option name="destroyMethodName" value="Удалить"></option> <option name="linkedObject">'+n(e(o.docType))+'</option> <option name="format" value=""></option> </options> <option name="firstRequest">false</option> </options> <option name="autoHeight">true</option> <options name="display"> <option name="partiallyLoad" value="true"></option> <option name="hierColumn" value="Раздел"></option> <option name="titleColumn" value="Название"></option> <option name="emptyHtml">'+n(e(rk("Нет данных")))+'</option> <option name="emptyTableHtml">'+n(e(rk("Нет данных")))+'</option> <options name="columns" type="array"> <options> <option name="title" value=""></option> <option name="field">Название</option> <option name="render" type="function" value="js!SBIS3.EDO.InnerStat:renderTitleColumn"></option> <option name="width">300</option> <option name="className" value="phase-report-performer"></option> <option name="filterName">Название</option> <option name="fixedSize">true</option> </options> <options> <option name="title">'+n(e(rk("Просрочено")))+'</option> <option name="field">Просрочено</option> <option name="render" type="function">js!SBIS3.EDO.StatisticsInnerCurrent:prototype.columnRenderOverdue</option> <option name="width">60</option> <option name="captionAlign">right</option> <option name="fixedSize">true</option> <option name="textAlign">right</option> <option name="useForFolder">true</option> <option name="textHeadAlign">Top</option> <option name="verticalAlign">bottom</option> </options> <options> <option name="title">'+n(e(rk("Итого")))+'</option> <option name="field">Итого</option> <option name="render" type="function">js!SBIS3.EDO.StatisticsInnerCurrent:prototype.columnRender</option> <option name="width">60</option> <option name="captionAlign">right</option> <option name="fixedSize">true</option> <option name="className" value="phase-report-total-right-border"></option> <option name="isResultField">true</option> <option name="textAlign">right</option> <option name="useForFolder">true</option> <option name="textHeadAlign">Top</option> <option name="verticalAlign">bottom</option> </options> </options> <option name="alwaysDisplayResults">true</option> <option name="resultText" value=""></option> <option name="resultType">foldersAndLeaves</option> <option name="resultsRender" type="function">js!SBIS3.EDO.StatisticsInnerCurrent:prototype.resultsRender</option> <option name="rootName" value=""></option> <option name="rowRender" type="function">js!SBIS3.EDO.StatisticsInnerCurrent:prototype.rowRender</option> </options> <options name="filterParams"> <options name="ТипДокумента"> <option name="saveToState">false</option> <option name="fieldName">ТипДокумента</option> </options> <options name="ФильтрТипыДокументов"> <option name="saveToState">false</option> <option name="fieldName">ФильтрТипыДокументов</option> </options> <options name="ФильтрАвторИлиОтвОтдел"> <option name="saveToState">false</option> <option name="fieldName">ФильтрАвторИлиОтвОтдел</option> </options> <options name="ФильтрАвторИлиОтветственный"> <option name="saveToState">false</option> <option name="fieldName">ФильтрАвторИлиОтветственный</option> </options> <options name="ФильтрВладелец"> <option name="saveToState">false</option> <option name="fieldName">ФильтрВладелец</option> </options> <options name="ФильтрДиапазонДокументов"> <option name="saveToState">false</option> <option name="fieldName">ФильтрДиапазонДокументов</option> </options> <options name="ФильтрДатаП"> <option name="saveToState">false</option> <option name="fieldName">ФильтрДатаП</option> </options> <options name="ФильтрДатаПериод"> <option name="saveToState">false</option> <option name="fieldName">ФильтрДатаПериод</option> </options> <options name="ФильтрДатаС"> <option name="saveToState">false</option> <option name="fieldName">ФильтрДатаС</option> </options> <options name="ФильтрЛицо1"> <option name="saveToState">false</option> <option name="fieldName">ФильтрЛицо1</option> </options> <options name="ФильтрОтветственноеЛицо"> <option name="saveToState">false</option> <option name="fieldName">ФильтрОтветственноеЛицо</option> </options> <options name="ФильтрПоВехе"> <option name="saveToState">false</option> <option name="fieldName">ФильтрПоВехе</option> </options> <options name="ФильтрПоКраткомуСостоянию"> <option name="saveToState">false</option> <option name="fieldName">ФильтрПоКраткомуСостоянию</option> </options> <options name="ФильтрПриоритет"> <option name="saveToState">false</option> <option name="fieldName">ФильтрПриоритет</option> </options> <options name="ФильтрСписокРассылки"> <option name="saveToState">false</option> <option name="fieldName">ФильтрСписокРассылки</option> </options> <options name="ФильтрСрокДата"> <option name="saveToState">false</option> <option name="fieldName">ФильтрСрокДата</option> </options> <options name="ФильтрСтатистикаПериод"> <option name="saveToState">false</option> <option name="fieldName">ФильтрСтатистикаПериод</option> </options> <options name="ФильтрСтатистикаТекущие"> <option name="saveToState">false</option> <option name="fieldName">ФильтрСтатистикаТекущие</option> </options> <options name="ФильтрСтатусПерехода"> <option name="saveToState">false</option> <option name="fieldName">ФильтрСтатусПерехода</option> </options> <options name="ФильтрВнешняяСтатистика"> <option name="saveToState">false</option> <option name="fieldName">ФильтрВнешняяСтатистика</option> </options> </options> <options name="handlers"> <option name="onInit" type="function">js!SBIS3.EDO.StatisticsInnerCurrent:prototype.onInit</option> <option name="onRowClick" type="function" value="js!SBIS3.EDO.InnerStat:onRowClickStat"></option> <option name="onAfterLoad" type="function">js!SBIS3.EDO.StatisticsInnerCurrent:prototype.onAfterLoad</option> <option name="onFolderEnter" type="function">js!SBIS3.EDO.StatisticsInnerCurrent:prototype.onFolderEnter</option> <option name="onAfterRender" type="function">js!SBIS3.EDO.StatisticsInnerCurrent:prototype.onAfterRender</option> </options> </component> </div>');return(a=n(a))+(i&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.StatisticsInnerCurrent"}},o});
define('js!SBIS3.EDO.StatisticsInnerCurrent',['Lib/Control/Control','Core/core-functions','SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.StatisticsInnerCurrent','js!SBIS3.EDO.InnerStat','js!SBIS3.EDO.StatFuncs','js!SBIS3.EDO.Filters','Deprecated/Controls/HierarchyView/HierarchyView','Deprecated/Controls/TableView/plugins/Ladder-plugin','Deprecated/Controls/TableView/plugins/Results-plugin','js!SBIS3.EDO.FilterController','css!SBIS3.EDO.StatisticsReportByPhase','i18n!SBIS3.EDO.StatisticsInnerCurrent','Elektronnyj_dokumentooborot_localization'],function(t,e,r,a,i,s){var o=r.extend({_dotTplFn:a,$protected:{_options:{autoHeight:true,autoWidth:true,fastFilters:{}}},_modifyOptions:function(t){var e=this.getParentByClass('SBIS3.EDO.StatTemplate')?this.getParentByClass('SBIS3.EDO.StatTemplate')._options.docType:'Документ';return t.docType=e,t;},$constructor:function(){},init:function(){if(!this.getParent().getLinkedContext().getValue('ФильтрСтатистикаПериод'))this._options.fastFilters={};else this._options.fastFilters={'ФильтрСтатистикаПериод':{defaultValue:'Период'}};o.superclass.init.call(this),this.getChildControlByName('ПанельСФильтромСтат').setLinkedView(this.getChildControlByName('StatisticsInnerCurrentBrowser'));},columnRender:function(t,e){var r,n=this.getQuery(),a=false,o='Просрочено'!==e&&'Итого'!=e?e.split('##')[0]:void 0,l=void 0!==o&&-1!==o&&'-1##Прочее'!==e?e.split('##')[1]:void 0,u;if('-1'===o)u=i.generateHrefParams(n,t,false,a,this.other_elements_id,e);else{var g=l?{'ИдРегламента':l}:void 0;u='-1##Прочее'!==e?i.generateHrefParams(s.addStringFilter(n,g),t,false,a,o,e):void 0;}if(!t.hasColumn(e))return'';r=t.get(e);var f=$('<span></span>');if(null!==r&&0!==r[0]){if(u)if(f.attr('class','phase-report-link'),t.hasColumn('Раздел@')&&t.get('Раздел@'))f.addClass('folder_font');if(f.attr('params',u),f.text(r[0]),'-1##Прочее'===e)f.attr('style','margin-right: 4px');return f;}else return'';},columnRenderOverdue:function(t,e){var r,n=this.getQuery(),a=true,o='Просрочено'!==e&&'Итого'!=e?e.split('##')[0]:void 0,l=void 0!==o&&-1!==o&&'-1##Прочее'!==e?e.split('##')[1]:void 0,u;if('-1'===o)u=i.generateHrefParams(n,t,false,a,this.other_elements_id,e);else{var g=l?{'ИдРегламента':l}:void 0;u='-1##Прочее'!==e?i.generateHrefParams(s.addStringFilter(n,g),t,false,a,o,e):void 0;}r=t.get('Просрочено'===e?'Итого':e);var f=$('<span></span>');if(null!==r&&0!==r[1]&&this.show_overdue){if(f.addClass('overdue-stat-count'),u)if(f.addClass('phase-report-link'),t.hasColumn('Раздел@')&&t.get('Раздел@'))f.addClass('folder_font');return f.attr('params',u),f.text(r[1]),f;}else return'';},resultsRender:function(t,e){if(null===e)return;for(var r=this,n=r.getQuery(),a=this.getParent().getParent(),o=a.getLinkedContext(),l=s.getStatFiltersList('js!SBIS3.EDO.StatisticsInnerCurrent'),u,g=0;g<l.length;g++)o.setValue(l[g],n[l[g]]);o.setValue('ТекущееПодразделение',n['Раздел']?n['Раздел']:o.getValue('ТекущееПодразделение'));var f=function(t,e,r,n,a){t.click(function(t){if(e['ИдРегламента']=n,a)e['РегламентТекст']=a;s.goToInnerStatReport('js!SBIS3.EDO.StatisticsReportByPhase',e,r);});},d=t.find('td');for(g=0;g<r.getColumns().length;g++){var p=r.getColumns()[g].field,h,c=r.getColumns()[g].is_overdue,m=p?p.replace(/\./gi,'&#046;').split('##')[1]:'',S=!p||'Итого'===p||'Просрочено'===p?void 0:p.split('##')[0],C=S?p.split('##')[1]:void 0;if('Итого'===p)c=false,m=rk('Всего');if('Просрочено'===p)c=true,m=rk('Просрочено');if('Название'!==p&&'Должность'!==p){h=e.get('Просрочено'!==p?p:'Итого').split(',');var v=$(d[g]).find('div'),y=$('<div></div>');if(0!==v.length){$(d[g]).attr('title','');var B=c?'0'!==h[1].toString()?h[1]:'':'0'!==h[0].toString()?h[0]:'';if(c)y.addClass('overdue-stat-count');if('0'!==B&&(!c||c&&r.show_overdue)){var I;if('-1##Прочее'===p)I=i.generateHrefParams(r.getQuery(),e,true,c,r.other_elements_id,'other_elements',h[0],h[1]);else{var R=C?{'ИдРегламента':C}:void 0;I=i.generateHrefParams(s.addStringFilter(r.getQuery(),R),e,true,c,S,p);}y.addClass('phase-report-link');var P=function(t,e){t.click(function(t){s.goToPhasesWork(t,e);});};P(y,I),y.attr({title:m}),y.text(B);}else y.text('');if(!c&&'-1##Прочее'===p)y.attr('style','margin-right:4px');v.html(y);var E=r.getContainer().find('tr.ws-browser-head-top td[columnid='+g+']'),w=E.find('div');if(E.addClass('bottom-caption'),E.attr('title',''),0!==w.length){var _=$('<div title = "'+m+'">'+(m.length>40?m.substr(0,40)+'...':m)+'</div>');if(p&&'Итого'!=p&&'Просрочено'!=p&&'-1##Прочее'!=p){if(E.attr('style','border-right: 1px solid #EAEAEA !important;'),_.attr('class','cut-column-caption'),_.attr('style','margin-right: 3px;'),'0'!==h[0].toString()){if('По ответственному'===n['ФильтрРазрезСтатистики']&&!n['ФильтрПоКраткомуСостоянию'])if('Выполнено'===n['ФильтрСтатистикаПериод'])(function(t,e,r,n){t.click(function(t){e['ИдРегламента']=n,s.goToInnerStatReport('js!SBIS3.EDO.ReportStatResult',e,r);});}(_,n,a,S));else R=C?{'ИдРегламента':C}:void 0,P(_,I=i.generateHrefParams(s.addStringFilter(r.getQuery(),R),e,true,false,S,p));else f(_,n,a,S,C);_.attr('class','regulation-caption');}}else{if('Просрочено'===p)if(_.text(''),_.attr('style','margin-right: 3px;'),r.show_overdue&&'0'!==h[1].toString())_.addClass('icon-16 icon-Time icon-disabled'),_.attr('style','margin-top: 3px;'),_.addClass('overdue-stat-count'),_.attr('title',rk('Нарушен срок'));if('-1##Прочее'===p)if(_.attr('style','margin-right: 4px;'),_.attr('class','cut-column-caption'),'0'!==h[0].toString())_.click(function(t){s.goToOtherRegls(t);}),_.attr('class','regulation-caption');if('Итого'===p)_.attr('style','margin-right: 3px;'),E.attr('style','border-right: 1px solid #EAEAEA !important;');}w.html(_);}}}}t.addClass('phase-report-total-row');},rowRender:function(t,e){if(!t.get('Раздел@')&&-1!==t.get('@Лицо'))e.find('.ws-browser-div-cut').css('height','40px');},onInit:function(){var r=this.getColumnMap(),n=this.getColumns(),a=this;a.initial_columns=e.clone(n);for(var i=0;i<r.length;i++)a.toggleColumn(r[i].field,false);var l=true;if(l)a.subscribe('onDataReady',function(){if(!l)return;var e=a.getPathSelector();s.formPathSelectorNodes(e,'Обработка внутри компании'),e.subscribe('onPathChange',function(e,r){if(-1000===r){e.setResult(false),s.removeStatSaveButton();var n=null;if(!n){var i=a.getParentByClass('SBIS3.EDO.StatTemplate'),l=i&&i._options&&i._options['template'],u=s.getBrowserFromNewRegistry.call(this);return void s.updateStatTemplateNew(l,u);}if('СтатистикаВходящих'===n.get('ШаблонСтатистики')||'СтатистикаИсходящих'===n.get('ШаблонСтатистики')||'СтатистикаВнутренних'===n.get('ШаблонСтатистики')||'js!SBIS3.BUH.ExpRepStatMain'===n.get('ШаблонСтатистики')&&t.ControlStorage.containsByName('РазделыДокументооборота')){if(t.ControlStorage.containsByName('ПанельСФильтромСтат'))t.ControlStorage.getByName('ПанельСФильтромСтат').show();return s.updateStatTemplate(n.get('ШаблонСтатистики'),true,false),false;}else if('js!SBIS3.BUH.ExpRepStatMain'===n.get('ШаблонСтатистики')){var g='ШаблонСтатистики';t.ControlStorage.getByName(g).setTemplate('js!SBIS3.BUH.ExpRepStatMain'),t.ControlStorage.getByName('PathTab').tab=t.ControlStorage.getByName('ЗакладкиСтатистики');}else{var f='';if('-2 ТД'===n.get('@Ид'))f='js!SBIS3.EDO.StatIncomingEvents';else if('-3 ТД'===n.get('@Ид'))f='js!SBIS3.EDO.StatOutgoingEvents';else f='СтатистикаСкладских';s.updateStatTemplate(f,true,false);}}if(null===r){var d=a.getQuery();if(null!==d['Раздел'])d['Раздел']=null,d['СтолбцовСРегламентами']=o.prototype.sendAvailableAreaWidth(a),d['ФильтрВнешняяСтатистика']=true,a.setQuery(d);this.getContainer().find('span').first().attr({title:rk('К выбору отчета')});}}),e.subscribe('onArrowClick',function(t,e){if(-1000===e)t.setResult(false);});});var u=a.getQuery(),g=a.getParent().getParent().getLinkedContext(),f=s.getStatFiltersList('js!SBIS3.EDO.StatisticsInnerCurrent');if(g.getValue('ТекущееПодразделение'))u['Раздел']=g.getValue('ТекущееПодразделение');for(i=0;i<f.length;i++)u[f[i]]=g.getValue(f[i]);u['СтолбцовСРегламентами']=o.prototype.sendAvailableAreaWidth(a),u['ФильтрВнешняяСтатистика']=true,a.setQuery(u);},onAfterLoad:function(){var r=this,a=r.getRecordSet(),l=e.clone(r.initial_columns),u=this.getColumnMap();if(0===a.getRecords().length)return;for(var g=a.getRecords()[0],f=r.getQuery(),d=a.getResults(),p=d.hasColumn('-1##Прочее')&&3===d.get('-1##Прочее').split(',').length?parseInt(d.get('-1##Прочее').split(',')[2],10):5,h,c=[],m=[],S=9;S<g.getColumns().length;S++)if(-1!==g.getColumns()[S].indexOf('##'))if(S>=9+p+1)c.push(g.getColumns()[S]),m.push(g.getColumns()[S].split('##')[0]);if(r.other_elements=c,r.other_elements_id=m,d.hasColumn('Итого'))if('0'===d.get('Итого').split(',')[1])l.splice(1,1);var C=[o.prototype.columnRender,o.prototype.columnRenderOverdue],v='',y='';for(S=10,n=10+p;S<n&&S<g.getColumns().length;++S){var B=g.getColumns()[S].split('##')[1].substr(0,60),I=Math.floor(s.columnWidth(B)/2)+10;if(h=d.hasColumn(g.getColumns()[S])?d.get(g.getColumns()[S]).split(',')[0]:null,'0'!==h)I=Math.max(I,12*h.length,40),y=(v=g.getColumns()[S]).replace(/\./gi,'&#046;'),l.push(i.makeColumn(y,v,I,C,true,void 0,'bottom','phase-report-fix-font-weight')),l.push(i.makeColumn(y,v,I,C,false,void 0,'bottom','phase-report-fix-font-weight phase-report-total-right-border'));}if(h=d.hasColumn(g.getColumns()[9])?d.get(g.getColumns()[9]).split(',')[0]:null,'0'!==h)y=(v=g.getColumns()[9]).replace(/\./gi,'&#046;'),l.push(i.makeColumn(y,v,45,C,true,void 0,'bottom','phase-report-fix-font-weight')),l.push(i.makeColumn(y,v,45,C,false,void 0,'bottom','phase-report-fix-font-weight'));for(r.show_overdue=f['ФильтрСрокДата']?false:true,S=0;S<u.length;S++)r.toggleColumn(u[S].field,true);if(r.setColumns(l),t.ControlStorage.containsByName('ПанельСФильтромСтат'))t.ControlStorage.getByName('ПанельСФильтромСтат').getFilterButton().applyFilter(true);},sendAvailableAreaWidth:function(t){return t.getContainer().width()-300-120-120;},onFolderEnter:function(e,r){var n=this.getParent().getParent().getParent(),a=n._options.StatTemplateName?n._options.StatTemplateName:'ШаблонСтатистики';if(-1000!==r&&null!==r)t.ControlStorage.getByName(a).getLinkedContext().setValue('ТекущееПодразделение',r);if(this.getQuery()['ФильтрВнешняяСтатистика']&&(-1000===r||null===r))e.setResult(false);},onSetQuery:function(t,e){if(e['ИдРегламента']){t.setResult(false);var r=this.getBrowser().getQuery();if('По ответственному'===e['ФильтрРазрезСтатистики'])s.goToInnerStatReport('js!SBIS3.EDO.ReportStatResult',e,this.getParent().getParent().getParent());else s.goToInnerStatReport('js!SBIS3.EDO.StatisticsReportByPhase',e,this.getParent().getParent().getParent());return false;}if((!e['ФильтрСтатистикаПериод']||'Период'===e['ФильтрСтатистикаПериод'])&&!e['ФильтрПоКраткомуСостоянию'])return s.goToMainInnerStatReport('js!SBIS3.EDO.PeriodStatReport',this.getParent().getParent().getParent(),this.getBrowser(),e),t.setResult(false),false;},onAfterRender:function(t){i.setClickToDetalization(this,'span.phase-report-link,span.phase-report-link-title');},onChange:function(t,e,r){var n=this.getBrowser();if(n)n.show_overdue=e['ФильтрСрокДата']?false:true;}});return o;});
define("html!SBIS3.EDO.StatisticsIncomingDocsContragents/StatisticsContragents",function(){var o=function(o){var t=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;o.test(t);)t=t.replace(o,"&#123;&#123;$1&#125;&#125;");return t}}(),n=function(o){return o.join?o.join(""):o.toString()},e=function(o){return void 0===o?"":o&&"object"==typeof o?n(o):""+o},i="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div style="height:100%;"> <component data-component="Deprecated/Controls/SearchString/SearchString" name="Строка поиска" style="width:400px;height:32px;margin-top:8px;position:absolute;top:0px;left:0px;bottom:auto;right:0px;"> <option name="tooltip">'+t(e(rk("Укажите название контрагента")))+'</option> <option name="linkedBrowser">Statistics'+t(e(o.browserName))+'EventsContragents</option> <option name="filterName">Поиск</option> <option name="useBrowserFilter">true</option> </component> <component data-component="Deprecated/Controls/TemplatedArea/TemplatedArea" name="Область по шаблону 1" style="position:absolute !important;float:right !important;left:408px;margin-top:0px;margin-right:0px;top:0px;bottom:0px;right:0px;"> <option name="template">js!SBIS3.EDO.TemplateStatFilter</option> </component> <component data-component="Deprecated/Controls/PathSelector/PathSelector" name="'+t(e(o.pathSelectorName))+'" style="height:24px;width:400px;position:relative;top:40px;left:0px;bottom:auto;right:0px;margin-top:0px;"> <options name="handlers"> <option name="onInit" type="function" value="js!SBIS3.EDOStatistics.PathFilterController:onReportCaptionFilterReady"></option> <option name="onPathChange" type="function" value="js!SBIS3.EDOStatistics.PathFilterController:onPathChangeHandlerDocs"></option> <option name="onDrawPoint" type="function" value="js!SBIS3.EDOStatistics.PathFilterController:onDrawPointReportCaption"></option> <option name="onArrowClick" type="function" value="js!SBIS3.EDOStatistics.PathFilterController:onReportCaptionArrowClickHandler"></option> </options> </component> <component data-component="Deprecated/Controls/TableView/TableView" name="Statistics'+t(e(o.browserName))+'EventsContragents" class="stat-report" style="min-height:50px;position:relative;margin-top:30px;left:0px;bottom:auto;right:0px;height:calc(100% - 65px);"> <options name="dataSource"> <options name="readerParams"> <option name="queryName">'+t(e(o.queryName))+'</option> <option name="createMethodName" value="Создать"></option> <option name="updateMethodName" value="Записать"></option> <option name="readMethodName" value="Прочитать"></option> <option name="destroyMethodName" value="Удалить"></option> <option name="linkedObject">'+t(e(o.linkedObject))+'</option> <option name="format" value=""></option> </options> <option name="firstRequest">true</option> <option name="setCursorOnLoad">false</option> </options> <options name="display"> <option name="emptyHtml">'+t(e(rk("Нет данных")))+'</option> <option name="emptyTableHtml">'+t(e(rk("Нет данных")))+'</option> <options name="columns" type="array"> <options> <option name="field" value="Контрагент"></option> <option name="title" value=""></option> <option name="width">');return"СтатистикаПоКонтрагентам"==o.queryName&&(a+="405"),"СтатистикаСобытийПоКонтрагенту"==o.queryName&&(a+="603"),a+='</option> <option name="captionAlign">left</option> <option name="filterName">Контрагент</option> </options> <options> <option name="field" value="ИНН/КПП"></option> <option name="title">'+t(e(rk("ИНН / КПП")))+'</option> <option name="width">179</option> <option name="fixedSize">true</option> <option name="captionAlign">left</option> <option name="className" value="stat_gray_text"></option> </options> <options> <option name="field" value="Кол-во"></option> <option name="title">'+t(e(rk("Документов")))+'</option> <option name="width">70</option> <option name="fixedSize">true</option> <option name="captionAlign">right</option> <option name="textAlign">right</option> <option name="isResultField">true</option> <option name="filterName">Сумма</option> </options> ',"СтатистикаПоКонтрагентам"==o.queryName&&(a+=' <options> <option name="field" value="СуммаНДС"></option> <option name="title">'+t(e(rk("Сумма НДС")))+'</option> <option name="width">116</option> <option name="fixedSize">true</option> <option name="captionAlign">right</option> <option name="textAlign">right</option> <option name="isResultField">true</option> <option name="filterName">Сумма</option> </options> <options> <option name="field" value="Сумма"></option> <option name="title">'+t(e(rk("Сумма")))+'</option> <option name="width">116</option> <option name="fixedSize">true</option> <option name="captionAlign">right</option> <option name="textAlign">right</option> <option name="isResultField">true</option> <option name="filterName">Сумма</option> </options> '),a+=' </options> <option name="useSorting">true</option> <option name="recordsPerPage">25</option> <option name="pagesLeftRight">3</option> <option name="addRecordInEmptyTable">true</option> <option name="resultsRender" type="function" value="js!SBIS3.EDO.StatisticsEDOHandlers:showTitleCutTotalDiv"></option> <option name="resultText" value=""></option> <option name="cutLongRows">true</option> <option name="usePaging">full</option> </options> <options name="filterParams"> <options name="ТипДокумента"> <option name="saveToState">false</option> <option name="fieldName">ТипДокумента</option> </options> <options name="ФильтрАвторИлиОтвОтдел"> <option name="saveToState">false</option> <option name="fieldName">ФильтрАвторИлиОтвОтдел</option> </options> <options name="ФильтрАвторИлиОтветственный"> <option name="saveToState">false</option> <option name="fieldName">ФильтрАвторИлиОтветственный</option> </options> <options name="ФильтрВладелец"> <option name="saveToState">false</option> <option name="fieldName">ФильтрВладелец</option> </options> <options name="ФильтрДатаП"> <option name="saveToState">false</option> <option name="fieldName">ФильтрДатаП</option> </options> <options name="ФильтрДатаПериод"> <option name="saveToState">false</option> <option name="fieldName">ФильтрДатаПериод</option> </options> <options name="ФильтрДатаС"> <option name="saveToState">false</option> <option name="fieldName">ФильтрДатаС</option> </options> <options name="ФильтрДокументНашаОрганизация"> <option name="saveToState">false</option> <option name="fieldName">ФильтрДокументНашаОрганизация</option> </options> <options name="ФильтрЛицо1"> <option name="saveToState">false</option> <option name="fieldName">ФильтрЛицо1</option> </options> <options name="ФильтрНезакрепленные"> <option name="saveToState">false</option> <option name="fieldName">ФильтрНезакрепленные</option> </options> <options name="ФильтрОтветственноеЛицо"> <option name="saveToState">false</option> <option name="fieldName">ФильтрОтветственноеЛицо</option> </options> <options name="ФильтрСобытий"> <option name="saveToState">false</option> <option name="fieldName">ФильтрСобытий</option> </options> <options name="ФильтрСостояние"> <option name="saveToState">false</option> <option name="fieldName">ФильтрСостояние</option> </options> <options name="ФильтрУдаленные"> <option name="saveToState">false</option> <option name="fieldName">ФильтрУдаленные</option> </options> <option name="ФильтрТипСобытия" type="string">'+t(e(o.eventType))+'</option> </options> <options name="reports"> <option name="Статистика" value="Elektronnyj_dokumentooborot/Statistika/Pechatnye_formy/StatisticsByContragents.xsl"></option> </options> <options name="handlers"> <option name="onInit" type="function" value="js!SBIS3.EDO.StatisticsEDOHandlers:setStatFilterBrowser"></option> <option name="onRowClick" type="function" value="js!SBIS3.EDO.StatisticsEDOHandlers:onKontrRowClick"></option> <option name="onPrepareReportData" type="function" value="js!SBIS3.EDO.StatisticsEDOHandlers:printReportWithSumms"></option> </options> <option name="autoWidth">true</option> <option name="autoHeight">false</option> <option name="owner" value=""></option> <option name="multiSelect">false</option> <option name="reloadAfterChange">true</option> <option name="allowAdd">false</option> <option name="allowDelete">false</option> <option name="allowEdit">false</option> </component> </div>',(a=t(a))+(i&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.StatisticsIncomingDocsContragents/StatisticsContragents"}},o});
define('js!SBIS3.EDO.StatisticsIncomingDocsContragents',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.StatisticsIncomingDocsContragents/StatisticsContragents','js!SBIS3.EDO.StatisticsEDOHandlers','js!SBIS3.EDOStatistics.PathFilterController','Deprecated/Controls/SearchString/SearchString','Deprecated/Controls/PathSelector/PathSelector','Deprecated/Controls/TableView/TableView','js!SBIS3.EDO.FilterController','js!SBIS3.EDO.Filters','js!SBIS3.EDO.FastFilters','js!SBIS3.EDO.InnerStat','Deprecated/Controls/TableView/plugins/Results-plugin','Deprecated/Controls/TableView/plugins/ScrollPaging-plugin','Deprecated/Controls/TemplatedArea/TemplatedArea','Elektronnyj_dokumentooborot_localization'],function(t,e){var n=t.extend({_dotTplFn:e,$protected:{_options:{autoHeight:false,autoWidth:true,browserName:'Incoming',pathSelectorName:rk('Поставщики'),linkedObject:'СтатистикаСкладВх',queryName:'СтатистикаПоКонтрагентам',eventType:'0'}},$constructor:function(){},init:function(){n.superclass.init.call(this);}});return n;});
define('js!SBIS3.EDO.StatisticsIncomingEventsContragents',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.StatisticsIncomingDocsContragents/StatisticsContragents','js!SBIS3.EDO.StatisticsEDOHandlers','js!SBIS3.EDOStatistics.PathFilterController','Deprecated/Controls/SearchString/SearchString','Deprecated/Controls/PathSelector/PathSelector','Deprecated/Controls/TableView/TableView','js!SBIS3.EDO.FilterController','js!SBIS3.EDO.Filters','js!SBIS3.EDO.FastFilters','js!SBIS3.EDO.InnerStat','Deprecated/Controls/TableView/plugins/Results-plugin','Deprecated/Controls/TableView/plugins/ScrollPaging-plugin','Deprecated/Controls/TemplatedArea/TemplatedArea','Elektronnyj_dokumentooborot_localization'],function(t,e){var n=t.extend({_dotTplFn:e,$protected:{_options:{autoHeight:false,autoWidth:true,browserName:'Incoming',pathSelectorName:rk('Поставщики'),linkedObject:'РеестрВходящих',queryName:'СтатистикаСобытийПоКонтрагенту',eventType:'0'}},$constructor:function(){},init:function(){n.superclass.init.call(this);}});return n;});
define('js!SBIS3.EDO.StatisticsOutgoingDocsContragents',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.StatisticsIncomingDocsContragents/StatisticsContragents','js!SBIS3.EDO.StatisticsEDOHandlers','js!SBIS3.EDOStatistics.PathFilterController','Deprecated/Controls/SearchString/SearchString','Deprecated/Controls/PathSelector/PathSelector','Deprecated/Controls/TableView/TableView','js!SBIS3.EDO.FilterController','js!SBIS3.EDO.Filters','js!SBIS3.EDO.FastFilters','js!SBIS3.EDO.InnerStat','Deprecated/Controls/TableView/plugins/Results-plugin','Deprecated/Controls/TableView/plugins/ScrollPaging-plugin','Deprecated/Controls/TemplatedArea/TemplatedArea','Elektronnyj_dokumentooborot_localization'],function(t,e){var r=t.extend({_dotTplFn:e,$protected:{_options:{autoHeight:false,autoWidth:true,browserName:'Outgoing',pathSelectorName:rk('Покупатели'),linkedObject:'СтатистикаСкладИсх',queryName:'СтатистикаПоКонтрагентам',eventType:'1'}},$constructor:function(){},init:function(){r.superclass.init.call(this);}});return r;});
define('js!SBIS3.EDO.StatisticsOutgoingEventsContragents',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.StatisticsIncomingDocsContragents/StatisticsContragents','js!SBIS3.EDO.StatisticsEDOHandlers','js!SBIS3.EDOStatistics.PathFilterController','Deprecated/Controls/SearchString/SearchString','Deprecated/Controls/PathSelector/PathSelector','Deprecated/Controls/TableView/TableView','js!SBIS3.EDO.FilterController','js!SBIS3.EDO.Filters','js!SBIS3.EDO.FastFilters','js!SBIS3.EDO.InnerStat','Deprecated/Controls/TableView/plugins/Results-plugin','Deprecated/Controls/TableView/plugins/ScrollPaging-plugin','Deprecated/Controls/TemplatedArea/TemplatedArea','Elektronnyj_dokumentooborot_localization'],function(t,e){var r=t.extend({_dotTplFn:e,$protected:{_options:{autoHeight:false,autoWidth:true,browserName:'Outgoing',pathSelectorName:rk('Покупатели'),linkedObject:'РеестрИсходящих',queryName:'СтатистикаСобытийПоКонтрагенту',eventType:'1'}},$constructor:function(){},init:function(){r.superclass.init.call(this);}});return r;});
define("html!SBIS3.EDO.StatisticsReportByOurOrganizations",function(){var o=function(o){var t=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;o.test(t);)t=t.replace(o,"&#123;&#123;$1&#125;&#125;");return t}}(),n=function(o){return o.join?o.join(""):o.toString()},e=function(o){return void 0===o?"":o&&"object"==typeof o?n(o):""+o},i="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div> <component data-component="Deprecated/Controls/SearchString/SearchString" name="Строка поиска" style="width:400px;height:32px;margin-top:8px;position:absolute;top:0px;left:0px;bottom:auto;right:0px;"> <option name="tooltip">'+t(e(rk("Укажите название организации")))+'</option> <option name="linkedBrowser">Statistics'+t(e(o.browserName))+'OurOrganizations</option> <option name="filterName">Поиск</option> <option name="useBrowserFilter">true</option> </component> <component data-component="Deprecated/Controls/TemplatedArea/TemplatedArea" name="Область по шаблону 1" style="position:absolute !important;float:right !important;left:408px;margin-top:0px;margin-right:0px;top:0px;bottom:0px;right:0px;"> <option name="template">js!SBIS3.EDO.TemplateMainStatFilter</option> </component> <component data-component="Deprecated/Controls/PathSelector/PathSelector" name="Текущее состояние по нашим организациям" style="height:24px;width:400px;position:relative;top:40px;left:0px;bottom:auto;right:0px;margin-top:0px;"> <options name="handlers"> <option name="onInit" type="function" value="js!SBIS3.EDOStatistics.PathFilterController:onReportCaptionFilterReady"></option> <option name="onPathChange" type="function" value="js!SBIS3.EDOStatistics.PathFilterController:onPathChangeHandlerDocs"></option> <option name="onDrawPoint" type="function" value="js!SBIS3.EDOStatistics.PathFilterController:onDrawPointReportCaption"></option> <option name="onArrowClick" type="function" value="js!SBIS3.EDOStatistics.PathFilterController:onReportCaptionArrowClickHandler"></option> </options> </component> <component data-component="Deprecated/Controls/TreeView/TreeView" name="Statistics'+t(e(o.browserName))+'OurOrganizations" class="our-org-report" style=" overflow:hidden;min-height:50px;width:auto;position:relative;margin-top:30px;left:0px;bottom:auto;right:0px;"> <options name="dataSource"> <options name="readerParams"> <option name="queryName" value="'+t(e(o.queryName))+'"></option> <option name="createMethodName" value="'+t(e(o.createMethodName))+'"></option> <option name="updateMethodName" value="Записать"></option> <option name="readMethodName" value="'+t(e(o.readMethodName))+'"></option> <option name="destroyMethodName" value="'+t(e(o.destroyMethodName))+'"></option> <option name="linkedObject">'+t(e(o.linkedObject))+'</option> <option name="format" value=""></option> </options> <option name="firstRequest">true</option> </options> <options name="display"> <option name="partiallyLoad" value="false"></option> <option name="hierColumn" value="Раздел"></option> <option name="titleColumn" value="Раздел"></option> <option name="emptyHtml">'+t(e(rk("Нет данных")))+'</option> <option name="emptyTableHtml">'+t(e(rk("Нет данных")))+'</option> <options name="columns" type="array"> <options> <option name="field" value="Название"></option> <option name="render" type="function" value="js!SBIS3.EDO.StatisticsReportByOurOrganizations:prototype.renderNameColumn"></option> <option name="title" value=""></option> <option name="width">287</option> <option name="textAlign">left</option> </options> <options> <option name="field" value="Всего"></option> <option name="captionRender" type="function" value="js!SBIS3.EDO.StatisticsReportByOurOrganizations:prototype.renderCaptionTotalCoulumnBold"></option> <option name="render" type="function" value="js!SBIS3.EDO.StatisticsReportByOurOrganizations:prototype.renderCountColumn"></option> <option name="title">'+t(e(rk("Всего")))+'</option> <option name="width">80</option> <option name="textAlign">right</option> <option name="fixedSize">true</option> <option name="isResultField">true</option> <option name="captionAlign">right</option> <option name="className" value="column-bold column-black"></option> </options> '+t(e(o.additionalColumns))+' </options> <option name="useSorting">true</option> <option name="addRecordInEmptyTable">false</option> <option name="resultsRender" type="function" value="js!SBIS3.EDO.StatisticsReportByOurOrganizations:prototype.renderTotalRow"></option> <option name="resultText" value=""></option> <option name="rowRender" type="function" value="js!SBIS3.EDO.StatisticsReportByOurOrganizations:prototype.renderRow"></option> <option name="cutLongRows">true</option> <option name="expand">folders</option> <option name="reload">false</option> <option name="viewMode" value=""></option> </options> <options name="filterParams"> <options name="ТипДокумента"> <option name="saveToState">false</option> <option name="fieldName">ТипДокумента</option> </options> <options name="ФильтрАвторИлиОтвОтдел"> <option name="saveToState">false</option> <option name="fieldName">ФильтрАвторИлиОтвОтдел</option> </options> <options name="ФильтрАвторИлиОтветственный"> <option name="saveToState">false</option> <option name="fieldName">ФильтрАвторИлиОтветственный</option> </options> <options name="ФильтрВладелец"> <option name="saveToState">false</option> <option name="fieldName">ФильтрВладелец</option> </options> <options name="ФильтрДатаП"> <option name="saveToState">false</option> <option name="fieldName">ФильтрДатаП</option> </options> <options name="ФильтрДатаПериод"> <option name="saveToState">false</option> <option name="fieldName">ФильтрДатаПериод</option> </options> <options name="ФильтрДатаС"> <option name="saveToState">false</option> <option name="fieldName">ФильтрДатаС</option> </options> <options name="ФильтрЛицо1"> <option name="saveToState">false</option> <option name="fieldName">ФильтрЛицо1</option> </options> <options name="ФильтрОтветственноеЛицо"> <option name="saveToState">false</option> <option name="fieldName">ФильтрОтветственноеЛицо</option> </options> <options name="ФильтрСобытий"> <option name="saveToState">false</option> <option name="fieldName">ФильтрСобытий</option> </options> <options name="ФильтрУдаленные"> <option name="saveToState">false</option> <option name="fieldName">ФильтрУдаленные</option> </options> <options name="ФильтрНезакрепленные"> <option name="saveToState">false</option> <option name="fieldName">ФильтрНезакрепленные</option> </options> '+t(e(o.additionalFilters))+' </options> <options name="reports"> <option name="Статистика" value="Elektronnyj_dokumentooborot/Statistika/Pechatnye_formy/ReportByOurOrganizations'+t(e(o.reportName))+'.xsl"></option> </options> <options name="handlers"> <options name="onInit" type="array"> <option type="function" value="js!SBIS3.EDO.StatisticsEDOHandlers:setStatFilterBrowser"></option> <option type="function" value="js!SBIS3.EDO.InnerStat:onInitStatBrowser"></option> </options> <option name="onRowClick" type="function" value="js!SBIS3.EDO.StatisticsReportByOurOrganizations:prototype.onOurOrgRowClick"></option> <option name="onPrepareReportData" type="function" value="js!SBIS3.EDO.StatisticsEDOHandlers:printOrgReport"></option> <option name="onAfterLoad" type="function" value="js!SBIS3.EDO.StatisticsReportByOurOrganizations:prototype.onAferLoadBrowser"></option> </options> <option name="autoWidth">true</option> <option name="owner" value=""></option> <option name="multiSelect">false</option> <option name="reloadAfterChange">false</option> <option name="allowAdd">false</option> <option name="allowDelete">false</option> <option name="allowEdit">false</option> <option name="setCursorOnLoad">false</option> <option name="mode">dblClickMode</option> <option name="useHoverRowAsActive">true</option> </component> </div>');return(a=t(a))+(i&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.StatisticsReportByOurOrganizations"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.StatisticsReportByOurOrganizations", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".our-org-report .our-org-report-left-border{border-left:1px solid #eaeaea!important}.our-org-report .ws-browser-results{background-color:rgba(0,0,0,0)}.our-org-report .column-bold{font-weight:700}.our-org-report .column-gray{color:#999}.our-org-report .column-red{color:red}.our-org-report .column-black{color:#000}.our-org-report .column-total-right{text-align:right}.our-org-report .column-total-right span.ws-browser-sigma{float:none}.our-org-report .our-org-report-total-sum{cursor:pointer!important}.our-org-report .our-org-report-total-sum:hover,.our-org-report .ws-browser-cell-cut:hover div,.our-org-report .ws-browser-cell.ws-browser-right:hover div{text-decoration:underline}.our-org-report .ws-browser-cell:hover span.filial-name{text-decoration:underline}.our-org-report .td-org-with-filial{text-decoration:none!important}.our-org-report .filial-comment{color:#999;text-decoration:none!important}.our-org-report .without-ref,.our-org-report .without-ref div{text-decoration:none!important;cursor:default!important}"));head.appendChild(style);});}
define('js!SBIS3.EDO.StatisticsReportByOurOrganizations',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.StatisticsReportByOurOrganizations','js!SBIS3.EDO.StatFuncs','Deprecated/Controls/SearchString/SearchString','Deprecated/Controls/PathSelector/PathSelector','Deprecated/Controls/TreeView/TreeView','Deprecated/Controls/TableView/plugins/Results-plugin','js!SBIS3.EDO.FilterController','js!SBIS3.EDO.StatisticsEDOHandlers','js!SBIS3.EDO.Filters','js!SBIS3.EDO.FastFilters','js!SBIS3.EDO.InnerStat','js!SBIS3.EDOStatistics.PathFilterController','css!SBIS3.EDO.StatisticsReportByOurOrganizations','Deprecated/Controls/TemplatedArea/TemplatedArea','Elektronnyj_dokumentooborot_localization'],function(r,e,t){var o=r.extend({_dotTplFn:e,$protected:{_options:{autoHeight:true,autoWidth:true,browserName:'',methodName:'',reportName:'',additionalColumns:''}},$constructor:function(){},init:function(){o.superclass.init.call(this);},renderCaptionTotalCoulumnBold:function(){var r=rk('Всего');return jQuery('<div class="column-bold column-black" title="'+r+'">'+r+'</div>');},renderCaptionInnerCoulumnBold:function(){var r=rk('Обработка внутри компании'),e=rk('Обработка');return jQuery('<div class="column-bold column-black our-org-report-left-border-td" title="'+r+'">'+e+'&hellip;</div>');},renderCaptionInnerCoulumn:function(){var r=rk('В обработке');return jQuery('<div class="column-black our-org-report-left-border-td" title="'+r+'">'+r+'</div>');},renderCaptionSendCoulumn:function(){var r=rk('Отправлено');return jQuery('<div class="column-bold column-black our-org-report-left-border-td" title="'+r+'">'+r+'</div>');},renderCaptionErrorCoulumn:function(){var r=rk('С ошибками');return jQuery('<div class="column-bold column-red our-org-report-left-border-td" title="'+r+'">'+r+'</div>');},renderCaptionDraftCoulumn:function(){var r=rk('Черновики');return jQuery('<div class="our-org-report-left-border-td" title="'+r+'">'+r+'</div>');},renderCaptionNoSendCoulumn:function(){var r=rk('Не доставлено');return jQuery('<div class="column-black our-org-report-left-border-td" title="'+r+'">'+r+'</div>');},renderCaptionDeliveredCoulumn:function(){var r=rk('Доставлено');return jQuery('<div class="column-black our-org-report-left-border-td" title="'+r+'">'+r+'</div>');},renderCaptionCheckCoulumnIco:function(){var r=rk('Не получен ответ');return jQuery('<div class="icon-16 icon-Sent2 icon-primary" title="'+r+'"></div>');},renderCaptionRecdCoulumnIco:function(){var r=rk('Утверждено');return jQuery('<div class="icon-16 icon-Successful icon-done" title="'+r+'"></div>');},renderCaptionDeclinedCoulumnIco:function(){var r=rk('Отклонено');return jQuery('<div class="icon-16 icon-Unsuccess icon-error" title="'+r+'"></div>');},renderCaptionDelCoulumnIco:function(){var r=rk('Аннулировано');return jQuery('<div class="icon-16 icon-Close icon-disabled" title="'+r+'"></div>');},renderCaptionRecdCoulumn:function(){var r=rk('Утверждено');return jQuery('<div class="column-black our-org-report-left-border-td" title="'+r+'">'+r+'</div>');},renderCaptionDeclinedCoulumn:function(){var r=rk('Отклонено');return jQuery('<div class="column-black our-org-report-left-border-td" title="'+r+'">'+r+'</div>');},renderCaptionDelSenderCoulumn:function(){var r=rk('Аннулировано'),e=rk('Аннулиров');return jQuery('<div class="our-org-report-left-border-td" title="'+r+'">'+e+'&hellip;</div>');},renderNameColumn:function(r,e){if(r.get('Раздел@')){var t=rk(', в том числе по филиалам'),o=r.get(e);return'<div title="'+(o+t)+'">'+'<span class="filial-name">'+o+'</span>'+'<span class="filial-comment">'+t+':</span>'+'</div>';}},renderCountColumn:function(r,e){function t(r,e,o){var n=e.get(r);if(e.get('Раздел@'))for(var i=0;i<o.length;i++){var l=o[i];if(l.get('Раздел')===e.get('@Лицо'))n+=t(r,l,o);}return n;}var o=r.get('Раздел@')?t(e,r,this.getRecordSet().getRecords()):r.get(e);return o?o:'';},renderRow:function(r,e){if(r.get('@Лицо')<0)e.find('.ws-browser-cell').addClass('without-ref');if(r.get('Раздел'))e.find('.ws-browser-cell[coldefindex=0]').addClass('td-org-with-filial');jQuery.each(e.find('.ws-browser-cell'),function(r,e){if(jQuery(e).find('.ws-browser-cell-container').filter(function(){return''===jQuery(this).text();}).length>0)jQuery(e).addClass('without-ref');});},onAferLoadBrowser:function(){var r=this,e=r.getRecordSet().getResults(),t=['Всего','Отправлено','Не_отправлено','В_обработке','Обработка_внутри_компании','Не_доставлено','Доставлено','Не_получен_ответ','Утверждено','Принято','Отклонено','Аннулировано','С_ошибками','Черновики'];r.toggleColumn('Название',true);for(var o=0;o<t.length;o++){var n=t[o];r.toggleColumn(n,e.hasColumn(n)&&e.get(n)>0);}jQuery.each(r.getContainer().find('.ws-browser-header-cell'),function(r,e){if(jQuery(e).find('div.our-org-report-left-border-td').length>0)jQuery(e).addClass('our-org-report-left-border');});},renderTotalRow:function(r,e){var o,n=t.getBrowserFromNewRegistry.call(this),i=function(r,e,o){jQuery(r).click(function(r){t.goToReestrFromOurOrgReport(e,null,null,o);});};jQuery.each(r.find('td.ws-browser-cell-cut'),function(r,e){var t=jQuery(e).find('div.ws-browser-div-cut').text(),l=e.title.replace(new RegExp(' ','g'),'_');if(t&&''!==t)e.title=t,jQuery(e).addClass('our-org-report-total-sum');if('Всего'===t)jQuery(e).addClass('column-total-right'),o=rk('Название');else o=rk(l);i(e,o,n);});},onOurOrgRowClick:function(r,e,o,n,i){if(null===o.get('@Лицо')||'-1'===o.get('@Лицо')||0===o.get(i))return;var l=t.getBrowserFromNewRegistry.call(this);t.goToReestrFromOurOrgReport(i,parseInt(o.get('@Лицо'),10),o.get('Название'),l);},makeColumn:function(r,e,t,o,n,i,l){return'<options>'+'<option name="field" value="'+r+'"></option>'+'<option name="captionRender" type="function" value="js!SBIS3.EDO.StatisticsReportByOurOrganizations:prototype.'+e+'"></option>'+'<option name="render" type="function" value="js!SBIS3.EDO.StatisticsReportByOurOrganizations:prototype.renderCountColumn"></option>'+'<option name="title" value="'+rk(t)+'"></option>'+'<option name="width">'+o+'</option>'+'<option name="textAlign">right</option>'+'<option name="fixedSize">true</option>'+(i?'':'<option name="isResultField">true</option>')+(l?'':'<option name="captionAlign">right</option>')+'<option name="className" value="'+n+'"></option>'+'</options>';},makeFilter:function(r){return'<options name="'+r+'">'+'<option name="saveToState">false</option>'+'<option name="fieldName">'+r+'</option>'+'</options>';}});return o;});
define('js!SBIS3.EDO.StatisticsIncomingDocsOurOrganizations',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.StatisticsReportByOurOrganizations','js!SBIS3.EDO.StatisticsReportByOurOrganizations','Deprecated/Controls/SearchString/SearchString','Deprecated/Controls/TemplatedArea/TemplatedArea','Deprecated/Controls/PathSelector/PathSelector','js!SBIS3.EDOStatistics.PathFilterController','Deprecated/Controls/TreeView/TreeView','js!SBIS3.EDO.StatisticsEDOHandlers','Elektronnyj_dokumentooborot_localization'],function(e,t,r){var o=e.extend({_dotTplFn:t,$protected:{_options:{autoHeight:true,autoWidth:true,browserName:'IncomingDocs',queryName:'СтатистикаВходящихПоНО',createMethodName:'FormatKeyByDocumentId',readMethodName:'getTypeAndSubtypeWithChildren',destroyMethodName:'ЗагрузитьФайл',linkedObject:'Документ',reportName:'Incoming',additionalColumns:''+r.prototype.makeColumn('Обработка_внутри_компании','renderCaptionInnerCoulumn','В обработке','74','our-org-report-left-border')+r.prototype.makeColumn('Утверждено','renderCaptionRecdCoulumn','Утверждено','74','our-org-report-left-border')+r.prototype.makeColumn('Отклонено','renderCaptionDeclinedCoulumn','Отклонено','66','our-org-report-left-border')+r.prototype.makeColumn('Черновики','renderCaptionDraftCoulumn','Черновики','66','column-gray our-org-report-left-border')+r.prototype.makeColumn('Аннулировано','renderCaptionDelSenderCoulumn','Аннулировано','74','column-gray our-org-report-left-border'),additionalFilters:r.prototype.makeFilter('ФильтрНеотвеченные')}},$constructor:function(){},init:function(){o.superclass.init.call(this);}});return o;});
define('js!SBIS3.EDO.StatisticsIncomingEventsOurOrganizations',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.StatisticsReportByOurOrganizations','js!SBIS3.EDO.StatisticsReportByOurOrganizations','Deprecated/Controls/SearchString/SearchString','Deprecated/Controls/TemplatedArea/TemplatedArea','Deprecated/Controls/PathSelector/PathSelector','js!SBIS3.EDOStatistics.PathFilterController','Deprecated/Controls/TreeView/TreeView','js!SBIS3.EDO.StatisticsEDOHandlers','Elektronnyj_dokumentooborot_localization'],function(e,r,t){var o=e.extend({_dotTplFn:r,$protected:{_options:{autoHeight:true,autoWidth:true,browserName:'IncomingEvents',queryName:'СтатистикаСобытийПоНО',createMethodName:'Создать',readMethodName:'Прочитать',destroyMethodName:'Удалить',linkedObject:'РеестрВходящих',reportName:'Incoming',additionalColumns:''+t.prototype.makeColumn('Обработка_внутри_компании','renderCaptionInnerCoulumn','В обработке','74','our-org-report-left-border',void 0,true)+t.prototype.makeColumn('Утверждено','renderCaptionRecdCoulumn','Утверждено','74','our-org-report-left-border')+t.prototype.makeColumn('Отклонено','renderCaptionDeclinedCoulumn','Отклонено','66','our-org-report-left-border')+t.prototype.makeColumn('Черновики','renderCaptionDraftCoulumn','Черновики','66','column-gray our-org-report-left-border')+t.prototype.makeColumn('Аннулировано','renderCaptionDelSenderCoulumn','Аннулировано','74','column-gray our-org-report-left-border'),additionalFilters:''}},$constructor:function(){},init:function(){o.superclass.init.call(this);}});return o;});
define('js!SBIS3.EDO.StatisticsOutgoingDocsOurOrganizations',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.StatisticsReportByOurOrganizations','js!SBIS3.EDO.StatisticsReportByOurOrganizations','Deprecated/Controls/SearchString/SearchString','Deprecated/Controls/TemplatedArea/TemplatedArea','Deprecated/Controls/PathSelector/PathSelector','js!SBIS3.EDOStatistics.PathFilterController','Deprecated/Controls/TreeView/TreeView','js!SBIS3.EDO.StatisticsEDOHandlers','Elektronnyj_dokumentooborot_localization'],function(e,o,r){var t=e.extend({_dotTplFn:o,$protected:{_options:{autoHeight:true,autoWidth:true,browserName:'OutgoingDocs',queryName:'СтатистикаИсходящихПоНО',createMethodName:'FormatKeyByDocumentId',readMethodName:'getTypeAndSubtypeWithChildren',destroyMethodName:'ЗагрузитьФайл',linkedObject:'Документ',reportName:'Outgoing',additionalColumns:''+r.prototype.makeColumn('Обработка_внутри_компании','renderCaptionInnerCoulumnBold','Обработка внутри компании','84','our-org-report-left-border')+r.prototype.makeColumn('Отправлено','renderCaptionSendCoulumn','Отправлено','80','our-org-report-left-border without-ref')+r.prototype.makeColumn('Не_доставлено','renderCaptionNoSendCoulumn','Не доставлено','86','our-org-report-left-border')+r.prototype.makeColumn('Доставлено','renderCaptionDeliveredCoulumn','Доставлено','70','our-org-report-left-border without-ref')+r.prototype.makeColumn('Не_получен_ответ','renderCaptionCheckCoulumnIco','Не получен ответ','52','column-gray')+r.prototype.makeColumn('Принято','renderCaptionRecdCoulumnIco','Принято','52','column-gray')+r.prototype.makeColumn('Отклонено','renderCaptionDeclinedCoulumnIco','Отклонено','52','column-gray')+r.prototype.makeColumn('Аннулировано','renderCaptionDelCoulumnIco','Аннулировано','52','column-gray',true)+r.prototype.makeColumn('С_ошибками','renderCaptionErrorCoulumn','С ошибками','76','our-org-report-left-border column-red')+r.prototype.makeColumn('Черновики','renderCaptionDraftCoulumn','Черновики','64','column-gray our-org-report-left-border'),additionalFilters:r.prototype.makeFilter('ФильтрНеотвеченные')}},$constructor:function(){},init:function(){t.superclass.init.call(this);}});return t;});
define('js!SBIS3.EDO.StatisticsOutgoingEventsOurOrganizations',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.StatisticsReportByOurOrganizations','js!SBIS3.EDO.StatisticsReportByOurOrganizations','Deprecated/Controls/SearchString/SearchString','Deprecated/Controls/TemplatedArea/TemplatedArea','Deprecated/Controls/PathSelector/PathSelector','js!SBIS3.EDOStatistics.PathFilterController','Deprecated/Controls/TreeView/TreeView','js!SBIS3.EDO.StatisticsEDOHandlers','Elektronnyj_dokumentooborot_localization'],function(e,o,r){var t=e.extend({_dotTplFn:o,$protected:{_options:{autoHeight:true,autoWidth:true,browserName:'OutgoingEvents',queryName:'СтатистикаСобытийПоНО',createMethodName:'Создать',readMethodName:'Прочитать',destroyMethodName:'Удалить',linkedObject:'РеестрИсходящих',reportName:'Outgoing',additionalColumns:''+r.prototype.makeColumn('Обработка_внутри_компании','renderCaptionInnerCoulumnBold','Обработка внутри компании','84','our-org-report-left-border',void 0,true)+r.prototype.makeColumn('Отправлено','renderCaptionSendCoulumn','Отправлено','80','our-org-report-left-border without-ref',void 0,true)+r.prototype.makeColumn('Не_доставлено','renderCaptionNoSendCoulumn','Не доставлено','86','our-org-report-left-border',void 0,true)+r.prototype.makeColumn('Доставлено','renderCaptionDeliveredCoulumn','Доставлено','70','our-org-report-left-border without-ref',void 0,true)+r.prototype.makeColumn('Не_получен_ответ','renderCaptionCheckCoulumnIco','Не получен ответ','52','column-gray')+r.prototype.makeColumn('Принято','renderCaptionRecdCoulumnIco','Принято','52','column-gray')+r.prototype.makeColumn('Отклонено','renderCaptionDeclinedCoulumnIco','Отклонено','52','column-gray')+r.prototype.makeColumn('Аннулировано','renderCaptionDelCoulumnIco','Аннулировано','52','column-gray')+r.prototype.makeColumn('С_ошибками','renderCaptionErrorCoulumn','С ошибками','76','our-org-report-left-border column-red')+r.prototype.makeColumn('Черновики','renderCaptionDraftCoulumn','Черновики','64','column-gray our-org-report-left-border'),additionalFilters:''}},$constructor:function(){},init:function(){t.superclass.init.call(this);}});return t;});
define("html!SBIS3.EDO.FilterInnerStatPhase",function(){var o=function(o){var t=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;o.test(t);)t=t.replace(o,"&#123;&#123;$1&#125;&#125;");return t}}(),e=function(o){return o.join?o.join(""):o.toString()},n=function(o){return void 0===o?"":o&&"object"==typeof o?e(o):""+o},i="undefined"!=typeof process,r=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div> <component data-component="SBIS3.EDO.EDOFilter" name="ФильтрЭДОСтатистика"> <options name="rightsLim"> <option name="show">true</option> <option name="textRender" type="function">js!SBIS3.EDO.ScopeFilters:setScopeTextForFilter</option> </options> <option name="filterDataPeriodLimited">true</option> <options name="filtersCustom"> ');return o.FilterPassageStatus&&(r+=' <option name="templateTop">js!SBIS3.EDO.FilterPassageStatus</option> '),r+=' <option name="templateBottom">js!SBIS3.EDO.FilterRepeatStages</option> </options> <options name="filtersEDO"> <options name="FilterFace1"> <option name="show">true</option> </options> <options name="FilterResponsibleFace"> <option name="show">true</option> </options> <options name="FilterAuthorOrResponsibleMe"> <option name="show">true</option> </options> <options name="FilterListDispatch"> <option name="show">'+t(n(o.hideListPerformer))+'</option> </options> <options name="FilterLimitationDate"> <option name="show">true</option> </options> <options name="FilterPriority"> <option name="show">'+t(n(o.showFilterPriority))+"</option> </options> ",o.FilterIdRegulations&&(r+=' <options name="FilterIDRegulations"> <option name="show">true</option> </options> '),r+=' <options name="FilterMilestone"> <option name="show">true</option> </options> </options> </component> </div>',(r=t(r))+(i&&-1!==r.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.FilterInnerStatPhase"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.FilterInnerStatPhase", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(""));head.appendChild(style);});}
define('js!SBIS3.EDO.FilterInnerStatPhase',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.FilterInnerStatPhase','js!SBIS3.EDO.StatFuncs','css!SBIS3.EDO.FilterInnerStatPhase','js!SBIS3.EDO.EDOFilter','js!SBIS3.EDO.ScopeFilters','Elektronnyj_dokumentooborot_localization'],function(t,e,i){var s=true,r=t.extend({_dotTplFn:e,$protected:{_options:{autoHeight:true,autoWidth:true,datePeriodLimited:s?false:true,hideListPerformer:s?false:true,showFilterPriority:s?false:true,FilterIdRegulations:true,FilterPassageStatus:false}},_modifyOptions:function(t){t=r.superclass._modifyOptions.call(this,t);var e=this.getTopParent(),s=e&&e.getOpener(),n=s&&s.getParentByClass('SBIS3.EDO.StatTemplate'),o=n&&n._options,a=o&&o['filter_options']||{},l=i.customizeFiltersToObject(o&&o['customizeFilters']||{});if(a['ИдРегламента'])t['FilterIdRegulations']=false;if(true===l['ФильтрСтатусПерехода'])t['FilterPassageStatus']=true;return t;},$constructor:function(){},init:function(){r.superclass.init.call(this);}});return r;});
define("html!SBIS3.EDO.StatisticsReportByPhase",function(){var o=function(o){var t=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;o.test(t);)t=t.replace(o,"&#123;&#123;$1&#125;&#125;");return t}}(),n=function(o){return o.join?o.join(""):o.toString()},e=function(o){return void 0===o?"":o&&"object"==typeof o?n(o):""+o},i="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div> <component data-component="SBIS3.EDO.FilterController" name="ПанельСФильтромСтат"> <option name="filterLine" type="function" value="js!SBIS3.EDO.InnerStat:filterReglLineRender"></option> <option name="mode" value="hover"></option> <option name="template" value="js!SBIS3.EDO.FilterInnerStatPhase"></option> <options name="filterButtonHandlers"> <options name="onChange" type="array"> <option type="function" value="js!SBIS3.EDO.Filters:onFilterReestrChange"></option> </options> <option name="onBeforeShow" type="function" value="js!SBIS3.EDO.FilterHandlers:onBeforeShowPhaseFilter"></option> <options name="onSetQuery" type="array"> <option type="function" value="js!SBIS3.EDO.InnerStat:changeDefaultFilterPeriodStat"></option> <option type="function" value="js!SBIS3.EDO.StatisticsReportByPhase:prototype.onSetQuery"></option> </options> <option name="onResetFilter" type="function" value="js!SBIS3.EDO.Filters:onResetFiltersWithFast"></option> </options> <options name="pathFilterHandlers"> <option name="onVisualizeFilter" type="function" value="js!SBIS3.EDO.FastFilters:onVisualizeFilter"></option> <option name="onCreatePoint" type="function" value="js!SBIS3.EDO.FastFilters:onCreatePointInnerStat"></option> <option name="onFilterChange" type="function" value="js!SBIS3.EDO.FastFilters:onChangeFastFilterInner"></option> <option name="onInit" type="function" value="js!SBIS3.EDO.InnerStat:onInitStatFastFilters"></option> </options> </component> <component data-component="Deprecated/Controls/HierarchyView/HierarchyView" name="StatisticsReportByPhaseBrowser" style="width:auto;height:auto;" class="phase-report-hierarchy-view statistics-browser"> <options name="dataSource"> <options name="readerParams"> <option name="queryName" value="СтатистикаОтчетПоФазам"></option> <option name="createMethodName" value="Config"></option> <option name="updateMethodName" value="Записать"></option> <option name="readMethodName" value=""></option> <option name="destroyMethodName" value=""></option> <option name="linkedObject">'+t(e(o.docType))+'</option> <option name="format" value=""></option> </options> <option name="firstRequest">false</option> <option name="setCursorOnLoad">false</option> <option name="useHoverRowAsActive">true</option> <option name="useSorting">false</option> </options> <option name="autoHeight">true</option> <options name="display"> <option name="partiallyLoad" value="true"></option> <option name="hierColumn" value="Раздел"></option> <option name="titleColumn" value="Название"></option> <option name="emptyHtml">'+t(e(rk("Нет данных")))+'</option> <option name="emptyTableHtml">'+t(e(rk("Нет данных")))+'</option> <options name="columns" type="array"> <options> <option name="className" value="phase-report-performer"></option> <option name="title" value=""></option> <option name="field">Название</option> <option name="width">255</option> <option name="fixedSize">true</option> <option name="render" type="function" value="js!SBIS3.EDO.InnerStat:renderTitleColumn"></option> <option name="filterName">Исполнитель</option> </options> <options> <option name="field">Итого</option> <option name="title" value=" "></option> <option name="width">56</option> <option name="fixedSize">true</option> <option name="captionAlign">right</option> <option name="isResultField">true</option> <option name="textAlign">right</option> <option name="is_not_overdue">false</option> <option name="textHeadAlign">Bottom</option> <option name="useForFolder">true</option> <option name="render" type="function">js!SBIS3.EDO.StatisticsReportByPhase:prototype.onPhaseColumnRenderOverdue</option> <option name="verticalAlign">bottom</option> </options> </options> <option name="alwaysDisplayResults">true</option> <option name="resultText" value=""></option> <option name="resultType">foldersAndLeaves</option> <option name="resultsRender" type="function">js!SBIS3.EDO.StatisticsReportByPhase:prototype.onTotalRenderPhaseReport</option> <option name="rootName" value=""></option> </options> <options name="filterParams"> <options name="ИдРегламента"> <option name="saveToState">false</option> <option name="fieldName">ИдРегламента</option> </options> <options name="ТипДокумента"> <option name="saveToState">false</option> <option name="fieldName">ТипДокумента</option> </options> <options name="ФильтрАвтор"> <option name="saveToState">false</option> <option name="fieldName">ФильтрАвтор</option> </options> <options name="ФильтрАвторИлиОтвОтдел"> <option name="saveToState">false</option> <option name="fieldName">ФильтрАвторИлиОтвОтдел</option> </options> <options name="ФильтрАвторИлиОтветственный"> <option name="saveToState">false</option> <option name="fieldName">ФильтрАвторИлиОтветственный</option> </options> <options name="ФильтрВладелец"> <option name="saveToState">false</option> <option name="fieldName">ФильтрВладелец</option> </options> <options name="ФильтрДатаП"> <option name="saveToState">false</option> <option name="fieldName">ФильтрДатаП</option> </options> <options name="ФильтрДатаПериод"> <option name="saveToState">false</option> <option name="fieldName">ФильтрДатаПериод</option> </options> <options name="ФильтрДатаС"> <option name="saveToState">false</option> <option name="fieldName">ФильтрДатаС</option> </options> <options name="ФильтрДиапазонДокументов"> <option name="saveToState">false</option> <option name="fieldName">ФильтрДиапазонДокументов</option> </options> <options name="ФильтрЛицо1"> <option name="saveToState">false</option> <option name="fieldName">ФильтрЛицо1</option> </options> <options name="ФильтрОтветственноеЛицо"> <option name="saveToState">false</option> <option name="fieldName">ФильтрОтветственноеЛицо</option> </options> <options name="ФильтрПоВехе"> <option name="saveToState">false</option> <option name="fieldName">ФильтрПоВехе</option> </options> <options name="ФильтрПоКраткомуСостоянию"> <option name="saveToState">false</option> <option name="fieldName">ФильтрПоКраткомуСостоянию</option> </options> <options name="ФильтрПовторные"> <option name="saveToState">false</option> <option name="fieldName">ФильтрПовторные</option> </options> <options name="ФильтрДиапазонДокументов"> <option name="saveToState">false</option> <option name="fieldName">ФильтрДиапазонДокументов</option> </options> <options name="ФильтрПриоритет"> <option name="saveToState">false</option> <option name="fieldName">ФильтрПриоритет</option> </options> <options name="ФильтрПросроченные"> <option name="saveToState">false</option> <option name="fieldName">ФильтрПросроченные</option> </options> <options name="ФильтрСобытий"> <option name="saveToState">false</option> <option name="fieldName">ФильтрСобытий</option> </options> <options name="ФильтрСписокРассылки"> <option name="saveToState">false</option> <option name="fieldName">ФильтрСписокРассылки</option> </options> <options name="ФильтрСрокДата"> <option name="saveToState">false</option> <option name="fieldName">ФильтрСрокДата</option> </options> <options name="ФильтрСтатистикаПериод"> <option name="saveToState">false</option> <option name="fieldName">ФильтрСтатистикаПериод</option> </options> <options name="ФильтрСтатистикаТекущие"> <option name="saveToState">false</option> <option name="fieldName">ФильтрСтатистикаТекущие</option> </options> <options name="ФильтрТипыДокументов"> <option name="saveToState">false</option> <option name="fieldName">ФильтрТипыДокументов</option> </options> <options name="ФильтрСтатусПерехода"> <option name="saveToState">false</option> <option name="fieldName">ФильтрСтатусПерехода</option> </options> <options name="ФильтрВнешняяСтатистика"> <option name="saveToState">false</option> <option name="fieldName">ФильтрВнешняяСтатистика</option> </options> </options> <options name="handlers"> <option name="onInit" type="function">js!SBIS3.EDO.StatisticsReportByPhase:prototype.onInitPhaseReport</option> <option name="onRowClick" type="function" value="js!SBIS3.EDO.InnerStat:onRowClickStat"></option> <option name="onAfterLoad" type="function">js!SBIS3.EDO.StatisticsReportByPhase:prototype.onAfterLoad</option> <option name="onFolderEnter" type="function" value="js!SBIS3.EDO.InnerStat:onBrowserFolderEnterStat"></option> <option name="onAfterRender" type="function">js!SBIS3.EDO.StatisticsReportByPhase:prototype.onAfterRender</option> </options> </component> </div>');return(a=t(a))+(i&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.StatisticsReportByPhase"}},o});
define('js!SBIS3.EDO.StatisticsReportByPhase',['Lib/Control/Control','Lib/Control/Infobox/Infobox','Core/core-extend','Core/core-functions','WS.Data/Source/SbisService','WS.Data/Query/Query','Core/helpers/string-helpers','SBIS3.CONTROLS/CompoundControl','js!SBIS3.EDO.InnerStat','js!SBIS3.EDO.StatFuncs','html!SBIS3.EDO.StatisticsReportByPhase','js!SBIS3.EDO.FilterHandlers','js!SBIS3.EDO.Filters','Deprecated/Controls/HierarchyView/HierarchyView','Deprecated/Controls/TableView/plugins/Ladder-plugin','Deprecated/Controls/TableView/plugins/Results-plugin','js!SBIS3.EDO.FilterController','css!SBIS3.EDO.StatisticsReportByPhase','i18n!SBIS3.EDO.StatisticsReportByPhase','Elektronnyj_dokumentooborot_localization'],function(t,e,r,s,a,i,n,o,l,p,u){var h=o.extend({_dotTplFn:u,$protected:{_options:{autoHeight:true,autoWidth:true,fastFilters:{}}},_modifyOptions:function(t){var e=this.getParentByClass('SBIS3.EDO.StatTemplate')?this.getParentByClass('SBIS3.EDO.StatTemplate')._options.docType:getCurrentNavigationRecord()&&getCurrentNavigationRecord().hasColumn('ТипДокумента')?getCurrentNavigationRecord().get('ТипДокумента'):'Документ';return t.docType=e,t;},$constructor:function(){},init:function(){if(!this.getParent().getLinkedContext().getValue('ФильтрСтатистикаПериод'))this._options.fastFilters={};else this._options.fastFilters={'ФильтрСтатистикаПериод':{defaultValue:rk('Период')}};h.superclass.init.call(this),this.getChildControlByName('ПанельСФильтромСтат').setLinkedView(this.getChildControlByName('StatisticsReportByPhaseBrowser'));},onInitPhaseReport:function(){var r=this;r.phases=f();var s=new i();s.where({'UuidРегламентов':[this.getParent().getLinkedContext().getValue('ИдРегламента')]}),new a({endpoint:'Regulation',binding:{query:'PhaseListStd'}}).query(s).addCallback(function(e){var s=r.getColumns(),a=r.getQuery(),i=[],n=[h.prototype.onPhaseColumnRender,h.prototype.onPhaseColumnRenderOverdue];s.push(l.makeColumn(rk('Всего'),'Итого',56,n,false,true,'bottom','phase-report-fix-font-weight phase-report-total-right-border'));for(var o=0,u=e.getAll().getCount();o<u;++o){var f=e.getAll().at(o),d=f.get('Название').substr(0,60),g=Math.floor(p.columnWidth(d)/2)+10,c=f.get('Название'),S=f.get('ИдРегламентаИдФазы').split(':')[1],v=f.get('ИдРегламентаИдФазы').split(':')[1]+'##'+c,C=r.getParentByClass('SBIS3.EDO.StatTemplate'),m=C&&C._options['filter_options']&&C._options['filter_options']['ИдРегламента']?true:false;i.push(v),r.phases.insertPhase(v,S),s.push(l.makeColumn(v.replace(/\./gi,'&#046;'),v,g,n,true,false,'bottom','phase-report-fix-font-weight')),s.push(l.makeColumn(v.replace(/\./gi,'&#046;'),v,g<57&&m?57:g,n,false,true,'bottom','phase-report-fix-font-weight phase-report-total-right-border'));}if(r.columns_array=s,a['Раздел']=r.getParent().getLinkedContext().getValue('ТекущееПодразделение'),r.setQuery(a),t.ControlStorage.containsByName('ПанельСФильтромСтат'))t.ControlStorage.getByName('ПанельСФильтромСтат').getFilterButton().applyFilter(true);}),r.subscribe('onDataReady',function(t){var r=this.getContainer().find('#inprogressIcon');if(r)r.mouseover(function(){var t=this;e.show({control:t,message:'Один документ может быть одновременно в обработке <br/> у нескольких сотрудников и на нескольких этапах.',hideDelay:4000});});});},onAfterLoad:function(t){for(var e=this,r=this.getQuery(),a=s.clone(e.columns_array),i=e.getRecordSet().getResults(),n=3;n<a.length;n+=2){var o=a[n].field,l=i.hasColumn(o)?i.get(o):0;if('УникальныхДокументов'!==o&&l)if(l=l.length>=5?r['ФильтрПросроченные']?l.split(',')[1]:l.split(',')[0]:l,0===parseInt(l,10)){var p=$.inArray(a[n],a);a.splice(p,2),n-=2;}}e.setColumns(a);},_onPhaseColumnRender:function(t,e,r,s){var a=t.get(e)[0],i=t.get(e)[1],n=s?i:a,o=jQuery('<div class="phase-report-cell"></div>');if(n){var l=d(a,i,s),u='<span class="phase-report-'+(s?'overdue':'count')+'">'+n+'</span>';o.html(u);var h='Итого'!==e&&'Название'!==e&&'ПросроченныхПоСроку'!==e&&'УникальныхДокументов'!==e?{'ФильтрИдФазы':e.split('##')[1]}:void 0;if(p.generateHref(o,this,e,t,false,void 0,void 0,s,h),o.attr({title:l}),t.hasColumn('Раздел@')&&t.get('Раздел@'))o.addClass('folder_font');}return o;},onPhaseColumnRender:function(){return h.prototype._onPhaseColumnRender.apply(this,[].slice.call(arguments).concat([false]));},onPhaseColumnRenderOverdue:function(){if(this.getQuery()['ФильтрСрокДата'])return jQuery('<div class="phase-report-cell"></div>');var t=h.prototype._onPhaseColumnRender.apply(this,[].slice.call(arguments).concat([true]));return t.addClass('overdue-stat-count'),t;},onSetQuery:function(t,e){var r=this.getParentByClass('SBIS3.EDO.StatTemplate')?this.getParentByClass('SBIS3.EDO.StatTemplate'):null;if(r&&r._options['template']&&!e['ИдРегламента'])return p.goToMainInnerStatReport(r._options['template'],this.getParent().getParent().getParent(),this.getBrowser(),e),t.setResult(false),false;if((!e['ФильтрСтатистикаПериод']||'Период'===e['ФильтрСтатистикаПериод'])&&((r?'current'!==r._options['statisticsType']:false)||!e['ФильтрПоКраткомуСостоянию']))return p.goToMainInnerStatReport('js!SBIS3.EDO.PeriodStatReport',this.getParent().getParent().getParent(),this.getBrowser(),e),t.setResult(false),false;if(!e['ИдРегламента'])if(r&&r._options['filter_options']&&r._options['filter_options']['ИдРегламента']){e['ИдРегламента']=r._options['filter_options']['ИдРегламента'];var s=this.getBrowser().getQuery(),a=true;for(var i in e)if(e[i]!==s[i])a=false;if(a)return t.setResult(false),false;}else return p.goToMainInnerStatReport(null,this.getParent().getParent().getParent(),this.getBrowser(),e),t.setResult(false),false;else if(e['ИдРегламента']!==this.getBrowser().getQuery()['ИдРегламента'])return p.goToInnerStatReport('js!SBIS3.EDO.StatisticsReportByPhase',e,this.getParent().getParent().getParent()),t.setResult(false),false;if(e['ИдРегламента']===this.getBrowser().getQuery()['ИдРегламента']&&e['ФильтрИдФазы'])if(this.getFloatArea().hasChildControlByName('ФильтрИдФазы'))return p.goToInnerStatReport('js!SBIS3.EDO.StatisticsReportTransitions',e,this.getParent().getParent().getParent()),t.setResult(false),false;},onTotalRenderPhaseReport:function(t,e){if(null===e)return;var r='',s=this,a=s.getParent().getParent(),i=s.getQuery(),o=(!i['ФильтрПоКраткомуСостоянию']||'4'===i['ФильтрПоКраткомуСостоянию']||4===i['ФильтрПоКраткомуСостоянию'])&&!!i['ФильтрПросроченные'],l=i['ФильтрПросроченные'];function u(t,e){t.click(function(t){p.goToPhasesWork(t,e);});}for(var h=0;h<s.getColumns().length;h++){var f=s.getColumns()[h].field,g=$('<div></div>'),c,S=this.getQuery()['ИдРегламента'];if(e.hasColumn(f))if(c=e.get(f),'УникальныхДокументов'!==f)if(c=c.split(','),c&&3===c.length){r=d(c[0],c[1],l);var v=s.getColumns()[h].title,C=!s.getColumns()[h].is_not_overdue,m,y;if('Итого'===f&&C)m=t.find('td').eq(1).find('div');if('Итого'===f&&!C)m=t.find('td').eq(2).find('div');if('Итого'!==f)(m=t.find('td[title="'+v+'"] div').eq(0)).parent().attr('title','');if(0!==m.length){var P=c[0],B;if(C)if(i['ФильтрСрокДата'])P='';else P='0'!==c[1]?c[1]:'',C=true,m.addClass('overdue-stat-count');m.attr({title:r}),B=$('<span class="phase-report-link" >'+P+'</span>');var R=s.getContainer().find('tr.ws-browser-head-top td[columnid='+h+']'),_=R.find('div');if('Итого'!==f){var I=s.phases.getPhaseIdList(f),O=-1!==v.indexOf('##')?v.split('##')[1]:v,D=rk('Этап')+' "'+(-1!==f.indexOf('##')?f.split('##')[1]:f)+'"',b=c[2],w='',T='';if(l&&b>0)w=b>=24?b/24+' д.':b+' ч.',T=' '+rk('норма выполнения этапа')+' '+w;if(y={'ФильтрИдФазы':O},'Выполнено'!==i['ФильтрСтатистикаПериод']||i['ФильтрПоКраткомуСостоянию']&&('4'===i['ФильтрПоКраткомуСостоянию']||4===i['ФильтрПоКраткомуСостоянию']))D+=T,u(_,p.generateHrefValue(s,f,e,true,void 0,void 0,void 0,void 0,y));else D+=T,function(t,e,r,s){t.click(function(t){e['ФильтрИдФазы']=e['ИдРегламента']+':'+s,p.goToInnerStatReport('js!SBIS3.EDO.StatisticsReportTransitions',e,r);});}(g,i,a,I);if(g.addClass('phase-report-link cut-column-caption'),g.attr('title',D),g.html(n.escapeHtml(O.length>40?O.substr(0,40)+'...':O)),_.html(g),R.addClass('phase-report-total-right-border'),l&&b>0){var k='<div class="phase-report-latetime-header-cell" title="'+D+'"><div class="icon-16 icon-Time icon-disabled" style="display: inline !important;"></div>&nbsp';k+=w+'</div>',$(t.find('td')[h]).prepend($(k));}}else if(C){if(g.text(''),g.attr('style','margin-right: 3px;'),!i['ФильтрСрокДата']&&'0'!==c[1].toString())g.addClass('icon-16 icon-Time icon-disabled'),g.attr('style','margin-top: 3px;'),g.addClass('overdue-stat-count'),g.attr('title',rk('Нарушен срок'));_.html(g);}else R.addClass('phase-report-total-right-border'),R.attr('title','Всего');if('0'!==P)u(B,p.generateHrefValue(s,f,e,true,void 0,void 0,void 0,C,y));m.html(B);}}}t.addClass('phase-report-total-row');},onAfterRender:function(t){l.setClickToDetalization(this,'span.phase-report-link,span.phase-report-link-title');}});return h;function f(){return new(r({},{$protected:{_phaseMap:{}},$constructor:function(){},insertPhase:function(t,e,r){this._phaseMap[t]=e;},getPhaseCount:function(){var t=0;for(var e in this._phaseMap)if(this._phaseMap.hasOwnProperty(e))++t;return t;},getPhaseIdList:function(t){if(-1===t){var e=[];for(var r in this._phaseMap)if(e.hasOwnProperty(r))e.push(this._phaseMap[r][0]);return e;}else return this._phaseMap[t];}}))();}function d(t,e,r){return r?e:t;}function g(t,e,r){var s='<span class="phase-report-count" >'+t+'</span>',a='<span class="phase-report-separator"> / </span>',i='<span class="phase-report-overdue" >'+e+'</span>',n='',o=false;if(r){if(r.getQuery()['ФильтрПросроченные'])o=true;if(o){if(e>0)n=i;}else if(t>0)n=s;}return'<div class="phase-report-cell" >'+n+'</div>';}});
define("html!SBIS3.EDO.DateDoneCol",function(){var e=function(e){var t=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;e.test(t);)t=t.replace(e,"&#123;&#123;$1&#125;&#125;");return t}}(),n=function(e){return e.join?e.join(""):e.toString()},i=function(e){return void 0===e?"":e&&"object"==typeof e?n(e):""+e},o="undefined"!=typeof process,r=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,"");return e.templateBinding.only_date&&(r+=" ",e.only_date=!0,r+=" "),r+=" ",e.templateBinding.date_field&&(r+=" ",e.date_field="ДокументДатаВремя",r+=" "),r+=" ",e.templateBinding.tasks&&(r+=" ",e.tasks=e.templateBinding.tasks,r+=" "),r+=" ",e.templateBinding.big_date&&(r+=" ",e.big_date=e.templateBinding.big_date,r+=" "),r+=" ",e.templateBinding.no_title&&(r+=" ",e.no_title=e.templateBinding.no_title,r+=" "),r+=" "+t(i(e.included.DateCol(e)))+" ",(r=t(r))+(o&&-1!==r.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.DateDoneCol"}},e});
define('js!SBIS3.EDO.DateDoneCol',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.DateDoneCol','css!SBIS3.EDO.DateCol','Elektronnyj_dokumentooborot_localization'],function(t,n){'use strict';var o=t.extend({_dotTplFn:n,$protected:{_options:{name:'DateDoneCol'}},$constructor:function(){},init:function(){var t=this;o.superclass.init.call(t);}});return o;});
define("html!SBIS3.EDO.ResponsibleCol",function(){var e=function(e){var i=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(i){for(;e.test(i);)i=i.replace(e,"&#123;&#123;$1&#125;&#125;");return i}}(),n=function(e){return e.join?e.join(""):e.toString()},o=function(e){return void 0===e?"":e&&"object"==typeof e?n(e):""+e},r="undefined"!=typeof process,t=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,""),s=(e.item,e.item.get("responsible")),d=s?s.mainInfo:"",a=s?s.additionalInfo:"",l=s?s.faceId:null,f=d?"ResponsibleCol_office":"ResponsibleCol_face";return t+=" <div class=\"ResponsibleCol\" data-minicard-template='js!SBIS3.PersonalOffice.MiniCard' ",l&&(t+=" data-minicard-oid='"+i(o(l))+"' "),t+=' data-minicard-mode=\'click\'> <div class="ResponsibleCol_face edo-registry_noEdit" title="'+i(o(rk("Ответственный")))+": "+i(o(d))+'">'+i(o(d))+'</div> <div class="'+i(o(f))+' edo-registry_noEdit">'+i(o(a))+"</div> </div> ",(t=i(t))+(r&&-1!==t.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.ResponsibleCol"}},e});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.ResponsibleCol", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".ResponsibleCol_face{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.ResponsibleCol_face:hover{text-decoration:underline}.ResponsibleCol_office{line-height:19px;font-size:12px;color:#999!important;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.col_resp_pattern{vertical-align:top!important}.removedByKontragent{color:#ccc!important}.inOutDoc_responsible .ResponsibleCol_face{margin-bottom:1px;margin-top:1px}.ResponsibleCol .ResponsibleCol_office{position:relative;top:1px}"));head.appendChild(style);});}
define('js!SBIS3.EDO.ResponsibleCol',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.ResponsibleCol','css!SBIS3.EDO.ResponsibleCol','i18n!SBIS3.EDO.ResponsibleCol','Elektronnyj_dokumentooborot_localization'],function(n,o){'use strict';var s=n.extend({_dotTplFn:o,$protected:{_options:{name:'ResponsibleCol'}},$constructor:function(){},init:function(){var n=this;s.superclass.init.call(n);}});return s;});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.Statistics.ColumnsTemplate.Handlers", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".phase-report-link-title{text-decoration:none;cursor:auto}.phase-report-link-title:hover{cursor:pointer}.regulation-caption:hover{text-decoration:underline!important;cursor:pointer;color:#ff7033}.statistics-browser .controls-DataGridView__results{background-color:rgba(0,0,0,0);border-bottom:1px solid #eaeaea!important}.statistics-browser .controls-DataGridView .controls-DataGridView__table .controls-DataGridView__td{cursor:default!important}.bold_boss{font-weight:700}.statistics-browser .folder_font{font-size:15px}.statistics-browser .overdue-stat-count{color:#ef463a!important}.phase-report-link{text-decoration:none;width:100%;display:inline-block}.phase-report-link:hover{text-decoration:underline;cursor:pointer}"));head.appendChild(style);});}
define('js!SBIS3.EDO.Statistics.ColumnsTemplate.Handlers',['Core/helpers/string-helpers-min','Core/helpers/string-helpers','js!SBIS3.EDO.StatFuncs','css!SBIS3.EDO.Statistics.ColumnsTemplate.Handlers','Elektronnyj_dokumentooborot_localization'],function(e,t,r){'use strict';return Handlers={getDate:function(e,t){return e&&t in e&&e[t]?'string'===typeof e[t]?e[t]:e[t].toSQL():null;},getCounter:function(e,t,r,i){if(r&&'Просрочено'===r||!r)r='Итого';return e.item.get(r)?(t?e.item.get(r).split(','):e.item.get(r))[i]:null;},generateHrefParams:function(r,i,n,s,l,o,a,u,f,g){var m=n?r['Раздел']?[r['Раздел']]:null:i.item.get('@Лицо')?[parseInt(i.item.get('@Лицо'),10)]:null,c=n?r['Раздел']?r['Раздел']:'Всего':i.item.get('Название')?t.escapeHtml(i.item.get('Название')):null,p=n?true:i.item.get('Раздел@')?i.item.get('Раздел@'):null,d={face:m,count:!!a||0===a?a:Handlers.getCounter(i,n,o,0),overdue:!!u||0===u?u:Handlers.getCounter(i,n,o,1),title:'other_reglaments'===o?n?'Прочих':'Всего':c,isDivision:'other_reglaments'===o?n?false:p:p,filter:{}};for(var S in r)if(r.hasOwnProperty(S))d.filter[S]=r[S];return d.filter['Регламент']=r&&r['Регламент']?r['Регламент']:l,d.filter['ФильтрДатаС']=Handlers.getDate(r,'ФильтрДатаС'),d.filter['ФильтрДатаП']=Handlers.getDate(r,'ФильтрДатаП'),d.filter['ФильтрСрокДата']=r&&r['ФильтрСрокДата']?new Date(r['ФильтрСрокДата']).toSQL():void 0,d.filter['ФильтрПросроченные']=s,d.filter['ФильтрНераспределенные']='Нераспределенные'===i.item.get('Название'),d.filter['ФильтрУдаленные']=false,d.filter['ФильтрСтатистикаПериод']=f?f:r&&r['ФильтрСтатистикаПериод'],d.filter['ФильтрНеПустойПереход']=g&&'StatisticsReportTransitionsBrowser'===g.getName()?true:void 0,encodeURIComponent(e.serializeURLData(d));},setClickPhasesWork:function(e,t){e.click(function(e){r.goToPhasesWork(e,t,void 0,true);});},goToInnerStatReport:function(e,t,r){}};});
define("html!SBIS3.EDO.Statistics.ColumnsTemplate.TitleCell",function(){var e=function(e){var t=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;e.test(t);)t=t.replace(e,"&#123;&#123;$1&#125;&#125;");return t}}(),r=function(e){return e.join?e.join(""):e.toString()},n=function(e){return void 0===e?"":e&&"object"==typeof e?r(e):""+e},i="undefined"!=typeof process,o=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,""),l=global.requirejs("Core/helpers/string-helpers"),s=e.item.get("Название")||"без имени",a=-1===e.item.get("@Лицо")?rk(s):l.escapeHtml(s),p=!!e.item.get("Руководитель"),u=!!e.item.get("Раздел@"),f=e.item.get("Должность")||"",d=l.escapeHtml(f),m=!u&&-1!==e.item.get("@Лицо");return o+=' <span title="'+t(n(a))+'" class="'+t(n("phase-report-link-title"))+'"> ',m&&(o+=' <div style="float: left; margin-right: 4px;"> '+t(n(e.included.photoTpl(e)))+" </div> "),o+=' <span title="'+t(n(a))+'" style="',p&&(o+="font-weight: 700;"),o+='"> '+t(n(a))+' </span> <br/> <span style="font-size: 12px; color: #999999; text-overflow: ellipsis; overflow: hidden;" title="'+t(n(d))+'">'+t(n(d))+"</span> </span> ",(o=t(o))+(i&&-1!==o.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.Statistics.ColumnsTemplate.TitleCell"}},e});
define('js!SBIS3.EDO.Statistics.ColumnsTemplate.TitleCell',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.Statistics.ColumnsTemplate.TitleCell','html!SBIS3.PersonCore.Photo/photoCellTpl','css!SBIS3.EDO.InnerStat','Core/helpers/string-helpers','i18n!SBIS3.EDO.Statistics.ColumnsTemplate.TitleCell','Elektronnyj_dokumentooborot_localization'],function(t,e){'use strict';var l=t.extend({_dotTplFn:e,$protected:{_options:{name:'Statistics.ColumnsTemplate.TitleCell'}},$constructor:function(){},init:function(){var t=this;l.superclass.init.call(t);}});return l;});
define("html!SBIS3.EDO.TaskColBigPreview",function(){var e=function(e){var t,i=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;e.test(t);)t=t.replace(e,"&#123;&#123;$1&#125;&#125;");return t}}(),o=function(e){return e.join?e.join(""):e.toString()},r=function(e){return void 0===e?"":e&&"object"==typeof e?o(e):""+e},n="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,""),s=global.requirejs("Core/helpers/string-helpers"),l=e.item.get("СписокИсполнителей"),d=e.item.get("Лицо.Название"),p=s.escapeHtml(e.item.get("РП.ПодразделенияСотрудника")),c=(function(e){var t=e.get("РП.ДополнительнаяИнформация");t.getCount&&t.getCount()}(e.item),e.item.get("@ВнешнийДокумент")),v=e.item.get("@ВерсияВнешнегоДокумента"),u=e.item.get("ДатаВремя");currWidth=300,currHeight=424;var _=function(e,t){var i=e||"";return t=t||255,i=i.replace(/<[^>]+>/g,""),(i=s.escapeHtml(i)).length>t&&(i=i.substr(0,t)+"..."),i}(e.item.get("ДокументРасширение.Название")||e.item.get("РазличныеДокументы.Информация")||"");if(l&&l.getCount())if(t=l.at(0),l.getCount()>1){for(var g=l.getCount(),m=[],f=0;f<g;f++)m.push(l.at(f).get("Название"));d=m.length?m.join(","):""}else t&&(d=t.get("Название"),t&&'"ЧастноеЛицо"'===t.get("Лицо_")&&(p=t.get("Подразделение")));if(a+=' <div class="rt_unallocated_list"> <div class="rt_unallocated_descr"> <div class="rt_left_bp rt_float"> <div class="rt_photo rt_float"> '+i(r(e.decorators.applyOnly(e.included.photoTpl(e),{ladder:{column:"face_foto",parentId:e.item.get(e.parentProperty)}})))+' </div> </div> <div class="rt_bp"> <span class="rt_username_bp">'+i(r(e.decorators.apply(d)))+'</span> <span class="rt_user_dept_bp">'+i(r(p?" / "+p:""))+'</span> </div> <div class="rt_descr_bp rt_float"> ',null!==e.item.get("ДокументРасширение.Название")?a+=' <div class="rt_descr_text_bp rt_float">'+i(r(e.decorators.apply(_)))+" </div> ":a+=' <div class="rt_desc_bp rt_float"></div> ',a+=' <div class="rt_date_bp rt_float"> ',!0!==e.isNode){a+=" ";a+=' <div class="datecol"> <span class="datecol_date">'+i(r(e.item.get("Дата")?e.item.get("Дата").strftime("%d.%m"):""))+"</span> </div> "}return a+=' </div> </div> </div> <div class="controls-ListView__itemCheckBox js-controls-ListView__itemCheckBox rt_big_preview_CheckBox"></div> <div class="rt_big_preview_base"> <div ',a+=' class="rt_big_preview_one" ',a+='> <component data-component="SBIS3.DOCVIEW.Preview"> <option name="width" value="'+i(r(currWidth))+'"></option> <option name="height" value="'+i(r(currHeight))+'"></option> <option name="attachId" value="'+i(r(c))+'" type="string"></option> <option name="redactionId" value="'+i(r(v))+'" type="string"></option> <option name="serviceUrl" value="/"></option> <option name="objectName" value="Документ"></option> <option name="hash" value="'+i(r(u))+'"></option> <option name="activableByClick" value="false"></option> </component> </div> </div> </div>',(a=i(a))+(n&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.TaskColBigPreview"}},e});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.TaskColBigPreview", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".rt_left_bp{width:40px;float:left;padding-right:5px}.rt_username_bp{font-weight:700;color:#000;font-size:14px}.rt_user_dept_bp{color:#999;font-size:12px}.rt_descr_bp{width:300px;height:25px}.rt_date_bp{float:right}.rt_descr_text_bp{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;width:215px;float:left}.rt_regl{float:left}.rt_rightside{float:right;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.rt_rightside div{display:inline-block}.rt_milestone{color:#999;font-size:11px}.rt_datelimit{color:#999;padding-left:3px}.rt_datelimit .icon-16{margin-right:3px}.rt_priopity{display:inline-block;margin-left:3px}.rt_desc_bp{float:left}.rt_pad16{padding-left:16px}.rt_files{color:#999}.rt_overtask{color:#999;font-size:11px}.rt_overtask:hover{text-decoration:underline;cursor:pointer;color:#ff7033!important}.rt_currcond,.rt_prevcomment{color:#999;font-size:11px}.rt_datelimit_red{color:#e22323}.rt_wrapper.unreaded *{font-weight:700}.rt_folder_count{color:#999}.rt_folder_count_new{color:#ff7033}.rt_subtasks{cursor:pointer;font-size:12px;color:#999}.rt_subtasks:hover{text-decoration:underline}.rt_subtasks .icon-16{vertical-align:text-top;color:#313e78!important;width:13px!important;height:13px!important}.rt_desc p{margin:0}.rt_big_preview_one{border:solid 1px #ccc!important;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABISURBVChTY/wPBAxI4NGjRwwsLCxQHgMDE5TGCUhX8PfvX4Y/f/7AMePDhw/hbgBJKioqQnkQwARyEAwzMzNDhRGAUkcyMAAApgoZuUflpgMAAAAASUVORK5CYII=);background-color:transparent;background-repeat:no-repeat;background-position:center;width:300px!important;height:424px}.rt_big_preview_sev{background-color:#fff;width:300px;height:424px;position:relative;z-index:1}.rt_big_preview_base{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABISURBVChTY/wPBAxI4NGjRwwsLCxQHgMDE5TGCUhX8PfvX4Y/f/7AMePDhw/hbgBJKioqQnkQwARyEAwzMzNDhRGAUkcyMAAApgoZuUflpgMAAAAASUVORK5CYII=);background-color:transparent;width:300px;height:424px;margin:auto;position:relative;z-index:1}.rt_big_preview{border:solid 1px #ccc;width:100%;height:100%;background-repeat:no-repeat;background-position:center;background-color:transparent}.rt_big_preview:after{content:'';display:block;position:absolute;z-index:-1;width:100%;height:100%;bottom:0;right:0;left:8px;top:8px;border:1px solid #ccc}.rt_unallocated_list{width:350px!important;min-width:300px;height:495px;padding:10px}@media only screen and (min-device-width :768px) and (max-device-width :1024px){.rt_unallocated_list{width:50%!important}}.rt_unallocated_descr{width:300px;height:43px;overflow:hidden;margin:auto}.rt_bp{height:20px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;color:#999;font-size:12px}.rt_photo>.ws-invisible>.person-photo-mini-large{display:none}.rt_big_preview_CheckBox{top:7px!important;left:-1px!important}"));head.appendChild(style);});}
define('js!SBIS3.EDO.TaskColBigPreview',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.PersonCore.Photo/photoCellTpl','html!SBIS3.EDO.TaskColBigPreview','Core/helpers/string-helpers','js!SBIS3.DOCVIEW.Preview','css!SBIS3.EDO.TaskColBigPreview','Elektronnyj_dokumentooborot_localization'],function(e,o){'use strict';var t=e.extend({_dotTplFn:o,$protected:{_options:{name:'TaskColBigPreview'}},$constructor:function(){},init:function(){var e=this;t.superclass.init.call(e);}});return t;});
define("tmpl!SBIS3.EDO.CompetenceFieldLink",["Core/tmpl/js/tclosure","js!SBIS3.CONTROLS/FieldLink/Link","js!SBIS3.Person.PersonsCollage","js!SBIS3.CONTROLS/FieldLink","js!SBIS3.CONTROLS/DataGridView","js!SBIS3.CONTROLS/Link","js!SBIS3.CONTROLS/Action/OpenDialogAction"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],o={};o["js!SBIS3.CONTROLS/FieldLink/Link"]=e[1],o["js!SBIS3.Person.PersonsCollage"]=e[2],o["js!SBIS3.CONTROLS/FieldLink"]=e[3],o["js!SBIS3.CONTROLS/DataGridView"]=e[4],o["js!SBIS3.CONTROLS/Link"]=e[5],o["js!SBIS3.CONTROLS/Action/OpenDialogAction"]=e[6];var i=function e(i,n,r,a,l){function s(){}var c=0,p=void 0!==t&&t?t:arguments[arguments.length-1];void 0===p&&(eval("var thelpers = null;"),p=global.requirejs("View/Runner/tclosure"));var d={};l&&l.isSetts&&(d=l.fullContext||{});var m="string"==typeof r?r:"",S=void 0===o?void 0:o,u={id:[],def:void 0},f=p.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,i),g=this&&this.includedTemplates?this.includedTemplates:{},C=p.getMarkupGenerator(a);try{var h=C.joinElements([C.createTag("div",{class:"edo-CompetenceFieldLink"},[C.createTag("div",{},[C.createControl("wsControl","ws:SBIS3.CONTROLS/FieldLink/Link",{name:"showSelectorPerformer",caption:global.rk("Исполнитель"),owner:"StaffChoice__fieldLink",tabindex:"0"},{name:"showSelectorPerformer",sbisname:"showSelectorPerformer"},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},r,S,g,p.config,d),p.getter(i,["allowResponsibilityZone"])?[C.createControl("wsControl","ws:SBIS3.CONTROLS/FieldLink/Link",{name:"TaskControls_isplink",caption:"&nbsp/&nbsp",tabindex:"0",enabled:!1,bindings:[{fieldName:"record/isVisibleZoneLabel",propName:"visible",propPath:[],fullPropName:"visible",propPathStr:"",oneWay:!0,direction:"fromContext",bindNonExistent:!0}],visible:p.getter(i,["isVisibleZoneLabel"])},{name:"TaskControls_isplink",sbisname:"TaskControls_isplink"},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},r,S,g,p.config,d),C.createControl("wsControl","ws:SBIS3.CONTROLS/FieldLink/Link",{handlers:{onActivated:p.getTypeFunc(" js!SBIS3.EDO.CompetenceFieldLink:prototype.activatedResponsibilityZoneLink ",{})},name:"showSelectorResponsibilityZone",caption:global.rk("Зона ответственности"),owner:"StaffChoice__fieldLink",tabindex:"0",bindings:[{fieldName:"record/isVisibleZoneLabel",propName:"visible",propPath:[],fullPropName:"visible",propPathStr:"",oneWay:!0,direction:"fromContext",bindNonExistent:!0}],visible:p.getter(i,["isVisibleZoneLabel"]),esc:!1},{name:"showSelectorResponsibilityZone",sbisname:"showSelectorResponsibilityZone"},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},r,S,g,p.config,d)]:C.createText("")],{},u,this),C.createControl("wsControl","ws:SBIS3.Person.PersonsCollage",{settings:{size:"40"},name:"competenceCollage",tabindex:"0",data:p.getter(i,["photoData"]),esc:!1},{class:"StaffChoice__staffCollage",name:"competenceCollage",sbisname:"competenceCollage"},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},r,S,g,p.config,d),C.createControl("wsControl","ws:SBIS3.CONTROLS/FieldLink",{itemsSortMethod:p.getTypeFunc(" js!SBIS3.EDO.FTaskControlsHandlers:sortm ",{}),dictionaries:[{componentOptions:{curCompetenceTabId:p.getTypeFunc(" js!SBIS3.EDO.CompetenceFieldLink:prototype.getCurCompetenceTabId ",{}),allowResponsibilityZone:p.getter(i,["allowResponsibilityZone"])},dialogOptions:{className:"ws-float-area__block-layout"},name:"ЧастноеЛицо",template:"js!SBIS3.EDO.CompetenceSelectorDialog",readOnly:!0,selectionType:"allBySelectAction",caption:global.rk("Исполнитель")}],list:{options:{items:[{content:p.createDataArray([(new function(){var e=Object.create(i),t=function e(t,o,i,n,r){if(void 0===i)var i=arguments[2];var a=0,l="content";if(void 0===p&&(eval("var thelpers = null;"),p=global.requirejs("View/Runner/tclosure")),r&&r.isSetts)var s=r.fullContext||{};t=p.isolateScope(Object.create(this),t,l);var c="string"==typeof i?i:"",d={id:[],def:void 0},m=this&&this.includedTemplates?this.includedTemplates:{},u=p.getMarkupGenerator(n);try{var g=u.joinElements([u.createControl("wsControl","ws:SBIS3.CONTROLS/DataGridView",{itemsActions:[],filter:{"ТипРаздела":"СписокИсполнителей","НабиратьЗоны":!0},columns:[{cellTemplate:"tmpl!SBIS3.EDO.CompetenceFieldLink/resources/SuggestItemTemplate"}],footerTpl:p.createDataArray([(new function(){var e=Object.create(t),o=function e(t,o,i,n,r){if(void 0===i)var i=arguments[2];var a=0,l="footerTpl";if(void 0===p&&(eval("var thelpers = null;"),p=global.requirejs("View/Runner/tclosure")),r&&r.isSetts)var s=r.fullContext||{};t=p.isolateScope(Object.create(this),t,l);var c="string"==typeof i?i:"",d={id:[],def:void 0},m=this&&this.includedTemplates?this.includedTemplates:{},u=p.getMarkupGenerator(n);try{var g=u.joinElements([u.createControl("wsControl","ws:SBIS3.CONTROLS/Link",{name:"showAllButton",caption:global.rk("Все сотрудники")},p.plainMerge(o,{name:"showAllButton",sbisname:"showAllButton"}),{data:t,ctx:this,pName:void 0!==l?l:void 0,viewController:f},i,S,m,p.config,s)],c,d);d.def&&(g=u.chain(g,d,o),d=void 0)}catch(e){p.templateError("resources/Elektronnyj_dokumentooborot/components/CompetenceFieldLink/CompetenceFieldLink.tmpl",e,t)}return g||""};this.func=p.makeFunctionSerializable(o,e)}).func]),handlers:{onInit:p.getTypeFunc(" js!SBIS3.EDO.CompetenceFieldLink:prototype.setSuggestDS ",{}),onChangeHoveredItem:p.getTypeFunc(" js!SBIS3.EDO.CompetenceFieldLink:prototype.changePickerHover ",{})},name:"view",pageSize:"12",allowEmptySelection:!1,highlightEnabled:!0,showHead:!1,idProperty:"Лицо",allowEnterToFolder:!1,itemsDragNDrop:!1,emptyHTML:global.rk("Нет данных"),esc:!1},p.plainMerge(o,{name:"view",sbisname:"view"}),{data:t,ctx:this,pName:void 0!==l?l:void 0,viewController:f},i,S,m,p.config,s)],c,d);d.def&&(g=u.chain(g,d,o),d=void 0)}catch(e){p.templateError("resources/Elektronnyj_dokumentooborot/components/CompetenceFieldLink/CompetenceFieldLink.tmpl",e,t)}return g||""};this.func=p.makeFunctionSerializable(t,e)}).func]),id:"StaffTab",title:global.rk("Сотрудники"),align:"left",searchParam:"СтрокаПоиска"},{content:p.createDataArray([(new function(){var e=Object.create(i),t=function e(t,o,i,n,r){if(void 0===i)var i=arguments[2];var a=0,l="content";if(void 0===p&&(eval("var thelpers = null;"),p=global.requirejs("View/Runner/tclosure")),r&&r.isSetts)var s=r.fullContext||{};t=p.isolateScope(Object.create(this),t,l);var c="string"==typeof i?i:"",d={id:[],def:void 0},m=this&&this.includedTemplates?this.includedTemplates:{},u=p.getMarkupGenerator(n);try{var g=u.joinElements([u.createControl("wsControl","ws:SBIS3.CONTROLS/DataGridView",{itemsActions:[],filter:{"ТипРаздела":"СписокЗон"},columns:[{cellTemplate:"tmpl!SBIS3.EDO.CompetenceFieldLink/resources/SuggestZoneItemTemplate"}],footerTpl:p.createDataArray([(new function(){var e=Object.create(t),o=function e(t,o,i,n,r){if(void 0===i)var i=arguments[2];var a=0,l="footerTpl";if(void 0===p&&(eval("var thelpers = null;"),p=global.requirejs("View/Runner/tclosure")),r&&r.isSetts)var s=r.fullContext||{};t=p.isolateScope(Object.create(this),t,l);var c="string"==typeof i?i:"",d={id:[],def:void 0},m=this&&this.includedTemplates?this.includedTemplates:{},u=p.getMarkupGenerator(n);try{var g=u.joinElements([u.createControl("wsControl","ws:SBIS3.CONTROLS/Link",{handlers:{onActivated:p.getTypeFunc(" js!SBIS3.EDO.CompetenceFieldLink:prototype.activatedResponsibilityZoneLink ",{})},name:"showAllButton",caption:global.rk("Все рабочие зоны"),esc:!1},p.plainMerge(o,{name:"showAllButton",sbisname:"showAllButton"}),{data:t,ctx:this,pName:void 0!==l?l:void 0,viewController:f},i,S,m,p.config,s)],c,d);d.def&&(g=u.chain(g,d,o),d=void 0)}catch(e){p.templateError("resources/Elektronnyj_dokumentooborot/components/CompetenceFieldLink/CompetenceFieldLink.tmpl",e,t)}return g||""};this.func=p.makeFunctionSerializable(o,e)}).func]),handlers:{onInit:p.getTypeFunc(" js!SBIS3.EDO.CompetenceFieldLink:prototype.setSuggestDS ",{}),onChangeHoveredItem:p.getTypeFunc(" js!SBIS3.EDO.CompetenceFieldLink:prototype.changePickerHover ",{})},name:"view",curTabName:"ZonePicker",pageSize:"6",allowEmptySelection:!1,highlightEnabled:!0,showHead:!1,idProperty:"Лицо",emptyHTML:global.rk("Нет данных"),esc:!1},p.plainMerge(o,{name:"view",sbisname:"view"}),{data:t,ctx:this,pName:void 0!==l?l:void 0,viewController:f},i,S,m,p.config,s)],c,d);d.def&&(g=u.chain(g,d,o),d=void 0)}catch(e){p.templateError("resources/Elektronnyj_dokumentooborot/components/CompetenceFieldLink/CompetenceFieldLink.tmpl",e,t)}return g||""};this.func=p.makeFunctionSerializable(t,e)}).func]),id:"ZoneTab",title:global.rk("Зоны ответственности"),align:"left",searchParam:"СтрокаПоиска",visible:p.getter(i,["allowResponsibilityZone"])}],handlers:{onResize:p.getTypeFunc(" js!SBIS3.EDO.CompetenceFieldLink:prototype.suggestResize ",{})},displayProperty:"title",idProperty:"id",selectedKey:"StaffTab",id:"StaffTab"},component:"SBIS3.CONTROLS/Suggest/SuggestView"},handlers:{onItemActivate:p.getTypeFunc(" js!SBIS3.EDO.CompetenceFieldLink:prototype.fieldLinkItemActivate ",{}),onSelectedItemsChange:p.getTypeFunc(" js!SBIS3.EDO.CompetenceFieldLink:prototype.selectedItemsChange ",{})},name:"StaffChoice__fieldLink",tabindex:"4",selectedItems:p.getter(i,["userList"]),useSelectorAction:!0,placeholder:p.getter(i,["placeholder"]),displayProperty:"Название",idProperty:"Лицо",autoShow:!0,chooserMode:"dialog",multiselect:p.getter(i,["multiselect"]),validateIfHidden:!0,showEmptyList:!0,useUserConfigHistory:!1,historyId:"historyCompetenceFieldLink",extendedTooltip:!1,linkedDisplayField:"Название",searchParam:"СтрокаПоиска",bindings:[{fieldName:"searchStringField",propName:"text",propPath:[],fullPropName:"text",propPathStr:"",oneWay:!0,direction:"fromProperty",bindNonExistent:!0},{fieldName:"searchStringField",propName:"dictionaries/0/componentOptions/searchString",propPath:["0","componentOptions","searchString"],fullPropName:"dictionaries/0/componentOptions/searchString",propPathStr:"0/componentOptions/searchString",oneWay:!0,direction:"fromContext",bindNonExistent:!1}],text:"",pickerClassName:p.getter(i,["pickerClassName"]),itemContentTpl:"tmpl!SBIS3.EDO.CompetenceFieldLink/resources/CompetenceItemTemplate",esc:!1},{class:"edo-TaskControls_ispComponent controls-FieldLink__itemsEdited",name:"StaffChoice__fieldLink",sbisname:"StaffChoice__fieldLink"},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f,internal:{__dirtyCheckingVars_0:p.getter(i,["allowResponsibilityZone"]),__dirtyCheckingVars_18:p.getter(i,["allowResponsibilityZone"])}},r,S,g,p.config,d),C.createControl("wsControl","ws:SBIS3.CONTROLS/Action/OpenDialogAction",{name:"workAreaDialog",dialogComponent:"js!SBIS3.WorkingArea.WorkAreaDialog",mode:"floatArea"},{name:"workAreaDialog",sbisname:"workAreaDialog"},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},r,S,g,p.config,d)],n,u,this)],m,u);u.def&&(h=C.chain(h,u,n),u=void 0)}catch(e){p.templateError("resources/Elektronnyj_dokumentooborot/components/CompetenceFieldLink/CompetenceFieldLink.tmpl",e,i)}return h||""};return i.includedFunctions={},i.stable=!0,i.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.CompetenceFieldLink"}},i});
define('js!SBIS3.EDO.FTaskControlsHandlers',['i18n!SBIS3.EDO.FTaskControlsHandlers','Elektronnyj_dokumentooborot_localization'],function(){'use strict';return{setFocus:function(){if(this.getTextValue()&&this.getParent().hasChildControlByName('fTaskRichEditor'))this.getParent().getChildControlByName('fTaskRichEditor').setActive(true);},sortm:function(t,e){return t.collectionItem.get('Название')<e.collectionItem.get('Название')?1:t.collectionItem.get('Название')>e.collectionItem.get('Название')?-1:0;},checkDescription:function(){var t=this.getText(),e=t&&''!==t.replace(/\s/g,''),n=[],r=0,i=this.getLinkedContext().getValue('record')?this.getLinkedContext().getValue('record'):false;if(e)return true;if(i)if(n=i.has('РП.Документ')&&i.get('РП.Документ').has('СписокВложений')?i.get('РП.Документ').get('СписокВложений'):false,r=n?n.getCount():0,r>0)return true;return rk('Введите описание или прикрепите внешние документы');}};});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.CompetenceFieldLink", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-CompetenceFieldLink .linkSeparator{color:#999}.ws-disabled .edo-CompetenceFieldLink .linkSeparator{color:#e4e4e4}.edo-CompetenceFieldLink .photoBlock{position:absolute!important}.edo-CompetenceFieldLink .edo-TaskControls_ispComponent{display:block;width:auto}.edo-CompetenceFieldLink .Persons-Collage{position:absolute!important}.edo-CompetenceFieldLink .StaffChoice__staffCollage{display:block!important}.edo-CompetenceFieldLink .controls-TextBox{color:#313e78;font-size:14px}.edo-CompetenceFieldLink .controls-FieldLink__item:hover .competence_face,.edo-CompetenceFieldLink .controls-FieldLink__item:hover .competence_zone_text{text-decoration:underline}.edo-CompetenceFieldLink .controls-FieldLink__itemsEdited .controls-FieldLink__item-caption:hover{text-decoration:none}.edo-CompetenceFieldLink .competence_face{display:inline;color:#1f2c63;font-size:15px}.edo-CompetenceFieldLink .competence_zone{display:inline;color:#999;font-size:14px}.edo-CompetenceFieldLink .competence_content{display:inline;overflow:hidden;text-overflow:ellipsis}.controls-FieldLink__item-caption .competence_face,.controls-FieldLink__item-caption .competence_zone{display:inline}.controls-FieldLink__item-caption .competence_content{display:inline;overflow:hidden;text-overflow:ellipsis}.edo-CompetenceFieldLink .competence_content .competence_zone{font-weight:400}.edo-CompetenceFieldLink__suggestWithZone{min-width:270px}.edo-CompetenceFieldLink__suggest,.edo-CompetenceFieldLink__suggestWithZone{overflow-y:auto!important}.edo-CompetenceFieldLink__suggest .controls-suggestView .controls-ListView{padding-top:0!important}.edo-CompetenceFieldLink .controls-FieldLink__fieldWrapper{color:#000}.edo-Competence_staffsubmenu-row{height:24px;display:block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.edo-Competence_staffsubmenu-row .edo-Competence_Suggest-zone-name{font-size:15px;line-height:24px;display:inline-block}"));head.appendChild(style);});}
define("tmpl!SBIS3.EDO.CompetenceFieldLink/resources/CompetenceItemTemplate",["Core/tmpl/js/tclosure"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={},i=function e(i,n,a,p,c){function l(){}var o=0,m=void 0!==t&&t?t:arguments[arguments.length-1];void 0===m&&(eval("var thelpers = null;"),m=global.requirejs("View/Runner/tclosure"));var s={};c&&c.isSetts&&(s=c.fullContext||{});var g="string"==typeof a?a:"",d=void 0===r?void 0:r,u={id:[],def:void 0},v=m.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,i),y=this&&this.includedTemplates?this.includedTemplates:{},f=m.getMarkupGenerator(p);try{var T=f.joinElements([f.createTag("div",{class:"competence_content"},[f.createTag("div",{class:"competence_face",title:""+m.wrapUndef(m.utils.escape((m.getter(i,["item","get"]).apply(m.getter(i,["item"]),["РП.Сотрудник"])?m.getter(i,["item","get"]).apply(m.getter(i,["item"]),["РП.Сотрудник"])+"/":"")+m.getter(i,["item","get"]).apply(m.getter(i,["item"]),["Название"])||m.getter(i,["item","get"]).apply(m.getter(i,["item"]),["ЗонаОтветственностиНазвание"])))},[f.createText(" "+m.wrapUndef(m.utils.escape(m.getter(i,["item","get"]).apply(m.getter(i,["item"]),["РП.Сотрудник"])||m.getter(i,["item","get"]).apply(m.getter(i,["item"]),["Название"])||m.getter(i,["item","get"]).apply(m.getter(i,["item"]),["ЗонаОтветственностиНазвание"]))))],{},u,this),!m.getter(i,["item","get"]).apply(m.getter(i,["item"]),["РП.Сотрудник"])&&m.getter(i,["item","get"]).apply(m.getter(i,["item"]),["Состояние"])||!m.getter(i,["item","get"]).apply(m.getter(i,["item"]),["ЗонаОтветственностиНазвание"])?f.createText(""):[f.createTag("div",{class:"competence_zone"},[f.createText(""+global.rk("&nbsp;/&nbsp;")),f.createTag("div",{class:"competence_zone competence_zone_text"},[f.createText(""+m.wrapUndef(m.utils.escape(m.getter(i,["item","get"]).apply(m.getter(i,["item"]),["ЗонаОтветственностиНазвание"]))))],{},u,this)],{},u,this)]],n,u,this)],g,u);u.def&&(T=f.chain(T,u,n),u=void 0)}catch(e){m.templateError("resources/Elektronnyj_dokumentooborot/components/CompetenceFieldLink/resources/CompetenceItemTemplate.tmpl",e,i)}return T||""};return i.includedFunctions={},i.stable=!0,i.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.CompetenceFieldLink/resources/CompetenceItemTemplate"}},i});
define("tmpl!SBIS3.EDO.CompetenceFieldLink/resources/SuggestItemTemplate",["Core/tmpl/js/tclosure","js!SBIS3.CONTROLS/Link"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.CONTROLS/Link"]=e[1];var a=function e(a,i,s,o,p){function c(){}var n=0,g=void 0!==t&&t?t:arguments[arguments.length-1];void 0===g&&(eval("var thelpers = null;"),g=global.requirejs("View/Runner/tclosure"));var l={};p&&p.isSetts&&(l=p.fullContext||{});var m="string"==typeof s?s:"",d=void 0===r?void 0:r,u={id:[],def:void 0},y=g.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,a),f=this&&this.includedTemplates?this.includedTemplates:{},_=g.getMarkupGenerator(o);try{var S=_.joinElements([_.createTag("div",{class:"edo-Competence_Suggest-row"},[g.getter(a,["item","get"]).apply(g.getter(a,["item"]),["Раздел@"])?_.createText(""):[_.createTag("div",{class:"edo-Competence_Suggest__photo"},[_.createText(" "+g.wrapUndef(g.Sanitize.apply(void 0,[g.getDecorators().sanitize.apply(void 0,[g.getter(a,["item","photoFace"])])]))+" ")],{},u,this)],_.createTag("div",{class:"edo-Competence_Suggest__description"},[_.createTag("div",{class:"edo-Competence_Suggest__firstRow phcl_nowrap"},[_.createTag("div",{class:"edo-Competence_Suggest-person-name",title:""+g.wrapUndef(g.utils.escape(g.getter(a,["item","get"]).apply(g.getter(a,["item"]),["Название"])))},[_.createText(" "+g.wrapUndef(g.utils.escape(g.getter(a,["item","get"]).apply(g.getter(a,["item"]),["Название"])))+" ")],{},u,this),_.createTag("div",{class:"edo-Competence_Suggest__secondaryInfoWrapper"},[g.getter(a,["item","get"]).apply(g.getter(a,["item"]),["Раздел@"])&&g.getter(a,["item","get"]).apply(g.getter(a,["item"]),["КолЧел"])?[_.createTag("span",{class:"edo-Competence_Suggest__EmployeesNumber"},[_.createText("("+g.wrapUndef(g.utils.escape(g.getter(a,["item","get"]).apply(g.getter(a,["item"]),["КолЧел"])))+")")],{},u,this)]:_.createText(""),g.getter(a,["item","get"]).apply(g.getter(a,["item"]),["markIcon"])?[_.createTag("div",{class:"listEmpl-mark icon-16 icon-disabled "+g.wrapUndef(g.utils.escape(g.getter(a,["item","get"]).apply(g.getter(a,["item"]),["markIcon"]))),style:"width: 16px; display: inline-block;",title:""+g.wrapUndef(g.utils.escape(g.getter(a,["item","get"]).apply(g.getter(a,["item"]),["РасшифровкаМетки"])))},[],{},u,this)]:_.createText(""),g.getter(a,["item","get"]).apply(g.getter(a,["item"]),["Должность"])?[_.createTag("span",{class:"edo-Competence_Suggest__secondaryInfo edo-Competence_Suggest_place",title:""+g.wrapUndef(g.utils.escape(g.getter(a,["item","get"]).apply(g.getter(a,["item"]),["Должность"])))},[_.createText(" "+g.wrapUndef(g.utils.escape(g.getter(a,["item","get"]).apply(g.getter(a,["item"]),["Должность"])))+" ")],{},u,this)]:_.createText("")],{},u,this),_.createText(" "+g.wrapUndef(g.utils.escape(g.getter(a,["item","get"]).apply(g.getter(a,["item"]),["msgNotAllowed"])))+" ")],{},u,this),_.createTag("div",{class:"edo-Competence_Suggest__secondaryInfo"},[g.getter(a,["item","get"]).apply(g.getter(a,["item"]),["ПодразделениеПолныйПуть"])?[_.createTag("div",{class:"edo-Competence_Suggest__PersonEmployment person-department phcl_nowrap"},[_.createText(" "+g.wrapUndef(g.utils.escape(g.getter(a,["item","get"]).apply(g.getter(a,["item"]),["ПодразделениеПолныйПуть"])))+" ")],{},u,this)]:_.createText(""),_.createTag("div",{class:"no_confirmed_icon"},[_.createText(" "+g.wrapUndef(g.utils.escape(g.getter(a,["item","get"]).apply(g.getter(a,["item"]),["confirmedOrgInfo"])))+" ")],{},u,this)],{},u,this)],{},u,this),g.getter(a,["item","get"]).apply(g.getter(a,["item"]),["РабочиеГруппы"])?[_.createControl("wsControl","ws:SBIS3.CONTROLS/Link",{handlers:{onActivated:g.getTypeFunc(" js!SBIS3.EDO.CompetenceFieldLink:prototype.suggestArrowClick ",{})},lineData:g.getter(a,["item"]),esc:!1},{class:"edo-Competence_SuggestStaff__subMenuIcon icon-16 icon-MarkCRightLight icon-primary"},{data:a,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},s,d,f,g.config,l)]:_.createText("")],i,u,this)],m,u);u.def&&(S=_.chain(S,u,i),u=void 0)}catch(e){g.templateError("resources/Elektronnyj_dokumentooborot/components/CompetenceFieldLink/resources/SuggestItemTemplate.tmpl",e,a)}return S||""};return a.includedFunctions={},a.stable=!0,a.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.CompetenceFieldLink/resources/SuggestItemTemplate"}},a});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.CompetenceFieldLink/resources/SuggestItemTemplate", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-Competence_Suggest-row{height:42px;white-space:nowrap}.edo-CompetenceZone_Suggest-row{height:59px;white-space:nowrap}.edo-Competence_Suggest-row .activityIcon{vertical-align:top;margin:0 -4px;width:16px;height:16px;display:inline-block;float:none!important}.edo-Competence_Suggest-row .activityIconInCorner{position:absolute;bottom:3px;margin-left:-5px}.edo-Competence_Suggest__photo{display:inline-block}.edo-Competence_Suggest__photo .employee_photo{margin:1px 0 1px 1px}.edo-CompetenceZone_Suggest__description,.edo-Competence_Suggest__description{display:inline-block;overflow:hidden;vertical-align:top}.edo-Competence_Suggest__description{max-width:calc(100% - 52px)}.edo-CompetenceZone_Suggest__description{width:calc(100% - 40px)}.edo-Competence_Suggest__firstRow{margin-top:5px;height:16px;line-height:16px}div.edo-Competence_Suggest__firstRow .edo-Competence_Suggest-person-name{font-size:15px;line-height:16px;display:inline-block;float:left;margin-right:4px;overflow:hidden;max-width:100%}div.edo-Competence_Suggest__firstRow .edo-Competence_Suggest__secondaryInfo{font-size:12px;line-height:18px;vertical-align:top;overflow:hidden;display:inline}.edo-Competence_Suggest__firstRow span img{vertical-align:bottom}.edo-Competence_Suggest__secondaryInfoWrapper{white-space:nowrap;overflow:hidden;color:#999}.edo-Competence_Suggest__secondaryInfo{font-size:12px;line-height:17px;height:17px;color:#999;vertical-align:bottom}.edo-Competence_Suggest__secondaryInfo div{text-decoration:none!important}.edo-Competence_Suggest__secondaryInfo .icon-16{vertical-align:top}.edo-Competence_Suggest__secondaryInfo .phcl_nowrap{text-align:left;max-width:calc(100% - 26px);float:left}.edo-Competence_Suggest__secondaryInfo .no_confirmed_icon{float:left;margin-left:4px}.edo-Competence_Suggest_place{line-height:16px;vertical-align:text-bottom}.edo-CompetenceZone_Suggest-row .phcl_nowrap,.edo-Competence_Suggest-row .phcl_nowrap{overflow:hidden;white-space:nowrap}.edo-Competence_Suggest__EmployeesNumber{color:#ccc;font-size:14px;font-weight:400}.edo-Competence_Suggest__PersonEmployment{font-size:12px;cursor:pointer}.edo-Competence_Suggest__PersonEmployment.person-company{color:#8991a9!important}.edo-Competence_Suggest__PersonEmployment.person-department{color:#999!important}.edo-Competence_Suggest__PersonEmployment:hover{text-decoration:underline}.edo-Competence_Suggest-isDepartament{margin:0 18px 0 12px;content:'\\e96e'}div.edo-CompetenceZone_Suggest__firstRow{font-size:14px;line-height:18px;vertical-align:top;overflow:hidden;text-overflow:ellipsis}div.edo-Competence_Suggest__description{width:100%}.edo-Competence_Suggest__subMenuIcon{position:absolute;top:4px;right:0}.edo-Competence_SuggestStaff__subMenuIcon{position:absolute;top:8px;right:0;width:16px;height:16px}.edo-Competence_Suggest__hasScroll .edo-Competence_SuggestStaff__subMenuIcon{right:8px}.edo-Competence_Suggest__subMenuPicker .controls-Menu__itemsContainer{max-width:250px}.edo-Competence_Suggest__subMenuPicker .edo-Competence_Suggest-person-name{display:inline}.edo-Competence_Suggest__subMenuPicker .edo-Competence_Suggest_place{display:block}.edo-Competence_Suggest-row.edo-Competence_submenu-row{height:38px!important}.edo-Competence_Suggest__subMenuPicker .controls-MenuItem{padding:0 8px}.edo-Competence_Suggest__subMenuPicker .controls-MenuItem__text{margin:2px 0!important}.edo-Competence_Suggest__subMenuPicker .employee_photo{padding:3px 6px 0 0}.edo-Competence_Suggest__subMenuPicker .edo-Competence_Suggest__description{max-width:calc(100% - 36px)!important}.controls-MenuItem .edo-CompetenceZone_Suggest__description:after,.controls-MenuItem .edo-Competence_Suggest__description:after,.controls-Suggest__picker .edo-CompetenceZone_Suggest__description:after,.controls-Suggest__picker .edo-Competence_Suggest__description:after{top:0;padding:3px 6px;content:\"\\00a0\";box-sizing:content-box;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;position:absolute;width:20px;line-height:38px;right:0;text-align:right;background-size:100% 100%;background:-moz-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,1) 45%);background:-webkit-gradient(linear,left top,right top,color-stop(0,rgba(255,255,255,0)),color-stop(45%,rgba(255,255,255,1)));background:-webkit-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,1) 45%);background:-o-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,1) 45%);background:-ms-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,1) 45%);background:linear-gradient(to right,rgba(255,255,255,0) 0,rgba(255,255,255,1) 45%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#00ffffff', endColorstr='#ffffff', GradientType=1)}.controls-ListView__hoveredItem .edo-CompetenceZone_Suggest__description:after,.controls-ListView__hoveredItem .edo-Competence_Suggest__description:after,.controls-MenuItem:hover .edo-CompetenceZone_Suggest__description:after,.controls-MenuItem:hover .edo-Competence_Suggest__description:after{background:-moz-linear-gradient(left,rgba(255,255,255,0) 0,rgba(240,245,251,1) 45%);background:-webkit-gradient(linear,left top,right top,color-stop(0,rgba(255,255,255,0)),color-stop(45%,rgba(240,245,251,1)));background:-webkit-linear-gradient(left,rgba(255,255,255,0) 0,rgba(240,245,251,1) 45%);background:-o-linear-gradient(left,rgba(255,255,255,0) 0,rgba(240,245,251,1) 45%);background:-ms-linear-gradient(left,rgba(255,255,255,0) 0,rgba(240,245,251,1) 45%);background:linear-gradient(to right,rgba(255,255,255,0) 0,rgba(240,245,251,1) 45%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#00ffffff', endColorstr='#F0F5FB', GradientType=1)}.controls-MenuItem .edo-CompetenceZone_Suggest__description:after,.controls-MenuItem .edo-Competence_Suggest__description:after{padding-right:0;right:-8px}"));head.appendChild(style);});}
define("tmpl!SBIS3.EDO.CompetenceFieldLink/resources/SuggestZoneItemTemplate",["Core/tmpl/js/tclosure","js!SBIS3.CONTROLS/Link"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.CONTROLS/Link"]=e[1];var i=function e(i,a,o,n,p){function s(){}var g=0,c=void 0!==t&&t?t:arguments[arguments.length-1];void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure"));var l={};p&&p.isSetts&&(l=p.fullContext||{});var m="string"==typeof o?o:"",d=void 0===r?void 0:r,u={id:[],def:void 0},y=c.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,i),f=this&&this.includedTemplates?this.includedTemplates:{},S=c.getMarkupGenerator(n);try{var _=S.joinElements([S.createTag("div",{class:"edo-CompetenceZone_Suggest-row"},[S.createTag("div",{class:"edo-CompetenceZone_Suggest__firstRow"},[S.createText(" "+c.wrapUndef(c.utils.escape(c.getter(i,["item","get"]).apply(c.getter(i,["item"]),["Название"])))+" ")],{},u,this),c.getter(i,["item","get"]).apply(c.getter(i,["item"]),["РП.Сотрудник"])?[S.createTag("div",{class:"edo-Competence_Suggest__photo"},[S.createText(" "+c.wrapUndef(c.Sanitize.apply(void 0,[c.getDecorators().sanitize.apply(void 0,[c.getter(i,["item","photoFaceZone"])])]))+" ")],{},u,this)]:S.createText(""),S.createTag("div",{class:"edo-CompetenceZone_Suggest__description"},[c.getter(i,["item","get"]).apply(c.getter(i,["item"]),["РП.Сотрудник"])?[S.createTag("div",{class:"edo-Competence_Suggest__firstRow phcl_nowrap"},[S.createTag("div",{class:"edo-Competence_Suggest-person-name",title:""+c.wrapUndef(c.utils.escape(c.getter(i,["item","get"]).apply(c.getter(i,["item"]),["Название"])))},[S.createText(" "+c.wrapUndef(c.utils.escape(c.getter(i,["item","get"]).apply(c.getter(i,["item"]),["РП.Сотрудник"])))+" ")],{},u,this),S.createTag("div",{id:""+c.wrapUndef(c.utils.escape(c.getter(i,["item","get"]).apply(c.getter(i,["item"]),["employeeMark"]))),style:""+c.wrapUndef(c.utils.escape(c.getter(i,["item","get"]).apply(c.getter(i,["item"]),["hasEmployeeMark"])?"width: 16px; display: inline-block;":"display: inline;"))},[],{},u,this),c.getter(i,["item","get"]).apply(c.getter(i,["item"]),["Должность"])?[S.createTag("div",{class:"edo-Competence_Suggest__secondaryInfo edo-Competence_Suggest_place",title:""+c.wrapUndef(c.utils.escape(c.getter(i,["item","get"]).apply(c.getter(i,["item"]),["Должность"])))},[S.createText(" "+c.wrapUndef(c.utils.escape(c.getter(i,["item","get"]).apply(c.getter(i,["item"]),["Должность"])))+" ")],{},u,this)]:S.createText(""),S.createText(" "+c.wrapUndef(c.utils.escape(c.getter(i,["item","get"]).apply(c.getter(i,["item"]),["msgNotAllowed"])))+" ")],{},u,this),S.createTag("div",{class:"edo-Competence_Suggest__secondaryInfo"},[c.getter(i,["item","get"]).apply(c.getter(i,["item"]),["РП.ПодразделениеСотрудника"])?[S.createTag("div",{class:"edo-Competence_Suggest__PersonEmployment person-department phcl_nowrap"},[S.createText(" "+c.wrapUndef(c.utils.escape(c.getter(i,["item","get"]).apply(c.getter(i,["item"]),["РП.ПодразделениеСотрудника"])))+" ")],{},u,this)]:S.createText(""),S.createTag("div",{class:"no_confirmed_icon"},[S.createText(" "+c.wrapUndef(c.utils.escape(c.getter(i,["item","get"]).apply(c.getter(i,["item"]),["confirmedOrgInfo"])))+" ")],{},u,this)],{},u,this)]:S.createText("")],{},u,this),c.getter(i,["item","get"]).apply(c.getter(i,["item"]),["Ответственные"])&&c.getter(c.getter(i,["item","get"]).apply(c.getter(i,["item"]),["Ответственные"]),["getCount"])&&c.getter(c.getter(i,["item","get"]).apply(c.getter(i,["item"]),["Ответственные"]),["getCount"]).apply(c.getter(i,["item","get"]).apply(c.getter(i,["item"]),["Ответственные"]),[])>0?[S.createControl("wsControl","ws:SBIS3.CONTROLS/Link",{handlers:{onActivated:c.getTypeFunc(" js!SBIS3.EDO.CompetenceFieldLink:prototype.suggestArrowClick ",{})},lineData:c.getter(i,["item"]),esc:!1},{class:"edo-Competence_SuggestStaff__subMenuIcon icon-16 icon-MarkCRightLight icon-primary"},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},o,d,f,c.config,l)]:S.createText("")],a,u,this)],m,u);u.def&&(_=S.chain(_,u,a),u=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/CompetenceFieldLink/resources/SuggestZoneItemTemplate.tmpl",e,i)}return _||""};return i.includedFunctions={},i.stable=!0,i.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.CompetenceFieldLink/resources/SuggestZoneItemTemplate"}},i});
define('js!SBIS3.EDO.CompetenceFieldLink',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.CompetenceFieldLink','Core/ExtensionsManager','Core/RightsManager','Core/constants','Core/compatibility','WS.Data/Source/SbisService','WS.Data/Collection/List','WS.Data/Collection/RecordSet','WS.Data/Adapter/Sbis','js!SBIS3.CompetenceFieldLink.Models.SuggestModel','WS.Data/Di','SBIS3.CONTROLS/Menu/ContextMenu','Core/helpers/Object/isEqual','Core/core-functions','SBIS3.CONTROLS/Link','SBIS3.CONTROLS/FieldLink','js!SBIS3.Person.PersonsCollage','SBIS3.CONTROLS/DataGridView','SBIS3.CONTROLS/Tree/DataGridView','SBIS3.CONTROLS/Action/OpenDialogAction','js!SBIS3.EDO.FTaskControlsHandlers','SBIS3.CONTROLS/Suggest/SuggestView','css!SBIS3.EDO.CompetenceFieldLink','tmpl!SBIS3.EDO.CompetenceFieldLink/resources/CompetenceItemTemplate','tmpl!SBIS3.EDO.CompetenceFieldLink/resources/SuggestItemTemplate','css!SBIS3.EDO.CompetenceFieldLink/resources/SuggestItemTemplate','tmpl!SBIS3.EDO.CompetenceFieldLink/resources/SuggestZoneItemTemplate','Elektronnyj_dokumentooborot_localization'],function(e,t,n,i,o,s,r,a,l,g,c,u,d,p,f){'use strict';u.register('SuggestModel',c);var h='EmplTab',m=e.extend({_dotTplFn:t,$protected:{_options:{docState:null,docType:null,keepUser:true,photoData:[{photoId:null}]},__internalSetSelected:false,_competenceCollage:void 0,_prevUserList:null,_fieldLink:void 0},getDocType:function(){return this._options.docType;},_modifyOptions:function(e){if(e=m.superclass._modifyOptions.call(this,e),e.isVisibleZoneLabel=!!e.zone,e.multiselect=!e.zone,e.docState&&e.docState.get()<2)e.isVisibleZoneLabel=true;if(e['allowResponsibilityZone']=e['allowResponsibilityZone']&&i.checkAccessRights(['Зоны ответственности'])&&'ProjectManagement'in o.modules&&!!n.checkExtensions(['УПРАВЛЕНИЕ_ПРОЕКТАМИ'])['УПРАВЛЕНИЕ_ПРОЕКТАМИ'],!!e.zone)e.placeholder='';else if(e.allowResponsibilityZone)e.placeholder=rk('Укажите ФИО сотрудника или зону ответственности');else e.placeholder=rk('Укажите ФИО сотрудника или выберите из справочника');if(e.userList)e.photoData=this.preparePhotoData(e.userList,e.allowResponsibilityZone);if(e.allowResponsibilityZone)e.pickerClassName='edo-CompetenceFieldLink__suggestWithZone';else e.pickerClassName='edo-CompetenceFieldLink__suggest';return e;},getUserList:function(){return this._options.userList;},setUserList:function(e){this._fieldLink.setSelectedItems(e),this._options.userList=e;},applyUserList:function(e){this._options.userList=e,this._notifyOnPropertyChanged('userList'),this.setPhotoData(e);},getPhotoData:function(){return this._options.photoData;},preparePhotoData:function(e,t){var e=e,n=[],i='Лицо',o=t?'Фото':'ФотоБольшое',s='Раздел@';if(e&&e.getCount()>0)for(var r=0;r<e.getCount();r++){var a=e.at(r);if(a.get(i)){var l=null;if(a.get(o))l=a.get(o);else if(a.get('Фото'))l=a.get('Фото');n.push({personId:a.get(i),photoId:l,depId:a.get(s)?a.get(i):null});}}if(n.length<=0)n=[{photoId:null}];return n;},setPhotoData:function(e){var t=this.preparePhotoData(this._options.userList,this._options.allowResponsibilityZone);this._options.photoData=t,this._competenceCollage.setData(t);},getZone:function(){return this._options.zone;},setZone:function(e){this._options.zone=e,this._notifyOnPropertyChanged('zone');},init:function(){m.superclass.init.call(this);var e=this,t=this.getChildControlByName('StaffChoice__fieldLink'),n=[{validator:function(){var t=this.getSelectedItems(),n=true;if(t?t.getCount():0){if(t.at(0).has('РП.идСотрудника')&&!t.at(0).get('РП.идСотрудника')&&t.at(0).has('Состояние')&&t.at(0).get('Состояние'))n=rk('В выбранной зоне ответственный не указан. Выберите другую зону или укажите ответственного.');}else n=e._options.allowResponsibilityZone?rk('Укажите ФИО сотрудника или зону ответственности'):rk('Укажите ФИО сотрудника или выберите из справочника');return n;}}];if(this._fieldLink=t,this._competenceCollage=this.getChildControlByName('competenceCollage'),this.getUserList())this._prevUserList=this.getUserList().clone(),this.setUserList(this.getUserList());t.setValidators(n);},changePickerHover:function(e,t){this.getParentByClass('SBIS3.EDO.CompetenceFieldLink').showSubMenu(this,t);},suggestArrowClick:function(){if(!s.touch)return;var e={key:this._options.lineData.get('Лицо'),container:$(this.getContainer()).parents('tr')};this.getParentByClass('SBIS3.EDO.CompetenceFieldLink').showSubMenu(this.getParent(),e,true);},showSubMenu:function(e,t,n){var i,o,s,r,l;if('ZonePicker'==e._options.curTabName)i='@Ответственный',o='Ответственные',l=-3,s=c,r=function(e,t){var n=this.getTopParent().getChildControlByName('StaffChoice__fieldLink'),i=this._options.parentItem.clone(),o=this.getItems().getRecordById(t),s=o.get('ЧастноеЛицо.@Лицо'),r=p(o);i.set('РП.идСотрудника',s),i.set('РП.Сотрудник',r),i.set('Фото',o.get('ЧастноеЛицо.Фото'));var l=n.getSelectedItems()?n.getSelectedItems().clone():new a();l.add(i),n.setSelectedItems(l);};else i='zoneId',o='РабочиеГруппы',l=-1,s=g,r=function(e,t){var n=this.getTopParent().getChildControlByName('StaffChoice__fieldLink'),i=this._options.parentItem.clone(),o=this.getItems().getRecordById(t),s=o.get('zoneId'),r=o.get('Название');if(-1===i.getFormat().getFieldIndex('РП.идСотрудника'))i.addField({name:'РП.идСотрудника',type:'integer'});if(-1===i.getFormat().getFieldIndex('РП.Сотрудник'))i.addField({name:'РП.Сотрудник',type:'string'});if(-1===i.getFormat().getFieldIndex('Состояние'))i.addField({name:'Состояние',type:'string'});i.set('РП.идСотрудника',i.get('Лицо')),i.set('РП.Сотрудник',i.get('Название')),i.set('Лицо',s),i.set('Название',r),i.set('Состояние',s);var l=n.getSelectedItems()?n.getSelectedItems().clone():new a();l.add(i),n.setSelectedItems(l);};function g(e){var t='<div class="edo-Competence_staffsubmenu-row">',n=e.get('Название')?e.get('Название'):'Зона без названия';return t+='<div class="edo-Competence_Suggest-zone-name" title="'+n+'">'+n+'</div>',t+='</div>',t;}function c(e){var t='<div class="edo-Competence_Suggest-row edo-Competence_submenu-row">';t+='<component data-component="SBIS3.Person.PersonPhoto" class="employee_photo"><opts name="data"><opt name="personId">'+e.get('ЧастноеЛицо.@Лицо')+'</opt><opt name="photoId">'+e.get('ЧастноеЛицо.Фото')+'</opt></opts><opts name="settings"><opt name="size">32</opt><opt name="showMiniCard">false</opt><opts></component>',t+='<div class="edo-Competence_Suggest__description">';var n=p(e),i=e.get('Должность');if(t+='<div class="edo-Competence_Suggest-person-name" title="'+n+'">'+n+'</div>',i)t+='<div class="edo-Competence_Suggest__secondaryInfo edo-Competence_Suggest_place" title="'+i+'">'+i+'</div>';return t+='</div></div>',t;}function u(e){var t=e.get('ЧастноеЛицо.Фамилия'),n=e.get('ЧастноеЛицо.Имя'),i=e.get('ЧастноеЛицо.Отчество');if(n||i)t+=' ';if(n)t+=n[0]+'.';if(i)t+=i[0]+'.';return t;}function p(e){var t=e.get('ЧастноеЛицо.Фамилия'),n=e.get('ЧастноеЛицо.Имя');if(n)t+=' '+n;return t;}if(t.key){if(!e._contextMenu)e._contextMenu=new d({element:$('<div class="edo-Competence_Suggest__subMenuPicker"></div>').appendTo('body'),displayProperty:'itemTpl',horizontalAlign:{side:'left'},verticalAlign:{side:'top',offset:-3},corner:'tr',targetPart:true,parent:e,closeByExternalOver:true,handlers:{onMenuItemActivate:r}});if(n&&true==e._contextMenu.isVisible())e._contextMenu.hide();else{var f=e.getItems().getRecordById(t.key),h=f.get(o)?f.get(o).clone():null;if(h&&h.getCount&&0!=h.getCount()){if(-1===h.getFormat().getFieldIndex('itemTpl'))h.addField({name:'itemTpl',type:'string'});for(var m=0;m<h.getCount();m++)h.at(m).set('itemTpl',s(h.at(m)));var _=0,C=$(e.getParentByClass('SBIS3.CONTROLS/ScrollContainer').getContainer()).find('.controls-ScrollContainer__scrollbar.ws-invisible');if(C&&0==C.length)_=-8;e._contextMenu._options.idProperty=i,e._contextMenu._options.verticalAlign.offset=l,e._contextMenu._options.horizontalAlign.offset=_,e._contextMenu.setItems(h),e._contextMenu._options.parentItem=f,e._contextMenu.setTarget(t.container),e._contextMenu.show();}}}},suggestResize:function(){var e=$(this.getContainer()).find('.controls-ScrollContainer__scrollbar.ws-invisible');if(e&&0==e.length)$(this.getContainer()).addClass('edo-Competence_Suggest__hasScroll');else $(this.getContainer()).removeClass('edo-Competence_Suggest__hasScroll');},setSuggestDS:function(){var e=new r({endpoint:'Документ',binding:{query:'СписокЗонИЛиц'},idProperty:'Лицо',model:'SuggestModel'});this.setDataSource(e,true);},activatedResponsibilityZoneLink:function(){h='WorkAreaTab';},getCurCompetenceTabId:function(){var e=h;return h='EmplTab',e;},fieldLinkItemActivate:function(e,t){var n=this.getTopParent(),i=t.item,o=i.has('Лицо_')&&'"ФункциональнаяОбласть"'==i.get('Лицо_'),s=i.has('ЗонаОтветственности')&&i.get('ЗонаОтветственности');if(t.id&&(s||o)){var a=s?s:t.id;new r({endpoint:'ФункциональнаяОбласть'}).call('Прочитать',{'ИдО':a,'ИмяМетода':'Список'}).addCallback(function(){n.getChildControlByName('workAreaDialog').execute({id:a,item:i});}).addErrback(function(){n.getChildControlByName('workAreaDialog').execute({id:a,item:i});}),e.cancelBubble();}},_setCompetencePlaceholder:function(e){var t=(e=e?e:this.getChildControlByName('StaffChoice__fieldLink')).getSelectedItems(),n=rk('Укажите ФИО сотрудника')+(this._options.allowResponsibilityZone?' '+rk('или зону ответственности'):' '+rk('или выберите из справочника'));if(t&&t.getCount()){var i=e.getSelectedItems().at(t.getCount()-1);if(i.has('ЗонаОтветственности')&&i.get('ЗонаОтветственности'))n='';}e.setPlaceholder(n);},_getIfExist:function(e,t){if(e&&e.has(t)&&e.get(t))return e.get(t);else return null;},_executorListIsChange:function(e,t,n){if(n)if(!e||!t||!(e.getFormat&&t.getFormat&&p(e.getFormat(),t.getFormat())))return true;var i=function(e){var t=[];if(e)e.each(function(e){t.push(parseInt(e.getId(),10));});return t;},o=i(e),s=i(t);if(o.length===s.length){for(var r=0;r<o.length;r++)if(o.indexOf(s[r])<0)return true;}else return true;return false;},makeCommonFormat:function(e){return new l({rawData:{_type:'recordset',d:e,s:[{n:'@Лицо',t:'Идентификатор'},{n:'Название',t:'Строка'},{n:'ЗонаОтветственности',t:'Число целое'},{n:'ЗонаОтветственностиНазвание',t:'Строка'},{n:'Лицо',t:'Число целое'},{n:'Лицо_',t:'Строка'},{n:'Раздел@',t:'Логическое'},{n:'РП.идСотрудника',t:'Число целое'},{n:'РП.Сотрудник',t:'Строка'},{n:'ФотоБольшое',t:'Число целое'},{n:'Фото',t:'Число целое'},{n:'Фото_mini',t:'Число целое'},{n:'Состояние',t:'Строка'}]},adapter:new g()});},makeDataItemArray:function(e,t,n,i){var o=null,s='',r=null,a='',l=null,g=false,c=null,u=null,d=null,p=null;if(t){if(n)o=parseInt(e.get('Лицо'),10),s=e.get('Название'),a=e.get('ЗонаОтветственностиНазвание');else o=parseInt(e.get('РП.идСотрудника'),10),s=e.get('РП.Сотрудник'),a=e.get('Название');r=parseInt(e.get(i),10),l='Функциональная область';}else if(o=parseInt(e.get('Лицо'),10),s=e.get('Название'),g=this._getIfExist(e,'Раздел@'),g)l='Структура предприятия';if(c=this._getIfExist(e,'ФотоБольшое'),u=this._getIfExist(e,'ФотоБольшое'),d=this._getIfExist(e,'Фото_mini'),p=this._getIfExist(e,'Состояние'),!u)u=this._getIfExist(e,'Фото');if(!d)d=this._getIfExist(e,'Фото');return[o,s,r,a,o,l,g,o,s,c,u,d,p];},selectedItemsChange:function(){var e=this,t=e.getParent(),n=e.getSelectedItems(),i=new a(),o=[],s=[],r=null;if(t.__internalSetSelected)return;if(n&&n.getCount()){var l=n.at(n.getCount()-1),g=n.getCount()>0?n.at(0):null,c=!!(l.has('Состояние')&&l.get('Состояние')),u=t.getZone()||g&&g.has('ЗонаОтветственности')&&g.get('ЗонаОтветственности')||null,d=c?l.get('Лицо'):u;if(c||u&&1==n.getCount()){if(!l.get('Лицо')||l.get('Лицо')==d&&!l.get('РП.идСотрудника'))f.alert('Нельзя выбирать зону без ответственного сотрудника','error'),this.validate();else i.add(l);if(t._options.keepUser&&c&&!u&&t._options.userList&&t._options.userList.getCount&&1==t._options.userList.getCount()){var p=t._options.userList.at(0);i.at(0).set('РП.идСотрудника',p.get('@Лицо')),i.at(0).set('РП.Сотрудник',p.get('Название'));}}else{var h=[];n.each(function(e){if(t._getIfExist(e,'Лицо')&&t._getIfExist(e,'Лицо')!=d&&!t._getIfExist(e,'ЗонаОтветственности')){var n=parseInt(e.get('Лицо'),10);if(-1==h.indexOf(n))h.push(n),i.add(e);}});}i.each(function(e){var n=l.has('ЗонаОтветственности')&&l.get('ЗонаОтветственности')&&l.get('ЗонаОтветственности')!=l.get('@Лицо'),i=!!(l.has('Состояние')&&l.get('Состояние'))||n;if(i)if(r=n?'ЗонаОтветственности':'@Лицо','@Лицо'==r&&(!e.has('@Лицо')||!e.get('@Лицо')))r='Лицо';s.push(t.makeDataItemArray(e,i,n,r));});}var m=t.makeCommonFormat(s);if(t._executorListIsChange(t._prevUserList,m,true)||t._executorListIsChange(n,i,true)){if(t.__internalSetSelected=true,this.setSelectedItems(m),t._executorListIsChange(t._prevUserList,m,false))if(t.applyUserList(m),t.getUserList())t._prevUserList=t.getUserList().clone();var _=r?parseInt(l.get(r),10):null;if(t.getZone()!=_)t.setZone(_);if(this.setMultiselect(!r),t._setCompetencePlaceholder(e),1==i.getCount()){var C=this.getParent().getContainer().closest('.edo-TaskControls');if(C)C.wsControl().detectNextActiveChildControl();}t.__internalSetSelected=false;}}});return m;});
define("tmpl!SBIS3.EDO.CompetenceSelectorDialog",["Core/tmpl/js/tclosure","js!SBIS3.CONTROLS/Tab/Control","js!SBIS3.CONTROLS/ScrollContainer","js!SBIS3.Staff.Choice.List","js!SBIS3.WorkingArea.ChooseWorkingArea"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],o={};o["js!SBIS3.CONTROLS/Tab/Control"]=e[1],o["js!SBIS3.CONTROLS/ScrollContainer"]=e[2],o["js!SBIS3.Staff.Choice.List"]=e[3],o["js!SBIS3.WorkingArea.ChooseWorkingArea"]=e[4];var r=function e(r,i,n,l,a){function s(){}var c=0,d=void 0!==t&&t?t:arguments[arguments.length-1];void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure"));var p={};a&&a.isSetts&&(p=a.fullContext||{});var S="string"==typeof n?n:"",u=void 0===o?void 0:o,m={id:[],def:void 0},g=d.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,r),f=this&&this.includedTemplates?this.includedTemplates:{},C=d.getMarkupGenerator(l);try{var h=C.joinElements([C.createTag("div",{class:"edo-CompetenceSelectorDialog ws-flexbox ws-flex-column ws-flex-grow-1 ws-flex-shrink-1"},[C.createTag("div",{class:"edo-CompetenceSelectorDialog_padding  ws-flexbox ws-flex-column ws-flex-grow-1 ws-flex-shrink-1"},[C.createControl("wsControl","ws:SBIS3.CONTROLS/Tab/Control",{items:[{content:d.createDataArray([(new function(){var e=Object.create(r),t=function e(t,o,r,i,n){if(void 0===r)var r=arguments[2];var l=0,a="content";if(void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure")),n&&n.isSetts)var s=n.fullContext||{};t=d.isolateScope(Object.create(this),t,a);var c="string"==typeof r?r:"",p={id:[],def:void 0},S=this&&this.includedTemplates?this.includedTemplates:{},m=d.getMarkupGenerator(i);try{var f=m.joinElements([m.createControl("wsControl","ws:SBIS3.CONTROLS/ScrollContainer",{content:d.createDataArray([(new function(){var e=Object.create(t),o=function e(t,o,r,i,n){if(void 0===r)var r=arguments[2];var l=0,a="content";if(void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure")),n&&n.isSetts)var s=n.fullContext||{};t=d.isolateScope(Object.create(this),t,a);var c="string"==typeof r?r:"",p={id:[],def:void 0},S=this&&this.includedTemplates?this.includedTemplates:{},m=d.getMarkupGenerator(i);try{var f=m.joinElements([m.createControl("wsControl","ws:SBIS3.Staff.Choice.List",{selectedFilter:d.getTypeFunc(" js!SBIS3.EDO.CompetenceSelectorDialog:prototype.staffSelectedFilter ",{}),display:{title:"",showOtherEmployees:!0},handlers:{onInit:d.getTypeFunc(" js!SBIS3.EDO.CompetenceSelectorDialog:prototype.initStaffList ",{})},name:"ChoiceList",selectionType:"all",multiselect:!0,useSelectAll:!1,searchString:d.getter(t,["searchString"]),esc:!1},d.plainMerge(o,{class:"edo-CompetenceChoiceList",name:"ChoiceList",sbisname:"ChoiceList"}),{data:t,ctx:this,pName:void 0!==a?a:void 0,viewController:g},r,u,S,d.config,s)],c,p);p.def&&(f=m.chain(f,p,o),p=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/components/CompetenceFieldLink/resources/CompetenceSelectorDialog/CompetenceSelectorDialog.tmpl",e,t)}return f||""};this.func=d.makeFunctionSerializable(o,e)}).func]),stickyContainer:!0,esc:!1},d.plainMerge(o,{class:"edo-CompetenceChoiceContainer controls-ScrollContainer__flex"}),{data:t,ctx:this,pName:void 0!==a?a:void 0,viewController:g,internal:{__dirtyCheckingVars_3:d.getter(t,["searchString"])}},r,u,S,d.config,s)],c,p);p.def&&(f=m.chain(f,p,o),p=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/components/CompetenceFieldLink/resources/CompetenceSelectorDialog/CompetenceSelectorDialog.tmpl",e,t)}return f||""};this.func=d.makeFunctionSerializable(t,e)}).func]),id:"EmplTab",align:"left",title:"Сотрудники"},{content:d.createDataArray([(new function(){var e=Object.create(r),t=function e(t,o,r,i,n){if(void 0===r)var r=arguments[2];var l=0,a="content";if(void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure")),n&&n.isSetts)var s=n.fullContext||{};t=d.isolateScope(Object.create(this),t,a);var c="string"==typeof r?r:"",p={id:[],def:void 0},S=this&&this.includedTemplates?this.includedTemplates:{},m=d.getMarkupGenerator(i);try{var f=m.joinElements([m.createControl("wsControl","ws:SBIS3.WorkingArea.ChooseWorkingArea",{selectedFilter:d.getTypeFunc(" js!SBIS3.EDO.CompetenceSelectorDialog:prototype.zoneSelectedFilter ",{}),handlers:{onInit:d.getTypeFunc(" js!SBIS3.EDO.CompetenceSelectorDialog:prototype.initWorkingAreaList ",{})},name:"WorkingAreaList",className:"ws-float-area__block-layout",selectionType:"allBySelectAction",multiselect:!1,useSelectAll:!1,FilterSearch:d.getter(t,["searchString"]),esc:!1},d.plainMerge(o,{class:"edo-CompetenceWorkingAreaList",name:"WorkingAreaList",sbisname:"WorkingAreaList"}),{data:t,ctx:this,pName:void 0!==a?a:void 0,viewController:g},r,u,S,d.config,s)],c,p);p.def&&(f=m.chain(f,p,o),p=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/components/CompetenceFieldLink/resources/CompetenceSelectorDialog/CompetenceSelectorDialog.tmpl",e,t)}return f||""};this.func=d.makeFunctionSerializable(t,e)}).func]),id:"WorkAreaTab",align:"left",title:"Зоны ответственности",visible:d.getter(r,["allowResponsibilityZone"])&&d.getter(r,["showChooseWorkingArea"])}],name:"SelectorBrowserTabs",tabindex:"1",tabsDisplayField:"title",idProperty:"id",selectedKey:d.getter(r,["selectedKey"]),esc:!1},{class:"edo-CompetenceSelectorTabs ws-flexbox ws-flex-column ws-flex-grow-1 ws-flex-shrink-1",name:"SelectorBrowserTabs",sbisname:"SelectorBrowserTabs"},{data:r,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:g,internal:{__dirtyCheckingVars_3:d.getter(r,["searchString"]),__dirtyCheckingVars_7:d.getter(r,["searchString"]),__dirtyCheckingVars_8:d.getter(r,["allowResponsibilityZone"])&&d.getter(r,["showChooseWorkingArea"])}},n,u,f,d.config,p)],{},m,this)],i,m,this)],S,m);m.def&&(h=C.chain(h,m,i),m=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/components/CompetenceFieldLink/resources/CompetenceSelectorDialog/CompetenceSelectorDialog.tmpl",e,r)}return h||""};return r.includedFunctions={},r.stable=!0,r.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.CompetenceSelectorDialog"}},r});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.CompetenceSelectorDialog", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-CompetenceSelectorDialog{width:800px;background-color:#f7f4f0;height:100%}.edo-CompetenceSelectorDialog_padding{padding-top:14px;height:-moz-calc(100% - 14px);height:-webkit-calc(100% - 14px);height:calc(100% - 14px)}.edo-CompetenceSelectorDialog .controls-TabControl{height:100%}.edo-CompetenceSelectorDialog .ws-SwitchableArea__item{height:100%;display:flex;flex-direction:column;flex-grow:1}.edo-CompetenceSelectorDialog .ws-SwitchableArea{height:100%;display:flex;flex-direction:column;flex-grow:1}.edo-CompetenceSelectorDialog .controls-SelectorController__multiselect .controls-Browser__selector .controls-Browser__search{margin-left:12px!important}.edo-CompetenceSelectorTabButtons{background-color:#f7f4f0}.edo-CompetenceWorkingAreaList{padding-top:8px}.edo-CompetenceChoiceList{position:relative}.edo-CompetenceSelectorDialog .ws-float-area-title{display:none}.edo-CompetenceChoiceContainer .StaffChoice_List__ourCompany{margin-left:8px}.edo-CompetenceChoiceContainer .staff-staffBrowser-CompositeView{height:auto}.edo-CompetenceChoiceContainer .controls-SelectorWrapper{display:block!important}.edo-CompetenceWorkingAreaList .ws-window-titlebar-custom{display:none}.edo-CompetenceSelectorDialog .edo-CompetenceSelectorDialog_closebtn.controls-Link{position:absolute;cursor:pointer;background:transparent url(/resources/Elektronnyj_dokumentooborot/components/CompetenceFieldLink/resources/CompetenceSelectorDialog/resources/areaCloseButton.v1516270649826335cf4508dd597be4bfc9caa3e08b901.png) 0 -1px}"));head.appendChild(style);});}
define('js!SBIS3.EDO.CompetenceSelectorDialog',['SBIS3.CONTROLS/Action/Selector/SelectorController','tmpl!SBIS3.EDO.CompetenceSelectorDialog','optional!js!SBIS3.WorkingArea.ChooseWorkingArea','css!SBIS3.EDO.CompetenceSelectorDialog','SBIS3.CONTROLS/Tab/Control','js!SBIS3.Staff.Choice.List','Elektronnyj_dokumentooborot_localization'],function(e,t,o){var n=e.extend({_dotTplFn:t,$protected:{_options:{showChooseWorkingArea:!!o,selectedKey:'EmplTab'}},$constructor:function(){},init:function(){n.superclass.init.call(this);},_modifyOptions:function(e){var t=(e=n.superclass._modifyOptions.call(this,e)).curCompetenceTabId;return e.selectedKey=t?t():'EmplTab',e;},initStaffList:function(){this.getChildControlByName('engineBrowser').setMultiselect(true);},initWorkingAreaList:function(){this.getChildControlByName('chooseWorkAreaReestr').setMultiselect(false);},staffSelectedFilter:function(e){if(e.get('Состояние'))return false;else return true;},zoneSelectedFilter:function(e){if(e.get('Состояние'))return true;else return false;}});return n;});
define("html!SBIS3.EDO.DocResponsibleConfig",function(){var o=function(o){var t=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;o.test(t);)t=t.replace(o,"&#123;&#123;$1&#125;&#125;");return t}}(),e=function(o){return o.join?o.join(""):o.toString()},n=function(o){return void 0===o?"":o&&"object"==typeof o?e(o):""+o},p="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="edo-DocResponsibleConfig"> <div class="edo-DocResponsibleConfig-title">'+t(n(rk("Определение ответственного за документ")))+"</div> <component data-component='SBIS3.CONTROLS/Menu/MenuButton' class=\"controls-Button__withoutCaption edo-DocResponsibleConfig-menu\"> <opt name='name'>btnChooseResponsible</opt> <opt name='visible'>false</opt> <opt name=\"idProperty\">id</opt> <opt name='icon'>sprite:icon-24 icon-AddButtonNew icon-primary</opt> <opt name=\"caption\">"+t(n(rk("Добавить")))+'</opt> <opts name="handlers"> <opt name="onMenuItemActivate" type="function">js!SBIS3.EDO.DocResponsibleConfig:prototype.onActivated</opt> </opts> </component> <div class="edo-DocResponsibleConfig-caption1">'+t(n(rk("Шаги выполняются последовательно, пока не определится сотрудник или подразделение")))+': </div> <component data-component="SBIS3.CONTROLS/CompositeView" class="controls-DataGridView__hasSeparator edo-DocResponsibleConfig-cv"> <opt name="name" value="chooseResponsibleTable"/> <opt name=\'visible\'>false</opt> <opt name="showHead" value="false"/> <opt name="viewMode" value="table"/> <opt name="displayProperty">title</opt> <opt name="idProperty">id</opt> <opt name="emptyHTML" value="'+t(n(rk("Нет данных")))+'"/> <opts name="columns" type="array"> <opts> <opt name="title">'+t(n(rk("Название")))+'</opt> <opt name="field">title</opt> </opts> </opts> <opts name="itemsActions" type="array"> <opts> <opt name="icon">sprite:icon-16 icon-ArrowUp icon-primary</opt> <opt name="name">arrowUp</opt> <opt name="tooltip">'+t(n(rk("Переместить вверх")))+'</opt> <opt name="caption">'+t(n(rk("Переместить вверх")))+'</opt> <opt name="isMainAction">true</opt> <opt name="onActivated" type="function">js!SBIS3.EDO.DocResponsibleConfig:prototype.recordUp</opt> </opts> <opts> <opt name="icon">sprite:icon-16 icon-ArrowDown icon-primary</opt> <opt name="name">arrowDown</opt> <opt name="tooltip">'+t(n(rk("Переместить вниз")))+'</opt> <opt name="caption">'+t(n(rk("Переместить вниз")))+'</opt> <opt name="isMainAction">true</opt> <opt name="onActivated" type="function">js!SBIS3.EDO.DocResponsibleConfig:prototype.recordDown</opt> </opts> <opts> <opt name="icon">sprite:icon-16 icon-Erase icon-error</opt> <opt name="name">actDelete</opt> <opt name="tooltip">'+t(n(rk("Удалить")))+'</opt> <opt name="caption">'+t(n(rk("Удалить")))+'</opt> <opt name="isMainAction">true</opt> <opt name="onActivated" type="function">js!SBIS3.EDO.DocResponsibleConfig:prototype.deleteItem</opt> </opts> </opts> <opts name="handlers"> <opts name="onChangeHoveredItem" type="array"> <opt name="onChangeHoveredItem" type="function"> js!SBIS3.EDO.DocResponsibleConfig:prototype.onChangeHoveredItem </opt> </opts> </opts> </component> <div class="edo-DocResponsibleConfig-caption2">'+t(n(rk("Можно")))+' <component data-component="SBIS3.CONTROLS/Link" class="controls-Link__underline mainLink__2"> <opt name="name">chooseEmpl</opt> <opt name="caption">'+t(n(rk("указать подразделение или сотрудника")))+'</opt> <opts name="handlers"> <opt name="onActivated" type="function"> js!SBIS3.EDO.DocResponsibleConfig:prototype.onActivatedChooseEmpl </opt> </opts> </component> , '+t(n(rk("который будет отвечать за документы, для которых на предыдущих шагах ответственный не определился.")))+' </div> <div class="edo-DocResponsibleConfig-caption2">'+t(n(rk("Если ответственный не определится - уведомление о новом документе придет всем пользователям с ролями: 'Администратор системы', 'Настройщик системы' и 'Руководитель предприятия'.")))+' </div> <component data-component="SBIS3.CONTROLS/CompositeView" class="controls-DataGridView__hasSeparator edo-DocResponsibleConfig-cv-empl"> <opt name="name" value="chooseEmployees"/> <opt name="visible" value="false"/> <opt name="showHead" value="false"/> <opt name="viewMode" value="table"/> <opt name="displayProperty">Название</opt> <opt name="idProperty">Лицо</opt> <opt name="emptyHTML" value="'+t(n(rk("Нет данных")))+'"/> <opts name="columns" type="array"> <opts> <opt name="width">45</opt> <opt name="cellTemplate">html!SBIS3.EDO.DocResponsibleEmployee</opt> <opt name="title" value=""></opt> <opts name="includedTemplates"> <opt name="photoTpl">html!SBIS3.Person.PersonPhoto/resources/photoCellTpl</opt> </opts> <opts name="templateBinding"> <opt name="photoIdField">Лицо.Фото</opt> <opt name="personIdField">Лицо</opt> </opts> </opts> </opts> <opts name="itemsActions" type="array"> <opts> <opt name="icon">sprite:icon-16 icon-ArrowUp icon-primary</opt> <opt name="name">arrowUp</opt> <opt name="tooltip">'+t(n(rk("Переместить вверх")))+'</opt> <opt name="caption">'+t(n(rk("Переместить вверх")))+'</opt> <opt name="isMainAction">true</opt> <opt name="onActivated" type="function">js!SBIS3.EDO.DocResponsibleConfig:prototype.recordUp</opt> </opts> <opts> <opt name="icon">sprite:icon-16 icon-ArrowDown icon-primary</opt> <opt name="name">arrowDown</opt> <opt name="tooltip">'+t(n(rk("Переместить вниз")))+'</opt> <opt name="caption">'+t(n(rk("Переместить вниз")))+'</opt> <opt name="isMainAction">true</opt> <opt name="onActivated" type="function">js!SBIS3.EDO.DocResponsibleConfig:prototype.recordDown</opt> </opts> <opts> <opt name="icon">sprite:icon-16 icon-TFDelete icon-hover</opt> <opt name="name">actDelete</opt> <opt name="tooltip">'+t(n(rk("Удалить")))+'</opt> <opt name="caption">'+t(n(rk("Удалить")))+'</opt> <opt name="isMainAction">true</opt> <opt name="onActivated" type="function">js!SBIS3.EDO.DocResponsibleConfig:prototype.deleteItem</opt> </opts> </opts> <opts name="handlers"> <opts name="onChangeHoveredItem" type="array"> <opt name="onChangeHoveredItem" type="function"> js!SBIS3.EDO.DocResponsibleConfig:prototype.onChangeHoveredItem </opt> </opts> </opts> </component> </div>');return(a=t(a))+(p&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.DocResponsibleConfig"}},o});
define("html!SBIS3.EDO.DocResponsibleEmployee",function(){var o=function(o){var e=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(e){for(;o.test(e);)e=e.replace(o,"&#123;&#123;$1&#125;&#125;");return e}}(),t=function(o){return o.join?o.join(""):o.toString()},n=function(o){return void 0===o?"":o&&"object"==typeof o?t(o):""+o},i="undefined"!=typeof process,p=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="edo-DocResponsibleEmployee"> <component data-component="SBIS3.CONTROLS/DropdownList" class="edo-DocResponsibleEmployee-ddl"> <opt name="name" value="DropdownList_'+e(n(o.item.get("Лицо")))+'"></opt> <opt name="idProperty" value="key"></opt> <opt name="displayProperty" value="title"></opt> <opt name="multiselect">false</opt> <options name="items" type="array"> <options> <option name="key" value=""></option> <option name="title">'+e(n(rk("Все документы")))+'</option> </options> <options> <option name="key" value="ДокОтгрВх,РеалВх,НакладнаяВх,АктВрВх,СчетВх,ФактураВх"></option> <option name="title">'+e(n(rk("Закупка (накладные, акты, счета, фактуры)")))+'</option> </options> <options> <option name="key" value="ЗаказВх"></option> <option name="title">'+e(n(rk("Заказы")))+'</option> </options> <options> <option name="key" value="ДоговорВх,ДоговорДок"></option> <option name="title">'+e(n(rk("Договоры")))+'</option> </options> <options> <option name="key" value="КоррВх"></option> <option name="title">'+e(n(rk("Письма")))+'</option> </options> </options> <options name="selectedKeys" type="array"> <option>'+e(n(o.item.get("ТипыДокументов")))+'</option> </options> <options name="handlers"> <option name="onSelectedItemsChange" type="function"> js!SBIS3.EDO.DocResponsibleEmployee:prototype.onSelectedItemsChange </option> </options> </component> <div class="edo-DocResponsibleEmployee-photo"> '+e(n(o.included.photoTpl(o)))+' </div> <div class="edo-DocResponsibleEmployee-title"> '+e(n(o.item.get("Название")))+" </div> </div>");return(p=e(p))+(i&&-1!==p.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.DocResponsibleEmployee"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.DocResponsibleEmployee", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-DocResponsibleEmployee-photo,.edo-DocResponsibleEmployee-title{display:inline-block;float:left}.edo-DocResponsibleEmployee-title{margin-left:8px}.edo-DocResponsibleEmployee-photo{clear:left}.edo-DocResponsibleEmployee-ddl{float:left}"));head.appendChild(style);});}
define('js!SBIS3.EDO.DocResponsibleEmployee',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.DocResponsibleEmployee','SBIS3.CONTROLS/DropdownList','css!SBIS3.EDO.DocResponsibleEmployee','Elektronnyj_dokumentooborot_localization'],function(e,t){return e.extend({_dotTplFn:t,$protected:{_options:{}},onSelectedItemsChange:function(e,t,o){var n=this.getParent(),s=n.getDataSet(),i=this.getContainer().parents('tr[data-id]').attr('data-id');s.getRecordById(i).set('ТипыДокументов',t[0]),n.getItems()._notify('onCollectionChange');}});});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.DocResponsibleConfig", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-DocResponsibleConfig-title{font-size:18px;font-weight:700;display:inline;color:#313e78;margin-left:8px}.edo-DocResponsibleConfig-caption1,.edo-DocResponsibleConfig-caption2{margin-top:5px;margin-bottom:5px;color:#999;margin-left:16px}.edo-DocResponsibleConfig-caption1{display:none}.edo-DocResponsibleConfig-cv .controls-DataGridView__columnValue{padding-left:8px}.edo-DocResponsibleConfig-cv-empl .controls-DataGridView__columnValue{padding-left:8px}"));head.appendChild(style);});}
define('js!SBIS3.EDO.DocResponsibleConfig',['optional!js!SBIS3.ENGINE.CoreConfiguration','Core/core-functions','WS.Data/Source/SbisService','SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.DocResponsibleConfig','WS.Data/Source/Memory','WS.Data/Entity/Model','js!SBIS3.Staff.Choice.List','js!SBIS3.EDO.DocResponsibleEmployee','SBIS3.CONTROLS/Link','SBIS3.CONTROLS/Menu/MenuButton','SBIS3.CONTROLS/CompositeView','css!SBIS3.EDO.DocResponsibleConfig','html!SBIS3.Person.PersonPhoto/resources/photoCellTpl','Elektronnyj_dokumentooborot_localization'],function(e,t,s,o,i,n,r,a){'use strict';var l=o.extend({_dotTplFn:i,$protected:{_options:{defaultSettings:{items:{SpecifiedSender:rk('Конкретный сотрудник или подразделение, указанное получателем в документе'),FixedEmployee:rk('Сотрудник, закрепленный за контрагентом'),OnDocumentAddress:rk('Обособленное подразделение, соответствующее адресу в документе'),OnDocumentBase:rk('Ответственный за документ-основание, например, за счет или договор'),IdentifiedByFilial:rk('Подразделение, соответствующее нашей организации')},employees:[]},linkMenu:null,currentSettings:null,responsibleTable:null,employeeTable:null,applyButton:null,historyButton:null,configArea:null,baseDocObject:'Документ',listGetMethod:'GetResponsibleOrder',listSetMethod:'SetResponsibleOrder'}},$constructor:function(){},onChangeHoveredItem:function(e,t){var s=this,o=s.getItemsActions().getItemsInstances(),i=s.getNextItemById(t['key'])?s.getNextItemById(t['key']).data('id'):false,n=s.getPrevItemById(t['key'])?s.getPrevItemById(t['key']).data('id'):false;for(var r in o)if(o.hasOwnProperty(r))switch(r){case'arrowUp':o[r][n?'show':'hide']();break;case'arrowDown':o[r][i?'show':'hide']();break;default:o[r].show();}},redrawMenu:function(){var e=this._options.responsibleTable.getItems(),t={items:[]};e.each(function(e){t.items.push(e.get('id'));});var s=this._options.linkMenu,o=this.mergeMenuItems(t),i=this.prepareSettings(o);s.setItems(i),s.setVisible(e.getCount()<Object.keys(this._options.defaultSettings.items).length?true:false);},saveSettings:function(){var e=this.getRespTable(),o=this.getEmplTable(),i=e.getItems(),n=o.getItems(),r,a=[],l=[],p;if(i&&n){r=i.getCount();for(var u=0;u<r;u++)a.push(i.at(u).get('id'));r=n.getCount();for(var u=0;u<r;u++)l.push({'Лицо':n.at(u).get('Лицо'),'Название':n.at(u).get('Название'),'Лицо.Фото':n.at(u).get('Лицо.Фото'),'ТипыДокументов':n.at(u).get('ТипыДокументов')});p={items:a,employees:l},new s({endpoint:this._options.baseDocObject}).call(this._options.listSetMethod,{'ПараметрыКлиента':JSON.stringify(p)}).addErrback(function(e){t.alert(e.message,'error');});}},loadSettings:function(){var e=this,o=null,i=[];return new s({endpoint:e._options.baseDocObject}).call(e._options.listGetMethod,{'Формат':'raw'}).addCallback(function(n){if(!n||!(n.getRawData&&n.getRawData())){for(var r in e._options.defaultSettings.items)if(e._options.defaultSettings.items.hasOwnProperty(r))i.push(r);o=JSON.stringify({items:i,employees:[]}),new s({endpoint:e._options.baseDocObject}).call(e._options.listSetMethod,{'ПараметрыКлиента':o}).addErrback(function(e){t.alert(e.message,'error');});}else o=n.getRawData();return e._options.currentSettings=o,JSON.parse(o);});},onActivatedChooseEmpl:function(){var e=this.getParent().getEmplTable(),t={multiSelect:false,side:'right',isStack:true,autoHeight:true,opener:this,selectionType:'all',showChooseOrg:false,restrictionOffice:'department'};a.show(t).addCallback(function(t){if(t&&t.length){var s=e.getItems(),o=new r({adapter:'adapter.json',format:e.getItems().getFormat(),idProperty:'Лицо'});o.set('Лицо',t[0].get('Лицо')),o.set('Название',t[0].get('Название')),o.set('Лицо.Фото',t[0].get('ФотоБольшое')),o.set('ТипыДокументов',''),s.add(o),e.getDataSource().update(o);}});},onActivated:function(e,t){var s=this.getParent(),o=s._options.responsibleTable,i=s._options.defaultSettings,n=new r({adapter:'adapter.json',format:o.getItems().getFormat(),idProperty:'id'});n.set('id',t),n.set('title',i.items[t]);for(var a=this.getItems(),l=a.getCount(),p=[],u=0;u<l;u++)if(a.at(u).getId()!==t)p.push({id:a.at(u).get('id'),title:a.at(u).get('title')});this.setItems(p),o.getItems().add(n),o.getDataSource().update(n);},recordUp:function(e,t,s){this.moveRecordUp(e,t,s);},deleteItem:function(e,t,s){this.deleteRecords([t]);},recordDown:function(e,t,s){this.moveRecordDown(e,t,s);},prepareSettings:function(e){var t=[],s=this._options.defaultSettings;if(e.items)for(var o in e.items)if(e.items.hasOwnProperty(o))t.push({id:e.items[o],title:s.items[e.items[o]]});return t;},prepareEmployees:function(e){var t=[];if(e.hasOwnProperty('employees')&&e.employees)for(var s in e.employees)if(e.employees.hasOwnProperty(s))t.push({'Лицо':e.employees[s]['Лицо'],'Название':e.employees[s]['Название'],'Лицо.Фото':e.employees[s]['Лицо.Фото'],'ТипыДокументов':e.employees[s]['ТипыДокументов']});return t;},mergeMenuItems:function(e){var t=this._options.defaultSettings,s={items:[],employees:e.hasOwnProperty('employees')?e.employees:[]},o=[];for(var i in t.items)if(t.items.hasOwnProperty(i))if(-1===Array.indexOf(e.items,i))o.push(i);return s.items=o,s;},fillData:function(e){var t=this,s=t._options,o=t.getContainer().find('.edo-DocResponsibleConfig-caption1').eq(0),i=t.mergeMenuItems(e),r=t.prepareSettings(i),a=t.prepareEmployees(e),l=t.getRespTable(),p=t.getEmplTable(),u=this._options.linkMenu;if(t._options.linkMenu.setItems(r),l.setDataSource(new n({data:t.prepareSettings(e),idProperty:'id'})),a.length)p.setVisible(true);if(e.items.length)o.show(),l.setVisible(true);t._options.linkMenu.setVisible(r.length?true:false),p.setDataSource(new n({data:t.prepareEmployees(e),idProperty:'Лицо'})),t.subscribeTo(p.getItems(),'onCollectionChange',function(e){if(s.applyButton.show(),p.getItems().getCount())p.setVisible(true);else p.setVisible(false);}),t.subscribeTo(l.getItems(),'onCollectionChange',function(e,i,n,r,a,p){if(s.applyButton.show(),l.setVisible(l.getItems().getCount()?true:false),l.getItems().getCount())l.setVisible(true),o.show();else l.setVisible(false),o.hide();t.redrawMenu.call(t);});},getEmplTable:function(){return this._options.employeeTable;},getRespTable:function(){return this._options.responsibleTable;},init:function(){var t=this,s=t._options;l.superclass.init.call(this),s.linkMenu=t.getChildControlByName('btnChooseResponsible'),s.responsibleTable=this.getChildControlByName('chooseResponsibleTable'),s.employeeTable=this.getChildControlByName('chooseEmployees'),s.configArea=t.getParentByName('Configuration'),s.applyButton=s.configArea.getChildControlByName('Apply'),s.historyButton=s.configArea.getChildControlByName('historyLink'),t.loadSettings().addCallback(function(e){s.currentSettings=e,t.fillData.call(t,e),s.historyButton.show();}),t.subscribeTo(e,'onAfterSave',function(e,s,o){t.saveSettings();});}});return l;});
define('js!SBIS3.EDO.DocResponsibleConfigHandler',['Lib/Control/Control','Core/EventBus','Elektronnyj_dokumentooborot_localization'],function(n,o){var e={onNavigate:function(o,e,i,a){var t=null,l=null;if(n.ControlStorage.containsByName('Configuration')){if(t=n.ControlStorage.getByName('Configuration'),t.hasChildControlByName('Apply'))l=t.getChildControlByName('Apply');if('responsible'!==i)l.hide();}}};return o.channel('navigation').subscribe('onNavigate',e.onNavigate),e;});
define("html!SBIS3.EDO.FilterLimitation",function(){var t=function(t){var e=function(){var t=/\{\{([\s\S]+?)\}\}/g;return function(e){for(;t.test(e);)e=e.replace(t,"&#123;&#123;$1&#125;&#125;");return e}}(),n=function(t){return t.join?t.join(""):t.toString()},o=function(t){return void 0===t?"":t&&"object"==typeof t?n(t):""+t},i="undefined"!=typeof process,r=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div style="height:32px;"> <div style="float:left;height:32px;line-height:32px;width:109px!important;margin-right:8px;text-align:right;"> '+e(o(rk("Срок выполнения")))+' </div> <component data-component="Deprecated/Controls/FieldDate/FieldDate" name="ФильтрСрокДата" style="float:left;padding-top:4px;height:28px;"> <option name="mask">DD.MM.YY</option> <option name="calendar">true</option> <option name="centuryDivision">99</option> <option name="autoComplete">true</option> <option name="arrows">false</option> <option name="allowChangeEnable">true</option> </component> </div>');return(r=e(r))+(i&&-1!==r.indexOf("{{")?String.fromCharCode(8203,8203):"")};return t.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.FilterLimitation"}},t});
define('js!SBIS3.EDO.FilterLimitation',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.FilterLimitation','Deprecated/Controls/DateRange/DateRange','Deprecated/Controls/FieldDate/FieldDate','i18n!SBIS3.EDO.FilterLimitation','Elektronnyj_dokumentooborot_localization'],function(t,e){'use strict';var i=t.extend({_dotTplFn:e,$protected:{_options:{name:'ФильтрСрок'}},$constructor:function(){},getQuery1:function(){return this.getChildControlByName('ФильтрСрокДата').getQuery();},getValue:function(){if(this.hasChildControlByName('ФильтрСрокДата'))return this.getChildControlByName('ФильтрСрокДата').getValue();else return;},setValue:function(t){if(this.hasChildControlByName('ФильтрСрокДата'))return this.getChildControlByName('ФильтрСрокДата').setValue(t);else return false;},getDefaultValue1:function(){},getStringValue:function(){return this.getChildControlByName('ФильтрСрокДата').getValue().strftime('%e %q %Y');},setActive:function(t){this.getChildControlByName('ФильтрСрокДата').setActive(t);},init:function(){i.superclass.init.call(this);var t=this;this.getChildControlByName('ФильтрСрокДата').getStringValue=this.getStringValue;}});return i;});
define("html!SBIS3.EDO.FiltersKit",function(){var o=function(o){var n=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;o.test(n);)n=n.replace(o,"&#123;&#123;$1&#125;&#125;");return n}}(),t=function(o){return o.join?o.join(""):o.toString()},i=function(o){return void 0===o?"":o&&"object"==typeof o?t(o):""+o},e="undefined"!=typeof process,p=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div style="width:318px;padding-bottom:16px;position:relative;"> <div style="line-height:8px;height:8px;min-height:8px;" class="padding16"></div> <div class="divLinkButtonAll padding16" style="height:24px;line-height:24px;"> <component data-component="Deprecated/Controls/LinkButton/LinkButton" name="LinkButtonAll" class="btnAllDocs" style="font-size:18px;color:black;font-family:Tahoma, Geneva, sans-serif;text-align:left;text-decoration:underline;"></component> </div> <div class="divTemplatedAreaTop"> </div> <div style="line-height:24px;" class="divCaption1 padding16"> '+n(i(rk("Можно отобрать по состоянию:")))+' </div> <div class="FilterState" style="display:none;"> <component data-component="SBIS3.EDO.FilterDropdown" name="FilterState"> <option name="btnCaption">'+n(i(rk("Обработки...")))+'</option> <option name="context">false</option> <options name="data" type="array"> <options> <option name="key" type="string">-1</option> <option name="value">'+n(i(rk("В любом состоянии")))+'</option> </options> <options> <option name="key" type="string">10</option> <option name="value">'+n(i(rk("Внутренняя обработка")))+'</option> </options> <options> <option name="key">2,3</option> <option name="value">'+n(i(rk("Недоставленные")))+'</option> </options> <options> <option name="key" type="string">4</option> <option name="value">'+n(i(rk("Не получен ответ")))+'</option> </options> <options> <option name="key" type="string">7</option> <option name="value">'+n(i(rk("Утвержденные")))+'</option> </options> <options> <option name="key" type="string">9</option> <option name="value">'+n(i(rk("Отклоненные")))+'</option> </options> <options> <option name="key" type="string">6</option> <option name="value">'+n(i(rk("С ошибками")))+'</option> </options> <options> <option name="key" type="string">-2</option> <option name="value">'+n(i(rk("Незакрепленные")))+'</option> </options> <options> <option name="key" type="string">-3</option> <option name="value">'+n(i(rk("Удаленные")))+'</option> </options> <options> <option name="value">'+n(i(rk("Аннулированные")))+'</option> <option name="key">19,20,22</option> </options> <options> <option name="key">0,1</option> <option name="value">'+n(i(rk("Черновики")))+'</option> </options> </options> <option name="filterName">ФильтрСостояние</option> <options name="excludedFilters" type="array"> <option>ФильтрПоКраткомуСостоянию</option> </options> </component> </div> <div class="FilterPaymentOld" style="display:none;"> <component data-component="SBIS3.EDO.FilterDropdown" name="FilterPaymentOld"> <option name="btnCaption">'+n(i(rk("Оплаты...")))+'</option> <option name="context">false</option> <options name="data" type="array"> <options> <option name="key" type="string">-1</option> <option name="value">'+n(i(rk("Оплаченные и неоплаченные")))+'</option> </options> <options> <option name="key" type="string">1</option> <option name="value">'+n(i(rk("Только оплаченные")))+'</option> </options> <options> <option name="key" type="string">2</option> <option name="value">'+n(i(rk("Только неоплаченные")))+'</option> </options> </options> <option name="filterName">ФильтрОплата</option> </component> </div> <div class="FilterShortState" style="display:none;"> <component data-component="SBIS3.EDO.FilterDropdown" name="FilterShortState"> <option name="btnCaption">'+n(i(rk("Обработки...")))+'</option> <option name="context">false</option> <options name="data" type="array"> <options> <option name="key" type="string">0</option> <option name="value">'+n(i(rk("В любом состоянии")))+'</option> </options> <options> <option name="key" type="string">4</option> <option name="value">'+n(i(rk("В обработке")))+'</option> </options> <options> <option name="key" type="string">1</option> <option name="value">'+n(i(rk("Завершенные")))+'</option> </options> <options> <option name="isMul">true</option> <option name="key">2,3</option> <option name="value">'+n(i(rk("положительно,отрицательно")))+'</option> </options> <options> <option name="key" type="string">-3</option> <option name="value">'+n(i(rk("Удаленные")))+'</option> </options> <options> <option name="key" type="string">5</option> <option name="value">'+n(i(rk("Черновики")))+'</option> </options> </options> <option name="filterName">ФильтрПоКраткомуСостоянию</option> <options name="excludedFilters" type="array"> <option>ФильтрСостояние</option> </options> </component> </div> <div class="FilterRepeat" style="display:none;"> <component data-component="SBIS3.EDO.FilterDropdown" name="FilterRepeat"> <option name="btnCaption">'+n(i(rk("Повторений...")))+'</option> <option name="context">false</option> <options name="data" type="array"> <options> <option name="key" type="string">0</option> <option name="value">'+n(i(rk("Не учитываются")))+'</option> </options> <options> <option name="key" type="string">1</option> <option name="value">'+n(i(rk("Учитываются")))+'</option> </options> </options> <option name="filterName">ФильтрПоПовторениям</option> </component> </div> <div class="FilterTransitionType" style="display:none;"> <component data-component="SBIS3.EDO.FilterDropdown" name="FilterTransitionType"> <option name="btnCaption">'+n(i(rk("Типа перехода...")))+'</option> <option name="context">false</option> <options name="data" type="array"> <options> <option name="key" type="string">1</option> <option name="value">'+n(i(rk("Положительные")))+'</option> </options> <options> <option name="key" type="string">2</option> <option name="value">'+n(i(rk("Отрицательные")))+'</option> </options> <options> <option name="key" type="string">3</option> <option name="value">'+n(i(rk("Все")))+'</option> </options> </options> <option name="filterName">ФильтрТипПерехода</option> </component> </div> <div class="FilterDelivery" style="display:none;"> <component data-component="SBIS3.EDO.FilterDropdown" name="FilterDelivery"> <option name="btnCaption">'+n(i(rk("Доставки...")))+'</option> <option name="context">false</option> <options name="data" type="array"> <options> <option name="key" type="string">0</option> <option name="value">'+n(i(rk("Почтой")))+'</option> </options> <options> <option name="key" type="string">1</option> <option name="value">'+n(i(rk("По e-mail")))+'</option> </options> <options> <option name="key" type="string">2</option> <option name="value">'+n(i(rk("Курьером")))+'</option> </options> <options> <option name="key" type="string">3</option> <option name="value">'+n(i(rk("По факсу")))+'</option> </options> <options> <option name="key" type="string">4</option> <option name="value">'+n(i(rk("Телефонограммой")))+'</option> </options> <options> <option name="key" type="string">5</option> <option name="value">'+n(i(rk("Электронно")))+'</option> </options> <options> <option name="key" type="string">6</option> <option name="value">'+n(i(rk("Нашим сотрудником")))+'</option> </options> <options> <option name="key" type="string">7</option> <option name="value">'+n(i(rk("Заказным письмом")))+'</option> </options> <options> <option name="key" type="string">8</option> <option name="value">'+n(i(rk("Ценным письмом")))+'</option> </options> <options> <option name="key" type="string">9</option> <option name="value">'+n(i(rk("Обычным письмом")))+'</option> </options> <options> <option name="key" type="string">10</option> <option name="value">'+n(i(rk("Экспресс-почтой")))+'</option> </options> </options> <option name="filterName">ФильтрТипПерехода</option> </component> </div> <div class="FilterHistory padding32" style="display:none;height:24px;"> <component data-component="SBIS3.EDO.FilterLinkButton" name="FilterHistory" style="display:inline-block;"> <option name="fValue">true</option> <option name="fText">'+n(i(rk("Текущее")))+'</option> <option name="fTitle">ФильтрИстория</option> </component> <div style="display:inline-block;position:relative;top:4px;padding-left:3px;padding-right:3px;heigth:100%;vertical-align: top">'+n(i(rk("/")))+'</div> <component data-component="SBIS3.EDO.FilterLinkButton" name="FilterHistory" style="display:inline-block;"> <option name="fValue">false</option> <option name="fText">'+n(i(rk("без текущего")))+'</option> <option name="fTitle">ФильтрИстория</option> </component> </div> <div class="FilterPosted padding32" style="display:none;height:24px;"> <component data-component="SBIS3.EDO.FilterLinkButton" name="FilterPosted" style="display:inline-block;"> <option name="fValue">true</option> <option name="fText">'+n(i(rk("Проведенные")))+'</option> <option name="fTitle">ФильтрПроведенные</option> </component> <div style="display:inline-block;position:relative;top:4px;padding-left:3px;padding-right:3px;heigth:100%;vertical-align: top">'+n(i(rk("/")))+'</div> <component data-component="SBIS3.EDO.FilterLinkButton" name="FilterPosted" style="display:inline-block;"> <option name="fValue">false</option> <option name="fText">'+n(i(rk("Непроведенные")))+'</option> <option name="fTitle">ФильтрПроведенные</option> </component> </div> <div class="FilterPayment padding32" style="display:none;height:24px;"> <component data-component="SBIS3.EDO.FilterLinkButton" name="FilterPayment" style="display:inline-block;"> <option name="fValue" type="string">1</option> <option name="fText">'+n(i(rk("Оплаченные")))+'</option> <option name="fTitle">ФильтрОплата</option> </component> <div style="display:inline-block;position:relative;top:4px;padding-left:3px;padding-right:3px;heigth:100%;vertical-align: top">'+n(i(rk("/")))+'</div> <component data-component="SBIS3.EDO.FilterLinkButton" name="FilterPayment" style="display:inline-block;"> <option name="fValue" type="string">2</option> <option name="fText">'+n(i(rk("Неоплаченные")))+'</option> <option name="fTitle">ФильтрОплата</option> </component> </div> <div class="FilterShipping padding32" style="display:none;height:24px;"> <component data-component="SBIS3.EDO.FilterLinkButton" name="FilterShipping" style="display:inline-block;"> <option name="fValue" type="string">1</option> <option name="fText">'+n(i(rk("Отгруженные")))+'</option> <option name="fTitle">ФильтрПоставка</option> </component> <div style="display:inline-block;position:relative;top:4px;padding-left:3px;padding-right:3px;heigth:100%;vertical-align: top">'+n(i(rk("/")))+'</div> <component data-component="SBIS3.EDO.FilterLinkButton" name="FilterShipping" style="display:inline-block;"> <option name="fValue" type="string">2</option> <option name="fText">'+n(i(rk("Неотгруженные")))+'</option> <option name="fTitle">ФильтрПоставка</option> </component> </div> <div class="FilterUnanswered padding32" style="display:none;"> <component data-component="SBIS3.EDO.FilterLinkButton" name="FilterUnanswered"> <option name="fValue">true</option> <option name="fText">'+n(i(rk("Неотвеченные")))+'</option> <option name="fTitle">ФильтрНеотвеченные</option> </component> </div> <div class="FilterDeleted padding32" style="display:none;height:24px;"> <div class="divDraft" style="display:inline-block;position:relative;height:24px"> <component data-component="SBIS3.EDO.FilterLinkButton" name="FilterDraft" style="display:inline-block;"> <option name="fValue">0,1</option> <option name="fText">'+n(i(rk("Черновики")))+'</option> <option name="fTitle">ФильтрСостояние</option> <options name="excludedFilters" type="array"> <option>ФильтрПоКраткомуСостоянию</option> <option>ФильтрПросроченные</option> </options> </component> <div style="display:inline-block;position:relative;top:4px;padding-left:3px;padding-right:3px;heigth:100%;vertical-align: top">'+n(i(rk("/")))+'</div> </div> <div class="divDraftShort" style="display:inline-block;position:relative;height:24px"> <component data-component="SBIS3.EDO.FilterLinkButton" name="FilterDraftShort" style="display:inline-block;"> <option name="fValue" type="string">5</option> <option name="fText">'+n(i(rk("Черновики")))+'</option> <option name="fTitle">ФильтрПоКраткомуСостоянию</option> <options name="excludedFilters" type="array"> <option>ФильтрСостояние</option> <option>ФильтрПросроченные</option> </options> </component> <div style="display:inline-block;position:relative;top:4px;padding-left:3px;padding-right:3px;heigth:100%;vertical-align: top">'+n(i(rk("/")))+'</div> </div> <component data-component="SBIS3.EDO.FilterLinkButton" name="FilterDeleted" style="display:inline-block;"> <option name="fValue">true</option> <option name="fText">'+n(i(rk("Удаленные")))+'</option> <option name="fTitle">ФильтрУдаленные</option> </component> </div> <div style="line-height:24px;" class="divCaption2 padding16"> '+n(i(rk("Отфильтровать по:")))+' </div> <div class="FilterPriority padding32" style="display:none;"> <component data-component="SBIS3.EDO.FilterLinkButton" name="FilterPriority"> <option name="fValue" type="string">1</option> <option name="fText">'+n(i(rk("Важным")))+'</option> <option name="fTitle">ФильтрПриоритет</option> </component> </div> <div class="FilterLimitationDate padding32" style="display:none;height:24px;"> <component data-component="SBIS3.EDO.FilterLinkButton" name="FilterLimitationDate" style="display:inline-block;"> <option name="fValue">isFieldLink</option> <option name="fText">'+n(i(rk("Сроку выполнения")))+'</option> <option name="fTitle">ФильтрСрокДата</option> <options name="excludedFilters" type="array"> <option>ФильтрПоКраткомуСостоянию:1,2,3</option> <option>ФильтрСостояние:7,9</option> </options> </component> </div> <div class="FilterOverdue padding32" style="display:none;height:24px;"> <div class="divDeadline" style="display:inline-block;position:relative;height:24px"> <component data-component="SBIS3.EDO.FilterLinkButton" name="FilterLimitation" style="display:inline-block;"> <option name="fValue">isFieldLink</option> <option name="fText">'+n(i(rk("Сроку выполнения")))+'</option> <option name="fTitle">ФильтрСрокДата</option> <options name="excludedFilters" type="array"> <option>ФильтрПоКраткомуСостоянию:1,2,3</option> <option>ФильтрСостояние:7,9</option> </options> </component> <div style="display:inline-block;position:relative;top:4px;padding-left:3px;padding-right:3px;heigth:100%;vertical-align: top">'+n(i(rk("/")))+'</div> </div> <component data-component="SBIS3.EDO.FilterLinkButton" name="FilterOverdue" style="display:inline-block;"> <option name="fValue">true</option> <option name="fText">'+n(i(rk("Просроченные")))+'</option> <option name="fTitle">ФильтрПросроченные</option> <options name="excludedFilters" type="array"> <option>ФильтрСостояние:7,9</option> <option>ФильтрПоКраткомуСостоянию:1,2,3</option> <option>ФильтрПоКраткомуСостоянию:5</option> <option>ФильтрСостояние:0,1</option> </options> </component> </div> <div class="FilterMilestone  padding32" style="display:none;"> <component data-component="SBIS3.EDO.FilterLinkButton" name="FilterMilestone"> <option name="fValue">isFieldLink</option> <option name="fText">'+n(i(rk("Вехе")))+'</option> <option name="fTitle">ФильтрПоВехе</option> </component> </div> <div class="FilterRegulations padding32" style="display:none;"> <component data-component="SBIS3.EDO.FilterLinkButton" name="FilterRegulations"> <option name="fValue">isFieldLink</option> <option name="fText">'+n(i(rk("Регламенту (этапу)")))+'</option> <option name="fTitle">Регламент</option> </component> </div> <div class="FilterIDRegulations padding32" style="display:none;"> <component data-component="SBIS3.EDO.FilterLinkButton" name="FilterIDRegulations"> <option name="fValue">isFieldLink</option> <option name="fText">'+n(i(rk("Регламенту (этапу)")))+'</option> <option name="fTitle">ИдРегламента</option> </component> </div> <div class="FilterTransition padding32" style="display:none;"> <component data-component="SBIS3.EDO.FilterLinkButton" name="FilterTransition"> <option name="fValue">isFieldLink</option> <option name="fText">'+n(i(rk("Результату")))+'</option> <option name="fTitle">ФильтрПереход</option> </component> </div> <div class="FilterFace1 padding32" style="display:none;"> <component data-component="SBIS3.EDO.FilterLinkButton" name="FilterFace1"> <option name="fValue">isFieldLink</option> <option name="fText">'+n(i(rk("Контрагенту")))+'</option> <option name="fTitle">ФильтрЛицо1</option> </component> </div> <div class="FilterOurOrganisation padding32" style="display:none;"> <component data-component="SBIS3.EDO.FilterLinkButton" name="FilterOurOrganisation"> <option name="fValue">isFieldLink</option> <option name="fText">'+n(i(rk("Фильтр@@Организации")))+'</option> <option name="fTitle">ФильтрДокументНашаОрганизация</option> </component> </div> <div class="FilterResponsibleFace padding32" style="display:none;"> <component data-component="SBIS3.EDO.FilterLinkButton" name="FilterResponsibleFace"> <option name="fValue">isFieldLink</option> <option name="fText">'+n(i(rk("Ответственному")))+'</option> <option name="fTitle">ФильтрОтветственноеЛицо</option> <options name="excludedFilters" type="array"> <option>ФильтрАвтор</option> <option>ФильтрВладелец</option> <option>ФильтрНезакрепленные</option> </options> </component> </div> <div class="Regulations padding32" style="display:none;"> <component data-component="SBIS3.EDO.FilterLinkButton" name="Regulations"></component> </div> <div class="FilterAuthorOrResponsible" style="display:none;"> <div style="height:24px;" class="padding32"> <div class="divAuthor" style="display:inline-block;position:relative;height:24px"> <component data-component="SBIS3.EDO.FilterLinkButton" name="FilterAuthor1" style="display:inline-block;float:none;"> <option name="fValue">isFieldLink</option> <option name="fText">'+n(i(rk("Автору")))+'</option> <option name="fTitle">ФильтрАвтор</option> <options name="excludedFilters" type="array"> <option>ФильтрОтветственноеЛицо</option> <option>ФильтрВладелец</option> <option>ФильтрНезакрепленные</option> </options> </component> <div style="display:inline-block;position:relative;top:4px;padding-left:3px;padding-right:3px;heigth:100%;vertical-align: top">'+n(i(rk("/")))+'</div> </div> <component data-component="SBIS3.EDO.FilterLinkButton" name="FilterResponsibleFace1" style="display:inline-block;float:none;"> <option name="fValue">isFieldLink</option> <option name="fText">'+n(i(rk("Ответственному")))+'</option> <option name="fTitle">ФильтрОтветственноеЛицо</option> <options name="excludedFilters" type="array"> <option>ФильтрАвтор</option> <option>ФильтрВладелец</option> <option>ФильтрНезакрепленные</option> </options> </component> <div class="divListDispatch" style="display:inline-block;position:relative;height:24px"> <div style="display:inline-block;position:relative;top:4px;padding-left:3px;padding-right:3px;heigth:100%;vertical-align: top">'+n(i(rk("/")))+'</div> <component data-component="SBIS3.EDO.FilterLinkButton" name="FilterListDispatch1" style="display:inline-block;float:none;"> <option name="fValue">isFieldLink</option> <option name="fText">'+n(i(rk("Исполнителю")))+'</option> <option name="fTitle">ФильтрСписокРассылки</option> <options name="excludedFilters" type="array"> <option>ФильтрИсполнительСобытия</option> <option>ФильтрКонкретныйИсполнитель</option> </options> <option name="fTooltip">'+n(i(rk("Исполнитель, указанный в документе")))+'</option> </component> </div> </div> </div> <div class="FilterAuthorOrResponsibleMe" style="display:none;"> <div style="margin-left:48px;height:24px;"> <component data-component="SBIS3.EDO.FilterLinkButton" name="FilterOwner" style="display:inline-block;"> <option name="fText">'+n(i(rk("От меня")))+'</option> <option name="fTitle">ФильтрВладелец</option> <option name="fValue">От меня</option> <options name="excludedFilters" type="array"> <option>ФильтрОтветственноеЛицо</option> <option>ФильтрАвтор</option> <option>ФильтрНезакрепленные</option> </options> <option name="outerTooltip">'+n(i(rk("Я - автор или я - ответственный")))+'</option> </component> <div style="display:inline-block;position:relative;top:4px;padding-left:3px;padding-right:3px;heigth:100%;vertical-align: top">'+n(i(rk("/")))+'</div> <component data-component="SBIS3.EDO.FilterLinkButton" name="FilterOwnerUnit" style="display:inline-block;"> <option name="fText">'+n(i(rk("От моего отдела")))+'</option> <option name="fTitle">ФильтрВладелец</option> <option name="fValue">От моего отдела</option> <options name="excludedFilters" type="array"> <option>ФильтрОтветственноеЛицо</option> <option>ФильтрАвтор</option> <option>ФильтрНезакрепленные</option> </options> <option name="outerTooltip">'+n(i(rk("Авторы или ответственные - сотрудники моего отдела")))+'</option> </component> </div> </div> <div class="FilterUnfixed padding32" style="display:none;height:24px;"> <component data-component="SBIS3.EDO.FilterLinkButton" name="FilterUnfixed" style="float:none;padding-left:16px;"> <option name="fValue" type="string">-2</option> <option name="fText">'+n(i(rk("Незакрепленные")))+'</option> <option name="fTitle">ФильтрНезакрепленные</option> <options name="excludedFilters" type="array"> <option>ФильтрОтветственноеЛицо</option> <option>ФильтрАвтор</option> <option>ФильтрВладелец</option> </options> </component> </div> <div class="FilterListDispatch padding32" style="display:none;"> <component data-component="SBIS3.EDO.FilterLinkButton" name="FilterListDispatch"> <option name="fValue">isFieldLink</option> <option name="fText">'+n(i(rk("Исполнителю")))+'</option> <option name="fTitle">ФильтрСписокРассылки</option> <options name="excludedFilters" type="array"> <option>ФильтрИсполнительСобытия</option> <option>ФильтрКонкретныйИсполнитель</option> </options> <option name="fTooltip">'+n(i(rk("Исполнитель, указанный в документе")))+'</option> </component> </div> <div class="FilterEventPerformer padding32" style="display:none;"> <component data-component="SBIS3.EDO.FilterLinkButton" name="FilterEventPerformer"> <option name="fValue">isFieldLink</option> <option name="fText">'+n(i(rk("Исполнителю текущего этапа")))+'</option> <option name="fTitle">ФильтрИсполнительСобытия</option> <options name="excludedFilters" type="array"> <option>ФильтрСписокРассылки</option> <option>ФильтрКонкретныйИсполнитель</option> </options> </component> </div> <div class="FilterSpecificPerformer padding32" style="display:none;"> <div style="margin-left:16px;height:24px;"> <component data-component="SBIS3.EDO.FilterLinkButton" name="FilterSpecificPerformer" style="display:inline-block;"> <option name="fText">'+n(i(rk("На мне")))+'</option> <option name="fTitle">ФильтрКонкретныйИсполнитель</option> <option name="fValue">На мне</option> <option name="outerTooltip">'+n(i(rk("Я - исполнитель")))+'</option> <options name="excludedFilters" type="array"> <option>ФильтрИсполнительСобытия</option> <option>ФильтрСписокРассылки</option> </options> </component> <div style="display:inline-block;position:relative;top:4px;padding-left:3px;padding-right:3px;heigth:100%;vertical-align: top">'+n(i(rk("/")))+'</div> <component data-component="SBIS3.EDO.FilterLinkButton" name="FilterSpecificPerformer" style="display:inline-block;"> <option name="fText">'+n(i(rk("На моем отделе")))+'</option> <option name="fTitle">ФильтрКонкретныйИсполнитель</option> <option name="fValue">На моем отделе</option> <option name="outerTooltip">'+n(i(rk("Исполнитель - мой отдел или сотрудники моего отдела")))+'</option> <options name="excludedFilters" type="array"> <option>ФильтрИсполнительСобытия</option> <option>ФильтрСписокРассылки</option> </options> </component> </div> <div class="FilterTypeDocVD" style="display:none;"> <component data-component="SBIS3.EDO.FilterLinkButton" name="FilterTypeDocVD"> <option name="fValue">isFieldLink</option> <option name="fText">Тип документа</option> <option name="fTitle">ТипДокументаВД</option> </component> </div> <div class="divNoPerformer padding16" style="display:none;height:24px;"> <component data-component="SBIS3.EDO.FilterLinkButton" name="FilterSpecificPerformer" style="display:inline-block;"> <option name="fText">'+n(i(rk("Без исполнителя")))+'</option> <option name="fTitle">ФильтрКонкретныйИсполнитель</option> <option name="fValue">Без исполнителя</option> <options name="excludedFilters" type="array"> <option>ФильтрИсполнительСобытия</option> <option>ФильтрСписокРассылки</option> </options> </component> </div> </div> <div class="FilterAuthor padding32" style="display:none;"> <component data-component="SBIS3.EDO.FilterLinkButton" name="FilterAuthor"> <option name="fValue">isFieldLink</option> <option name="fText">'+n(i(rk("Автору")))+'</option> <option name="fTitle">ФильтрАвтор</option> </component> </div> <div class="FilterSender padding32" style="display:none;"> <component data-component="SBIS3.EDO.FilterLinkButton" name="FilterSender"> <option name="fValue">isFieldLink</option> <option name="fText">'+n(i(rk("Отправителю")))+'</option> <option name="fTitle">ФильтрОтправитель</option> </component> </div> <div class="FilterReceiver padding32" style="display:none;"> <component data-component="SBIS3.EDO.FilterLinkButton" name="FilterReceiver"> <option name="fValue">isFieldLink</option> <option name="fText">'+n(i(rk("Получателю")))+'</option> <option name="fTitle">ФильтрПолучатель</option> </component> </div> <div class="FilterSubdivision padding32" style="display:none;"> <component data-component="SBIS3.EDO.FilterLinkButton" name="FilterSubdivision"> <option name="fValue">isFieldLink</option> <option name="fText">'+n(i(rk("Офису")))+'</option> <option name="fTitle">ФильтрПодразделение</option> </component> </div> <div class="FilterPhase  padding32" style="display:none;"> <component data-component="SBIS3.EDO.FilterLinkButton" name="FilterPhase"> <option name="fValue">isFieldLink</option> <option name="fText">'+n(i(rk("Этапу")))+'</option> <option name="fTitle">ФильтрФаза</option> <options name="excludedFilters" type="array"> <option>ФильтрСостояние:0,1</option> </options> </component> </div> <div class="FilterIdPhase  padding32" style="display:none;"> <component data-component="SBIS3.EDO.FilterLinkButton" name="FilterPhase"> <option name="fValue">isFieldLink</option> <option name="fText">'+n(i(rk("Этапу")))+'</option> <option name="fTitle">ФильтрИдФазы</option> <options name="excludedFilters" type="array"> <option>ФильтрСостояние:0,1</option> </options> </component> </div> <div class="divTemplatedAreaBottom"> </div> </div>');return(p=n(p))+(e&&-1!==p.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.FiltersKit"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.FiltersKit", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".padding16{padding-left:16px}.padding32{padding-left:32px}.btnAllDocs{text-decoration:underline}.btnAllDocs:hover{color:#ff7033!important}"));head.appendChild(style);});}
define("html!SBIS3.EDO.FilterDropdown",function(){var n=function(n){var o=function(){var n=/\{\{([\s\S]+?)\}\}/g;return function(o){for(;n.test(o);)o=o.replace(n,"&#123;&#123;$1&#125;&#125;");return o}}(),t=function(n){return n.join?n.join(""):n.toString()},e=function(n){return void 0===n?"":n&&"object"==typeof n?t(n):""+n},r="undefined"!=typeof process,i=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="divFilterDropDown" style="width:auto;"> <div class="divCaption"> <component data-component="Deprecated/Controls/LinkButton/LinkButton" name="ButtonCaption"> <option name="caption">'+o(e(n.btnCaption))+'</option> </component> </div> <div class="divDropDown"> </div> </div>');return(i=o(i))+(r&&-1!==i.indexOf("{{")?String.fromCharCode(8203,8203):"")};return n.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.FilterDropdown"}},n});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.FilterDropdown", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".divFilterDropDown{width:248px}.divCaption{height:24px;padding-left:32px}.divDropDown{padding-left:40px;display:none}.DropListLine{height:24px;position:relative;white-space:nowrap}.divInlineBlock{display:inline-block}.divSeparator{display:inline-block;position:relative;top:-6px;left:0}.divPoint{color:#999;display:inline-block;position:absolute;top:4px;left:0}.divSpace16{margin-left:24px}.DropListItem{padding-left:8px}"));head.appendChild(style);});}
define('js!SBIS3.EDO.FilterDropdown',['SBIS3.CONTROLS/CompoundControl','Deprecated/Controls/LinkButton/LinkButton','html!SBIS3.EDO.FilterDropdown','css!SBIS3.EDO.FilterDropdown','Deprecated/Controls/Button/Button','Elektronnyj_dokumentooborot_localization'],function(t,e,i){'use strict';var a=t.extend({_dotTplFn:i,$protected:{_options:{name:'FilterDropdown',btnCaption:rk('кнопка'),filterName:'fn ',excludedFilters:[],data:[]}},$constructor:function(){this._publish('onSelectFilter');},setBtnCaption:function(t){this.getChildControlByName('ButtonCaption').setCaption(t);},setData:function(t){this._options.data=t,this._redrawValues();},getFSettingsByNameAndValue:function(t,e){for(var i=this,a={},n=0;n<i._options.data.length;n++){var o=i._options.data[n].alternativeFilter||i._options.filterName;if(o==t)if(i._options.data[n].isMul){var s=i._options.data[n].key.split(';'),l=i._options.data[n].value.split(';'),d=[];if(i._options.data[n].valueOnSelect)d=i._options.data[n].valueOnSelect.split(';');for(var r in s)if(s[r]==e){if(a['title']=o,a['value']=s[r],a['textValue']=d[r]||l[r]||s[r],i._options.data[n].excludedFilters)a['excludedFilters']=i._options.data[n].excludedFilters;return a;}}else if(i._options.data[n].key==e){if(a['title']=o,a['value']=i._options.data[n].key,a['textValue']=i._options.data[n].valueOnSelect||i._options.data[n].value||i._options.data[n].key,i._options.data[n].excludedFilters)a['excludedFilters']=i._options.data[n].excludedFilters;return a;}}return;},init:function(){a.superclass.init.call(this);var t=this,e=t.getChildControlByName('ButtonCaption');this._redrawValues(),e.subscribe('onClick',function(){var e=t.getContainer().find('.divDropDown');if(e.is(':visible'))e.hide();else e.show();}),this.subscribe('onSelectFilter',function(t,i,a,n){e._notify('onClick');});},_renderValueItem:function(t,i){var a=this,n=$('<div class="DropListLine"></div>'),o=a._options.data[i].alternativeFilter||a._options.filterName;if(a._options.data[i].isMul){var s=a._options.data[i].key.split(';'),l=a._options.data[i].value.split(';'),d=[];if(a._options.data[i].valueOnSelect)d=a._options.data[i].valueOnSelect.split(';');for(var r in s)if(s.hasOwnProperty(r))(function(t){var r=l[t]||s[t];if(t>0)n.append('<div class="divSeparator">&nbsp;/&nbsp;</div>');else n.append('<div class="divSeparator divSpace16"></div>');new e({element:$('<div class="divInlineBlock"></div>').appendTo(n),caption:r}).subscribe('onClick',function(){var e={};if(e['title']=o,e['value']=s[t],e['textValue']=d[t]||r,a._options.data[i].excludedFilters)e['excludedFilters']=a._options.data[i].excludedFilters;a._notify('onSelectFilter',e);});}(r));}else{var p=a._options.data[i].value||a._options.data[i].key;n.append('<div class="divPoint">\u2022</div>'),new e({element:$('<div class="DropListItem"></div>').appendTo(n),caption:p}).subscribe('onClick',function(){var t={};if(t['title']=o,t['value']=a._options.data[i].key,t['textValue']=a._options.data[i].valueOnSelect||p,a._options.data[i].excludedFilters)t['excludedFilters']=a._options.data[i].excludedFilters;a._notify('onSelectFilter',t);});}t.append(n);},_redrawValues:function(){var t=this.getContainer().find('.divDropDown');t.empty();for(var e in this._options.data)if(this._options.data.hasOwnProperty(e))this._renderValueItem(t,e);}});return a;});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.FilterView", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".filter-view-stat .ws-FilterView__link{text-align:left;padding-left:128px}"));head.appendChild(style);});}
define('js!SBIS3.EDO.FilterView',['Deprecated/Controls/FilterView/FilterView','html!Deprecated/Controls/FilterView/FilterView','css!SBIS3.EDO.FilterView','i18n!SBIS3.EDO.FilterView','Elektronnyj_dokumentooborot_localization'],function(e,t){'use strict';var i=e.extend({$protected:{_options:{autoHeight:true,linkText:{emptyFilterText:rk('Все документы...'),filledFilterText:rk('другие параметры...')}}},_dotTplFn:t,$constructor:function(){},init:function(){i.superclass.init.call(this);}});return i;});
define('js!SBIS3.EDO.FiltersKit',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.FiltersKit','css!SBIS3.EDO.FiltersKit','js!SBIS3.EDO.FilterDropdown','Deprecated/Controls/Button/Button','js!SBIS3.EDO.FilterLinkButton','js!SBIS3.EDO.FilterView','Deprecated/Controls/LinkButton/LinkButton','Deprecated/Controls/Label/Label','Deprecated/Controls/TemplatedArea/TemplatedArea','i18n!SBIS3.EDO.FiltersKit','Elektronnyj_dokumentooborot_localization'],function(t,i){'use strict';var e=t.extend({_dotTplFn:i,$protected:{_options:{name:'FiltersKit',linkTitle:rk('Все документы'),filtersSet:[],filterStateData:[]},_baseFilters:['FilterState','FilterFace1','FilterResponsibleFace','FilterOurOrganisation','FilterAuthorOrResponsible','FilterEventPerformer','FilterTypeDocVD','FilterAuthor','FilterSender','FilterSubdivision','FilterPhase','FilterIdPhase','FilterOverdue','FilterShortState','FilterOwner','FilterOwnerUnit','FilterAuthor1','FilterResponsibleFace1','FilterListDispatch1','FilterRegulations','FilterIDRegulations','FilterTransition','FilterDeleted','FilterListDispatch','FilterLimitation','FilterPosted','FilterSpecificPerformer','FilterPriority','FilterAuthorOrResponsibleMe','FilterUnfixed','FilterPayment','FilterShipping','FilterUnanswered','FilterDraft','FilterDraftShort','FilterLimitationDate','FilterMilestone','FilterReceiver']},$constructor:function(){this._publish('onSelectFilter'),this._publish('onTitleClick');},_toggleCaption:function(){var t=-1!=Array.indexOf(this._options.filtersSet,'FilterState')||-1!=Array.indexOf(this._options.filtersSet,'FilterShortState')||-1!=Array.indexOf(this._options.filtersSet,'FilterDeleted')||-1!=Array.indexOf(this._options.filtersSet,'FilterPosted')||-1!=Array.indexOf(this._options.filtersSet,'FilterShipping')||-1!=Array.indexOf(this._options.filtersSet,'FilterUnanswered');this.getContainer().find('.divCaption1').toggle(t);var i=-1!=Array.indexOf(this._options.filtersSet,'FilterFace1')||-1!=Array.indexOf(this._options.filtersSet,'FilterResponsibleFace')||-1!=Array.indexOf(this._options.filtersSet,'FilterOurOrganisation')||-1!=Array.indexOf(this._options.filtersSet,'FilterPriority')||-1!=Array.indexOf(this._options.filtersSet,'FilterAuthorOrResponsible')||-1!=Array.indexOf(this._options.filtersSet,'FilterEventPerformer')||-1!=Array.indexOf(this._options.filtersSet,'FilterTypeDocVD')||-1!=Array.indexOf(this._options.filtersSet,'FilterAuthor')||-1!=Array.indexOf(this._options.filtersSet,'FilterSender')||-1!=Array.indexOf(this._options.filtersSet,'FilterSubdivision')||-1!=Array.indexOf(this._options.filtersSet,'FilterPhase')||-1!=Array.indexOf(this._options.filtersSet,'FilterOverdue')||-1!=Array.indexOf(this._options.filtersSet,'FilterLimitationDate')||-1!=Array.indexOf(this._options.filtersSet,'FilterOwner')||-1!=Array.indexOf(this._options.filtersSet,'FilterAuthorOrResponsibleMe')||-1!=Array.indexOf(this._options.filtersSet,'FilterOwnerUnit')||-1!=Array.indexOf(this._options.filtersSet,'FilterAuthor1')||-1!=Array.indexOf(this._options.filtersSet,'FilterResponsibleFace1')||-1!=Array.indexOf(this._options.filtersSet,'FilterListDispatch1')||-1!=Array.indexOf(this._options.filtersSet,'FilterRegulations')||-1!=Array.indexOf(this._options.filtersSet,'FilterIDRegulations')||-1!=Array.indexOf(this._options.filtersSet,'FilterTransition')||-1!=Array.indexOf(this._options.filtersSet,'FilterListDispatch')||-1!=Array.indexOf(this._options.filtersSet,'FilterMilestone')||-1!=Array.indexOf(this._options.filtersSet,'FilterReceiver')||-1!=Array.indexOf(this._options.filtersSet,'FilterSpecificPerformer')||-1!=Array.indexOf(this._options.filtersSet,'FilterUnfixed')||-1!=Array.indexOf(this._options.filtersSet,'FilterPayment');this.getContainer().find('.divCaption2').toggle(i);},_makeVisible:function(t,i){this.getContainer().find(t).toggle(i);},setLinkTitle:function(t){if(t)this._makeVisible('.divLinkButtonAll',true),this.getChildControlByName('LinkButtonAll').setCaption(t);else this._makeVisible('.divLinkButtonAll',false);},setFiltersSet:function(t){this._options.filtersSet=t;for(var i=0;i<this._baseFilters.length;i++)this._makeVisible('.'+this._baseFilters[i],Array.indexOf(t,this._baseFilters[i])>=0);this._toggleCaption();},setFilterData:function(t,i){if(this.hasChildControlByName(t))this.getChildControlByName(t).setData(i);},setHidePerformer:function(t){this._makeVisible('.divListDispatch',!t);},setHideAuthor:function(t){this._makeVisible('.divAuthor',!t);},setHideDraft:function(t,i){if(t)this._makeVisible('.divDraft',!t),this._makeVisible('.divDraftShort',!t);else if(i)this._makeVisible('.divDraftShort',!t),this._makeVisible('.divDraft',t);else this._makeVisible('.divDraft',!t),this._makeVisible('.divDraftShort',t);},setHideDeadline:function(t){this._makeVisible('.divDeadline',!t);},setShowNoPerformer:function(t){this._makeVisible('.divNoPerformer',t);},setFieldLinkTitle:function(t,i){if(''!==i)if(this.hasChildControlByName(t))this.getChildControlByName(t).setFText(i);},setFilterValue:function(t,i){if(this.hasChildControlByName(t))this.getChildControlByName(t).setFValue(i);},subscribeChildrenSelectFilter:function(t){for(var i=this,e=t.getChildControls(),r=0;r<e.length;r++)if(e[r].hasEvent('onSelectFilter'))e[r].subscribe('onSelectFilter',function(t,e){i._notify('onSelectFilter',e);});},init:function(){e.superclass.init.call(this);for(var t=this,i=0;i<t._baseFilters.length;i++)if(t.hasChildControlByName(t._baseFilters[i]))t.getChildControlByName(t._baseFilters[i]).subscribe('onSelectFilter',function(i,e){t._notify('onSelectFilter',e);});t.getChildControlByName('FilterOverdue').subscribe('onSelectFilter',function(i,e){t._notify('onSelectFilter',e);}),this.getChildControlByName('LinkButtonAll').subscribe('onClick',function(){t._notify('onTitleClick');});}});return e;});
define("html!SBIS3.EDO.PhaseDictForFilter",function(){var o=function(o){var t=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;o.test(t);)t=t.replace(o,"&#123;&#123;$1&#125;&#125;");return t}}(),e=function(o){return o.join?o.join(""):o.toString()},n=function(o){return void 0===o?"":o&&"object"==typeof o?e(o):""+o},i="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div> <div class="edo-PhaseDictForFilter" style="width:450px;height:auto;"> ');return o.multiSelect&&(a+=' <div class="ws-window-titlebar-custom"> <component data-component="Deprecated/Controls/Button/Button"> <option name="name">multiSelectButton</option> <option name="className">edo-PhaseDictForFilter__multiSelectButton</option> <option name="defaultButton">true</option> <option name="caption">Выбрать</option> <option name="visible">false</option> </component> </div> '),a+=" ",o.useSearch&&(a+=' <component data-component="Deprecated/Controls/SearchString/SearchString"> <option name="name">searchString</option> <option name="className">edo-PhaseDictForFilter__searchString '+t(n(o.searchStringCssClass))+'</option> <option name="linkedBrowser">'+t(n(o.linkedBrowserName))+'</option> <option name="filterName">Название</option> <option name="useBrowserFilter">false</option> <option name="startSearch">'+t(n(o.startSearch))+'</option> <option name="tooltip">'+t(n(o.searchTooltip))+'</option> <option name="resetRoot">true</option> </component> '),a+=' <component data-component="SBIS3.CONTROLS/DataGridView" class="edo-RulesList_tree"> <option name="name">'+t(n(o.linkedBrowserName))+'</option> <option name="autoHeight">true</option> <option name="autoWidth">true</option> <option name="useCurrentFilterOnMove">false</option> <option name="allowEdit">false</option> <option name="allowMove">false</option> <option name="allowDelete">false</option> <option name="editMode">newFloatArea</option> <option name="folderLinkAction">open</option> <option name="multiSelect">'+t(n(o.multiSelect))+'</option> <options name="itemsActions" type=\'array\' value="null"></options> <option name="displayProperty">'+t(n(rk("Название")))+'</option> <option name="emptyHTML">'+t(n(rk("Нет данных")))+'</option> <option name="showHead">false</option> <options name="columns" type="array"> <options> <option name="title">'+t(n(rk("Название")))+'</option> <option name="field">Название</option> <option name="highlight">true</option> <option name="width">395</option> <option name="fixedSize">true</option> </options> </options> </component> </div> </div>',(a=t(a))+(i&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.PhaseDictForFilter"}},o});
define('js!SBIS3.EDO.PhaseDictForFilter',['WS.Data/Source/SbisService','Core/helpers/fast-control-helpers','SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.PhaseDictForFilter','Deprecated/Controls/Button/Button','Deprecated/Controls/SearchString/SearchString','SBIS3.CONTROLS/DataGridView','Elektronnyj_dokumentooborot_localization'],function(e,t,r,a){'use strict';var s=r.extend({_dotTplFn:a,$protected:{_options:{name:'PhaseDictForFilters',linkedBrowserName:'PhasesForRules',useSearch:false,searchTooltip:rk('найти...'),startSearch:3,searchStringCssClass:'',multiSelect:false},_tree:void 0},$constructor:function(){},init:function(){s.superclass.init.call(this);var r=this,a=[],i=new e({endpoint:'Regulation'});r._tree=r.getChildControlByName('PhasesForRules');var o=r.getLinkedContext().getValue('ИдРегламента');if(o)if(Array.isArray(o))a=o;else a.push(o);i.call('PhaseList',{reg_uuids:a,name_mask:''}).addCallback(function(e){if(e.getRow().get('Фазы')){var t=e.getRow().get('Фазы').at(0).get('Фазы'),a=e.getRow().get('Фазы').at(0).get('ИдРегламента');t.addField({name:'ИдентификаторСРегламентом',type:'string'}),t.addField({name:'ИдРегламентаИдФазы',type:'string'});for(var s=0;s<t.getCount();s++)t.at(s).set('ИдентификаторСРегламентом',a+':'+t.at(s).get('Идентификатор')),t.at(s).set('ИдРегламентаИдФазы',a+':'+t.at(s).get('Идентификатор'));r._tree.setItems(t);}}).addErrback(function(e){t.alert(e.details,{},r.getTopParent());});}});return s.title='Этапы',s;});
define('js!SBIS3.EDO.EdoHandlers',['Core/core-functions','Core/core-instance','WS.Data/Source/SbisService','Core/helpers/fast-control-helpers','Core/Indicator','Core/Deferred','Core/WindowManager','WS.Data/Utils','Lib/ServerEvent/Bus','i18n!SBIS3.EDO.EdoHandlers','Elektronnyj_dokumentooborot_localization'],function(cFunctions,cInstance,SbisService,fcHelpers,Indicator,cDeferred,WindowManager){'use strict';var EdoHandlers={timeOut:100,updateCountersTimeout:15000,calcCounters:null,deSerializeString:function(val){var filter={};try{filter=eval(val);}catch(e){}if(filter&&filter['ФильтрДатаС'])filter['ФильтрДатаС']=new Date(filter['ФильтрДатаС'].replace(/(\d+).(\d+).(\d+)/,'$3/$2/$1'));if(filter&&filter['ФильтрДатаП'])filter['ФильтрДатаП']=new Date(filter['ФильтрДатаП'].replace(/(\d+).(\d+).(\d+)/,'$3/$2/$1'));return filter;},setDocBookmark:function(e){if(e)for(var t=e.getChildControls(),n=0;n<t.length;n++)if(cInstance.instanceOfModule(t[n],'Deprecated/Controls/TabButtons/TabButtons')){var a=t[n].getCurrentTab();if(''!==a&&'ОткрытьЗакладкуДокументы'!==a)t[n].setCurrentTab('ОткрытьЗакладкуДокументы');}},onReadyDialog:function(e){var t=this;t._controllerEDO.subscribe('onCreateConnectedDoc',function(e,n,a,r,i,o){var c=new cDeferred();e.setResult(c);var l=t.getLinkedContext().getFieldOrigin('@Документ').getValue('@Документ');new SbisService({endpoint:'Документ'}).call('НайтиСвязанныйДокумент',{'ДокументОснование':l,'ВидСвязи':i}).addCallback(function(e){if(e.getRawData()>-1)new SbisService({name:n}).call('Прочитать',{'ИдО':e,'ИмяМетода':n+'.'+a}).addCallback(function(e){c.callback(e.getRawData());});else c.callback();});});},onAfterShow:function(e){},readFix:function(e,t){setTimeout(function(){EdoHandlers.fixDoc(e);},EdoHandlers.timeOut);},saveEditableDoc:function(e,t){Indicator.hide();var n=e?e.getTopParent().getLinkedContext().getRecord():WindowManager.getActiveWindow().getTopParent().getLinkedContext().getRecord(),a=new cDeferred(),r=window;if(window.DispatcherEDO&&window.DispatcherEDO.getActive())r=window.DispatcherEDO.getActive();Indicator.show();var i=function(){var n=t?r.sdsMain:r.sdsCurrent;if(void 0!==n&&null!==n.model)return n.setContextData('Документ',e.getTopParent().getLinkedContext().getRecord()),n.saveDocument().addCallback(function(){a.callback(),Indicator.hide();}).addErrback(function(e){a.errback(e),Indicator.hide();});else Indicator.hide(),a.callback();};if(n&&(n.isChanged()||t||Boolean(e&&e.isNewRecord())))n.update({diffOnly:Boolean(e&&!e.isNewRecord())}).addCallback(i).addErrback(function(e){a.errback(e),Indicator.hide();});else i();return a;},onSave:function(e){var t=this.getRecord().hasColumn('ДокументРасширение.Учитывается')?this.getRecord().get('ДокументРасширение.Учитывается'):false,n=this.getTopParent(),a=this,r=a.getOpener(),i=this.getLinkedContext().getRecord(),o=new cDeferred();if(e.setResult(o),!t)return void o.dependOn(i.update());else EdoHandlers.saveEditableDoc(a).addCallback(function(){o.callback();}).addErrback(function(e){o.errback(e.message),Indicator.hide(),cFunctions.alert(e.message,'','error');});},onSaveGenerateAll:function(e,t){EdoHandlers.onSaveGenerate.apply(this,[e,t,false]);},onSaveGenerate:function(e,t,n){var a=this.getTopParent().getRecord(),r=false===n?false:true,i=new cDeferred(),o=t||a&&a.isChanged();if(a&&a.hasColumn('@Документ'))if(o){e.setResult(i);var c=new SbisService({endpoint:'ОсновнойРедактируемыйДокумент'}),l=a.update({diffOnly:r}).addCallback(function(){return c.call('Сгенерировать',{'ключДокумента':parseInt(a.get('@Документ'),10)});}).addErrback(function(e){i.errback(rk('Ошибки при сохранении документа')+': '+e.message);});i.dependOn(l);}},fixDoc:function(e){var t=e.getContext();if(!t)return;var n=e.getRecord(),a=null,r=null;if(n&&n.hasColumn('@Документ'))a=n.get('@Документ');if(n&&n.hasColumn('Просмотрен'))r=n.get('Просмотрен');if(true!==r&&a)if(new SbisService({endpoint:'Документ'}).call('Фиксация',{'ИдО':parseInt(a,10)}).addCallback(function(){var t=e.getOpener&&e.getOpener()?e.getOpener():false;if(t&&cInstance.instanceOfModule(t,'SBIS3.EDO2.OpenDialogAction'))t._notify('onFixDoc');}),true===e.isNewRecord()){var i=n.isChanged();if(t.setValue('Просмотрен',true),!i)n.commit();}},onBeforeShowFirstTab:function(e){},getInn:function(e){var t=e.getRecord(),n,a,r='';if(t.hasColumn('ТипДокумента.Раздел')){var i=t.get('ТипДокумента.Раздел');if('-3'==i){if(t.hasColumn('РП.НОИНН'))n=t.get('РП.НОИНН');if(t.hasColumn('ДокументНашаОрганизация.Контрагент.КПП'))a=t.get('ДокументНашаОрганизация.Контрагент.КПП');}if('-2'==i){if(t.hasColumn('Контрагент.ИНН'))n=t.get('Контрагент.ИНН');if(t.hasColumn('Контрагент.КПП'))a=t.get('Контрагент.КПП');}r=a?n+','+a:n;}return void 0!==r?r:'';},checkDescription:function(){var e=this.getValue();if(e&&''!==e.replace(/\s/g,''))return true;else return rk('Введите описание');},onChangeFace1:function(e,t){try{var n=this.getLinkedContext().getFieldOrigin('@Документ'),a=parseInt(n.getValue('ДокументНашаОрганизация'),10),r=parseInt(n.getValue('Лицо1'),10);if('ДокументНашаОрганизация'===this.getName())a=parseInt(t[0].hasColumn('@Лицо')?t[0].get('@Лицо'):t[0].getKey(),10);else if('Лицо1'===this.getName())r=parseInt(t[0].hasColumn('@Лицо')?t[0].get('@Лицо'):t[0].getKey(),10);if(r&&a)if(a===r)e.setResult(false),fcHelpers.alert(rk('Отправитель и получатель документа должны отличаться!'),{},this);}catch(e){}}};return EdoHandlers;});
define('js!SBIS3.EDO.EdoReestrHandlers',['Core/core-functions','Core/core-attach','Transport/BLObject','Core/helpers/fast-control-helpers','Core/Indicator','Core/EventBus','Core/Context','Core/ParallelDeferred','Core/Deferred','Core/constants','js!SBIS3.EDO.Employee','js!SBIS3.EDO2.OpenDialogAction','i18n!SBIS3.EDO.EdoReestrHandlers','Elektronnyj_dokumentooborot_localization'],function(e,r,t,n,a,l,o,i,s,f,d){'use strict';var c;return c={eraseSelectedDocs:function(n,l,o){var i=l&&'ido_field'in l?l.ido_field:'@Документ',s=l&&'number_field'in l?l.number_field:'Номер',f=l&&'del_field'in l?l.del_field:'Удален',d=l&&'doctype_field'in l?l.doctype_field:'ТипДокумента.ТипДокумента';r.attachInstance('Deprecated/Controls/DialogConfirm/DialogConfirm',{resizable:false,message:rk('Восстановление документа будет невозможно. Продолжить?'),handlers:{onConfirm:function(r,l){if(l){a.setMessage(rk('Удаление')+'...');var u=function(r,a){if(a>=r.length)c.deferredBrowserReload(n,o);else if(r[a].hasColumn(i)&&r[a].hasColumn(f)&&r[a].get(f)&&r[a].hasColumn(d)&&r[a].get(d)&&r[a].get(d).length>0)new t(r[a].get(d)).call('Удалить',{'ИдО':parseInt(r[a].get(i),10)},t.RETURN_TYPE_ASIS).addCallback(function(e){u(r,a+1);}).addErrback(function(t){if(c.deferredBrowserReload([],o),403!==t.httpError)e.alert(rk('Не удалось удалить документ')+' \u2116'+r[a].get(s)+': '+t.message,'error');});else u(r,a+1);};u(n,0);}}}});},onDeleteStart:function(e,r){var t=r[0],n=this,a;if(t.hasColumn('Удален')&&t.get('Удален'))c.eraseSelectedDocs(r,null,n),e.setResult(false);else if(1===r.length)if(a=t.get('ДокументРасширение.Состояние'),a.get('Запущен')&&!a.get('Завершен'))e.setResult(rk('Документ находится в обработке. Вы действительно хотите удалить документ?'));else e.setResult(rk('Удалить документ?'));else e.setResult(rk('Удалить документы?'));},deleteToTrash:function(o,f,d){var c=d&&'ido_field'in d?d.ido_field:'@Документ',u=d&&'number_field'in d?d.number_field:'Номер',h=new s();a.setMessage(rk('Удаление')),a.show();var g=t('Документ'),C=f instanceof Array,p=[],k=function(e,r){var t=[2,0,1,1,1,2];return r[e%100>4&&e%100<20?2:t[e%10<5?e%10:5]];},v=function(n,l){var i=new s(),f=n.hasColumn('МетодУдаления')&&n.get('МетодУдаления')&&n.hasColumn('@Событие')&&n.get('@Событие'),d=f?n.get('МетодУдаления'):'НаУдалить',v={'ИдО':n.hasColumn('ИдРедакции')&&n.get('ИдРедакции')?parseInt(n.get('ИдРедакции'),10):parseInt(n.get(c),10)},m=function(){if(f)v['идСобытия']=n.get('@Событие');i.dependOn(g.call(d,v,t.RETURN_TYPE_ASIS).addCallback(function(r){if(!C)a.hide();if(''!==r)C?p.push('\u2116'+n.get(u)+': '+r):e.alert(r,'','error');}).addErrback(function(r){a.hide(),e.alert(r.message,'error');}));},_=function(r){return g.call(d,{'ИдО':r},t.RETURN_TYPE_ASIS).addCallback(function(r){if(''!==r)C?p.push('\u2116'+n.get(u)+': '+r):e.alert(r,'','error');}).addErrback(function(r){a.hide(),e.alert(r.message,'error');});},R=function(e,r){var t=e.createDependent();return t.addBoth(function(){return _(r);}),t;},E=function(){new t('ПапкаДокументов').call('СписокВложенных',{'Папка':parseInt(n.getKey(),10)},t.RETURN_TYPE_RECORDSET).addCallback(function(e){for(var r=[],t=[],n=[],a=0;a<e.getRecordCount();a++)e.at(a).get('Раздел@')?t.push(e.at(a).get('@Документ')):r.push(e.at(a).get('@Документ'));for(r=r.concat(t),a=0;a<r.length;a++)if(0===a){var l=_(r[a]);n.push(l);}else{var o=R(n[a-1],r[a]);n.push(o);}if(n&&n.length>0)i.dependOn(n[n.length-1]);}).addErrback(function(r){e.alert(r.message,'error');});};if(l>0){var b=(1==l?rk('Папка содержит'):l+' '+k(l,[rk('папка содержит'),rk('папки содержат'),rk('папок содержат')]))+' '+rk('записи, которые будут удалены. Продолжить удаление?');r.attachInstance('Control/Area:DialogConfirm',{message:b,height:207,width:395,type:'alert',opener:o,handlers:{onConfirm:function(e,r){if(r)h.callback(true);else h.callback(false);}}});}if(n.isBranch()&&true===n.hasChildren())h.addCallback(function(e){if(true===e)E();else i.callback();return e;});else m();return i;},m=[];if(C){for(var _=new i(),R=0,E=0,b=f.length;E<b;E++){var S=f[E],D=false;try{D=S.get('РП.Документ').get('РазрешенныеДействия').get('Удаление');}catch(e){D=false;}if(D)p.push('\u2116'+S.get(u)+': '+rk('У текущего пользователя нет прав на удаление документов!'));else{if(S.isBranch()&&true===S.hasChildren())++R;if(E>=b-1)_.push(v(S,R));else _.push(v(S));}m.push(S.getKey());}return _.done().getResult().addCallback(function(){if(a.hide(),p.length>0)n.openErrorsReportDialog({numSelected:f.length,numSuccess:parseInt(f.length,10)-parseInt(p.length,10),errors:p,title:rk('Итоги операции')+': "'+rk('Удаление документов')+'"'});if(o.clearSelection)o.clearSelection(m);if(o.reload)o.reload();l.channel('DeleteChannel').notify('deleteToTrash',m);});}else return v(f).addCallback(function(e){o.reload(),m.push(f.getKey()),l.channel('DeleteChannel').notify('deleteToTrash',m);});},onBeforeDelete:function(e,r){var t=this;c.deleteToTrash(t,r),e.setResult(false);},onReadyForInitUserHint:function(e){var r=this,t=r.getContainer();if(true===o.global.getValue('needCursorFirst')){var n=r.getContainer().find('tr').eq(1);if(n.length)r.setActiveRow(n);o.global.setValue('needCursorFirst',false);}var a=t.find('div.user_div');if(a.length)for(var l=0;l<a.length;l++){var i=a.eq(l);if(i.attr('user_id')&&-1===i.html().indexOf('Список')&&-1===i.html().indexOf('Внутреннее'))i.attr('id','hintId_forUser_'+l),i.parents('td.ws-browser-cell').eq(0).click(function(e){var r=$(this).find('.name_and_office_div').eq(0),t=r.attr('id'),n=r.attr('user_id'),a=r.attr('current_status');e.stopPropagation();var l={nameControl:t,onlyClick:true},o={facePk:n,current_status:a?a:rk('Текущий исполнитель'),fio:null,sign:false};f.initControl(o,l);});}},OnAnswerClick:function(e,r,t){var n=$(t).wsControl();new d().execute({id:r}),e.stopPropagation();},deferredBrowserReload:function(e,r){a.hide();var t=r||getCurrentBrowser();if(t){for(var n=[],l=0;l<e.length;l++)n.push(e[l].hasColumn('@Событие')?e[l].get('@Событие'):e[l].get('@Документ'));t.clearSelection(n),t.reload();}}};});
define('js!SBIS3.EDO.EdoRecOptionsMini',['WS.Data/Source/SbisService','Core/Indicator','Core/EventBus','SBIS3.CONTROLS/Utils/InformationPopupManager','Elektronnyj_dokumentooborot_localization'],function(e,t,o,a){'use strict';return{copyRecord:function(n,i){var r=i.get('@Документ')?i.get('@Документ'):i.get('Документ.@Документ')?i.get('Документ.@Документ'):false;require(['js!SBIS3.EDO2.OpenDialogAction'],function(i){t.setMessage(rk('Копирование записи')+'...'),new e({endpoint:'СлужЗап'}).call('Копировать',{'ИдО':parseInt(r,10)}).addCallback(function(t){var a=t.getRow().has('РазличныеДокументы.БазовыйДокумент')?t.getRow().get('РазличныеДокументы.БазовыйДокумент'):null;if(r=t.getRow().has('@Документ')?t.getRow().get('@Документ'):t.getRow().get('Документ.@Документ'),a)new e({endpoint:'СлужЗап'}).call('КоличествоПодзадач',{'ИДДокумента':a,'ТипОперации':'inc'});if(r){new i().execute({id:r});var s=n.getTopParent();if(s&&s.hasChildControlByName('PartialReloader'))o.channel('EdoPartialReloader').notify('onCopyRecord',{id:n.getId(),docs:[parseInt(r,10)]});else n.reload();}}).addErrback(function(e){t.hide(),a.showMessageDialog({message:e.message,status:'error'});});});}};});
define('js!SBIS3.EDO.EdoServiceCommands',['Core/core-functions','Core/core-instance','WS.Data/Source/SbisService','Core/Deferred','Core/constants','SBIS3.CONTROLS/Action/SelectorAction','Elektronnyj_dokumentooborot_localization'],function(e,t,a,n,o,l){'use strict';var c={fShowDocTime:function(){for(var e=this,a=e.getLinkedContext().getValue('record'),n=a.get('@Документ'),l=a.get('Удален'),c=e.getTopParent().getChildControls(),r,d=0;d<c.length;d++)if(t.instanceOfModule(c[d],'SBIS3.EDO2.Dialog')){r=c[d];break;}if('Управление рабочим временем'in o.modules)require(['js!SBIS3.WTM.OpenTimeMark'],function(t){t({opener:e,docId:n,readOnly:l}).once('onExecuted',function(e,t,a){r.sendCommand('edoUpdateFullTrace');});});},fTaskAttachToTask:function(){var t=this,n=t.getLinkedContext(),o=n.getValue('record'),l=n.getValue('record').get('@Документ'),r=t.getLinkedContext().getValue('record'),d=false,i=t.getChildControlByName('EDOTaskDialog');if(i.sendCommand('submit'),t.validate())c.fSelectTask(t).addCallback(function(o){if(o){var c=parseInt(o.get('@Документ'),10),s=o.get('ТипДокумента.ТипДокумента');if(c!=l&&s)if(Array.indexOf(['Проект','Этап','Совещание'],s)>=0)new a({endpoint:'СлужЗап'}).call('ДобавитьВПроект',{'ИдЗадачи':l,'ИдПроекта':c}).addCallback(function(){t.getTopParent().getChildControlByName('OvertaskCrumbs').reloadData();});else if('ПланРабот'===s){var u=o.get('ДокументРасширение.Название'),f=o.get('Проект.ПланДатаНач'),C=o.get('Проект.ПланДатаКнц');require(['js!SBIS3.Plan.WorkPlans'],function(e){e.includeDocsToPlan([r],c,f,C,false).addCallback(function(){t.getTopParent().getChildControlByName('OvertaskCrumbs').reloadData();});});}else new a({endpoint:'Документ'}).call('ДобавитьПодзадачу',{'ИДЗадачи':c,'ИДПодзадачи':l}).addCallback(function(){if(r)d=r.isChanged();if(n.setValue('record/РазличныеДокументы.БазовыйДокумент',parseInt(c,10)),r&&!d)r.acceptChanges();t.getTopParent().getChildControlByName('OvertaskCrumbs').reloadData(),i.sendCommand('submit'),i.sendCommand('notify','onUpdateModel');}).addErrback(function(t){e.alert(t,'error');});}});},fTaskAttachToProject:function(){var e=this,t=e.getLinkedContext().getValue('record'),n=e.getChildControlByName('EDOTaskDialog');c.fSelectProject().addCallback(function(o){new a({endpoint:'СлужЗап'}).call('ДобавитьВПроект',{'ИдЗадачи':t.get('@Документ'),'ИдПроекта':o.projectID}).addCallback(function(){e.getTopParent().getChildControlByName('OvertaskCrumbs').reloadData().addCallback(function(){n.sendCommand('edoReloadLinkedDocs'),n.sendCommand('edoUpdateFullTrace'),n.sendCommand('notify','onUpdateModel');});});});},fTaskAttachToChecklist:function(){var e=this,t=e.getLinkedContext().getValue('record').get('@Документ'),a=e.getChildControlByName('EDOTaskDialog');require(['js!SBIS3.Examination.ExaminationSelector'],function(n){n.addTaskToExamination(t,e).addCallback(function(t){e.getTopParent().getChildControlByName('OvertaskCrumbs').reloadData().addCallback(function(){a.sendCommand('edoReloadLinkedDocs'),a.sendCommand('edoUpdateFullTrace'),a.sendCommand('notify','onUpdateModel');});});});},fTaskAttachToPlan:function(){var e=this,t=e.getLinkedContext().getValue('record'),a=e.getChildControlByName('EDOTaskDialog'),n=parseInt(t.get('@Документ'),10),o;c.fSelectPlan(e).addCallback(function(t){o=t.nameProj,e.getTopParent().getChildControlByName('OvertaskCrumbs').reloadData().addCallback(function(){a.sendCommand('edoReloadLinkedDocs'),a.sendCommand('edoUpdateFullTrace'),a.sendCommand('notify','onUpdateModel');});});},fTaskAttachToMeetings:function(){var t=this,o=t.getLinkedContext().getValue('record'),l=t.getChildControlByName('EDOTaskDialog'),r=o.get('@Документ'),d=new n();return c.fSelectMeetings(t).addCallback(function(n){var o=n.meetingId;new a({endpoint:'Документ'}).call('СвязатьДокументы',{'ДокументОснование':o,'ДокументСледствие':r,'ВидСвязи':1,'ВидСвязиДокумента':null}).addCallback(function(e){d.callback(e),t.getTopParent().getChildControlByName('OvertaskCrumbs').reloadData().addCallback(function(){l.sendCommand('edoReloadLinkedDocs'),l.sendCommand('edoUpdateFullTrace'),l.sendCommand('notify','onUpdateModel');});}).addErrback(function(t){e.alert(t,'error'),d.callback(false);});}),d;},fDocumentAttachToTask:function(){var t=this,o=t.getLinkedContext().getValue('record').get('@Документ'),l=new n();return c.fSelectTask(t).addCallback(function(t){var n=parseInt(t.get('@Документ'),10);new a({endpoint:'Документ'}).call('СвязатьДокументы',{'ДокументОснование':n,'ДокументСледствие':o,'ВидСвязи':1,'ВидСвязиДокумента':null}).addCallback(function(e){l.callback(e);}).addErrback(function(t){e.alert(t,'error'),l.callback(false);});}),l;},fDocumentAttachToProject:function(){var t=this.getLinkedContext().getValue('record').get('@Документ'),o=new n(),l;return c.fSelectProject().addCallback(function(n){l=n.projectID,new a({endpoint:'Документ'}).call('СвязатьДокументы',{'ДокументОснование':l,'ДокументСледствие':t,'ВидСвязи':1,'ВидСвязиДокумента':null}).addCallback(function(e){o.callback(e);}).addErrback(function(t){e.alert(t,'error'),o.callback(false);});}),o;},fDocumentAttachToPlan:function(){var e=this,t=e.getLinkedContext().getValue('record').get('@Документ'),a=new n();return c.fSelectPlan(e).addCallback(function(e){a.callback(e);}),a;},fSelectTask:function(e){var t=this,a,o=new n(),c=e.getLinkedContext().getValue('record').get('@Документ');return a=new l({mode:'floatArea',template:'js!SBIS3.EDO.TaskSelection',dialogOptions:{title:rk('Задачи'),className:'ws-float-area__block-layout'},componentOptions:{subTask:c},activableByClick:true}),a.execute({selectionType:'leaf',multiselect:false}),a.once('onExecuted',function(e,t,a){var n;if(a&&a.getCount())n=a.at(0),o.callback(n);}),o;},fSelectProject:function(){var e=this,t,a=new n();return t=new l({mode:'floatArea',template:'js!SBIS3.ProjectManagement.DialogProjectsWithWorks'}),t.execute({selectionType:'all',multiselect:false,componentOptions:{'БезЗадач':true,'БезЗавершенныхПроектов':true}}),t.once('onExecuted',function(e,t,n){var o,l;if(n&&n.getCount())l=(o=n.at(0)).getId(),a.callback({projectID:l});}),a;},fSelectPlan:function(e){var t=this,a,o=e.getLinkedContext().getValue('record'),c=parseInt(o.get('@Документ'),10),r=new n();return a=new l({mode:'floatArea',template:'js!SBIS3.Plan.PlanSelector'}),a.execute({multiselect:false,selectionType:'leaf',componentOptions:{'ВключенДокумент':c}}),a.once('onExecuted',function(e,t,a){if(a&&a.getCount()){var n=a.at(0).getId(),l=a.at(0).get('ДокументРасширение.Название'),c=a.at(0).get('Проект.ПланДатаНач'),d=a.at(0).get('Проект.ПланДатаКнц');require(['js!SBIS3.Plan.WorkPlans'],function(e){e.includeDocsToPlan([o],n,c,d,true).addCallback(function(){r.callback({nameProj:l});});});}}),r;},fSelectMeetings:function(){var e=this,t,a=new n();return t=new l({mode:'floatArea',template:'js!SBIS3.Meetings.MeetingsChoiceList'}),t.execute({}),t.once('onExecuted',function(e,t,n){var o,l;if(n&&n.getCount())l=(o=n.at(0)).get('IdMainDoc'),a.callback({meetingId:l});}),a;}};return c;});
define("html!SBIS3.EDO.FContract",function(){var o=function(o){var t=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;o.test(t);)t=t.replace(o,"&#123;&#123;$1&#125;&#125;");return t}}(),n=function(o){return o.join?o.join(""):o.toString()},e=function(o){return void 0===o?"":o&&"object"==typeof o?n(o):""+o},a="undefined"!=typeof process,i=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="FTaskControl"> <component data-component="SBIS3.EDO2.Dialog" name="EDOContractDialog"> <option name="objectName" value="'+t(e(o.objectName))+'"></option> <option name="stickyHeader">true</option> <option name="secondLineContent"> </option> <options name="fullTrace"> <option name="showToolbar">false</option> </options> <opt name="firstLineContent"> <component data-component="SBIS3.Contragents.ChoiceOurCompanyLink" class="edo-FContract_ChoiceOurCompanyLink"> <options name="componentOptions"> <opt name="ShowInnerCompany" value="true"></opt> <opt name="ourCompany" value="false"></opt> <opts name="ScopesAreas" type="array"> <opt value="'+t(e(o.scopeArea))+'"/> </opts> <opt name="ShowAllCompany" value="false"></opt> <opt name="withAffiliates" value="true"></opt> <option name="openCardCompany" bind="record/isOpenCardCompany" type="boolean"></option> </options> <opt name="className" value="controls-SelectorButton__asLink"></opt> <opt name="enabled">true</opt> <opt name="allowChangeEnable">false</opt> <opt name="multiselect" value="false"></opt> <opt name="idProperty" value="@Лицо"></opt> <opts name="selectedItem"> <opt name="@Лицо" bind="record/ДокументНашаОрганизация"></opt> <opt name="Название" bind="record/ДокументНашаОрганизация.Контрагент.Название"></opt> </opts> </component> </opt> <options name="tabs" type="array"> <options> <option name="className">myClass controls-TabButton__main-item</option> <option name="content"> <div style="width: 100%;"> <table style="table-layout: fixed; width: 100%;"> <colgroup> <col> <col width="202"> </colgroup> <tbody> <tr> <td class="edo-FContract_TaskControls"> <div> <component data-component="SBIS3.EDO.FContractControls"> <option name="labelCaption" value="'+t(e(o.labelCaption))+'"></option> <option name="placeholderCaption" value="'+t(e(o.placeholderCaption))+'"></option> <option name="tabindex" value="1"></option> </component> </div> </td> <td class="edo-FContract_sticker-container"> <div> <component data-component="SBIS3.EDO2.Sticker" name="ContractSticker"> <option name="tabindex" value="2"></option> <option name="mini">false</option> <option name="mayDeleteResponsible">false</option> <option name="showContractorInfo">true</option> </component> </div> </td> </tr> </tbody> </table> </div> <component data-component=\'SBIS3.EDO2.Spoiler\' class=\'edo-FContract__additional-fields\'> <opt name=\'leftPartTitleTpl\' value=\' \'></opt> <opt name=\'collapseHeight\'>180</opt> <opt name=\'expanded\' bind=\'record/enabled\' oneWay=\'true\'></opt> <opt name=\'contentTpl\'> <component data-component=\'SBIS3.EDO2.AdditionalFields.View\'> <opt name=\'area\'>177d7f75-15dc-4df2-a2a5-7114e16f0a5a</opt> </component> </opt> </component> <div class="edo-FContract_AttachTo"> <div class="edo-FContract_itembutton"> <component data-component="SBIS3.EDO2.AttachButton" name="AttachTo"> <option name="canAttachExternalLinks">true</option> </component> </div> <div class="edo-FContract_itembutton"> <component data-component="SBIS3.EDO2.CreateButton" name="CreateAttach"> </component> </div> <div class="edo-FContract_itembutton"> <component data-component="SBIS3.DOCVIEW.SwitchVisibilityMode" name="ModeSwitcher" class="edo-FContract_SwitchVisibility"> <option name="visible" bind="record/toggleFContractSwitchVisibilityMode" value="true" nonexistent="true" oneWay=\'true\'></option> <options name="hasSwitch"> <option name="bigPreview" value="true" type="boolean"></option> <option name="diskClassic" value="false" type="boolean"></option> <option name="classic" value="true" type="boolean"></option> </options> <options name="listOptions"> <options name="visibilityMode"> <option name="defaultMode">classic</option> <option name="setFromCookie">true</option> <option name="autoSelect">true</option> <option name="savedModeField">contractViewerCookieField</option> </options> </options> </component> </div> </div> <div class="edo-FContract_FullViewer"> <component data-component="SBIS3.EDO2.Viewer"> <option name="name">DocList</option> </component> </div> </option> <option name="id">firstTab</option> <option name="title"> <component data-component="SBIS3.EDO2.MainTabHeader"> <option name="docType">'+t(e(o.objectName))+"</option> </component> </option> </options> </options> </component> </div>");return(i=t(i))+(a&&-1!==i.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.FContract"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.FContract", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-FContract_sticker-container{vertical-align:top}.edo-FContract_TaskControls{padding-left:12px;padding-right:8px;padding-top:21px}.edo-FContract_AttachTo,.edo-FContract_TaskControls{margin-left:12px}.edo-FContract_AttachTo{height:24px}.edo-FContract_itembutton{float:left;margin-right:8px}.edo-FContract_FullViewer{margin-top:4px}.edo-FContract_Subtasks{padding-bottom:8px}.edo-FContract_Subtasks .edo-Subtasks{margin-top:8px}.edo-FContract_SwitchVisibility{float:right;margin-top:4px}.FTaskControl .edo-TaskControls_table{padding-top:18px}.edo-Dialog_header-secondLineContent{max-height:32px}.edo-FContract_TaskControls .edo-AddresseeChoiceNew__nameRender{font-weight:700}.edo-FContract_ChoiceOurCompanyLink{margin:8px 0;height:24px;float:right}.edo-FContract_ChoiceOurCompanyLink .controls-SelectorButton__cross{display:none}.edo-FContract__additional-fields{padding:8px 0 0 4px}"));head.appendChild(style);});}
define("html!SBIS3.EDO.FContractControls",function(){var o=function(o){var n=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;o.test(n);)n=n.replace(o,"&#123;&#123;$1&#125;&#125;");return n}}(),e=function(o){return o.join?o.join(""):o.toString()},t=function(o){return void 0===o?"":o&&"object"==typeof o?e(o):""+o},i="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="edo-TaskControls"> <div> <component data-component="SBIS3.CONTROLS/Link" name="ContractLink" class="ContractLink"> <option name="caption">'+n(t(o.labelCaption))+'</option> <option name="tabindex">0</option> </component> <component data-component="SBIS3.AddresseeChoice.FieldLink" name="ContractFieldLink" class="ContractFieldLink ws-autofocus"> <option name="selectedItems" bind="record/СписокРассылки"></option> <option name="placeholder">'+n(t(o.placeholderCaption))+'</option> <option name="allowContragentChoice">true</option> <option name="multiselect">true</option> <option name="favoritesOnly">false</option> <option name="tabindex">1</option> <option name="representativeChoice">false</option> <option name=\'saveParentRecordChanges\'>true</option> <options name="validators" type="array"> <options> <option name="errorMessage" value="'+n(t(o.placeholderCaption))+'"></option> <option name="validator" type="function">SBIS3.CONTROLS/Utils/ControlsValidators:required</option> <option name="option" value="selectedKeys"></option> </options> </options> <option name="autoShow">false</option> <options name="companyOptions"> <option name="forbidSelectFolder" type="boolean">true</option> </options> </component> </div> <div> <component data-component="SBIS3.CONTROLS/TextArea" name="ContractComment" class="ContractComment"> <option name="text" bind="record/ДокументРасширение.Название" value=""></option> <option name="tooltip" bind="record/ДокументРасширение.Название" value="" oneWay="true"></option> <option name="className" value="inner_text_fld border_top_none"></option> <option name="placeholder">'+n(t(rk("Комментарий")))+'</option> <option name="isRelative" value="true"></option> <option name=\'maxLinesCount\' value=\'5\'></option> <option name="tabindex" value="2"></option> <option name="visible" bind="record/commentFieldVivible" oneWay="true" nonexistent="false">false</option> </component> </div> </div>');return(a=n(a))+(i&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.FContractControls"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.FContractControls", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".ContractLink,.ContractLink:visited{color:#999}.ContractLink.controls-Link:not(.ws-disabled):hover{color:#ff7033}.ContractFieldLink{width:100%}.ContractFieldLink .controls-FieldLink__item-caption{color:#313e78;font-size:15px;font-weight:700}.ContractComment{width:100%;margin-top:8px}"));head.appendChild(style);});}
define('js!SBIS3.EDO.FContractControls',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.FContractControls','SBIS3.CONTROLS/Utils/ControlsValidators','css!SBIS3.EDO.FContractControls','SBIS3.CONTROLS/Link','js!SBIS3.AddresseeChoice.FieldLink','SBIS3.CONTROLS/TextArea','preload!optional!SBIS3.AddresseeChoice.Dialog','i18n!SBIS3.EDO.FContractControls','Elektronnyj_dokumentooborot_localization'],function(t,o){'use strict';var n;return n=t.extend({_dotTplFn:o,$protected:{_options:{}},$constructor:function(){},init:function(){var t=this;if(n.superclass.init.call(this),t.hasChildControlByName('ContractLink')&&t.hasChildControlByName('ContractFieldLink')){var o=t.getChildControlByName('ContractLink'),i=t.getChildControlByName('ContractFieldLink');t.subscribeTo(o,'onActivated',function(t){i.sendCommand('showSelector');});}}}),n;});
define('js!SBIS3.EDO.FContract',['Core/CommandDispatcher','js!SBIS3.EDO2.FormController','html!SBIS3.EDO.FContract','js!SBIS3.EDO.EdoServiceCommands','js!SBIS3.EDO2.Dialog','js!SBIS3.EDO2.Viewer','js!SBIS3.DOCVIEW.SwitchVisibilityMode','js!SBIS3.EDO2.MainTabHeader','js!SBIS3.EDO2.Sticker','SBIS3.CONTROLS/Menu/MenuLink','css!SBIS3.EDO.FContract','js!SBIS3.EDO.FContractControls','js!SBIS3.EDO2.AttachButton','js!SBIS3.EDO2.CreateButton','optional!js!SBIS3.Contragents.ChoiceOurCompanyLink','js!SBIS3.EDO2.Spoiler','js!SBIS3.EDO2.AdditionalFields.View','i18n!SBIS3.EDO.FContract','Elektronnyj_dokumentooborot_localization'],function(t,S,o,n){'use strict';var i=S.extend({_dotTplFn:o,$protected:{_options:{}},$constructor:function(){t.declareCommand(this,'fShowDocTime',n.fShowDocTime);},init:function(){i.superclass.init.call(this);}});return i;});
define('js!SBIS3.EDO.FContractModel',['Transport/Record','Transport/RecordSet','Core/constants','js!SBIS3.EDO2.EdoModel','WS.Data/Collection/RecordSet','WS.Data/Di','WS.Data/Adapter/Sbis','Elektronnyj_dokumentooborot_localization'],function(e,t,i,s,n,r){'use strict';var o=s.extend({_moduleName:'SBIS3.EDO.FContractModel',$protected:{_options:{userServiceCommands:[{id:'edoShowDocTime',icon:'sprite:icon-24 icon-Time icon-primary',className:'edo-Dialog_header-ServiceButtons_item',visible:!!('Управление рабочим временем'in i.modules),weight:70,caption:rk('Время по документу'),componentType:'SBIS3.CONTROLS/Button/IconButton',command:'fShowDocTime'}],properties:{toggleFContractSwitchVisibilityMode:{get:function(){var e=this&&this.get('РП.Документ'),t=this&&this.get('РП.ДополнительнаяИнформация')||e&&e.get('СписокВложений');return!!(t&&t.getCount()>0);}},commentFieldVivible:{get:function(){return this.getModelField('ДокументРасширение.Название')||this.getModelField('enabled');}},isOpenCardCompany:{get:function(){if(this.get('isEditing')||this.get('enabled'))return false;return true;}},'СписокРассылки':{get:function(){if(this.has('РП.СписокРассылки')){if(!this.getModelField('РП.СписокРассылки')&&this.getModelField('Лицо1')){var e=this._createSubscribeList(parseInt(this.getModelField('Лицо1'),10),this.getModelField('Лицо1.Название'),this.getModelField('Лицо1.Лицо_'));return this.set('РП.СписокРассылки',e),this.acceptChanges(),e;}return this.getModelField('РП.СписокРассылки');}return this._createSubscribeList(parseInt(this.getModelField('Лицо1'),10),this.getModelField('Лицо1.Название'),this.getModelField('Лицо1.Лицо_'));},set:function(i){if(this.has('РП.СписокРассылки')){if(!i instanceof t)if(i instanceof e)i=this._createSubscribeList(parseInt(i.get('@Лицо'),10),i.get('Название'),i.get('Лицо_'));else i=this._createSubscribeList(parseInt(i,10));this.set('РП.СписокРассылки',this._filterValue(i)),this._fillFace1FromSubscribeList();}else{if(i instanceof t)i.each(function(e){if(e.hasColumn&&e.hasColumn('@Лицо'))return i=e.get('@Лицо'),false;});if(i instanceof e)if(i.hasColumn&&i.hasColumn('@Лицо'))i=i.get('@Лицо');this.set('Лицо1',i);}}}}}},_createSubscribeList:function(e,t,i){return e=e||0,t=t||null,i=i||null,new n({rawData:{_type:'recordset',d:[[e,t,i]],s:[{n:'@Лицо',t:'Число целое'},{n:'Название',t:'Строка'},{n:'Лицо_',t:'Строка'}]},adapter:'adapter.sbis'});},_filterValue:function(e){var t=[];return e.each(function(e){t.push([e.get('@Лицо'),e.get('Название')]);}),new n({rawData:{_type:'recordset',d:t,s:[{n:'@Лицо',t:'Число целое'},{n:'Название',t:'Строка'}]},adapter:'adapter.sbis'});},_fillFace1FromSubscribeList:function(){var e=this;(this.has('РП.СписокРассылки')?this.get('РП.СписокРассылки'):new n()).each(function(t){if(t.has('@Лицо'))return e.set('Лицо1',t.get('@Лицо')),e.set('Лицо1.Название',t.get('Название')),false;});}});return r.register('edo.model.FContractModel',o),o;});
define('js!SBIS3.EDO.FContractIn',['js!SBIS3.EDO.FContract','js!SBIS3.EDO.FContractModel','js!SBIS3.EDO2.Dialog','Elektronnyj_dokumentooborot_localization'],function(t,e){'use strict';var o;return o=t.extend({$protected:{_options:{objectName:'ДоговорДок',labelCaption:rk('Контрагент'),scopeArea:'Договоры',placeholderCaption:rk('Укажите контрагента'),dataSource:{endpoint:{contract:'ДоговорДок'},binding:{read:'Документ.ПрочитатьДляУчастника',destroy:'Документ.УдалитьДокументы',format:'ДоговорДок.Список',query:'Список'},model:e},readMetaData:{'ИмяОбъекта':'ДоговорДок'}}},$constructor:function(){}}),o;});
define('js!SBIS3.EDO.FContractOut',['js!SBIS3.EDO.FContract','js!SBIS3.EDO.FContractModel','js!SBIS3.EDO2.Dialog','Elektronnyj_dokumentooborot_localization'],function(t,e){'use strict';var o;return o=t.extend({$protected:{_options:{objectName:'ДоговорДок',labelCaption:rk('Контрагент'),scopeArea:'Договоры',placeholderCaption:rk('Укажите контрагента'),isSendInviteWithDoc:false,dataSource:{endpoint:{contract:'ДоговорДок'},binding:{read:'Документ.ПрочитатьДляУчастника',destroy:'Документ.УдалитьДокументы',format:'ДоговорДок.Список',query:'Список'},model:e},readMetaData:{'ИмяОбъекта':'ДоговорДок'}}},$constructor:function(){}}),o;});
define('js!SBIS3.EDO.EventsRegistryHandlers',['Core/core-functions','Elektronnyj_dokumentooborot_localization'],function(t){'use strict';return{_statsChangeArea:function(e){function i(e,i,r){var a={},l=[];for(l in e)if(e.hasOwnProperty(l))a[e[l]['filterField']]={caption:e[l]['caption'],value:e[l]['value']};for(l in i)if(i.hasOwnProperty(l)){var n=i[l]['filterField'];if(n in a){var s=a[n]['value'];if(a[n]['caption'])i[l]['caption']=a[n]['caption'];else if(i[l]['caption'])i[l]['caption']=void 0;if(void 0!==s&&null!==s)i[l]['value']=s;else i[l]['value']=i[l]['resetValue'];}else if(!(n in r))i[l]['value']=i[l]['resetValue'],i[l]['caption']=i[l]['resetCaption'];else i[l]['caption']=r[n][0],i[l]['value']=r[n][1];i[l]['visibilityValue']=i[l]['value']==i[l]['resetValue']?i[l]['resetVisibilityValue']||false:true;}return t.clone(i);}var r=this.getChildControlByName(this._options.tabsName).getCurrentBrowser(),a=this.getChildControlByName(e['statType']+'EventsBrowser'),l=r._getFilterButton().getFilterStructure(),n=a._getFilterButton().getFilterStructure(),s=r.getFilter(),o=a._getFastDataFilter().getDataSet().getRecordById('FilterState'),u=o.get('keyField'),c=e['extraFilters']||{},g='';if('organizations'===e['source']&&'listTab'===e['destination'])return g=o.get('values').filter(function(t){return t[u]===c['ФильтрСостояние'][1];}),g=g?g[0]:void 0,c['ФильтрСостояние']=[g['title'],g[u]],a._getFilterButton().setFilterStructure(i(l,n,c)),a._getFilterButton().applyFilter(),this.getChildControlByName(this._options.tabsName).getTabButtons().setSelectedKey(this._options.listTabId),true;if(void 0===e['state'])e['state']=s['ФильтрСостояние'];if(g=o.get('values').filter(function(t){return t[u]===e['state'];}),g=g?g[0]:void 0,!!g&&l&&n)c['ФильтрСостояние']=[g['title'],g[u]],a._getFilterButton().setFilterStructure(i(l,n,c)),a._getFilterButton().applyFilter(),this.getChildControlByName(this._options.tabsName).getTabButtons().setSelectedKey(this._options.listTabId);return true;}};});
define('js!SBIS3.EDO.LoadButtonHandlers',['Core/moduleStubs','js!SBIS3.FL.FileLoader','WS.Data/Source/SbisService','Elektronnyj_dokumentooborot_localization'],function(e,t,r){'use strict';var s;return s={prepareParamsRecord:function(e){var t=this.getDocType(),r=this.isIncoming(),s={_type:'record',d:[],s:[]};if(t)s.s.push({n:'ЗагружаемыйФайлЭДО.ТипДокумента',t:'Строка'},{n:'ТипЗагрузчика',t:'Строка'}),s.d.push(t,'ЭДО');if(void 0!=r)s.s.push({n:'ЗагружаемыйФайлЭДО.Входящий',t:'Логическое'}),s.d.push(r);if(this.getDocTypesRecord()&&this.getDocTypesRecord().getColumns().length>0)s.s.push({n:'ЗагружаемыйФайлЭДО.ТипыДокументов',t:'Запись'}),s.d.push(this.getDocTypesRecord());e.setRawData(s);},deferredRegistryUpdate:function(){var t=this;e.requireModule('Lib/ServerEvent/Bus').addCallback(function(s){s[0].serverChannel('fileloader.uploaded').subscribe('onMessage',function(s,n){new r({endpoint:{address:'/fileloader-facade/service/',contract:'Uploading'}}).call('GetResult',{ID:n.get('ID')}).addCallback(function(r){e.require(['js!SBIS3.Engine.BrowserTabs']).addCallback(function(e){var r=t.getParentByClass(e[0]);if(r&&r.getCurrentBrowser()&&r.getCurrentBrowser().getView())r.getCurrentBrowser().getView().reload();});});});});},uploadFiles:function(){var e=this;s.deferredRegistryUpdate.call(e),new t({handlers:{onBeforeSend:function(t,r){s.prepareParamsRecord.call(e,r.record),t.setResult({record:r.record});}}}).choose();},loadButtonMenuItemOnActivated:function(e){if('fromFile'===e)s.uploadFiles.call(this);},loadButtonOnActivated:function(){s.uploadFiles.call(this);}};});
define('js!SBIS3.EDO.LoadButton',['SBIS3.CONTROLS/Menu/MenuButton','WS.Data/Entity/Record','Core/helpers/collection-helpers','js!SBIS3.EDO.LoadButtonHandlers','js!SBIS3.EDO2.IntegrationMixin','Core/helpers/functional-helpers','i18n!SBIS3.EDO.LoadButton','Elektronnyj_dokumentooborot_localization'],function(t,n,e,i,o,s){'use strict';var r=t.extend([o],{$protected:{_options:{name:'loadButton',width:107,parentProperty:'parent',visible:true,items:[{id:'fromFile',title:rk('Из файла'),icon:'sprite:icon-24 icon-OpenedFolder icon-primary',handlers:{onActivated:'js!SBIS3.EDO.LoadButtonHandlers:loadButtonMenuItemOnActivated'}}],from1C:false,docType:'',incoming:false,docTypes:''},_docTypesRecord:null},$constructor:function(){this.once('onReady',function(){if(this._options.docTypes)this._initialize();this._reload();}.bind(this));},_initialize:function(){var t=this._options.docTypes.split(','),e={_type:'record',d:[],s:[]},i;for(var o in t)if(t.hasOwnProperty(o))i=t[o].split(':'),e.s.push({n:i[0],t:'Строка'}),e.d.push(i[1]);this._docTypesRecord=new n({rawData:e,adapter:'adapter.sbis'});},_reload:s.forAliveOnly(function(){return this.getImportMenu(this.getDocType(),this.isIncoming()?'i':'o',function(){return this._reload();}.bind(this)).addCallback(function(t){if(this.unsubscribe('onMenuItemActivate',this.loadButtonOnMenuItemActivate),this.unsubscribe('onActivated',i.loadButtonOnActivated),t&&t.length){var n=[{id:'fromFile',title:rk('Из файла'),icon:'sprite:icon-24 icon-OpenedFolder icon-primary'}].concat(t);this.savedHandlers={fromFile:i.loadButtonMenuItemOnActivated},e.forEach(n,function(t){if(Boolean(t.onActivated))this.savedHandlers[t.id]=t.onActivated;}.bind(this)),this.setItems(n),this.subscribe('onMenuItemActivate',this.loadButtonOnMenuItemActivate);}else this.setItems([]),this.subscribe('onActivated',i.loadButtonOnActivated);}.bind(this));}),loadButtonOnMenuItemActivate:function(t,n){if(Boolean(this.savedHandlers[n]))this.savedHandlers[n].call(this,n);},getDocType:function(){return this._options.docType;},from1C:function(){return this._options.from1C;},isIncoming:function(){return this._options.incoming;},getDocTypesRecord:function(){return this._docTypesRecord;},_modifyOptions:function(){var t=r.superclass._modifyOptions.apply(this,arguments);return t.caption=rk('Загрузить','на сайт'),t;}});return r;});
define("tmpl!SBIS3.EDO.InOutDocumentButtons",["Core/tmpl/js/tclosure","js!SBIS3.EDO2.RulesSelector","js!SBIS3.CONTROLS/Menu/MenuButton","js!SBIS3.EDO.LoadButton","js!SBIS3.EDO2.ExportButton"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],n={};n["js!SBIS3.EDO2.RulesSelector"]=e[1],n["js!SBIS3.CONTROLS/Menu/MenuButton"]=e[2],n["js!SBIS3.EDO.LoadButton"]=e[3],n["js!SBIS3.EDO2.ExportButton"]=e[4];var o=function e(o,r,i,a,c){function s(){}var l=0,u=void 0!==t&&t?t:arguments[arguments.length-1];void 0===u&&(eval("var thelpers = null;"),u=global.requirejs("View/Runner/tclosure"));var d={};c&&c.isSetts&&(d=c.fullContext||{});var m="string"==typeof i?i:"",p=void 0===n?void 0:n,g={id:[],def:void 0},S=u.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),f=this&&this.includedTemplates?this.includedTemplates:{},v=u.getMarkupGenerator(a);try{var y=v.joinElements([v.createTag("div",{},[v.createTag("div",{style:"display:inline-block; float: left;"},[v.createControl("wsControl","ws:SBIS3.EDO2.RulesSelector",{content:u.createDataArray([(new function(){var e=Object.create(o),t=function e(t,n,o,r,i){if(void 0===o)var o=arguments[2];var a=0,c="content";if(void 0===u&&(eval("var thelpers = null;"),u=global.requirejs("View/Runner/tclosure")),i&&i.isSetts)var s=i.fullContext||{};t=u.isolateScope(Object.create(this),t,c);var l="string"==typeof o?o:"",d={id:[],def:void 0},m=this&&this.includedTemplates?this.includedTemplates:{},g=u.getMarkupGenerator(r);try{var f=g.joinElements([g.createControl("wsControl","ws:SBIS3.CONTROLS/Menu/MenuButton",{name:"ruleSelectorMenuLink",caption:u.getter(t,["caption"]),primary:!0},u.plainMerge(n,{name:"ruleSelectorMenuLink",sbisname:"ruleSelectorMenuLink"}),{data:t,ctx:this,pName:void 0!==c?c:void 0,viewController:S},o,p,m,u.config,s)],l,d);d.def&&(f=g.chain(f,d,n),d=void 0)}catch(e){u.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/InOutDocumentButtons/InOutDocumentButtons.tmpl",e,t)}return f||""};this.func=u.makeFunctionSerializable(t,e)}).func]),name:"addDocumentButton",width:"200",showFavorites:!1,docTypes:u.getter(o,["rulesSelectorDocTypes"]),esc:!1},{name:"addDocumentButton",sbisname:"addDocumentButton"},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:S,internal:{__dirtyCheckingVars_0:u.getter(o,["caption"])}},i,p,f,u.config,d)],{},g,this),v.createTag("div",{style:"display:inline-block; float: left; margin-left: 12px;"},[v.createControl("wsControl","ws:SBIS3.EDO.LoadButton",{from1C:!!u.getter(o,["from1C"]),incoming:!!u.getter(o,["incoming"]),docType:u.getter(o,["LBdocType"])},{"data-access":u.utils.escape(u.getter(o,["rightsZone"]))},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:S},i,p,f,u.config,d)],{},g,this),v.createTag("div",{style:"float: left; margin-left: 12px;"},[v.createControl("wsControl","ws:SBIS3.EDO2.ExportButton",{exportSettings:{handlers:{onApplyOperation:u.getTypeFunc("js!SBIS3.EDO.EdoOperationsCommon:documentsPrepareExportColumns",{})},fileName:u.getter(o,["incoming"])?"Входящие":"Исходящие",items:u.getter(o,["items"])},incoming:!!u.getter(o,["incoming"]),docType:u.getter(o,["LBdocType"]),esc:!1},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:S,internal:{__dirtyCheckingVars_0:u.getter(o,["incoming"])?"Входящие":"Исходящие",__dirtyCheckingVars_1:u.getter(o,["items"])}},i,p,f,u.config,d)],{},g,this)],r,g,this)],m,g);g.def&&(y=v.chain(y,g,r),g=void 0)}catch(e){u.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/InOutDocumentButtons/InOutDocumentButtons.tmpl",e,o)}return y||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.InOutDocumentButtons"}},o});
define('js!SBIS3.EDO.InOutDocumentButtons',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.InOutDocumentButtons','js!SBIS3.EDO.OperationUnload','Core/Serializer','js!SBIS3.EDO2.RulesSelector','js!SBIS3.EDO.LoadButton','i18n!SBIS3.EDO.InOutDocumentButtons','js!SBIS3.EDO2.ExportButton','SBIS3.CONTROLS/Menu/MenuButton','js!SBIS3.EDO.EdoOperationsCommon','Elektronnyj_dokumentooborot_localization'],function(e,t,n,o){'use strict';var i=e.extend({_dotTplFn:t,_modifyOptions:function(){var e=i.superclass._modifyOptions.apply(this,arguments);e.caption='+ '+rk('Документ'),e.rulesSelectorDocTypes=[];for(var t in e.docTypes)if(e.docTypes.hasOwnProperty(t))e.rulesSelectorDocTypes.push({docType:e.docTypes[t]});if(e.items={PDF:{pageOrientation:2,serverSideExport:true,binding:{saveList:e.incoming?'РеестрВходящих.ВыгрузитьВExcel':'РеестрИсходящих.ВыгрузитьВExcel',saveDataSet:e.incoming?'РеестрВходящих.ВыгрузитьВExcel':'РеестрИсходящих.ВыгрузитьВExcel'}},Excel:{serverSideExport:true,binding:{saveList:e.incoming?'РеестрВходящих.ВыгрузитьВExcel':'РеестрИсходящих.ВыгрузитьВExcel',saveDataSet:e.incoming?'РеестрВходящих.ВыгрузитьВExcel':'РеестрИсходящих.ВыгрузитьВExcel'}}},!e.incoming)e.items['billSignReport']={title:rk('Отчет о подписании документов реализации'),icon:'sprite:icon-24 icon-PDF icon-error',onActivated:r};return e.rightsZone=e.rightsZone||(e.incoming?'Входящие':'Исходящие'),e;}});function r(e,t){n.prototype._menuItemActivated(e,t);}return o.setToJsonForFunction(r,'js!SBIS3.EDO.OperationUnload','prototype._menuItemActivated'),i;});
define("tmpl!SBIS3.EDO.IncomingEventsLight",["Core/tmpl/js/tclosure","js!SBIS3.EDO2.Browser","js!SBIS3.EDO.FilterIncomingNew","js!SBIS3.EDO.FilterIncomingNewSelector","js!SBIS3.EDO2.OpenDialogAction","js!SBIS3.EDO.FEdoPartialReloader"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.EDO2.Browser"]=e[1],r["js!SBIS3.EDO.FilterIncomingNew"]=e[2],r["js!SBIS3.EDO.FilterIncomingNewSelector"]=e[3],r["js!SBIS3.EDO2.OpenDialogAction"]=e[4],r["js!SBIS3.EDO.FEdoPartialReloader"]=e[5];var i=function e(i,o,n,a,l){function s(){}var c=0,d=void 0!==t&&t?t:arguments[arguments.length-1];void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure"));var m={};l&&l.isSetts&&(m=l.fullContext||{});var g="string"==typeof n?n:"",u=void 0===r?void 0:r,p={id:[],def:void 0},v=d.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,i),f=this&&this.includedTemplates?this.includedTemplates:{},S=d.getMarkupGenerator(a);try{var h=S.joinElements([S.createTag("div",{style:"height:100%;display: flex;flex-direction: column;"},[S.createControl("wsControl","ws:SBIS3.EDO2.Browser",{filterButtonConfig:{template:d.createDataArray([(new function(){var e=Object.create(i),t=function e(t,r,i,o,n){if(void 0===i)var i=arguments[2];var a=0,l="template";if(void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure")),n&&n.isSetts)var s=n.fullContext||{};t=d.isolateScope(Object.create(this),t,l);var c="string"==typeof i?i:"",m={id:[],def:void 0},g=this&&this.includedTemplates?this.includedTemplates:{},p=d.getMarkupGenerator(o);try{var f=p.joinElements([p.createControl("wsControl","ws:SBIS3.EDO.FilterIncomingNew",{},d.plainMerge(r,{}),{data:t,ctx:this,pName:void 0!==l?l:void 0,viewController:v},i,u,g,d.config,s)],c,m);m.def&&(f=p.chain(f,m,r),m=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/IncomingEventsLight/IncomingEventsLight.tmpl",e,t)}return f||""};this.func=d.makeFunctionSerializable(t,e)}).func]),additionalFilterParamsTemplate:d.createDataArray([(new function(){var e=Object.create(i),t=function e(t,r,i,o,n){if(void 0===i)var i=arguments[2];var a=0,l="additionalFilterParamsTemplate";if(void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure")),n&&n.isSetts)var s=n.fullContext||{};t=d.isolateScope(Object.create(this),t,l);var c="string"==typeof i?i:"",m={id:[],def:void 0},g=this&&this.includedTemplates?this.includedTemplates:{},p=d.getMarkupGenerator(o);try{var f=p.joinElements([p.createControl("wsControl","ws:SBIS3.EDO.FilterIncomingNewSelector",{},d.plainMerge(r,{}),{data:t,ctx:this,pName:void 0!==l?l:void 0,viewController:v},i,u,g,d.config,s)],c,m);m.def&&(f=p.chain(f,m,r),m=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/IncomingEventsLight/IncomingEventsLight.tmpl",e,t)}return f||""};this.func=d.makeFunctionSerializable(t,e)}).func]),filterStructure:d.getter(i,["filterButtonConfig"])},browserOptions:{columns:[{cellTemplate:"tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TDocDateTimeColumn",includedTemplates:{DateNumberColumn:"tmpl!SBIS3.EDO2.Browser/resources/columns/tmpl/DateNumberColumn"},width:"1"},{className:"edo-Browser-Main__td",cellTemplate:"tmpl!SBIS3.EDO2.Browser/resources/columns/tmpl/MainInfoColumn"},{cellTemplate:"tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TStateColumnASB",width:"1"},{cellTemplate:"tmpl!SBIS3.EDO2.Browser/resources/columns/tmpl/ResponsibleColumn",width:"1"}],bind:"browser.filter",viewCustomCSS:"controls-ListView__hideCheckBoxes",common:{objectName:"РеестрВходящих",method:"СписокСобытий",destroyMethod:"Удалить",viewMode:"table",model:d.getter(i,["model"])||"DocsInOutModel",firstRequest:!d.getter(i,["needFilterState"]),filterParams:d.getter(i,["filterParams"]),navigationType:"Position"},infiniteScroll:"down",pageSize:21,navigation:{type:"cursor",config:{field:["StartPosition","@Событие"],direction:"after"}},virtualScrolling:!0,viewMode:"table",idProperty:"@Событие",showHead:!1,ladder:["date_col"],handlers:d.getter(i,["handlers"]),itemsActionsVisibility:d.getter(i,["itemsActionsVisibility"]),massActionsVisibility:d.getter(i,["massActionsVisibility"]),massActionsSettings:d.getter(i,["massActionsSettings"]),itemsActions:d.getter(i,["itemsActions"])},name:"IncomingEventsBrowser",listData:d.getter(i,["listData"]),serverSideRendering:d.getter(i,["serverSideRendering"]),ignoreFiltersList:["ФильтрИзСписка","ТипДокумента"],hierarchy:{hierarchy:!1},breadCrumbsConfig:{visible:!1},historyId:"IncomingEvents1",updateFilterHistory:!0,useScope:!0,backButtonEditing:!0,isSingleTypeBrowser:!1,fastDataFilterConfig:d.getter(i,["fastDataFilterConfig"]),operationsPanelConfig:d.getter(i,["operationsPanelConfig"]),searchConfig:d.getter(i,["searchConfig"]),esc:!1},{class:"IncomingEventsBrowser ws-flexbox ws-flex-column ws-flex-grow-1",name:"IncomingEventsBrowser",sbisname:"IncomingEventsBrowser"},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:v,internal:{__dirtyCheckingVars_0:d.getter(i,["filterButtonConfig"]),__dirtyCheckingVars_2:{objectName:"РеестрВходящих",method:"СписокСобытий",destroyMethod:"Удалить",viewMode:"table",model:d.getter(i,["model"])||"DocsInOutModel",firstRequest:!d.getter(i,["needFilterState"]),filterParams:d.getter(i,["filterParams"]),navigationType:"Position"},__dirtyCheckingVars_8:d.getter(i,["handlers"]),__dirtyCheckingVars_9:d.getter(i,["itemsActionsVisibility"]),__dirtyCheckingVars_10:d.getter(i,["massActionsVisibility"]),__dirtyCheckingVars_11:d.getter(i,["massActionsSettings"]),__dirtyCheckingVars_12:d.getter(i,["itemsActions"])}},n,u,f,d.config,m),S.createControl("wsControl","ws:SBIS3.EDO2.OpenDialogAction",{name:"IncomingEventsAction",editMode:"newFloatArea",isDocsReestr:!0},{name:"IncomingEventsAction",sbisname:"IncomingEventsAction"},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:v},n,u,f,d.config,m),S.createControl("wsControl","ws:SBIS3.EDO.FEdoPartialReloader",{actionEventsToListen:["onUpdateModel",d.getter(i,["partialReloader","onDestroyModelHandlingEnable"])?"onDestroyModel":"",d.getter(i,["partialReloader","onCreateModelHandlingEnable"])?"onCreateModel":""],name:"PartialReloader",objectName:d.getter(i,["objectName"])||"РеестрВходящих",method:d.getter(i,["method"])||"СписокСобытий",filterName:d.getter(i,["partialReloader","filterName"])||"СписокИдО",filterNameForCookie:"ИдО",sortField:d.getter(i,["partialReloader","sortField"])||"Начало",overrideItemsSortMethod:!0,updateOnDeleteAndAdd:d.getter(i,["partialReloader","updateOnDeleteAndAdd"])||!1,addServerChannelName:d.getter(i,["partialReloader","addServerChannelName"])||"",fixServerChannelName:d.getter(i,["partialReloader","fixServerChannelName"])||"",deleteServerChannelName:d.getter(i,["partialReloader","deleteServerChannelName"])||"",edoOpenDialogAction:"IncomingEventsAction",registryKeyFromCookie:"PartialReloader_CurrentEvent",esc:!1},{name:"PartialReloader",sbisname:"PartialReloader"},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:v,internal:{__dirtyCheckingVars_0:d.getter(i,["partialReloader","onDestroyModelHandlingEnable"])?"onDestroyModel":"",__dirtyCheckingVars_1:d.getter(i,["partialReloader","onCreateModelHandlingEnable"])?"onCreateModel":""}},n,u,f,d.config,m)],o,p,this)],g,p);p.def&&(h=S.chain(h,p,o),p=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/IncomingEventsLight/IncomingEventsLight.tmpl",e,i)}return h||""};return i.includedFunctions={},i.stable=!0,i.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.IncomingEventsLight"}},i});
define("tmpl!SBIS3.EDO.CompaniesTab",["Core/tmpl/js/tclosure","js!SBIS3.CONTROLS/DataGridView","js!SBIS3.CONTROLS/Link"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],o={};o["js!SBIS3.CONTROLS/DataGridView"]=e[1],o["js!SBIS3.CONTROLS/Link"]=e[2];var r=function e(r,n,i,a,s){function l(){}var c=0,u=void 0!==t&&t?t:arguments[arguments.length-1];void 0===u&&(eval("var thelpers = null;"),u=global.requirejs("View/Runner/tclosure"));var p={};s&&s.isSetts&&(p=s.fullContext||{});var d="string"==typeof i?i:"",m=void 0===o?void 0:o,S={id:[],def:void 0},v=u.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,r),f=this&&this.includedTemplates?this.includedTemplates:{},h=u.getMarkupGenerator(a);try{var T=h.joinElements([h.createTag("div",{},[h.createControl("wsControl","ws:SBIS3.CONTROLS/DataGridView",{columns:[{cellTemplate:"html!SBIS3.EDO.CompaniesTemplate"}],handlers:{onBeforeDataLoad:[u.getTypeFunc("js!SBIS3.EDO.CompaniesTab:prototype.onBeforeDataLoadCompaniesTab",{})]},footerTpl:u.createDataArray([(new function(){var e=Object.create(r),t=function e(t,o,r,n,i){if(void 0===r)var r=arguments[2];var a=0,s="footerTpl";if(void 0===u&&(eval("var thelpers = null;"),u=global.requirejs("View/Runner/tclosure")),i&&i.isSetts)var l=i.fullContext||{};t=u.isolateScope(Object.create(this),t,s);var c="string"==typeof r?r:"",p={id:[],def:void 0},d=this&&this.includedTemplates?this.includedTemplates:{},S=u.getMarkupGenerator(n);try{var f=S.joinElements([S.createControl("wsControl","ws:SBIS3.CONTROLS/Link",{name:"showAllButton",caption:global.rk("Показать все")},u.plainMerge(o,{name:"showAllButton",sbisname:"showAllButton"}),{data:t,ctx:this,pName:void 0!==s?s:void 0,viewController:v},r,m,d,u.config,l)],c,p);p.def&&(f=S.chain(f,p,o),p=void 0)}catch(e){u.templateError("resources/Elektronnyj_dokumentooborot/components/Mixins/SearchAutocompleteMixin/resources/CompaniesTab/CompaniesTab.tmpl",e,t)}return f||""};this.func=u.makeFunctionSerializable(t,e)}).func]),name:"view",showHead:!1,idProperty:"@Лицо",itemsActions:[],dataSource:{module:"WS.Data/Source/SbisService",options:{endpoint:"Контрагент",binding:{query:"АвтодополнениеОбщее"},idProperty:"@Лицо"}},pageSize:5,emptyHTML:global.rk("Не найдено."),esc:!1},{name:"view",sbisname:"view"},{data:r,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:v},i,m,f,u.config,p)],n,S,this)],d,S);S.def&&(T=h.chain(T,S,n),S=void 0)}catch(e){u.templateError("resources/Elektronnyj_dokumentooborot/components/Mixins/SearchAutocompleteMixin/resources/CompaniesTab/CompaniesTab.tmpl",e,r)}return T||""};return r.includedFunctions={},r.stable=!0,r.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.CompaniesTab"}},r});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.CompaniesTab", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-CompaniesTemplate_inn{float:right;color:#999}.edo-CompaniesTemplate_kpp{float:right;color:#999;width:77px;height:20px;padding-left:5px;text-overflow:ellipsis;overflow:hidden}.edo-CompaniesTemplate_width0{width:0!important}.edo-CompaniesTemplate_region{color:#999;font-size:12px;padding-left:6px}.edo-CompaniesTemplate_director{color:#8991a9;margin-right:6px;font-size:14px}.edo-CompaniesTemplate_activityCategory{color:#999;font-size:12px}.edo-CompaniesTemplate_line2,.edo-CompaniesTemplate_line3{margin-left:12px}.edo-CompaniesTemplate_branchOf{color:#999;font-size:12px}.edo-CompaniesTemplate_ctrg-deceased{color:#bbb!important}"));head.appendChild(style);});}
define('js!SBIS3.EDO.CompaniesTab',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.CompaniesTab','html!SBIS3.EDO.CompaniesTemplate','Core/helpers/string-helpers','css!SBIS3.EDO.CompaniesTab','Elektronnyj_dokumentooborot_localization'],function(e,o){'use strict';return e.extend({_dotTplFn:o,$protected:{_options:{}},onBeforeDataLoadCompaniesTab:function(e,o){if(o.usePages)o['Источник']=1,o['ShowLiquid']=true;}});});
define("tmpl!SBIS3.EDO.PeopleTab",["Core/tmpl/js/tclosure","js!SBIS3.CONTROLS/DataGridView","js!SBIS3.CONTROLS/Link"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],o={};o["js!SBIS3.CONTROLS/DataGridView"]=e[1],o["js!SBIS3.CONTROLS/Link"]=e[2];var r=function e(r,n,i,a,l){function s(){}var c=0,u=void 0!==t&&t?t:arguments[arguments.length-1];void 0===u&&(eval("var thelpers = null;"),u=global.requirejs("View/Runner/tclosure"));var p={};l&&l.isSetts&&(p=l.fullContext||{});var d="string"==typeof i?i:"",m=void 0===o?void 0:o,S={id:[],def:void 0},v=u.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,r),f=this&&this.includedTemplates?this.includedTemplates:{},h=u.getMarkupGenerator(a);try{var T=h.joinElements([h.createTag("div",{},[h.createControl("wsControl","ws:SBIS3.CONTROLS/DataGridView",{handlers:{onBeforeDataLoad:[u.getTypeFunc("js!SBIS3.EDO.PeopleTab:prototype.onBeforeDataLoadPeopleTab",{})]},footerTpl:u.createDataArray([(new function(){var e=Object.create(r),t=function e(t,o,r,n,i){if(void 0===r)var r=arguments[2];var a=0,l="footerTpl";if(void 0===u&&(eval("var thelpers = null;"),u=global.requirejs("View/Runner/tclosure")),i&&i.isSetts)var s=i.fullContext||{};t=u.isolateScope(Object.create(this),t,l);var c="string"==typeof r?r:"",p={id:[],def:void 0},d=this&&this.includedTemplates?this.includedTemplates:{},S=u.getMarkupGenerator(n);try{var f=S.joinElements([S.createControl("wsControl","ws:SBIS3.CONTROLS/Link",{name:"showAllButton",caption:global.rk("Показать все")},u.plainMerge(o,{name:"showAllButton",sbisname:"showAllButton"}),{data:t,ctx:this,pName:void 0!==l?l:void 0,viewController:v},r,m,d,u.config,s)],c,p);p.def&&(f=S.chain(f,p,o),p=void 0)}catch(e){u.templateError("resources/Elektronnyj_dokumentooborot/components/Mixins/SearchAutocompleteMixin/resources/PeopleTab/PeopleTab.tmpl",e,t)}return f||""};this.func=u.makeFunctionSerializable(t,e)}).func]),name:"view",columns:[{cellTemplate:"html!SBIS3.EDO.PeopleTemplate"}],showHead:!1,idProperty:"@Лицо",itemsActions:[],dataSource:{module:"WS.Data/Source/SbisService",options:{endpoint:"Люди",binding:{query:"СписокПоиск"},idProperty:"@Лицо"}},pageSize:5,emptyHTML:global.rk("Не найдено."),esc:!1},{name:"view",sbisname:"view"},{data:r,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:v},i,m,f,u.config,p)],n,S,this)],d,S);S.def&&(T=h.chain(T,S,n),S=void 0)}catch(e){u.templateError("resources/Elektronnyj_dokumentooborot/components/Mixins/SearchAutocompleteMixin/resources/PeopleTab/PeopleTab.tmpl",e,r)}return T||""};return r.includedFunctions={},r.stable=!0,r.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.PeopleTab"}},r});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.PeopleTab", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-PeopleTemplate_department{font-size:12px;color:#999;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.edo-PeopleTemplate_name{white-space:nowrap;max-width:58%;text-overflow:ellipsis;overflow:hidden}.edo-PeopleTemplate_inn{float:right;font-size:12px;color:#999;margin-right:8px}.edo-PeopleTemplate_post{font-size:12px;color:#999;margin-left:8px;white-space:nowrap;max-width:28%;text-overflow:ellipsis;overflow:hidden}.edo-PeopleTemplate_photo{float:left;margin-right:4px}"));head.appendChild(style);});}
define('js!SBIS3.EDO.PeopleTab',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.PeopleTab','html!SBIS3.EDO.PeopleTemplate','Core/helpers/transport-helpers','css!SBIS3.EDO.PeopleTab','Elektronnyj_dokumentooborot_localization'],function(e,o){'use strict';return e.extend({_dotTplFn:o,$protected:{_options:{}},onBeforeDataLoadPeopleTab:function(e,o){if(o.usePages)o['сущности']=['сотрудники','физлица'];}});});
define('js!SBIS3.EDO.SearchAutocompleteHandlers',['Core/ContextBinder','Elektronnyj_dokumentooborot_localization'],function(e){'use strict';return{setProcessingAutocompletion:function(t){var o=new e();this._options._$autocompleteData.browserSearch=this.getChildControlByName('browserSearch'),this._options._$autocompleteData.view=this.getChildControlByName('browserView'),this._options._$autocompleteData.filterSuggestName=t||'ФильтрИзСписка',o.defineBinding('text','searchFormField','','fromContext'),o.bindControl(this._options._$autocompleteData.browserSearch,this.getLinkedContext(),'syncControl');},onListItemSelect:function(e,t,o){var i=this.sendCommand('edoSearchAutocomplete-getRegistry')._options._$autocompleteData;i.suggested=true,i.name=t.get('Название');},onSearch:function(e,t){var o=this.sendCommand('edoSearchAutocomplete-getRegistry')._options._$autocompleteData,i=o.view.getFilter();if(o.suggested){if(i[o.filterSuggestName]='Да',o.view.setFilter(i,true),o.suggested=false,o.name)o.browserSearch.setText(o.name),o.view.setHighlightText(o.name);}else i[o.filterSuggestName]='Нет',o.view.setFilter(i,true);},onReset:function(e){var t=this.sendCommand('edoSearchAutocomplete-getRegistry')._options._$autocompleteData,o=t.view.getFilter();t.suggested=false,o[t.filterSuggestName]='Нет',t.view.setFilter(o,true);}};});
define('js!SBIS3.EDO.SearchAutocompleteMixin',['Core/CommandDispatcher','js!SBIS3.EDO.CompaniesTab','js!SBIS3.EDO.PeopleTab','js!SBIS3.EDO.SearchAutocompleteHandlers','SBIS3.CONTROLS/Suggest/SuggestView','Elektronnyj_dokumentooborot_localization'],function(e,t,i,o){'use strict';return{after:{init:function(){o.setProcessingAutocompletion.apply(this,[this._options.searchAutocompleteFilterName||this._options._$autocompleteData.filterSuggestName]),e.declareCommand(this,'edoSearchAutocomplete-getRegistry',function(){return this;}.bind(this));},_modifyOptions:function(e){return e._$autocompleteData={browserSearch:null,view:null,suggested:false,name:'',filterSuggestName:'ФильтрИзСписка'},e;}},getSearchConfig:function(){return{placeholder:rk('Найти...'),searchDelay:600,trim:true,usePicker:true,searchParam:'Реквизиты',resultBindings:[{contextField:'searchFormField',itemField:'@Лицо'}],handlers:{onListItemSelect:[o.onListItemSelect],onSearch:[o.onSearch],onReset:[o.onReset]},list:{component:'SBIS3.CONTROLS/Suggest/SuggestView',options:{displayProperty:'title',idProperty:'id',selectedKey:' DialogCompaniesTab',items:[{id:' DialogCompaniesTab',title:rk('Компании'),align:'left',searchParam:'Реквизиты',content:t},{id:'DialogPeopleTab',title:rk('Люди'),align:'left',searchParam:'поиск',content:i}]}}};}};});
define('js!SBIS3.EDO.Modificators.IncomingEvents.List',['js!SBIS3.EDO.Modificators.DefaultModificator','Elektronnyj_dokumentooborot_localization'],function(e){'use strict';function t(){e.apply(this,arguments),this._allowedItems=['edoDeleteRedaction','edoRestoreRedaction'],this._allowedMOPItems=['edoDeleteRedactionMass','edoRestoreRedactionMass'],this._fastFilterItems=['ФильтрСостояние','ФильтрВладелец','ТипДокументаВД'];}return t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.prototype.getFilterButtonConfig=function(){return{template:'SBIS3.EDO.FilterIncomingNew',additionalFilterParamsTemplate:'SBIS3.EDO.FilterIncomingNewSelector',filterStructure:this._getFilterStructure(['ФильтрДатаПериод','ФильтрДатаС','ФильтрДатаП','ИдРегламента','ФильтрЛицо1','ФильтрСостояние','ФильтрОрганизацияФилиал','ФильтрОтветственноеЛицо','ФильтрВладелец','ФильтрНезакрепленные','ФильтрПометкиВкл','ФильтрПометкиИскл','ФильтрУдаленные','ТипДокументаВД','ФильтрНепрочитанные'])};},t.prototype.modifyFilterConfigs=function(e){var t=e.filter(function(e){return this._fastFilterItems.indexOf(e['filterField'])>-1;}.bind(this)),i;for(i in t)t[i]['itemTemplate']=null;return e;},t.prototype.getFastDataFilterConfig=function(){return{className:'edo-tasks__fastDataFilter',idProperty:'name',data:[{keyField:'key',displayField:'title',name:'FilterAuthorOrResponsibleMe',multiselect:false,className:'controls-DropdownList__linkStyle',showSelectedInList:true,values:[{key:'Все',value:'Все',title:rk('Все')},{key:'От меня',value:'От меня',title:rk('Мои')},{key:'От моего отдела',value:'От моего отдела',title:rk('Моего отдела')}]},{keyField:'key',displayField:'title',name:'FilterState',multiselect:false,className:'controls-DropdownList controls-DropdownList__linkStyle',showSelectedInList:true,values:[{key:'-1',title:rk('В любом состоянии')},{key:'10',title:rk('Внутренняя обработка')},{key:'7',title:rk('Утвержденные')},{key:'9',title:rk('Отклоненные')},{key:'22',title:rk('Аннулированные')},{key:'19,20',title:rk('Удалено мной/контрагентом')},{key:'0,1',title:rk('Черновики')},{key:'-2',title:rk('Удаленные')}]},{keyField:'ТипДокументаВД',displayField:'Название',name:'FilterDocumentType',multiselect:true,className:'controls-DropdownList__linkStyle',showSelectedInList:true,values:[{'ТипДокументаВД':'Все','Название':rk('Все типы документов')},{'ТипДокументаВД':'АктВР,АктПП','Название':rk('Акты (услуги, работы, права)')},{'ТипДокументаВД':'ЭДОНакл','Название':rk('Накладные')},{'ТипДокументаВД':'СчФктр,УпдСчфДоп','Название':rk('Счета-фактуры (вкл. в составе УПД)')},{'ТипДокументаВД':'счФактКор,УкдКсчфДис','Название':rk('Счета-фактуры корр. (вкл. в составе УКД)')},{'ТипДокументаВД':'УпдДоп','Название':rk('Передаточные документы')},{'ТипДокументаВД':'УкдДис','Название':rk('Передаточные документы корр.')},{'ТипДокументаВД':'АктСвер','Название':rk('Акты сверки')},{'ТипДокументаВД':'Договор','Название':rk('Договоры')},{'ТипДокументаВД':'ЭДОСч','Название':rk('Счета')}]}]};},t;});
define('js!SBIS3.EDO.OperationPrint',['Core/core-functions','Core/helpers/string-helpers-min','Core/Indicator','optional!js!SBIS3.TEMPLATEEDITOR.OperationPrint','SBIS3.CONTROLS/Utils/DataProcessor','js!SBIS3.EDO.EdoCommon','js!SBIS3.EDO.EdoOperationsCommon','WS.Data/Chain','WS.Data/Collection/Factory/RecordSet','WS.Data/Adapter/Sbis','i18n!SBIS3.EDO.OperationPrint','Elektronnyj_dokumentooborot_localization'],function(e,t,i,n,o,r,s,a,c,l){'use strict';return n.extend({$constructor:function(){this.changeSelectionHandlerDebounce=this._changeSelectionHandler.debounce(100,true);},_menuItemActivated:function(e,t){if('billSignReport'==t){var i=this._getView().getSelectedItems(),n;if(!i||!(i.getCount()>0))this._currentItem=t,this._prepareOperation(rk('Что распечатать'));else n=this.getViewFilter(),s.printDocsReportOperation(i,n);}},getViewFilter:function(){var e=this._options.linkedView.getDataSource(),t=this._options.linkedView.getFilter(),i=e._buildRecord(t);return i=e.getAdapter().serialize(i),i;},applyOperation:function(e){i.hide();var n=this._options.linkedView,p=this._options&&!!this._options.exportDocuments?e.dataSet.clone():a(e.dataSet).filter(function(e){return!e.get((n.getParentProperty&&n.getParentProperty())+'@');}).value(c,{adapter:new l()});if(!p.getCount())return;if('files_print'===this._currentItem)return void s.printSelectedDocsOperation(e.dataSet,true,'',this._options.customObjectName,this._options.customMethodName);else if('billSignReport'===this._currentItem){var d=this.getViewFilter();return void s.printDocsReportOperation(e.dataSet,d);}if(!!this._options.exportDocuments)s.documentsPrepareExport(p),e.report=true,e.xsl=t.transliterate(this._options.xsl);else if(p.each(function(e){e.set('ДокументРасширение.Название',r.RemoveTags(e.get('ДокументРасширение.Название')));}),p.at(0).has('РазличныеДокументы.Информация'))p.each(function(e){e.set('РазличныеДокументы.Информация',r.RemoveTags(e.get('РазличныеДокументы.Информация')));});if(this._options.minPrintWindowWidth)e.minWidth=this._options.minPrintWindowWidth;e.dataSet=p,new o(e).print();},onSelectedItemsChange:function(e){this.changeSelectionHandlerDebounce(this,e);},_changeSelectionHandler:function(e,t){var i=e._options.linkedView,n=i.getSelectedItems(),o=i.getParentProperty&&i.getParentProperty(),r;if(t.length)r=n.getCount()?n:i.getItems();if(r&&r.getCount())if(e.hasLeafInSelected(r,o))e.show();else e.hide();},hasLeafInSelected:function(e,t){for(var i=0;i<e.getCount();i++)if(!e.at(i).get(t+'@'))return true;return false;},processSelectedPageSize:function(e){if('billSignReport'===this._currentItem&&0==e){var t=this.getViewFilter();s.printDocsReportOperation(null,t);}else return s.processSelectedPageSizeCommon(e,this);},_onOperationActivated:function(){},filteredPrint:function(){if(this.selectedIsEmpty())e.alert(rk('Выберите документы для печати!'),'error');else s.printSelectedDocsOperation(this.getSelectedElements(),true,'',this._options.filteredObjectName,this._options.filteredMethodName);},filesPrint:function(){if(this.selectedIsEmpty())this._prepareOperation(rk('Что напечатать'));else s.printSelectedDocsOperation(this.getSelectedElements(),true,'',this._options.customObjectName,this._options.customMethodName);}});});
define('js!SBIS3.EDO.FilterButtonsConfigsStats',['tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterFace1','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterIdRegulations','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterSender','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterReceiver','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterAuthor','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterMilestone','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterProject','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterListDispatch','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplUnread','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterDatePeriod','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterResp','tmpl!SBIS3.EDO2.MarksFilterRowTemplate/tmpl/MarksFilterRowTemplate','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterDatePeriod','css!SBIS3.EDO2.MarksFilterRowTemplate','Elektronnyj_dokumentooborot_localization'],function(){'use strict';return function(e,l){function i(l){return e&&e.hasOwnProperty(l)?e[l]:null;}function t(e){return l&&l.hasOwnProperty(e)?l[e]:'';}return{'ФильтрДатаПериод':{internalValueField:'FilterDatePeriod',internalCaptionField:'FilterDatePeriodText',filterField:'ФильтрДатаПериод',resetValue:'Все',value:i('ФильтрДатаПериод')?i('ФильтрДатаПериод'):'Все'},'ФильтрДатаПериодСтатистика':{caption:rk('Месяц'),resetCaption:rk('Месяц'),internalValueField:'FilterDatePeriod',internalCaptionField:'FilterDatePeriodText',itemTemplate:'tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterDatePeriod',filterField:'ФильтрДатаПериод',resetValue:'Месяц',value:i('ФильтрДатаПериод')?i('ФильтрДатаПериод'):'Месяц'},'ФильтрДатаС':{internalValueField:'FilterDateFrom',internalCaptionField:'FilterDateFromText',filterField:'ФильтрДатаС',resetValue:null,itemTemplate:null,historyItemTemplate:null,value:i('ФильтрДатаС')},'ФильтрДатаП':{internalValueField:'FilterDateTo',internalCaptionField:'FilterDateToText',filterField:'ФильтрДатаП',resetValue:null,itemTemplate:null,historyItemTemplate:null,value:i('ФильтрДатаП')},'ФильтрСостояние':{internalValueField:'FilterState',internalCaptionField:'FilterStateText',filterField:'ФильтрСостояние',resetValue:'-1',itemTemplate:null,value:i('ФильтрСостояние')||'-1'},'БыстрыйФильтрСостояние':{internalValueField:'FilterState',internalCaptionField:'FilterStateText',filterField:'ФильтрСостояние',resetValue:'-1',value:i('ФильтрСостояние')||'-1'},'БыстрыйФильтрСостояниеКраткое':{internalValueField:'FilterShortState',internalCaptionField:'FilterShortStateText',filterField:'ФильтрПоКраткомуСостоянию',resetValue:'8',value:i('ФильтрПоКраткомуСостоянию')||'8'},'ФильтрВладелец':{internalValueField:'FilterAuthorOrResponsibleMe',internalCaptionField:'FilterAuthorOrResponsibleMeText',internalVisibilityField:'FilterAuthorOrResponsibleMeVisibility',filterField:'ФильтрВладелец',resetValue:'Все',resetVisibilityValue:false,itemTemplate:null,value:i('ФильтрВладелец')||'Все'},'БыстрыйФильтрВладелец':{internalValueField:'FilterAuthorOrResponsibleMe',internalCaptionField:'FilterAuthorOrResponsibleMeText',filterField:'ФильтрВладелец',resetValue:'Все',value:i('ФильтрВладелец')||'Все'},'ФильтрАвторИлиОтветственный':{internalValueField:'FilterAuthorOrResponsible',internalCaptionField:'FilterAuthorOrResponsibleText',internalVisibilityField:'FilterAuthorOrResponsibleVisibility',filterField:'ФильтрАвторИлиОтветственный',resetValue:[],resetVisibilityValue:false,itemTemplate:'tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterAuthor',historyItemTemplate:'tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterAuthor',value:i('ФильтрАвторИлиОтветственный')||[]},'ФильтрЛицо1':{internalValueField:'FilterFace1',internalCaptionField:'FilterFace1Text',internalVisibilityField:'FilterFace1Visibility',filterField:'ФильтрЛицо1',resetValue:[],resetVisibilityValue:false,itemTemplate:'tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterFace1',historyItemTemplate:'tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterFace1',value:i('ФильтрЛицо1')||[]},'ФильтрДокументНашаОрганизация':{internalValueField:'FilterOurOrganisation',internalCaptionField:'FilterOurOrganisationText',internalVisibilityField:'FilterOurOrganisationVisibility',filterField:'ФильтрДокументНашаОрганизация',resetValue:[],resetVisibilityValue:false,value:i('ФильтрДокументНашаОрганизация')||[]},'ФильтрКонкретныйИсполнитель':{internalValueField:'FilterSpecificPerformer',internalCaptionField:'FilterSpecificPerformerText',internalVisibilityField:'FilterSpecificPerformerVisibility',filterField:'ФильтрКонкретныйИсполнитель',resetValue:'Все',resetVisibilityValue:true,value:i('ФильтрКонкретныйИсполнитель')||'Все'},'ФильтрНезакрепленные':{internalValueField:'FilterUnfixed',internalCaptionField:'FilterUnfixedText',internalVisibilityField:'FilterUnfixedVisibility',filterField:'ФильтрНезакрепленные',resetValue:null,resetVisibilityValue:false,value:i('ФильтрНезакрепленные')||null},'ТипДокументаВД':{internalValueField:'FilterDocumentType',internalCaptionField:'FilterDocumentTypeText',internalVisibilityField:'FilterDocumentTypeVisibility',filterField:'ТипДокументаВД',resetValue:['Все'],itemTemplate:null,value:i('ТипДокументаВД')||['Все']},'БыстрыйТипДокументаВД':{internalValueField:'FilterDocumentType',internalCaptionField:'FilterDocumentTypeText',internalVisibilityField:'FilterDocumentTypeVisibility',filterField:'ТипДокументаВД',resetValue:['Все'],value:i('ТипДокументаВД')||['Все']},'ИдРегламента':{internalValueField:'FilterIdRegulationMul',internalCaptionField:'FilterIdRegulationText',internalVisibilityField:'FilterRegulationVisibility',filterField:'ИдРегламента',resetValue:[],resetVisibilityValue:false,itemTemplate:'tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterIdRegulations',value:i('ИдРегламента')||[]},'ФильтрОтветственноеЛицо':{internalValueField:'FilterResponsibleFace',internalCaptionField:'FilterResponsibleFaceText',internalVisibilityField:'FilterResponsibleFaceVisibility',filterField:'ФильтрОтветственноеЛицо',resetValue:[],resetCaption:'',resetVisibilityValue:false,itemTemplate:'tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterResp',historyItemTemplate:'tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterResp',value:i('ФильтрОтветственноеЛицо')||[]},'ФильтрПометкиВкл':{internalValueField:'FilterMarksIncluded',internalCaptionField:'FilterMarksIncludedText',internalVisibilityField:'FilterMarksVisibility',filterField:'ФильтрПометкиВкл',resetValue:[],resetVisibilityValue:false,itemTemplate:'tmpl!SBIS3.EDO2.MarksFilterRowTemplate/tmpl/MarksFilterRowTemplate',value:i('ФильтрПометкиВкл')||[]},'ФильтрПометкиИскл':{internalValueField:'FilterMarksExcluded',internalCaptionField:'FilterMarksExcludedText',filterField:'ФильтрПометкиИскл',resetValue:[],resetVisibilityValue:false,itemTemplate:'tmpl!SBIS3.EDO2.MarksFilterRowTemplate/tmpl/MarksFilterRowTemplate',value:i('ФильтрПометкиИскл')||[]},'ФильтрУдаленные':{internalValueField:'FilterDeleted',internalCaptionField:'FilterDeletedText',internalVisibilityField:'FilterDeletedVisibility',filterField:'ФильтрУдаленные',resetValue:null,value:i('ФильтрУдаленные')||null},'ФильтрТипСобытия':{internalValueField:'FilterEventType',internalCaptionField:'FilterEventTypeText',filterField:'ФильтрТипСобытия',resetValue:i('ФильтрТипСобытия')||'',value:i('ФильтрТипСобытия')||''},'ФильтрНепрочитанные':{internalValueField:'FilterUnread',internalCaptionField:'FilterUnreadText',internalVisibilityField:'FilterUnreadVisibility',filterField:'ФильтрНепрочитанные',resetValue:null,itemTemplate:'tmpl!SBIS3.EDO.BaseFiltersStyles/FtplUnread',resetVisibilityValue:false,value:i('ФильтрНепрочитанные')||null}};};});
define('js!SBIS3.EDO.DocsInOutModel',['js!SBIS3.EDO2.EdoModel','WS.Data/Di','Elektronnyj_dokumentooborot_localization'],function(t,e){'use strict';var o=t.extend({_moduleName:'SBIS3.EDO.DocsInOutModel',$protected:{_options:{properties:{dateStart:{get:function(){return this.get('Начало')?this.get('Начало').strftime('%d.%m.%y'):'';}}}}}});return e.register('DocsInOutModel',o),o;});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.IncomingEventsLight", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".event_date .datecol_small .datecol_date{color:#000;font-size:14px;vertical-align:top!important;text-align:right!important}.event_date .datecol_small .datecol_time{color:#ccc!important}.controls-DropdownList__picker .inc_events .controls-ListView__defaultItem{display:none}.pereh_col .no_icon{padding-left:0}.IncomingEventsBrowser .datecol_small{padding-top:1px}.IncomingEventsBrowser .edo-DateCol_icon_unread{position:absolute;margin-top:-17px;margin-left:5px}.IncomingEventsBrowser{height:100%}.engine-BrowserTabs{height:100%}"));head.appendChild(style);});}
define('js!SBIS3.EDO.IncomingEventsLight',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.IncomingEventsLight','js!SBIS3.EDO.SearchAutocompleteMixin','js!SBIS3.EDO.Modificators','js!SBIS3.EDO.Modificators.IncomingEvents.List','js!SBIS3.EDO.EdoClicks','js!SBIS3.EDO.EdoRecOptions','js!SBIS3.EDO.OperationPrint','js!SBIS3.EDO.EdoOperationsCommon','Core/Serializer','js!SBIS3.EDO.FilterButtonsConfigsStats','tmpl!SBIS3.EDO2.Browser/resources/columns/tmpl/ResponsibleColumn','tmpl!SBIS3.EDO2.Browser/resources/columns/tmpl/StateColumn','tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TStateColumnASB','tmpl!SBIS3.EDO2.Browser/resources/columns/tmpl/MainInfoColumn','tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TDocDateTimeColumn','tmpl!SBIS3.EDO2.Browser/resources/columns/tmpl/DateNumberColumn','js!SBIS3.EDO2.Browser','js!SBIS3.EDO2.OpenDialogAction','js!SBIS3.EDO.FEdoPartialReloader','js!SBIS3.EDO.DocsInOutModel','Core/UserConfig','css!SBIS3.EDO.IncomingEventsLight','Elektronnyj_dokumentooborot_localization'],function(e,t,o,n,s,i,r,a,l,c,m){'use strict';var u=e.extend([o],{_dotTplFn:t,$protected:{_options:{itemsActionsVisibility:{edoSaveDocumentOnDisk:false,edoSendDocument:false,edoOpenInNewTab:false,edoDeleteDocument:false,edoShowDkPanel:false,edoPostDocument:false,edoRestoreDocument:false},massActionsVisibility:{edoDeleteDocumentMass:false,edoRestoreDocumentMass:false},massActionsSettings:{edoPrintDocumentMass:{documentIdField:'@Документ',recursive:false,infinityPrint:true,minPrintWindowWidth:666,exportDocuments:true,xsl:'Электронный документооборот/Реестры/xslt/reestr_events_new.xsl',filteredObjectName:'ДокОтгрВх',filteredMethodName:'ПечатьВложенийСФильтром',handlers:{onApplyOperation:l.documentsPreparePrintColumns},items:[{id:'filtered',title:rk('Фактуры, накладные, акты'),onActivated:f}]}},filterParams:{},configFilters:['ФильтрДатаПериод','ФильтрДатаС','ФильтрДатаП','ИдРегламента','ФильтрЛицо1','ФильтрСостояние','ФильтрДокументНашаОрганизация','ФильтрОтветственноеЛицо','ФильтрВладелец','ФильтрНезакрепленные','ФильтрПометкиВкл','ФильтрПометкиИскл','ФильтрУдаленные','ТипДокументаВД','ФильтрНепрочитанные'],configFastFilters:['ФильтрСостояние','ФильтрВладелец','ТипДокументаВД']}},init:function(){u.superclass.init.call(this);var e=this,t=this.getChildControlByName('IncomingEventsBrowser'),o=this.getChildControlByName('browserFastDataFilter');if(o)o.setItems(this._options.fastDataFilterConfig.data);t.subscribeTo(t,'onStartCommand',function(e,t){if('edoCopyDocument'===t.commandName)t.args[0].createStartEvent=true;});},_modifyOptions:function(){var e=u.superclass._modifyOptions.apply(this,arguments),t={},o=new s(),i=new n(o),r=e.url,a=r&&r.filterState?true:false,l={undeveloped:'10',clear:'-1'},c=r?l[r.filterState]||'-1':'-1',f=global.requirejs('Core/UserConfig');if(e.filterButtonConfig=[],e&&e.listData&&e.listData.filter)t=e.listData.filter;if(a)f.removeParam('IncomingEvents1');if(c)e.filterParams['ФильтрСостояние']=c,t['ФильтрСостояние']=c;e.operationsPanelConfig=i.getMOPActions();var S=m(t),d=[];return e.filterButtonConfig=e.configFilters.map(function(e){return S[e];}),d=e.configFastFilters.map(function(e){return S[e];}),e.fastDataFilterConfig=o.getFastDataFilterConfig(),e.fastDataFilterConfig.filterStructure=d,e.itemsActions=i.getActions(),e.needFilterState=a,e.handlers=this._getHandlers(e),e.searchConfig=this.getSearchConfig(),e;},_getHandlers:function(){return{onItemClick:[i.clickDispPartialReloaderSetCookie],onChangeHoveredItem:[r.onChangeHoveredItemEvents]};},onTabChange:function(e,t){if('DoneTab'==t)this.getCurrentBrowser().getView().reload();}});function f(){a.prototype.filteredPrint();}return c.setToJsonForFunction(f,'js!SBIS3.EDO.OperationPrint','prototype.filteredPrint'),u;});
define("tmpl!SBIS3.EDO.IncomingEventLightTab",["Core/tmpl/js/tclosure","js!SBIS3.Engine.BrowserTabs","js!SBIS3.EDO.InOutDocumentButtons","js!SBIS3.EDO.IncomingEventsLight"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],n={};n["js!SBIS3.Engine.BrowserTabs"]=e[1],n["js!SBIS3.EDO.InOutDocumentButtons"]=e[2],n["js!SBIS3.EDO.IncomingEventsLight"]=e[3];var r=function e(r,o,i,a,s){function l(){}var c=0,d=void 0!==t&&t?t:arguments[arguments.length-1];void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure"));var u={};s&&s.isSetts&&(u=s.fullContext||{});var g="string"==typeof i?i:"",m=void 0===n?void 0:n,v={id:[],def:void 0},p=d.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,r),h=this&&this.includedTemplates?this.includedTemplates:{},f=d.getMarkupGenerator(a);try{var b=f.joinElements([f.createTag("div",{style:"min-height:1px;display: flex;flex-direction: column;height:100%;"},[f.createControl("wsControl","ws:SBIS3.Engine.BrowserTabs",{tabsArea:[{content:d.createDataArray([(new function(){var e=Object.create(r),t=function e(t,n,r,o,i){if(void 0===r)var r=arguments[2];var a=0,s="content";if(void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure")),i&&i.isSetts)var l=i.fullContext||{};t=d.isolateScope(Object.create(this),t,s);var c="string"==typeof r?r:"",u={id:[],def:void 0},g=this&&this.includedTemplates?this.includedTemplates:{},v=d.getMarkupGenerator(o);try{var h=v.joinElements([v.createControl("wsControl","ws:SBIS3.EDO.InOutDocumentButtons",{name:"InOutDocumentButtons",docTypes:["ДокОтгрВх","ФактураВх","КоррВх","АктСверкиДок","ДоговорДок","СчетВх"],from1C:!1,incoming:!0,LBdocType:"Входящие"},d.plainMerge(n,{name:"InOutDocumentButtons",sbisname:"InOutDocumentButtons"}),{data:t,ctx:this,pName:void 0!==s?s:void 0,viewController:p},r,m,g,d.config,l)],c,u);u.def&&(h=v.chain(h,u,n),u=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/IncomingEventLightTab/IncomingEventLightTab.tmpl",e,t)}return h||""};this.func=d.makeFunctionSerializable(t,e)}).func]),id:"aGroup"}],mainArea:[{id:"StatGroup",template:"js!SBIS3.EDO.StatTemplateExternal",componentOptions:{StatTemplateName:"ШаблонСтатистики",needStatPrintBtn:!0,statTemplate:"js!SBIS3.EDO.StatIncomingEventsNew",statType:"Incoming"}},{content:d.createDataArray([(new function(){var e=Object.create(r),t=function e(t,n,r,o,i){if(void 0===r)var r=arguments[2];var a=0,s="content";if(void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure")),i&&i.isSetts)var l=i.fullContext||{};t=d.isolateScope(Object.create(this),t,s);var c="string"==typeof r?r:"",u={id:[],def:void 0},g=this&&this.includedTemplates?this.includedTemplates:{},v=d.getMarkupGenerator(o);try{var h=v.joinElements([v.createControl("wsControl","ws:SBIS3.EDO.IncomingEventsLight",{useAutoRefresh:!0,partialReloader:{fixServerChannelName:"edo.task-fix",onCreateModelHandlingEnable:!0,onDestroyModelHandlingEnable:!0},url:d.getter(t,["url"]),listData:d.getter(t,["listData"]),serverSideRendering:d.getter(t,["serverSideRendering"])},d.plainMerge(n,{}),{data:t,ctx:this,pName:void 0!==s?s:void 0,viewController:p},r,m,g,d.config,l)],c,u);u.def&&(h=v.chain(h,u,n),u=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/IncomingEventLightTab/IncomingEventLightTab.tmpl",e,t)}return h||""};this.func=d.makeFunctionSerializable(t,e)}).func]),id:"ListGroup"}],tabs:[{id:d.getter(r,["statTabId"]),title:global.rk("Статистика"),mainArea:"StatGroup"},{id:d.getter(r,["listTabId"]),mainArea:"ListGroup",tabsArea:"aGroup",title:global.rk("Список")}],handlers:{onTabChange:[d.getTypeFunc("js!SBIS3.EDO.EdoCommon:onTabChangeNewRegistry",{})],onTabAndMainLoaded:[d.getTypeFunc("js!SBIS3.EDO.IncomingEventLightTab:prototype.onTabAndMainLoaded",{})]},name:"IncomingEventsTabs",style:"height:100%;display: flex;flex-direction: column;",defaultTab:"ListTab",esc:!1},{class:"ws-flexbox ws-flex-column ws-flex-grow-1",name:"IncomingEventsTabs",sbisname:"IncomingEventsTabs"},{data:r,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:p,internal:{__dirtyCheckingVars_6:d.getter(r,["url"]),__dirtyCheckingVars_7:d.getter(r,["listData"]),__dirtyCheckingVars_8:d.getter(r,["serverSideRendering"]),__dirtyCheckingVars_9:d.getter(r,["statTabId"]),__dirtyCheckingVars_11:d.getter(r,["listTabId"])}},i,m,h,d.config,u)],o,v,this)],g,v);v.def&&(b=f.chain(b,v,o),v=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/IncomingEventLightTab/IncomingEventLightTab.tmpl",e,r)}return b||""};return r.includedFunctions={},r.stable=!0,r.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.IncomingEventLightTab"}},r});
define('js!SBIS3.EDO.IncomingEventLightTab',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.IncomingEventLightTab','js!SBIS3.EDO.EdoCommon','WS.Data/Source/SbisService','Core/CommandDispatcher','js!SBIS3.EDO.EventsRegistryHandlers','js!SBIS3.EDO.InOutDocumentButtons','js!SBIS3.EDO.IncomingEventsLight','js!SBIS3.Engine.BrowserTabs','js!SBIS3.EDO.EdoOperationsCommon','Elektronnyj_dokumentooborot_localization'],function(t,n,e,o,a,i){var c=t.extend({_dotTplFn:n,$protected:{_options:{tabsName:'IncomingEventsTabs',listTabId:'ListTab',statTabId:'StatTab'}},$constructor:function(){a.declareCommand(this,'statsChangeArea',i._statsChangeArea);},init:function(){c.superclass.init.call(this);var t=this;new o({endpoint:'ГлобальныеПараметрыКлиента'}).call('ПолучитьЗначение',{'Путь':'unit_contracts_converted'}).addCallback(function(n){if('true'!==n.getRawData()){for(var e=t.getChildControlByName('InOutDocumentButtons').getChildControlByName('addDocumentButton'),o=e._options.docTypes,a=0;a<o.length;a++)if('ДоговорДок'===o[a].docType)o[a].docType='ДоговорВх';e.setDocTypes(o);}}),new o({endpoint:'ГлобальныеПараметрыКлиента'}).call('ПолучитьЗначение',{'Путь':'unit_reconciliations_converted'}).addCallback(function(n){if('true'!==n.getRawData()){for(var e=t.getChildControlByName('InOutDocumentButtons').getChildControlByName('addDocumentButton'),o=e._options.docTypes,a=0;a<o.length;a++)if('АктСверкиДок'===o[a].docType)o[a].docType='АктСверВх';e.setDocTypes(o);}});},onTabAndMainLoaded:function(t,n){if('StatTab'!=n)e.initTaskButtons({mainObject:this.getCurrentTabArea('main'),tabsObject:this.getCurrentTabArea('tabs'),btnDocName:'addDocumentButton',brwName:'IncomingEventsBrowser',actionName:'IncomingEventsAction',folderButtonName:null,rootFolderName:null,folderAction:null,dialogComponents:{'bc5f60fd-2633-45e0-a817-41a89910d074':'js!SBIS3.EDO.ReconciliationReportIn','534888e6-8c29-4c11-9530-774d485b639b':'js!SBIS3.EDO.ReconciliationReportIn','635f32d6-974d-4096-935a-44822f8672d0':'js!SBIS3.EDO.FContractIn','904203de-34b9-411d-bd05-e51e6b91ab40':'js!SBIS3.EDO.FContractOut','fdbbfd83-64f6-4ae1-9761-625b114ec4bd':'js!SBIS3.EDO.ReconciliationReportOut'}});}});return c;});
define("html!SBIS3.EDO.LetterEditor",function(){var o=function(o){var n=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;o.test(n);)n=n.replace(o,"&#123;&#123;$1&#125;&#125;");return n}}(),t=function(o){return o.join?o.join(""):o.toString()},e=function(o){return void 0===o?"":o&&"object"==typeof o?t(o):""+o},i="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="edo-LetterEditor"> <component data-component=\'SBIS3.CONTROLS/RichEditor\'> <option name="name" value="RichEditor"></option> <option name="className" value="edo-LetterEditor_dataReviewCollapsed"></option> <option name="text" bind="record/ДокументРасширение.Название"></option> <option name="highlightLinks" type="boolean" value="true"></option> <option name=\'verticalAlignment\' value=\'Top\'></option> <option name="autoHeight" type="boolean" value="true"></option> <option name="minimalHeight" value="60"></option> <option name="maximalHeight" value="0"></option> <option name="hideBorder" type="boolean" value="true"></option> <option name="tooltip" value="'+n(e(rk("Текст письма")))+'"></option> <options name="handlers"> <options name="onInitEditor" type="array"> <option name="onInitEditor" type="function" value="js!SBIS3.EDO.LetterEditor:prototype.onInitEditor"></option> </options> </options> <options name="userItems"> <options name="image"> <options name="config"> <option name="visible" type="boolean" value="false"></option> </options> </options> <options name="source"> <options name="config"> <option name="visible" type="boolean" value="false"></option> </options> </options> <options name="ТекстИзПредПисьма"> <option name="type" type="string" value="button"></option> <options name="config"> <option name="tooltip" type="string" value="'+n(e(rk("Вставить текст предыдущего письма")))+'"></option> <option name="image" type="string" value="sprite:icon-16 icon-PasteTextLetter icon-primary"></option> <options name="handlers"> <option name="onActivated" type="function" value="js!SBIS3.EDO.LetterEditor:prototype.textFromPrevLetter"></option> </options> <option name="visible" type="boolean" value="false"></option> <option name="enabled" type="boolean" value="true"></option> </options> </options> </options> </component> <div class="edo-LetterEditor_iconButton_wrapper"> <component data-component=\'SBIS3.CONTROLS/Button/IconButton\'> <option name="name">iconResizeDataReview</option> <option name="class">edo-LetterEditor_iconButton</option> <option name="icon">icon-32 icon-AccordionArrowDown icon-disabled action-hover</option> <option name="tooltip">Развернуть</option> <option name="visible">false</option> <option name="allowChangeEnable" type="boolean">false</option> </component> </div> </div> ');return(a=n(a))+(i&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.LetterEditor"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.LetterEditor", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-LetterEditor{padding:0 12px 0 12px}.edo-LetterEditor_dataReviewCollapsed .controls-RichEditor__dataReview{max-height:308px;overflow-y:visible!important}.edo-LetterEditor_iconButton{margin-left:48%}.edo-LetterEditor_shadow::after{width:100%;content:' ';height:32px;position:absolute;margin-top:-32px;background:linear-gradient(to bottom,rgba(255,255,255,0) 0,rgba(255,255,255,1) 100%)}.edo-LetterEditor .controls-RichEditor__dataReview{min-height:0!important}"));head.appendChild(style);});}
define('js!SBIS3.EDO.LetterEditor',['WS.Data/Source/SbisService','Core/helpers/fast-control-helpers','Lib/Control/CompoundControl/CompoundControl','html!SBIS3.EDO.LetterEditor','SBIS3.CONTROLS/RichEditor','SBIS3.CONTROLS/Button/IconButton','css!SBIS3.EDO.LetterEditor','Elektronnyj_dokumentooborot_localization'],function(t,e,i,o){'use strict';var n=i.extend({_dotTplFn:o,$protected:{_options:{},_$stateIconResize:{visible:false,isArrowDown:true,collapsible:{icon:'icon-32 icon-AccordionArrowUp icon-disabled action-hover',title:'Свернуть'},expandable:{icon:'icon-32 icon-AccordionArrowDown icon-disabled action-hover',title:'Развернуть'}}},$constructor:function(){this.once('onReady',function(){this._setVisibleIconResize(),this._setHandlers();}.bind(this));},_setVisibleIconResize:function(t){var e=function(t){var e=t?'addClass':'removeClass';this._$stateIconResize.visible=t,this.getChildControlByName('iconResizeDataReview').setVisible(t),this.getChildControlByName('RichEditor').getContainer()[e]('edo-LetterEditor_shadow');}.bind(this);if('edit'===t)e(false);else if('save'===t)e(o=this.getContainer().find('.controls-RichEditor__editorFrame').height()>=300);else{var i=this.getLinkedContext(),o=this.getContainer().find('.controls-RichEditor__dataReview').height()>=300&&!i.getValue('record/enabled');e(o);}},_setHandlers:function(){var t=this.getContainer().closest('.ws-scrolling-content'),e=this.getChildControlByName('RichEditor').getContainer(),i=this.getChildControlByName('iconResizeDataReview'),o=function(o){var n=o?'removeClass':'addClass',s=o?this._$stateIconResize.collapsible:this._$stateIconResize.expandable;if(this._$stateIconResize.isArrowDown=!o,t&&!o)t.animate({scrollTop:0},0);e[n]('edo-LetterEditor_dataReviewCollapsed'),e[n]('edo-LetterEditor_shadow'),i.setIcon(s.icon),i.setTooltip(s.title);}.bind(this);i.subscribe('onActivated',function(){o(this._$stateIconResize.isArrowDown);}.bind(this));},init:function(){n.superclass.init.apply(this,arguments);},textFromPrevLetter:function(i){var o=this.getOwner();new t({endpoint:'КоррИсх'}).call('ТекстДокОснования',{'ИдО':o.getLinkedContext().getValue('@Документ')}).addCallback(function(t){if(t.getScalar())o.insertHtml('<blockquote>'+t.getScalar()+'</blockquote><br/>');}).addErrback(function(t){e.alert(t.message);});},onInitEditor:function(){if(this.getTopParent().getLinkedContext().getValue('РП.ЕстьПредПисьмо'))this.getToolbarItem('ТекстИзПредПисьма').show();}});return n;});
define("tmpl!SBIS3.EDO.Letter.Dialog",["Core/tmpl/js/tclosure","js!SBIS3.EDO2.Dialog","js!SBIS3.Contragents.ChoiceOurCompanyLink","js!SBIS3.EDO2.MainTabHeader","js!SBIS3.CONTROLS/Link","js!SBIS3.AddresseeChoice.FieldLink","js!SBIS3.EDO2.Sticker","js!SBIS3.EDO.LetterEditor","js!SBIS3.EDO2.AttachButton","js!SBIS3.EDO2.CreateButton","js!SBIS3.EDO2.Viewer"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],o={};o["js!SBIS3.EDO2.Dialog"]=e[1],o["js!SBIS3.Contragents.ChoiceOurCompanyLink"]=e[2],o["js!SBIS3.EDO2.MainTabHeader"]=e[3],o["js!SBIS3.CONTROLS/Link"]=e[4],o["js!SBIS3.AddresseeChoice.FieldLink"]=e[5],o["js!SBIS3.EDO2.Sticker"]=e[6],o["js!SBIS3.EDO.LetterEditor"]=e[7],o["js!SBIS3.EDO2.AttachButton"]=e[8],o["js!SBIS3.EDO2.CreateButton"]=e[9],o["js!SBIS3.EDO2.Viewer"]=e[10];var r=function e(r,i,a,n,s){function l(){}var c=0,d=void 0!==t&&t?t:arguments[arguments.length-1];void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure"));var p={};s&&s.isSetts&&(p=s.fullContext||{});var m="string"==typeof a?a:"",u=void 0===o?void 0:o,v={id:[],def:void 0},g=d.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,r),h=this&&this.includedTemplates?this.includedTemplates:{},f=d.getMarkupGenerator(n);try{var S=f.joinElements([f.createTag("div",{class:"edo-LetterDialog"},[f.createControl("wsControl","ws:SBIS3.EDO2.Dialog",{firstLineContent:d.createDataArray([(new function(){var e=Object.create(r),t=function e(t,o,r,i,a){if(void 0===r)var r=arguments[2];var n=0,s="firstLineContent";if(void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure")),a&&a.isSetts)var l=a.fullContext||{};t=d.isolateScope(Object.create(this),t,s);var c="string"==typeof r?r:"",p={id:[],def:void 0},m=this&&this.includedTemplates?this.includedTemplates:{},v=d.getMarkupGenerator(i);try{var h=v.joinElements([v.createTag("div",{class:"edo-LetterDialog__choiceOurCompanyLink-container"},[v.createControl("wsControl","ws:SBIS3.Contragents.ChoiceOurCompanyLink",{componentOptions:{ShowInnerCompany:!0,ourCompany:!1,ScopesAreas:[d.getter(t,["scopeArea"])],ShowAllCompany:!1,withAffiliates:!0,openCardCompany:void 0},selectedItem:{"@Лицо":void 0,"Название":void 0},multiselect:!1,className:"edo-LetterDialog__choiceOurCompanyLink controls-SelectorButton__asLink",enabled:!0,allowChangeEnable:!1,idProperty:"@Лицо",esc:!1,bindings:[{fieldName:"record/isOpenCardCompany",propName:"componentOptions/openCardCompany",propPath:["openCardCompany"],fullPropName:"componentOptions/openCardCompany",propPathStr:"openCardCompany",oneWay:!0,direction:"fromContext",bindNonExistent:!1},{fieldName:"record/ДокументНашаОрганизация",propName:"selectedItem/@Лицо",propPath:["@Лицо"],fullPropName:"selectedItem/@Лицо",propPathStr:"@Лицо",oneWay:!0,direction:"fromContext",bindNonExistent:!1},{fieldName:"record/ДокументНашаОрганизация.Контрагент.Название",propName:"selectedItem/Название",propPath:["Название"],fullPropName:"selectedItem/Название",propPathStr:"Название",oneWay:!0,direction:"fromContext",bindNonExistent:!1}]},{},{data:t,ctx:this,pName:void 0!==s?s:void 0,viewController:g,internal:{__dirtyCheckingVars_2:[d.getter(t,["scopeArea"])]}},r,u,m,d.config,l)],o,p,this)],c,p);p.def&&(h=v.chain(h,p,o),p=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/Letters/DialogBase/Dialog.tmpl",e,t)}return h||""};this.func=d.makeFunctionSerializable(t,e)}).func]),tabs:[{title:d.createDataArray([(new function(){var e=Object.create(r),t=function e(t,o,r,i,a){if(void 0===r)var r=arguments[2];var n=0,s="title";if(void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure")),a&&a.isSetts)var l=a.fullContext||{};t=d.isolateScope(Object.create(this),t,s);var c="string"==typeof r?r:"",p={id:[],def:void 0},m=this&&this.includedTemplates?this.includedTemplates:{},v=d.getMarkupGenerator(i);try{var h=v.joinElements([v.createControl("wsControl","ws:SBIS3.EDO2.MainTabHeader",{docType:d.getter(t,["objectName"])},d.plainMerge(o,{}),{data:t,ctx:this,pName:void 0!==s?s:void 0,viewController:g},r,u,m,d.config,l)],c,p);p.def&&(h=v.chain(h,p,o),p=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/Letters/DialogBase/Dialog.tmpl",e,t)}return h||""};this.func=d.makeFunctionSerializable(t,e)}).func]),content:d.createDataArray([(new function(){var e=Object.create(r),t=function e(t,o,r,i,a){if(void 0===r)var r=arguments[2];var n=0,s="content";if(void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure")),a&&a.isSetts)var l=a.fullContext||{};t=d.isolateScope(Object.create(this),t,s);var c="string"==typeof r?r:"",p={id:[],def:void 0},m=this&&this.includedTemplates?this.includedTemplates:{},v=d.getMarkupGenerator(i);try{var h=v.joinElements([v.createTag("div",{class:"edo-LetterDialog__header"},[v.createTag("div",{class:"edo-LetterDialog__addresseeChoice-container"},[v.createControl("wsControl","ws:SBIS3.CONTROLS/Link",{name:"AddresseeChoiceLink",caption:d.getter(t,["incoming"])?global.rk.apply(t,["Отправитель"]):global.rk.apply(t,["Получатель"]),tabindex:0},{class:"edo-LetterDialog__addresseeChoice-link",name:"AddresseeChoiceLink",sbisname:"AddresseeChoiceLink"},{data:t,ctx:this,pName:void 0!==s?s:void 0,viewController:g},r,u,m,d.config,l),v.createControl("wsControl","ws:SBIS3.AddresseeChoice.FieldLink",{selectedItem:{"@Лицо":void 0,"Название":void 0,"ИНН":void 0},validators:[{validator:d.getTypeFunc("SBIS3.CONTROLS/Utils/ControlsValidators:required",{}),errorMessage:global.rk("Укажите контрагента"),option:"selectedKeys"}],name:"LetterFieldLink",autoShow:!1,contacts:!1,representativeChoice:!d.getter(t,["incoming"]),bindings:[{fieldName:"record/РП.Документ/Состояние/Подписание/Ответственный/Профиль",propName:"representative",propPath:[],fullPropName:"representative",propPathStr:"",oneWay:!0,direction:"fromContext",bindNonExistent:!1},{fieldName:"record/Лицо1",propName:"selectedItem/@Лицо",propPath:["@Лицо"],fullPropName:"selectedItem/@Лицо",propPathStr:"@Лицо",oneWay:!0,direction:"fromContext",bindNonExistent:!1},{fieldName:"record/Лицо1.Название",propName:"selectedItem/Название",propPath:["Название"],fullPropName:"selectedItem/Название",propPathStr:"Название",oneWay:!0,direction:"fromContext",bindNonExistent:!1},{fieldName:"record/Контрагент.ИНН",propName:"selectedItem/ИНН",propPath:["ИНН"],fullPropName:"selectedItem/ИНН",propPathStr:"ИНН",oneWay:!0,direction:"fromContext",bindNonExistent:!1}],representative:void 0,placeholder:global.rk("Название контрагента или ИНН"),allowContragentChoice:!0,multiselect:!1,favoritesOnly:!1,tabindex:1,esc:!1},{class:"edo-LetterDialog__addresseeChoice-fieldLink ws-autofocus",name:"LetterFieldLink",sbisname:"LetterFieldLink"},{data:t,ctx:this,pName:void 0!==s?s:void 0,viewController:g},r,u,m,d.config,l)],{},p,this),v.createTag("div",{class:"edo-LetterDialog__header-rightSide"},[v.createControl("resolver",d.getter(t,["letterDetailsTemplate"]),d.uniteScope(d.utils.escape(d.uniteScope(t,{parent:void 0,element:void 0})(d.plainMerge)),{showRespondButton:"КоррВх"==d.getter(t,["objectName"])}),{},{data:t,ctx:this,pName:void 0!==s?s:void 0,viewController:g},r,u,m,d.config,l,p),v.createControl("wsControl","ws:SBIS3.EDO2.Sticker",{mayDeleteResponsible:!1,showContractorInfo:!0,mini:!1,tabindex:0},{class:"edo-LetterDialog__sticker"},{data:t,ctx:this,pName:void 0!==s?s:void 0,viewController:g},r,u,m,d.config,l)],{},p,this)],o,p,this)],c,p);p.def&&(h=v.chain(h,p,o),p=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/Letters/DialogBase/Dialog.tmpl",e,t)}return h||""};this.func=d.makeFunctionSerializable(t,e)}).func,(new function(){var e=Object.create(r),t=function e(t,o,r,i,a){if(void 0===r)var r=arguments[2];var n=0,s="content";if(void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure")),a&&a.isSetts)var l=a.fullContext||{};t=d.isolateScope(Object.create(this),t,s);var c="string"==typeof r?r:"",p={id:[],def:void 0},m=this&&this.includedTemplates?this.includedTemplates:{},v=d.getMarkupGenerator(i);try{var h=v.joinElements([v.createTag("div",{},[v.createControl("wsControl","ws:SBIS3.EDO.LetterEditor",{name:"LetterEditor"},{name:"LetterEditor",sbisname:"LetterEditor"},{data:t,ctx:this,pName:void 0!==s?s:void 0,viewController:g},r,u,m,d.config,l)],o,p,this)],c,p);p.def&&(h=v.chain(h,p,o),p=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/Letters/DialogBase/Dialog.tmpl",e,t)}return h||""};this.func=d.makeFunctionSerializable(t,e)}).func,(new function(){var e=Object.create(r),t=function e(t,o,r,i,a){if(void 0===r)var r=arguments[2];var n=0,s="content";if(void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure")),a&&a.isSetts)var l=a.fullContext||{};t=d.isolateScope(Object.create(this),t,s);var c="string"==typeof r?r:"",p={id:[],def:void 0},m=this&&this.includedTemplates?this.includedTemplates:{},v=d.getMarkupGenerator(i);try{var h=v.joinElements([v.createTag("div",{class:"edo-LetterDialog__attach-container"},[v.createTag("div",{class:"edo-LetterDialog__attach-item Report__Attach_file"},[v.createControl("wsControl","ws:SBIS3.EDO2.AttachButton",{objectName:d.getter(t,["objectName"]),canAttachExternalLinks:!0},{},{data:t,ctx:this,pName:void 0!==s?s:void 0,viewController:g},r,u,m,d.config,l)],{},p,this),v.createTag("div",{class:"edo-LetterDialog__attach-item Report__Attach_external"},[v.createControl("wsControl","ws:SBIS3.EDO2.CreateButton",{objectName:d.getter(t,["objectName"])},{},{data:t,ctx:this,pName:void 0!==s?s:void 0,viewController:g},r,u,m,d.config,l)],{},p,this)],o,p,this)],c,p);p.def&&(h=v.chain(h,p,o),p=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/Letters/DialogBase/Dialog.tmpl",e,t)}return h||""};this.func=d.makeFunctionSerializable(t,e)}).func,(new function(){var e=Object.create(r),t=function e(t,o,r,i,a){if(void 0===r)var r=arguments[2];var n=0,s="content";if(void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure")),a&&a.isSetts)var l=a.fullContext||{};t=d.isolateScope(Object.create(this),t,s);var c="string"==typeof r?r:"",p={id:[],def:void 0},m=this&&this.includedTemplates?this.includedTemplates:{},v=d.getMarkupGenerator(i);try{var h=v.joinElements([v.createTag("div",{class:"edo-Viewer"},[v.createControl("wsControl","ws:SBIS3.EDO2.Viewer",{},{},{data:t,ctx:this,pName:void 0!==s?s:void 0,viewController:g},r,u,m,d.config,l)],o,p,this)],c,p);p.def&&(h=v.chain(h,p,o),p=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/Letters/DialogBase/Dialog.tmpl",e,t)}return h||""};this.func=d.makeFunctionSerializable(t,e)}).func]),className:"controls-TabButton__main-item",id:"firstTab"}],name:"LetterDialog",objectName:d.getter(r,["objectName"]),stickyHeader:!0,fullTrace:{showToolbar:!1},esc:!1},{name:"LetterDialog",sbisname:"LetterDialog"},{data:r,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:g,internal:{__dirtyCheckingVars_2:[d.getter(r,["scopeArea"])],__dirtyCheckingVars_8:d.getter(r,["objectName"]),__dirtyCheckingVars_9:d.getter(r,["incoming"])&&(d.getter(r,["incoming"])?global.rk.apply(r,["Отправитель"]):global.rk.apply(r,["Получатель"])),__dirtyCheckingVars_14:!d.getter(r,["incoming"]),__dirtyCheckingVars_20:d.getter(r,["letterDetailsTemplate"]),__dirtyCheckingVars_21:"КоррВх"==d.getter(r,["objectName"]),__dirtyCheckingVars_23:d.getter(r,["letterDetailsTemplate"]),__dirtyCheckingVars_28:d.getter(r,["objectName"]),__dirtyCheckingVars_30:d.getter(r,["objectName"])}},a,u,h,d.config,p)],i,v,this)],m,v);v.def&&(S=f.chain(S,v,i),v=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/Letters/DialogBase/Dialog.tmpl",e,r)}return S||""};return r.includedFunctions={},r.stable=!0,r.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.Letter.Dialog"}},r});
define("tmpl!SBIS3.EDO.LetterRegistrationButton",["Core/tmpl/js/tclosure","js!SBIS3.CONTROLS/Label","js!SBIS3.CONTROLS/Link"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],o={};o["js!SBIS3.CONTROLS/Label"]=e[1],o["js!SBIS3.CONTROLS/Link"]=e[2];var i=function e(i,r,n,a,l){function s(){}var c=0,d=void 0!==t&&t?t:arguments[arguments.length-1];void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure"));var p={};l&&l.isSetts&&(p=l.fullContext||{});var m="string"==typeof n?n:"",u=void 0===o?void 0:o,N={id:[],def:void 0},v=d.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,i),g=this&&this.includedTemplates?this.includedTemplates:{},f=d.getMarkupGenerator(a);try{var b=f.joinElements([f.createTag("div",{class:"edo-LetterRegistrationButton"},[f.createControl("wsControl","ws:SBIS3.CONTROLS/Label",{className:"edo-LetterRegistrationButton__label",caption:d.getter(i,["headerTitle"]),bindings:[{fieldName:"record/docRegistration/visible",propName:"visible",propPath:[],fullPropName:"visible",propPathStr:"",oneWay:!0,direction:"fromContext",bindNonExistent:!0}],visible:!1,enabled:!1,allowChangeEnable:!1},{},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:v},n,u,g,d.config,p),f.createTag("div",{class:"edo-LetterRegistrationButton__body"},[f.createControl("wsControl","ws:SBIS3.CONTROLS/Link",{name:"link",className:"edo-LetterRegistrationButton__link",bindings:[{fieldName:"record/docRegistration/visible",propName:"visible",propPath:[],fullPropName:"visible",propPathStr:"",oneWay:!0,direction:"fromContext",bindNonExistent:!0},{fieldName:"record/docRegistration/caption",propName:"caption",propPath:[],fullPropName:"caption",propPathStr:"",oneWay:!0,direction:"fromContext",bindNonExistent:!0}],visible:!1,caption:"",allowChangeEnable:!1,command:"showRegistrationDialog"},{name:"link",sbisname:"link"},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:v},n,u,g,d.config,p),f.createControl("wsControl","ws:SBIS3.CONTROLS/Link",{icon:"icon-16 icon-Close icon-disabled action-hover",className:"edo-LetterRegistrationButton__link-close",allowChangeEnable:!1,bindings:[{fieldName:"record/docRegistration/visible",propName:"visible",propPath:[],fullPropName:"visible",propPathStr:"",oneWay:!0,direction:"fromContext",bindNonExistent:!0}],visible:!1,command:"clearRegistrationData"},{},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:v},n,u,g,d.config,p)],{},N,this)],r,N,this)],m,N);N.def&&(b=f.chain(b,N,r),N=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/components/Registry/Documents/Letters/EDO2DialogLetter/resources/LetterDetails/LetterRegistrationButton/LetterRegistrationButton.tmpl",e,i)}return b||""};return i.includedFunctions={},i.stable=!0,i.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.LetterRegistrationButton"}},i});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.LetterRegistrationButton", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-LetterRegistrationButton{text-align:right}.edo-LetterRegistrationButton__label{color:#999!important;margin:0!important;cursor:default!important;height:18px!important;line-height:18px!important}.edo-LetterRegistrationButton__body{line-height:18px}.edo-LetterRegistrationButton__body>span{height:18px;line-height:18px}.edo-LetterRegistrationButton__link-close{width:13px}.edo-LetterRegistrationButton__link{max-width:154px}"));head.appendChild(style);});}
define('js!SBIS3.EDO.LetterRegistrationButton',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.LetterRegistrationButton','Core/CommandDispatcher','Core/helpers/fast-control-helpers','css!SBIS3.EDO.LetterRegistrationButton','Elektronnyj_dokumentooborot_localization'],function(t,e,o,n){'use strict';return t.extend({_dotTplFn:e,$protected:{_options:{}},$constructor:function(){this.once('onReady',function(){this._declareCommand();}.bind(this));},_declareCommand:function(){o.declareCommand(this,'showRegistrationDialog',function(){n.showFloatArea({animation:'fade',side:'right',verticalAlign:'top',direction:'bottom',template:'js!SBIS3.EDO.LetterRegistrationDialog',autoHide:true,opener:this,parent:this,target:this.getContainer(),border:false,autoCloseOnHide:true,trackTarget:false,offset:{x:4,y:-1},componentOptions:{headerTitle:this._options.headerTitle}});}.bind(this)),o.declareCommand(this,'clearRegistrationData',function(){this.getLinkedContext().setValue('record/ДанныеДокумента.НомерУКонтрагента',null),this.getLinkedContext().setValue('record/ДанныеДокумента.ДатаРегистрации',null);}.bind(this));}});});
define("tmpl!SBIS3.EDO.Letter.Dialog/LetterDetailsTemplate",["Core/tmpl/js/tclosure","js!SBIS3.CONTROLS/DropdownList","js!SBIS3.CONTROLS/Link","js!SBIS3.EDO2.RulesSelector","js!SBIS3.CONTROLS/Menu/MenuLink","js!SBIS3.EDO.LetterRegistrationButton","js!SBIS3.CONTROLS/Label","js!SBIS3.CONTROLS/SelectorButton"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.CONTROLS/DropdownList"]=e[1],r["js!SBIS3.CONTROLS/Link"]=e[2],r["js!SBIS3.EDO2.RulesSelector"]=e[3],r["js!SBIS3.CONTROLS/Menu/MenuLink"]=e[4],r["js!SBIS3.EDO.LetterRegistrationButton"]=e[5],r["js!SBIS3.CONTROLS/Label"]=e[6],r["js!SBIS3.CONTROLS/SelectorButton"]=e[7];var o=function e(o,i,n,a,l){function s(){}var p=0,c=void 0!==t&&t?t:arguments[arguments.length-1];void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure"));var d={};l&&l.isSetts&&(d=l.fullContext||{});var u="string"==typeof n?n:"",m=void 0===r?void 0:r,S={id:[],def:void 0},y=c.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),v=this&&this.includedTemplates?this.includedTemplates:{},L=c.getMarkupGenerator(a);try{var b=L.joinElements([L.createTag("div",{class:"edo-LetterDetails"},[L.createTag("div",{class:"edo-LetterDetails__dropdownList-container"},[L.createControl("wsControl","ws:SBIS3.CONTROLS/DropdownList",{name:"DropdownListDelivery",idProperty:"key",displayProperty:"title",mode:"click",multiselect:!1,bindings:[{fieldName:"record/deliveryListVisible",propName:"visible",propPath:[],fullPropName:"visible",propPathStr:"",oneWay:!0,direction:"fromContext",bindNonExistent:!0},{fieldName:"record/deliveryListKey",propName:"selectedKeys",propPath:[],fullPropName:"selectedKeys",propPathStr:"",oneWay:!1,direction:"fromContext",bindNonExistent:!0}],visible:!1,allowChangeEnable:!0,emptyValue:!0,selectedKeys:[null],items:[{key:"0",title:global.rk.apply(o,["Почтой"])},{key:"1",title:global.rk.apply(o,["На e-mail"])},{key:"2",title:global.rk.apply(o,["Доставка курьером"])},{key:"3",title:global.rk.apply(o,["По факсу"])},{key:"4",title:global.rk.apply(o,["Телефонограммой"])},{key:"5",title:global.rk.apply(o,["Электронно"])},{key:"6",title:global.rk.apply(o,["Доставка нашим сотрудником"])},{key:"7",title:global.rk.apply(o,["Заказным письмом"])},{key:"8",title:global.rk.apply(o,["Ценным письмом"])},{key:"10",title:global.rk.apply(o,["Экспресс-почтой"])}]},{class:"edo-LetterDetails__dropdownList",name:"DropdownListDelivery",sbisname:"DropdownListDelivery"},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},n,m,v,c.config,d)],{},S,this),L.createTag("div",{class:"edo-LetterDetails_linkAnswer_wrapper"},[L.createControl("wsControl","ws:SBIS3.CONTROLS/Link",{handlers:{onActivated:c.getTypeFunc("js!SBIS3.EDO.Letter.Handlers:onOpenDocumentActivated",{})},name:"LinkAnswer",allowChangeEnable:!1,bindings:[{fieldName:"record/letterDetails/linkAnswer/visible",propName:"visible",propPath:[],fullPropName:"visible",propPathStr:"",oneWay:!0,direction:"fromContext",bindNonExistent:!0},{fieldName:"record/letterDetails/linkAnswer/caption",propName:"caption",propPath:[],fullPropName:"caption",propPathStr:"",oneWay:!0,direction:"fromContext",bindNonExistent:!0}],visible:!1,caption:!0,esc:!1},{class:"edo-LetterDetails_linkAnswer",name:"LinkAnswer",sbisname:"LinkAnswer"},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},n,m,v,c.config,d)],{},S,this),c.getter(o,["showRespondButton"])?[L.createTag("div",{class:"edo-LetterDetails_rulesSelector_wrapper"},[L.createControl("wsControl","ws:SBIS3.EDO2.RulesSelector",{content:c.createDataArray([(new function(){var e=Object.create(o),t=function e(t,r,o,i,n){if(void 0===o)var o=arguments[2];var a=0,l="content";if(void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure")),n&&n.isSetts)var s=n.fullContext||{};t=c.isolateScope(Object.create(this),t,l);var p="string"==typeof o?o:"",d={id:[],def:void 0},u=this&&this.includedTemplates?this.includedTemplates:{},S=c.getMarkupGenerator(i);try{var v=S.joinElements([S.createControl("wsControl","ws:SBIS3.CONTROLS/Menu/MenuLink",{handlers:{onMenuItemActivate:c.getTypeFunc("js!SBIS3.EDO.Letter.Handlers:MenuLinkOnMenuItemActivate",{})},name:"ruleSelectorMenuLink",caption:global.rk("Ответить"),allowChangeEnable:!1,idProperty:"id",esc:!1},c.plainMerge(r,{class:"edo-LetterDetails_menuLink",name:"ruleSelectorMenuLink",sbisname:"ruleSelectorMenuLink"}),{data:t,ctx:this,pName:void 0!==l?l:void 0,viewController:y},o,m,u,c.config,s)],p,d);d.def&&(v=S.chain(v,d,r),d=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/Letters/DialogBase/LetterDetailsTemplate.tmpl",e,t)}return v||""};this.func=c.makeFunctionSerializable(t,e)}).func]),name:"linkRespondRulesSelector",allowChangeEnable:!1,bindings:[{fieldName:"record/letterDetails/linkRespond/visible",propName:"visible",propPath:[],fullPropName:"visible",propPathStr:"",oneWay:!0,direction:"fromContext",bindNonExistent:!0}],visible:!1,docTypes:[{docType:"КоррИсх"}],esc:!1},{name:"linkRespondRulesSelector",sbisname:"linkRespondRulesSelector"},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},n,m,v,c.config,d)],{},S,this)]:L.createText(""),L.createTag("div",{class:"edo-LetterDetails_linkCorrList_wrapper"},[L.createControl("wsControl","ws:SBIS3.CONTROLS/Link",{handlers:{onActivated:c.getTypeFunc("js!SBIS3.EDO.Letter.Handlers:onShowCorrListActivated",{})},name:"LinkCorrList",caption:global.rk("Вся переписка"),bindings:[{fieldName:"record/РП.ЕстьПереписка",propName:"visible",propPath:[],fullPropName:"visible",propPathStr:"",oneWay:!0,direction:"fromContext",bindNonExistent:!0}],visible:!1,allowChangeEnable:!1,esc:!1},{class:"edo-LetterDetails_linkCorrList",name:"LinkCorrList",sbisname:"LinkCorrList"},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},n,m,v,c.config,d)],{},S,this),L.createControl("wsControl","ws:SBIS3.EDO.LetterRegistrationButton",{name:"letterRegistrationButton",headerTitle:c.getter(o,["showRespondButton"])?"Регистрация у отправителя":"Регистрация у получателя"},{name:"letterRegistrationButton",sbisname:"letterRegistrationButton"},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},n,m,v,c.config,d),L.createTag("div",{class:"edo-LetterDetails_selectorButton_wrapper"},[L.createControl("wsControl","ws:SBIS3.CONTROLS/Label",{className:"edo-LetterRegistrationButton__label",caption:global.rk("Местонахождение оригинала"),bindings:[{fieldName:"record/locationOrigVisible",propName:"visible",propPath:[],fullPropName:"visible",propPathStr:"",oneWay:!0,direction:"fromContext",bindNonExistent:!0}],visible:!1,enabled:!1,allowChangeEnable:!1},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},n,m,v,c.config,d),L.createControl("wsControl","ws:SBIS3.CONTROLS/SelectorButton",{name:"SelectorButtonLocationOrig",allowChangeEnable:!1,bindings:[{fieldName:"record/locationOrigVisible",propName:"visible",propPath:[],fullPropName:"visible",propPathStr:"",oneWay:!0,direction:"fromContext",bindNonExistent:!0},{fieldName:"record/locationOrigKey",propName:"selectedKeys",propPath:[],fullPropName:"selectedKeys",propPathStr:"",oneWay:!1,direction:"fromContext",bindNonExistent:!0}],visible:!1,selectedKeys:[null],useSelectorAction:!0,dictionaries:[{name:"СтруктураПредприятия",template:"js!SBIS3.Staff.DepartmentChoice.List",readOnly:!0,componentOptions:{multiselect:!1}}],idProperty:"@Лицо",displayProperty:"Название",chooserMode:"floatArea",multiselect:!1,dataSource:{module:"WS.Data/Source/SbisService",options:{endpoint:{contract:"СтруктураПредприятия"}},binding:{read:"Прочитать"},idProperty:"@Лицо"}},{class:"edo-LetterDetails_selectorButton",name:"SelectorButtonLocationOrig",sbisname:"SelectorButtonLocationOrig"},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},n,m,v,c.config,d)],{},S,this)],i,S,this)],u,S);S.def&&(b=L.chain(b,S,i),S=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/Letters/DialogBase/LetterDetailsTemplate.tmpl",e,o)}return b||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.Letter.Dialog/LetterDetailsTemplate"}},o});
define('js!SBIS3.EDO.Letter.Handlers',['Core/core-attach','WS.Data/Source/SbisService','WS.Data/Entity/Record','Core/Indicator','Core/EventBus','Core/Context','js!SBIS3.EDO2.OpenDialogAction','WS.Data/Adapter/Sbis','Elektronnyj_dokumentooborot_localization'],function(e,t,n,o,a,i,r){'use strict';var l;return l={onOrigPlaceMenu:function(){var e=this.getTopParent().getChildControlByName('SelectorButtonLocationOrig'),t=e._options.dictionaries[0];e._getSelectorAction().execute({template:t.template,componentOptions:t.componentOptions||{},multiselect:e.getMultiselect(),selectionType:t.selectionType||'all'});},onDeliveryChange:function(e){var t=this.getChildControlByName('DropdownListDelivery');if(void 0!==e)t.setSelectedKeys([e]);},onStartSending:function(){new t({endpoint:'КоррИсх'}).call('УстановитьСпособДоставки',{'ИдО':parseInt(this.getLinkedContext().getValue('record').get('@Документ'),10),'Доставка':5});},onOpenDocumentActivated:function(){var e=new r.prototype.$constructor();e.execute({id:parseInt(this.getLinkedContext().getValue('record').get('Ответ').get('@Документ'),10),initializingWay:'delayRemote'}),e.getLinkedContext().setValue('record',this.getLinkedContext().getValue('record')),e.getLinkedContext().setValue('dlg',this.getTopParent()),e.once('onExecuted',l.panel_onClose_handler);},MenuLinkOnMenuItemActivate:function(e,a){var i=this,d=i.getItems().getRecordById(a);if(d&&!d.get('Раздел@')){var s=parseInt(i.getLinkedContext().getValue('record').get('Лицо1'),10),c=d.get('Идентификатор')||'ad2d4160-6303-475d-bf4b-6a7b25459286',g=new n({rawData:{_type:'record',d:[s,true,c],s:[{n:'Лицо1',t:'Число целое'},{n:'ВызовИзБраузера',t:'Логическое'},{n:'ИдРегламента',t:'Строка'}]},adapter:'adapter.sbis'});o.show(),new t({endpoint:'КоррИсх'}).call('Создать',{'ИмяМетода':'КоррИсх.Список','Фильтр':g}).addCallback(function(e){new t({endpoint:'Документ'}).call('СкопироватьВнешниеДокументы',{'ДокументОснование':parseInt(i.getLinkedContext().getValue('record').get('@Документ'),10),'ДокументСледствие':parseInt(e.getRow().get('@Документ'),10),'ВидСвязи':1,'СписокВД':[]}).addCallback(function(){o.hide();var t=new r.prototype.$constructor();t.execute({id:parseInt(e.getRow().get('@Документ'),10),initializingWay:'delayRemote'}),t.getLinkedContext().setValue('record',i.getLinkedContext().getValue('record')),t.getLinkedContext().setValue('dlg',i.getTopParent()),t.once('onExecuted',l.panel_onClose_handler);});}).addErrback(function(){o.hide();});}},panel_onClose_handler:function(e,n){var o=this,i=o.getLinkedContext().getValue('record'),r=i.get('ТипДокумента.ТипДокумента');new t({endpoint:r}).call('Прочитать',{'ИдО':parseInt(i.get('@Документ'),10),'ИмяМетода':r+'.Список'}).addCallback(function(e){var t=e.getRow().get('Ответ'),n=o.getLinkedContext().getValue('dlg'),r=t?t.get('@Документ'):null,l=i.get('Ответ')?i.get('Ответ').get('@Документ'):null;if(n.getChildControlByName('LinkAnswer')[t?'show':'hide'](),n.getChildControlByName('LinkCorrList')[e.getRow().get('РП.ЕстьПереписка')?'show':'hide'](),n.hasChildControlByName('linkRespondRulesSelector'))n.getChildControlByName('linkRespondRulesSelector')[t?'hide':'show']();if(!l&&r||r!==l)if(i.set('Ответ',t),i.set('РП.ЕстьПереписка',e.getRow().get('РП.ЕстьПереписка')),i.acceptChanges(['Ответ','РП.ЕстьПереписка']),a.channel('lettersChannel').notify('onCloseDialogAnswer',i),t)n.getChildControlByName('LinkAnswer').setCaption(rk('Ответ')+' '+t.get('Дата').strftime('%d.%m'));});},onShowCorrListActivated:function(){var t=this,n=t.getLinkedContext().getValue('record'),o=new i();o.setValue('ДокументПереписки',n.get('@Документ')),o.setValue('ДокументПерепискиТип',n.get('ТипДокумента.ТипДокумента'));var a={opener:t,className:'edo-floatAreaLetterList',autoCloseOnHide:true,template:'js!SBIS3.EDO.LetterList',target:t.getContainer(),side:'right',isStack:true,overlay:false,showDelay:300,animationLength:300,parent:null,width:800,autoWidth:false,keepSize:false,offset:{x:1,y:0},context:o};e.attachInstance('Lib/Control/FloatArea/FloatArea',a);}};});
define('js!SBIS3.EDO.LetterModel',['Core/constants','js!SBIS3.EDO2.EdoModel','WS.Data/Di','Core/RightsManager','i18n!SBIS3.EDO.LetterModel','Elektronnyj_dokumentooborot_localization'],function(e,i,n,t){'use strict';var r=i.extend({_moduleName:'SBIS3.EDO.LetterModel',constructor:function(e){r.superclass.constructor.call(this,e),this._$userServiceCommands[0].caption='КоррИсх'===this.get('ТипДокумента.ТипДокумента')?rk('Регистрация у получателя'):rk('Регистрация у отправителя');},_$properties:{letterDetails:{get:function(){var e={linkAnswer:{visible:false,caption:''},linkRespond:{visible:false},locationOrig:{visible:false},deliveryList:{visible:false,selectedKey:null}},i=this.get('Ответ'),n=['ДанныеДокумента.ДатаРегистрации','ДанныеДокумента.НомерУКонтрагента','ДанныеДокумента.Доставка','ДанныеДокумента.Местонахождение'],r,o;if(i&&i.get('Дата'))e.linkAnswer.visible=true,e.linkAnswer.caption='Ответ '+i.get('Дата').strftime('%d.%m');if(e.linkRespond.visible=!e.linkAnswer.visible&&t.getRights('Входящая корреспонденция')['Входящая корреспонденция']&t.WRITE_MASK,e.locationOrig.visible=!!this.get('ДанныеДокумента.Местонахождение'),e.deliveryList.visible=!!(this.get('ДанныеДокумента.Доставка')&&null!==this.get('ДанныеДокумента.Доставка').get()),e.deliveryList.visible)e.deliveryList.selectedKey=String(this.get('ДанныеДокумента.Доставка').get());return e;}},locationOrigVisible:{get:function(){return!!this.get('ДанныеДокумента.Местонахождение');}},locationOrigKey:{get:function(){if(this.get('locationOrigVisible'))return[String(this.get('ДанныеДокумента.Местонахождение'))];else return[null];},set:function(e){this.set('ДанныеДокумента.Местонахождение',!!e.length?e[0]:null);}},deliveryListVisible:{get:function(){return!!(this.get('ДанныеДокумента.Доставка')&&null!==this.get('ДанныеДокумента.Доставка').get());}},deliveryListKey:{get:function(){if(this.get('deliveryListVisible'))return[String(this.get('ДанныеДокумента.Доставка').get())];else return[null];},set:function(e){if(this.get('ДанныеДокумента.Доставка').get()!==(null===e[0]?null:parseInt(e[0],10)))this.set('ДанныеДокумента.Доставка',e[0]);}},docRegistration:{get:function(){var e={visible:false,caption:''},i=this.get('ДанныеДокумента.НомерУКонтрагента')||'',n=this.get('ДанныеДокумента.ДатаРегистрации')||'',t=function(e){var i=6;if(e.length>i)' '===e.charAt(i-1)&&--i,e=e.substr(0,i)+'...';return e;};if(e.visible=!!(i||n),i||n)e.visible=true,e.caption=(i?'\u2116 ':'')+t(i)+(i&&n?' от ':'')+(n&&n.strftime('%d.%m.%y'));return e;}},serviceCommandDeliveryVisible:{get:function(){return!(this.get('ДанныеДокумента.Доставка')&&null!==this.get('ДанныеДокумента.Доставка').get());}},serviceCommandEdoOrigPlaceVisible:{get:function(){return!this.get('ДанныеДокумента.Местонахождение');}},serviceCommandEdoRegDateVisible:{get:function(){return!(this.get('ДанныеДокумента.НомерУКонтрагента')||this.get('ДанныеДокумента.ДатаРегистрации'));}},isOpenCardCompany:{get:function(){if(this.get('isEditing')||this.get('enabled'))return false;return true;}},iconResizeVisible:{get:function(){return!this.get('enabled')&&this.get('isBigDataReview');}}},_$userServiceCommands:[{id:'edoRegDate',icon:'sprite:icon-24 icon-CheckDoc icon-primary',visible:'serviceCommandEdoRegDateVisible',caption:rk('Регистрация у отправителя'),componentType:'SBIS3.CONTROLS/Button/IconButton',command:'edoRegDate'},{id:'edoOrigPlace',icon:'sprite:icon-24 icon-Document icon-primary',visible:'serviceCommandEdoOrigPlaceVisible',caption:rk('Местонахождение оригинала'),componentType:'SBIS3.CONTROLS/Button/IconButton',command:'edoOrigPlace'},{id:'delivery',icon:'sprite:icon-24 icon-Mail icon-primary',visible:'serviceCommandDeliveryVisible',caption:rk('Способ доставки'),componentType:'SBIS3.CONTROLS/Menu/MenuIcon'},{id:'delivery_bymail',visible:true,caption:rk('Почтой'),componentType:'SBIS3.CONTROLS/Menu/MenuIcon',command:'delivery_change',parent:'delivery',commandArgs:[0]},{id:'delivery_byemail',visible:true,caption:rk('На e-mail'),componentType:'SBIS3.CONTROLS/Menu/MenuIcon',command:'delivery_change',parent:'delivery',commandArgs:[1]},{id:'delivery_bycourier',visible:true,caption:rk('Доставка курьером'),componentType:'SBIS3.CONTROLS/Menu/MenuIcon',command:'delivery_change',parent:'delivery',commandArgs:[2]},{id:'delivery_byfax',visible:true,caption:rk('По факсу'),componentType:'SBIS3.CONTROLS/Menu/MenuIcon',command:'delivery_change',parent:'delivery',commandArgs:[3]},{id:'delivery_byphonegram',visible:true,caption:rk('Телефонограммой'),componentType:'SBIS3.CONTROLS/Menu/MenuIcon',command:'delivery_change',parent:'delivery',commandArgs:[4]},{id:'delivery_bysbis',visible:true,caption:rk('Электронно'),componentType:'SBIS3.CONTROLS/Menu/MenuIcon',command:'delivery_change',parent:'delivery',commandArgs:[5]},{id:'delivery_byemployee',visible:true,caption:rk('Доставка нашим сотрудником'),componentType:'SBIS3.CONTROLS/Menu/MenuIcon',command:'delivery_change',parent:'delivery',commandArgs:[6]},{id:'delivery_byorderedmail',visible:true,caption:rk('Заказным письмом'),componentType:'SBIS3.CONTROLS/Menu/MenuIcon',command:'delivery_change',parent:'delivery',commandArgs:[7]},{id:'delivery_byvalueablemail',visible:true,caption:rk('Ценным письмом'),componentType:'SBIS3.CONTROLS/Menu/MenuIcon',command:'delivery_change',parent:'delivery',commandArgs:[8]},{id:'delivery_byexpressmail',visible:true,caption:rk('Экспресс-почтой'),componentType:'SBIS3.CONTROLS/Menu/MenuIcon',command:'delivery_change',parent:'delivery',commandArgs:[10]},{id:'edoShowDocTime',icon:'sprite:icon-24 icon-Time icon-primary',visible:!!('Управление рабочим временем'in e.modules),weight:70,caption:rk('Время по документу'),componentType:'SBIS3.CONTROLS/Button/IconButton',command:'fShowDocTime'}]});return n.register('edo.model.LetterModel',r),r;});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.Letter.Dialog", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-LetterDialog__choiceOurCompanyLink-container{padding:8px 0;height:24px;line-height:24px;text-align:right}.edo-LetterDialog__choiceOurCompanyLink-container .controls-SelectorButton__cross{display:none}.edo-LetterDialog__choiceOurCompanyLink{max-width:300px}.edo-LetterDialog__addresseeChoice-container{-webkit-flex-shrink:1;-ms-flex-negative:1;-ms-flex-shrink:1;flex-shrink:1;width:100%;overflow:hidden;padding:19px 0 0 12px}.edo-LetterDialog__addresseeChoice-container .controls-FieldLink__item-caption{color:#313e78;font-size:15px;font-weight:700}.edo-LetterDialog__addresseeChoice-link{color:#8991a9;text-decoration:underline}.edo-LetterDialog__addresseeChoice-fieldLink{width:100%}.edo-LetterDialog__attach-container{width:100%;margin:8px 9px 6px 12px}.edo-LetterDialog__attach-item{display:inline-block;margin-right:20px}.edo-LetterDialog__header{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-justify-content:space-between;-ms-justify-content:space-between;justify-content:space-between;-ms-flex-pack:justify;-webkit-flex-shrink:1;-ms-flex-negative:1;-ms-flex-shrink:1;flex-shrink:1;padding-bottom:6px}.edo-LetterDialog__header-rightSide{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-justify-content:flex-end;-ms-justify-content:flex-end;justify-content:flex-end;-ms-flex-pack:end;-webkit-flex-shrink:0;-ms-flex-negative:0;-ms-flex-shrink:0;flex-shrink:0}.edo-LetterDialog__sticker{-webkit-flex-shrink:1;-ms-flex-negative:1;-ms-flex-shrink:1;flex-shrink:1;margin-left:10px}.edo-LetterDetails_linkAnswer,.edo-LetterDetails_linkCorrList,.edo-LetterDetails_linkRespond,.edo-LetterDetails_menuLink{height:18px;line-height:18px}.edo-LetterDetails_deliveryList{text-align:right;display:block;min-height:18px;height:18px;line-height:24px}.edo-LetterDetails .edo-LetterDetails_deliveryList.controls-DropdownList .controls-DropdownList__selectedItem{display:block}.edo-LetterDetails{-webkit-flex-shrink:1;-ms-flex-negative:1;-ms-flex-shrink:1;flex-shrink:1;padding:4px 0 0 6px;max-width:185px;overflow:hidden}.edo-LetterDetails_selectorButton{margin-right:-3px;max-width:182px;z-index:1;line-height:18px;height:18px}.edo-LetterDetails_selectorButton_Label{color:#999;font-family:'TensorFont Regular',TensorFont;font-size:14px;height:18px;line-height:18px}.edo-LetterDetails_selectorButton .controls-SelectorButton__text{color:#05b}.edo-LetterDetails_selectorButton .controls-SelectorButton__text:hover{color:#ff7033;text-decoration:underline}.edo-LetterDetails_linkAnswer_wrapper,.edo-LetterDetails_linkCorrList_wrapper,.edo-LetterDetails_linkRespond_wrapper,.edo-LetterDetails_rulesSelector_wrapper{text-align:right;line-height:18px}.edo-LetterDetails__dropdownList-container{text-align:right;line-height:18px}.edo-LetterDetails__dropdownList{height:18px;line-height:18px;min-height:18px}.edo-LetterDetails_selectorButton_wrapper{text-align:right}.edo-LetterDetails__dropdownList.ws-disabled .controls-DropdownList__selectedItem .controls-DropdownList__textWrapper,.edo-LetterDetails__dropdownList.ws-disabled .controls-DropdownList__value:hover{color:#ccc!important}"));head.appendChild(style);});}
define('js!SBIS3.EDO.Letter.Dialog',['tmpl!SBIS3.EDO.Letter.Dialog','tmpl!SBIS3.EDO.Letter.Dialog/LetterDetailsTemplate','js!SBIS3.EDO2.FormController','js!SBIS3.EDO.Letter.Handlers','js!SBIS3.EDO.EdoServiceCommands','SBIS3.CONTROLS/Utils/InformationPopupManager','WS.Data/Source/SbisService','Core/CommandDispatcher','Core/Deferred','js!SBIS3.EDO.LetterModel','SBIS3.CONTROLS/Utils/ControlsValidators','optional!js!SBIS3.Contragents.ChoiceOurCompanyLink','preload!optional!SBIS3.AddresseeChoice.Dialog','css!SBIS3.EDO.Letter.Dialog','Elektronnyj_dokumentooborot_localization'],function(e,t,i,o,n,s,a,r,l){'use strict';var d=i.extend({_dotTplFn:e,$protected:{_options:{incoming:true,dataSource:{},readMetaData:{}}},$constructor:function(){this.once('onReady',function(){this._declareCommand(),this._setHandlers();}.bind(this));},_declareCommand:function(){r.declareCommand(this,'delivery_change',o.onDeliveryChange),r.declareCommand(this,'edoRegDate',function(){this.getChildControlByName('letterRegistrationButton').sendCommand('showRegistrationDialog');}.bind(this)),r.declareCommand(this,'edoOrigPlace',o.onOrigPlaceMenu),r.declareCommand(this,'fShowDocTime',n.fShowDocTime);},_setHandlers:function(){var e=this.getChildControlByName('AddresseeChoiceLink'),t=this.getChildControlByName('LetterFieldLink');if(!this._options.incoming)this.subscribe('onStartSending',o.onStartSending.bind(this));this.subscribe('onCommandCatch',function(e,t){if('edoEditDocument'===t)this.getChildControlByName('LetterEditor')._setVisibleIconResize('edit');else if('edoSaveDocument'===t)this.getChildControlByName('LetterEditor')._setVisibleIconResize('save');}.bind(this)),this.subscribeTo(e,'onActivated',function(){require(['js!SBIS3.AddresseeChoice.Dialog'],function(){t.showSelector('js!SBIS3.AddresseeChoice.Dialog',{selectionType:'all'});});}),this.subscribe('onBeforeUpdateModel',function(e,t){if(t.isChanged&&!t.isChanged())return;var i=new l();e.setResult(i),new a({endpoint:t.get('ТипДокумента.ТипДокумента')}).call('НайтиДокументПоТипуИНомеру',{'ПараметрыДокумента':{'@Документ':t.get('@Документ'),'ТипДокумента':t.get('ТипДокумента'),'НомерУКонтрагента':t.get('ДанныеДокумента.НомерУКонтрагента'),'Лицо1':t.get('Лицо1')}}).addCallback(function(e){if(e.getScalar())s.showConfirmDialog({message:'Для указанного контрагента<br>письмо с таким номером<br>уже зарегистрировано!',details:'Хотите сохранить письмо?'},function(){i.callback();},function(){i.errback();});else i.callback();});});},_modifyOptions:function(){var e=d.superclass._modifyOptions.apply(this,arguments);return e.letterDetailsTemplate=t,e;}});return d;});
define('js!SBIS3.EDO.IncomingLetterDialog',['js!SBIS3.EDO.Letter.Dialog','Elektronnyj_dokumentooborot_localization'],function(e){'use strict';return e.extend({$protected:{_options:{incoming:true,dataSource:{endpoint:{contract:'КоррВх'},binding:{create:'Создать',update:'Записать',destroy:'Документ.УдалитьДокументы',read:'Документ.ПрочитатьДляУчастника',format:'КоррВх.Список',query:'КоррВх.Список'},model:'edo.model.LetterModel'},readMetaData:{'ИмяОбъекта':'КоррВх'},objectName:'КоррВх',scopeArea:'Входящая корреспонденция',isNewDocument:false,saveImmediatelyFields:['Лицо1']}}});});
define('js!SBIS3.EDO.OutgoingLetterDialog',['js!SBIS3.EDO.Letter.Dialog','Elektronnyj_dokumentooborot_localization'],function(e){'use strict';return e.extend({$protected:{_options:{incoming:false,dataSource:{endpoint:{contract:'КоррИсх'},binding:{create:'Создать',update:'Записать',destroy:'Документ.УдалитьДокументы',read:'Документ.ПрочитатьДляУчастника',format:'КоррИсх.Список',query:'КоррИсх.Список'},model:'edo.model.LetterModel'},readMetaData:{'ИмяОбъекта':'КоррИсх'},objectName:'КоррИсх',scopeArea:'Исходящая корреспонденция',isNewDocument:false,saveImmediatelyFields:['Лицо1']}}});});
define("tmpl!SBIS3.EDO.OutgoingEventsLight",["Core/tmpl/js/tclosure","js!SBIS3.EDO2.Browser","js!SBIS3.EDO.FilterOutgoingNew","js!SBIS3.EDO.FilterOutgoingNewSelector","js!SBIS3.EDO2.OpenDialogAction","js!SBIS3.EDO.FEdoPartialReloader"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.EDO2.Browser"]=e[1],r["js!SBIS3.EDO.FilterOutgoingNew"]=e[2],r["js!SBIS3.EDO.FilterOutgoingNewSelector"]=e[3],r["js!SBIS3.EDO2.OpenDialogAction"]=e[4],r["js!SBIS3.EDO.FEdoPartialReloader"]=e[5];var o=function e(o,i,n,a,l){function s(){}var d=0,c=void 0!==t&&t?t:arguments[arguments.length-1];void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure"));var g={};l&&l.isSetts&&(g=l.fullContext||{});var m="string"==typeof n?n:"",u=void 0===r?void 0:r,p={id:[],def:void 0},v=c.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),S=this&&this.includedTemplates?this.includedTemplates:{},f=c.getMarkupGenerator(a);try{var h=f.joinElements([f.createTag("div",{style:"height:100%;display: flex;flex-direction: column;"},[f.createControl("wsControl","ws:SBIS3.EDO2.Browser",{filterButtonConfig:{template:c.createDataArray([(new function(){var e=Object.create(o),t=function e(t,r,o,i,n){if(void 0===o)var o=arguments[2];var a=0,l="template";if(void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure")),n&&n.isSetts)var s=n.fullContext||{};t=c.isolateScope(Object.create(this),t,l);var d="string"==typeof o?o:"",g={id:[],def:void 0},m=this&&this.includedTemplates?this.includedTemplates:{},p=c.getMarkupGenerator(i);try{var S=p.joinElements([p.createControl("wsControl","ws:SBIS3.EDO.FilterOutgoingNew",{},c.plainMerge(r,{}),{data:t,ctx:this,pName:void 0!==l?l:void 0,viewController:v},o,u,m,c.config,s)],d,g);g.def&&(S=p.chain(S,g,r),g=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/OutgoingEventsLight/OutgoingEventsLight.tmpl",e,t)}return S||""};this.func=c.makeFunctionSerializable(t,e)}).func]),additionalFilterParamsTemplate:c.createDataArray([(new function(){var e=Object.create(o),t=function e(t,r,o,i,n){if(void 0===o)var o=arguments[2];var a=0,l="additionalFilterParamsTemplate";if(void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure")),n&&n.isSetts)var s=n.fullContext||{};t=c.isolateScope(Object.create(this),t,l);var d="string"==typeof o?o:"",g={id:[],def:void 0},m=this&&this.includedTemplates?this.includedTemplates:{},p=c.getMarkupGenerator(i);try{var S=p.joinElements([p.createControl("wsControl","ws:SBIS3.EDO.FilterOutgoingNewSelector",{},c.plainMerge(r,{}),{data:t,ctx:this,pName:void 0!==l?l:void 0,viewController:v},o,u,m,c.config,s)],d,g);g.def&&(S=p.chain(S,g,r),g=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/OutgoingEventsLight/OutgoingEventsLight.tmpl",e,t)}return S||""};this.func=c.makeFunctionSerializable(t,e)}).func]),filterStructure:c.getter(o,["filterButtonConfig"])},browserOptions:{columns:[{cellTemplate:"tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TDocDateTimeColumn",includedTemplates:{DateNumberColumn:"tmpl!SBIS3.EDO2.Browser/resources/columns/tmpl/DateNumberColumn"},width:1},{className:"edo-Browser-Main__td",cellTemplate:"tmpl!SBIS3.EDO2.Browser/resources/columns/tmpl/MainInfoColumn"},{cellTemplate:"tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TStateColumn",width:1,includedTemplates:{edoStateColumn:"tmpl!SBIS3.EDO2.Browser/resources/columns/tmpl/StateColumn"}},{cellTemplate:"tmpl!SBIS3.EDO2.Browser/resources/columns/tmpl/ResponsibleColumn",fixedSize:!0,width:160,className:"inOutDoc_responsible"}],bind:"browser.filter",viewCustomCSS:"controls-ListView__hideCheckBoxes",common:{objectName:"РеестрИсходящих",method:"СписокСобытий",destroyMethod:"Удалить",viewMode:"table",model:c.getter(o,["model"])||"DocsInOutModel",filterParams:c.getter(o,["filterParams"]),navigationType:"Position"},infiniteScroll:"down",pageSize:21,navigation:{type:"cursor",config:{field:["StartPosition","@Событие"],direction:"after"}},virtualScrolling:!0,viewMode:"table",idProperty:"@Событие",showHead:!1,ladder:["date_col"],handlers:c.getter(o,["handlers"]),itemsActionsVisibility:c.getter(o,["itemsActionsVisibility"]),massActionsVisibility:c.getter(o,["massActionsVisibility"]),itemsActions:c.getter(o,["itemsActions"]),massActionsSettings:c.getter(o,["massActionsSettings"])},name:"OutgoingEventsBrowser",listData:c.getter(o,["listData"]),serverSideRendering:c.getter(o,["serverSideRendering"]),hierarchy:{hierarchy:!1},breadCrumbsConfig:{visible:!1},historyId:c.getter(o,["contragentAnswers"])?"OutgoingEventsAnswer1":"OutgoingEvents1",updateFilterHistory:!0,useScope:!0,ignoreFiltersList:["ФильтрОтветыКонтрагентов","ФильтрИзСписка","ТипДокумента"],isSingleTypeBrowser:!1,fastDataFilterConfig:c.getter(o,["fastDataFilterConfig"]),operationsPanelConfig:c.getter(o,["operationsPanelConfig"]),searchConfig:c.getter(o,["searchConfig"]),esc:!1},{class:"OutgoingEventsBrowser ws-flexbox ws-flex-column ws-flex-grow-1",name:"OutgoingEventsBrowser",sbisname:"OutgoingEventsBrowser"},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:v,internal:{__dirtyCheckingVars_0:c.getter(o,["filterButtonConfig"]),__dirtyCheckingVars_7:{objectName:"РеестрИсходящих",method:"СписокСобытий",destroyMethod:"Удалить",viewMode:"table",model:c.getter(o,["model"])||"DocsInOutModel",filterParams:c.getter(o,["filterParams"]),navigationType:"Position"},__dirtyCheckingVars_13:c.getter(o,["handlers"]),__dirtyCheckingVars_14:c.getter(o,["itemsActionsVisibility"]),__dirtyCheckingVars_15:c.getter(o,["massActionsVisibility"]),__dirtyCheckingVars_16:c.getter(o,["itemsActions"]),__dirtyCheckingVars_17:c.getter(o,["massActionsSettings"])}},n,u,S,c.config,g),f.createControl("wsControl","ws:SBIS3.EDO2.OpenDialogAction",{name:"OutgoingEventsAction",editMode:"newFloatArea",isDocsReestr:!0},{name:"OutgoingEventsAction",sbisname:"OutgoingEventsAction"},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:v},n,u,S,c.config,g),f.createControl("wsControl","ws:SBIS3.EDO.FEdoPartialReloader",{actionEventsToListen:["onUpdateModel",c.getter(o,["partialReloader","onDestroyModelHandlingEnable"])?"onDestroyModel":"",c.getter(o,["partialReloader","onCreateModelHandlingEnable"])?"onCreateModel":""],name:"PartialReloader",objectName:c.getter(o,["objectName"])||"РеестрИсходящих",method:c.getter(o,["method"])||"СписокСобытий",filterName:c.getter(o,["partialReloader","filterName"])||"СписокИдО",filterNameForCookie:"ИдО",sortField:c.getter(o,["partialReloader","sortField"])||"Начало",overrideItemsSortMethod:!0,updateOnDeleteAndAdd:c.getter(o,["partialReloader","updateOnDeleteAndAdd"])||!1,addServerChannelName:c.getter(o,["partialReloader","addServerChannelName"])||"",fixServerChannelName:c.getter(o,["partialReloader","fixServerChannelName"])||"",deleteServerChannelName:c.getter(o,["partialReloader","deleteServerChannelName"])||"",edoOpenDialogAction:"OutgoingEventsAction",allowedSeveralPhasesOfDoc:c.getter(o,["partialReloader","allowedSeveralPhasesOfDoc"])||!1,registryKeyFromCookie:"PartialReloader_CurrentEvent",esc:!1},{name:"PartialReloader",sbisname:"PartialReloader"},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:v,internal:{__dirtyCheckingVars_0:c.getter(o,["partialReloader","onDestroyModelHandlingEnable"])?"onDestroyModel":"",__dirtyCheckingVars_1:c.getter(o,["partialReloader","onCreateModelHandlingEnable"])?"onCreateModel":""}},n,u,S,c.config,g)],i,p,this)],m,p);p.def&&(h=f.chain(h,p,i),p=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/OutgoingEventsLight/OutgoingEventsLight.tmpl",e,o)}return h||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.OutgoingEventsLight"}},o});
define('js!SBIS3.EDO.Modificators.OutgoingEvents.List',['js!SBIS3.EDO.Modificators.DefaultModificator','Elektronnyj_dokumentooborot_localization'],function(e){'use strict';function t(){e.apply(this,arguments),this._allowedItems=['edoDeleteRedaction','edoRestoreRedaction'],this._allowedMOPItems=['edoDeleteRedactionMass','edoRestoreRedactionMass'],this._fastFilterItems=['ФильтрСостояние','ФильтрВладелец','ТипДокументаВД'];}return t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.prototype.getFilterButtonConfig=function(){return{template:'SBIS3.EDO.FilterOutgoingNew',additionalFilterParamsTemplate:'SBIS3.EDO.FilterOutgoingNewSelector',filterStructure:this._getFilterStructure(['ФильтрДатаПериод','ФильтрДатаС','ФильтрДатаП','ИдРегламента','ФильтрЛицо1','ФильтрСостояние','ФильтрОрганизацияФилиал','ФильтрОтветственноеЛицо','ФильтрВладелец','ФильтрНезакрепленные','ФильтрПометкиВкл','ФильтрПометкиИскл','ФильтрУдаленные','ТипДокументаВД'])};},t.prototype.modifyFilterConfigs=function(e){var t=e.filter(function(e){return this._fastFilterItems.indexOf(e['filterField'])>-1;}.bind(this)),i;for(i in t)t[i]['itemTemplate']=null;return e;},t.prototype.getFastDataFilterConfig=function(){return{className:'edo-tasks__fastDataFilter',idProperty:'name',data:[{keyField:'key',displayField:'title',name:'FilterAuthorOrResponsibleMe',multiselect:false,className:'controls-DropdownList__linkStyle',showSelectedInList:true,values:[{key:'Все',title:rk('Все'),value:'Все'},{key:'От меня',title:rk('От меня'),value:'От меня'},{key:'От моего отдела',value:'От моего отдела',title:rk('От моего отдела')}]},{keyField:'key',displayField:'title',name:'FilterState',multiselect:false,className:'controls-DropdownList controls-DropdownList__linkStyle',showSelectedInList:true,values:[{key:'-1',title:rk('В любом состоянии')},{key:'10',title:rk('Внутренняя обработка')},{key:'2,3',title:rk('Недоставленные')},{key:'4',title:rk('Не получен ответ')},{key:'7',title:rk('Утвержденные')},{key:'9',title:rk('Отклоненные')},{key:'6',title:rk('С ошибками')},{key:'22',title:rk('Аннулированные')},{key:'19,20',title:rk('Удалено мной/контрагентом')},{key:'0,1',title:rk('Черновики')},{key:'-2',title:rk('Удаленные')}]},{keyField:'ТипДокументаВД',displayField:'Название',name:'FilterDocumentType',multiselect:true,className:'controls-DropdownList__linkStyle',showSelectedInList:true,values:[{'ТипДокументаВД':'Все','Название':rk('Все типы документов')},{'ТипДокументаВД':'АктВР,АктПП','Название':rk('Акты (услуги, работы, права)')},{'ТипДокументаВД':'ЭДОНакл','Название':rk('Накладные')},{'ТипДокументаВД':'СчФктр,УпдСчфДоп','Название':rk('Счета-фактуры (вкл. в составе УПД)')},{'ТипДокументаВД':'счФактКор,УкдКсчфДис','Название':rk('Счета-фактуры корр. (вкл. в составе УКД)')},{'ТипДокументаВД':'УпдДоп','Название':rk('Передаточные документы')},{'ТипДокументаВД':'УкдДис','Название':rk('Передаточные документы корр.')},{'ТипДокументаВД':'АктСвер','Название':rk('Акты сверки')},{'ТипДокументаВД':'Договор','Название':rk('Договоры')},{'ТипДокументаВД':'ЭДОСч','Название':rk('Счета')}]}]};},t;});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.OutgoingEventsLight", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".event_date .datecol_small .datecol_date{color:#000;font-size:14px;vertical-align:top!important;text-align:right!important}.event_date .datecol_small .datecol_time{color:#ccc!important}.controls-DropdownList__picker .out_events .controls-ListView__defaultItem{display:none}.pereh_col .no_icon{padding-left:0}.OutgoingEventsBrowser .datecol_small{padding-top:1px}.OutgoingEventsBrowser .edo-DateCol_icon_unread{position:absolute;margin-top:-19px;margin-left:5px}.OutgoingEventsBrowser{height:100%}.engine-BrowserTabs{height:100%}"));head.appendChild(style);});}
define('js!SBIS3.EDO.OutgoingEventsLight',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.OutgoingEventsLight','js!SBIS3.EDO.Modificators','js!SBIS3.EDO.Modificators.OutgoingEvents.List','js!SBIS3.EDO.SearchAutocompleteMixin','js!SBIS3.EDO.EdoOperationsCommon','js!SBIS3.EDO.OperationPrint','js!SBIS3.EDO.EdoRecOptions','js!SBIS3.EDO.EdoClicks','Core/Serializer','js!SBIS3.EDO.FilterButtonsConfigsStats','js!SBIS3.EDO2.Browser','tmpl!SBIS3.EDO2.Browser/resources/columns/tmpl/ResponsibleColumn','tmpl!SBIS3.EDO2.Browser/resources/columns/tmpl/StateColumn','tmpl!SBIS3.EDO2.Browser/resources/columns/tmpl/MainInfoColumn','tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TStateColumn','tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TDocDateTimeColumn','tmpl!SBIS3.EDO2.Browser/resources/columns/tmpl/DateNumberColumn','js!SBIS3.EDO2.OpenDialogAction','js!SBIS3.EDO.FEdoPartialReloader','js!SBIS3.EDO.OperationUnload','js!SBIS3.EDO.DocsInOutModel','css!SBIS3.EDO.OutgoingEventsLight','Elektronnyj_dokumentooborot_localization'],function(t,e,o,s,n,i,r,a,l,c,u){'use strict';var m=t.extend([n],{_dotTplFn:e,$protected:{_options:{itemsActionsVisibility:{edoSaveDocumentOnDisk:false,edoSendDocument:false,edoOpenInNewTab:false,edoDeleteDocument:false,edoShowDkPanel:false,edoPostDocument:false,edoRestoreDocument:false},massActionsVisibility:{edoDeleteDocumentMass:false,edoRestoreDocumentMass:false},massActionsSettings:{edoPrintDocumentMass:{documentIdField:'@Документ',recursive:false,infinityPrint:true,minPrintWindowWidth:666,exportDocuments:true,xsl:'Электронный документооборот/Реестры/xslt/reestr_events_new.xsl',filteredObjectName:'ДокОтгрВх',filteredMethodName:'ПечатьВложенийСФильтром',handlers:{onApplyOperation:i.documentsPreparePrintColumns},items:[{id:'filtered',title:rk('Фактуры, накладные, акты'),onActivated:S}]}},filterParams:{},configFilters:['ФильтрДатаПериод','ФильтрДатаС','ФильтрДатаП','ИдРегламента','ФильтрЛицо1','ФильтрСостояние','ФильтрДокументНашаОрганизация','ФильтрОтветственноеЛицо','ФильтрВладелец','ФильтрНезакрепленные','ФильтрПометкиВкл','ФильтрПометкиИскл','ФильтрУдаленные','ТипДокументаВД'],configFastFilters:['ФильтрСостояние','ФильтрВладелец','ТипДокументаВД']}},init:function(){m.superclass.init.call(this);var t=this,e=this.getChildControlByName('OutgoingEventsBrowser'),o=this.getChildControlByName('browserFastDataFilter');if(o)o.setItems(this._options.fastDataFilterConfig.data);e.subscribeTo(e,'onStartCommand',function(t,e){if('edoCopyDocument'===e.commandName)e.args[0].createStartEvent=true;});},_modifyOptions:function(){var t=m.superclass._modifyOptions.apply(this,arguments),e={},n=new s(),i=new o(n);if(t.filterButtonConfig=[],t&&t.listData&&t.listData.filter)e=t.listData.filter;t.operationsPanelConfig=i.getMOPActions();var r=u(e),a=[];if(t.filterButtonConfig=t.configFilters.map(function(t){return r[t];}),a=t.configFastFilters.map(function(t){return r[t];}),t.fastDataFilterConfig=n.getFastDataFilterConfig(),t.fastDataFilterConfig.filterStructure=a,t.itemsActions=i.getActions(),t.handlers=this._getHandlers(t),t.searchConfig=this.getSearchConfig(),t.contragentAnswers)t.filterParams['ФильтрОтветыКонтрагентов']=true;return t;},_getHandlers:function(){return{onItemClick:[l.clickDispPartialReloaderSetCookie],onChangeHoveredItem:[a.onChangeHoveredItemEvents]};}});function S(){r.prototype.filteredPrint();}return c.setToJsonForFunction(S,'js!SBIS3.EDO.OperationPrint','prototype.filteredPrint'),m;});
define("tmpl!SBIS3.EDO.OutgoingEventLightTab",["Core/tmpl/js/tclosure","js!SBIS3.Engine.BrowserTabs","js!SBIS3.EDO.InOutDocumentButtons","js!SBIS3.EDO.OutgoingEventsLight"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],n={};n["js!SBIS3.Engine.BrowserTabs"]=e[1],n["js!SBIS3.EDO.InOutDocumentButtons"]=e[2],n["js!SBIS3.EDO.OutgoingEventsLight"]=e[3];var r=function e(r,o,a,i,s){function l(){}var u=0,c=void 0!==t&&t?t:arguments[arguments.length-1];void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure"));var d={};s&&s.isSetts&&(d=s.fullContext||{});var g="string"==typeof a?a:"",m=void 0===n?void 0:n,p={id:[],def:void 0},v=c.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,r),h=this&&this.includedTemplates?this.includedTemplates:{},b=c.getMarkupGenerator(i);try{var f=b.joinElements([b.createTag("div",{style:"min-height:1px;display: flex;flex-direction: column;height:100%;"},[b.createControl("wsControl","ws:SBIS3.Engine.BrowserTabs",{tabsArea:[{content:c.createDataArray([(new function(){var e=Object.create(r),t=function e(t,n,r,o,a){if(void 0===r)var r=arguments[2];var i=0,s="content";if(void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure")),a&&a.isSetts)var l=a.fullContext||{};t=c.isolateScope(Object.create(this),t,s);var u="string"==typeof r?r:"",d={id:[],def:void 0},g=this&&this.includedTemplates?this.includedTemplates:{},p=c.getMarkupGenerator(o);try{var h=p.joinElements([p.createControl("wsControl","ws:SBIS3.EDO.InOutDocumentButtons",{name:"InOutDocumentButtons",docTypes:["ДокОтгрИсх","ФактураИсх","КоррИсх","АктСверкиДок","ДоговорДок","СчетИсх"],from1C:!0,incoming:!1,LBdocType:"Исходящие"},c.plainMerge(n,{name:"InOutDocumentButtons",sbisname:"InOutDocumentButtons"}),{data:t,ctx:this,pName:void 0!==s?s:void 0,viewController:v},r,m,g,c.config,l)],u,d);d.def&&(h=p.chain(h,d,n),d=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/OutgoingEventLightTab/OutgoingEventLightTab.tmpl",e,t)}return h||""};this.func=c.makeFunctionSerializable(t,e)}).func]),id:"aGroup"}],mainArea:[{id:"StatGroup",template:"js!SBIS3.EDO.StatTemplateExternal",componentOptions:{StatTemplateName:"ШаблонСтатистики",needStatPrintBtn:!0,statTemplate:"js!SBIS3.EDO.StatOutgoingEventsNew",statType:"Outgoing"}},{id:"ContrListGroup",template:"js!SBIS3.EDO.OutgoingEventsLight",componentOptions:{contragentAnswers:!0,useAutoRefresh:!0,partialReloader:{fixServerChannelName:"edo.task-fix",onDestroyModelHandlingEnable:!0}}},{content:c.createDataArray([(new function(){var e=Object.create(r),t=function e(t,n,r,o,a){if(void 0===r)var r=arguments[2];var i=0,s="content";if(void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure")),a&&a.isSetts)var l=a.fullContext||{};t=c.isolateScope(Object.create(this),t,s);var u="string"==typeof r?r:"",d={id:[],def:void 0},g=this&&this.includedTemplates?this.includedTemplates:{},p=c.getMarkupGenerator(o);try{var h=p.joinElements([p.createControl("wsControl","ws:SBIS3.EDO.OutgoingEventsLight",{useAutoRefresh:!0,partialReloader:{onCreateModelHandlingEnable:!0,onDestroyModelHandlingEnable:!0,allowedSeveralPhasesOfDoc:!0},url:c.getter(t,["url"]),listData:c.getter(t,["listData"]),serverSideRendering:c.getter(t,["serverSideRendering"])},c.plainMerge(n,{}),{data:t,ctx:this,pName:void 0!==s?s:void 0,viewController:v},r,m,g,c.config,l)],u,d);d.def&&(h=p.chain(h,d,n),d=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/OutgoingEventLightTab/OutgoingEventLightTab.tmpl",e,t)}return h||""};this.func=c.makeFunctionSerializable(t,e)}).func]),id:"ListGroup"}],tabs:[{id:c.getter(r,["statTabId"]),title:global.rk("Статистика"),mainArea:"StatGroup"},{id:"ContrListTab",mainArea:"ContrListGroup",tabsArea:"aGroup",title:global.rk("Ответы контрагентов")},{id:c.getter(r,["listTabId"]),mainArea:"ListGroup",tabsArea:"aGroup",title:global.rk("Отправленные")}],handlers:{onTabChange:[c.getTypeFunc("js!SBIS3.EDO.EdoCommon:onTabChangeNewRegistry",{})],onTabAndMainLoaded:[c.getTypeFunc("js!SBIS3.EDO.OutgoingEventLightTab:prototype.onTabAndMainLoaded",{})]},name:c.getter(r,["tabsName"]),style:"height:100%;display: flex;flex-direction: column;",defaultTab:"ListTab",esc:!1},{class:"ws-flexbox ws-flex-column ws-flex-grow-1",name:c.getter(r,["tabsName"]),sbisname:c.getter(r,["tabsName"])},{data:r,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:v,internal:{__dirtyCheckingVars_7:c.getter(r,["url"]),__dirtyCheckingVars_8:c.getter(r,["listData"]),__dirtyCheckingVars_9:c.getter(r,["serverSideRendering"]),__dirtyCheckingVars_10:c.getter(r,["statTabId"]),__dirtyCheckingVars_13:c.getter(r,["listTabId"])}},a,m,h,c.config,d)],o,p,this)],g,p);p.def&&(f=b.chain(f,p,o),p=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/OutgoingEventLightTab/OutgoingEventLightTab.tmpl",e,r)}return f||""};return r.includedFunctions={},r.stable=!0,r.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.OutgoingEventLightTab"}},r});
define('js!SBIS3.EDO.OutgoingEventLightTab',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.OutgoingEventLightTab','js!SBIS3.EDO.EdoCommon','WS.Data/Source/SbisService','Core/CommandDispatcher','js!SBIS3.EDO.EventsRegistryHandlers','js!SBIS3.EDO.InOutDocumentButtons','js!SBIS3.EDO.OutgoingEventsLight','js!SBIS3.Engine.BrowserTabs','js!SBIS3.EDO.EdoOperationsCommon','Elektronnyj_dokumentooborot_localization'],function(t,n,e,o,a,i){var s=t.extend({_dotTplFn:n,$protected:{_options:{tabsName:'OutgoingEventsTabs',listTabId:'ListTab',statTabId:'StatTab'}},$constructor:function(){a.declareCommand(this,'statsChangeArea',i._statsChangeArea);},init:function(){s.superclass.init.call(this);var t=this;new o({endpoint:'ГлобальныеПараметрыКлиента'}).call('ПолучитьЗначение',{'Путь':'unit_contracts_converted'}).addCallback(function(n){if('true'!==n.getRawData()){for(var e=t.getChildControlByName('InOutDocumentButtons').getChildControlByName('addDocumentButton'),o=e._options.docTypes,a=0;a<o.length;a++)if('ДоговорДок'===o[a].docType)o[a].docType='ДоговорИсх';e.setDocTypes(o);}}),new o({endpoint:'ГлобальныеПараметрыКлиента'}).call('ПолучитьЗначение',{'Путь':'unit_reconciliations_converted'}).addCallback(function(n){if('true'!==n.getRawData()){for(var e=t.getChildControlByName('InOutDocumentButtons').getChildControlByName('addDocumentButton'),o=e._options.docTypes,a=0;a<o.length;a++)if('АктСверкиДок'===o[a].docType)o[a].docType='АктСверИсх';e.setDocTypes(o);}});},onTabAndMainLoaded:function(t,n){if('StatTab'!=n)e.initTaskButtons({mainObject:this.getCurrentTabArea('main'),tabsObject:this.getCurrentTabArea('tabs'),btnDocName:'addDocumentButton',brwName:'OutgoingEventsBrowser',actionName:'OutgoingEventsAction',folderButtonName:null,rootFolderName:null,folderAction:null,dialogComponents:{'904203de-34b9-411d-bd05-e51e6b91ab40':'js!SBIS3.EDO.FContractOut','fdbbfd83-64f6-4ae1-9761-625b114ec4bd':'js!SBIS3.EDO.ReconciliationReportOut','bc5f60fd-2633-45e0-a817-41a89910d074':'js!SBIS3.EDO.ReconciliationReportIn','534888e6-8c29-4c11-9530-774d485b639b':'js!SBIS3.EDO.ReconciliationReportIn','635f32d6-974d-4096-935a-44822f8672d0':'js!SBIS3.EDO.FContractIn'}});}});return s;});
define('js!SBIS3.EDO.ExternalStatisticsHandlers',['Core/CommandDispatcher','Core/core-attach','Elektronnyj_dokumentooborot_localization'],function(t,e){'use strict';var n={getFilterStateByName:function(t){switch(t){case'all_docs':return;case'send_docs':return'2,3,4,7,9';case'deliv_docs':return'4,7,9';case'recv_docs':case'recv_docs_in':return'7';case'decl_docs':case'decl_docs_in':return'9';case'on_checking_docs':return'4';case'no_deliv_docs':return'2,3';case'regl_docs':case'proc_docs':case'no_send_docs':return'10';case'kon_del_docs':case'kon_del_docs_in':return'19,20';case'ann_docs':case'ann_docs_in':return'22';case'error_docs':return'6';case'rough_docs':return'0,1';default:return;}},onRowClickContragents:function(t,e,a,s,r,i){n.onRowClickDispatcher.apply(this,[t,e,a,s,r,i,{source:'contragents'}]);},onRowClick:function(t,e,a,s,r,i){n.onRowClickDispatcher.apply(this,[t,e,a,s,r,i,{}]);},onRowClickDispatcher:function(e,a,s,r,i,o,c){var d=this._options.docType,l=this.getParent(),_=s.get('Состояние'),u=o.cellContainer,p=this._options.columns[o.cellIndex]['field'],h=u.find('[stat_id]').attr('stat_id');if('Доставлено'===_||'Отправлено'===_)return;if('Контрагенты'!==p)if('Всего'===_)t.sendCommand(this,'statsChangeArea',{stat_id:h,statBrw:l,docType:d,destination:'organizations',state:n.getFilterStateByName(h)||'-1',record:s});else t.sendCommand(this,'statsChangeArea',{stat_id:h,statBrw:l,docType:d,destination:'listTab',source:(c||{})['source'],state:n.getFilterStateByName(h)||'-1',record:s});else t.sendCommand(this,'statsChangeArea',{stat_id:h,statBrw:l,docType:d,destination:'contragents',state:n.getFilterStateByName(h)||'-1'});},addStatPrintButton:function(t){var n=$('<div id="stat_print_button" style="top:3px;left:8px;float:left;z-index:100;"></div>'),a=$('div.browserTabs__middle-area'),s=a.length?a:$('div#content');if(a.length)n.css('top','-1px');if(0!==s.length)s.find('div#stat_print_button').remove();if(0!==s.length&&0===s.find('div#stat_print_button').length)s.append(n);e.attachInstance('Control/Button',{element:n,image:'sprite:icon-24 icon-Print icon-primary',name:'Распечатать',caption:rk('Распечатать'),parent:s,renderStyle:'asLink',handlers:{onActivated:function(){t.action.execute(t.getMeta());}}});},removeStatPrintButton:function(){var t=$('div.browserTabs__middle-area'),e=t.length?t:$('div#content');if(0!==e.length){var n=e.find('div#stat_print_button'),a=e.find('div#stat_save_button'),s={p:!!n.length,s:!!a.length};return n.remove(),a.remove(),s;}}};return n;});
define("tmpl!SBIS3.EDO.StatEventsTable",["Core/tmpl/js/tclosure","js!SBIS3.Engine.Browser","js!SBIS3.EDO.FilterOutgoingStats","js!SBIS3.EDO.FilterOutgoingStatsSelector","js!SBIS3.CONTROLS/DataGridView","js!SBIS3.CONTROLS.Action.List.Save"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.Engine.Browser"]=e[1],r["js!SBIS3.EDO.FilterOutgoingStats"]=e[2],r["js!SBIS3.EDO.FilterOutgoingStatsSelector"]=e[3],r["js!SBIS3.CONTROLS/DataGridView"]=e[4],r["js!SBIS3.CONTROLS.Action.List.Save"]=e[5];var a=function e(a,i,o,n,s){function l(){}var c=0,d=void 0!==t&&t?t:arguments[arguments.length-1];void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure"));var p={};s&&s.isSetts&&(p=s.fullContext||{});var g="string"==typeof o?o:"",u=void 0===r?void 0:r,m={id:[],def:void 0},S=d.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,a),y=this&&this.includedTemplates?this.includedTemplates:{},v=d.getMarkupGenerator(n);try{var T=v.joinElements([v.createTag("div",{},[v.createControl("wsControl","ws:SBIS3.Engine.Browser",{filterButtonConfig:{template:d.createDataArray([(new function(){var e=Object.create(a),t=function e(t,r,a,i,o){if(void 0===a)var a=arguments[2];var n=0,s="template";if(void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure")),o&&o.isSetts)var l=o.fullContext||{};t=d.isolateScope(Object.create(this),t,s);var c="string"==typeof a?a:"",p={id:[],def:void 0},g=this&&this.includedTemplates?this.includedTemplates:{},m=d.getMarkupGenerator(i);try{var y=m.joinElements([m.createControl("wsControl","ws:SBIS3.EDO.FilterOutgoingStats",{},d.plainMerge(r,{}),{data:t,ctx:this,pName:void 0!==s?s:void 0,viewController:S},a,u,g,d.config,l)],c,p);p.def&&(y=m.chain(y,p,r),p=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/StatTemplateExternal/StatEventsTable/StatEventsTable.tmpl",e,t)}return y||""};this.func=d.makeFunctionSerializable(t,e)}).func]),additionalFilterParamsTemplate:d.createDataArray([(new function(){var e=Object.create(a),t=function e(t,r,a,i,o){if(void 0===a)var a=arguments[2];var n=0,s="additionalFilterParamsTemplate";if(void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure")),o&&o.isSetts)var l=o.fullContext||{};t=d.isolateScope(Object.create(this),t,s);var c="string"==typeof a?a:"",p={id:[],def:void 0},g=this&&this.includedTemplates?this.includedTemplates:{},m=d.getMarkupGenerator(i);try{var y=m.joinElements([m.createControl("wsControl","ws:SBIS3.EDO.FilterOutgoingStatsSelector",{},d.plainMerge(r,{}),{data:t,ctx:this,pName:void 0!==s?s:void 0,viewController:S},a,u,g,d.config,l)],c,p);p.def&&(y=m.chain(y,p,r),p=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/StatTemplateExternal/StatEventsTable/StatEventsTable.tmpl",e,t)}return y||""};this.func=d.makeFunctionSerializable(t,e)}).func]),resetLinkText:global.rk("За последний месяц"),filterStructure:d.getter(a,["filterButtonConfig"])},content:d.createDataArray([(new function(){var e=Object.create(a),t=function e(t,r,a,i,o){if(void 0===a)var a=arguments[2];var n=0,s="content";if(void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure")),o&&o.isSetts)var l=o.fullContext||{};t=d.isolateScope(Object.create(this),t,s);var c="string"==typeof a?a:"",p={id:[],def:void 0},g=this&&this.includedTemplates?this.includedTemplates:{},m=d.getMarkupGenerator(i);try{var y=m.joinElements([m.createTag("div",{style:"width:480px;"},[m.createControl("wsControl","ws:SBIS3.CONTROLS/DataGridView",{columns:[{field:"Состояние",title:global.rk("Текущее состояние"),headerAddClassName:"edo-externalStat__columnHeader-bold",width:"250",className:"column_underline external_stat_browser",cellTemplate:"tmpl!SBIS3.EDO.StatEventsTable/resources/StatTitleCol",headTemplate:"tmpl!SBIS3.EDO.StatEventsTable/resources/StatColHead",templateBinding:{statesDict:d.getter(t,["statesDict"]),docType:d.getter(t,["docType"]),type:"outgoing"}},{field:"Документы",title:global.rk("Документы"),headerAddClassName:"edo-externalStat__columnHeader-indent",width:"90",className:"column_underline external_stat_browser extstat_aright",cellTemplate:"tmpl!SBIS3.EDO.StatEventsTable/resources/StatNumCol",headTemplate:"tmpl!SBIS3.EDO.StatEventsTable/resources/StatColHead",templateBinding:{statesDict:d.getter(t,["statesDict"]),docType:d.getter(t,["docType"]),type:"outgoing"}},{field:"Проценты",title:"%",headerAddClassName:"edo-externalStat__columnHeader-indent",width:"70",className:"column_underline external_stat_browser extstat_aright",cellTemplate:"tmpl!SBIS3.EDO.StatEventsTable/resources/StatPercentCol",headTemplate:"tmpl!SBIS3.EDO.StatEventsTable/resources/StatColHead",templateBinding:{statesDict:d.getter(t,["statesDict"]),docType:d.getter(t,["docType"]),type:"outgoing"}},{field:"Контрагенты",title:d.getter(t,["numColumnHeaderTitle"]),headerAddClassName:"edo-externalStat__columnHeader-indent",width:"100",className:"column_underline external_stat_browser extstat_aright",cellTemplate:"tmpl!SBIS3.EDO.StatEventsTable/resources/StatNumCol",headTemplate:"tmpl!SBIS3.EDO.StatEventsTable/resources/StatColHead",templateBinding:{statesDict:d.getter(t,["statesDict"]),docType:d.getter(t,["docType"]),type:"outgoing"}}],handlers:{onPrepareReportData:d.getTypeFunc("js!SBIS3.EDO.StatisticsEDOHandlers:printRazvReport",{}),onItemClick:d.getTypeFunc("js!SBIS3.EDO.ExternalStatisticsHandlers:onRowClick",{})},reports:{"Статистика":"Elektronnyj_dokumentooborot/Statistika/Pechatnye_formy/"+d.getter(t,["statType"])+"Main.xsl"},name:"browserView",name1:d.getter(t,["browserName"]),showPaging:!1,emptyHtml:global.rk("Нет данных"),bindings:[{fieldName:"browser.filter",propName:"filter",propPath:[],fullPropName:"filter",propPathStr:"",oneWay:!1,direction:"fromContext",bindNonExistent:!0}],filter:d.getter(t,["filters"])||{"ФильтрДатаПериод":"Месяц"},emptyHTML:global.rk("Для выбранных условий отбора статистика отсутствует"),itemsDragNDrop:"",itemsActions:[],showHead:!0,contextMenu:!1,docType:d.getter(t,["docType"]),esc:!1},{name:"browserView",sbisname:"browserView"},{data:t,ctx:this,pName:void 0!==s?s:void 0,viewController:S,internal:{__dirtyCheckingVars_1:{statesDict:d.getter(t,["statesDict"]),docType:d.getter(t,["docType"]),type:"outgoing"},__dirtyCheckingVars_3:{statesDict:d.getter(t,["statesDict"]),docType:d.getter(t,["docType"]),type:"outgoing"},__dirtyCheckingVars_4:{statesDict:d.getter(t,["statesDict"]),docType:d.getter(t,["docType"]),type:"outgoing"},__dirtyCheckingVars_5:d.getter(t,["numColumnHeaderTitle"]),__dirtyCheckingVars_6:{statesDict:d.getter(t,["statesDict"]),docType:d.getter(t,["docType"]),type:"outgoing"},__dirtyCheckingVars_7:d.getter(t,["statType"])}},a,u,g,d.config,l)],r,p,this)],c,p);p.def&&(y=m.chain(y,p,r),p=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/StatTemplateExternal/StatEventsTable/StatEventsTable.tmpl",e,t)}return y||""};this.func=d.makeFunctionSerializable(t,e)}).func]),name:"StatBrowser",className:"external_stat_browser",fastDataFilterConfig:d.getter(a,["fastDataFilterConfig"]),esc:!1},{name:"StatBrowser",sbisname:"StatBrowser"},{data:a,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:S,internal:{__dirtyCheckingVars_1:d.getter(a,["filterButtonConfig"]),__dirtyCheckingVars_3:{statesDict:d.getter(a,["statesDict"]),docType:d.getter(a,["docType"]),type:"outgoing"},__dirtyCheckingVars_5:{statesDict:d.getter(a,["statesDict"]),docType:d.getter(a,["docType"]),type:"outgoing"},__dirtyCheckingVars_6:{statesDict:d.getter(a,["statesDict"]),docType:d.getter(a,["docType"]),type:"outgoing"},__dirtyCheckingVars_7:d.getter(a,["numColumnHeaderTitle"]),__dirtyCheckingVars_8:{statesDict:d.getter(a,["statesDict"]),docType:d.getter(a,["docType"]),type:"outgoing"},__dirtyCheckingVars_9:d.getter(a,["statType"]),__dirtyCheckingVars_10:d.getter(a,["browserName"]),__dirtyCheckingVars_17:d.getter(a,["docType"])}},o,u,y,d.config,p),v.createControl("wsControl","ws:SBIS3.CONTROLS.Action.List.Save",{name:"saveAction"},{name:"saveAction",sbisname:"saveAction"},{data:a,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:S},o,u,y,d.config,p)],i,m,this)],g,m);m.def&&(T=v.chain(T,m,i),m=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/StatTemplateExternal/StatEventsTable/StatEventsTable.tmpl",e,a)}return T||""};return a.includedFunctions={},a.stable=!0,a.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.StatEventsTable"}},a});
define("tmpl!SBIS3.EDO.StatEventsTable/resources/StatTitleCol",["Core/tmpl/js/tclosure"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={},a=function e(a,i,l,s,n){function o(){}var p=0,c=void 0!==t&&t?t:arguments[arguments.length-1];void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure"));var g={};n&&n.isSetts&&(g=n.fullContext||{});var d="string"==typeof l?l:"",m=void 0===r?void 0:r,u={id:[],def:void 0},v=c.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,a),y=this&&this.includedTemplates?this.includedTemplates:{},f=c.getMarkupGenerator(s);try{var h=f.joinElements([f.createTag("div",{stat_id:""+c.wrapUndef(c.utils.escape(c.getter(a,["templateBinding","statesDict",c.getter(a,["item","get"]).apply(c.getter(a,["item"]),["Состояние"]),"class"])))},[f.createTag("span",{class:c.wrapUndef(c.utils.escape("Доставлено"!==c.getter(a,["item","get"]).apply(c.getter(a,["item"]),["Состояние"])&&"Отправлено"!==c.getter(a,["item","get"]).apply(c.getter(a,["item"]),["Состояние"])?"stat_docs":void 0))+" "+c.wrapUndef(c.utils.escape(c.getter(a,["templateBinding","statesDict",c.getter(a,["item","get"]).apply(c.getter(a,["item"]),["Состояние"]),"class"]))),style:""+c.wrapUndef(c.utils.escape(c.getter(a,["templateBinding","statesDict",c.getter(a,["item","get"]).apply(c.getter(a,["item"]),["Состояние"]),"style"])))},[f.createText(""+c.wrapUndef(c.utils.escape(c.getter(a,["templateBinding","statesDict",c.getter(a,["item","get"]).apply(c.getter(a,["item"]),["Состояние"]),"label"]))))],{},u,this),"Всего"===c.getter(a,["item","get"]).apply(c.getter(a,["item"]),["Состояние"])?[f.createTag("hr",{style:"display: block;margin-left: 18px;margin-top: 5px;background-color: #000000;border: none;height: 1px;margin-right:-5px"},[],{},u,this)]:f.createText("")],i,u,this)],d,u);u.def&&(h=f.chain(h,u,i),u=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/StatTemplateExternal/StatEventsTable/resources/StatTitleCol.tmpl",e,a)}return h||""};return a.includedFunctions={},a.stable=!0,a.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.StatEventsTable/resources/StatTitleCol"}},a});
define("tmpl!SBIS3.EDO.StatEventsTable/resources/StatNumCol",["Core/tmpl/js/tclosure"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={},a=function e(a,i,l,s,n){function o(){}var p=0,c=void 0!==t&&t?t:arguments[arguments.length-1];void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure"));var g={};n&&n.isSetts&&(g=n.fullContext||{});var d="string"==typeof l?l:"",u=void 0===r?void 0:r,m={id:[],def:void 0},f=c.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,a),v=this&&this.includedTemplates?this.includedTemplates:{},y=c.getMarkupGenerator(s);try{var h=y.joinElements([y.createTag("div",{},[y.createTag("div",{stat_id:""+c.wrapUndef(c.utils.escape(c.getter(a,["templateBinding","statesDict",c.getter(a,["item","get"]).apply(c.getter(a,["item"]),["Состояние"]),"class"]))),title:""+c.wrapUndef(c.utils.escape("Документы"===c.getter(a,["field"])?global.rk.apply(a,["Перейти к документам"]):global.rk.apply(a,["Перейти к списку"])+" "+global.rk.apply(a,["поставщиков"])))},[y.createTag("span",{class:c.wrapUndef(c.utils.escape("Доставлено"!==c.getter(a,["item","get"]).apply(c.getter(a,["item"]),["Состояние"])&&"Отправлено"!==c.getter(a,["item","get"]).apply(c.getter(a,["item"]),["Состояние"])?"stat_docs":void 0))+" "+c.wrapUndef(c.utils.escape(c.getter(a,["templateBinding","statesDict",c.getter(a,["item","get"]).apply(c.getter(a,["item"]),["Состояние"]),"class"]))),style:"padding-right:20px"},[y.createText(""+c.wrapUndef(c.utils.escape(c.getter(a,["item","get"]).apply(c.getter(a,["item"]),[c.getter(a,["field"])]))))],{},m,this)],{},m,this),"Всего"===c.getter(a,["item","get"]).apply(c.getter(a,["item"]),["Состояние"])?[y.createTag("hr",{style:"display: block;margin-left: 0px;margin-top: 5px;background-color: #000000;border: none;height: 1px;margin-right:-5px;margin-left:-5px"},[],{},m,this)]:y.createText("")],i,m,this)],d,m);m.def&&(h=y.chain(h,m,i),m=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/StatTemplateExternal/StatEventsTable/resources/StatNumCol.tmpl",e,a)}return h||""};return a.includedFunctions={},a.stable=!0,a.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.StatEventsTable/resources/StatNumCol"}},a});
define("tmpl!SBIS3.EDO.StatEventsTable/resources/StatPercentCol",["Core/tmpl/js/tclosure"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={},a=function e(a,i,l,s,p){function g(){}var n=0,c=void 0!==t&&t?t:arguments[arguments.length-1];void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure"));var o={};p&&p.isSetts&&(o=p.fullContext||{});var d="string"==typeof l?l:"",m=void 0===r?void 0:r,u={id:[],def:void 0},y=c.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,a),f=this&&this.includedTemplates?this.includedTemplates:{},v=c.getMarkupGenerator(s);try{var h=v.joinElements([v.createTag("div",{stat_id:""+c.wrapUndef(c.utils.escape(c.getter(a,["templateBinding","statesDict",c.getter(a,["item","get"]).apply(c.getter(a,["item"]),["Состояние"]),"class"])))},["Всего"===c.getter(a,["item","get"]).apply(c.getter(a,["item"]),["Состояние"])?[v.createTag("div",{title:""+global.rk("Перейти к документам")},[v.createTag("span",{class:"stat_docs "+c.wrapUndef(c.utils.escape(c.getter(a,["templateBinding","statesDict",c.getter(a,["item","get"]).apply(c.getter(a,["item"]),["Состояние"]),"class"]))),style:"padding-right:20px"},[],{},u,this)],{},u,this),v.createTag("hr",{style:"display: block;margin-left: 0px;margin-top: 5px;background-color: #000000;border: none;height: 1px;margin-right:-5px;margin-left:-5px"},[],{},u,this)]:"Доставлено"===c.getter(a,["item","get"]).apply(c.getter(a,["item"]),["Состояние"])||"Отправлено"===c.getter(a,["item","get"]).apply(c.getter(a,["item"]),["Состояние"])?[v.createTag("div",{title:""+c.wrapUndef(c.utils.escape(c.getDecorators().number.apply(void 0,[c.getter(a,["item","get"]).apply(c.getter(a,["item"]),[c.getter(a,["field"])])])))},[v.createTag("span",{class:""+c.wrapUndef(c.utils.escape(c.getter(a,["templateBinding","statesDict",c.getter(a,["item","get"]).apply(c.getter(a,["item"]),["Состояние"]),"class"]))),style:"padding-right:20px"},[v.createText(""+c.wrapUndef(c.utils.escape(c.getter(c.getter(a,["item","get"]).apply(c.getter(a,["item"]),[c.getter(a,["field"])]),["toFixed"]).apply(c.getter(a,["item","get"]).apply(c.getter(a,["item"]),[c.getter(a,["field"])]),[1]))))],{},u,this)],{},u,this)]:[v.createTag("div",{title:""+c.wrapUndef(c.utils.escape(c.getDecorators().number.apply(void 0,[c.getter(a,["item","get"]).apply(c.getter(a,["item"]),[c.getter(a,["field"])])])))},[v.createTag("span",{class:"stat_docs "+c.wrapUndef(c.utils.escape(c.getter(a,["templateBinding","statesDict",c.getter(a,["item","get"]).apply(c.getter(a,["item"]),["Состояние"]),"class"]))),style:"padding-right:20px"},[v.createText(""+c.wrapUndef(c.utils.escape(c.getter(c.getter(a,["item","get"]).apply(c.getter(a,["item"]),[c.getter(a,["field"])]),["toFixed"]).apply(c.getter(a,["item","get"]).apply(c.getter(a,["item"]),[c.getter(a,["field"])]),[1]))))],{},u,this)],{},u,this)]],i,u,this)],d,u);u.def&&(h=v.chain(h,u,i),u=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/StatTemplateExternal/StatEventsTable/resources/StatPercentCol.tmpl",e,a)}return h||""};return a.includedFunctions={},a.stable=!0,a.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.StatEventsTable/resources/StatPercentCol"}},a});
define("tmpl!SBIS3.EDO.StatEventsTable/resources/StatColHead",["Core/tmpl/js/tclosure"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={},a=function e(a,n,o,l,s){function i(){}var c=0,u=void 0!==t&&t?t:arguments[arguments.length-1];void 0===u&&(eval("var thelpers = null;"),u=global.requirejs("View/Runner/tclosure"));var d={};s&&s.isSetts&&(d=s.fullContext||{});var p="string"==typeof o?o:"",m=void 0===r?void 0:r,v={id:[],def:void 0},f=u.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,a),S=this&&this.includedTemplates?this.includedTemplates:{},h=u.getMarkupGenerator(l);try{var g=h.joinElements([h.createTag("div",{class:"edo-externalStat__columnHeader "+u.wrapUndef(u.utils.escape(u.getter(a,["column","headerAddClassName"])))},[h.createText(" "+u.wrapUndef(u.utils.escape(u.getter(a,["column","title"])))+" ")],n,v,this)],p,v);v.def&&(g=h.chain(g,v,n),v=void 0)}catch(e){u.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/StatTemplateExternal/StatEventsTable/resources/StatColHead.tmpl",e,a)}return g||""};return a.includedFunctions={},a.stable=!0,a.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.StatEventsTable/resources/StatColHead"}},a});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.StatEventsTable", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".tarea100{height:100%}.extstat_aright{text-align:right}.extstat_col_padding{padding-right:20px}.external_stat_browser{padding:0}.all_docs{font-weight:700;padding-left:18px!important}.no_send_docs{font-weight:700;padding-left:18px!important}.stat_docs:hover{cursor:pointer!important;text-decoration:underline!important}.send_docs{font-weight:700;padding-left:18px!important}.rough_docs{color:grey!important;padding-left:18px!important}.ann_docs,.decl_docs,.kon_del_docs,.on_checking_docs,.recv_docs{color:grey!important;float:right!important;padding-left:18px!important}.error_docs{font-weight:700;color:red!important;padding-left:18px!important}.decl_docs_in,.deliv_docs,.no_deliv_docs,.proc_docs,.recv_docs_in{padding-left:18px!important}.common_underline{text-decoration:underline!important}.ann_docs_in,.kon_del_docs_in{color:grey!important;padding-left:18px!important}.edo-externalStat__columnHeader{font-size:13px;color:grey}.edo-externalStat__columnHeader-indent{padding-right:20px}.edo-externalStat__columnHeader-bold{font-weight:700;color:#000}"));head.appendChild(style);});}
define('js!SBIS3.EDO.StatEventsTable',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.StatEventsTable','js!SBIS3.EDO.FilterButtonsConfigsStats','js!WS.Data/Source/SbisService','js!WS.Data/Adapter/Sbis','js!SBIS3.EDO.ExternalStatisticsHandlers','js!WS.Data/Collection/RecordSet','WS.Data/Entity/Record','tmpl!SBIS3.EDO.StatEventsTable/resources/StatTitleCol','tmpl!SBIS3.EDO.StatEventsTable/resources/StatNumCol','tmpl!SBIS3.EDO.StatEventsTable/resources/StatPercentCol','tmpl!SBIS3.EDO.StatEventsTable/resources/StatColHead','css!SBIS3.EDO.StatEventsTable','Elektronnyj_dokumentooborot_localization'],function(t,e,i,a,r,s,o,n){'use strict';var l=t.extend({_dotTplFn:e,$protected:{_options:{browserName:'',methodName:'',objectName:'',createMethodName:'Создать',updateMethodName:'Записать',readMethodName:'Прочитать',destroyMethodName:'Удалить',ourOrganizationReportName:'js!SBIS3.EDO.StatisticsIncomingEventsOurOrganizations',printOptions:{}}},_modifyOptions:function(){var t=l.superclass._modifyOptions.apply(this,arguments);t.filters=t.filters||{'ФильтрДатаПериод':'Месяц'},delete t.filters['ФильтрСостояние'];var e=i(t.filters),a=[];return t.filterButtonConfig=t.configFilters.map(function(t){return e[t];}),a=t.configFastFilters.map(function(t){return e[t];}),t.fastDataFilterConfig=t.area.getFastDataFilterConfig(),t.fastDataFilterConfig.filterStructure=a,function(t){if(t.statFilterStructure){var e={},i=0;for(i=0;i<t.statFilterStructure.length;i++)e[t.statFilterStructure[i]['filterField']]=t.statFilterStructure[i];for(i=0;i<t.filterButtonConfig.length;i++)if(t.filterButtonConfig[i]['filterField']in e)t.filterButtonConfig[i]=e[t.filterButtonConfig[i]['filterField']];for(i=0;i<t.fastDataFilterConfig.length;i++)if(t.fastDataFilterConfig[i]['filterField']in e)t.fastDataFilterConfig[i]=e[t.fastDataFilterConfig[i]['filterField']];}}(t),t;},init:function(){l.superclass.init.call(this);var t=this.getChildControlByName('browserFastDataFilter'),e=this.getChildControlByName('saveAction');if(t)t.setItems(this._options.fastDataFilterConfig.data);var i=new a({endpoint:this._options.objectName,adapter:new r(),binding:{destroy:this._options.destroyMethodName,read:this._options.readMethodName,update:this._options.updateMethodName,create:this._options.createMethodName,query:this._options.methodName},idProperty:'Состояние'}),o=this.getChildControlByName('StatBrowser'),n=o.getView();if(n.setDataSource(i,true),n.setFilter(this._options.filters),this._options.needStatPrintBtn)s.addStatPrintButton({action:e,getMeta:this.getPrintData.bind(o,this._options.statesDict,this._options.printOptions)});},getPrintData:function(t,e){var i=new o({adapter:'adapter.sbis',format:[{name:'Заголовок',type:'string'},{name:'ИмяОтчета',type:'string'},{name:'ФильтрыОтчета',type:'string'},{name:'Данные',type:'recordset'}]}),a=new n({adapter:'adapter.sbis',format:i.getFormat()}),r=this.getView();return a.set('Заголовок',e.title),a.set('ФильтрыОтчета',this._getFilterButton().getChildControlByName('filterLine').getLinkedContext().getValue('titleText')),a.set('Данные',r.getItems()),i.add(a),{recordSet:i,xsl:e.xsl,columns:[{title:'Заголовок',field:'Заголовок'},{title:'ИмяОтчета',field:'ИмяОтчета'},{title:'ФильтрыОтчета',field:'ФильтрыОтчета'},{title:'Данные',field:'Данные'}]};}});return l;});
define('js!SBIS3.EDO.Modificators.IncomingEvents.Stat',['Elektronnyj_dokumentooborot_localization'],function(){'use strict';function e(){this._allowedItems=[],this._allowedMOPItems=[],this._fastFilterItems=['ФильтрВладелец','ТипДокументаВД'];}return e.prototype.getFastDataFilterConfig=function(){return{className:'edo-tasks__fastDataFilter',idProperty:'name',data:[{keyField:'key',displayField:'title',name:'FilterAuthorOrResponsibleMe',multiselect:false,className:'controls-DropdownList__linkStyle',showSelectedInList:true,values:[{key:'Все',value:'Все',title:rk('Все')},{key:'От меня',value:'От меня',title:rk('Мои')},{key:'От моего отдела',value:'От моего отдела',title:rk('Моего отдела')}]},{keyField:'ТипДокументаВД',displayField:'Название',name:'FilterDocumentType',multiselect:true,className:'controls-DropdownList__linkStyle',showSelectedInList:true,values:[{'ТипДокументаВД':'Все','Название':rk('Все типы документов')},{'ТипДокументаВД':'АктВР,АктПП','Название':rk('Акты (услуги, работы, права)')},{'ТипДокументаВД':'ЭДОНакл','Название':rk('Накладные')},{'ТипДокументаВД':'СчФктр,УпдСчфДоп','Название':rk('Счета-фактуры (вкл. в составе УПД)')},{'ТипДокументаВД':'счФактКор,УкдКсчфДис','Название':rk('Счета-фактуры корр. (вкл. в составе УКД)')},{'ТипДокументаВД':'УпдДоп','Название':rk('Передаточные документы')},{'ТипДокументаВД':'УкдДис','Название':rk('Передаточные документы корр.')},{'ТипДокументаВД':'АктСвер','Название':rk('Акты сверки')},{'ТипДокументаВД':'Договор','Название':rk('Договоры')},{'ТипДокументаВД':'ЭДОСч','Название':rk('Счета')}]}]};},e;});
define('js!SBIS3.EDO.StatIncomingEventsNew',['js!SBIS3.EDO.StatEventsTable','js!SBIS3.EDO.Modificators.IncomingEvents.Stat','Elektronnyj_dokumentooborot_localization'],function(t,e){'use strict';var n=t.extend({$protected:{_options:{browserName:'StatisticsIncomingEvents',methodName:'СтатистикаСобытий',objectName:'РеестрВходящих',createMethodName:'Создать',updateMethodName:'Записать',readMethodName:'Прочитать',destroyMethodName:'Удалить',configFilters:['ФильтрДатаПериодСтатистика','ФильтрДатаС','ФильтрДатаП','ФильтрВладелец','ФильтрОтветственноеЛицо','ФильтрЛицо1','ФильтрДокументНашаОрганизация','ФильтрКонкретныйИсполнитель','ФильтрНезакрепленные','ТипДокументаВД'],configFastFilters:['БыстрыйФильтрВладелец','БыстрыйТипДокументаВД'],ourOrganizationReportName:'js!SBIS3.EDO.StatisticsIncomingEventsOurOrganizations',printOptions:{xsl:'Elektronnyj_dokumentooborot/Statistika/Pechatnye_formy/IncomingMain.xsl',title:rk('Входящие документы')}}},_modifyOptions:function(t){return t.area=new e(),n.superclass._modifyOptions.apply(this,arguments);},init:function(){n.superclass.init.call(this);}});return n;});
define('js!SBIS3.EDO.Modificators.OutgoingEvents.Stat',['Elektronnyj_dokumentooborot_localization'],function(){'use strict';function e(){this._allowedItems=[],this._allowedMOPItems=[],this._fastFilterItems=['ФильтрВладелец','ТипДокументаВД'];}return e.prototype.getFastDataFilterConfig=function(){return{className:'edo-tasks__fastDataFilter',idProperty:'name',data:[{keyField:'key',displayField:'title',name:'FilterAuthorOrResponsibleMe',multiselect:false,className:'controls-DropdownList__linkStyle',showSelectedInList:true,values:[{key:'Все',title:rk('Все'),value:'Все'},{key:'От меня',title:rk('Мои'),value:'От меня'},{key:'От моего отдела',value:'От моего отдела',title:rk('Моего отдела')}]},{keyField:'ТипДокументаВД',displayField:'Название',name:'FilterDocumentType',multiselect:true,className:'controls-DropdownList__linkStyle',showSelectedInList:true,values:[{'ТипДокументаВД':'Все','Название':rk('Все типы документов')},{'ТипДокументаВД':'АктВР,АктПП','Название':rk('Акты (услуги, работы, права)')},{'ТипДокументаВД':'ЭДОНакл','Название':rk('Накладные')},{'ТипДокументаВД':'СчФктр,УпдСчфДоп','Название':rk('Счета-фактуры (вкл. в составе УПД)')},{'ТипДокументаВД':'счФактКор,УкдКсчфДис','Название':rk('Счета-фактуры корр. (вкл. в составе УКД)')},{'ТипДокументаВД':'УпдДоп','Название':rk('Передаточные документы')},{'ТипДокументаВД':'УкдДис','Название':rk('Передаточные документы корр.')},{'ТипДокументаВД':'АктСвер','Название':rk('Акты сверки')},{'ТипДокументаВД':'Договор','Название':rk('Договоры')},{'ТипДокументаВД':'ЭДОСч','Название':rk('Счета')}]}]};},e;});
define('js!SBIS3.EDO.StatOutgoingEventsNew',['js!SBIS3.EDO.StatEventsTable','js!SBIS3.EDO.Modificators.OutgoingEvents.Stat','Elektronnyj_dokumentooborot_localization'],function(t,e){'use strict';var i=t.extend({$protected:{_options:{browserName:'StatisticsOutgoingEvents',methodName:'СтатистикаСобытий',objectName:'РеестрИсходящих',createMethodName:'Создать',updateMethodName:'Записать',readMethodName:'Прочитать',destroyMethodName:'Удалить',configFilters:['ФильтрДатаПериодСтатистика','ФильтрДатаС','ФильтрДатаП','ФильтрВладелец','ФильтрОтветственноеЛицо','ФильтрЛицо1','ФильтрДокументНашаОрганизация','ФильтрКонкретныйИсполнитель','ФильтрНезакрепленные','ТипДокументаВД'],configFastFilters:['БыстрыйФильтрВладелец','БыстрыйТипДокументаВД'],ourOrganizationReportName:'js!SBIS3.EDO.StatisticsOutgoingEventsOurOrganizations',printOptions:{xsl:'Elektronnyj_dokumentooborot/Statistika/Pechatnye_formy/OutgoingMain.xsl',title:rk('Исходящие документы')}}},_modifyOptions:function(t){return t.area=new e(),i.superclass._modifyOptions.apply(this,arguments);},init:function(){i.superclass.init.call(this);}});return i;});
define('js!SBIS3.EDO.StatisticsContragentsHandlers',['Elektronnyj_dokumentooborot_localization'],function(){'use strict';return{applySourceFSToDestinationFS:function(t){if(t.statFilterStructure){var i={},e=0;for(e=0;e<t.statFilterStructure.length;e++)i[t.statFilterStructure[e]['filterField']]=t.statFilterStructure[e];for(e=0;e<t.filterButtonConfig.length;e++)if(t.filterButtonConfig[e]['filterField']in i)t.filterButtonConfig[e]=i[t.filterButtonConfig[e]['filterField']];for(e=0;e<t.fastDataFilterConfig.length;e++)if(t.fastDataFilterConfig[e]['filterField']in i)t.fastDataFilterConfig[e]=i[t.fastDataFilterConfig[e]['filterField']];}}};});
define("tmpl!SBIS3.EDO.StatisticsEventsContragents/StatisticsContragents",["Core/tmpl/js/tclosure","js!SBIS3.Engine.Browser","js!SBIS3.CONTROLS/OperationsPanel/PanelButton/OperationsPanelButton","js!SBIS3.EDO.FilterStatsContragents","js!SBIS3.EDO.FilterStatsContragentsSelector","js!SBIS3.CONTROLS/ScrollContainer","js!SBIS3.CONTROLS/Button/BackButton","js!SBIS3.CONTROLS/CompositeView"],function(){var t=Array.prototype.slice.call(arguments),e=t[0],r={};r["js!SBIS3.Engine.Browser"]=t[1],r["js!SBIS3.CONTROLS/OperationsPanel/PanelButton/OperationsPanelButton"]=t[2],r["js!SBIS3.EDO.FilterStatsContragents"]=t[3],r["js!SBIS3.EDO.FilterStatsContragentsSelector"]=t[4],r["js!SBIS3.CONTROLS/ScrollContainer"]=t[5],r["js!SBIS3.CONTROLS/Button/BackButton"]=t[6],r["js!SBIS3.CONTROLS/CompositeView"]=t[7];var n=function t(n,o,a,i,s){function l(){}var c=0,p=void 0!==e&&e?e:arguments[arguments.length-1];void 0===p&&(eval("var thelpers = null;"),p=global.requirejs("View/Runner/tclosure"));var u={};s&&s.isSetts&&(u=s.fullContext||{});var d="string"==typeof a?a:"",S=void 0===r?void 0:r,m={id:[],def:void 0},v=p.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,n),g=this&&this.includedTemplates?this.includedTemplates:{},f=p.getMarkupGenerator(i);try{var C=f.joinElements([f.createTag("div",{style:"height:100%;"},[f.createControl("wsControl","ws:SBIS3.Engine.Browser",{topTemplate:p.createDataArray([(new function(){var t=Object.create(n),e=function t(e,r,n,o,a){if(void 0===n)var n=arguments[2];var i=0,s="topTemplate";if(void 0===p&&(eval("var thelpers = null;"),p=global.requirejs("View/Runner/tclosure")),a&&a.isSetts)var l=a.fullContext||{};e=p.isolateScope(Object.create(this),e,s);var c="string"==typeof n?n:"",u={id:[],def:void 0},d=this&&this.includedTemplates?this.includedTemplates:{},m=p.getMarkupGenerator(o);try{var g=m.joinElements([m.createControl("wsControl","ws:SBIS3.CONTROLS/OperationsPanel/PanelButton/OperationsPanelButton",{name:"panelControlButton"},p.plainMerge(r,{class:"controls-OperationsPanelButton__showSeparator",name:"panelControlButton",sbisname:"panelControlButton"}),{data:e,ctx:this,pName:void 0!==s?s:void 0,viewController:v},n,S,d,p.config,l)],c,u);u.def&&(g=m.chain(g,u,r),u=void 0)}catch(t){p.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/StatTemplateExternal/StatEventsTable/StatisticsReportByContragents/StatisticsContragents.tmpl",t,e)}return g||""};this.func=p.makeFunctionSerializable(e,t)}).func]),filterButtonConfig:{template:p.createDataArray([(new function(){var t=Object.create(n),e=function t(e,r,n,o,a){if(void 0===n)var n=arguments[2];var i=0,s="template";if(void 0===p&&(eval("var thelpers = null;"),p=global.requirejs("View/Runner/tclosure")),a&&a.isSetts)var l=a.fullContext||{};e=p.isolateScope(Object.create(this),e,s);var c="string"==typeof n?n:"",u={id:[],def:void 0},d=this&&this.includedTemplates?this.includedTemplates:{},m=p.getMarkupGenerator(o);try{var g=m.joinElements([m.createControl("wsControl","ws:SBIS3.EDO.FilterStatsContragents",{},p.plainMerge(r,{}),{data:e,ctx:this,pName:void 0!==s?s:void 0,viewController:v},n,S,d,p.config,l)],c,u);u.def&&(g=m.chain(g,u,r),u=void 0)}catch(t){p.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/StatTemplateExternal/StatEventsTable/StatisticsReportByContragents/StatisticsContragents.tmpl",t,e)}return g||""};this.func=p.makeFunctionSerializable(e,t)}).func]),additionalFilterParamsTemplate:p.createDataArray([(new function(){var t=Object.create(n),e=function t(e,r,n,o,a){if(void 0===n)var n=arguments[2];var i=0,s="additionalFilterParamsTemplate";if(void 0===p&&(eval("var thelpers = null;"),p=global.requirejs("View/Runner/tclosure")),a&&a.isSetts)var l=a.fullContext||{};e=p.isolateScope(Object.create(this),e,s);var c="string"==typeof n?n:"",u={id:[],def:void 0},d=this&&this.includedTemplates?this.includedTemplates:{},m=p.getMarkupGenerator(o);try{var g=m.joinElements([m.createControl("wsControl","ws:SBIS3.EDO.FilterStatsContragentsSelector",{},p.plainMerge(r,{}),{data:e,ctx:this,pName:void 0!==s?s:void 0,viewController:v},n,S,d,p.config,l)],c,u);u.def&&(g=m.chain(g,u,r),u=void 0)}catch(t){p.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/StatTemplateExternal/StatEventsTable/StatisticsReportByContragents/StatisticsContragents.tmpl",t,e)}return g||""};this.func=p.makeFunctionSerializable(e,t)}).func]),resetLinkText:global.rk("За последний месяц"),filterStructure:p.getter(n,["filterButtonConfig"])},searchConfig:{placeholder:global.rk("Укажите название контрагента")},operationsPanelConfig:{items:[{type:{mark:!0},name:"operationsMark",componentType:"SBIS3.CONTROLS/OperationsPanel/Mark"},{options:{fileName:global.rk("Сводная ведомость по контрагентам"),caption:global.rk("Сохранить")},type:{mass:!0,selection:!0},name:"download",componentType:"SBIS3.CONTROLS/OperationsPanel/Unload"},{type:{mass:!0,selection:!0},options:{fileName:global.rk("Сводная ведомость по контрагентам"),caption:global.rk("Распечатать")},name:"print",componentType:"SBIS3.CONTROLS/OperationsPanel/Print"}]},reports:{name:"Статистика",value:"Elektronnyj_dokumentooborot/Statistika/Pechatnye_formy/StatisticsByContragents.xsl"},content:p.createDataArray([(new function(){var t=Object.create(n),e=function t(e,r,n,o,a){if(void 0===n)var n=arguments[2];var i=0,s="content";if(void 0===p&&(eval("var thelpers = null;"),p=global.requirejs("View/Runner/tclosure")),a&&a.isSetts)var l=a.fullContext||{};e=p.isolateScope(Object.create(this),e,s);var c="string"==typeof n?n:"",u={id:[],def:void 0},d=this&&this.includedTemplates?this.includedTemplates:{},m=p.getMarkupGenerator(o);try{var g=m.joinElements([m.createControl("wsControl","ws:SBIS3.CONTROLS/ScrollContainer",{content:p.createDataArray([(new function(){var t=Object.create(e),r=function t(e,r,n,o,a){if(void 0===n)var n=arguments[2];var i=0,s="content";if(void 0===p&&(eval("var thelpers = null;"),p=global.requirejs("View/Runner/tclosure")),a&&a.isSetts)var l=a.fullContext||{};e=p.isolateScope(Object.create(this),e,s);var c="string"==typeof n?n:"",u={id:[],def:void 0},d=this&&this.includedTemplates?this.includedTemplates:{},m=p.getMarkupGenerator(o);try{var g=m.joinElements([m.createControl("wsControl","ws:SBIS3.CONTROLS/Button/BackButton",{name:"fakeBackButton",caption:p.getter(e,["pathSelectorName"])},p.plainMerge(r,{name:"fakeBackButton",sbisname:"fakeBackButton"}),{data:e,ctx:this,pName:void 0!==s?s:void 0,viewController:v},n,S,d,p.config,l)],c,u);u.def&&(g=m.chain(g,u,r),u=void 0)}catch(t){p.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/StatTemplateExternal/StatEventsTable/StatisticsReportByContragents/StatisticsContragents.tmpl",t,e)}return g||""};this.func=p.makeFunctionSerializable(r,t)}).func,(new function(){var t=Object.create(e),r=function t(e,r,n,o,a){if(void 0===n)var n=arguments[2];var i=0,s="content";if(void 0===p&&(eval("var thelpers = null;"),p=global.requirejs("View/Runner/tclosure")),a&&a.isSetts)var l=a.fullContext||{};e=p.isolateScope(Object.create(this),e,s);var c="string"==typeof n?n:"",u={id:[],def:void 0},d=this&&this.includedTemplates?this.includedTemplates:{},m=p.getMarkupGenerator(o);try{var g=m.joinElements([m.createControl("wsControl","ws:SBIS3.CONTROLS/CompositeView",{columns:[{field:"Контрагент",title:""},{field:"ИНН/КПП",title:global.rk("ИНН / КПП"),width:"179"},{field:"Кол-во",title:global.rk("Документов"),width:"93"}],handlers:{onItemClick:p.getTypeFunc("js!SBIS3.EDO.ExternalStatisticsHandlers:onRowClickContragents",{})},name:"browserView",idProperty:"@Лицо",showPaging:!1,bindings:[{fieldName:"browser.filter",propName:"filter",propPath:[],fullPropName:"filter",propPathStr:"",oneWay:!1,direction:"fromContext",bindNonExistent:!0}],filter:p.getter(e,["filters"]),emptyHTML:global.rk("Нет данных"),itemsDragNDrop:"",itemsActions:[],showHead:!0,contextMenu:!1,docType:p.getter(e,["docType"]),pageSize:21,navigation:{lastPage:!0},infiniteScroll:!0,resultsTpl:"tmpl!SBIS3.EDO.StatisticsEventsContragents/StatContrResultsTpl",resultsPosition:"top",resultsText:"",esc:!1},p.plainMerge(r,{name:"browserView",sbisname:"browserView"}),{data:e,ctx:this,pName:void 0!==s?s:void 0,viewController:v},n,S,d,p.config,l)],c,u);u.def&&(g=m.chain(g,u,r),u=void 0)}catch(t){p.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/StatTemplateExternal/StatEventsTable/StatisticsReportByContragents/StatisticsContragents.tmpl",t,e)}return g||""};this.func=p.makeFunctionSerializable(r,t)}).func]),stickyContainer:!0,esc:!1},p.plainMerge(r,{class:"controls-ScrollContainer__flex"}),{data:e,ctx:this,pName:void 0!==s?s:void 0,viewController:v,internal:{__dirtyCheckingVars_0:p.getter(e,["pathSelectorName"]),__dirtyCheckingVars_8:p.getter(e,["docType"])}},n,S,d,p.config,l)],c,u);u.def&&(g=m.chain(g,u,r),u=void 0)}catch(t){p.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/StatTemplateExternal/StatEventsTable/StatisticsReportByContragents/StatisticsContragents.tmpl",t,e)}return g||""};this.func=p.makeFunctionSerializable(e,t)}).func]),name:p.getter(n,["browserName"]),className:"external_stat_browser ws-flexbox ws-flex-column ws-flex-grow-1",fastDataFilterConfig:p.getter(n,["fastDataFilterConfig"]),searchParam:"Поиск",stickyHeader:!0,esc:!1},{name:p.getter(n,["browserName"]),sbisname:p.getter(n,["browserName"])},{data:n,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:v,internal:{__dirtyCheckingVars_1:p.getter(n,["filterButtonConfig"]),__dirtyCheckingVars_12:p.getter(n,["pathSelectorName"]),__dirtyCheckingVars_20:p.getter(n,["docType"])}},a,S,g,p.config,u)],o,m,this)],d,m);m.def&&(C=f.chain(C,m,o),m=void 0)}catch(t){p.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/StatTemplateExternal/StatEventsTable/StatisticsReportByContragents/StatisticsContragents.tmpl",t,n)}return C||""};return n.includedFunctions={},n.stable=!0,n.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.StatisticsEventsContragents/StatisticsContragents"}},n});
define('js!SBIS3.EDO.Modificators.Contragents.Stat',['js!SBIS3.EDO.Modificators.DefaultModificator','Elektronnyj_dokumentooborot_localization'],function(e){'use strict';function t(){e.apply(this,arguments),this._allowedItems=[],this._allowedMOPItems=[],this._fastFilterItems=['ФильтрСостояние','ФильтрВладелец','ТипДокументаВД'];}return t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.prototype.getFastDataFilterConfig=function(){return{className:'edo-tasks__fastDataFilter',idProperty:'name',data:[{keyField:'key',displayField:'title',name:'FilterAuthorOrResponsibleMe',multiselect:false,className:'controls-DropdownList__linkStyle',showSelectedInList:true,values:[{key:'Все',title:rk('Все'),value:'Все'},{key:'От меня',title:rk('Мои'),value:'От меня'},{key:'От моего отдела',value:'От моего отдела',title:rk('Моего отдела')}]},{keyField:'key',displayField:'title',name:'FilterState',multiselect:false,className:'controls-DropdownList controls-DropdownList__linkStyle',showSelectedInList:true,values:[{key:'-1',title:rk('В любом состоянии')},{key:'10',title:rk('Внутренняя обработка')},{key:'2,3',title:rk('Недоставленные')},{key:'4',title:rk('Не получен ответ')},{key:'7',title:rk('Утвержденные')},{key:'9',title:rk('Отклоненные')},{key:'6',title:rk('С ошибками')},{key:'22',title:rk('Аннулированные')},{key:'19,20',title:rk('Удалено мной/контрагентом')},{key:'0,1',title:rk('Черновики')},{key:'-2',title:rk('Удаленные')}]},{keyField:'ТипДокументаВД',displayField:'Название',name:'FilterDocumentType',multiselect:true,className:'controls-DropdownList__linkStyle',showSelectedInList:true,values:[{'ТипДокументаВД':'Все','Название':rk('Все типы документов')},{'ТипДокументаВД':'АктВР,АктПП','Название':rk('Акты (услуги, работы, права)')},{'ТипДокументаВД':'ЭДОНакл','Название':rk('Накладные')},{'ТипДокументаВД':'СчФктр,УпдСчфДоп','Название':rk('Счета-фактуры (вкл. в составе УПД)')},{'ТипДокументаВД':'счФактКор,УкдКсчфДис','Название':rk('Счета-фактуры корр. (вкл. в составе УКД)')},{'ТипДокументаВД':'УпдДоп','Название':rk('Передаточные документы')},{'ТипДокументаВД':'УкдДис','Название':rk('Передаточные документы корр.')},{'ТипДокументаВД':'АктСвер','Название':rk('Акты сверки')},{'ТипДокументаВД':'Договор','Название':rk('Договоры')},{'ТипДокументаВД':'ЭДОСч','Название':rk('Счета')}]}]};},t;});
define("tmpl!SBIS3.EDO.StatisticsEventsContragents/StatContrResultsTpl",["Core/tmpl/js/tclosure"],function(){var t=Array.prototype.slice.call(arguments),e=t[0],r={},n=function t(n,i,s,o,a){function l(){}var c=0,d=void 0!==e&&e?e:arguments[arguments.length-1];void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure"));var p={};a&&a.isSetts&&(p=a.fullContext||{});var u="string"==typeof s?s:"",g=void 0===r?void 0:r,h={id:[],def:void 0},v=d.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,n),m=this&&this.includedTemplates?this.includedTemplates:{},f=d.getMarkupGenerator(o);try{var y=f.joinElements([f.createTag("tr",{class:"controls-DataGridView__results"},[f.createTag("td",{style:"background:#F0F0F0;",colspan:""+d.wrapUndef(d.utils.escape(d.getter(n,["columns","length"])-1))},[],{},h,this),f.createTag("td",{style:"background:#F0F0F0;overflow:hidden;height:20px;"},[f.createTag("div",{style:"height: 16px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-size:14px;color:#000000;vertical-align:middle;min-height:20px;line-height:20px;padding:4px;"},[f.createText(""+d.wrapUndef(d.utils.escape(d.getter(n,["item","get"]).apply(d.getter(n,["item"]),["Кол-во"]))))],{},h,this)],{},h,this)],i,h,this)],u,h);h.def&&(y=f.chain(y,h,i),h=void 0)}catch(t){d.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/StatTemplateExternal/StatEventsTable/StatisticsReportByContragents/StatContrResultsTpl.tmpl",t,n)}return y||""};return n.includedFunctions={},n.stable=!0,n.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.StatisticsEventsContragents/StatContrResultsTpl"}},n});
define('js!SBIS3.EDO.StatisticsEventsContragents',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.StatisticsEventsContragents/StatisticsContragents','js!SBIS3.EDO.StatisticsContragentsHandlers','js!SBIS3.EDO.FilterButtonsConfigsStats','js!SBIS3.EDO.Modificators.Contragents.Stat','Core/CommandDispatcher','WS.Data/Source/SbisService','WS.Data/Adapter/Sbis','tmpl!SBIS3.EDO.StatisticsEventsContragents/StatContrResultsTpl','js!SBIS3.EDO.ExternalStatisticsHandlers','Elektronnyj_dokumentooborot_localization'],function(t,e,i,s,a,n,r,o){'use strict';var l=t.extend({_dotTplFn:e,$protected:{_options:{autoHeight:false,autoWidth:false,browserName:'',pathSelectorName:'',objectName:'',queryName:'',eventType:'',configFilters:[]}},_modifyOptions:function(){var t=l.superclass._modifyOptions.apply(this,arguments);if(t.filterButtonConfig=[],t.statFilterStructure=t.statFilterStructure||[],t.filters)t.filters['ФильтрТипСобытия']=t.eventType;var e=s(t.filters),n=[];return t.filterButtonConfig=t.configFilters.map(function(t){return e[t];}),n=t.configFastFilters.map(function(t){return e[t];}),t.fastDataFilterConfig=new a().getFastDataFilterConfig(),t.fastDataFilterConfig.filterStructure=n,i.applySourceFSToDestinationFS(t),t;},init:function(){l.superclass.init.call(this);var t=this.getChildControlByName('browserFastDataFilter'),e=this.getChildControlByName('fakeBackButton'),i=this._options.browserName;if(t)t.setItems(this._options.fastDataFilterConfig.data);this.getChildControlByName('panelControlButton').setLinkedPanel(this.getChildControlByName('browserOperationsPanel')),e.subscribeTo(e,'onActivated',function(){n.sendCommand(this,'statsBackToStart',[i]);});var s=new r({endpoint:this._options.objectName,adapter:new o(),binding:{destroy:'Удалить',read:'Прочитать',update:'Записать',create:'Создать',query:this._options.queryName},idProperty:'@Лицо'}),a=this.getChildControlByName(i).getView();a.setDataSource(s,true),a.setFilter(this._options.filters);}});return l;});
define('js!SBIS3.EDO.StatisticsIncomingEventsContragentsNew',['js!SBIS3.EDO.StatisticsEventsContragents','Elektronnyj_dokumentooborot_localization'],function(t){'use strict';var e=t.extend({$protected:{_options:{browserName:'Incoming',pathSelectorName:rk('Поставщики'),objectName:'РеестрВходящих',queryName:'СтатистикаСобытийПоКонтрагенту',eventType:'0',configFilters:['ФильтрДатаПериодСтатистика','ФильтрДатаС','ФильтрДатаП','ФильтрСостояние','ФильтрВладелец','ФильтрОтветственноеЛицо','ФильтрДокументНашаОрганизация','ФильтрКонкретныйИсполнитель','ФильтрНезакрепленные','ФильтрТипСобытия','ТипДокументаВД'],configFastFilters:['БыстрыйФильтрВладелец','БыстрыйТипДокументаВД','БыстрыйФильтрСостояние']}},init:function(){e.superclass.init.call(this);}});return e;});
define('js!SBIS3.EDO.StatisticsOutgoingEventsContragentsNew',['js!SBIS3.EDO.StatisticsEventsContragents','Elektronnyj_dokumentooborot_localization'],function(t){'use strict';var e=t.extend({$protected:{_options:{browserName:'Outgoing',pathSelectorName:rk('Покупатели'),objectName:'РеестрИсходящих',queryName:'СтатистикаСобытийПоКонтрагенту',eventType:'1',configFilters:['ФильтрДатаПериодСтатистика','ФильтрДатаС','ФильтрДатаП','ФильтрСостояние','ФильтрВладелец','ФильтрОтветственноеЛицо','ФильтрДокументНашаОрганизация','ФильтрКонкретныйИсполнитель','ФильтрНезакрепленные','ФильтрТипСобытия','ТипДокументаВД'],configFastFilters:['БыстрыйФильтрВладелец','БыстрыйТипДокументаВД','БыстрыйФильтрСостояние']}},init:function(){e.superclass.init.call(this);}});return e;});
define('js!SBIS3.EDO.Modificators.OurOrganizations.Stat',['js!SBIS3.EDO.Modificators.DefaultModificator','Elektronnyj_dokumentooborot_localization'],function(t){'use strict';function e(){t.apply(this,arguments),this._fastFilterItems=['ФильтрВладелец'];}return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.prototype.getFastDataFilterConfig=function(){return{className:'edo-tasks__fastDataFilter',idProperty:'name',filterStructure:this._getFastDataFilterStructure(this._fastFilterItems),data:[{keyField:'key',displayField:'title',name:'FilterAuthorOrResponsibleMe',multiselect:false,className:'controls-DropdownList__linkStyle',showSelectedInList:true,values:[{key:'Все',title:rk('Все'),value:'Все'},{key:'От меня',title:rk('Мои'),value:'От меня'},{key:'От моего отдела',title:rk('Моего отдела'),value:'От моего отдела'}]}]};},e;});
define("tmpl!SBIS3.EDO.StatisticsOurOrganizations",["Core/tmpl/js/tclosure","js!SBIS3.Engine.Browser","js!SBIS3.CONTROLS/OperationsPanel/PanelButton/OperationsPanelButton","js!SBIS3.EDO.FilterStatsOrganizations","js!SBIS3.EDO.FilterStatsOrganizationsSelector","js!SBIS3.CONTROLS/ScrollContainer","js!SBIS3.CONTROLS/Button/BackButton","js!SBIS3.CONTROLS/Tree/CompositeView"],function(){var t=Array.prototype.slice.call(arguments),e=t[0],r={};r["js!SBIS3.Engine.Browser"]=t[1],r["js!SBIS3.CONTROLS/OperationsPanel/PanelButton/OperationsPanelButton"]=t[2],r["js!SBIS3.EDO.FilterStatsOrganizations"]=t[3],r["js!SBIS3.EDO.FilterStatsOrganizationsSelector"]=t[4],r["js!SBIS3.CONTROLS/ScrollContainer"]=t[5],r["js!SBIS3.CONTROLS/Button/BackButton"]=t[6],r["js!SBIS3.CONTROLS/Tree/CompositeView"]=t[7];var a=function t(a,o,n,i,s){function l(){}var c=0,u=void 0!==e&&e?e:arguments[arguments.length-1];void 0===u&&(eval("var thelpers = null;"),u=global.requirejs("View/Runner/tclosure"));var p={};s&&s.isSetts&&(p=s.fullContext||{});var d="string"==typeof n?n:"",S=void 0===r?void 0:r,m={id:[],def:void 0},v=u.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,a),g=this&&this.includedTemplates?this.includedTemplates:{},f=u.getMarkupGenerator(i);try{var O=f.joinElements([f.createTag("div",{class:"edo-StatisticsReportByOurOrganizations",style:"height:100%;"},[f.createControl("wsControl","ws:SBIS3.Engine.Browser",{topTemplate:u.createDataArray([(new function(){var t=Object.create(a),e=function t(e,r,a,o,n){if(void 0===a)var a=arguments[2];var i=0,s="topTemplate";if(void 0===u&&(eval("var thelpers = null;"),u=global.requirejs("View/Runner/tclosure")),n&&n.isSetts)var l=n.fullContext||{};e=u.isolateScope(Object.create(this),e,s);var c="string"==typeof a?a:"",p={id:[],def:void 0},d=this&&this.includedTemplates?this.includedTemplates:{},m=u.getMarkupGenerator(o);try{var g=m.joinElements([m.createControl("wsControl","ws:SBIS3.CONTROLS/OperationsPanel/PanelButton/OperationsPanelButton",{name:"panelControlButton"},u.plainMerge(r,{class:"controls-OperationsPanelButton__showSeparator",name:"panelControlButton",sbisname:"panelControlButton"}),{data:e,ctx:this,pName:void 0!==s?s:void 0,viewController:v},a,S,d,u.config,l)],c,p);p.def&&(g=m.chain(g,p,r),p=void 0)}catch(t){u.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/StatTemplateExternal/StatEventsTable/StatisticsReportByOurOrganizations/StatisticsOurOrganizations.tmpl",t,e)}return g||""};this.func=u.makeFunctionSerializable(e,t)}).func]),filterButtonConfig:{template:u.createDataArray([(new function(){var t=Object.create(a),e=function t(e,r,a,o,n){if(void 0===a)var a=arguments[2];var i=0,s="template";if(void 0===u&&(eval("var thelpers = null;"),u=global.requirejs("View/Runner/tclosure")),n&&n.isSetts)var l=n.fullContext||{};e=u.isolateScope(Object.create(this),e,s);var c="string"==typeof a?a:"",p={id:[],def:void 0},d=this&&this.includedTemplates?this.includedTemplates:{},m=u.getMarkupGenerator(o);try{var g=m.joinElements([m.createControl("wsControl","ws:SBIS3.EDO.FilterStatsOrganizations",{},u.plainMerge(r,{}),{data:e,ctx:this,pName:void 0!==s?s:void 0,viewController:v},a,S,d,u.config,l)],c,p);p.def&&(g=m.chain(g,p,r),p=void 0)}catch(t){u.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/StatTemplateExternal/StatEventsTable/StatisticsReportByOurOrganizations/StatisticsOurOrganizations.tmpl",t,e)}return g||""};this.func=u.makeFunctionSerializable(e,t)}).func]),additionalFilterParamsTemplate:u.createDataArray([(new function(){var t=Object.create(a),e=function t(e,r,a,o,n){if(void 0===a)var a=arguments[2];var i=0,s="additionalFilterParamsTemplate";if(void 0===u&&(eval("var thelpers = null;"),u=global.requirejs("View/Runner/tclosure")),n&&n.isSetts)var l=n.fullContext||{};e=u.isolateScope(Object.create(this),e,s);var c="string"==typeof a?a:"",p={id:[],def:void 0},d=this&&this.includedTemplates?this.includedTemplates:{},m=u.getMarkupGenerator(o);try{var g=m.joinElements([m.createControl("wsControl","ws:SBIS3.EDO.FilterStatsOrganizationsSelector",{},u.plainMerge(r,{}),{data:e,ctx:this,pName:void 0!==s?s:void 0,viewController:v},a,S,d,u.config,l)],c,p);p.def&&(g=m.chain(g,p,r),p=void 0)}catch(t){u.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/StatTemplateExternal/StatEventsTable/StatisticsReportByOurOrganizations/StatisticsOurOrganizations.tmpl",t,e)}return g||""};this.func=u.makeFunctionSerializable(e,t)}).func]),resetLinkText:global.rk("За последний месяц"),filterStructure:u.getter(a,["filterButtonConfig"])},content:u.createDataArray([(new function(){var t=Object.create(a),e=function t(e,r,a,o,n){if(void 0===a)var a=arguments[2];var i=0,s="content";if(void 0===u&&(eval("var thelpers = null;"),u=global.requirejs("View/Runner/tclosure")),n&&n.isSetts)var l=n.fullContext||{};e=u.isolateScope(Object.create(this),e,s);var c="string"==typeof a?a:"",p={id:[],def:void 0},d=this&&this.includedTemplates?this.includedTemplates:{},m=u.getMarkupGenerator(o);try{var g=m.joinElements([m.createControl("wsControl","ws:SBIS3.CONTROLS/ScrollContainer",{content:u.createDataArray([(new function(){var t=Object.create(e),r=function t(e,r,a,o,n){if(void 0===a)var a=arguments[2];var i=0,s="content";if(void 0===u&&(eval("var thelpers = null;"),u=global.requirejs("View/Runner/tclosure")),n&&n.isSetts)var l=n.fullContext||{};e=u.isolateScope(Object.create(this),e,s);var c="string"==typeof a?a:"",p={id:[],def:void 0},d=this&&this.includedTemplates?this.includedTemplates:{},m=u.getMarkupGenerator(o);try{var g=m.joinElements([m.createControl("wsControl","ws:SBIS3.CONTROLS/Button/BackButton",{caption:global.rk("Текущее состояние по нашим организациям"),tooltip:global.rk("К выбору отчета"),command:"statsBackToStart",commandArgs:["OrganizationsBrowser"]},u.plainMerge(r,{}),{data:e,ctx:this,pName:void 0!==s?s:void 0,viewController:v},a,S,d,u.config,l)],c,p);p.def&&(g=m.chain(g,p,r),p=void 0)}catch(t){u.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/StatTemplateExternal/StatEventsTable/StatisticsReportByOurOrganizations/StatisticsOurOrganizations.tmpl",t,e)}return g||""};this.func=u.makeFunctionSerializable(r,t)}).func,(new function(){var t=Object.create(e),r=function t(e,r,a,o,n){if(void 0===a)var a=arguments[2];var i=0,s="content";if(void 0===u&&(eval("var thelpers = null;"),u=global.requirejs("View/Runner/tclosure")),n&&n.isSetts)var l=n.fullContext||{};e=u.isolateScope(Object.create(this),e,s);var c="string"==typeof a?a:"",p={id:[],def:void 0},d=this&&this.includedTemplates?this.includedTemplates:{},m=u.getMarkupGenerator(o);try{var g=m.joinElements([m.createControl("wsControl","ws:SBIS3.CONTROLS/Tree/CompositeView",{handlers:{onItemClick:u.getTypeFunc("js!SBIS3.EDO.StatisticsOurOrganizations:prototype.onItemClick",{}),onClick:u.getTypeFunc("js!SBIS3.EDO.StatisticsOurOrganizations:prototype.onClick",{})},name:"browserView",showPaging:!1,bindings:[{fieldName:"browser.filter",propName:"filter",propPath:[],fullPropName:"filter",propPathStr:"",oneWay:!1,direction:"fromContext",bindNonExistent:!0}],filter:u.getter(e,["filters"])||{},className:"edo-StatisticsOurOrgs__view controls-DataGridView__overflow-ellipsis controls-DataGridView__hasSeparator controls-ListView__withoutMarker",idProperty:"@Лицо",parentProperty:"Раздел",emptyHTML:global.rk("Нет данных"),partialyReload:!1,allowEnterToFolder:!1,itemsDragNDrop:"",itemsActions:[],showHead:!0,contextMenu:!1,docType:u.getter(e,["docType"]),pageSize:21,navigation:{lastPage:!0},infiniteScroll:!0,resultsPosition:"top",resultsText:"",footerTpl:"tmpl!SBIS3.EDO.StatisticsOurOrganizations/resources/FooterTemplate",expand:!0,esc:!1},u.plainMerge(r,{name:"browserView",sbisname:"browserView"}),{data:e,ctx:this,pName:void 0!==s?s:void 0,viewController:v},a,S,d,u.config,l)],c,p);p.def&&(g=m.chain(g,p,r),p=void 0)}catch(t){u.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/StatTemplateExternal/StatEventsTable/StatisticsReportByOurOrganizations/StatisticsOurOrganizations.tmpl",t,e)}return g||""};this.func=u.makeFunctionSerializable(r,t)}).func]),stickyContainer:!0,esc:!1},u.plainMerge(r,{class:"controls-ScrollContainer__flex"}),{data:e,ctx:this,pName:void 0!==s?s:void 0,viewController:v,internal:{__dirtyCheckingVars_10:u.getter(e,["docType"])}},a,S,d,u.config,l)],c,p);p.def&&(g=m.chain(g,p,r),p=void 0)}catch(t){u.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/StatTemplateExternal/StatEventsTable/StatisticsReportByOurOrganizations/StatisticsOurOrganizations.tmpl",t,e)}return g||""};this.func=u.makeFunctionSerializable(e,t)}).func]),name:"OrganizationsBrowser",className:"external_stat_browser ws-flexbox ws-flex-column ws-flex-grow-1",fastDataFilterConfig:u.getter(a,["fastDataFilterConfig"]),searchParam:"Поиск",searchConfig:{placeholder:global.rk.apply(a,["Укажите название организации"])},stickyHeader:!0,operationsPanelConfig:{items:[{name:"print",componentType:"SBIS3.CONTROLS/OperationsPanel/Print",type:{mass:!0},options:{fileName:global.rk.apply(a,["Сводная ведомость по организациям"]),caption:global.rk.apply(a,["Распечатать"])}}]},esc:!1},{name:"OrganizationsBrowser",sbisname:"OrganizationsBrowser"},{data:a,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:v,internal:{__dirtyCheckingVars_1:u.getter(a,["filterButtonConfig"]),__dirtyCheckingVars_12:u.getter(a,["docType"])}},n,S,g,u.config,p)],o,m,this)],d,m);m.def&&(O=f.chain(O,m,o),m=void 0)}catch(t){u.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/StatTemplateExternal/StatEventsTable/StatisticsReportByOurOrganizations/StatisticsOurOrganizations.tmpl",t,a)}return O||""};return a.includedFunctions={},a.stable=!0,a.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.StatisticsOurOrganizations"}},a});
define("tmpl!SBIS3.EDO.StatisticsOurOrganizations/resources/ColumnHeaderTemplate",["Core/tmpl/js/tclosure"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={},n=function e(n,a,o,i,s){function l(){}var c=0,u=void 0!==t&&t?t:arguments[arguments.length-1];void 0===u&&(eval("var thelpers = null;"),u=global.requirejs("View/Runner/tclosure"));var d={};s&&s.isSetts&&(d=s.fullContext||{});var p="string"==typeof o?o:"",m=void 0===r?void 0:r,v={id:[],def:void 0},f=u.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,n),g=this&&this.includedTemplates?this.includedTemplates:{},h=u.getMarkupGenerator(i);try{var S=h.joinElements([h.createTag("div",{class:"controls-DataGridView__th-content "+u.wrapUndef(u.utils.escape(u.getter(n,["column","headerAddClassName"])))},[h.createText(" "+u.wrapUndef(u.utils.escape(u.getter(n,["column","title"])))+" ")],a,v,this)],p,v);v.def&&(S=h.chain(S,v,a),v=void 0)}catch(e){u.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/StatTemplateExternal/StatEventsTable/StatisticsReportByOurOrganizations/resources/ColumnHeaderTemplate.tmpl",e,n)}return S||""};return n.includedFunctions={},n.stable=!0,n.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.StatisticsOurOrganizations/resources/ColumnHeaderTemplate"}},n});
define("tmpl!SBIS3.EDO.StatisticsOurOrganizations/resources/FooterTemplate",["Core/tmpl/js/tclosure"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={},o=function e(o,a,i,n,s){function l(){}var c=0,u=void 0!==t&&t?t:arguments[arguments.length-1];void 0===u&&(eval("var thelpers = null;"),u=global.requirejs("View/Runner/tclosure"));var d={};s&&s.isSetts&&(d=s.fullContext||{});var p="string"==typeof i?i:"",m=void 0===r?void 0:r,v={id:[],def:void 0},f=u.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),g=this&&this.includedTemplates?this.includedTemplates:{},S=u.getMarkupGenerator(n);try{var O=S.joinElements([u.getter(o,["totalCount"])?[S.createTag("div",{class:"edo-StatisticsOurOrgs__view__footer"},[S.createText(" "+global.rk("Всего")+u.wrapUndef(u.utils.escape(": "+u.getter(o,["totalCount"])))+" ")],{},v,this)]:S.createText("")],p,v);v.def&&(O=S.chain(O,v,a),v=void 0)}catch(e){u.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/StatTemplateExternal/StatEventsTable/StatisticsReportByOurOrganizations/resources/FooterTemplate.tmpl",e,o)}return O||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.StatisticsOurOrganizations/resources/FooterTemplate"}},o});
define("tmpl!SBIS3.EDO.StatisticsOurOrganizations/resources/ItemTemplate",["Core/tmpl/js/tclosure"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={},a=function e(a,n,o,s,i){function l(){}var c=0,u=void 0!==t&&t?t:arguments[arguments.length-1];void 0===u&&(eval("var thelpers = null;"),u=global.requirejs("View/Runner/tclosure"));var p={};i&&i.isSetts&&(p=i.fullContext||{});var m="string"==typeof o?o:"",d=void 0===r?void 0:r,g={id:[],def:void 0},v=u.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,a),T=this&&this.includedTemplates?this.includedTemplates:{},f=u.getMarkupGenerator(s);try{var h=f.joinElements([void(T.template=function(e,t){this&&this.includedTemplates&&this.includedTemplates;var r=u.getMarkupGenerator(s);try{var a=r.joinElements([u.getter(e,["columnValue"])?[r.createTag("span",{},[r.createText(" "+u.wrapUndef(u.utils.escape(u.getter(e,["columnValue"])))+" ")],{},g,this)]:r.createText("")],m,g);g.def&&(a=r.chain(a,g,t),g=void 0)}catch(t){u.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/StatTemplateExternal/StatEventsTable/StatisticsReportByOurOrganizations/resources/ItemTemplate.tmpl",t,e)}return a||""}.bind({includedTemplates:T})),function(e,t){u.prepareAttrsForFocus(t,e,"0");this&&this.includedTemplates&&this.includedTemplates;var r=u.getMarkupGenerator(s);try{var a=r.joinElements([u.getter(e,["columnValue"])?[r.createTag("span",{},[r.createText(" "+u.wrapUndef(u.utils.escape(u.getter(e,["columnValue"])))+" ")],{},g,this)]:r.createText("")],m,g);g.def&&(a=r.chain(a,g,t),g=void 0)}catch(t){u.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/StatTemplateExternal/StatEventsTable/StatisticsReportByOurOrganizations/resources/ItemTemplate.tmpl",t,e)}return a||""}(u.calculateScope(u.uniteScope(u.utils.escape({columnValue:u.getter(a,["item","getColumnValue"]).apply(u.getter(a,["item"]),[u.getter(a,["field"])])}),{}),u.plainMerge),u.plainMerge(n,{}))],m,g);g.def&&(h=f.chain(h,g,n),g=void 0)}catch(e){u.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/StatTemplateExternal/StatEventsTable/StatisticsReportByOurOrganizations/resources/ItemTemplate.tmpl",e,a)}return h||""};return a.includedFunctions={},a.stable=!0,a.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.StatisticsOurOrganizations/resources/ItemTemplate"}},a});
define("tmpl!SBIS3.EDO.StatisticsOurOrganizations/resources/FirstContentCellTemplate",["Core/tmpl/js/tclosure","tmpl!SBIS3.EDO.StatisticsOurOrganizations/resources/ItemTemplate"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["tmpl!SBIS3.EDO.StatisticsOurOrganizations/resources/ItemTemplate"]=e[1];var i=function e(i,a,n,o,s){function l(){}var c=0,u=void 0!==t&&t?t:arguments[arguments.length-1];void 0===u&&(eval("var thelpers = null;"),u=global.requirejs("View/Runner/tclosure"));var p={};s&&s.isSetts&&(p=s.fullContext||{});var d="string"==typeof n?n:"",m=void 0===r?void 0:r,S={id:[],def:void 0},v=u.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,i),O=this&&this.includedTemplates?this.includedTemplates:{},g=u.getMarkupGenerator(o);try{var f=g.joinElements([g.createControl("template","tmpl!SBIS3.EDO.StatisticsOurOrganizations/resources/ItemTemplate",u.uniteScope(u.utils.escape(u.uniteScope(i,{parent:void 0,element:void 0})(u.plainMerge)),{}),{},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:v},o?n+"part_"+c+++"_":n,m,O,u.config,p),u.getter(i,["isNode"])?[g.createTag("span",{class:"edo-StatisticsOurOrgs__view__td-gray"},[g.createText(" "+u.wrapUndef(u.utils.escape(", "+global.rk.apply(i,["в том числе по филиалам"])+":"))+" ")],{},S,this)]:g.createText("")],d,S);S.def&&(f=g.chain(f,S,a),S=void 0)}catch(e){u.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/StatTemplateExternal/StatEventsTable/StatisticsReportByOurOrganizations/resources/FirstContentCellTemplate.tmpl",e,i)}return f||""};return i.includedFunctions={},i.stable=!0,i.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.StatisticsOurOrganizations/resources/FirstContentCellTemplate"}},i});
define('js!SBIS3.EDO.StatisticsOurOrganizations.Model',['WS.Data/Entity/Model','WS.Data/Di','Elektronnyj_dokumentooborot_localization'],function(t,e){'use strict';var i=t.extend({_moduleName:'SBIS3.EDO.StatisticsOurOrganizations.Model',getColumnValue:function(t){if(t=t||'',this.get('Раздел@')&&'number'===typeof this.get(t)){var e=function(){var i=this.getOwner(),r=this.get(t),n;for(n=0;n<i.getCount();n++){var a=i.at(n);if(a.get('Раздел')===this.get('@Лицо'))r+=e.apply(a);}return r;};return e.apply(this)||'';}else return this.get(t)||'';}});return e.register('StatisticsOurOrganizations.Model',i),i;});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.StatisticsOurOrganizations", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-StatisticsOurOrgs__view__td-bold{font-weight:700}.edo-StatisticsOurOrgs__view__td-black,.edo-StatisticsOurOrgs__view__td-black:hover{color:#000!important}.edo-StatisticsOurOrgs__view__td-gray,.edo-StatisticsOurOrgs__view__td-gray:hover{color:#999!important}.edo-StatisticsOurOrgs__view__td-red,.edo-StatisticsOurOrgs__view__td-red:hover{color:red!important}.edo-StatisticsOurOrgs__view__footer{padding:6px 6px 6px 1px;text-align:right;line-height:20px;font-size:12px;color:#999!important}.edo-StatisticsOurOrgs__view__td-default{text-decoration:none!important;cursor:default!important}.edo-StatisticsOurOrgs__view .controls-DataGridView__tbody .controls-DataGridView__td .controls-DataGridView__columnValue:empty{position:absolute;left:0;top:0;cursor:default!important;width:100%;height:100%}.edo-StatisticsOurOrgs__view .controls-DataGridView__results .controls-DataGridView__td:not(.controls-DataGridView__firstContentCell):hover,.edo-StatisticsOurOrgs__view .controls-DataGridView__tbody .controls-DataGridView__td:not(.controls-DataGridView__firstContentCell):hover,.edo-StatisticsOurOrgs__view__td-firstContentCell:hover .controls-DataGridView__columnValue span:first-child,.edo-StatisticsOurOrgs__view__td-firstContentCell:hover .controls-TreeView__folderTitle span:first-child{text-decoration:underline;cursor:pointer}.edo-StatisticsOurOrgs__view__td-firstContentCell .controls-DataGridView__columnValue span,.edo-StatisticsOurOrgs__view__td-firstContentCell .controls-TreeView__folderTitle span{display:inline-block}"));head.appendChild(style);});}
define('js!SBIS3.EDO.StatisticsOurOrganizations',['SBIS3.CONTROLS/CompoundControl','js!SBIS3.EDO.Modificators','js!SBIS3.EDO.FilterButtonsConfigsStats','js!SBIS3.EDO.Modificators.OurOrganizations.Stat','WS.Data/Source/SbisService','Core/helpers/Object/find','Core/core-merge','Core/CommandDispatcher','tmpl!SBIS3.EDO.StatisticsOurOrganizations','tmpl!SBIS3.EDO.StatisticsOurOrganizations/resources/ColumnHeaderTemplate','tmpl!SBIS3.EDO.StatisticsOurOrganizations/resources/FooterTemplate','tmpl!SBIS3.EDO.StatisticsOurOrganizations/resources/ItemTemplate','tmpl!SBIS3.EDO.StatisticsOurOrganizations/resources/FirstContentCellTemplate','js!SBIS3.EDO.StatisticsOurOrganizations.Model','css!SBIS3.EDO.StatisticsOurOrganizations','Elektronnyj_dokumentooborot_localization'],function(t,e,i,s,a,r,o,l,n){'use strict';var d=t.extend({_dotTplFn:n,$protected:{_options:{incoming:true,filters:{},statFilterStructure:null,autoHeight:false},_$columnsState:{columnsStorage:[{field:'Название',className:'edo-StatisticsOurOrgs__view__td-firstContentCell',cellTemplate:'tmpl!SBIS3.EDO.StatisticsOurOrganizations/resources/FirstContentCellTemplate'},{field:'Всего',title:rk('Всего'),cellTemplate:'tmpl!SBIS3.EDO.StatisticsOurOrganizations/resources/ItemTemplate',className:'edo-StatisticsOurOrgs__view__td-bold edo-StatisticsOurOrgs__view__td-black controls-DataGridView__td__textAlignRight',width:80},{field:'Обработка_внутри_компании',title:rk('В обработке'),cellTemplate:'tmpl!SBIS3.EDO.StatisticsOurOrganizations/resources/ItemTemplate',headerAddClassName:'edo-StatisticsOurOrgs__view__td-black',headTemplate:'tmpl!SBIS3.EDO.StatisticsOurOrganizations/resources/ColumnHeaderTemplate',className:'edo-StatisticsOurOrgs__view__td-left-border controls-DataGridView__td__textAlignRight',width:83},{field:'Утверждено',title:rk('Утверждено'),cellTemplate:'tmpl!SBIS3.EDO.StatisticsOurOrganizations/resources/ItemTemplate',headerAddClassName:'edo-StatisticsOurOrgs__view__td-black',headTemplate:'tmpl!SBIS3.EDO.StatisticsOurOrganizations/resources/ColumnHeaderTemplate',className:'edo-StatisticsOurOrgs__view__td-left-border controls-DataGridView__td__textAlignRight',width:82},{field:'Отправлено',title:rk('Отправлено'),headerAddClassName:'edo-StatisticsOurOrgs__view__td-black edo-StatisticsOurOrgs__view__td-bold',cellTemplate:'tmpl!SBIS3.EDO.StatisticsOurOrganizations/resources/ItemTemplate',headTemplate:'tmpl!SBIS3.EDO.StatisticsOurOrganizations/resources/ColumnHeaderTemplate',className:'controls-DataGridView__td__textAlignRight edo-StatisticsOurOrgs__view__td-left-border edo-StatisticsOurOrgs__view__td-default',width:75},{field:'Не_доставлено',title:rk('Не доставлено'),headerAddClassName:'edo-StatisticsOurOrgs__view__td-black',headTemplate:'tmpl!SBIS3.EDO.StatisticsOurOrganizations/resources/ColumnHeaderTemplate',cellTemplate:'tmpl!SBIS3.EDO.StatisticsOurOrganizations/resources/ItemTemplate',className:'controls-DataGridView__td__textAlignRight edo-StatisticsOurOrgs__view__td-left-border',width:90},{field:'Доставлено',title:rk('Доставлено'),headerAddClassName:'edo-StatisticsOurOrgs__view__td-black',headTemplate:'tmpl!SBIS3.EDO.StatisticsOurOrganizations/resources/ColumnHeaderTemplate',cellTemplate:'tmpl!SBIS3.EDO.StatisticsOurOrganizations/resources/ItemTemplate',className:'controls-DataGridView__td__textAlignRight edo-StatisticsOurOrgs__view__td-left-border edo-StatisticsOurOrgs__view__td-default',width:74},{field:'Не_получен_ответ',title:rk('Не получен ответ'),headerAddClassName:'icon-16 icon-Sent2 icon-primary',headTemplate:'tmpl!SBIS3.EDO.StatisticsOurOrganizations/resources/ColumnHeaderTemplate',cellTemplate:'tmpl!SBIS3.EDO.StatisticsOurOrganizations/resources/ItemTemplate',className:'controls-DataGridView__td__textAlignRight edo-StatisticsOurOrgs__view__td-gray',width:50},{field:'Принято',headTooltip:rk('Утверждено'),headerAddClassName:'icon-16 icon-Successful icon-done',headTemplate:'tmpl!SBIS3.EDO.StatisticsOurOrganizations/resources/ColumnHeaderTemplate',cellTemplate:'tmpl!SBIS3.EDO.StatisticsOurOrganizations/resources/ItemTemplate',className:'controls-DataGridView__td__textAlignRight edo-StatisticsOurOrgs__view__td-gray',width:50},{field:'Отклонено',title:rk('Отклонено'),headerAddClassName:'edo-StatisticsOurOrgs__view__td-black',cellTemplate:'tmpl!SBIS3.EDO.StatisticsOurOrganizations/resources/ItemTemplate',headTemplate:'tmpl!SBIS3.EDO.StatisticsOurOrganizations/resources/ColumnHeaderTemplate',className:'edo-StatisticsOurOrgs__view__td-left-border controls-DataGridView__td__textAlignRight',width:75},{field:'Аннулировано',title:rk('Аннулировано'),cellTemplate:'tmpl!SBIS3.EDO.StatisticsOurOrganizations/resources/ItemTemplate',className:'edo-StatisticsOurOrgs__view__td-left-border edo-StatisticsOurOrgs__view__td-gray controls-DataGridView__td__textAlignRight',width:94},{field:'С_ошибками',title:rk('С ошибками'),headerAddClassName:'edo-StatisticsOurOrgs__view__td-bold',cellTemplate:'tmpl!SBIS3.EDO.StatisticsOurOrganizations/resources/ItemTemplate',headTemplate:'tmpl!SBIS3.EDO.StatisticsOurOrganizations/resources/ColumnHeaderTemplate',className:'controls-DataGridView__td__textAlignRight edo-StatisticsOurOrgs__view__td-red edo-StatisticsOurOrgs__view__td-left-border',width:83},{field:'Черновики',title:rk('Черновики'),cellTemplate:'tmpl!SBIS3.EDO.StatisticsOurOrganizations/resources/ItemTemplate',className:'edo-StatisticsOurOrgs__view__td-left-border edo-StatisticsOurOrgs__view__td-gray controls-DataGridView__td__textAlignRight',width:76}],incomingColumnsName:['Название','Всего','Обработка_внутри_компании','Утверждено','Отклонено','Черновики','Аннулировано'],outgoingColumnsName:['Название','Всего','Обработка_внутри_компании','Отправлено','Не_доставлено','Доставлено','Не_получен_ответ','Принято','Отклонено','Аннулировано','С_ошибками','Черновики'],additionalSettingsOutgoing:{'Обработка_внутри_компании':{title:rk('Обработка'),headTooltip:rk('Обработка внутри компании'),headerAddClassName:'edo-StatisticsOurOrgs__view__td-black edo-StatisticsOurOrgs__view__td-bold',width:75},'Отклонено':{headTooltip:rk('Отклонено'),title:'',headerAddClassName:'icon-16 icon-Unsuccess icon-error',className:'edo-StatisticsOurOrgs__view__td-left-border controls-DataGridView__td__textAlignRight edo-StatisticsOurOrgs__view__td-gray',width:50},'Аннулировано':{headTooltip:rk('Аннулировано'),title:'',headerAddClassName:'icon-16 icon-Close icon-disabled',headTemplate:'tmpl!SBIS3.EDO.StatisticsOurOrganizations/resources/ColumnHeaderTemplate',width:50}}},_$stateDictionary:{'Название':'-1','Всего':'-1','В_обработке':'10','Обработка_внутри_компании':'10','Утверждено':'7','Принято':'7','Отклонено':'9','Не_получен_ответ':'4','Не_доставлено':'2,3','Аннулировано':'22','Удалено мной/контрагентом':'19,20','С_ошибками':'6','Черновики':'0,1'},_$configFilters:['ФильтрДатаПериод','ФильтрДатаС','ФильтрДатаП','ФильтрНезакрепленные','ФильтрЛицо1','ФильтрОтветственноеЛицо','ФильтрВладелец','ТипДокументаВД']},$constructor:function(){this.once('onReady',function(){this._setColumns(),this._declareCommand(),this._init(),this._setDataSource();}.bind(this));},_setColumns:function(){var t=this.getChildControlByName('browserView'),e=function(t,e,i){return t.filter(function(t){return r(e,function(e){return e===t.field;});}).map(function(t){if(i[t.field])return t=o(t,i[t.field]);else return t;});}(this._$columnsState.columnsStorage,this._options.incoming?this._$columnsState.incomingColumnsName:this._$columnsState.outgoingColumnsName,this._options.incoming?{}:this._$columnsState.additionalSettingsOutgoing);if(t){var i=function(t){var i=t?t.results:this.getItems().getMetaData().results,s=[],a,o;if(this._options.totalCount=t?t.total||0:this.getItems().getMetaData().total||0,i.each(function(t,e){if(0===e)s.push(t);}),s.length)this.setColumns(e.filter(function(t){return!r(s,function(e){return e===t.field;});}));else this.setColumns(e);};t.once('onItemsReady',function(){i.apply(this),t.subscribe('onDataLoad',function(t,e){i.apply(this,[e.getMetaData()]);});});}},_declareCommand:function(){l.declareCommand(this,'getFilterState',function(t){return this._$stateDictionary[t]||'none';}.bind(this));},_init:function(){this.getChildControlByName('panelControlButton').setLinkedPanel(this.getChildControlByName('browserOperationsPanel'));var t=this.getChildControlByName('browserFastDataFilter');if(t)t.setItems(this._options.fastDataFilterConfig.data);},_setDataSource:function(){var t=this.getChildControlByName('browserView');if(t)t.setDataSource(new a({endpoint:{contract:this._options.linkedObject},model:'StatisticsOurOrganizations.Model',binding:{destroy:'Удалить',read:'Прочитать',update:'Записать',create:'Создать',query:this._options.queryName}}));},_modifyOptions:function(){var t=d.superclass._modifyOptions.apply(this,arguments),a=new e(new s()),r='Elektronnyj_dokumentooborot/Statistika/Pechatnye_formy/ReportByOurOrganizations',o=function(t){if(t.statFilterStructure){var e={},i=0;for(i=0;i<t.statFilterStructure.length;i++)e[t.statFilterStructure[i]['filterField']]=t.statFilterStructure[i];for(i=0;i<t.filterButtonConfig.length;i++)if(t.filterButtonConfig[i]['filterField']in e)t.filterButtonConfig[i]=e[t.filterButtonConfig[i]['filterField']];for(i=0;i<t.fastDataFilterConfig.length;i++)if(t.fastDataFilterConfig[i]['filterField']in e)t.fastDataFilterConfig[i]=e[t.fastDataFilterConfig[i]['filterField']];}},l=function(t,e){var i=[];for(var s in t)if(t.hasOwnProperty(s)&&e.hasOwnProperty(t[s]))i.push(e[t[s]]);return i;};if(t.queryName='СтатистикаСобытийПоНО',t.incoming)t.linkedObject='РеестрВходящих',t.reportName=r+'Incoming.xsl';else t.linkedObject='РеестрИсходящих',t.reportName=r+'Outgoing.xsl';return t.fastDataFilterConfig=a.getFastDataFilterConfig(t.filters),t.filterButtonConfig=l(this._$configFilters,i(t.filters)),o(t),t;},onClick:function(t,e){if($(e.target.parentElement).hasClass('controls-DataGridView__results')){var i=this.getColumns()[e.target.cellIndex]['field'],s=this.sendCommand('getFilterState',i);if('none'!==s&&'Название'!==i)this.sendCommand('statsChangeArea',{source:'organizations',destination:'listTab',extraFilters:{'ФильтрСостояние':['',s]}});}},onItemClick:function(t,e,i,s,a,r){var o=this.getColumns()[r.cellIndex]['field'],l=this.sendCommand('getFilterState',o);if(i.get('Раздел@'))if($(s).hasClass('controls-TreeView__expand'))return;else t.setResult(false);if(null===i.get('@Лицо')||'-1'===i.get('@Лицо')||!i.getColumnValue(o)||'none'===l)return;this.sendCommand('statsChangeArea',{source:'organizations',destination:'listTab',extraFilters:{'ФильтрСостояние':['',l],'ФильтрДокументНашаОрганизация':[i.get('Название'),[i.get('@Лицо')]]}});}});return d;});
define("tmpl!SBIS3.EDO.StatTemplateExternal",["Core/tmpl/js/tclosure","js!Deprecated/Controls/TemplatedArea/TemplatedArea"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!Deprecated/Controls/TemplatedArea/TemplatedArea"]=e[1];var a=function e(a,n,o,l,i){function s(){}var p=0,m=void 0!==t&&t?t:arguments[arguments.length-1];void 0===m&&(eval("var thelpers = null;"),m=global.requirejs("View/Runner/tclosure"));var c={};i&&i.isSetts&&(c=i.fullContext||{});var d="string"==typeof o?o:"",u=void 0===r?void 0:r,g={id:[],def:void 0},T=m.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,a),v=this&&this.includedTemplates?this.includedTemplates:{},y=m.getMarkupGenerator(l);try{var f=y.joinElements([y.createTag("div",{style:"height: 100%; position1:relative;",class:""+m.wrapUndef(m.utils.escape(m.getter(a,["className"])))},[y.createControl("wsControl","ws:Deprecated/Controls/TemplatedArea/TemplatedArea",{style:"height:100%;",className:"tarea100",template:m.getter(a,["statTemplate"]),name:m.getter(a,["StatTemplateName"]),componentOptions:{numColumnHeaderTitle:m.getter(a,["numColumnHeaderTitle"]),statType:m.getter(a,["statType"]),docType:m.getter(a,["docType"]),statesDict:"Outgoing"===m.getter(a,["statType"])?m.getter(a,["statesDictOutgoing"]):m.getter(a,["statesDictIncoming"]),needStatPrintBtn:m.getter(a,["needStatPrintBtn"])}},{name:m.getter(a,["StatTemplateName"]),sbisname:m.getter(a,["StatTemplateName"])},{data:a,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:T},o,u,v,m.config,c)],n,g,this)],d,g);g.def&&(f=y.chain(f,g,n),g=void 0)}catch(e){m.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/Documents/StatTemplateExternal/StatTemplateExternal.tmpl",e,a)}return f||""};return a.includedFunctions={},a.stable=!0,a.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.StatTemplateExternal"}},a});
define('js!SBIS3.EDO.StatTemplateExternal',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.StatTemplateExternal','Core/CommandDispatcher','js!SBIS3.EDO.ExternalStatisticsHandlers','Deprecated/Controls/TemplatedArea/TemplatedArea','Elektronnyj_dokumentooborot_localization'],function(t,e,s,a){'use strict';var l=t.extend({_dotTplFn:e,$protected:{_options:{statesDictOutgoing:{'Всего':{class:'all_docs',label:rk('Всего по нашим организациям'),style:''},'НеОтправлено':{class:'no_send_docs',label:rk('Обработка внутри компании'),style:''},'Отправлено':{class:'send_docs',label:rk('Отправлено'),style:''},'НеДоставлено':{class:'no_deliv_docs',label:rk('Не доставлено'),style:'padding-left:50px !important;'},'Доставлено':{class:'deliv_docs',label:rk('Доставлено, из них'),style:'padding-left:50px !important;'},'На проверке':{class:'on_checking_docs',label:rk('Не получен ответ'),style:''},'Принято':{class:'recv_docs',label:rk('Завершено'),style:''},'Отклонено':{class:'decl_docs',label:rk('Отклонено'),style:''},'УдаленоКонтрагентом':{class:'kon_del_docs',label:rk('Удалено мной/контрагентом'),style:''},'Аннулировано':{class:'ann_docs',label:rk('Аннулировано'),style:''},'СОшибками':{class:'error_docs',label:rk('С ошибками'),style:''},'Черновики':{class:'rough_docs',label:rk('Черновики'),style:''}},statesDictIncoming:{'Всего':{class:'all_docs',label:rk('Всего по нашим организациям'),style:''},'ВОбработке':{class:'proc_docs',label:rk('В обработке'),style:''},'Принято':{class:'recv_docs_in',label:rk('Завершено'),style:''},'Отклонено':{class:'decl_docs_in',label:rk('Отклонено'),style:''},'Черновики':{class:'rough_docs',label:rk('Черновики'),style:''},'Аннулировано':{class:'ann_docs_in',label:rk('Аннулировано'),style:''},'УдаленоКонтр':{class:'kon_del_docs_in',label:rk('Удалено мной/контрагентом'),style:''}}}},$constructor:function(){s.declareCommand(this,'statsChangeArea',this._statsChangeArea.bind(this)),s.declareCommand(this,'statsBackToStart',this._statsBackToStart.bind(this));},_statsBackToStart:function(t){var e=this.getChildControlByName(t);this.getChildControlByName(this._options.StatTemplateName).setTemplate(this._options.statTemplate,{filters:e.getFilter(),statFilterStructure:e._getFilterButton().getFilterStructure()});},_statsChangeArea:function(t){if(a.removeStatPrintButton(),t['source']=t['source']||'stats',t['statType']=this._options.statType,'listTab'===t['destination']){if('contragents'===t['source']){if(!t['extraFilters'])t['extraFilters']={};t['extraFilters']['ФильтрЛицо1']=[t['record'].get('Контрагент'),t['record'].get('@Лицо')];}return false;}else if('contragents'===t['destination']){var e=this,s=t['state'],l=e.getChildControlByName('StatBrowser'),r=l.getFilter(),o=l._getFilterButton().getFilterStructure();if(r['ФильтрСостояние']=s,e._options.filterDocTypes)r['ФильтрТипыДокументов']=e._options.filterDocTypes;return e.getChildControlByName(e._options.StatTemplateName).setTemplate(e._options.contragentsTemplate,{filters:r,statFilterStructure:o,contragentsTemplate:e._options.contragentsTemplate}),true;}else if('organizations'===t['destination'])return this.getChildControlByName(this._options.StatTemplateName).setTemplate(this._options.ourorgTemplate,{incoming:!!('Incoming'===this._options.statType),filters:this.getChildControlByName('StatBrowser').getFilter(),statFilterStructure:this.getChildControlByName('StatBrowser')._getFilterButton().getFilterStructure()}),true;return false;},_modifyOptions:function(){var t=l.superclass._modifyOptions.apply(this,arguments);return t.numColumnHeaderTitle='Incoming'===t.statType?rk('Поставщики'):rk('Покупатели'),t.contragentsTemplate='js!SBIS3.EDO.Statistics'+t.statType+'EventsContragentsNew',t.ourorgTemplate='js!SBIS3.EDO.StatisticsOurOrganizations',t.statesDictOutgoing['Принято']={class:'recv_docs',label:rk('Outgoing'!==t.statType?'Утверждено':'Завершено'),style:''},t.statesDictIncoming['Принято']={class:'recv_docs_in',label:rk('Incoming'!==t.statType?'Утверждено':'Завершено'),style:''},t;}});return l.dimensions={autoWidth:false,autoHeight:false,resizable:false},l;});
define("tmpl!SBIS3.EDO.FilterTasksFromMe/FtplFilterListDispatchFromMe",["Core/tmpl/js/tclosure"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={},i=function e(i,l,a,n,o){function s(){}var c=0,p=void 0!==t&&t?t:arguments[arguments.length-1];void 0===p&&(eval("var thelpers = null;"),p=global.requirejs("View/Runner/tclosure"));var u={};o&&o.isSetts&&(u=o.fullContext||{});var d="string"==typeof a?a:"",v=void 0===r?void 0:r,m={id:[],def:void 0},F=p.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,i),f=this&&this.includedTemplates?this.includedTemplates:{},g=p.getMarkupGenerator(n);try{var h=g.joinElements([p.getter(i,["caption"])?[p.getter(i,["value"])>=0||p.getter(i,["value","length"])>1?[g.createTag("div",{style:"display:inline;"},[g.createText(" "+p.wrapUndef(p.utils.escape(global.rk.apply(i,["Получатель"])+": "+p.getter(i,["caption"]))))],{},m,this)]:p.getter(i,["value"])<0?[g.createTag("div",{style:"display:inline;"},[g.createText(""+p.wrapUndef(p.utils.escape(p.getter(i,["caption"]))))],{},m,this)]:g.createText("")]:g.createText("")],d,m);m.def&&(h=g.chain(h,m,l),m=void 0)}catch(e){p.templateError("resources/Elektronnyj_dokumentooborot/Filtry/FilterTasksFromMe/FtplFilterListDispatchFromMe.tmpl",e,i)}return h||""};return i.includedFunctions={},i.stable=!0,i.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FilterTasksFromMe/FtplFilterListDispatchFromMe"}},i});
define('js!SBIS3.EDO.Modificators.FromMe.List',['js!SBIS3.EDO.Modificators.DefaultModificator','tmpl!SBIS3.EDO.FilterTasksFromMe/FtplFilterListDispatchFromMe','Elektronnyj_dokumentooborot_localization'],function(t){'use strict';function e(){t.apply(this,arguments),this._allowedItems=['edoMoveDocument','edoAddSubtask','edoDeleteUserFolder'],this._allowedMOPItems=['edoSetControlDocumentMass'];}return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.prototype.modifyFilterConfigs=function(t){return t[12]['historyItemTemplate']='tmpl!SBIS3.EDO.FilterTasksFromMe/FtplFilterListDispatchFromMe',delete t[12].itemTemplate,t;},e.prototype.getFilterButtonConfig=function(){return{template:'SBIS3.EDO.FilterTasksFromMe',additionalFilterParamsTemplate:'SBIS3.EDO.FilterTasksFromMeSelector',filterStructure:this._getFilterStructure(['ФильтрДатаПериод','ФильтрДатаС','ФильтрДатаП','ФильтрПоКраткомуСостоянию','ФильтрПросроченные','ИдРегламента','ФильтрИдФазы','ФильтрСрокДата','ФильтрСписокРассылки','ФильтрПоВехе','ФильтрЛицо1','Проект','ФильтрПометкиВкл','ФильтрПометкиИскл','ФильтрЗонаОтветственности','ПапкаДокументов','ПростыеВД','РассчитатьФото','ПоказИерархии','ВключитьСписокИсполнителей','ВнешняяИерархия','ОтМеня','ПапкаСкрытьНепрочитанные'])};},e.prototype.getFastDataFilterConfig=function(){return{className:'edo-tasks__fastDataFilter',idProperty:'name',filterStructure:this._getFastDataFilterStructure(['ФильтрПоКраткомуСостоянию']),data:[{keyField:'key',displayField:'title',name:'FilterShortState',multiselect:false,className:'controls-DropdownList__withoutCross controls-DropdownList__linkStyle',itemContentTpl:'tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterStateListItem',showSelectedInList:true,values:[{key:'8',title:rk('В обработке')},{key:'-1',title:rk('В любом состоянии')},{key:'1',title:rk('Завершенные')},{key:'2',title:rk('Завершенные положительно'),listTitle:rk('положительно')},{key:'3',title:rk('Завершенные отрицательно'),listTitle:rk('отрицательно')},{key:'-2',title:rk('Удаленные')}]}]};},e;});
define('js!SBIS3.EDO.Modificators.FromMe.ReturnGroup',['js!SBIS3.EDO.Modificators.DefaultModificator','Elektronnyj_dokumentooborot_localization'],function(t){'use strict';function e(){t.apply(this,arguments),this._allowedItems=[],this._allowedMOPItems=['edoSetControlDocumentMass'];}return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.prototype.getFilterButtonConfig=function(){return{template:'SBIS3.EDO.FilterTasksReturn',additionalFilterParamsTemplate:'SBIS3.EDO.FilterTasksReturnSelector',filterStructure:this._getFilterStructure(['ФильтрДатаПериод','ФильтрДатаС','ФильтрДатаП','ФильтрПросроченные','ИдРегламента','ФильтрИдФазы','ФильтрСрокДата','ФильтрСписокРассылки','ФильтрПоВехе','ФильтрПометкиВкл','ФильтрПометкиИскл','ФильтрЛицо1','ФильтрОтправитель','ФильтрНепрочитанные'])};},e;});
define('js!SBIS3.EDO.Modificators.MyTasks.DoneGroup',['js!SBIS3.EDO.Modificators.DefaultModificator','Elektronnyj_dokumentooborot_localization'],function(t){'use strict';function e(){t.apply(this,arguments),this._allowedItems=[],this._allowedMOPItems=['edoSetControlDocumentMass'];}return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.prototype.modifyFilterConfigs=function(t){if(t[0]['resetValue']='Месяц','Все'===t[0]['value'])t[0]['value']='Месяц';return t[0]['itemTemplate']='tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterDatePeriod',t[4]['internalVisibilityField']='FilterLimitationOverdueVisibility',t[4]['resetVisibilityValue']=false,t;},e.prototype.getFilterButtonConfig=function(){return{template:'SBIS3.EDO.FilterTasksExecute',additionalFilterParamsTemplate:'SBIS3.EDO.FilterTasksExecuteSelector',resetLinkText:rk('За последний месяц'),filterStructure:this._getFilterStructure(['ФильтрДатаПериод','ФильтрДатаС','ФильтрДатаП','ФильтрПросроченные','ИдРегламента','ФильтрИдФазы','ФильтрСрокДата','ФильтрПометкиВкл','ФильтрПометкиИскл','ФильтрЛицо1','ФильтрОтправитель','ФильтрПоВехе','ФильтрПолучатель'])};},e;});
define('js!SBIS3.EDO.Modificators.OnCtrl.List',['js!SBIS3.EDO.Modificators.DefaultModificator','Elektronnyj_dokumentooborot_localization'],function(t){'use strict';function o(){t.apply(this,arguments),this._allowedItems=['edoMoveDocument','edoUncheckFromMonitoring','edoDeleteUserFolder'],this._allowedMOPItems=['edoSetControlDocumentMass'];}return o.prototype=Object.create(t.prototype),o.prototype.constructor=o,o.prototype.modifyMOPActions=function(t){t=this._clone(t);var o=this._findActionWithIndex(t,'edoSetControlDocumentMass');if(!t[o.index]['options'])t[o.index]['options']={};return t[o.index]['options']['set']=false,t[o.index]['options']['icon']='sprite:icon-24 icon-Hide icon-primary',t[o.index]['options']['tooltip']=rk('Снять с контроля'),t[o.index]['options']['caption']=rk('Снять с контроля'),t;},o.prototype.getFilterButtonConfig=function(){return{template:'SBIS3.EDO.FilterTasksControlled',additionalFilterParamsTemplate:'SBIS3.EDO.FilterTasksControlledSelector',filterStructure:this._getFilterStructure(['ФильтрДатаПериод','ФильтрДатаС','ФильтрДатаП','ФильтрСостояние','ФильтрПросроченные','ИдРегламента','ФильтрЛицо1','ФильтрИдФазы','ФильтрСрокДата','ФильтрЛицо1','ФильтрСписокРассылки','ФильтрАвторИлиОтветственный','ФильтрПоВехе','Проект','ФильтрПометкиВкл','ФильтрПометкиИскл','ФильтрЗонаОтветственности','ПапкаДокументов','ПростыеВД','НаКонтроле','РассчитатьФото','ПоказИерархии','ВключитьСписокИсполнителей','ПапкаСкрытьНепрочитанные','ВнешняяИерархия'])};},o;});
define('js!SBIS3.EDO.Modificators.TaskHier',['js!SBIS3.EDO.Modificators.DefaultModificator','Elektronnyj_dokumentooborot_localization'],function(e){'use strict';function t(t,o){e.apply(this,arguments),this._deleteUserFolderHandler=t,this._arrowClick=o,this._allowedItems=['edoMoveDocument','edoRenameFolder','edoRemoveTransferredTasks','edoCreateFolder','edoDeleteUserFolder'],this._allowedMOPItems=[];}return t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.prototype.modifyItemsActions=function(e){var t;if(e=this._clone(e),this._arrowClick)e[(t=this._findActionWithIndex(e,'edoRenameFolder')).index]['onActivated']=this._arrowClick;return t=this._findActionWithIndex(e,'edoDeleteUserFolder'),e[t.index]['onActivated']=this._deleteUserFolderHandler,t=this._findActionWithIndex(e,'edoRemoveTransferredTasks'),e[t.index]['isMainAction']=false,e;},t;});
define('js!SBIS3.EDO.FTasksHandlers',['i18n!SBIS3.EDO.FTasksHandlers','Elektronnyj_dokumentooborot_localization'],function(){'use strict';var e;return e={setPrintColumns:function(e){e.setResult([{field:'Дата',title:rk('Дата')},{field:'Номер',title:rk('Номер')},{field:'РазличныеДокументы.Информация',title:rk('Описание')},{field:'Сотрудник.Название',title:rk('Ответственный')}]);},setPrintColumnsForServerPrint:function(e){e.setResult([{field:'ПечатьНомер',title:rk('Номер')},{field:'ПечатьРегламент',title:rk('Регламент')},{field:'ПечатьОписание',title:rk('Описание')},{field:'ПечатьНачало',title:rk('Началось')},{field:'ПечатьЗавершение',title:rk('Завершено')},{field:'ПечатьСостояние',title:rk('Состояние')},{field:'ПечатьЭтап',title:rk('Этап')},{field:'ПечатьИсполнитель',title:rk('Исполнитель')},{field:'ПечатьОтветственный',title:rk('Ответственный')}]);},isVisibleEdoRestoreDocumentMass:function(e){return-2===+e['ФильтрПоКраткомуСостоянию'];}};});
define('js!SBIS3.EDO.Modificators.Tasks.List',['js!SBIS3.EDO.Modificators.DefaultModificator','js!SBIS3.EDO.FTasksHandlers','Elektronnyj_dokumentooborot_localization'],function(t,e){'use strict';function i(){t.apply(this,arguments),this._allowedItems=['edoAddSubtask'],this._allowedMOPItems=['edoSetControlDocumentMass','edoUnloadDocumentMass'];}return i.prototype=Object.create(t.prototype),i.prototype.constructor=i,i.prototype.modifyMOPActions=function(t){t=this._clone(t);var i=this._findActionWithIndex(t,'edoUnloadDocumentMass');if(!t[i.index]['options'])t[i.index]['options']={};return t[i.index]['options'].handlers.onApplyOperation=[e.setPrintColumnsForServerPrint],t[i.index]['options'].exportDocuments=true,t[i.index]['options'].fileName='Задачи по сотрудникам',t[i.index]['options'].items=[{id:'PDF',title:rk('Список в PDF'),pageOrientation:0,xsl:void 0,serverSideExport:true,binding:{saveList:'СлужЗап.СервернаяПечать',saveDataSet:'СлужЗап.СервернаяПечать'}},{id:'Excel',title:rk('Список в Excel'),xsl:void 0,serverSideExport:true,binding:{saveList:'СлужЗап.СервернаяПечать',saveDataSet:'СлужЗап.СервернаяПечать'}}],t;},i.prototype.modifyFilterConfigs=function(t){if(t[3].resetValue='-1',!t[3].value||'8'===t[3].value)t[3].value='-1';if(t[6].internalValueField='FilterIdRegulation',t[6].resetValue=null,Array.isArray(t[6].value))t[6].value=null;return t;},i.prototype.getFilterButtonConfig=function(){return{template:'SBIS3.EDO.FilterTasks',additionalFilterParamsTemplate:'SBIS3.EDO.FilterTasksSelector',filterStructure:this._getFilterStructure(['ФильтрДатаПериод','ФильтрДатаС','ФильтрДатаП','ФильтрПоКраткомуСостоянию','ФильтрПросроченные','ИдРегламента','ФильтрИдФазы','ФильтрСрокДата','ФильтрЛицо1','ФильтрАвторИлиОтветственный','ФильтрСписокРассылки','ФильтрКонкретныйИсполнитель','ФильтрПоВехе','ФильтрПометкиВкл','ФильтрПометкиИскл','ФильтрЗонаОтветственности','ПростыеВД','РассчитатьФото','ВключитьСписокИсполнителей'])};},i.prototype.modifyFastDataFilterConfigs=function(t){if(t[0].resetValue='-1',!t[0].value||'8'===t[0].value)t[0].value='-1';return t;},i.prototype.getFastDataFilterConfig=function(){return{className:'edo-tasks__fastDataFilter',idProperty:'name',filterStructure:this._getFastDataFilterStructure(['ФильтрПоКраткомуСостоянию']),data:[{keyField:'key',displayField:'title',name:'FilterShortState',multiselect:false,className:'controls-DropdownList__withoutCross controls-DropdownList__linkStyle',itemContentTpl:'tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterStateListItem',showSelectedInList:true,values:[{key:'-1',title:rk('В любом состоянии')},{key:'4',title:rk('В обработке')},{key:'1',title:rk('Завершенные')},{key:'2',title:rk('Завершенные положительно'),listTitle:rk('положительно')},{key:'3',title:rk('Завершенные отрицательно'),listTitle:rk('отрицательно')},{key:'-2',title:rk('Удаленные')}]}]};},i;});
define('js!SBIS3.EDO.Modificators.Unallocated.List',['js!SBIS3.EDO.Modificators.DefaultModificator','Elektronnyj_dokumentooborot_localization'],function(t){'use strict';function e(){t.apply(this,arguments),this._allowedItems=[],this._allowedMOPItems=['edoSetControlDocumentMass'];}return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.prototype.modifyFilterConfigs=function(t){if(t[7].internalValueField='FilterIdPhaseMul',t[7].resetValue=[],!Array.isArray(t[7].value))t[7].value=[];return t;},e.prototype.getFilterButtonConfig=function(){return{template:'SBIS3.EDO.FilterTasksUnallocated',additionalFilterParamsTemplate:'SBIS3.EDO.FilterTasksUnallocatedSelector',filterStructure:this._getFilterStructure(['ФильтрДатаПериод','ФильтрДатаС','ФильтрДатаП','ФильтрПросроченные','ИдРегламента','ФильтрЛицо1','ФильтрИдФазы','ФильтрСрокДата','ФильтрАвторИлиОтветственный','ФильтрПоВехе','ФильтрОтправитель','ФильтрПометкиВкл','ФильтрПометкиИскл','ФильтрЗонаОтветственности','ПапкаДокументов','ПростыеВД','РассчитатьФото','ПоказИерархии','ВнешняяИерархия'])};},e;});
define("tmpl!SBIS3.EDO.FTaskHier",["Core/tmpl/js/tclosure","js!SBIS3.CONTROLS/Tree/DataGridView"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.CONTROLS/Tree/DataGridView"]=e[1];var i=function e(i,a,o,s,n){function l(){}var d=0,c=void 0!==t&&t?t:arguments[arguments.length-1];void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure"));var p={};n&&n.isSetts&&(p=n.fullContext||{});var m="string"==typeof o?o:"",g=void 0===r?void 0:r,u={id:[],def:void 0},y=c.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,i),v=this&&this.includedTemplates?this.includedTemplates:{},T=c.getMarkupGenerator(s);try{var S=T.joinElements([T.createTag("div",{class:"edo-TaskHier"},[T.createControl("wsControl","ws:SBIS3.CONTROLS/Tree/DataGridView",{columns:[{cellTemplate:"tmpl!SBIS3.EDO.FTaskHier/resources/FTaskHierCol",className:"controls-DataGridView-cell-overflow-ellipsis",fixedSize:!0,width:"190"}],handlers:{onChangeHoveredItem:c.getTypeFunc(""+c.wrapUndef(c.utils.escape(c.getter(i,["onChangeHoveredItemTaskHier"])||"js!SBIS3.EDO.EdoRecOptions:onChangeHoveredItemTaskHier")),{}),onItemClick:c.getTypeFunc(""+c.wrapUndef(c.utils.escape(c.getter(i,["onItemClickHandler"]))),{}),onItemsReady:c.getTypeFunc(""+c.wrapUndef(c.utils.escape(c.getter(i,["onItemsReady"]))),{})},name:"taskHierBrowser",className:"controls-ListView__padding-XS",itemsDragNDrop:c.getter(i,["itemsDragNDrop"]),allowEnterToFolder:!1,showHead:!1,expand:!1,displayType:"folders",showPaging:!1,pageSize:"999",allowEmptySelection:!0,partialyReload:!0,scrollPaging:!1,idProperty:"@СвязьПапок",parentProperty:"ПапкаДокументов",expanderDisplayMode:"withChild",displayProperty:"Название",items:c.getter(i,["foldersListData"])?c.getter(i,["foldersListData","items"]):void 0,itemsActions:c.getter(i,["itemsActions"]),selectedKey:c.getter(i,["selectedKey"]),esc:!1},{name:"taskHierBrowser",sbisname:"taskHierBrowser"},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y,internal:{__dirtyCheckingVars_1:c.getter(i,["onChangeHoveredItemTaskHier"])||"js!SBIS3.EDO.EdoRecOptions:onChangeHoveredItemTaskHier",__dirtyCheckingVars_2:c.getter(i,["onItemClickHandler"]),__dirtyCheckingVars_3:c.getter(i,["onItemsReady"])}},o,g,v,c.config,p)],a,u,this)],m,u);u.def&&(S=T.chain(S,u,a),u=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/FTaskHier/FTaskHier.tmpl",e,i)}return S||""};return i.includedFunctions={},i.stable=!0,i.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FTaskHier"}},i});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.FTaskHier", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-TaskHier .ca_counters{position:absolute;right:0;padding-right:6px;font-size:14px;z-index:10;background-size:cover;height:30px;padding-left:30px}.TaskHier-delegate-icon{position:relative;top:1px}.edo-TaskHier .ca_counters{background:-moz-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,1) 28%);background:-webkit-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,1) 28%);background:linear-gradient(to right,rgba(255,255,255,0) 0,rgba(255,255,255,1) 28%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#00ffffff', endColorstr='#ffffff', GradientType=1)}.edo-TaskHier .controls-ListView__hoveredItem .ca_counters{background:-moz-linear-gradient(left,rgba(240,245,251,0) 0,rgba(240,245,251,1) 28%);background:-webkit-linear-gradient(left,rgba(240,245,251,0) 0,rgba(240,245,251,1) 28%);background:linear-gradient(to right,rgba(240,245,251,0) 0,rgba(240,245,251,1) 28%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#00f0f5fb', endColorstr='#f0f5fb', GradientType=1)}.edo-TaskHier .controls-DataGridView__td.controls-DataGridView-cell-overflow-ellipsis .controls-TreeView__folderTitle{text-overflow:clip;width:80%}.edo-TaskHier .controls-TreeView__hideExpands .controls-TreeView__folderTitle{margin-left:12px}.edo-TaskHier .ca_delim{color:#f4f4f4;margin:0 3px}.edo-TaskHier .ca_count_new{color:#ff7033}.edo-TaskHier .ca_count{color:#587ab0}.edo-TaskHier .controls-DataGridView .controls-DataGridView__table .controls-DataGridView__td{border-right:1px solid #f4f4f4}.edo-TaskHier .controls-DataGridView .controls-DataGridView__table .controls-ListView__item__selected .controls-DataGridView__td{border-bottom:1px solid #f4f4f4;border-top:1px solid #f4f4f4;border-right:1px solid #fff}.edo-BrowserWrapper__leftcol.serverSideRendering.tmpl:before{content:'';display:inline-block;position:absolute;width:1px;background:#f4f4f4;height:100%;right:0;z-index:0}.edo-TaskHier .controls-DataGridView .controls-DataGridView__table .controls-ListView__item__selected:hover .controls-DataGridView__td{border-right:1px solid #fff}.tasksSale-browser .controls-Browser>.controls-Browser__view>.controls-ListView{min-height:825px}.tasksSale-browser .controls-DataGridView .controls-DataGridView__table .controls-DataGridView__th{padding-bottom:4px}.tasksSale-browser .controls-Browser__table.controls-Browser__table-fullFilterBlock .controls-Browser__tableCell-filterButton,.tasksSale-browser .controls-Browser__table.controls-Browser__table-fullFilterBlock .controls-Browser__tableCell-search{border-bottom:none}.FromMe .controls-DataGridView .controls-DataGridView__table .controls-DataGridView__th .controls-Link,.OnCtrl .controls-DataGridView .controls-DataGridView__table .controls-DataGridView__th .controls-Link{line-height:inherit}.edo-TaskHier{margin-top:24px}.edo-TaskHier .controls-TreeView__folderTitle .icon-Enter{vertical-align:text-bottom}.BrowserWrapper-rightcol .controls-AjaxLoader{top:2px;min-height:34px}.TaskGroupItem_new{color:#ff7033}.TaskGroupItem_all{color:#587ab0;padding-right:2px}.edo-TaskHier tr[data-id='-1,ПапкаДокументов'] .lvl1{width:0;margin-left:5px}.edo-TaskHier tr td .lvl1{margin-left:12px}.edo-FMyTaskTapeTab__floatArea .edo-TaskHier .controls-DataGridView__table,.edo-FMyTaskTapeTab__floatArea .edo-TaskHier .controls-DataGridView__tbody,.edo-FMyTaskTapeTab__floatArea .edo-TaskHier .controls-DataGridView__td,.edo-FMyTaskTapeTab__floatArea .edo-TaskHier .controls-DataGridView__tr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-moz-flex-direction:column;-ms-flex-direction:column;flex-direction:column}"));head.appendChild(style);});}
define("tmpl!SBIS3.EDO.FTaskHier/resources/FTaskHierCol",["Core/tmpl/js/tclosure"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={},a=function e(a,i,s,l,c){function o(){}var n=0,p=void 0!==t&&t?t:arguments[arguments.length-1];void 0===p&&(eval("var thelpers = null;"),p=global.requirejs("View/Runner/tclosure"));var g={};c&&c.isSetts&&(g=c.fullContext||{});var u="string"==typeof s?s:"",m=void 0===r?void 0:r,d={id:[],def:void 0},T=p.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,a),f=this&&this.includedTemplates?this.includedTemplates:{},h=p.getMarkupGenerator(l);try{var k=h.joinElements([h.createTag("div",{},[h.createTag("span",{class:""+p.wrapUndef(p.utils.escape("TaskHierCol_title "+p.getter(a,["item","taskHier","rootClass"]))),title:""+p.wrapUndef(p.utils.escape(p.getter(a,["item","folderTitle"])))},[h.createText(""+p.wrapUndef(p.utils.escape(p.getter(a,["item","folderTitle"]))))],{},d,this),p.getter(a,["item","Условие"])?[h.createTag("span",{class:"icon-16 icon-Enter icon-primary",title:""+global.rk("Папка с автораспределением задач")},[],{},d,this)]:h.createText(""),p.getter(a,["item","Переназначение"])?[h.createTag("span",{class:"icon-16 icon-Publish2 icon-primary TaskHier-delegate-icon",title:""+global.rk("Вы можете закрывать задачи за сотрудника")},[],{},d,this)]:h.createText(""),h.createTag("span",{class:"ca_counters"},[p.getter(a,["item","СчетчикЗадач"])?[""+p.getter(a,["item","СчетчикЗадач","get"]).apply(p.getter(a,["item","СчетчикЗадач"]),["Новых"])!="0"?[h.createTag("span",{class:"TaskGroupItem_new"},[h.createText(""+p.wrapUndef(p.utils.escape(p.getter(a,["item","СчетчикЗадач","get"]).apply(p.getter(a,["item","СчетчикЗадач"]),["Новых"])>999?"999+":p.getter(a,["item","СчетчикЗадач","get"]).apply(p.getter(a,["item","СчетчикЗадач"]),["Новых"]))))],{},d,this),h.createTag("span",{class:"ca_delim"},[h.createText(""+global.rk("|"))],{},d,this)]:h.createText(""),""+p.getter(a,["item","СчетчикЗадач","get"]).apply(p.getter(a,["item","СчетчикЗадач"]),["Всего"])!="0"?[h.createTag("span",{class:"TaskGroupItem_all"},[h.createText(""+p.wrapUndef(p.utils.escape(p.getter(a,["item","СчетчикЗадач","get"]).apply(p.getter(a,["item","СчетчикЗадач"]),["Всего"])>999?"999+":p.getter(a,["item","СчетчикЗадач","get"]).apply(p.getter(a,["item","СчетчикЗадач"]),["Всего"]))))],{},d,this)]:h.createText("")]:h.createText("")],{},d,this)],i,d,this)],u,d);d.def&&(k=h.chain(k,d,i),d=void 0)}catch(e){p.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/FTaskHier/resources/FTaskHierCol.tmpl",e,a)}return k||""};return a.includedFunctions={},a.stable=!0,a.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FTaskHier/resources/FTaskHierCol"}},a});
define('js!SBIS3.EDO.FTaskHier',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FTaskHier','WS.Data/Source/SbisService','Core/Context','Core/EventBus','js!SBIS3.EDO.TaskRegistryModel','js!SBIS3.EDO.Modificators','js!SBIS3.EDO.Modificators.TaskHier','SBIS3.CONTROLS/Action/List/InteractiveMove','js!SBIS3.EDO.EdoRecOptions','SBIS3.CONTROLS/Tree/DataGridView','css!SBIS3.EDO.FTaskHier','tmpl!SBIS3.EDO.FTaskHier/resources/FTaskHierCol','js!SBIS3.EDO.FolderDialogAction','Elektronnyj_dokumentooborot_localization'],function(e,t,r,n,i,o,s,a,d){'use strict';var l=e.extend({_dotTplFn:t,$protected:{_options:{queryObject:'СвязьПапок',queryMethod:'ДокументыВПапке',linkedEdoBrowser:null,noLoadOnInit:true,linkedGroupTape:null,useLightCounters:false,itemsDragNDrop:'separateParent',processFixEvents:false}},subscribeNewFolders:function(e){e.subscribeTo(i.channel('edo.tasks.changeuserfolderslist'),'onMessage',function(t,r,n){e.reload();});},updateHandlerAfterHierMove:function(e){var t=this;e.subscribeTo(i.serverChannel('edo.tasks.changetaskparent'),'onMessage',function(r,n,i){var o=e.getItems(),s=e.getParentProperty(),a=o.getRecordById(n.get(s)+','+s),d=o.getRecordById(n.get('ПапкаДокументовИсточника')+','+s),l=o.getRecordById(e.getSelectedKey()),g=t.getRootRec(e,a),c=t.getRootRec(e,l);if(!e.getParentProperty)return;if(n.get(s)===n.get('ПапкаДокументовИсточника'))return;if(!d&&a)return d=o.getRecordById('-1,'+s),t.updateSingleRec(d,'dec','False'!==n.get('Прочитана')),void t.updateTreeBranch(e,g);if(d&&!a)return a=o.getRecordById('-1,'+s),t.updateSingleRec(a,'inc','False'!==n.get('Прочитана')),void t.updateTreeBranch(e,c);if(c&&g){if(t.updateTreeBranch(e,g),c.getId()!==g.getId())t.updateTreeBranch(e,c);return;}e.reload();});},setCursorOnFirstRow:function(e){if(e)e.setSelectedIndex(0);},setBrowMoveStrategy:function(e){require(['js!SBIS3.EDO.TasksMoveStrategy'],function(t){t.bindOnBeginMove(e,'СвязьПапок');});},getRootRec:function(e,t){var r=5,n=e.getParentProperty(),i=t;if(!t)return null;for(var o=0;o<r;o++)if(i.get(n))i=e.getDataSet().getRecordById(i.get(n));else break;return i;},updateRecCounters:function(e,t,r,n,i){for(var o=0,s=t.get('СчетчикЗадач'),a=s?parseInt(s.get('Всего'),10):0,d=s?parseInt(s.get('Новых'),10):0,l=e.getParentProperty?e.getParentProperty():null,g=null,c,u=0;r[u];u++)if(r[u].has('РП.Просмотрен')&&false===r[u].get('РП.Просмотрен'))o++;if('dec'===n){if(a-r.length>-1)s.set('Всего',a-r.length);if(g=this.getRootRec(e,t),g&&g.getId()!==t.getId())if(c=g.get('СчетчикЗадач'),+c.get('Всего')-r.length>-1)c.set('Всего',parseInt(c.get('Всего'),10)-r.length);}else s.set('Всего',a+r.length);if(o)if('dec'===n){if(d-o>-1)s.set('Новых',d-o);if(g=this.getRootRec(e,t),g&&g.getId()!==t.getId())if(c=g.get('СчетчикЗадач'),+c.get('Новых')-o>-1)c.set('Новых',+c.get('Новых')-o);}else s.set('Новых',d+o);},setDataSetChangeHandlerLite:function(e){this.updateHandlerAfterHierMove(e),e.subscribeTo(i.channel('edopartialreloader'),'onItemsCountChange',function(t,r){var n=e.getSelectedKey();if(n)e.reloadItem(n,void 0,'inside');});},setDataSetChangeHandler:function(e){var t=this;e.subscribeTo(i.channel('edopartialreloader'),'onItemsCountChange',function(r,n){var i=e.getSelectedKey(),o=e.getDataSet(),s=i?o.getRecordById(i):null,a=t.getParent().getChildControlByName('FTasksGroupByType'),d=a.getSelectedKey(),l=a.getDataSet(),g=l?l.getRecordById(d):null,c=null;if(!l)return;if(s){if(s.get('МояПапка')&&-1!==parseInt(i,10)){if(c=t.getRootRec(e,s),c)if(-1===parseInt(c.getId(),10))t.updateRecCounters(e,s,n.changed_recs,n.type,false);else t.updateTreeBranch(e,c);}else t.updateRecCounters(e,s,n.changed_recs,n.type,false);setTimeout(function(){a.reload();},1000);}else if(g){if('dec'===n.type){if(+g.get('КолВсего')-n.changed_recs.length>-1)g.set('КолВсего',+g.get('КолВсего')-n.changed_recs.length);}else g.set('КолВсего',+g.get('КолВсего')+n.changed_recs.length);if(n.brw_id===e.getId())e.reload();}});},updateHandlerAfterFix:function(e){var t=this;e.subscribeTo(i.channel('edopartialreloader'),'onItemsRead',function(r,i){var o=e.getDataSet(),s,a,d,l,g;if(i.dirs.length){if(l=n.global.getValue('ПапкиТекущегоПользователя'),!l)return;d=l.get('МоиЗадачи');for(var c in i.dirs){if(!i.dirs.hasOwnProperty(c)||!e.getParentProperty)continue;if(s=o.getRecordById(i.dirs[c]+','+e.getParentProperty()),s){if(g=t.getRootRec(e,s),g)t.updateTreeBranch(e,g);}else if(i.dirs[c]===d){if(s=o.getRecordById('-1,'+e.getParentProperty()),a=s&&s.get('СчетчикЗадач'),a)if(parseInt(a.get('Новых'),10)-1>-1)a.set('Новых',+a.get('Новых')-1);}else{var u=t.getRootRec(e,e.getSelectedItem());t.updateTreeBranch(e,u);}}}});},updateTreeBranch:function(e,t){var r=false;if(t)r=true===e.getOpenedPath()[t.getId()],e.reloadItem(t.getId(),null,'inside').addCallback(function(){if(r)e.expandNode(t.getId());});},updateSingleRec:function(e,t,r){var n=e.get('СчетчикЗадач');if('inc'===t){if(this._options.processFixEvents&&!r)n.set('Новых',+n.get('Новых')+1);n.set('Всего',parseInt(n.get('Всего'),10)+1);}else{if(this._options.processFixEvents&&!r&&+n.get('Новых')-1>-1)n.set('Новых',parseInt(n.get('Новых'),10)-1);if(+n.get('Всего')-1>-1)n.set('Всего',parseInt(n.get('Всего'),10)-1);}},findRoot:function(e,t,r){var n=e,i,o;do{i=o,n=(o=n.get(t.getParentProperty()))?r.getRecordById(o):null;}while(o&&n);return i;},updateDelegatedFolders:function(e){e.getItems().forEach(function(t){if(false===!!t.get('МояПапка'))e.reloadItem(t.getId(),void 0,'inside');});},updateHandlerAnotherDir:function(e,t){var r=this;e.subscribeTo(i.channel('edopartialreloader'),'receiveDirKeyFromServer',function(i,o){var s=o.dir,a=o.type,d=o.fix,l=e.getDataSet(),g=parseInt(e.getSelectedKey(),10),c,u;if(!e.getParentProperty||e.getSelectedItem()&&parseInt(e.getSelectedItem().getId(),10)===o.dir&&'dec'===a)return;if(u=l.getRecordById(s+','+e.getParentProperty()),!u){if(-1===g&&'dec'===a)return void r.updateDelegatedFolders(e);if(c=n.global.getValue('ПапкиТекущегоПользователя'),c)if(s===c.get('МоиЗадачи')){if(e.reloadItem('-1,ПапкаДокументов',void 0,'inside'),r._options&&r._options.linkedGroupTape)r._options.linkedGroupTape.reload();return;}}if(u){r.updateSingleRec(u,a,d);var f=r.findRoot(u,e,l),p=l.getRecordById(f);e.reloadItem(f,p,'inside');}else t&&e.reload(e.getFilter(),null,null,null,true);if(r._options&&r._options.linkedGroupTape)r._options.linkedGroupTape.reload();});},updateHandlerAfterUFolderDelete:function(e){e.subscribeTo(i.channel('edopartialreloader'),'onDeleteUserFolder',function(t,r){var n=r.folder,i=e.getDataSet().getRecordById('-1,'+e.getParentProperty()),o,s,a=null,d=null;if(i&&n&&n.get('СчетчикЗадач').get('Всего'))o=i.get('СчетчикЗадач'),s=n.get('СчетчикЗадач'),a=parseInt(o.get('Всего'),10)+parseInt(s.get('Всего'),10),d=parseInt(o.get('Новых'),10)+parseInt(s.get('Новых'),10),o.set('Всего',a||''),o.set('Новых',d||'');});},destroy:function(){if(this.hasChildControlByName('taskHierBrowser'))this.getChildControlByName('taskHierBrowser')._options.interactiveMoveObject.destroy();l.superclass.destroy.apply(this,arguments);},init:function(){l.superclass.init.call(this);var e=this.getChildControlByName('taskHierBrowser'),t=new r({endpoint:this._options.queryObject,binding:{query:this._options.queryMethod},model:o}),i={'Регламент':null,'ПоказИерархии':true,'ВидДерева':'Только узлы','ВнешняяИерархия':true};if(this.setCursorOnFirstRow(e),this.updateHandlerAfterHierMove(e),this.subscribeNewFolders(e),this.setBrowMoveStrategy(e),this._options.useLightCounters)this.setDataSetChangeHandlerLite(e);else this.setDataSetChangeHandler(e);if(this.updateHandlerAfterFix(e),this.updateHandlerAfterUFolderDelete(e),this.updateHandlerAnotherDir(e,true),e.setDataSource(t,true),e.setFilter(i,this._options.foldersListData&&!!this._options.foldersListData.items||this._options.noLoadOnInit),new r({endpoint:'ПапкаДокументов'}).call('ИдентификаторыСлужебных',{fid:'МоиЗадачи',face:null}).addCallback(function(e){n.global.setValue('ПапкиТекущегоПользователя',e.getRow());}),e)e._options.interactiveMoveObject=new d({linkedObject:e,componentOptions:{filter:{'ПоказИерархии':true,'СписокДляПеремещения':true}}});},_modifyOptions:function(){var e=l.superclass._modifyOptions.apply(this,arguments),t=new a(e.deleteUserFolderClick,e.arrowClick),r=new s(t,{});return e.selectedKey=e.foldersListData&&!!e.foldersListData.items?'-1,ПапкаДокументов':void 0,e.itemsActions=e.itemsActions||r.getActions(),e;}});return l;});
define("tmpl!SBIS3.EDO.FTasksGroupByType",["Core/tmpl/js/tclosure","js!SBIS3.CONTROLS/ListView"],function(){var e=Array.prototype.slice.call(arguments),r=e[0],t={};t["js!SBIS3.CONTROLS/ListView"]=e[1];var s=function e(s,o,a,i,p){function n(){}var l=0,u=void 0!==r&&r?r:arguments[arguments.length-1];void 0===u&&(eval("var thelpers = null;"),u=global.requirejs("View/Runner/tclosure"));var c={};p&&p.isSetts&&(c=p.fullContext||{});var y="string"==typeof a?a:"",T=void 0===t?void 0:t,d={id:[],def:void 0},m=u.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,s),S=this&&this.includedTemplates?this.includedTemplates:{},B=u.getMarkupGenerator(i);try{var k=B.joinElements([B.createTag("div",{class:"edo-TasksGroupByType"},[B.createControl("wsControl","ws:SBIS3.CONTROLS/ListView",{itemsActions:[],groupBy:{clickHandler:u.getTypeFunc("js!SBIS3.EDO.FTasksGroupByType:prototype.groupClickHandler ",{}),field:"ВидГруппы",contentTemplate:"tmpl!SBIS3.EDO.FTasksGroupByType/resources/FTasksGroupSeparator"},name:"FTasksGroupByType",className:"tcv_TasksGroupByType controls-ListView__orangeMarker",showHead:!1,itemsDragNDrop:!1,viewMode:"list",scrollPaging:!1,infiniteScroll:!0,idProperty:"Ид",displayProperty:"Название",itemTpl:"tmpl!SBIS3.EDO.FTasksGroupByType/resources/FTaskGroupItem",itemContentTpl:"tmpl!SBIS3.EDO.FTasksGroupByType/resources/FTaskGroupItemContent",easyGroup:!0,filterParams:u.getter(s,["filterParams"]),items:u.getter(s,["groupsListData"])?u.getter(s,["groupsListData","items"]):void 0,esc:!1},{name:"FTasksGroupByType",sbisname:"FTasksGroupByType"},{data:s,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},a,T,S,u.config,c)],o,d,this)],y,d);d.def&&(k=B.chain(k,d,o),d=void 0)}catch(e){u.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/FTasksGroupByType/FTasksGroupByType.tmpl",e,s)}return k||""};return s.includedFunctions={},s.stable=!0,s.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FTasksGroupByType"}},s});
define('js!SBIS3.EDO.TasksGroupByTypeModel',['WS.Data/Entity/Model','WS.Data/Di','js!SBIS3.Person.PersonPhotoTemplateHelper','Elektronnyj_dokumentooborot_localization'],function(e,t,o){'use strict';var r=e.extend([],{_moduleName:'SBIS3.EDO.TasksGroupByTypeModel',_$properties:{photoData:{get:function(){var e=this;return o.getPhotoData({data:{personId:e.get('bindId'),photoId:e.get('Фото')},settings:{size:24}});}},counterLength:{get:function(){return this.get('КолВсего').toString().length;}}}});return t.register('TasksGroupByTypeModel',r),r;});
define("tmpl!SBIS3.EDO.FTasksGroupByType/resources/FTasksGroupSeparator",["Core/tmpl/js/tclosure"],function(){var e=Array.prototype.slice.call(arguments),r=e[0],t={},o=function e(o,s,a,p,n){function l(){}var i=0,u=void 0!==r&&r?r:arguments[arguments.length-1];void 0===u&&(eval("var thelpers = null;"),u=global.requirejs("View/Runner/tclosure"));var c={};n&&n.isSetts&&(c=n.fullContext||{});var d="string"==typeof a?a:"",y=void 0===t?void 0:t,f={id:[],def:void 0},m=u.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),v=this&&this.includedTemplates?this.includedTemplates:{},T=u.getMarkupGenerator(p);try{var _=T.joinElements([T.createTag("div",{class:"controls-GroupBy__separator controls-GroupBy__separator__right"},[T.createTag("span",{class:"controls-GroupBy__separatorText controls-GroupBy__separatorCollapse "+u.wrapUndef(u.utils.escape(u.getter(o,["item","Свернуто"])?"controls-GroupBy__separatorCollapse__collapsed":"")),id:""+u.wrapUndef(u.utils.escape(u.getter(o,["item","GroupId"])))},[T.createText(""+u.wrapUndef(u.utils.escape(u.getter(o,["item","ВидГруппы"]))))],{},f,this)],s,f,this)],d,f);f.def&&(_=T.chain(_,f,s),f=void 0)}catch(e){u.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/FTasksGroupByType/resources/FTasksGroupSeparator.tmpl",e,o)}return _||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FTasksGroupByType/resources/FTasksGroupSeparator"}},o});
define("tmpl!SBIS3.EDO.FTasksGroupByType/resources/FTaskGroupItem",["Core/tmpl/js/tclosure"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={},o=function e(o,n,i,s,a){function u(){}var l=0,p=void 0!==t&&t?t:arguments[arguments.length-1];void 0===p&&(eval("var thelpers = null;"),p=global.requirejs("View/Runner/tclosure"));var c={};a&&a.isSetts&&(c=a.fullContext||{});var d="string"==typeof i?i:"",m=void 0===r?void 0:r,v={id:[],def:void 0},y=p.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),f=this&&this.includedTemplates?this.includedTemplates:{},T=p.getMarkupGenerator(s);try{var g=T.joinElements([T.createControl("resolver",p.getter(o,["defaultItemTpl"]),p.uniteScope(p.utils.escape(p.uniteScope(o,{parent:void 0,element:void 0})(p.plainMerge)),{className:"TaskGroupItem tg-"+p.getter(o,["item","ВидГруппы"])+" "+(p.getter(o,["item","Свернуто"])?"ws-hidden":"")}),{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},i,m,f,p.config,c,v)],d,v);v.def&&(g=T.chain(g,v,n),v=void 0)}catch(e){p.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/FTasksGroupByType/resources/FTaskGroupItem.tmpl",e,o)}return g||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FTasksGroupByType/resources/FTaskGroupItem"}},o});
define("tmpl!SBIS3.EDO.FTasksGroupByType/resources/FTaskGroupItemContent",["Core/tmpl/js/tclosure","tmpl!SBIS3.Person.PersonPhotoTemplateHelper"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["tmpl!SBIS3.Person.PersonPhotoTemplateHelper"]=e[1];var a=function e(a,o,s,p,i){function n(){}var l=0,c=void 0!==t&&t?t:arguments[arguments.length-1];void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure"));var m={};i&&i.isSetts&&(m=i.fullContext||{});var u="string"==typeof s?s:"",g=void 0===r?void 0:r,d={id:[],def:void 0},T=c.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,a),y=this&&this.includedTemplates?this.includedTemplates:{},h=c.getMarkupGenerator(p);try{var f=h.joinElements([h.createTag("div",{},["Отправители"==c.getter(a,["item","GroupId"])||"Получатели"==c.getter(a,["item","GroupId"])?[h.createControl("template","tmpl!SBIS3.Person.PersonPhotoTemplateHelper",{photoData:c.getter(a,["item","get"]).apply(c.getter(a,["item"]),["photoData"])},{},{data:a,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:T},p?s+"part_"+l+++"_":s,g,y,c.config,m)]:h.createText(""),h.createTag("span",{class:"TaskGroupItem_title TaskGroupItem_title_length"+c.wrapUndef(c.utils.escape(c.getter(a,["item","get"]).apply(c.getter(a,["item"]),["counterLength"]))),title:""+c.wrapUndef(c.utils.escape(c.getter(a,["item","Название"])))},[h.createText(""+c.wrapUndef(c.utils.escape(c.getter(a,["item","Название"]))))],{},d,this),h.createTag("div",{class:"TaskGroupItem_new_counters"},[c.getter(a,["item","get"]).apply(c.getter(a,["item"]),["КолНовых"])?[h.createTag("span",{class:"TaskGroupItem_new"},[h.createText(""+c.wrapUndef(c.utils.escape(c.getter(a,["item","get"]).apply(c.getter(a,["item"]),["КолНовых"]))))],{},d,this)]:h.createText(""),c.getter(a,["item","get"]).apply(c.getter(a,["item"]),["КолНовых"])&&c.getter(a,["item","get"]).apply(c.getter(a,["item"]),["КолВсего"])?[h.createTag("span",{class:"TaskGroupItem_delim"},[h.createText(""+global.rk("|"))],{},d,this)]:h.createText(""),c.getter(a,["item","get"]).apply(c.getter(a,["item"]),["КолВсего"])?[h.createTag("span",{class:"TaskGroupItem_all"},[h.createText(""+c.wrapUndef(c.utils.escape(c.getter(a,["item","get"]).apply(c.getter(a,["item"]),["КолВсего"]))))],{},d,this)]:h.createText("")],{},d,this)],o,d,this)],u,d);d.def&&(f=h.chain(f,d,o),d=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/FTasksGroupByType/resources/FTaskGroupItemContent.tmpl",e,a)}return f||""};return a.includedFunctions={},a.stable=!0,a.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FTasksGroupByType/resources/FTaskGroupItemContent"}},a});
define('js!SBIS3.EDO.FTasksGroupByType',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FTasksGroupByType','WS.Data/Source/SbisService','WS.Data/Chain','Core/HashManager','js!SBIS3.EDO.TasksGroupByTypeModel','tmpl!SBIS3.EDO.FTasksGroupByType/resources/FTasksGroupSeparator','css!SBIS3.EDO.FTasksGroupByType','tmpl!SBIS3.EDO.FTasksGroupByType/resources/FTaskGroupItem','tmpl!SBIS3.EDO.FTasksGroupByType/resources/FTaskGroupItemContent','SBIS3.CONTROLS/Tree/CompositeView','Elektronnyj_dokumentooborot_localization'],function(e,t,i,r,n,a){'use strict';var o=e.extend({_dotTplFn:t,$protected:{_options:{linkedEdoBrowser:null,linkedHier:null},_treeView:void 0},$constructor:function(){},onSelectedItemChange:function(e,t){var i=this,r=i.getLinkedContext(),a=i.getParent().getLinkedContext();if(null!==t&&void 0!==t){var o={bindName:'',bindId:''},l=i.getDataSet().at(t),s=l,u=i._options.linkedEdoBrowser,d=u._options.browserOptions.bind,p=u.getLinkedContext(),g=['ФильтрПоВехе','ИдРегламента','ФильтрОтправитель','ФильтрСписокРассылки'],c=[],f=['Проект','ФильтрПоВехе','ИдРегламента','ПапкаДокументов','ФильтрОтправитель','ФильтрСписокРассылки'];for(var S in f)if(f.hasOwnProperty(S)&&f[S]!=s.get('bindName'))c.push(f[S]);require(['js!SBIS3.EDO.EdoCommon'],function(e){var a=u._filterButton,f=u._fastDataFilter;e.resetCustomFilters({edoBrowser:u,resetFilters:c,noLoad:true,bindButton:d,addFilter:{'ФильтрацияПоСчетчику':true},filterButtonFilter:a?a.getFilter():void 0,noClone:true});var S=a.getFilterStructure(),b=f?f.getFilterStructure():null,m={'Проект':null,'ФильтрПоВехе':[],'ИдРегламента':[],'ФильтрОтправитель':[],'ФильтрСписокРассылки':[]},F='';if(s.get('bindName'))F=s.get('bindName'),m[s.get('bindName')]=Array.indexOf(g,s.get('bindName'))>-1?[s.get('bindId')]:+s.get('bindId');for(var y=0;y<S.length;y++){if(S[y].filterField in m)S[y].value=m[S[y].filterField],S[y].resetValue=m[S[y].filterField],S[y].resetVisibilityValue=F==S[y].filterField,delete m[S[y].filterField];if(0==m.length)break;}if('registry-FromMe'===n.get('region_left')){for(var y=0;y<S.length;y++)if('FilterShortState'===S[y]['internalValueField']){S[y]['caption']=rk('В обработке'),S[y]['value']='8';break;}p.setValue(d+'/'+S[y]['filterField'],'8');for(var I=0;b&&I<b.length;I++)if('FilterShortState'===b[I]['internalValueField']){b[I]['caption']=rk('В обработке'),b[I]['value']='8';break;}f.setFilterStructure(b);}if(a.setFilterStructure(S),null!==t&&i.getParent()._options.linkedHier)i.getParent()._options.linkedHier.setSelectedKey(null);if(l)o.bindName=l.get('bindName'),o.bindId=l.get('bindId'),o.bindCaption=s.get('Название');if(r.setValue('typeSelection',o),'ИдРегламента'==o.bindName)r.setValue('tapeIdRegulation',[o.bindId]),r.setValue('tapeProject',null),r.setValue('tapeMilestone',[]);else if('ФильтрПоВехе'==o.bindName)r.setValue('tapeIdRegulation',[]),r.setValue('tapeProject',null),r.setValue('tapeMilestone',[o.bindId]);else if('Проект'==o.bindName)r.setValue('tapeIdRegulation',[]),r.setValue('tapeProject',+o.bindId),r.setValue('tapeMilestone',[]);else r.setValue('tapeIdRegulation',[]),r.setValue('tapeProject',null),r.setValue('tapeMilestone',[]);p.setValue(d+'/'+s.get('bindName'),Array.indexOf(g,s.get('bindName'))>-1?[s.get('bindId')]:s.get('bindId')),p.setValue(d+'Caption/'+s.get('bindName'),s.get('Название'));});}else r.setValue('typeSelection',null),r.setValue('tapeIdRegulation',[]),r.setValue('tapeProject',null),r.setValue('tapeMilestone',[]);},init:function(){o.superclass.init.call(this);var e=this.getChildControlByName('FTasksGroupByType'),t=new i({endpoint:'ПапкаДокументов',binding:{query:'ПолучитьСчетчики'},model:a}),r=e._options.filterParams;this._treeView=e,e.setDataSource(t,true),e.setFilter(r,this._options.groupsListData&&!!this._options.groupsListData.items||this._options.noLoadOnInit),e._options.curFolderName=this._getCurFolderName(),e.once('onDataLoad',function(t,i){i.forEach(function(t){e._options._groupCollapsing[t.get('ВидГруппы')]=!!t.get('Свернуто');});});},_getCurFolderName:function(){switch(n.get('region_left')){case'registry-My':return'МоиЗадачи';case'registry-FromMe':return'ОтМеня';case'registry-OnControl':return'НаКонтроле';}return'';},groupClickHandler:function(e){if(e&&e.text())new i({endpoint:'ПапкаДокументов'}).call('ОбновитьСостояниеГруппы',{'Папка':this._options.curFolderName||'МоиЗадачи','Группа':e.attr('id'),'Свернуто':!e.hasClass('controls-GroupBy__separatorCollapse__collapsed')});},setSelectionByData:function(e,t){var i=this._treeView.getDataSet(),n;if(null==e)return this._treeView.setSelectedKey(null),true;var a=this._treeView.getSelectedKey(),o,l;if(a)o=i.at(a).get('bindName'),l=i.at(a).get('bindId');if(i&&(e!=o||t!=l)){for(var s=0;s<i.getCount();s++)if(n=r(i.at(s)).toObject(),n.bindName&&n.bindId&&n.bindName==e&&n.bindId==t)return this._treeView.setSelectedKey(s),true;if(s>=i.getCount())return false;}return true;}});return o;});
define("tmpl!SBIS3.EDO.FMyTaskTapeTab/FMyTaskTapeTab",["Core/tmpl/js/tclosure","js!SBIS3.CONTROLS/Link","js!SBIS3.Engine.BrowserTabs","js!SBIS3.EDO.FTaskButtons","js!SBIS3.EDO.FMyTasks","js!SBIS3.EDO.FTaskHier","js!SBIS3.EDO.FTasksGroupByType","js!SBIS3.TASKS.MovementsController"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.CONTROLS/Link"]=e[1],r["js!SBIS3.Engine.BrowserTabs"]=e[2],r["js!SBIS3.EDO.FTaskButtons"]=e[3],r["js!SBIS3.EDO.FMyTasks"]=e[4],r["js!SBIS3.EDO.FTaskHier"]=e[5],r["js!SBIS3.EDO.FTasksGroupByType"]=e[6],r["js!SBIS3.TASKS.MovementsController"]=e[7];var o=function e(o,a,n,s,i){function l(){}var d=0,c=void 0!==t&&t?t:arguments[arguments.length-1];void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure"));var p={};i&&i.isSetts&&(p=i.fullContext||{});var m="string"==typeof n?n:"",u=void 0===r?void 0:r,g={id:[],def:void 0},v=c.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),k=this&&this.includedTemplates?this.includedTemplates:{},T=c.getMarkupGenerator(s);try{var C=T.joinElements([T.createTag("div",{class:"edo-FMyTaskTapeTab__wrapper"},[c.getter(o,["isFloatMode"])?[T.createTag("div",{class:"ws-float-area__close-button-wrapper",style:"height: 34px;"},[T.createControl("wsControl","ws:SBIS3.CONTROLS/Link",{name:"ЗадачиНаМне",caption:global.rk("Задачи на мне"),href:"/fregistry.html?region_left=registry-My",className:"mytask_area_caption"},{name:"ЗадачиНаМне",sbisname:"ЗадачиНаМне"},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:v},n,u,k,c.config,p)],{},g,this)]:T.createText(""),T.createControl("wsControl","ws:SBIS3.Engine.BrowserTabs",{tabsArea:[{content:c.createDataArray([(new function(){var e=Object.create(o),t=function e(t,r,o,a,n){if(void 0===o)var o=arguments[2];var s=0,i="content";if(void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure")),n&&n.isSetts)var l=n.fullContext||{};t=c.isolateScope(Object.create(this),t,i);var d="string"==typeof o?o:"",p={id:[],def:void 0},m=this&&this.includedTemplates?this.includedTemplates:{},g=c.getMarkupGenerator(a);try{var k=g.joinElements([g.createControl("wsControl","ws:SBIS3.EDO.FTaskButtons",{name:"TaskButtons",addDoc_name:"AddTaskInMine",showAddDoc:!0,addFolder_advanced:!0,showAddFolder:!0,createTaskTooltip:global.rk("Создать задачу"),createFolderTooltip:global.rk("Создать папку"),showTransfer:!0},c.plainMerge(r,{name:"TaskButtons",sbisname:"TaskButtons"}),{data:t,ctx:this,pName:void 0!==i?i:void 0,viewController:v},o,u,m,c.config,l)],d,p);p.def&&(k=g.chain(k,p,r),p=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/FMyTaskTapeTab/FMyTaskTapeTab.tmpl",e,t)}return k||""};this.func=c.makeFunctionSerializable(t,e)}).func]),id:"aftGroup"},{content:c.createDataArray([(new function(){var e=Object.create(o),t=function e(t,r,o,a,n){if(void 0===o)var o=arguments[2];var s=0,i="content";if(void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure")),n&&n.isSetts)var l=n.fullContext||{};t=c.isolateScope(Object.create(this),t,i);var d="string"==typeof o?o:"",p={id:[],def:void 0},m=this&&this.includedTemplates?this.includedTemplates:{},g=c.getMarkupGenerator(a);try{var k=g.joinElements([g.createControl("wsControl","ws:SBIS3.EDO.FTaskButtons",{name:"TaskButtons",addDoc_name:"AddTaskInMine",showAddDoc:!1},c.plainMerge(r,{name:"TaskButtons",sbisname:"TaskButtons"}),{data:t,ctx:this,pName:void 0!==i?i:void 0,viewController:v},o,u,m,c.config,l)],d,p);p.def&&(k=g.chain(k,p,r),p=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/FMyTaskTapeTab/FMyTaskTapeTab.tmpl",e,t)}return k||""};this.func=c.makeFunctionSerializable(t,e)}).func]),id:"addBtnGroup"}],tabs:[{id:"DoneTab",title:global.rk("Выполненные"),tabsArea:"addBtnGroup",mainArea:"doneGroup"},{id:"ListTab",title:global.rk("В работе"),tabsArea:"aftGroup",mainArea:"listGroup"}],mainArea:[{content:c.createDataArray([(new function(){var e=Object.create(o),t=function e(t,r,o,a,n){if(void 0===o)var o=arguments[2];var s=0,i="content";if(void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure")),n&&n.isSetts)var l=n.fullContext||{};t=c.isolateScope(Object.create(this),t,i);var d="string"==typeof o?o:"",p={id:[],def:void 0},m=this&&this.includedTemplates?this.includedTemplates:{},g=c.getMarkupGenerator(a);try{var k=g.joinElements([g.createControl("wsControl","ws:SBIS3.EDO.FMyTasks",{tapeContent:c.createDataArray([(new function(){var e=Object.create(t),r=function e(t,r,o,a,n){if(void 0===o)var o=arguments[2];var s=0,i="tapeContent";if(void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure")),n&&n.isSetts)var l=n.fullContext||{};t=c.isolateScope(Object.create(this),t,i);var d="string"==typeof o?o:"",p={id:[],def:void 0},m=this&&this.includedTemplates?this.includedTemplates:{},g=c.getMarkupGenerator(a);try{var k=g.joinElements([g.createControl("wsControl","ws:SBIS3.EDO.FTaskHier",{arrowClick:c.getTypeFunc("js!SBIS3.EDO.EdoClicks:myFolderClick",{}),deleteUserFolderClick:c.getTypeFunc("js!SBIS3.EDO.EdoRecOptions:deleteUserFolderMy",{}),name:"Edo-TaskHier",noLoadOnInit:!1,processFixEvents:!0,foldersListData:c.getter(t,["foldersListData"]),esc:!1},c.plainMerge(r,{name:"Edo-TaskHier",sbisname:"Edo-TaskHier"}),{data:t,ctx:this,pName:void 0!==i?i:void 0,viewController:v},o,u,m,c.config,l)],d,p);p.def&&(k=g.chain(k,p,r),p=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/FMyTaskTapeTab/FMyTaskTapeTab.tmpl",e,t)}return k||""};this.func=c.makeFunctionSerializable(r,e)}).func,(new function(){var e=Object.create(t),r=function e(t,r,o,a,n){if(void 0===o)var o=arguments[2];var s=0,i="tapeContent";if(void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure")),n&&n.isSetts)var l=n.fullContext||{};t=c.isolateScope(Object.create(this),t,i);var d="string"==typeof o?o:"",p={id:[],def:void 0},m=this&&this.includedTemplates?this.includedTemplates:{},g=c.getMarkupGenerator(a);try{var k=g.joinElements([g.createControl("wsControl","ws:SBIS3.EDO.FTasksGroupByType",{filterParams:{"ИмяПапки":"МоиЗадачи"},name:"Edo-TasksGroupByType",groupsListData:c.getter(t,["groupsListData"]),esc:!1},c.plainMerge(r,{name:"Edo-TasksGroupByType",sbisname:"Edo-TasksGroupByType"}),{data:t,ctx:this,pName:void 0!==i?i:void 0,viewController:v},o,u,m,c.config,l)],d,p);p.def&&(k=g.chain(k,p,r),p=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/FMyTaskTapeTab/FMyTaskTapeTab.tmpl",e,t)}return k||""};this.func=c.makeFunctionSerializable(r,e)}).func]),partialReloader:{addServerChannelName:"edo.task-added",fixServerChannelName:"edo.task-fix",deleteServerChannelName:"edo.task-delete",onCreateModelHandlingEnable:!0,onDestroyModelHandlingEnable:!0,updateOnDeleteAndAdd:!0,nameTaskHier:"Edo-TaskHier"},isEventsReestr:!0,showMoveTasksMass:!0,needDataLoadHandler:!0,useAutoRefresh:!0,tapeReestr:!0,listData:c.getter(t,["listData"]),tasksExists:c.getter(t,["tasksExists"]),foldersExists:c.getter(t,["foldersExists"]),serverSideRendering:c.getter(t,["serverSideRendering"]),showUnread:c.getter(t,["showUnread"]),backButtonEditing:!0,allowDragNDropMove:!0,showHead:!0,statusPictureTitle:global.rk("Состояние"),cssStatus:global.rk("Состояние"),dateColTitle:global.rk("Получено"),isNeedCommentPrevStage:!0,objectName:"СвязьПапок",dateColHeadTemplate:"tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/THeadDateRecieved",hierAllow:!0,filterParams:c.getter(t,["listBrowserFilterParams"]),esc:!1},c.plainMerge(r,{}),{data:t,ctx:this,pName:void 0!==i?i:void 0,viewController:v,internal:{__dirtyCheckingVars_2:c.getter(t,["foldersListData"]),__dirtyCheckingVars_3:c.getter(t,["groupsListData"])}},o,u,m,c.config,l)],d,p);p.def&&(k=g.chain(k,p,r),p=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/FMyTaskTapeTab/FMyTaskTapeTab.tmpl",e,t)}return k||""};this.func=c.makeFunctionSerializable(t,e)}).func,(new function(){var e=Object.create(o),t=function e(t,r,o,a,n){if(void 0===o)var o=arguments[2];var s=0,i="content";if(void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure")),n&&n.isSetts)var l=n.fullContext||{};t=c.isolateScope(Object.create(this),t,i);var d="string"==typeof o?o:"",p={id:[],def:void 0},m=this&&this.includedTemplates?this.includedTemplates:{},g=c.getMarkupGenerator(a);try{var k=g.joinElements([g.createControl("wsControl","ws:SBIS3.TASKS.MovementsController",{excludedFilters:c.getter(t,["movementsControllerOptions","taskHier","excludedFilters"]),includedFilters:c.getter(t,["movementsControllerOptions","taskHier","includedFilters"]),componentName:c.getter(t,["movementsControllerOptions","taskHier","componentName"]),browserName:c.getter(t,["movementsControllerOptions","taskHier","browserName"]),filterRetriever:c.getter(t,["movementsControllerOptions","taskHier","filterRetriever"]),injectableFilters:c.getter(t,["movementsControllerOptions","taskHier","injectableFilters"]),onResetSearchHandler:c.getter(t,["movementsControllerOptions","taskHier","onResetSearchHandler"]),onStartSearchHandler:c.getter(t,["movementsControllerOptions","taskHier","onStartSearchHandler"]),reloadAfterFilterChange:c.getter(t,["movementsControllerOptions","taskHier","reloadAfterFilterChange"]),resetOnRequest:c.getter(t,["movementsControllerOptions","taskHier","resetOnRequest"]),filterForNotReloadControl:c.getter(t,["movementsControllerOptions","taskHier","filterForNotReloadControl"]),itemDataRetriever:c.getter(t,["movementsControllerOptions","taskHier","itemDataRetriever"])},c.plainMerge(r,{}),{data:t,ctx:this,pName:void 0!==i?i:void 0,viewController:v},o,u,m,c.config,l)],d,p);p.def&&(k=g.chain(k,p,r),p=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/FMyTaskTapeTab/FMyTaskTapeTab.tmpl",e,t)}return k||""};this.func=c.makeFunctionSerializable(t,e)}).func,(new function(){var e=Object.create(o),t=function e(t,r,o,a,n){if(void 0===o)var o=arguments[2];var s=0,i="content";if(void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure")),n&&n.isSetts)var l=n.fullContext||{};t=c.isolateScope(Object.create(this),t,i);var d="string"==typeof o?o:"",p={id:[],def:void 0},m=this&&this.includedTemplates?this.includedTemplates:{},g=c.getMarkupGenerator(a);try{var k=g.joinElements([g.createControl("wsControl","ws:SBIS3.TASKS.MovementsController",{excludedFilters:c.getter(t,["movementsControllerOptions","groups","excludedFilters"]),includedFilters:c.getter(t,["movementsControllerOptions","groups","includedFilters"]),componentName:c.getter(t,["movementsControllerOptions","groups","componentName"]),browserName:c.getter(t,["movementsControllerOptions","groups","browserName"]),filterRetriever:c.getter(t,["movementsControllerOptions","groups","filterRetriever"]),injectableFilters:c.getter(t,["movementsControllerOptions","groups","injectableFilters"]),onResetSearchHandler:c.getter(t,["movementsControllerOptions","groups","onResetSearchHandler"]),onStartSearchHandler:c.getter(t,["movementsControllerOptions","groups","onStartSearchHandler"]),slaveControl:c.getter(t,["movementsControllerOptions","groups","slaveControl"]),getDataForMovingMarkerFromFilterButton:c.getter(t,["movementsControllerOptions","groups","getDataForMovingMarkerFromFilterButton"]),filterForNotReloadControl:c.getter(t,["movementsControllerOptions","groups","filterForNotReloadControl"]),itemDataRetriever:c.getter(t,["movementsControllerOptions","groups","itemDataRetriever"])},c.plainMerge(r,{}),{data:t,ctx:this,pName:void 0!==i?i:void 0,viewController:v},o,u,m,c.config,l)],d,p);p.def&&(k=g.chain(k,p,r),p=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/FMyTaskTapeTab/FMyTaskTapeTab.tmpl",e,t)}return k||""};this.func=c.makeFunctionSerializable(t,e)}).func]),id:"listGroup"},{content:c.createDataArray([(new function(){var e=Object.create(o),t=function e(t,r,o,a,n){if(void 0===o)var o=arguments[2];var s=0,i="content";if(void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure")),n&&n.isSetts)var l=n.fullContext||{};t=c.isolateScope(Object.create(this),t,i);var d="string"==typeof o?o:"",p={id:[],def:void 0},m=this&&this.includedTemplates?this.includedTemplates:{},g=c.getMarkupGenerator(a);try{var k=g.joinElements([g.createControl("wsControl","ws:SBIS3.EDO.FMyTasks",{additionalColumn:{width:"140",title:global.rk("Ответственный"),headTemplate:global.rk("Ответственный"),cellTemplate:"tmpl!SBIS3.EDO2.Browser/resources/columns/tmpl/ResponsibleColumn"},isEventsReestr:!0,useScrollContainer:!0,addClass:"doneTasksGroup",objectName:"Документ",method:"Выполненные",dateColTemplate:"tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TDateDoneColumn",descColTemplate:"tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TDetalizationColumn",additionalTaskColTemplate:"tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TMainColumn",showHead:!0,cssStatus:"fieldStatusAlign",dateColWidth:"100",dateColTitle:global.rk("Выполнено"),dateColField:"ДокументДатаВремя",ladderField:"ladderDateKeyDone",isExecuted:!0,isNotCheckShortStateForPeriodRender:!0,hierAllow:!1,idProperty:"@Событие",historyId:"MyTasksExecuted",operationsPanelConfig:c.getter(t,["operationsPanelConfigDoneGroup"]),filterButtonConfig:c.getter(t,["filterButtonConfigDoneGroup"]),massActionsSettings:c.getter(t,["massActionsSettingsDoneGroup"]),massActionsVisibility:c.getter(t,["massActionsVisibilityDoneGroup"]),personId:"Отправитель.@Лицо",photoId:"PhotoId",dateColHeadTemplate:"tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/THeadDateDone",filterParams:c.getter(t,["doneBrowserFilterParams"]),itemsActions:c.getter(t,["doneItemsActions"]),esc:!1},c.plainMerge(r,{}),{data:t,ctx:this,pName:void 0!==i?i:void 0,viewController:v},o,u,m,c.config,l)],d,p);p.def&&(k=g.chain(k,p,r),p=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/FMyTaskTapeTab/FMyTaskTapeTab.tmpl",e,t)}return k||""};this.func=c.makeFunctionSerializable(t,e)}).func]),id:"doneGroup"}],handlers:{onTabChange:c.getTypeFunc("js!SBIS3.EDO.FMyTaskTapeTab:prototype.onTabChange",{}),onTabAndMainLoaded:c.getTypeFunc("js!SBIS3.EDO.FMyTaskTapeTab:prototype.onTabAndMainLoaded",{})},name:"MyTaskTabs",defaultTab:"ListTab",tabsName:"MyTaskInnerTabs",esc:!1},{class:"MyTaskTabs TasksTapeTabBrowserTabs",name:"MyTaskTabs",sbisname:"MyTaskTabs"},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:v,internal:{__dirtyCheckingVars_11:c.getter(o,["foldersListData"]),__dirtyCheckingVars_12:c.getter(o,["groupsListData"]),__dirtyCheckingVars_21:c.getter(o,["listData"]),__dirtyCheckingVars_22:c.getter(o,["tasksExists"]),__dirtyCheckingVars_23:c.getter(o,["foldersExists"]),__dirtyCheckingVars_24:c.getter(o,["serverSideRendering"]),__dirtyCheckingVars_25:c.getter(o,["showUnread"]),__dirtyCheckingVars_34:c.getter(o,["listBrowserFilterParams"]),__dirtyCheckingVars_35:c.getter(o,["movementsControllerOptions","taskHier","excludedFilters"]),__dirtyCheckingVars_36:c.getter(o,["movementsControllerOptions","taskHier","includedFilters"]),__dirtyCheckingVars_37:c.getter(o,["movementsControllerOptions","taskHier","componentName"]),__dirtyCheckingVars_38:c.getter(o,["movementsControllerOptions","taskHier","browserName"]),__dirtyCheckingVars_39:c.getter(o,["movementsControllerOptions","taskHier","filterRetriever"]),__dirtyCheckingVars_40:c.getter(o,["movementsControllerOptions","taskHier","injectableFilters"]),__dirtyCheckingVars_41:c.getter(o,["movementsControllerOptions","taskHier","onResetSearchHandler"]),__dirtyCheckingVars_42:c.getter(o,["movementsControllerOptions","taskHier","onStartSearchHandler"]),__dirtyCheckingVars_43:c.getter(o,["movementsControllerOptions","taskHier","reloadAfterFilterChange"]),__dirtyCheckingVars_44:c.getter(o,["movementsControllerOptions","taskHier","resetOnRequest"]),__dirtyCheckingVars_45:c.getter(o,["movementsControllerOptions","taskHier","filterForNotReloadControl"]),__dirtyCheckingVars_46:c.getter(o,["movementsControllerOptions","taskHier","itemDataRetriever"]),__dirtyCheckingVars_47:c.getter(o,["movementsControllerOptions","groups","excludedFilters"]),__dirtyCheckingVars_48:c.getter(o,["movementsControllerOptions","groups","includedFilters"]),__dirtyCheckingVars_49:c.getter(o,["movementsControllerOptions","groups","componentName"]),__dirtyCheckingVars_50:c.getter(o,["movementsControllerOptions","groups","browserName"]),__dirtyCheckingVars_51:c.getter(o,["movementsControllerOptions","groups","filterRetriever"]),__dirtyCheckingVars_52:c.getter(o,["movementsControllerOptions","groups","injectableFilters"]),__dirtyCheckingVars_53:c.getter(o,["movementsControllerOptions","groups","onResetSearchHandler"]),__dirtyCheckingVars_54:c.getter(o,["movementsControllerOptions","groups","onStartSearchHandler"]),__dirtyCheckingVars_55:c.getter(o,["movementsControllerOptions","groups","slaveControl"]),__dirtyCheckingVars_56:c.getter(o,["movementsControllerOptions","groups","getDataForMovingMarkerFromFilterButton"]),__dirtyCheckingVars_57:c.getter(o,["movementsControllerOptions","groups","filterForNotReloadControl"]),__dirtyCheckingVars_58:c.getter(o,["movementsControllerOptions","groups","itemDataRetriever"]),__dirtyCheckingVars_68:c.getter(o,["operationsPanelConfigDoneGroup"]),__dirtyCheckingVars_69:c.getter(o,["filterButtonConfigDoneGroup"]),__dirtyCheckingVars_70:c.getter(o,["massActionsSettingsDoneGroup"]),__dirtyCheckingVars_71:c.getter(o,["massActionsVisibilityDoneGroup"]),__dirtyCheckingVars_72:c.getter(o,["doneBrowserFilterParams"]),__dirtyCheckingVars_73:c.getter(o,["doneItemsActions"])}},n,u,k,c.config,p)],a,g,this)],m,g);g.def&&(C=T.chain(C,g,a),g=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/FMyTaskTapeTab/FMyTaskTapeTab.tmpl",e,o)}return C||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FMyTaskTapeTab/FMyTaskTapeTab"}},o});
define('js!SBIS3.EDO.FMyTaskTapeTab',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FMyTaskTapeTab/FMyTaskTapeTab','js!SBIS3.EDO.EdoCommon','WS.Data/Source/SbisService','js!SBIS3.EDO.Modificators','js!SBIS3.EDO.Modificators.MyTasks.DoneGroup','js!SBIS3.EDO.FMyTasksHandlers','js!SBIS3.TASKS.MovementsController.Handlers','js!SBIS3.Engine.BrowserTabs','js!SBIS3.EDO.FMyTasks','js!SBIS3.EDO.FTaskButtons','js!SBIS3.EDO.FTaskHier','js!SBIS3.EDO.FTasksGroupByType','SBIS3.CONTROLS/Link','js!SBIS3.EDO.EdoClicks','js!SBIS3.EDO2.Browser','i18n!SBIS3.EDO.FMyTaskTapeTab','tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TDetalizationColumn','tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TDateDoneColumn','js!SBIS3.Person.PersonPhoto','css!SBIS3.EDO.FTasksGroupByType','tmpl!SBIS3.EDO2.Browser/resources/columns/tmpl/ResponsibleColumn','Elektronnyj_dokumentooborot_localization'],function(e,t,s,o,r,a,i,n){'use strict';var l=e.extend({_dotTplFn:t,$protected:{_options:{isFloatMode:false,showUnread:false,listData:null,ladder:['docFacePhoto','docDate'],ignoreFiltersList:['ФильтрПриоритет','ПоказИерархии','Лицо','СлужебныйКоличествоЗаписей','СлужебныйКоличествоПапок','ФильтрСписокРассылки'],massActionsSettingsDoneGroup:{edoPrintDocumentMass:{options:{handlers:{onApplyOperation:i.setPrintColumns_executed}}}},massActionsVisibilityDoneGroup:{edoSetCloseStatusMass:false,edoPostsMass:false,edoDeleteDocumentMass:false,edoRestoreDocumentMass:false},listBrowserFilterParams:{'ПапкаДокументов':'','ПростыеВД':true,'РассчитатьФото':true,'ПоказИерархии':false,'ВключитьСписокИсполнителей':true,'ВнешняяИерархия':true},doneBrowserFilterParams:{'ФильтрДатаПериод':'Месяц'},doneItemsActions:[],itemsExists:false,tasksExists:true,foldersExists:true,movementsControllerOptions:{}}},$constructor:function(e){this._options.isFloatMode=e.isFloatMode||false;},init:function(){l.superclass.init.call(this);var e='MyTasks';s.updateTaskHierAfterMassAction.call(this,e);},onTabAndMainLoaded:function(e,t){var o='MyTasks';if('ListTab'===t)s.initTaskButtons({mainObject:this.getCurrentTabArea('main'),tabsObject:this.getCurrentTabArea('tabs'),btnDocName:'AddTaskInMine',brwName:'MyTasks',actionName:'MyTasksAction',folderButtonName:'btnAddFolder',folderAdvancedMode:true,folderAction:'FolderAction',linkedEdoBrowser:['FTasksGroupByType','taskHierBrowser']});else if('DoneTab'===t)s.initTaskButtons({mainObject:this.getCurrentTabArea('main'),tabsObject:this.getCurrentTabArea('tabs'),brwName:'MyTasks',actionName:'MyTasksAction',dlgOpenMode:'remote'});},onTabChange:function(e,t){if('DoneTab'===t)this.getCurrentBrowser().getView().reload();},getService:function(e,t){return new o({endpoint:e.objectName,binding:{query:e.method,destroy:e.destroyMethod},model:e.model,filter:t});},_modifyOptions:function(){var e=l.superclass._modifyOptions.apply(this,arguments),t=new r(new a()),s=!!e.listData&&!!e.listData.items;e.doneItemsActions=t.getActions(),e.operationsPanelConfigDoneGroup=t.getMOPActions(),e.filterButtonConfigDoneGroup=t.getFilterButtonConfig(),e.tasksExists=!!(e.listData&&e.listData.items&&e.listData.items.getCount&&e.listData.items.getCount()>0),e.foldersExists=!!(e.foldersListData&&e.foldersListData.items&&e.foldersListData.items.getCount&&e.foldersListData.items.getCount()>1),e.itemsExists=s;var o=[{name:'ФильтрОтправитель',default:[]},{name:'Проект',default:null},{name:'ФильтрПоВехе',default:[]},{name:'ИдРегламента',default:[]}],i=[{name:'ПапкаДокументов',default:'',resetValue:null}];return e.movementsControllerOptions={taskHier:{excludedFilters:o,includedFilters:i,componentName:'taskHierBrowser',browserName:'MyTasks',filterRetriever:n.taskHierFilterRetriever,injectableFilters:{'ФильтрацияПоСчетчику':null},itemDataRetriever:n.extractTaskHierItemsDataForFilters,reloadAfterFilterChange:true,filterForNotReloadControl:'ФильтрацияПоСчетчику',resetOnRequest:true},groups:{excludedFilters:i,includedFilters:o,componentName:'FTasksGroupByType',browserName:'MyTasks',filterRetriever:n.groupsFilterRetriever,injectableFilters:{'ФильтрацияПоСчетчику':true},itemDataRetriever:n.extractGroupsItemsDataForFilters,filterForNotReloadControl:'ФильтрацияПоСчетчику',slaveControl:true,getDataForMovingMarkerFromFilterButton:n.extractDataFromChangedGroupsFilters}},e;}});return l;});
define("tmpl!SBIS3.EDO.FTasks/FTasks",["Core/tmpl/js/tclosure","js!SBIS3.EDO.BrowserWrapperPP","js!SBIS3.EDO2.OpenDialogAction","js!SBIS3.EDO.FEdoPartialReloader"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.EDO.BrowserWrapperPP"]=e[1],r["js!SBIS3.EDO2.OpenDialogAction"]=e[2],r["js!SBIS3.EDO.FEdoPartialReloader"]=e[3];var o=function e(o,a,s,i,l){function n(){}var d=0,c=void 0!==t&&t?t:arguments[arguments.length-1];void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure"));var m={};l&&l.isSetts&&(m=l.fullContext||{});var p="string"==typeof s?s:"",g=void 0===r?void 0:r,u={id:[],def:void 0},h=c.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),S=this&&this.includedTemplates?this.includedTemplates:{},y=c.getMarkupGenerator(i);try{var f=y.joinElements([y.createTag("div",{class:"edo-FTasks"},[y.createControl("wsControl","ws:SBIS3.EDO.BrowserWrapperPP",{browserOptions:{columns:[{cellTemplate:"tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TMainColumn",className:"controls-DataGridView-cell-overflow-ellipsis",templateBinding:{photoFldName:"userPhotoData",cssClass:"person-photo-mini-large",complexKeyField:"@Документ",complexKeySubtaskField:"Подзадача",personId:"firstIspPerson",photoId:"firstIspPhoto",photoKey:"photoKeyIsp"}},{cellTemplate:"tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TStateColumn",className:"column_caption_left",fixedSize:!0,width:130,templateBinding:{showRule:!1,showPhaseExecutor:!0,stateWidth:"125"},includedTemplates:{edoStateColumn:"tmpl!SBIS3.EDO2.Browser/resources/columns/tmpl/StateColumn"},title:global.rk("Состояние")},{cellTemplate:"tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TDateInsideColumn",includedTemplates:{DateCol:"tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TDateColumn"},templateBinding:{only_date:!0,tasks:!0},className:"column_caption_right",fixedSize:!0,width:45,title:global.rk("Дата")},{cellTemplate:"tmpl!SBIS3.EDO2.Browser/resources/columns/tmpl/ResponsibleColumn",fixedSize:!0,className:"col_resp_pattern column_caption_left",width:140,title:global.rk("Ответственный")}],itemsActionsVisibility:c.getter(o,["itemsActionsVisibility"]),massActionsVisibility:c.getter(o,["massActionsVisibility"]),massActionsSettings:c.getter(o,["massActionsSettings"]),className:"edo-FTasks__view controls-TreeDataGridView__withPhoto",stickyHeader:!0,hasSeparator:!1,allowToggleHead:!1,emptyHTML:global.rk("Нет задач"),idProperty:"@Документ",bind:"browser.filter",showHead:!0,ladder:["docFacePhoto","docDate"],common:{objectName:"СлужЗап",method:"СписокВнутренних",destroyMethod:"Удалить",filterParams:c.getter(o,["resultFilterParams"]),model:c.getter(o,["model"])||"TaskRegistryModel",firstRequest:!c.getter(o,["serverSideRendering"])&&(!c.getter(o,["firstRequestStatus"])||c.getter(o,["firstRequestStatus"]))},handlers:c.getter(o,["handlers"]),viewMode:"table",hierarchy:{allow:!0,parentProperty:"Раздел",displayProperty:"Название"},itemsActions:c.getter(o,["itemsActions"]),ignoreFiltersList:c.getter(o,["ignoreFiltersList"])},name:"Tasks",tasksExists:c.getter(o,["tasksExists"]),foldersExists:c.getter(o,["foldersExists"]),historyId:c.getter(o,["historyId"])||"TasksList",backButtonEditing:!0,useScope:!0,task1174428326:!0,tapeReestr:c.getter(o,["tapeReestr"]),tapeContent:c.getter(o,["tapeContent"]),serverSideRendering:c.getter(o,["serverSideRendering"]),operationsPanelConfig:c.getter(o,["operationsPanelConfig"]),filterButtonConfig:c.getter(o,["filterButtonConfig"]),fastDataFilterConfig:c.getter(o,["fastDataFilterConfig"]),esc:!1},{class:"Tasks controls-Browser__hide-path",name:"Tasks",sbisname:"Tasks"},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:h,internal:{__dirtyCheckingVars_14:c.getter(o,["itemsActionsVisibility"]),__dirtyCheckingVars_15:c.getter(o,["massActionsVisibility"]),__dirtyCheckingVars_16:c.getter(o,["massActionsSettings"]),__dirtyCheckingVars_23:{objectName:"СлужЗап",method:"СписокВнутренних",destroyMethod:"Удалить",filterParams:c.getter(o,["resultFilterParams"]),model:c.getter(o,["model"])||"TaskRegistryModel",firstRequest:!c.getter(o,["serverSideRendering"])&&(!c.getter(o,["firstRequestStatus"])||c.getter(o,["firstRequestStatus"]))},__dirtyCheckingVars_24:c.getter(o,["handlers"]),__dirtyCheckingVars_26:c.getter(o,["itemsActions"]),__dirtyCheckingVars_27:c.getter(o,["ignoreFiltersList"])}},s,g,S,c.config,m),y.createControl("wsControl","ws:SBIS3.EDO2.OpenDialogAction",{name:"TasksAction",editMode:"newFloatArea",objectName:"СлужЗап"},{name:"TasksAction",sbisname:"TasksAction"},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:h},s,g,S,c.config,m),y.createControl("wsControl","ws:SBIS3.EDO.FEdoPartialReloader",{actionEventsToListen:["onUpdateModel",c.getter(o,["partialReloader","onDestroyModelHandlingEnable"])?"onDestroyModel":"",c.getter(o,["partialReloader","onCreateModelHandlingEnable"])?"onCreateModel":""],name:"PartialReloader",objectName:c.getter(o,["objectName"])||"СлужЗап",method:c.getter(o,["method"])||"СписокВнутренних",filterName:c.getter(o,["partialReloader","filterName"])||"СписокИдО",sortField:c.getter(o,["partialReloader","sortField"])||"Дата",overrideItemsSortMethod:!0,updateOnDeleteAndAdd:c.getter(o,["partialReloader","updateOnDeleteAndAdd"])||!1,addServerChannelName:c.getter(o,["partialReloader","addServerChannelName"])||"",fixServerChannelName:c.getter(o,["partialReloader","fixServerChannelName"])||"",deleteServerChannelName:c.getter(o,["partialReloader","deleteServerChannelName"])||"",edoOpenDialogAction:"TasksAction",complexKeyField:"@Документ",updateAccordeonCountersEventName:"",esc:!1},{name:"PartialReloader",sbisname:"PartialReloader"},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:h,internal:{__dirtyCheckingVars_0:c.getter(o,["partialReloader","onDestroyModelHandlingEnable"])?"onDestroyModel":"",__dirtyCheckingVars_1:c.getter(o,["partialReloader","onCreateModelHandlingEnable"])?"onCreateModel":""}},s,g,S,c.config,m)],a,u,this)],p,u);u.def&&(f=y.chain(f,u,a),u=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/FTasks/FTasks.tmpl",e,o)}return f||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FTasks/FTasks"}},o});
define("tmpl!SBIS3.EDO.FTaskTabs/resources/FTasksCol",["Core/tmpl/js/tclosure"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],s={},r=function e(r,a,i,l,n){function o(){}var c=0,p=void 0!==t&&t?t:arguments[arguments.length-1];void 0===p&&(eval("var thelpers = null;"),p=global.requirejs("View/Runner/tclosure"));var u={};n&&n.isSetts&&(u=n.fullContext||{});var d="string"==typeof i?i:"",T=void 0===s?void 0:s,f={id:[],def:void 0},m=p.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,r),g=this&&this.includedTemplates?this.includedTemplates:{},v=p.getMarkupGenerator(l);try{var h=v.joinElements([v.createTag("div",{class:"controls-DataGridView__overflow-ellipsis"},["0"===p.getter(r,["item","UUID"])?[v.createTag("span",{class:""+p.wrapUndef(p.utils.escape("tasksAllTypes")),title:""+p.wrapUndef(p.utils.escape(p.getter(r,["item","Название"])))},[v.createText(""+p.wrapUndef(p.utils.escape(p.getter(r,["item","Название"]))))],{},f,this)]:[v.createTag("span",{class:""+p.wrapUndef(p.utils.escape("TaskCol_title")),title:""+p.wrapUndef(p.utils.escape(p.getter(r,["item","Название"])))},[v.createText(""+p.wrapUndef(p.utils.escape(p.getter(r,["item","Название"]))))],{},f,this),v.createTag("span",{class:"tasks_count"},[p.getter(r,["item","Количество"])?[v.createTag("span",{class:"TaskGroupItem_all"},[v.createText(""+p.wrapUndef(p.utils.escape(p.getter(r,["item","Количество"]))))],{},f,this)]:v.createText("")],{},f,this)]],a,f,this)],d,f);f.def&&(h=v.chain(h,f,a),f=void 0)}catch(e){p.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/FTaskTabs/resources/FTasksCol.tmpl",e,r)}return h||""};return r.includedFunctions={},r.stable=!0,r.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FTaskTabs/resources/FTasksCol"}},r});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.FTasks", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".Tasks.edo-Browser .controls-Browser__view table.controls-DataGridView__table{table-layout:fixed}.edo-FTasks__view.afterLoad .controls-DataGridView__table{border-bottom:1px solid #f4f4f4}.Tasks .controls-ListView__item-type-hidden .controls-TreeView__expand{display:none}.Tasks .edo-tasks__fastDataFilter{margin-right:4px}.Tasks .controls-DataGridView__th.column_caption_left{text-align:left!important}.Tasks .controls-DataGridView__th.column_caption_right{text-align:right!important;padding-right:4px!important}.no-sc-height{height:auto!important}#container{min-height:100%}.Tasks .controls-TreeDataGridView .tasks_count{position:absolute;right:0;padding-right:6px;font-size:14px;z-index:10;background-size:cover;height:30px;padding-left:30px;color:#587ab0}.Tasks .TaskCol_title:after{padding:3px 6px;content:\"\\00a0\";box-sizing:content-box;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;position:absolute;width:74px;line-height:30px;right:0;text-align:right;background-size:100% 100%;background:-moz-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,1) 45%);background:-webkit-gradient(linear,left top,right top,color-stop(0,rgba(255,255,255,0)),color-stop(45%,rgba(255,255,255,1)));background:-webkit-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,1) 45%);background:-o-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,1) 45%);background:-ms-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,1) 45%);background:linear-gradient(to right,rgba(255,255,255,0) 0,rgba(255,255,255,1) 45%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#00ffffff', endColorstr='#ffffff', GradientType=1)}.Tasks .controls-ListView__hoveredItem .TaskCol_title:after{background:-moz-linear-gradient(left,rgba(255,255,255,0) 0,rgba(240,245,251,1) 45%);background:-webkit-gradient(linear,left top,right top,color-stop(0,rgba(255,255,255,0)),color-stop(45%,rgba(240,245,251,1)));background:-webkit-linear-gradient(left,rgba(255,255,255,0) 0,rgba(240,245,251,1) 45%);background:-o-linear-gradient(left,rgba(255,255,255,0) 0,rgba(240,245,251,1) 45%);background:-ms-linear-gradient(left,rgba(255,255,255,0) 0,rgba(240,245,251,1) 45%);background:linear-gradient(to right,rgba(255,255,255,0) 0,rgba(240,245,251,1) 45%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#00ffffff', endColorstr='#F0F5FB', GradientType=1)}.Tasks .controls-TreeDataGridView .controls-ListView__item__selected .tasks_count .TaskGroupItem_all,.Tasks .controls-TreeDataGridView .tasks_count .TaskGroupItem_all{padding-right:6px}.Tasks .controls-DataGridView__td.controls-DataGridView-cell-overflow-ellipsis .controls-TreeView__folderTitle{text-overflow:clip;width:90%}.Tasks .edo-BrowserWrapper__leftcol .controls-ListView__item-without-child .controls-DataGridView__td.controls-DataGridView-cell-overflow-ellipsis .controls-DataGridView__columnValue{padding-left:16px;font-size:15px;margin-right:25px}.Tasks .edo-BrowserWrapper__leftcol .controls-ListView__item-without-child .controls-DataGridView__td.controls-DataGridView-cell-overflow-ellipsis .controls-DataGridView__columnValue div{white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.Tasks .edo-BrowserWrapper__leftcol tr td .lvl1{margin-left:11px}.Tasks .edo-BrowserWrapper__leftcol tr:first-child td .lvl1{margin-left:-10px}.Tasks.hideTapeByFilter .edo-BrowserWrapper__leftcol{display:none}.Tasks.hideTapeByFilter .edo-BrowserWrapper__rightcol{padding-left:0;width:100%;margin-left:0}.Tasks .edo-BrowserWrapper__leftcol .controls-DataGridView .controls-DataGridView__table .controls-ListView__item__selected .controls-DataGridView__td{border-bottom:1px solid #f4f4f4;border-top:1px solid #f4f4f4;border-right:1px solid #fff}.Tasks .edo-BrowserWrapper__leftcol .controls-DataGridView .controls-DataGridView__table tr:first-child .lvl1:before{content:''}.Tasks.hideTapeByFilter .edo-BrowserWrapper__vertical-separator{display:none}.edo-TasksSidebar.controls-DataGridView .controls-DataGridView__table .controls-DataGridView__td{border-right:1px solid #f4f4f4}.edo-FTasks__view .edo-Browser-Responsible--without-photo{top:-2px}.edo-FTasks__view .edo-Browser-State__active-phase-text.edo-Browser__first-base-line{top:-2px}.edo-FTasks__view .edo-Browser-State__wrapper.ws-hidden~.edo-Browser-State__executor{top:-2px;position:relative}.edo-FTasks__view .edo-Browser-State__active-phase-pause-icon{top:-2px;position:relative}.edo-FTasks__view .edo-Browser-State__active-phase-text.edo-Browser__second-base-line{position:relative;top:-2px}"));head.appendChild(style);});}
define('js!SBIS3.EDO.FTasks',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FTasks/FTasks','js!SBIS3.EDO.Modificators','js!SBIS3.EDO.Modificators.Tasks.List','js!SBIS3.EDO.EdoRecOptions','js!SBIS3.EDO.EdoClicks','js!SBIS3.EDO.FTasksHandlers','Core/EventBus','js!SBIS3.EDO.BrowserWrapperPP','js!SBIS3.EDO2.OpenDialogAction','js!SBIS3.EDO.FEdoPartialReloader','js!SBIS3.EDO.TaskRegistryModel','tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TMainColumn','tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TStateColumn','tmpl!SBIS3.EDO2.Browser/resources/columns/tmpl/StateColumn','tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TDocDateColumn','tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TDateColumn','tmpl!SBIS3.EDO2.Browser/resources/columns/tmpl/ResponsibleColumn','tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TDateInsideColumn','tmpl!SBIS3.EDO.FTaskTabs/resources/FTasksCol','css!SBIS3.EDO.FTasks','css!SBIS3.EDO.TaskCol','i18n!SBIS3.EDO.FTasks','Elektronnyj_dokumentooborot_localization'],function(e,s,t,o,r,i,n,a){'use strict';var l=e.extend({_dotTplFn:s,$protected:{_options:{listData:null,itemsActionsVisibility:{edoSaveDocumentOnDisk:false,edoSendDocument:false,edoShowDkPanel:false,edoPostDocument:false},massActionsVisibility:{edoSetCloseStatusMass:false,edoPostsMass:false,edoShowRegistryHistory:true},defaultFilterParams:{'ПростыеВД':true,'РассчитатьФото':true,'ВключитьСписокИсполнителей':true},ignoreFiltersList:['ПапкаДокументов','ФильтрПриоритет','ФильтрУдаленные','ФильтрЛицо1','ФильтрВладелец','ФильтрИсполнительСобытия','ФильтрКонкретныйИсполнитель','ФильтрКонкретныйИсполнительID'],massActionsSettings:{edoPrintDocumentMass:{recursive:false,minPrintWindowWidth:666,handlers:{onApplyOperation:n.setPrintColumns},items:[]},edoShowRegistryHistory:{objectHistoryName:'СлужЗап'},edoRestoreDocumentMass:{isVisible:n.isVisibleEdoRestoreDocumentMass}},resultFilterParams:{},tasksExists:true,foldersExists:true}},init:function(){l.superclass.init.call(this);var e=this,s=this.getChildControlByName('browserFastDataFilter'),t=e.hasChildControlByName('taskHierBrowser')?e.getChildControlByName('taskHierBrowser'):null;if(s)s.setItems(this._options.fastDataFilterConfig.data);if(t)t.setSelectedIndex(0),t.subscribeTo(a.channel('edopartialreloader'),'onItemsCountChange',function(){var e=t.getSelectedItem(),s=e.get('Раздел')||e.get('UUID');t.reloadItem(s,null,'inside');});e.getChildControlByName('Tasks').getView().subscribe('onItemsReady',function(){this.setSelectedIndex(0);});},_modifyOptions:function(){var e=l.superclass._modifyOptions.apply(this,arguments),s;if(e.resultFilterParams=e.filterParams||e.defaultFilterParams,s=new t(new o(),e.resultFilterParams),e.handlers=this._getHandlers(e),e.itemsActions=s.getActions(),e.operationsPanelConfig=s.getMOPActions(),e.filterButtonConfig=s.getFilterButtonConfig(),e.fastDataFilterConfig=s.getFastDataFilterConfig(),'object'==typeof e.operationsPanelConfig)e.operationsPanelConfig.hasItemsMenu=true;return e;},_getHandlers:function(e){return{onItemClick:[i.clickDisp],onChangeHoveredItem:[r.onChangeHoveredItem],onReady:[function(e){this.subscribeOnceTo(this,'onDataLoad',function(e){this.getContainer().addClass('afterLoad');});}]};}});return l;});
define("tmpl!SBIS3.EDO.FTaskTabs/FTaskTabs",["Core/tmpl/js/tclosure","js!SBIS3.CONTROLS/Button","js!SBIS3.Engine.BrowserTabs","js!SBIS3.EDO.FTaskButtons","js!SBIS3.EDO.FTasks","js!SBIS3.CONTROLS/Tree/DataGridView","js!SBIS3.TASKS.MovementsController","js!SBIS3.EDO.StatTemplateNew"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.CONTROLS/Button"]=e[1],r["js!SBIS3.Engine.BrowserTabs"]=e[2],r["js!SBIS3.EDO.FTaskButtons"]=e[3],r["js!SBIS3.EDO.FTasks"]=e[4],r["js!SBIS3.CONTROLS/Tree/DataGridView"]=e[5],r["js!SBIS3.TASKS.MovementsController"]=e[6],r["js!SBIS3.EDO.StatTemplateNew"]=e[7];var o=function e(o,a,s,n,i){function l(){}var c=0,d=void 0!==t&&t?t:arguments[arguments.length-1];void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure"));var m={};i&&i.isSetts&&(m=i.fullContext||{});var p="string"==typeof s?s:"",u=void 0===r?void 0:r,v={id:[],def:void 0},g=d.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),k=this&&this.includedTemplates?this.includedTemplates:{},T=d.getMarkupGenerator(n);try{var C=T.joinElements([T.createTag("div",{class:"edo-FTasksTabs"},[T.createTag("span",{class:"ws-float-area__close-button-wrapper ws-sticky-header__block"},[T.createControl("wsControl","ws:SBIS3.CONTROLS/Button",{name:"кВыбрать",isRelative:!0,visible:!1,tabindex:5,width:"100%",height:"100%",imgAlign:"left",defaultButton:!0,caption:global.rk("Выбрать")},{class:"TaskListSelectBtn",name:"кВыбрать",sbisname:"кВыбрать"},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:g},s,u,k,d.config,m)],{},v,this),T.createControl("wsControl","ws:SBIS3.Engine.BrowserTabs",{tabsArea:[{content:d.createDataArray([(new function(){var e=Object.create(o),t=function e(t,r,o,a,s){if(void 0===o)var o=arguments[2];var n=0,i="content";if(void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure")),s&&s.isSetts)var l=s.fullContext||{};t=d.isolateScope(Object.create(this),t,i);var c="string"==typeof o?o:"",m={id:[],def:void 0},p=this&&this.includedTemplates?this.includedTemplates:{},v=d.getMarkupGenerator(a);try{var k=v.joinElements([v.createControl("wsControl","ws:SBIS3.EDO.FTaskButtons",{name:"TaskButtons",addDoc_name:"AddTask",showAddDoc:!0},d.plainMerge(r,{name:"TaskButtons",sbisname:"TaskButtons"}),{data:t,ctx:this,pName:void 0!==i?i:void 0,viewController:g},o,u,p,d.config,l)],c,m);m.def&&(k=v.chain(k,m,r),m=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/FTaskTabs/FTaskTabs.tmpl",e,t)}return k||""};this.func=d.makeFunctionSerializable(t,e)}).func]),id:"aGroup"}],mainArea:[{content:d.createDataArray([(new function(){var e=Object.create(o),t=function e(t,r,o,a,s){if(void 0===o)var o=arguments[2];var n=0,i="content";if(void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure")),s&&s.isSetts)var l=s.fullContext||{};t=d.isolateScope(Object.create(this),t,i);var c="string"==typeof o?o:"",m={id:[],def:void 0},p=this&&this.includedTemplates?this.includedTemplates:{},v=d.getMarkupGenerator(a);try{var k=v.joinElements([v.createControl("wsControl","ws:SBIS3.EDO.FTasks",{tapeContent:d.createDataArray([(new function(){var e=Object.create(t),r=function e(t,r,o,a,s){if(void 0===o)var o=arguments[2];var n=0,i="tapeContent";if(void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure")),s&&s.isSetts)var l=s.fullContext||{};t=d.isolateScope(Object.create(this),t,i);var c="string"==typeof o?o:"",m={id:[],def:void 0},p=this&&this.includedTemplates?this.includedTemplates:{},v=d.getMarkupGenerator(a);try{var k=v.joinElements([v.createControl("wsControl","ws:SBIS3.CONTROLS/Tree/DataGridView",{columns:[{cellTemplate:"tmpl!SBIS3.EDO.FTaskTabs/resources/FTasksCol",className:"controls-DataGridView-cell-overflow-ellipsis"}],dataSource:{options:{binding:{query:"ДокументыВОбработкеПоСостояниям"},endpoint:"СлужЗап"},module:"WS.Data/Source/SbisService"},handlers:{onNodeExpand:d.getTypeFunc("js!SBIS3.EDO.FTaskTabs:prototype.onNodeExpand",{}),onNodeCollapse:d.getTypeFunc("js!SBIS3.EDO.FTaskTabs:prototype.onNodeCollapse",{})},name:"taskHierBrowser",className:"controls-ListView__padding-XS edo-TasksSidebar",itemsDragNDrop:!1,allowEnterToFolder:!1,showHead:!1,showPaging:!1,scrollPaging:!1,idProperty:"UUID",displayProperty:"Название",parentProperty:"Раздел",itemsActions:!1,expand:!0,expandByItemClick:!1,partialyReload:!0,esc:!1},d.plainMerge(r,{name:"taskHierBrowser",sbisname:"taskHierBrowser"}),{data:t,ctx:this,pName:void 0!==i?i:void 0,viewController:g},o,u,p,d.config,l)],c,m);m.def&&(k=v.chain(k,m,r),m=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/FTaskTabs/FTaskTabs.tmpl",e,t)}return k||""};this.func=d.makeFunctionSerializable(r,e)}).func]),useStickyHeader:!0,useAutoRefresh:!0,tasksExists:d.getter(t,["tasksExists"]),foldersExists:d.getter(t,["foldersExists"]),tapeReestr:!0,dateColTemplate:"tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TDateInsideColumn",partialReloader:{onCreateModelHandlingEnable:!0,onDestroyModelHandlingEnable:!0},esc:!1},d.plainMerge(r,{}),{data:t,ctx:this,pName:void 0!==i?i:void 0,viewController:g},o,u,p,d.config,l)],c,m);m.def&&(k=v.chain(k,m,r),m=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/FTaskTabs/FTaskTabs.tmpl",e,t)}return k||""};this.func=d.makeFunctionSerializable(t,e)}).func,(new function(){var e=Object.create(o),t=function e(t,r,o,a,s){if(void 0===o)var o=arguments[2];var n=0,i="content";if(void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure")),s&&s.isSetts)var l=s.fullContext||{};t=d.isolateScope(Object.create(this),t,i);var c="string"==typeof o?o:"",m={id:[],def:void 0},p=this&&this.includedTemplates?this.includedTemplates:{},v=d.getMarkupGenerator(a);try{var k=v.joinElements([v.createControl("wsControl","ws:SBIS3.TASKS.MovementsController",{excludedFilters:d.getter(t,["movementsControllerOptions","taskHier","excludedFilters"]),includedFilters:d.getter(t,["movementsControllerOptions","taskHier","includedFilters"]),componentName:d.getter(t,["movementsControllerOptions","taskHier","componentName"]),browserName:d.getter(t,["movementsControllerOptions","taskHier","browserName"]),filterRetriever:d.getter(t,["movementsControllerOptions","taskHier","filterRetriever"]),onClickAdditionalFilter:d.getter(t,["movementsControllerOptions","taskHier","onClickAdditionalFilter"]),injectableFilters:d.getter(t,["movementsControllerOptions","taskHier","injectableFilters"]),onResetSearchHandler:d.getter(t,["movementsControllerOptions","taskHier","onResetSearchHandler"]),onStartSearchHandler:d.getter(t,["movementsControllerOptions","taskHier","onStartSearchHandler"]),reloadAfterFilterChange:d.getter(t,["movementsControllerOptions","taskHier","reloadAfterFilterChange"]),filterForNotReloadControl:d.getter(t,["movementsControllerOptions","taskHier","filterForNotReloadControl"]),fastDataFilter:d.getter(t,["movementsControllerOptions","taskHier","fastDataFilter"]),needMoveMarkerAfterFilterChanged:d.getter(t,["movementsControllerOptions","taskHier","needMoveMarkerAfterFilterChanged"]),getDataForMovingMarkerFromFilterButton:d.getter(t,["movementsControllerOptions","taskHier","getDataForMovingMarkerFromFilterButton"]),skipMovingMarketAtFilterChange:d.getter(t,["movementsControllerOptions","taskHier","skipMovingMarketAtFilterChange"]),resetOnRequest:d.getter(t,["movementsControllerOptions","taskHier","resetOnRequest"]),skipOnFirstItem:d.getter(t,["movementsControllerOptions","taskHier","skipOnFirstItem"]),slaveControl:d.getter(t,["movementsControllerOptions","taskHier","slaveControl"]),itemDataRetrieverAsync:d.getter(t,["movementsControllerOptions","taskHier","itemDataRetrieverAsync"])},d.plainMerge(r,{}),{data:t,ctx:this,pName:void 0!==i?i:void 0,viewController:g},o,u,p,d.config,l)],c,m);m.def&&(k=v.chain(k,m,r),m=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/FTaskTabs/FTaskTabs.tmpl",e,t)}return k||""};this.func=d.makeFunctionSerializable(t,e)}).func]),id:"ListGroup"},{content:d.createDataArray([(new function(){var e=Object.create(o),t=function e(t,r,o,a,s){if(void 0===o)var o=arguments[2];var n=0,i="content";if(void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure")),s&&s.isSetts)var l=s.fullContext||{};t=d.isolateScope(Object.create(this),t,i);var c="string"==typeof o?o:"",m={id:[],def:void 0},p=this&&this.includedTemplates?this.includedTemplates:{},v=d.getMarkupGenerator(a);try{var k=v.joinElements([d.getter(t,["onlyList"])?v.createText(""):[v.createTag("div",{class:"edo-StatisticsReport"},[v.createControl("wsControl","ws:SBIS3.EDO.StatTemplateNew",{customizeFilters:{FilterMarks:!0,FilterPriority:!1,FilterAuthorOrResponsible:!0,FilterResponsibleFace:!1,FilterRepeatStages:!0},name:"КомпонентСтатистики",StatTemplateName:"ШаблонСтатистики",statisticsType:"period",loadOnDemand:!1,docType:"СлужЗап",serverSideRendering:!1,esc:!1},{name:"КомпонентСтатистики",sbisname:"КомпонентСтатистики"},{data:t,ctx:this,pName:void 0!==i?i:void 0,viewController:g},o,u,p,d.config,l)],{},m,this)]],c,m);m.def&&(k=v.chain(k,m,r),m=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/FTaskTabs/FTaskTabs.tmpl",e,t)}return k||""};this.func=d.makeFunctionSerializable(t,e)}).func]),id:"StatGroup"},{content:d.createDataArray([(new function(){var e=Object.create(o),t=function e(t,r,o,a,s){if(void 0===o)var o=arguments[2];var n=0,i="content";if(void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure")),s&&s.isSetts)var l=s.fullContext||{};t=d.isolateScope(Object.create(this),t,i);var c="string"==typeof o?o:"",m={id:[],def:void 0},p=this&&this.includedTemplates?this.includedTemplates:{},v=d.getMarkupGenerator(a);try{var k=v.joinElements([d.getter(t,["onlyList"])?v.createText(""):[v.createTag("div",{class:"edo-StatisticsReport"},[v.createControl("wsControl","ws:SBIS3.EDO.StatTemplateNew",{customizeFilters:{FilterMarks:!0,FilterPriority:!1,FilterAuthorOrResponsible:!0,FilterResponsibleFace:!1},name:"КомпонентСтатистикиВОбработке",StatTemplateName:"ШаблонСтатистикиВОбработке",statisticsType:"current",loadOnDemand:!1,docType:"СлужЗап",listData:d.getter(t,["listData"]),serverSideRendering:d.getter(t,["serverSideRendering"]),esc:!1},{name:"КомпонентСтатистикиВОбработке",sbisname:"КомпонентСтатистикиВОбработке"},{data:t,ctx:this,pName:void 0!==i?i:void 0,viewController:g},o,u,p,d.config,l)],{},m,this)]],c,m);m.def&&(k=v.chain(k,m,r),m=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/FTaskTabs/FTaskTabs.tmpl",e,t)}return k||""};this.func=d.makeFunctionSerializable(t,e)}).func]),id:"ProcessGroup"}],tabs:[{id:"ProcessTab",title:global.rk("В обработке"),mainArea:"ProcessGroup"},{id:"StatTab",title:global.rk("Статистика"),mainArea:"StatGroup"},{id:"ListTab",mainArea:"ListGroup",tabsArea:"aGroup",title:global.rk("Список")}],handlers:{onTabChange:[d.getTypeFunc("js!SBIS3.EDO.FTaskTabs:prototype.onTabChange",{})],onTabAndMainLoaded:[d.getTypeFunc("js!SBIS3.EDO.FTaskTabs:prototype.onTabAndMainLoaded",{})]},name:"TaskTabs",stickyHeader:!0,operationsButtonVisibility:!1,defaultTab:d.getter(o,["onlyList"])?"ListTab":"ProcessTab",tabsName:"TaskInnerTabs",esc:!1},{class:"FTasksTabs",name:"TaskTabs",sbisname:"TaskTabs"},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:g,internal:{__dirtyCheckingVars_12:d.getter(o,["tasksExists"]),__dirtyCheckingVars_13:d.getter(o,["foldersExists"]),__dirtyCheckingVars_16:d.getter(o,["movementsControllerOptions","taskHier","excludedFilters"]),__dirtyCheckingVars_17:d.getter(o,["movementsControllerOptions","taskHier","includedFilters"]),__dirtyCheckingVars_18:d.getter(o,["movementsControllerOptions","taskHier","componentName"]),__dirtyCheckingVars_19:d.getter(o,["movementsControllerOptions","taskHier","browserName"]),__dirtyCheckingVars_20:d.getter(o,["movementsControllerOptions","taskHier","filterRetriever"]),__dirtyCheckingVars_21:d.getter(o,["movementsControllerOptions","taskHier","onClickAdditionalFilter"]),__dirtyCheckingVars_22:d.getter(o,["movementsControllerOptions","taskHier","injectableFilters"]),__dirtyCheckingVars_23:d.getter(o,["movementsControllerOptions","taskHier","onResetSearchHandler"]),__dirtyCheckingVars_24:d.getter(o,["movementsControllerOptions","taskHier","onStartSearchHandler"]),__dirtyCheckingVars_25:d.getter(o,["movementsControllerOptions","taskHier","reloadAfterFilterChange"]),__dirtyCheckingVars_26:d.getter(o,["movementsControllerOptions","taskHier","filterForNotReloadControl"]),__dirtyCheckingVars_27:d.getter(o,["movementsControllerOptions","taskHier","fastDataFilter"]),__dirtyCheckingVars_28:d.getter(o,["movementsControllerOptions","taskHier","needMoveMarkerAfterFilterChanged"]),__dirtyCheckingVars_29:d.getter(o,["movementsControllerOptions","taskHier","getDataForMovingMarkerFromFilterButton"]),__dirtyCheckingVars_30:d.getter(o,["movementsControllerOptions","taskHier","skipMovingMarketAtFilterChange"]),__dirtyCheckingVars_31:d.getter(o,["movementsControllerOptions","taskHier","resetOnRequest"]),__dirtyCheckingVars_32:d.getter(o,["movementsControllerOptions","taskHier","skipOnFirstItem"]),__dirtyCheckingVars_33:d.getter(o,["movementsControllerOptions","taskHier","slaveControl"]),__dirtyCheckingVars_34:d.getter(o,["movementsControllerOptions","taskHier","itemDataRetrieverAsync"]),__dirtyCheckingVars_42:!d.getter(o,["onlyList"]),__dirtyCheckingVars_48:d.getter(o,["listData"]),__dirtyCheckingVars_49:d.getter(o,["serverSideRendering"]),__dirtyCheckingVars_50:!d.getter(o,["onlyList"])}},s,u,k,d.config,m)],a,v,this)],p,v);v.def&&(C=T.chain(C,v,a),v=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/FTaskTabs/FTaskTabs.tmpl",e,o)}return C||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FTaskTabs/FTaskTabs"}},o});
define('js!SBIS3.EDO.FTaskTabs',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FTaskTabs/FTaskTabs','js!SBIS3.EDO.EdoCommon','js!SBIS3.TASKS.MovementsController.Handlers','WS.Data/Source/SbisService','js!SBIS3.EDO.FTasks','js!SBIS3.Engine.BrowserTabs','js!SBIS3.EDO.FTaskButtons','SBIS3.CONTROLS/Button','i18n!SBIS3.EDO.FTaskTabs','js!SBIS3.EDO.StatTemplateNew','SBIS3.CONTROLS/Tree/DataGridView','browser!js!SBIS3.EDO.EDONavigationHandlers','Elektronnyj_dokumentooborot_localization'],function(t,e,s,a,i){'use strict';var r=t.extend({_dotTplFn:e,$protected:{_options:{onlyList:false,listData:null,tasksExists:true,foldersExists:true}},$constructor:function(t){this._options.onlyList=t.onlyList||this._options.onlyList;},init:function(){r.superclass.init.call(this);},onTabAndMainLoaded:function(t,e){if('ListTab'==e)s.initTaskButtons({mainObject:this.getCurrentTabArea('main'),tabsObject:this.getCurrentTabArea('tabs'),btnDocName:'AddTask',brwName:'Tasks',actionName:'TasksAction',linkedEdoBrowser:['taskHierBrowser']}),this.getParent().setCursorTaskHier();},onNodeExpand:function(t,e){if(void 0===e)return;if(new i({endpoint:'СлужЗап'}).call('РегламентыВОбработкеПоСостояниям',{'ИдРегламента':e,'Развернуть':true}),this._options.expand)this.setExpand(false);},onNodeCollapse:function(t,e){if(void 0===e)return;if(new i({endpoint:'СлужЗап'}).call('РегламентыВОбработкеПоСостояниям',{'ИдРегламента':e,'Развернуть':false}),this._options.expand)this.setExpand(false);},onTabChange:function(t,e){var s=this;switch(e){case'StatTab':case'ProcessTab':s.setOperationsButtonVisibility(false);break;default:s.setOperationsButtonVisibility(true);}},setCursorTaskHier:function(){var t=this;if(t.getChildControlByName('Tasks')&&t.hasChildControlByName('taskHierBrowser')){var e=t.getChildControlByName('taskHierBrowser');e.setSelectedIndex(0),e.setExpand(true);}},_modifyOptions:function(){var t=r.superclass._modifyOptions.apply(this,arguments);t.tasksExists=true,t.foldersExists=true;var e=[{name:'ИдРегламента',default:null,checkField:'ФильтрИдФазы'},{name:'ФильтрИдФазы',default:null}],s={key:'ФильтрПоКраткомуСостоянию',value:'4',title:rk('В обработке')};return t.movementsControllerOptions={taskHier:{excludedFilters:[],includedFilters:e,componentName:'taskHierBrowser',browserName:'Tasks',filterRetriever:a.allTasksFilterRetriever,onClickAdditionalFilter:a.allTasksOnClickAdditionalFilter,itemDataRetrieverAsync:a.extractAllTasksItemsDataForFiltersAsync,reloadAfterFilterChange:false,skipMovingMarketAtFilterChange:false,fastDataFilter:s,needMoveMarkerAfterFilterChanged:true,getDataForMovingMarkerFromFilterButton:a.extractDataFromChangedAllTasksFilters,resetOnRequest:true,slaveControl:true,skipOnFirstItem:true}},t;}});return r;});
define("tmpl!SBIS3.EDO.FUnallocatedTasks/FUnallocatedTasks",["Core/tmpl/js/tclosure","js!SBIS3.EDO.BrowserWrapperPP","js!SBIS3.CONTROLS/Link","js!SBIS3.EDO2.OpenDialogAction","js!SBIS3.EDO.FEdoPartialReloader"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.EDO.BrowserWrapperPP"]=e[1],r["js!SBIS3.CONTROLS/Link"]=e[2],r["js!SBIS3.EDO2.OpenDialogAction"]=e[3],r["js!SBIS3.EDO.FEdoPartialReloader"]=e[4];var a=function e(a,o,i,s,n){function l(){}var d=0,c=void 0!==t&&t?t:arguments[arguments.length-1];void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure"));var m={};n&&n.isSetts&&(m=n.fullContext||{});var p="string"==typeof i?i:"",g=void 0===r?void 0:r,u={id:[],def:void 0},v=c.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,a),S=this&&this.includedTemplates?this.includedTemplates:{},h=c.getMarkupGenerator(s);try{var f=h.joinElements([h.createTag("div",{class:"edo-FUnallocatedTasks"},[h.createControl("wsControl","ws:SBIS3.EDO.BrowserWrapperPP",{browserOptions:{columns:[{headTemplate:c.createDataArray([(new function(){var e=Object.create(a),t=function e(t,r,a,o,i){if(void 0===a)var a=arguments[2];var s=0,n="headTemplate";if(void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure")),i&&i.isSetts)var l=i.fullContext||{};t=c.isolateScope(Object.create(this),t,n);var d="string"==typeof a?a:"",m={id:[],def:void 0},p=this&&this.includedTemplates?this.includedTemplates:{},u=c.getMarkupGenerator(o);try{var S=u.joinElements([u.createControl("wsControl","ws:SBIS3.CONTROLS/Link",{handlers:{onActivated:[c.getTypeFunc("js!SBIS3.EDO.EdoCommon:onTitleClickDate",{})]},name:"LinkDate",caption:global.rk("Заголовок@@Срок"),tooltip:global.rk("Заголовок@@Срок"),esc:!1},c.plainMerge(r,{class:"ctrFilterLinkDate",name:"LinkDate",sbisname:"LinkDate"}),{data:t,ctx:this,pName:void 0!==n?n:void 0,viewController:v},a,g,p,c.config,l)],d,m);m.def&&(S=u.chain(S,m,r),m=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/FUnallocatedTasks/FUnallocatedTasks.tmpl",e,t)}return S||""};this.func=c.makeFunctionSerializable(t,e)}).func]),cellTemplate:"tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TMainColumn",className:"controls-DataGridView-cell-overflow-ellipsis",templateBinding:{photoFldName:"userPhotoData",cssClass:"person-photo-mini-large",useFaceField:!0,personId:"Лицо",photoId:"PhotoId",needCommentPrevStage:!!c.getter(a,["isNeedCommentPrevStage"])}},{cellTemplate:"tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TStateColumn",templateBinding:{showRule:!1,stateWidth:125},includedTemplates:{edoStateColumn:"tmpl!SBIS3.EDO2.Browser/resources/columns/tmpl/StateColumn"},title:global.rk("Состояние"),width:130},{headTemplate:c.createDataArray([(new function(){var e=Object.create(a),t=function e(t,r,a,o,i){if(void 0===a)var a=arguments[2];var s=0,n="headTemplate";if(void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure")),i&&i.isSetts)var l=i.fullContext||{};t=c.isolateScope(Object.create(this),t,n);var d="string"==typeof a?a:"",m={id:[],def:void 0},p=this&&this.includedTemplates?this.includedTemplates:{},u=c.getMarkupGenerator(o);try{var S=u.joinElements([u.createControl("wsControl","ws:SBIS3.CONTROLS/Link",{handlers:{onActivated:[c.getTypeFunc("js!SBIS3.EDO.EdoCommon:onTitleClickReceived",{})]},name:"LinkReceived",caption:global.rk("Получено"),className:"link_received",esc:!1},c.plainMerge(r,{class:"ctrFilterLinkReceived",name:"LinkReceived",sbisname:"LinkReceived"}),{data:t,ctx:this,pName:void 0!==n?n:void 0,viewController:v},a,g,p,c.config,l)],d,m);m.def&&(S=u.chain(S,m,r),m=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/FUnallocatedTasks/FUnallocatedTasks.tmpl",e,t)}return S||""};this.func=c.makeFunctionSerializable(t,e)}).func]),cellTemplate:"tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TDocDateColumn",title:global.rk("Получено"),templateBinding:{date_field:"Начало"},includedTemplates:{DateCol:"tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TDateColumn"},width:90,className:"event_date"}],itemsActionsVisibility:c.getter(a,["itemsActionsVisibility"]),massActionsVisibility:c.getter(a,["massActionsVisibility"]),massActionsSettings:c.getter(a,["massActionsSettings"]),allowToggleHead:!1,allowEmptySelection:!1,className:"edo-NeraspTasks__view controls-TreeDataGridView__withPhoto",stickyHeader:!0,hasSeparator:!1,idProperty:"@СвязьПапок",bind:"browser.filter",showHead:!0,ladder:["face_foto","date_col"],hierarchy:{allow:!0,parentProperty:"ПапкаДокументов",displayProperty:"Название"},handlers:c.getter(a,["handlers"]),emptyHTML:global.rk("Нет задач"),itemsActions:c.getter(a,["itemsActions"]),viewMode:"table",common:{navigationType:"Offset",objectName:"СвязьПапок",method:"ДокументыНерасп",destroyMethod:"Удалить",model:c.getter(a,["model"])||"TaskRegistryModel",filterParams:c.getter(a,["resultDefaultFilterParams"]),firstRequest:!c.getter(a,["serverSideRendering"])&&(!c.getter(a,["firstRequestStatus"])||c.getter(a,["firstRequestStatus"]))},navigation:{lastPage:!0}},name:"NeraspTasks",stickyHeader:!0,tapeReestr:c.getter(a,["tapeReestr"]),tapeContent:c.getter(a,["tapeContent"]),notHideTape:!0,historyId:"NeraspTasks",backButtonEditing:!1,ignoreFiltersList:c.getter(a,["ignoreFiltersList"]),listData:c.getter(a,["listData"]),tasksExists:c.getter(a,["tasksExists"]),foldersExists:c.getter(a,["foldersExists"]),filterButtonConfig:c.getter(a,["filterButtonConfig"]),serverSideRendering:c.getter(a,["serverSideRendering"]),operationsPanelConfig:c.getter(a,["operationsPanelConfig"]),esc:!1},{class:"NeraspTasks",name:"NeraspTasks",sbisname:"NeraspTasks"},{data:a,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:v,internal:{__dirtyCheckingVars_2:{photoFldName:"userPhotoData",cssClass:"person-photo-mini-large",useFaceField:!0,personId:"Лицо",photoId:"PhotoId",needCommentPrevStage:!!c.getter(a,["isNeedCommentPrevStage"])},__dirtyCheckingVars_12:c.getter(a,["itemsActionsVisibility"]),__dirtyCheckingVars_13:c.getter(a,["massActionsVisibility"]),__dirtyCheckingVars_14:c.getter(a,["massActionsSettings"]),__dirtyCheckingVars_22:c.getter(a,["handlers"]),__dirtyCheckingVars_24:c.getter(a,["itemsActions"]),__dirtyCheckingVars_25:{navigationType:"Offset",objectName:"СвязьПапок",method:"ДокументыНерасп",destroyMethod:"Удалить",model:c.getter(a,["model"])||"TaskRegistryModel",filterParams:c.getter(a,["resultDefaultFilterParams"]),firstRequest:!c.getter(a,["serverSideRendering"])&&(!c.getter(a,["firstRequestStatus"])||c.getter(a,["firstRequestStatus"]))}}},i,g,S,c.config,m),h.createControl("wsControl","ws:SBIS3.EDO2.OpenDialogAction",{tabindex:"0",name:"UnallocatedTasksAction",isEventsReestr:c.getter(a,["isEventsReestr"])},{name:"UnallocatedTasksAction",sbisname:"UnallocatedTasksAction"},{data:a,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:v},i,g,S,c.config,m),h.createControl("wsControl","ws:SBIS3.EDO.FEdoPartialReloader",{actionEventsToListen:["onUpdateModel",c.getter(a,["partialReloader","onDestroyModelHandlingEnable"])?"onDestroyModel":"",c.getter(a,["partialReloader","onCreateModelHandlingEnable"])?"onCreateModel":""],tabindex:"0",name:"PartialReloader",objectName:"СвязьПапок",method:"ДокументыНерасп",filterName:c.getter(a,["partialReloader","filterName"])||"СписокИдО",sortField:c.getter(a,["partialReloader","sortField"])||"ПорНомер",overrideItemsSortMethod:!0,updateOnDeleteAndAdd:c.getter(a,["partialReloader","updateOnDeleteAndAdd"])||!1,addServerChannelName:c.getter(a,["partialReloader","addServerChannelName"])||"",fixServerChannelName:c.getter(a,["partialReloader","fixServerChannelName"])||"",deleteServerChannelName:c.getter(a,["partialReloader","deleteServerChannelName"])||"",edoOpenDialogAction:"UnallocatedTasksAction",nameTaskHier:c.getter(a,["partialReloader","nameTaskHier"])||"",analyzeHierFieldOnTaskAdd:c.getter(a,["partialReloader","analyzeHierFieldOnTaskAdd"])?c.getter(a,["parentProperty"])||"ПапкаДокументов":"",forceUpdateAccordeonCountersOnDel:!0,esc:!1},{name:"PartialReloader",sbisname:"PartialReloader"},{data:a,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:v,internal:{__dirtyCheckingVars_0:c.getter(a,["partialReloader","onDestroyModelHandlingEnable"])?"onDestroyModel":"",__dirtyCheckingVars_1:c.getter(a,["partialReloader","onCreateModelHandlingEnable"])?"onCreateModel":""}},i,g,S,c.config,m)],o,u,this)],p,u);u.def&&(f=h.chain(f,u,o),u=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/FUnallocatedTasks/FUnallocatedTasks.tmpl",e,a)}return f||""};return a.includedFunctions={},a.stable=!0,a.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FUnallocatedTasks/FUnallocatedTasks"}},a});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.FUnallocatedTasks", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".NeraspTasks.edo-Browser .controls-Browser__view table.controls-DataGridView__table{table-layout:fixed}.NeraspTasks .controls-ListView__item-type-hidden .controls-TreeView__expand{display:none}.NeraspTasks .rt_subtasks{display:none}.link_received .controls-Link__field{margin-left:0}.ctrFilterLinkDate{float:right;color:#05b;font-size:12px;height:15px}.ctrFilterLinkReceived{color:#05b;font-size:12px;height:15px}.ctrFilterLinkDate .controls-Link__field{margin-left:0!important}.ws-is-firefox .ctrFilterLinkDate{height:17px}.ctrFilterLinkReceived .controls-Link__field{margin-left:0!important}.fieldStatusAlign{line-height:23px;padding-top:5px!important;padding-bottom:0!important}.NeraspTasks th .controls-Link,.NeraspTasks th div{line-height:normal;padding-left:4px}.NeraspTasks .edo-TaskHier{margin-top:33px}.edo-NeraspTasks__view th .controls-Link,.edo-NeraspTasks__view th div{line-height:normal;padding-left:4px}.edo-NeraspTasks__view .edo-Browser-State__active-phase-text.edo-Browser__first-base-line{top:-2px}.edo-NeraspTasks__view .edo-Browser-State__wrapper.ws-hidden~.edo-Browser-State__executor{top:-2px;position:relative}.edo-NeraspTasks__view .edo-Browser-State__active-phase-pause-icon{top:-2px;position:relative}.edo-NeraspTasks__view .edo-Browser-State__active-phase-text.edo-Browser__second-base-line{position:relative;top:-2px}"));head.appendChild(style);});}
define('js!SBIS3.EDO.FUnallocatedTasks',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FUnallocatedTasks/FUnallocatedTasks','js!SBIS3.EDO.Modificators','js!SBIS3.EDO.Modificators.Unallocated.List','js!SBIS3.EDO.EdoRecOptions','js!SBIS3.EDO.EdoClicks','js!SBIS3.EDO.EdoCommon','Core/EventBus','js!SBIS3.EDO.EdoCounters','js!SBIS3.EDO.FMyTasksHandlers','js!SBIS3.EDO.BrowserWrapperPP','js!SBIS3.EDO2.OpenDialogAction','js!SBIS3.EDO.FEdoPartialReloader','SBIS3.CONTROLS/Link','js!SBIS3.EDO.TaskRegistryModel','tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TMainColumn','tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TStateColumn','tmpl!SBIS3.EDO2.Browser/resources/columns/tmpl/StateColumn','tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TDocDateColumn','tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TDateColumn','css!SBIS3.EDO.FUnallocatedTasks','css!SBIS3.EDO.BrowserWrapperPP/resources/columnStyles','css!SBIS3.PersonCore.Photo','css!SBIS3.EDO.TaskCol','css!SBIS3.EDO.DateCol','i18n!SBIS3.EDO.FUnallocatedTasks','Elektronnyj_dokumentooborot_localization'],function(e,s,t,o,n,a,r,l,i,c){'use strict';var u=e.extend({_dotTplFn:s,$protected:{_options:{listData:null,defaultFilterParams:{'ПапкаДокументов':'','ПоказИерархии':true,'ПростыеВД':true,'РассчитатьФото':true,'ВключитьСписокИсполнителей':true},resultDefaultFilterParams:{},massActionsSettings:{edoPrintDocumentMass:{recursive:false,minPrintWindowWidth:666,handlers:{onApplyOperation:c.setPrintColumns},items:[],documentIdField:'@Документ'}},ignoreFiltersList:['ПапкаДокументов','ФильтрПриоритет','ПоказИерархии','ФильтрЛицо1','ВнешняяИерархия','СлужебныйКоличествоЗаписей','СлужебныйКоличествоПапок','ФильтрСписокРассылки','ФильтрВладелец'],itemsActionsVisibility:{edoSaveDocumentOnDisk:false,edoSendDocument:false,edoDeleteDocument:false,edoShowDkPanel:false,edoPostDocument:false,edoRestoreDocument:false},massActionsVisibility:{edoSetCloseStatusMass:false,edoPostsMass:false,edoDeleteDocumentMass:false,edoRestoreDocumentMass:false}}},$constructor:function(){},init:function(){u.superclass.init.call(this),this.subscribeTo(l.channel('EdoPartialReloader'),'updateAccCounters',function(e,s){if('onDeleteFromCollection'===s.description)i.updateCountersMain();}),this.getChildControlByName('NeraspTasks').getView().once('onItemsReady',function(){this.setSelectedIndex(0);});},_modifyOptions:function(){var e=u.superclass._modifyOptions.apply(this,arguments),s=null,n={};if(e.resultDefaultFilterParams=e.filterParams||e.defaultFilterParams,s=new t(new o()),e&&e.listData&&e.listData.filter)n=e.listData.filter;if(e.handlers=this._getHandlers(e),e.itemsActions=s.getActions(),e.operationsPanelConfig=s.getMOPActions(),e.filterButtonConfig=s.getFilterButtonConfig(n),'object'==typeof e.operationsPanelConfig)e.operationsPanelConfig.hasItemsMenu=true;return e;},_getHandlers:function(e){var s={onItemClick:[a.clickDisp],onBeforeProviderCall:[r.onBeforeDataLoadEvent],onChangeHoveredItem:[n.onChangeHoveredItem],onReady:[]};if(!e.tapeReestr)s.onReady.push(r.addRefreshCountersOnly);return s;}});return u;});
define("tmpl!SBIS3.EDO.FUnallocatedTasksTapeTab/FUnallocatedTasksTapeTab",["Core/tmpl/js/tclosure","js!SBIS3.CONTROLS/Link","js!SBIS3.Engine.BrowserTabs","js!SBIS3.EDO.FTaskButtons","js!SBIS3.EDO.FUnallocatedTasks","js!SBIS3.EDO.FTaskHier","js!SBIS3.TASKS.MovementsController"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.CONTROLS/Link"]=e[1],r["js!SBIS3.Engine.BrowserTabs"]=e[2],r["js!SBIS3.EDO.FTaskButtons"]=e[3],r["js!SBIS3.EDO.FUnallocatedTasks"]=e[4],r["js!SBIS3.EDO.FTaskHier"]=e[5],r["js!SBIS3.TASKS.MovementsController"]=e[6];var a=function e(a,s,o,n,i){function l(){}var d=0,c=void 0!==t&&t?t:arguments[arguments.length-1];void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure"));var m={};i&&i.isSetts&&(m=i.fullContext||{});var p="string"==typeof o?o:"",v=void 0===r?void 0:r,k={id:[],def:void 0},u=c.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,a),T=this&&this.includedTemplates?this.includedTemplates:{},g=c.getMarkupGenerator(n);try{var C=g.joinElements([g.createTag("div",{class:"TasksTapeTab"},[c.getter(a,["isFloatMode"])?[g.createTag("div",{class:"ws-float-area__close-button-wrapper",style:"height: 34px;"},[g.createControl("wsControl","ws:SBIS3.CONTROLS/Link",{name:"Нераспределенные",caption:global.rk("Разобрать"),href:"/fregistry.html?region_left=registry-UndistrServRec",className:"mytask_area_caption"},{name:"Нераспределенные",sbisname:"Нераспределенные"},{data:a,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:u},o,v,T,c.config,m)],{},k,this)]:g.createText(""),g.createControl("wsControl","ws:SBIS3.Engine.BrowserTabs",{tabsArea:[{content:c.createDataArray([(new function(){var e=Object.create(a),t=function e(t,r,a,s,o){if(void 0===a)var a=arguments[2];var n=0,i="content";if(void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure")),o&&o.isSetts)var l=o.fullContext||{};t=c.isolateScope(Object.create(this),t,i);var d="string"==typeof a?a:"",m={id:[],def:void 0},p=this&&this.includedTemplates?this.includedTemplates:{},k=c.getMarkupGenerator(s);try{var T=k.joinElements([k.createControl("wsControl","ws:SBIS3.EDO.FTaskButtons",{name:"TaskButtons",showAddDoc:!1,showAddFolder:!1},c.plainMerge(r,{name:"TaskButtons",sbisname:"TaskButtons"}),{data:t,ctx:this,pName:void 0!==i?i:void 0,viewController:u},a,v,p,c.config,l)],d,m);m.def&&(T=k.chain(T,m,r),m=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/FUnallocatedTasksTapeTab/FUnallocatedTasksTapeTab.tmpl",e,t)}return T||""};this.func=c.makeFunctionSerializable(t,e)}).func]),id:"listTabsArea"}],mainArea:[{content:c.createDataArray([(new function(){var e=Object.create(a),t=function e(t,r,a,s,o){if(void 0===a)var a=arguments[2];var n=0,i="content";if(void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure")),o&&o.isSetts)var l=o.fullContext||{};t=c.isolateScope(Object.create(this),t,i);var d="string"==typeof a?a:"",m={id:[],def:void 0},p=this&&this.includedTemplates?this.includedTemplates:{},k=c.getMarkupGenerator(s);try{var T=k.joinElements([k.createTag("div",{class:"tasksSale-browser"},[k.createControl("wsControl","ws:SBIS3.EDO.FUnallocatedTasks",{tapeContent:c.createDataArray([(new function(){var e=Object.create(t),r=function e(t,r,a,s,o){if(void 0===a)var a=arguments[2];var n=0,i="tapeContent";if(void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure")),o&&o.isSetts)var l=o.fullContext||{};t=c.isolateScope(Object.create(this),t,i);var d="string"==typeof a?a:"",m={id:[],def:void 0},p=this&&this.includedTemplates?this.includedTemplates:{},k=c.getMarkupGenerator(s);try{var T=k.joinElements([k.createControl("wsControl","ws:SBIS3.EDO.FTaskHier",{name:"Edo-TaskHier",queryMethod:"ДокументыНерасп",useItemActions:!1,allowEdit:!1,itemsDragNDrop:!1,noLoadOnInit:!1,useLightCounters:!0,foldersListData:c.getter(t,["foldersListData"]),onChangeHoveredItemTaskHier:"js!SBIS3.EDO.EdoRecOptions:onChangeHoveredItemHier",onItemsReady:"js!SBIS3.EDO.FUnallocatedTasksTapeTab:prototype.onItemsReady"},c.plainMerge(r,{name:"Edo-TaskHier",sbisname:"Edo-TaskHier"}),{data:t,ctx:this,pName:void 0!==i?i:void 0,viewController:u},a,v,p,c.config,l)],d,m);m.def&&(T=k.chain(T,m,r),m=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/FUnallocatedTasksTapeTab/FUnallocatedTasksTapeTab.tmpl",e,t)}return T||""};this.func=c.makeFunctionSerializable(r,e)}).func]),tapeReestr:!0,isEventsReestr:!0,useAutoRefresh:!0,listData:c.getter(t,["listData"]),tasksExists:c.getter(t,["tasksExists"]),foldersExists:c.getter(t,["foldersExists"]),serverSideRendering:c.getter(t,["serverSideRendering"]),personId:"Лицо",photoId:"PhotoId",partialReloader:{addServerChannelName:"edo.task-added",fixServerChannelName:"edo.task-fix",deleteServerChannelName:"edo.task-delete",onCreateModelHandlingEnable:!0,updateOnDeleteAndAdd:!0,nameTaskHier:"Edo-TaskHier",analyzeHierFieldOnTaskAdd:!0},filterParams:{"ПапкаДокументов":"","ПростыеВД":!0,"РассчитатьФото":!0,"ВнешняяИерархия":!0,"ПоказИерархии":!1,"ВключитьСписокИсполнителей":!0},esc:!1},{},{data:t,ctx:this,pName:void 0!==i?i:void 0,viewController:u,internal:{__dirtyCheckingVars_5:c.getter(t,["foldersListData"])}},a,v,p,c.config,l),k.createControl("wsControl","ws:SBIS3.TASKS.MovementsController",{excludedFilters:c.getter(t,["movementsControllerOptions","taskHier","excludedFilters"]),includedFilters:c.getter(t,["movementsControllerOptions","taskHier","includedFilters"]),componentName:c.getter(t,["movementsControllerOptions","taskHier","componentName"]),browserName:c.getter(t,["movementsControllerOptions","taskHier","browserName"]),filterRetriever:c.getter(t,["movementsControllerOptions","taskHier","filterRetriever"]),injectableFilters:c.getter(t,["movementsControllerOptions","taskHier","injectableFilters"]),onResetSearchHandler:c.getter(t,["movementsControllerOptions","taskHier","onResetSearchHandler"]),onStartSearchHandler:c.getter(t,["movementsControllerOptions","taskHier","onStartSearchHandler"]),reloadAfterFilterChange:c.getter(t,["movementsControllerOptions","taskHier","reloadAfterFilterChange"]),filterForNotReloadControl:c.getter(t,["movementsControllerOptions","taskHier","filterForNotReloadControl"]),resetOnRequest:c.getter(t,["movementsControllerOptions","taskHier","resetOnRequest"]),itemDataRetriever:c.getter(t,["movementsControllerOptions","taskHier","itemDataRetriever"])},{},{data:t,ctx:this,pName:void 0!==i?i:void 0,viewController:u},a,v,p,c.config,l)],r,m,this)],d,m);m.def&&(T=k.chain(T,m,r),m=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/FUnallocatedTasksTapeTab/FUnallocatedTasksTapeTab.tmpl",e,t)}return T||""};this.func=c.makeFunctionSerializable(t,e)}).func]),id:"listGroup"}],tabs:[{id:"listTab",mainArea:"listGroup",tabsArea:"listTabsArea",title:global.rk("Список"),visible:!1}],handlers:{onTabAndMainLoaded:[c.getTypeFunc("js!SBIS3.EDO.FUnallocatedTasksTapeTab:prototype.onTabAndMainLoaded",{})]},name:"BrowserTapeTabs",stickyHeader:!0,className:"NeraspTaskTapeTab",defaultTab:"listTab",esc:!1},{class:"TasksTapeTabBrowserTabs",name:"BrowserTapeTabs",sbisname:"BrowserTapeTabs"},{data:a,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:u,internal:{__dirtyCheckingVars_7:c.getter(a,["foldersListData"]),__dirtyCheckingVars_11:c.getter(a,["listData"]),__dirtyCheckingVars_12:c.getter(a,["tasksExists"]),__dirtyCheckingVars_13:c.getter(a,["foldersExists"]),__dirtyCheckingVars_14:c.getter(a,["serverSideRendering"]),__dirtyCheckingVars_17:c.getter(a,["movementsControllerOptions","taskHier","excludedFilters"]),__dirtyCheckingVars_18:c.getter(a,["movementsControllerOptions","taskHier","includedFilters"]),__dirtyCheckingVars_19:c.getter(a,["movementsControllerOptions","taskHier","componentName"]),__dirtyCheckingVars_20:c.getter(a,["movementsControllerOptions","taskHier","browserName"]),__dirtyCheckingVars_21:c.getter(a,["movementsControllerOptions","taskHier","filterRetriever"]),__dirtyCheckingVars_22:c.getter(a,["movementsControllerOptions","taskHier","injectableFilters"]),__dirtyCheckingVars_23:c.getter(a,["movementsControllerOptions","taskHier","onResetSearchHandler"]),__dirtyCheckingVars_24:c.getter(a,["movementsControllerOptions","taskHier","onStartSearchHandler"]),__dirtyCheckingVars_25:c.getter(a,["movementsControllerOptions","taskHier","reloadAfterFilterChange"]),__dirtyCheckingVars_26:c.getter(a,["movementsControllerOptions","taskHier","filterForNotReloadControl"]),__dirtyCheckingVars_27:c.getter(a,["movementsControllerOptions","taskHier","resetOnRequest"]),__dirtyCheckingVars_28:c.getter(a,["movementsControllerOptions","taskHier","itemDataRetriever"])}},o,v,T,c.config,m)],s,k,this)],p,k);k.def&&(C=g.chain(C,k,s),k=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/FUnallocatedTasksTapeTab/FUnallocatedTasksTapeTab.tmpl",e,a)}return C||""};return a.includedFunctions={},a.stable=!0,a.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FUnallocatedTasksTapeTab/FUnallocatedTasksTapeTab"}},a});
define('js!SBIS3.EDO.FUnallocatedTasksTapeTab',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FUnallocatedTasksTapeTab/FUnallocatedTasksTapeTab','js!SBIS3.EDO.EdoCommon','js!SBIS3.TASKS.MovementsController.Handlers','js!SBIS3.EDO.FTaskButtons','js!SBIS3.EDO.FTaskHier','js!SBIS3.Engine.BrowserTabs','js!SBIS3.EDO.FUnallocatedTasks','browser!js!SBIS3.EDO.EDONavigationHandlers','i18n!SBIS3.EDO.FUnallocatedTasksTapeTab','Elektronnyj_dokumentooborot_localization'],function(e,t,s,a){'use strict';var r=e.extend({_dotTplFn:t,$protected:{_options:{listData:null,tasksExists:true,foldersExists:true}},init:function(){r.superclass.init.call(this);var e='NeraspTasks';s.updateTaskHierAfterMassAction.call(this,e);},onTabAndMainLoaded:function(){s.initTaskButtons({mainObject:this.getCurrentTabArea('main'),tabsObject:this.getCurrentTabArea('tabs'),brwName:'NeraspTasks',actionName:'UnallocatedTasksAction',linkedEdoBrowser:['taskHierBrowser']});},onItemsReady:function(){this.setSelectedKey(this.getDataSet().at(0).getId());},_modifyOptions:function(){var e=r.superclass._modifyOptions.apply(this,arguments);e.tasksExists=!!(e.listData&&e.listData.items&&e.listData.items.getCount&&e.listData.items.getCount()>0),e.foldersExists=!!(e.foldersListData&&e.foldersListData.items&&e.foldersListData.items.getCount&&e.foldersListData.items.getCount()>0);var t=[{name:'ПапкаДокументов',default:null,resetValue:null}];return e.movementsControllerOptions={taskHier:{excludedFilters:[],includedFilters:t,componentName:'taskHierBrowser',browserName:'NeraspTasks',filterRetriever:a.taskHierFilterRetriever,injectableFilters:{'ФильтрацияПоСчетчику':null},itemDataRetriever:a.extractTaskHierItemsDataForFilters,onResetSearchHandler:a.resetTaskHierOnSearch,onStartSearchHandler:a.resetTaskHierOnSearch,reloadAfterFilterChange:true,filterForNotReloadControl:'ФильтрацияПоСчетчику',resetOnRequest:true}},e;}});return r;});
define("tmpl!SBIS3.EDO.FTasksMonitoring/FTasksMonitoring",["Core/tmpl/js/tclosure","js!SBIS3.EDO.BrowserWrapperPP","js!SBIS3.CONTROLS/Link","js!SBIS3.EDO2.OpenDialogAction","js!SBIS3.EDO.FolderDialogAction","js!SBIS3.EDO.FEdoPartialReloader"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.EDO.BrowserWrapperPP"]=e[1],r["js!SBIS3.CONTROLS/Link"]=e[2],r["js!SBIS3.EDO2.OpenDialogAction"]=e[3],r["js!SBIS3.EDO.FolderDialogAction"]=e[4],r["js!SBIS3.EDO.FEdoPartialReloader"]=e[5];var o=function e(o,a,i,n,l){function s(){}var d=0,c=void 0!==t&&t?t:arguments[arguments.length-1];void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure"));var p={};l&&l.isSetts&&(p=l.fullContext||{});var g="string"==typeof i?i:"",m=void 0===r?void 0:r,u={id:[],def:void 0},S=c.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),h=this&&this.includedTemplates?this.includedTemplates:{},C=c.getMarkupGenerator(n);try{var v=C.joinElements([C.createTag("div",{class:"edo-FTasksMonitoring"},[C.createControl("wsControl","ws:SBIS3.EDO.BrowserWrapperPP",{browserOptions:{columns:[{headTemplate:c.createDataArray([(new function(){var e=Object.create(o),t=function e(t,r,o,a,i){if(void 0===o)var o=arguments[2];var n=0,l="headTemplate";if(void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure")),i&&i.isSetts)var s=i.fullContext||{};t=c.isolateScope(Object.create(this),t,l);var d="string"==typeof o?o:"",p={id:[],def:void 0},g=this&&this.includedTemplates?this.includedTemplates:{},u=c.getMarkupGenerator(a);try{var h=u.joinElements([u.createControl("wsControl","ws:SBIS3.CONTROLS/Link",{handlers:{onActivated:[c.getTypeFunc("js!SBIS3.EDO.EdoCommon:onTitleClickDate",{})]},name:"LinkDate",caption:global.rk("Заголовок@@Срок"),tooltip:global.rk("Заголовок@@Срок"),esc:!1},c.plainMerge(r,{class:"ctrFilterLinkDate",name:"LinkDate",sbisname:"LinkDate"}),{data:t,ctx:this,pName:void 0!==l?l:void 0,viewController:S},o,m,g,c.config,s)],d,p);p.def&&(h=u.chain(h,p,r),p=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/FTasksMonitoring/FTasksMonitoring.tmpl",e,t)}return h||""};this.func=c.makeFunctionSerializable(t,e)}).func]),cellTemplate:"tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TMainColumn",className:"controls-DataGridView-cell-overflow-ellipsis date_th_ctrl",templateBinding:{photoFldName:"userPhotoData",cssClass:"person-photo-mini-large",personId:"firstIspPerson",photoId:"firstIspPhoto",photoKey:"photoKeyIsp"}},{title:global.rk("Состояние"),cellTemplate:"tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TStateColumn",fixedSize:"true",width:"125",templateBinding:{showRule:!1,showPhaseExecutor:!0,stateWidth:"121"},includedTemplates:{edoStateColumn:"tmpl!SBIS3.EDO2.Browser/resources/columns/tmpl/StateColumn"}},{headTemplate:c.createDataArray([(new function(){var e=Object.create(o),t=function e(t,r,o,a,i){if(void 0===o)var o=arguments[2];var n=0,l="headTemplate";if(void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure")),i&&i.isSetts)var s=i.fullContext||{};t=c.isolateScope(Object.create(this),t,l);var d="string"==typeof o?o:"",p={id:[],def:void 0},g=this&&this.includedTemplates?this.includedTemplates:{},u=c.getMarkupGenerator(a);try{var h=u.joinElements([u.createControl("wsControl","ws:SBIS3.CONTROLS/Link",{handlers:{onActivated:[c.getTypeFunc("js!SBIS3.EDO.EdoCommon:onTitleClickDateCreate",{})]},name:"LinkDateCreate",caption:global.rk("Дата"),esc:!1},c.plainMerge(r,{class:"ctrFilterDateCreate",name:"LinkDateCreate",sbisname:"LinkDateCreate"}),{data:t,ctx:this,pName:void 0!==l?l:void 0,viewController:S},o,m,g,c.config,s)],d,p);p.def&&(h=u.chain(h,p,r),p=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/FTasksMonitoring/FTasksMonitoring.tmpl",e,t)}return h||""};this.func=c.makeFunctionSerializable(t,e)}).func]),title:global.rk("Дата"),cellTemplate:"tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TDateMonColumn",includedTemplates:{DateCol:"tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TDateColumn"},templateBinding:{only_date:!0,date_field:"Документ.Дата"},className:"event_date_ctrl",fixedSize:!0,width:55},{title:global.rk("Ответственный"),cellTemplate:"tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TResponsibleColumn",includedTemplates:{edoResponsibleColumn:"tmpl!SBIS3.EDO2.Browser/resources/columns/tmpl/ResponsibleColumn"},fixedSize:!0,width:140}],itemsActionsVisibility:c.getter(o,["itemsActionsVisibility"]),massActionsVisibility:c.getter(o,["massActionsVisibility"]),massActionsSettings:c.getter(o,["massActionsSettings"]),allowEmptySelection:!1,allowToggleHead:!1,className:"edo-OnCtrl__view controls-TreeDataGridView__withPhoto",stickyHeader:!0,isFolderOnTop:!0,hasSeparator:!1,emptyHTML:global.rk("Нет задач"),showHead:!!c.getter(o,["showHead"])||"",idProperty:"@СвязьПапок",pageSize:21,ladder:["face_foto","date_col"],common:{navigationType:"Offset",objectName:c.getter(o,["objectName"])||"СвязьПапок",method:c.getter(o,["method"])||"ДокументыНаКонтроле",destroyMethod:"Удалить",model:c.getter(o,["model"])||"TaskRegistryModel",filterParams:c.getter(o,["resultDefaultFilterParams"]),firstRequest:!c.getter(o,["serverSideRendering"])&&(!c.getter(o,["firstRequestStatus"])||c.getter(o,["firstRequestStatus"]))},handlers:c.getter(o,["handlers"]),viewMode:"table",hierarchy:{allow:!!c.getter(o,["hierAllow"])||"",parentProperty:c.getter(o,["parentProperty"])||"ПапкаДокументов",displayProperty:c.getter(o,["displayProperty"])||"Название",arrowActivatedHandler:c.getter(o,["arrowActivatedHandler"])},bind:"browser.filter",itemsDragNDrop:void 0!==c.getter(o,["itemsDragNDrop"])?c.getter(o,["itemsDragNDrop"]):!!c.getter(o,["allowDragNDropMove"])||"",itemsActions:c.getter(o,["itemsActions"]),navigation:{lastPage:!0}},name:"OnCtrl",useScrollContainer:c.getter(o,["useScrollContainer"]),tapeReestr:c.getter(o,["tapeReestr"]),tapeContent:c.getter(o,["tapeContent"]),historyId:c.getter(o,["historyId"])?c.getter(o,["historyId"]):"OnCtrl",task1174428326:!0,backButtonEditing:!0,listData:c.getter(o,["listData"]),tasksExists:c.getter(o,["tasksExists"]),foldersExists:c.getter(o,["foldersExists"]),filterButtonConfig:c.getter(o,["filterButtonConfig"]),operationsPanelConfig:c.getter(o,["operationsPanelConfig"]),ignoreFiltersList:c.getter(o,["ignoreFiltersList"]),serverSideRendering:c.getter(o,["serverSideRendering"]),esc:!1},{class:"OnCtrl",name:"OnCtrl",sbisname:"OnCtrl"},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:S,internal:{__dirtyCheckingVars_16:c.getter(o,["itemsActionsVisibility"]),__dirtyCheckingVars_17:c.getter(o,["massActionsVisibility"]),__dirtyCheckingVars_18:c.getter(o,["massActionsSettings"]),__dirtyCheckingVars_25:!!c.getter(o,["showHead"])||"",__dirtyCheckingVars_28:{navigationType:"Offset",objectName:c.getter(o,["objectName"])||"СвязьПапок",method:c.getter(o,["method"])||"ДокументыНаКонтроле",destroyMethod:"Удалить",model:c.getter(o,["model"])||"TaskRegistryModel",filterParams:c.getter(o,["resultDefaultFilterParams"]),firstRequest:!c.getter(o,["serverSideRendering"])&&(!c.getter(o,["firstRequestStatus"])||c.getter(o,["firstRequestStatus"]))},__dirtyCheckingVars_29:c.getter(o,["handlers"]),__dirtyCheckingVars_30:{allow:!!c.getter(o,["hierAllow"])||"",parentProperty:c.getter(o,["parentProperty"])||"ПапкаДокументов",displayProperty:c.getter(o,["displayProperty"])||"Название",arrowActivatedHandler:c.getter(o,["arrowActivatedHandler"])},__dirtyCheckingVars_31:void 0!==c.getter(o,["itemsDragNDrop"])?c.getter(o,["itemsDragNDrop"]):!!c.getter(o,["allowDragNDropMove"])||"",__dirtyCheckingVars_32:c.getter(o,["itemsActions"])}},i,m,h,c.config,p),C.createControl("wsControl","ws:SBIS3.EDO2.OpenDialogAction",{name:"CtrlAction",tabindex:"0"},{name:"CtrlAction",sbisname:"CtrlAction"},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:S},i,m,h,c.config,p),C.createControl("wsControl","ws:SBIS3.EDO.FolderDialogAction",{name:"FolderAction",tabindex:"0"},{name:"FolderAction",sbisname:"FolderAction"},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:S},i,m,h,c.config,p),C.createControl("wsControl","ws:SBIS3.EDO.FEdoPartialReloader",{actionEventsToListen:["onUpdateModel",c.getter(o,["partialReloader","onDestroyModelHandlingEnable"])?"onDestroyModel":"",c.getter(o,["partialReloader","onCreateModelHandlingEnable"])?"onCreateModel":""],addToFilterFromRecordFields:["@СвязьПапок"],tabindex:"0",name:"PartialReloader",objectName:c.getter(o,["objectName"])||"СвязьПапок",method:c.getter(o,["method"])||"ДокументыНаКонтроле",filterName:c.getter(o,["partialReloader","filterName"])||"СписокИдО",sortField:c.getter(o,["partialReloader","sortField"])||"ПорНомер",overrideItemsSortMethod:!0,updateOnDeleteAndAdd:c.getter(o,["partialReloader","updateOnDeleteAndAdd"])||!1,addServerChannelName:c.getter(o,["partialReloader","addServerChannelName"])||"",fixServerChannelName:c.getter(o,["partialReloader","fixServerChannelName"])||"",deleteServerChannelName:c.getter(o,["partialReloader","deleteServerChannelName"])||"",edoOpenDialogAction:"CtrlAction",onRemoveFromControlHandling:!0,nameTaskHier:c.getter(o,["partialReloader","nameTaskHier"])||"",analyzeHierFieldOnTaskAdd:c.getter(o,["partialReloader","analyzeHierFieldOnTaskAdd"])?c.getter(o,["parentProperty"])||"ПапкаДокументов":"",forceUpdateAccordeonCountersOnDel:!0,forceUpdateAccordeonCountersOnAdd:!0,updateAccordeonCountersEventName:"",esc:!1},{name:"PartialReloader",sbisname:"PartialReloader"},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:S,internal:{__dirtyCheckingVars_0:c.getter(o,["partialReloader","onDestroyModelHandlingEnable"])?"onDestroyModel":"",__dirtyCheckingVars_1:c.getter(o,["partialReloader","onCreateModelHandlingEnable"])?"onCreateModel":""}},i,m,h,c.config,p)],a,u,this)],g,u);u.def&&(v=C.chain(v,u,a),u=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/FTasksMonitoring/FTasksMonitoring.tmpl",e,o)}return v||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FTasksMonitoring/FTasksMonitoring"}},o});
define('js!SBIS3.EDO.FTasksMonitoringHandlers',['i18n!SBIS3.EDO.FTasksMonitoringHandlers','Elektronnyj_dokumentooborot_localization'],function(){'use strict';var t;return t={setPrintColumns:function(t){t.setResult([{field:'Документ.Дата',title:rk('Дата')},{field:'Документ.Номер',title:rk('Номер')},{field:'РазличныеДокументы.Информация',title:rk('Описание')},{field:'РП.АктивнаяФаза',title:rk('Статус')},{field:'Сотрудник.Название',title:rk('Ответственный')}]);}};});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.FTasksMonitoring", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".OnCtrl.edo-Browser .controls-Browser__view table.controls-DataGridView__table{table-layout:fixed}.OnCtrl .controls-ListView__item-type-hidden .controls-TreeView__expand{display:none}.controls-DataGridView__thead .date_th_ctrl{vertical-align:top!important;text-align:right!important;padding-right:7px!important}.event_date_ctrl{vertical-align:top!important;text-align:right!important;padding-right:6px!important}.OnCtrl thead .state_and_phase div{padding-left:4px}.OnCtrl thead .col_resp_pattern div{padding-left:4px}.ctrFilterDateCreate{color:#05b;font-size:12px;height:15px}.ctrFilterDateCreate .controls-Link__field{margin-left:0!important}.ctrFilterLinkDate{float:right;color:#05b;font-size:12px;height:15px}.ctrFilterLinkDate .controls-Link__field{margin-left:0!important}.ws-is-firefox .ctrFilterLinkDate{height:17px}.edo-OnCtrl__view th .controls-Link,.edo-OnCtrl__view th div{line-height:normal;font-size:12px}.edo-OnCtrl__view .controls-DataGridView__th.date_th_ctrl>div{display:inline-block;float:right}.edo-OnCtrl__view .edo-Browser-Responsible--without-photo{top:-2px}.edo-OnCtrl__view .edo-Browser-State__active-phase-text.edo-Browser__first-base-line{top:-2px}.edo-OnCtrl__view .edo-Browser-State__wrapper.ws-hidden~.edo-Browser-State__executor{top:-2px;position:relative}.edo-OnCtrl__view .edo-Browser-State__active-phase-pause-icon{top:-2px;position:relative}.edo-OnCtrl__view .edo-Browser-State__active-phase-text.edo-Browser__second-base-line{position:relative;top:-2px}"));head.appendChild(style);});}
define('js!SBIS3.EDO.FTasksMonitoring',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FTasksMonitoring/FTasksMonitoring','js!SBIS3.EDO.Modificators','js!SBIS3.EDO.Modificators.OnCtrl.List','js!SBIS3.EDO.FTasksMonitoringHandlers','js!SBIS3.EDO.EdoCommon','js!SBIS3.EDO.EdoClicks','js!SBIS3.EDO.EdoRecOptions','SBIS3.CONTROLS/Action/List/InteractiveMove','js!SBIS3.EDO.TaskRegistryModel','js!SBIS3.EDO.BrowserWrapperPP','js!SBIS3.EDO2.OpenDialogAction','js!SBIS3.EDO.FolderDialogAction','js!SBIS3.EDO.FEdoPartialReloader','SBIS3.CONTROLS/Link','tmpl!SBIS3.EDO2.Browser/resources/columns/tmpl/StateColumn','tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TResponsibleColumn','tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TMainColumn','tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TStateColumn','tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TDocDateColumn','tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TDateColumn','tmpl!SBIS3.EDO2.Browser/resources/columns/tmpl/ResponsibleColumn','tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TResponsibleColumn','tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TDateMonColumn','css!SBIS3.EDO.FTasksMonitoring','css!SBIS3.EDO.BrowserWrapperPP/resources/columnStyles','css!SBIS3.EDO.TaskCol','i18n!SBIS3.EDO.FTasksMonitoring','Elektronnyj_dokumentooborot_localization'],function(e,o,t,s,r,n,i,a,l){'use strict';var u=e.extend({_dotTplFn:o,$protected:{_options:{listData:null,itemsActionsVisibility:{edoSaveDocumentOnDisk:false,edoSendDocument:false,edoDeleteDocument:false,edoShowMonitoringDialog:false,edoShowDkPanel:false,edoPostDocument:false,edoRestoreDocument:false,edoCopyDocument:false},massActionsVisibility:{edoSetCloseStatusMass:false,edoPostsMass:false,edoMoveDocumentMass:true},defaultFilterParams:{'ПапкаДокументов':'','ПростыеВД':true,'НаКонтроле':true,'РассчитатьФото':true,'ВключитьСписокИсполнителей':true,'ПапкаСкрытьНепрочитанные':true,'ПоказИерархии':true},resultDefaultFilterParams:{},hierAllow:true,massActionsSettings:{edoPrintDocumentMass:{recursive:false,minPrintWindowWidth:666,handlers:{onApplyOperation:r.setPrintColumns},items:[],documentIdField:'@Документ'},edoMoveDocumentMass:{filter:{'ПоказИерархии':true,'СписокДляПеремещения':true}}},ignoreFiltersList:['ПапкаДокументов','ФильтрПриоритет','ПоказИерархии','ВнешняяИерархия','ФильтрУдаленные','ФильтрИсполнительСобытия','ФильтрКонкретныйИсполнитель','ФильтрКонкретныйИсполнительID','ФильтрВладелец','ФильтрНезакрепленные']}},$constructor:function(){},destroy:function(){if(this.hasChildControlByName('browserView'))this.getChildControlByName('browserView')._options.interactiveMoveObject.destroy();u.superclass.destroy.apply(this,arguments);},init:function(){u.superclass.init.call(this);var e=this,o=this.hasChildControlByName('browserView')?this.getChildControlByName('browserView'):null;if(o.once('onItemsReady',function(){this.setSelectedIndex(0);}),e.subscribeTo(e.getChildControlByName('OnCtrl'),'onFinishCommand',function(e,t){if('edoDeleteDocument'==t.commandName)if(-1!==t.args[0].rowData.id.indexOf('Подзадача'))o.reload();}),o)o._options.interactiveMoveObject=new l({linkedObject:o,componentOptions:{filter:{'ПоказИерархии':true,'СписокДляПеремещения':true}}});},_modifyOptions:function(){var e=u.superclass._modifyOptions.apply(this,arguments),o=null,r={};if(e.resultDefaultFilterParams=e.filterParams||e.defaultFilterParams,o=new t(new s()),e&&e.listData&&e.listData.filter)r=e.listData.filter;if(e.handlers=this._getHandlers(e),e.itemsActions=o.getActions(),e.operationsPanelConfig=e.operationsPanelConfig||o.getMOPActions(),e.filterButtonConfig=o.getFilterButtonConfig(r),'object'==typeof e.operationsPanelConfig)e.operationsPanelConfig.hasItemsMenu=true;return e;},_getHandlers:function(e){var o={onReady:[e.addMoveStrategy||n.addMoveStrategy],onItemClick:[i.clickDisp],onBeforeProviderCall:[n.onBeforeDataLoadEvent],onChangeHoveredItem:[e.onChangeHoveredItemHandler||a.onChangeHoveredItemOnCtrl]};if(e.tapeReestr)o.onReady.push(n.setDataLoadHandler);return o;}});return u;});
define("tmpl!SBIS3.EDO.FTasksMonitoringTapeTab/FTasksMonitoringTapeTab",["Core/tmpl/js/tclosure","js!SBIS3.CONTROLS/Link","js!SBIS3.Engine.BrowserTabs","js!SBIS3.EDO.FTaskButtons","js!SBIS3.EDO.FTasksMonitoring","js!SBIS3.EDO.FTaskHier","js!SBIS3.EDO.FTasksGroupByType","js!SBIS3.TASKS.MovementsController"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.CONTROLS/Link"]=e[1],r["js!SBIS3.Engine.BrowserTabs"]=e[2],r["js!SBIS3.EDO.FTaskButtons"]=e[3],r["js!SBIS3.EDO.FTasksMonitoring"]=e[4],r["js!SBIS3.EDO.FTaskHier"]=e[5],r["js!SBIS3.EDO.FTasksGroupByType"]=e[6],r["js!SBIS3.TASKS.MovementsController"]=e[7];var o=function e(o,n,s,a,i){function l(){}var d=0,c=void 0!==t&&t?t:arguments[arguments.length-1];void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure"));var m={};i&&i.isSetts&&(m=i.fullContext||{});var p="string"==typeof s?s:"",g=void 0===r?void 0:r,u={id:[],def:void 0},v=c.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),C=this&&this.includedTemplates?this.includedTemplates:{},k=c.getMarkupGenerator(a);try{var T=k.joinElements([k.createTag("div",{class:"TasksTapeTab edo-FTasksMonitoringTapeTab"},[c.getter(o,["isFloatMode"])?[k.createTag("div",{class:"ws-float-area__close-button-wrapper",style:"height: 34px;"},[k.createControl("wsControl","ws:SBIS3.CONTROLS/Link",{name:"ЗадачиНаКонтроле",caption:global.rk("Задачи на контроле"),href:"/fregistry.html?region_left=registry-OnControl",className:"mytask_area_caption"},{name:"ЗадачиНаКонтроле",sbisname:"ЗадачиНаКонтроле"},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:v},s,g,C,c.config,m)],{},u,this)]:k.createText(""),k.createControl("wsControl","ws:SBIS3.Engine.BrowserTabs",{tabsArea:[{content:c.createDataArray([(new function(){var e=Object.create(o),t=function e(t,r,o,n,s){if(void 0===o)var o=arguments[2];var a=0,i="content";if(void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure")),s&&s.isSetts)var l=s.fullContext||{};t=c.isolateScope(Object.create(this),t,i);var d="string"==typeof o?o:"",m={id:[],def:void 0},p=this&&this.includedTemplates?this.includedTemplates:{},u=c.getMarkupGenerator(n);try{var C=u.joinElements([u.createControl("wsControl","ws:SBIS3.EDO.FTaskButtons",{name:"TaskButtons",addDoc_name:"AddTaskOnCtrl",showAddDoc:!0,showAddFolder:!0,createTaskTooltip:global.rk("Создать задачу"),createFolderTooltip:global.rk("Создать папку")},c.plainMerge(r,{name:"TaskButtons",sbisname:"TaskButtons"}),{data:t,ctx:this,pName:void 0!==i?i:void 0,viewController:v},o,g,p,c.config,l)],d,m);m.def&&(C=u.chain(C,m,r),m=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/FTasksMonitoringTapeTab/FTasksMonitoringTapeTab.tmpl",e,t)}return C||""};this.func=c.makeFunctionSerializable(t,e)}).func]),id:"aftGroup"}],mainArea:[{content:c.createDataArray([(new function(){var e=Object.create(o),t=function e(t,r,o,n,s){if(void 0===o)var o=arguments[2];var a=0,i="content";if(void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure")),s&&s.isSetts)var l=s.fullContext||{};t=c.isolateScope(Object.create(this),t,i);var d="string"==typeof o?o:"",m={id:[],def:void 0},p=this&&this.includedTemplates?this.includedTemplates:{},u=c.getMarkupGenerator(n);try{var C=u.joinElements([u.createTag("div",{class:"tasksSale-browser"},[u.createControl("wsControl","ws:SBIS3.EDO.FTasksMonitoring",{tapeContent:c.createDataArray([(new function(){var e=Object.create(t),r=function e(t,r,o,n,s){if(void 0===o)var o=arguments[2];var a=0,i="tapeContent";if(void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure")),s&&s.isSetts)var l=s.fullContext||{};t=c.isolateScope(Object.create(this),t,i);var d="string"==typeof o?o:"",m={id:[],def:void 0},p=this&&this.includedTemplates?this.includedTemplates:{},u=c.getMarkupGenerator(n);try{var C=u.joinElements([u.createControl("wsControl","ws:SBIS3.EDO.FTaskHier",{deleteUserFolderClick:c.getTypeFunc("js!SBIS3.EDO.EdoRecOptions:deleteUserFolderOnCtrl",{}),name:"Edo-TaskHier",edoBrowserName:"OnCtrl",queryMethod:"ДокументыНаКонтроле",foldersListData:c.getter(t,["foldersListData"]),onItemsReady:"js!SBIS3.EDO.FTasksMonitoringTapeTab:prototype.onItemsReady",esc:!1},c.plainMerge(r,{name:"Edo-TaskHier",sbisname:"Edo-TaskHier"}),{data:t,ctx:this,pName:void 0!==i?i:void 0,viewController:v},o,g,p,c.config,l)],d,m);m.def&&(C=u.chain(C,m,r),m=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/FTasksMonitoringTapeTab/FTasksMonitoringTapeTab.tmpl",e,t)}return C||""};this.func=c.makeFunctionSerializable(r,e)}).func,(new function(){var e=Object.create(t),r=function e(t,r,o,n,s){if(void 0===o)var o=arguments[2];var a=0,i="tapeContent";if(void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure")),s&&s.isSetts)var l=s.fullContext||{};t=c.isolateScope(Object.create(this),t,i);var d="string"==typeof o?o:"",m={id:[],def:void 0},p=this&&this.includedTemplates?this.includedTemplates:{},u=c.getMarkupGenerator(n);try{var C=u.joinElements([u.createControl("wsControl","ws:SBIS3.EDO.FTasksGroupByType",{name:"Edo-TasksGroupByType",filterParams:{"ИмяПапки":"НаКонтроле"},groupsListData:c.getter(t,["groupsListData"])},c.plainMerge(r,{name:"Edo-TasksGroupByType",sbisname:"Edo-TasksGroupByType"}),{data:t,ctx:this,pName:void 0!==i?i:void 0,viewController:v},o,g,p,c.config,l)],d,m);m.def&&(C=u.chain(C,m,r),m=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/FTasksMonitoringTapeTab/FTasksMonitoringTapeTab.tmpl",e,t)}return C||""};this.func=c.makeFunctionSerializable(r,e)}).func]),arrowActivatedHandler:c.getTypeFunc("js!SBIS3.EDO.EdoClicks:folderClick",{}),tapeReestr:!0,listData:c.getter(t,["listData"]),tasksExists:c.getter(t,["tasksExists"]),foldersExists:c.getter(t,["foldersExists"]),useAutoRefresh:!0,partialReloader:{onCreateModelHandlingEnable:!0,onDestroyModelHandlingEnable:!0,nameTaskHier:"Edo-TaskHier",analyzeHierFieldOnTaskAdd:!0},allowDragNDropMove:!0,filterParams:{"ПапкаДокументов":"","ПростыеВД":!0,"НаКонтроле":!0,"РассчитатьФото":!0,"ВключитьСписокИсполнителей":!0,"ПапкаСкрытьНепрочитанные":!0,"ПоказИерархии":!1,"ВнешняяИерархия":!0},showHead:!0,headTemplateDate:!0,headTemplateDateCreate:!0,hideClassResponsibleField:!0,serverSideRendering:c.getter(t,["serverSideRendering"]),esc:!1},{},{data:t,ctx:this,pName:void 0!==i?i:void 0,viewController:v,internal:{__dirtyCheckingVars_0:c.getter(t,["foldersListData"]),__dirtyCheckingVars_2:c.getter(t,["groupsListData"])}},o,g,p,c.config,l),u.createControl("wsControl","ws:SBIS3.TASKS.MovementsController",{excludedFilters:c.getter(t,["movementsControllerOptions","taskHier","excludedFilters"]),includedFilters:c.getter(t,["movementsControllerOptions","taskHier","includedFilters"]),componentName:c.getter(t,["movementsControllerOptions","taskHier","componentName"]),browserName:c.getter(t,["movementsControllerOptions","taskHier","browserName"]),filterRetriever:c.getter(t,["movementsControllerOptions","taskHier","filterRetriever"]),injectableFilters:c.getter(t,["movementsControllerOptions","taskHier","injectableFilters"]),onResetSearchHandler:c.getter(t,["movementsControllerOptions","taskHier","onResetSearchHandler"]),onStartSearchHandler:c.getter(t,["movementsControllerOptions","taskHier","onStartSearchHandler"]),reloadAfterFilterChange:c.getter(t,["movementsControllerOptions","taskHier","reloadAfterFilterChange"]),filterForNotReloadControl:c.getter(t,["movementsControllerOptions","taskHier","filterForNotReloadControl"]),resetOnRequest:c.getter(t,["movementsControllerOptions","taskHier","resetOnRequest"]),itemDataRetriever:c.getter(t,["movementsControllerOptions","taskHier","itemDataRetriever"])},{},{data:t,ctx:this,pName:void 0!==i?i:void 0,viewController:v},o,g,p,c.config,l),u.createControl("wsControl","ws:SBIS3.TASKS.MovementsController",{excludedFilters:c.getter(t,["movementsControllerOptions","groups","excludedFilters"]),includedFilters:c.getter(t,["movementsControllerOptions","groups","includedFilters"]),componentName:c.getter(t,["movementsControllerOptions","groups","componentName"]),browserName:c.getter(t,["movementsControllerOptions","groups","browserName"]),filterRetriever:c.getter(t,["movementsControllerOptions","groups","filterRetriever"]),injectableFilters:c.getter(t,["movementsControllerOptions","groups","injectableFilters"]),onResetSearchHandler:c.getter(t,["movementsControllerOptions","groups","onResetSearchHandler"]),onStartSearchHandler:c.getter(t,["movementsControllerOptions","groups","onStartSearchHandler"]),slaveControl:c.getter(t,["movementsControllerOptions","groups","slaveControl"]),getDataForMovingMarkerFromFilterButton:c.getter(t,["movementsControllerOptions","groups","getDataForMovingMarkerFromFilterButton"]),filterForNotReloadControl:c.getter(t,["movementsControllerOptions","groups","filterForNotReloadControl"]),itemDataRetriever:c.getter(t,["movementsControllerOptions","groups","itemDataRetriever"])},{},{data:t,ctx:this,pName:void 0!==i?i:void 0,viewController:v},o,g,p,c.config,l)],r,m,this)],d,m);m.def&&(C=u.chain(C,m,r),m=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/FTasksMonitoringTapeTab/FTasksMonitoringTapeTab.tmpl",e,t)}return C||""};this.func=c.makeFunctionSerializable(t,e)}).func]),id:"listGroup"}],tabs:[{id:"listTab",mainArea:"listGroup",tabsArea:"aftGroup",title:global.rk("Список"),visible:!1}],handlers:{onTabAndMainLoaded:[c.getTypeFunc("js!SBIS3.EDO.FTasksMonitoringTapeTab:prototype.onTabAndMainLoaded",{})]},name:"OnCtrlTaskTabs",stickyHeader:!0,defaultTab:"listTab",esc:!1},{class:"TasksTapeTabBrowserTabs",name:"OnCtrlTaskTabs",sbisname:"OnCtrlTaskTabs"},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:v,internal:{__dirtyCheckingVars_4:c.getter(o,["foldersListData"]),__dirtyCheckingVars_6:c.getter(o,["groupsListData"]),__dirtyCheckingVars_8:c.getter(o,["listData"]),__dirtyCheckingVars_9:c.getter(o,["tasksExists"]),__dirtyCheckingVars_10:c.getter(o,["foldersExists"]),__dirtyCheckingVars_19:c.getter(o,["serverSideRendering"]),__dirtyCheckingVars_20:c.getter(o,["movementsControllerOptions","taskHier","excludedFilters"]),__dirtyCheckingVars_21:c.getter(o,["movementsControllerOptions","taskHier","includedFilters"]),__dirtyCheckingVars_22:c.getter(o,["movementsControllerOptions","taskHier","componentName"]),__dirtyCheckingVars_23:c.getter(o,["movementsControllerOptions","taskHier","browserName"]),__dirtyCheckingVars_24:c.getter(o,["movementsControllerOptions","taskHier","filterRetriever"]),__dirtyCheckingVars_25:c.getter(o,["movementsControllerOptions","taskHier","injectableFilters"]),__dirtyCheckingVars_26:c.getter(o,["movementsControllerOptions","taskHier","onResetSearchHandler"]),__dirtyCheckingVars_27:c.getter(o,["movementsControllerOptions","taskHier","onStartSearchHandler"]),__dirtyCheckingVars_28:c.getter(o,["movementsControllerOptions","taskHier","reloadAfterFilterChange"]),__dirtyCheckingVars_29:c.getter(o,["movementsControllerOptions","taskHier","filterForNotReloadControl"]),__dirtyCheckingVars_30:c.getter(o,["movementsControllerOptions","taskHier","resetOnRequest"]),__dirtyCheckingVars_31:c.getter(o,["movementsControllerOptions","taskHier","itemDataRetriever"]),__dirtyCheckingVars_32:c.getter(o,["movementsControllerOptions","groups","excludedFilters"]),__dirtyCheckingVars_33:c.getter(o,["movementsControllerOptions","groups","includedFilters"]),__dirtyCheckingVars_34:c.getter(o,["movementsControllerOptions","groups","componentName"]),__dirtyCheckingVars_35:c.getter(o,["movementsControllerOptions","groups","browserName"]),__dirtyCheckingVars_36:c.getter(o,["movementsControllerOptions","groups","filterRetriever"]),__dirtyCheckingVars_37:c.getter(o,["movementsControllerOptions","groups","injectableFilters"]),__dirtyCheckingVars_38:c.getter(o,["movementsControllerOptions","groups","onResetSearchHandler"]),__dirtyCheckingVars_39:c.getter(o,["movementsControllerOptions","groups","onStartSearchHandler"]),__dirtyCheckingVars_40:c.getter(o,["movementsControllerOptions","groups","slaveControl"]),__dirtyCheckingVars_41:c.getter(o,["movementsControllerOptions","groups","getDataForMovingMarkerFromFilterButton"]),__dirtyCheckingVars_42:c.getter(o,["movementsControllerOptions","groups","filterForNotReloadControl"]),__dirtyCheckingVars_43:c.getter(o,["movementsControllerOptions","groups","itemDataRetriever"])}},s,g,C,c.config,m)],n,u,this)],p,u);u.def&&(T=k.chain(T,u,n),u=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/FTasksMonitoringTapeTab/FTasksMonitoringTapeTab.tmpl",e,o)}return T||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FTasksMonitoringTapeTab/FTasksMonitoringTapeTab"}},o});
define('js!SBIS3.EDO.FTasksMonitoringTapeTab',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FTasksMonitoringTapeTab/FTasksMonitoringTapeTab','js!SBIS3.EDO.EdoCommon','js!SBIS3.TASKS.MovementsController.Handlers','tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TDateMonColumn','js!SBIS3.Engine.BrowserTabs','js!SBIS3.EDO.FTasksMonitoring','js!SBIS3.EDO.FTaskButtons','js!SBIS3.EDO.FTaskHier','js!SBIS3.EDO.FTasksGroupByType','js!SBIS3.EDO.EdoClicks','i18n!SBIS3.EDO.FTasksMonitoringTapeTab','Elektronnyj_dokumentooborot_localization'],function(t,e,r,s){'use strict';var a=t.extend({_dotTplFn:e,$protected:{_options:{listData:null,tasksExists:true,foldersExists:true}},init:function(){a.superclass.init.call(this);var t='OnCtrl';r.updateTaskHierAfterMassAction.call(this,t);},onTabAndMainLoaded:function(){var t='Edo-TaskHier',e='Edo-TasksGroupByType',s='OnCtrl';r.initTaskButtons({mainObject:this.getCurrentTabArea('main'),tabsObject:this.getCurrentTabArea('tabs'),btnDocName:'AddTaskOnCtrl',brwName:'OnCtrl',actionName:'CtrlAction',folderButtonName:'btnAddFolder',rootFolderName:'На контроле',folderAction:'FolderAction',linkedEdoBrowser:['FTasksGroupByType','taskHierBrowser']});},onItemsReady:function(){this.setSelectedKey(this.getDataSet().at(0).getId());},_modifyOptions:function(){var t=a.superclass._modifyOptions.apply(this,arguments);t.tasksExists=!!(t.listData&&t.listData.items&&t.listData.items.getCount&&t.listData.items.getCount()>0),t.foldersExists=!!(t.foldersListData&&t.foldersListData.items&&t.foldersListData.items.getCount&&t.foldersListData.items.getCount()>1);var e=[{name:'ФильтрОтправитель',default:[]},{name:'ФильтрСписокРассылки',default:[]},{name:'Проект',default:null},{name:'ФильтрПоВехе',default:[]},{name:'ИдРегламента',default:[]}],r=[{name:'ПапкаДокументов',default:'',resetValue:null}];return t.movementsControllerOptions={taskHier:{excludedFilters:e,includedFilters:r,componentName:'taskHierBrowser',browserName:'OnCtrl',filterRetriever:s.taskHierFilterRetriever,injectableFilters:{'ФильтрацияПоСчетчику':null},itemDataRetriever:s.extractTaskHierItemsDataForFilters,reloadAfterFilterChange:true,filterForNotReloadControl:'ФильтрацияПоСчетчику',resetOnRequest:true},groups:{excludedFilters:r,includedFilters:e,componentName:'FTasksGroupByType',browserName:'OnCtrl',filterRetriever:s.groupsFilterRetriever,injectableFilters:{'ФильтрацияПоСчетчику':true},itemDataRetriever:s.extractGroupsItemsDataForFilters,filterForNotReloadControl:'ФильтрацияПоСчетчику',slaveControl:true,getDataForMovingMarkerFromFilterButton:s.extractDataFromChangedGroupsFilters}},t;}});return a;});
define("tmpl!SBIS3.EDO.FTasksFromMe/FTasksFromMe",["Core/tmpl/js/tclosure","js!SBIS3.CONTROLS/Link","js!SBIS3.EDO.BrowserWrapperPP","js!SBIS3.EDO2.OpenDialogAction","js!SBIS3.EDO.FolderDialogAction","js!SBIS3.EDO.FEdoPartialReloader"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.CONTROLS/Link"]=e[1],r["js!SBIS3.EDO.BrowserWrapperPP"]=e[2],r["js!SBIS3.EDO2.OpenDialogAction"]=e[3],r["js!SBIS3.EDO.FolderDialogAction"]=e[4],r["js!SBIS3.EDO.FEdoPartialReloader"]=e[5];var o=function e(o,a,i,s,n){function l(){}var d=0,c=void 0!==t&&t?t:arguments[arguments.length-1];void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure"));var g={};n&&n.isSetts&&(g=n.fullContext||{});var m="string"==typeof i?i:"",p=void 0===r?void 0:r,u={id:[],def:void 0},h=c.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),y=this&&this.includedTemplates?this.includedTemplates:{},C=c.getMarkupGenerator(s);try{var S=C.joinElements([C.createTag("div",{class:"edo-FTasksFromMe"},[c.getter(o,["isFloatMode"])?[C.createTag("div",{class:"ws-float-area__close-button-wrapper",style:"height: 34px;"},[C.createControl("wsControl","ws:SBIS3.CONTROLS/Link",{name:"TasksFromMeLink",caption:global.rk("Задачи от меня"),href:"/fregistry.html?region_left=registry-FromMe"},{class:"edo-FTasksFromMe_floatAreaLink",name:"TasksFromMeLink",sbisname:"TasksFromMeLink"},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:h},i,p,y,c.config,g)],{},u,this)]:C.createText(""),C.createControl("wsControl","ws:SBIS3.EDO.BrowserWrapperPP",{browserOptions:{columns:[{headTemplate:c.createDataArray([(new function(){var e=Object.create(o),t=function e(t,r,o,a,i){if(void 0===o)var o=arguments[2];var s=0,n="headTemplate";if(void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure")),i&&i.isSetts)var l=i.fullContext||{};t=c.isolateScope(Object.create(this),t,n);var d="string"==typeof o?o:"",g={id:[],def:void 0},m=this&&this.includedTemplates?this.includedTemplates:{},u=c.getMarkupGenerator(a);try{var y=u.joinElements([u.createControl("wsControl","ws:SBIS3.CONTROLS/Link",{handlers:{onActivated:[c.getTypeFunc("js!SBIS3.EDO.EdoCommon:onTitleClickDate",{})]},name:"LinkDate",caption:global.rk("Заголовок@@Срок"),tooltip:global.rk("Заголовок@@Срок"),esc:!1},c.plainMerge(r,{class:"ctrFilterLinkDate",name:"LinkDate",sbisname:"LinkDate"}),{data:t,ctx:this,pName:void 0!==n?n:void 0,viewController:h},o,p,m,c.config,l)],d,g);g.def&&(y=u.chain(y,g,r),g=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/FTasksFromMe/FTasksFromMe.tmpl",e,t)}return y||""};this.func=c.makeFunctionSerializable(t,e)}).func]),templateBinding:{cssClass:"person-photo-mini-large",personId:c.getter(o,["personId"])||"firstIspPerson",photoId:c.getter(o,["photoId"])||"firstIspPhoto",photoKey:c.getter(o,["photoKey"])||"photoKeyIsp",needCommentPrevStage:!!c.getter(o,["isNeedCommentPrevStage"])},title:global.rk("Заголовок@@Срок"),cellTemplate:c.getter(o,["descColTemplate"])||"tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TMainColumn",className:"controls-DataGridView-cell-overflow-ellipsis date_th"},{includedTemplates:{edoStateColumn:"tmpl!SBIS3.EDO2.Browser/resources/columns/tmpl/StateColumn",DateCol:"tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TDateColumn"},templateBinding:{dateHeadTemplate:c.createDataArray([(new function(){var e=Object.create(o),t=function e(t,r,o,a,i){if(void 0===o)var o=arguments[2];var s=0,n="dateHeadTemplate";if(void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure")),i&&i.isSetts)var l=i.fullContext||{};t=c.isolateScope(Object.create(this),t,n);var d="string"==typeof o?o:"",g={id:[],def:void 0},m=this&&this.includedTemplates?this.includedTemplates:{},u=c.getMarkupGenerator(a);try{var y=u.joinElements([u.createControl("wsControl","ws:SBIS3.CONTROLS/Link",{handlers:{onActivated:[c.getTypeFunc("js!SBIS3.EDO.EdoCommon:onTitleClickDateCreate",{})]},name:"LinkDateCreate",caption:global.rk("Дата"),tooltip:global.rk("Дата"),esc:!1},c.plainMerge(r,{class:"ctrFilterDateCreate",name:"LinkDateCreate",sbisname:"LinkDateCreate"}),{data:t,ctx:this,pName:void 0!==n?n:void 0,viewController:h},o,p,m,c.config,l)],d,g);g.def&&(y=u.chain(y,g,r),g=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/FTasksFromMe/FTasksFromMe.tmpl",e,t)}return y||""};this.func=c.makeFunctionSerializable(t,e)}).func]),showRule:!1,stateWidth:"164",date_field:"Документ.Дата",only_date:!0,tasks:!0,className:"event_date",fixedSize:!0,showPhaseExecutor:!0,dateCellTemplate:"tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TDocDateColumn",closedEventsBrowser:!!c.getter(o,["isExecuted"])||""},width:"164",headTemplate:"tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/THeadStateWithReceived",cellTemplate:"tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TStateWithReceivedColumn"}],common:{filterParams:c.getter(o,["resultFilterParams"]),firstRequest:!c.getter(o,["serverSideRendering"])&&(void 0===c.getter(o,["firstRequestStatus"])||c.getter(o,["firstRequestStatus"])),navigationType:"Offset",objectName:c.getter(o,["objectName"])||"СвязьПапок",method:c.getter(o,["method"])||"ДокументыОтМеня",destroyMethod:"Удалить",model:c.getter(o,["model"])||"TaskRegistryModel"},hierarchy:{allow:!!c.getter(o,["hierAllow"])||"",parentProperty:c.getter(o,["parentProperty"])||"ПапкаДокументов",displayProperty:c.getter(o,["displayProperty"])||"Название",arrowActivatedHandler:c.getter(o,["arrowActivatedHandler"])||void 0},itemsActionsVisibility:c.getter(o,["itemsActionsVisibility"]),massActionsVisibility:c.getter(o,["massActionsVisibility"]),massActionsSettings:c.getter(o,["massActionsSettings"]),itemsActions:c.getter(o,["itemsActions"]),allowToggleHead:!1,allowEmptySelection:!1,className:"edo-FromMe__view controls-TreeDataGridView__withPhoto",stickyHeader:!0,isFolderOnTop:!0,emptyHTML:global.rk("Нет задач"),hasSeparator:!1,idProperty:c.getter(o,["idProperty"])||"@СвязьПапок",bind:"browser.filter",showHead:!!c.getter(o,["showHead"])||"",ladder:["face_foto","date_col"],itemsDragNDrop:void 0!==c.getter(o,["itemsDragNDrop"])?c.getter(o,["itemsDragNDrop"]):!!c.getter(o,["allowDragNDropMove"])||"",handlers:c.getter(o,["handlers"]),viewMode:"table",pageSize:21,navigation:{lastPage:!0}},name:"FromMe",useScrollContainer:c.getter(o,["useScrollContainer"]),tapeReestr:c.getter(o,["tapeReestr"]),tapeContent:c.getter(o,["tapeContent"]),historyId:c.getter(o,["historyId"])?c.getter(o,["historyId"]):c.getter(o,["doNotUseHistoryId"])?"":"FromMe",backButtonEditing:!!c.getter(o,["backButtonEditing"])||"",isSingleTypeBrowser:!1,listData:c.getter(o,["listData"]),serverSideRendering:c.getter(o,["serverSideRendering"]),ignoreFiltersList:c.getter(o,["ignoreFiltersList"]),tasksExists:c.getter(o,["tasksExists"]),foldersExists:c.getter(o,["foldersExists"]),operationsPanelConfig:c.getter(o,["operationsPanelConfig"]),fastDataFilterConfig:c.getter(o,["fastDataFilterConfig"]),filterButtonConfig:c.getter(o,["filterButtonConfig"]),esc:!1},{class:c.utils.escape("edo-FTasksFromMe_BrowserWrapperPP "+c.getter(o,["additionalClass"])),name:"FromMe",sbisname:"FromMe"},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:h,internal:{__dirtyCheckingVars_2:c.getter(o,["personId"])||"firstIspPerson",__dirtyCheckingVars_3:c.getter(o,["photoId"])||"firstIspPhoto",__dirtyCheckingVars_4:c.getter(o,["photoKey"])||"photoKeyIsp",__dirtyCheckingVars_5:!!c.getter(o,["isNeedCommentPrevStage"]),__dirtyCheckingVars_7:c.getter(o,["descColTemplate"])||"tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TMainColumn",__dirtyCheckingVars_16:!!c.getter(o,["isExecuted"])||"",__dirtyCheckingVars_17:c.getter(o,["resultFilterParams"]),__dirtyCheckingVars_18:!c.getter(o,["serverSideRendering"])&&(void 0===c.getter(o,["firstRequestStatus"])||c.getter(o,["firstRequestStatus"])),__dirtyCheckingVars_19:c.getter(o,["objectName"])||"СвязьПапок",__dirtyCheckingVars_20:c.getter(o,["method"])||"ДокументыОтМеня",__dirtyCheckingVars_21:c.getter(o,["model"])||"TaskRegistryModel",__dirtyCheckingVars_22:!!c.getter(o,["hierAllow"])||"",__dirtyCheckingVars_23:c.getter(o,["parentProperty"])||"ПапкаДокументов",__dirtyCheckingVars_24:c.getter(o,["displayProperty"])||"Название",__dirtyCheckingVars_25:c.getter(o,["arrowActivatedHandler"])||void 0,__dirtyCheckingVars_26:c.getter(o,["itemsActionsVisibility"]),__dirtyCheckingVars_27:c.getter(o,["massActionsVisibility"]),__dirtyCheckingVars_28:c.getter(o,["massActionsSettings"]),__dirtyCheckingVars_29:c.getter(o,["itemsActions"]),__dirtyCheckingVars_36:c.getter(o,["idProperty"])||"@СвязьПапок",__dirtyCheckingVars_37:!!c.getter(o,["showHead"])||"",__dirtyCheckingVars_39:void 0!==c.getter(o,["itemsDragNDrop"])?c.getter(o,["itemsDragNDrop"]):!!c.getter(o,["allowDragNDropMove"])||"",__dirtyCheckingVars_40:c.getter(o,["handlers"])}},i,p,y,c.config,g),C.createControl("wsControl","ws:SBIS3.EDO2.OpenDialogAction",{name:"FromMeAction",isEventsReestr:c.getter(o,["isEventsReestr"]),tabindex:"0"},{name:"FromMeAction",sbisname:"FromMeAction"},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:h},i,p,y,c.config,g),C.createControl("wsControl","ws:SBIS3.EDO.FolderDialogAction",{name:"FolderAction",tabindex:"0"},{name:"FolderAction",sbisname:"FolderAction"},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:h},i,p,y,c.config,g),C.createControl("wsControl","ws:SBIS3.EDO.FEdoPartialReloader",{actionEventsToListen:["onUpdateModel",c.getter(o,["partialReloader","onDestroyModelHandlingEnable"])?"onDestroyModel":"",c.getter(o,["partialReloader","onCreateModelHandlingEnable"])?"onCreateModel":""],addToFilterFromRecordFields:[""+(c.getter(o,["partialReloader","addHierarchyToFilterFromRecord"])?c.getter(o,["partialReloader","addHierarchyToFilterFromRecord"]):""),"@СвязьПапок"],tabindex:"0",name:"PartialReloader",objectName:c.getter(o,["objectName"])||"СвязьПапок",method:c.getter(o,["method"])||"ДокументыОтМеня",filterName:c.getter(o,["partialReloader","filterName"])||"СписокИдО",sortField:c.getter(o,["partialReloader","turnOffSort"])?"":c.getter(o,["partialReloader","sortField"])||"ПорНомер",overrideItemsSortMethod:!0,updateOnDeleteAndAdd:c.getter(o,["partialReloader","updateOnDeleteAndAdd"])||!1,addServerChannelName:c.getter(o,["partialReloader","addServerChannelName"])||"",fixServerChannelName:c.getter(o,["partialReloader","fixServerChannelName"])||"",deleteServerChannelName:c.getter(o,["partialReloader","deleteServerChannelName"])||"",edoOpenDialogAction:"FromMeAction",nameTaskHier:c.getter(o,["partialReloader","nameTaskHier"])||"",analyzeHierFieldOnTaskAdd:c.getter(o,["partialReloader","analyzeHierFieldOnTaskAdd"])?c.getter(o,["parentProperty"])||"ПапкаДокументов":"",forceUpdateAccordeonCountersOnDel:!0,forceUpdateAccordeonCountersOnAdd:!0,updateAccordeonCountersEventName:"",esc:!1},{name:"PartialReloader",sbisname:"PartialReloader"},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:h,internal:{__dirtyCheckingVars_0:c.getter(o,["partialReloader","onDestroyModelHandlingEnable"])?"onDestroyModel":"",__dirtyCheckingVars_1:c.getter(o,["partialReloader","onCreateModelHandlingEnable"])?"onCreateModel":"",__dirtyCheckingVars_2:c.getter(o,["partialReloader","addHierarchyToFilterFromRecord"])?c.getter(o,["partialReloader","addHierarchyToFilterFromRecord"]):""}},i,p,y,c.config,g)],a,u,this)],m,u);u.def&&(S=C.chain(S,u,a),u=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/FTasksFromMe/FTasksFromMe.tmpl",e,o)}return S||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FTasksFromMe/FTasksFromMe"}},o});
define('js!SBIS3.EDO.FTasksFromMeHandlers',['i18n!SBIS3.EDO.FTasksFromMeHandlers','Elektronnyj_dokumentooborot_localization'],function(){'use strict';var e;return e={setPrintColumns:function(e){e.setResult([{field:'Документ.Дата',title:rk('Дата')},{field:'Документ.Номер',title:rk('Номер')},{field:'РазличныеДокументы.Информация',title:rk('Описание')},{field:'РП.АктивнаяФаза',title:rk('Статус')},{field:'Сотрудник.Название',title:rk('Ответственный')}]);},setPrintColumns_tab:function(e){e.setResult([{field:'Дата',title:rk('Дата')},{field:'Документ.Номер',title:rk('Номер')},{field:'РазличныеДокументы.Информация',title:rk('Описание')},{field:'РП.АктивнаяФаза',title:rk('Статус')},{field:'Лицо.Название',title:rk('Ответственный')}]);},isVisibleEdoRestoreDocumentMass:function(e){return-2===+e['ФильтрПоКраткомуСостоянию'];}};});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.FTasksFromMe", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-FTasksFromMe_BrowserWrapperPP.edo-Browser .controls-Browser__view table.controls-DataGridView__table{table-layout:fixed}.edo-FTasksFromMe_BrowserWrapperPP .controls-ListView__item-type-hidden .controls-TreeView__expand{display:none}.reestrByIsp .controls-TreeView__expand{display:none}.reestrByIsp .rt_right{width:auto}.controls-DataGridView__thead .date_th{vertical-align:top!important;text-align:right!important;padding-right:7px!important}.ctrFilterDateCreate{color:#05b;font-size:12px;height:15px}.ctrFilterDateCreate .controls-Link__field{margin-left:0!important}.edo-FromMe__view th .controls-Link,.edo-FromMe__view th div{line-height:normal;font-size:12px}.edo-FromMe__view .controls-DataGridView__th.date_th>div{display:inline-block;float:right}.edo-FTasksFromMe{height:100%}.edo-FTasksFromMe_floatAreaLink{font-size:18px;margin-left:8px;margin-top:8px;margin-bottom:2px;font-weight:700}"));head.appendChild(style);});}
define('js!SBIS3.EDO.FTasksFromMe',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FTasksFromMe/FTasksFromMe','js!SBIS3.EDO.Modificators','js!SBIS3.EDO.Modificators.FromMe.List','js!SBIS3.EDO.EdoCommon','js!SBIS3.EDO.EdoClicks','js!SBIS3.EDO.EdoRecOptions','js!SBIS3.EDO.FTasksFromMeHandlers','SBIS3.CONTROLS/Action/List/InteractiveMove','js!SBIS3.EDO.TaskRegistryModel','css!SBIS3.EDO.TaskCol','js!SBIS3.EDO.BrowserWrapperPP','js!SBIS3.EDO2.OpenDialogAction','js!SBIS3.EDO.FolderDialogAction','js!SBIS3.EDO.FEdoPartialReloader','SBIS3.CONTROLS/Link','tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TMainColumn','tmpl!SBIS3.EDO2.Browser/resources/columns/tmpl/StateColumn','tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TStateColumn','tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TDocDateColumn','tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TDateColumn','css!SBIS3.EDO.FTasksFromMe','css!SBIS3.PersonCore.Photo','css!SBIS3.EDO.BrowserWrapperPP/resources/columnStyles','tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/THeadStateWithReceived','tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TStateWithReceivedColumn','i18n!SBIS3.EDO.FTasksFromMe','Elektronnyj_dokumentooborot_localization'],function(e,t,o,s,r,i,a,n,l){'use strict';var c=e.extend({_dotTplFn:t,$protected:{_options:{listData:null,hierAllow:true,filterFace:false,filterFaceName:'',itemsActionsVisibility:{edoSaveDocumentOnDisk:false,edoSendDocument:false,edoShowDkPanel:false,edoPostDocument:false},massActionsVisibility:{edoSetCloseStatusMass:false,edoPostsMass:false,edoMoveDocumentMass:true},massActionsSettings:{edoPrintDocumentMass:{recursive:false,minPrintWindowWidth:666,handlers:{onApplyOperation:n.setPrintColumns},items:[],documentIdField:'@Документ'},edoMoveDocumentMass:{filter:{'ПоказИерархии':true,'СписокДляПеремещения':true}},edoRestoreDocumentMass:{isVisible:n.isVisibleEdoRestoreDocumentMass}},ignoreFiltersList:['ПапкаДокументов','ФильтрПриоритет','ПоказИерархии','ВнешняяИерархия','СлужебныйКоличествоЗаписей','СлужебныйКоличествоПапок','ФильтрУдаленные','ФильтрЛицо1','ФильтрОтправитель','ФильтрИсполнительСобытия'],defaultFilterParams:{'ПапкаДокументов':'','ПростыеВД':true,'ОтМеня':true,'РассчитатьФото':true,'ВключитьСписокИсполнителей':true,'ПапкаСкрытьНепрочитанные':true,'ПоказИерархии':true},resultFilterParams:{}}},$constructor:function(){},destroy:function(){if(this.hasChildControlByName('browserView'))this.getChildControlByName('browserView')._options.interactiveMoveObject.destroy();c.superclass.destroy.apply(this,arguments);},init:function(){c.superclass.init.call(this);var e=this,t=this.getChildControlByName('browserFastDataFilter'),o=e.hasChildControlByName('browserView')?e.getChildControlByName('browserView'):null;if(e.subscribeTo(e.getChildControlByName('FromMe'),'onFinishCommand',function(e,t){if('edoDeleteDocument'==t.commandName)if(-1!==t.args[0].rowData.id.indexOf('Подзадача'))o.reload();}),t)t.setItems(this._options.fastDataFilterConfig.data);if(e.getChildControlByName('FromMe').getView().once('onItemsReady',function(){this.setSelectedIndex(0);}),this._options.filterFace&&this._options.filterFaceName)this.setFilterFaceName(this._options.filterFaceName);if(o)o._options.interactiveMoveObject=new l({linkedObject:o,componentOptions:{filter:{'ПоказИерархии':true,'СписокДляПеремещения':true}}});},setFilterFaceName:function(e){var t=this.getChildControlByName('FromMe').getLinkedContext();if(t.getValue('fromMeFilter/buttonCaption/ФильтрСписокРассылки')!==e)t.setValue('fromMeFilter/buttonCaption/ФильтрСписокРассылки',e);},_modifyOptions:function(){var e=c.superclass._modifyOptions.apply(this,arguments),t=null,r={},i={};if(e.resultFilterParams=e.filterParams||e.defaultFilterParams,t=new o(new s()),e&&e.listData&&e.listData.filter)r=e.listData.filter;if(e.filterFace&&e.filterFaceName)e.resultFilterParams['ФильтрСписокРассылки']=[e.filterFace],r['ФильтрСписокРассылки']=[e.filterFace],i['ФильтрСписокРассылки']=[e.filterFaceName];if(e.handlers=this._getHandlers(e),e.itemsActions=e.itemsActions||t.getActions(),e.operationsPanelConfig=e.operationsPanelConfig||t.getMOPActions(),e.filterButtonConfig=e.filterButtonConfig||t.getFilterButtonConfig(r,i),e.fastDataFilterConfig=t.getFastDataFilterConfig(r),'object'==typeof e.operationsPanelConfig)e.operationsPanelConfig.hasItemsMenu=true;return e;},_getHandlers:function(e){var t={onReady:[e.addMoveStrategy||r.addMoveStrategy],onItemClick:[i.clickDisp],onBeforeProviderCall:[r.onBeforeDataLoadEvent],onChangeHoveredItem:[e.onChangeHoveredItemHandler||a.onChangeHoveredItem]};if(e.needDataLoadHandler)t.onReady.push(r.setDataLoadHandler);if(!e.tapeReestr)t.onReady.push(r.addRefresh);return t;}});return c;});
define("tmpl!SBIS3.EDO.FTasksFromMeTapeTab/FTasksFromMeTapeTab",["Core/tmpl/js/tclosure","js!SBIS3.CONTROLS/Link","js!SBIS3.Engine.BrowserTabs","js!SBIS3.EDO.FTaskButtons","js!SBIS3.EDO.FTasksFromMe","js!SBIS3.EDO.FTaskHier","js!SBIS3.EDO.FTasksGroupByType","js!SBIS3.TASKS.MovementsController","js!SBIS3.EDO.FMyTasks"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.CONTROLS/Link"]=e[1],r["js!SBIS3.Engine.BrowserTabs"]=e[2],r["js!SBIS3.EDO.FTaskButtons"]=e[3],r["js!SBIS3.EDO.FTasksFromMe"]=e[4],r["js!SBIS3.EDO.FTaskHier"]=e[5],r["js!SBIS3.EDO.FTasksGroupByType"]=e[6],r["js!SBIS3.TASKS.MovementsController"]=e[7],r["js!SBIS3.EDO.FMyTasks"]=e[8];var o=function e(o,s,a,n,i){function l(){}var d=0,c=void 0!==t&&t?t:arguments[arguments.length-1];void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure"));var m={};i&&i.isSetts&&(m=i.fullContext||{});var g="string"==typeof a?a:"",p=void 0===r?void 0:r,u={id:[],def:void 0},v=c.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),k=this&&this.includedTemplates?this.includedTemplates:{},C=c.getMarkupGenerator(n);try{var T=C.joinElements([C.createTag("div",{class:"edo-FTasksFromMeTapeTab TasksTapeTab"},[c.getter(o,["isFloatMode"])?[C.createTag("div",{class:"ws-float-area__close-button-wrapper",style:"height: 34px;"},[C.createControl("wsControl","ws:SBIS3.CONTROLS/Link",{name:"ЗадачиОтМеня",caption:global.rk("Задачи от меня"),href:"/fregistry.html?region_left=registry-FromMe",className:"mytask_area_caption"},{name:"ЗадачиОтМеня",sbisname:"ЗадачиОтМеня"},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:v},a,p,k,c.config,m)],{},u,this)]:C.createText(""),C.createControl("wsControl","ws:SBIS3.Engine.BrowserTabs",{tabsArea:[{content:c.createDataArray([(new function(){var e=Object.create(o),t=function e(t,r,o,s,a){if(void 0===o)var o=arguments[2];var n=0,i="content";if(void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure")),a&&a.isSetts)var l=a.fullContext||{};t=c.isolateScope(Object.create(this),t,i);var d="string"==typeof o?o:"",m={id:[],def:void 0},g=this&&this.includedTemplates?this.includedTemplates:{},u=c.getMarkupGenerator(s);try{var k=u.joinElements([u.createControl("wsControl","ws:SBIS3.EDO.FTaskButtons",{name:"TaskButtons",addDoc_name:"AddTaskFromMe",showAddDoc:!0,showAddFolder:!0,createTaskTooltip:global.rk("Создать задачу"),createFolderTooltip:global.rk("Создать папку")},c.plainMerge(r,{name:"TaskButtons",sbisname:"TaskButtons"}),{data:t,ctx:this,pName:void 0!==i?i:void 0,viewController:v},o,p,g,c.config,l)],d,m);m.def&&(k=u.chain(k,m,r),m=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/FTasksFromMeTapeTab/FTasksFromMeTapeTab.tmpl",e,t)}return k||""};this.func=c.makeFunctionSerializable(t,e)}).func]),id:"afGroup"},(new function(){var e=Object.create(o),t=function e(t,r,o,s,a){if(void 0===o)var o=arguments[2];var n=0,i="tabsArea";if(void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure")),a&&a.isSetts)var l=a.fullContext||{};t=c.isolateScope(Object.create(this),t,i);var d="string"==typeof o?o:"",m={id:[],def:void 0},g=this&&this.includedTemplates?this.includedTemplates:{},u=c.getMarkupGenerator(s);try{var k=u.joinElements([c.getter(t,["showReturnTask"])?[u.createTag("ws:Object",{id:"addBtnGroup"},[u.createTag("ws:content",{},[u.createControl("wsControl","ws:SBIS3.EDO.FTaskButtons",{name:"TaskButtons",addDoc_name:"AddTaskFromMe",showAddDoc:!0},{name:"TaskButtons",sbisname:"TaskButtons"},{data:t,ctx:this,pName:void 0!==i?i:void 0,viewController:v},o,p,g,c.config,l)],{},m,this)],{},m,this)]:u.createText("")],d,m);m.def&&(k=u.chain(k,m,r),m=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/FTasksFromMeTapeTab/FTasksFromMeTapeTab.tmpl",e,t)}return k||""};this.func=c.makeFunctionSerializable(t,e)}).func],mainArea:[{content:c.createDataArray([(new function(){var e=Object.create(o),t=function e(t,r,o,s,a){if(void 0===o)var o=arguments[2];var n=0,i="content";if(void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure")),a&&a.isSetts)var l=a.fullContext||{};t=c.isolateScope(Object.create(this),t,i);var d="string"==typeof o?o:"",m={id:[],def:void 0},g=this&&this.includedTemplates?this.includedTemplates:{},u=c.getMarkupGenerator(s);try{var k=u.joinElements([u.createTag("div",{class:"tasksSale-browser"},[u.createControl("wsControl","ws:SBIS3.EDO.FTasksFromMe",{tapeContent:c.createDataArray([(new function(){var e=Object.create(t),r=function e(t,r,o,s,a){if(void 0===o)var o=arguments[2];var n=0,i="tapeContent";if(void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure")),a&&a.isSetts)var l=a.fullContext||{};t=c.isolateScope(Object.create(this),t,i);var d="string"==typeof o?o:"",m={id:[],def:void 0},g=this&&this.includedTemplates?this.includedTemplates:{},u=c.getMarkupGenerator(s);try{var k=u.joinElements([u.createControl("wsControl","ws:SBIS3.EDO.FTaskHier",{deleteUserFolderClick:c.getTypeFunc("js!SBIS3.EDO.EdoRecOptions:deleteUserFolderFromMe",{}),name:"Edo-TaskHier",queryMethod:"ДокументыОтМеня",foldersListData:c.getter(t,["foldersListData"]),esc:!1},c.plainMerge(r,{name:"Edo-TaskHier",sbisname:"Edo-TaskHier"}),{data:t,ctx:this,pName:void 0!==i?i:void 0,viewController:v},o,p,g,c.config,l)],d,m);m.def&&(k=u.chain(k,m,r),m=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/FTasksFromMeTapeTab/FTasksFromMeTapeTab.tmpl",e,t)}return k||""};this.func=c.makeFunctionSerializable(r,e)}).func,(new function(){var e=Object.create(t),r=function e(t,r,o,s,a){if(void 0===o)var o=arguments[2];var n=0,i="tapeContent";if(void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure")),a&&a.isSetts)var l=a.fullContext||{};t=c.isolateScope(Object.create(this),t,i);var d="string"==typeof o?o:"",m={id:[],def:void 0},g=this&&this.includedTemplates?this.includedTemplates:{},u=c.getMarkupGenerator(s);try{var k=u.joinElements([u.createControl("wsControl","ws:SBIS3.EDO.FTasksGroupByType",{name:"Edo-TasksGroupByType",groupsListData:c.getter(t,["groupsListData"]),filterParams:{"ИмяПапки":"ОтМеня"},visible:!c.getter(t,["hideGroupsByFastfilter"])},c.plainMerge(r,{name:"Edo-TasksGroupByType",sbisname:"Edo-TasksGroupByType"}),{data:t,ctx:this,pName:void 0!==i?i:void 0,viewController:v},o,p,g,c.config,l)],d,m);m.def&&(k=u.chain(k,m,r),m=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/FTasksFromMeTapeTab/FTasksFromMeTapeTab.tmpl",e,t)}return k||""};this.func=c.makeFunctionSerializable(r,e)}).func]),arrowActivatedHandler:c.getTypeFunc("js!SBIS3.EDO.EdoClicks:folderClick",{}),listData:c.getter(t,["listData"]),foldersListData:c.getter(t,["foldersListData"]),serverSideRendering:c.getter(t,["serverSideRendering"]),tasksExists:c.getter(t,["tasksExists"]),foldersExists:c.getter(t,["foldersExists"]),hierAllow:!0,useAutoRefresh:!0,needDataLoadHandler:!0,partialReloader:{onCreateModelHandlingEnable:!0,onDestroyModelHandlingEnable:!0,nameTaskHier:"Edo-TaskHier",deleteServerChannelName:"edo.task-delete",analyzeHierFieldOnTaskAdd:!0},tapeReestr:!0,allowDragNDropMove:!0,showHead:!0,headTemplateDate:!0,headTemplateDateCreate:!0,filterParams:c.getter(t,["defaultFilterParams"]),filterFace:c.getter(t,["filterFace"]),filterFaceName:c.getter(t,["filterFaceName"]),esc:!1},{},{data:t,ctx:this,pName:void 0!==i?i:void 0,viewController:v,internal:{__dirtyCheckingVars_0:c.getter(t,["foldersListData"]),__dirtyCheckingVars_1:c.getter(t,["groupsListData"]),__dirtyCheckingVars_3:!c.getter(t,["hideGroupsByFastfilter"])}},o,p,g,c.config,l),u.createControl("wsControl","ws:SBIS3.TASKS.MovementsController",{excludedFilters:c.getter(t,["movementsControllerOptions","taskHier","excludedFilters"]),includedFilters:c.getter(t,["movementsControllerOptions","taskHier","includedFilters"]),componentName:c.getter(t,["movementsControllerOptions","taskHier","componentName"]),browserName:c.getter(t,["movementsControllerOptions","taskHier","browserName"]),filterRetriever:c.getter(t,["movementsControllerOptions","taskHier","filterRetriever"]),injectableFilters:c.getter(t,["movementsControllerOptions","taskHier","injectableFilters"]),onResetSearchHandler:c.getter(t,["movementsControllerOptions","taskHier","onResetSearchHandler"]),onStartSearchHandler:c.getter(t,["movementsControllerOptions","taskHier","onStartSearchHandler"]),reloadAfterFilterChange:c.getter(t,["movementsControllerOptions","taskHier","reloadAfterFilterChange"]),filterForNotReloadControl:c.getter(t,["movementsControllerOptions","taskHier","filterForNotReloadControl"]),resetOnRequest:c.getter(t,["movementsControllerOptions","taskHier","resetOnRequest"]),itemDataRetriever:c.getter(t,["movementsControllerOptions","taskHier","itemDataRetriever"])},{},{data:t,ctx:this,pName:void 0!==i?i:void 0,viewController:v},o,p,g,c.config,l),u.createControl("wsControl","ws:SBIS3.TASKS.MovementsController",{excludedFilters:c.getter(t,["movementsControllerOptions","groups","excludedFilters"]),includedFilters:c.getter(t,["movementsControllerOptions","groups","includedFilters"]),componentName:c.getter(t,["movementsControllerOptions","groups","componentName"]),browserName:c.getter(t,["movementsControllerOptions","groups","browserName"]),filterRetriever:c.getter(t,["movementsControllerOptions","groups","filterRetriever"]),injectableFilters:c.getter(t,["movementsControllerOptions","groups","injectableFilters"]),onResetSearchHandler:c.getter(t,["movementsControllerOptions","groups","onResetSearchHandler"]),onStartSearchHandler:c.getter(t,["movementsControllerOptions","groups","onStartSearchHandler"]),slaveControl:c.getter(t,["movementsControllerOptions","groups","slaveControl"]),getDataForMovingMarkerFromFilterButton:c.getter(t,["movementsControllerOptions","groups","getDataForMovingMarkerFromFilterButton"]),filterForNotReloadControl:c.getter(t,["movementsControllerOptions","groups","filterForNotReloadControl"]),onClickAdditionalFilter:c.getter(t,["movementsControllerOptions","groups","onClickAdditionalFilter"]),fastDataFilter:c.getter(t,["movementsControllerOptions","groups","fastDataFilter"]),itemDataRetriever:c.getter(t,["movementsControllerOptions","groups","itemDataRetriever"])},{},{data:t,ctx:this,pName:void 0!==i?i:void 0,viewController:v},o,p,g,c.config,l)],r,m,this)],d,m);m.def&&(k=u.chain(k,m,r),m=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/FTasksFromMeTapeTab/FTasksFromMeTapeTab.tmpl",e,t)}return k||""};this.func=c.makeFunctionSerializable(t,e)}).func]),id:"listGroup"},{content:c.createDataArray([(new function(){var e=Object.create(o),t=function e(t,r,o,s,a){if(void 0===o)var o=arguments[2];var n=0,i="content";if(void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure")),a&&a.isSetts)var l=a.fullContext||{};t=c.isolateScope(Object.create(this),t,i);var d="string"==typeof o?o:"",m={id:[],def:void 0},g=this&&this.includedTemplates?this.includedTemplates:{},u=c.getMarkupGenerator(s);try{var k=u.joinElements([u.createTag("div",{class:"tasksSale-browser"},[u.createControl("wsControl","ws:SBIS3.EDO.FMyTasks",{addClass:"returnTasksGroup",useScrollContainer:!0,useAutoRefresh:!0,partialReloader:{addServerChannelName:"edo.task-added",fixServerChannelName:"edo.task-fix",deleteServerChannelName:"edo.task-delete",updateOnDeleteAndAdd:!0},hierAllow:!1,method:"ВернувшиесяДокументы",filterParams:c.getter(t,["returnDefaultFilterParams"]),historyId:"FromMeReturn",showHead:!0,dateColTitle:global.rk("Получено"),isNeedCommentPrevStage:!0,ignoreFiltersList:["ФильтрПриоритет"],filterButtonConfig:c.getter(t,["filterButtonConfigReturnGroup"]),massActionsVisibility:c.getter(t,["massActionsVisibilityReturnGroup"]),operationsPanelConfig:c.getter(t,["operationsPanelConfigReturnGroup"]),massActionsSettings:c.getter(t,["massActionsSettings"]),itemsActions:c.getter(t,["returnItemsActions"])},{},{data:t,ctx:this,pName:void 0!==i?i:void 0,viewController:v},o,p,g,c.config,l)],r,m,this)],d,m);m.def&&(k=u.chain(k,m,r),m=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/FTasksFromMeTapeTab/FTasksFromMeTapeTab.tmpl",e,t)}return k||""};this.func=c.makeFunctionSerializable(t,e)}).func]),id:"returnGroup"}],tabs:[{id:"returnTab",title:global.rk("Вернулись"),mainArea:"returnGroup",tabsArea:"addBtnGroup",visible:c.getter(o,["showReturnTask"])},{id:"ListTab",title:global.rk("Список"),mainArea:"listGroup",tabsArea:"afGroup"}],handlers:{onBeforeShowFirstTab:[c.getTypeFunc("js!SBIS3.EDO.FTasksFromMeTapeTab:prototype.onBeforeShowFirstTab",{})],onTabAndMainLoaded:[c.getTypeFunc("js!SBIS3.EDO.FTasksFromMeTapeTab:prototype.onTabAndMainLoaded",{})],onTabChange:[c.getTypeFunc("js!SBIS3.EDO.FTasksFromMeTapeTab:prototype.onTabChange",{})]},name:"FromMeTaskTabs",stickyHeader:!0,defaultTab:"ListTab",tabsName:"FromMeTaskInnerTabs",esc:!1},{class:"TasksTapeTabBrowserTabs",name:"FromMeTaskTabs",sbisname:"FromMeTaskTabs"},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:v,internal:{__dirtyCheckingVars_5:c.getter(o,["showReturnTask"]),__dirtyCheckingVars_6:c.getter(o,["foldersListData"]),__dirtyCheckingVars_7:c.getter(o,["groupsListData"]),__dirtyCheckingVars_9:!c.getter(o,["hideGroupsByFastfilter"]),__dirtyCheckingVars_10:c.getter(o,["listData"]),__dirtyCheckingVars_11:c.getter(o,["foldersListData"]),__dirtyCheckingVars_12:c.getter(o,["serverSideRendering"]),__dirtyCheckingVars_13:c.getter(o,["tasksExists"]),__dirtyCheckingVars_14:c.getter(o,["foldersExists"]),__dirtyCheckingVars_24:c.getter(o,["defaultFilterParams"]),__dirtyCheckingVars_25:c.getter(o,["filterFace"]),__dirtyCheckingVars_26:c.getter(o,["filterFaceName"]),__dirtyCheckingVars_27:c.getter(o,["movementsControllerOptions","taskHier","excludedFilters"]),__dirtyCheckingVars_28:c.getter(o,["movementsControllerOptions","taskHier","includedFilters"]),__dirtyCheckingVars_29:c.getter(o,["movementsControllerOptions","taskHier","componentName"]),__dirtyCheckingVars_30:c.getter(o,["movementsControllerOptions","taskHier","browserName"]),__dirtyCheckingVars_31:c.getter(o,["movementsControllerOptions","taskHier","filterRetriever"]),__dirtyCheckingVars_32:c.getter(o,["movementsControllerOptions","taskHier","injectableFilters"]),__dirtyCheckingVars_33:c.getter(o,["movementsControllerOptions","taskHier","onResetSearchHandler"]),__dirtyCheckingVars_34:c.getter(o,["movementsControllerOptions","taskHier","onStartSearchHandler"]),__dirtyCheckingVars_35:c.getter(o,["movementsControllerOptions","taskHier","reloadAfterFilterChange"]),__dirtyCheckingVars_36:c.getter(o,["movementsControllerOptions","taskHier","filterForNotReloadControl"]),__dirtyCheckingVars_37:c.getter(o,["movementsControllerOptions","taskHier","resetOnRequest"]),__dirtyCheckingVars_38:c.getter(o,["movementsControllerOptions","taskHier","itemDataRetriever"]),__dirtyCheckingVars_39:c.getter(o,["movementsControllerOptions","groups","excludedFilters"]),__dirtyCheckingVars_40:c.getter(o,["movementsControllerOptions","groups","includedFilters"]),__dirtyCheckingVars_41:c.getter(o,["movementsControllerOptions","groups","componentName"]),__dirtyCheckingVars_42:c.getter(o,["movementsControllerOptions","groups","browserName"]),__dirtyCheckingVars_43:c.getter(o,["movementsControllerOptions","groups","filterRetriever"]),__dirtyCheckingVars_44:c.getter(o,["movementsControllerOptions","groups","injectableFilters"]),__dirtyCheckingVars_45:c.getter(o,["movementsControllerOptions","groups","onResetSearchHandler"]),__dirtyCheckingVars_46:c.getter(o,["movementsControllerOptions","groups","onStartSearchHandler"]),__dirtyCheckingVars_47:c.getter(o,["movementsControllerOptions","groups","slaveControl"]),__dirtyCheckingVars_48:c.getter(o,["movementsControllerOptions","groups","getDataForMovingMarkerFromFilterButton"]),__dirtyCheckingVars_49:c.getter(o,["movementsControllerOptions","groups","filterForNotReloadControl"]),__dirtyCheckingVars_50:c.getter(o,["movementsControllerOptions","groups","onClickAdditionalFilter"]),__dirtyCheckingVars_51:c.getter(o,["movementsControllerOptions","groups","fastDataFilter"]),__dirtyCheckingVars_52:c.getter(o,["movementsControllerOptions","groups","itemDataRetriever"]),__dirtyCheckingVars_57:c.getter(o,["returnDefaultFilterParams"]),__dirtyCheckingVars_62:c.getter(o,["filterButtonConfigReturnGroup"]),__dirtyCheckingVars_63:c.getter(o,["massActionsVisibilityReturnGroup"]),__dirtyCheckingVars_64:c.getter(o,["operationsPanelConfigReturnGroup"]),__dirtyCheckingVars_65:c.getter(o,["massActionsSettings"]),__dirtyCheckingVars_66:c.getter(o,["returnItemsActions"]),__dirtyCheckingVars_68:c.getter(o,["showReturnTask"])}},a,p,k,c.config,m)],s,u,this)],g,u);u.def&&(T=C.chain(T,u,s),u=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/FTasksFromMeTapeTab/FTasksFromMeTapeTab.tmpl",e,o)}return T||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FTasksFromMeTapeTab/FTasksFromMeTapeTab"}},o});
define('js!SBIS3.EDO.FTasksFromMeTapeTab',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FTasksFromMeTapeTab/FTasksFromMeTapeTab','js!SBIS3.EDO.Modificators','js!SBIS3.EDO.Modificators.FromMe.ReturnGroup','js!SBIS3.EDO.FTasksFromMeHandlers','js!SBIS3.EDO.EdoCommon','WS.Data/Source/SbisService','js!SBIS3.TASKS.MovementsController.Handlers','Core/EventBus','js!SBIS3.Engine.BrowserTabs','js!SBIS3.EDO.FTasksFromMe','js!SBIS3.EDO.FMyTasks','js!SBIS3.EDO.FTaskButtons','js!SBIS3.EDO.FTaskHier','js!SBIS3.EDO.FTasksGroupByType','js!SBIS3.EDO.EdoClicks','js!SBIS3.EDO2.Browser','i18n!SBIS3.EDO.FTasksFromMeTapeTab','Elektronnyj_dokumentooborot_localization'],function(e,t,r,s,a,o,n,i,l){'use strict';var u=e.extend({_dotTplFn:t,$protected:{_options:{listData:null,showReturnTask:true,massActionsSettings:{edoPrintDocumentMass:{options:{handlers:{onApplyOperation:a.setPrintColumns_tab}}}},defaultFilterParams:{'ПапкаДокументов':'','ПростыеВД':true,'ОтМеня':true,'РассчитатьФото':true,'ВключитьСписокИсполнителей':true,'ПапкаСкрытьНепрочитанные':true,'ВнешняяИерархия':true,'ПоказИерархии':false},ispDefaultFilterParams:{'ПапкаДокументов':'','ПростыеВД':true,'ОтМеня':true,'РассчитатьФото':true,'ВключитьСписокИсполнителей':true,'ПоказИерархии':false},returnDefaultFilterParams:{'ПапкаДокументов':'','ПростыеВД':true,'РассчитатьФото':true},returnItemsActions:[],tasksExists:true,foldersExists:true}},onDeleteCountersUpdate:function(e){var t=e.brw,r=e.foldersBrw,s=e.groupsBrw;if(t)t.subscribeTo(l.channel('edo.taskfromme'),'onMessage',function(e,t,a){var o=r?r.getSelectedKey():null,n=s?s.getSelectedKey():null,i,l;if(-1!==parseInt(t[0],10))return;if(o){var u=r.getDataSet().getRecordById(o).get('СчетчикЗадач');if(+u.get('Всего')-1>-1)u.set('Всего',+u.get('Всего')-1);s.reload();}else{if(+(l=s.getDataSet().getRecordById(n)).get('КолВсего')-1>-1)l.set('КолВсего',+l.get('КолВсего')-1);r.reload(r.getFilter(),null,null,null,true);}});},init:function(){u.superclass.init.call(this);var e=this.getChildControlByName('FromMeTaskTabs'),t=e.hasChildControlByName('taskHierBrowser')?e.getChildControlByName('taskHierBrowser'):null,r=e.hasChildControlByName('FTasksGroupByType')?e.getChildControlByName('FTasksGroupByType'):null;o.addReturnDocuments(e),o.removeReturnDocuments(e);var s='FromMe';o.updateTaskHierAfterMassAction.call(this,s),this.onDeleteCountersUpdate({brw:e,foldersBrw:t,groupsBrw:r});},onTabAndMainLoaded:function(e,t){var r='FromMe';if('ListTab'===t)o.initTaskButtons({mainObject:this.getCurrentTabArea('main'),tabsObject:this.getCurrentTabArea('tabs'),btnDocName:'AddTaskFromMe',brwName:'FromMe',actionName:'FromMeAction',folderButtonName:'btnAddFolder',rootFolderName:'От меня',folderAction:'FolderAction',createInFolder:true,linkedEdoBrowser:['FTasksGroupByType','taskHierBrowser']});else if('returnTab'===t)o.initTaskButtons({mainObject:this.getCurrentTabArea('main'),tabsObject:this.getCurrentTabArea('tabs'),btnDocName:'AddTaskFromMe',brwName:'MyTasks',actionName:'MyTasksAction'});},onTabChange:function(e,t){if('returnTab'===t)o.setLoadAndChangeTabReturnsCounter(this);},onBeforeShowFirstTab:function(){o.setLoadAndChangeTabReturnsCounter(this);},getService:function(e,t){return new n({endpoint:e.objectName,binding:{query:e.method,destroy:e.destroyMethod},model:e.model,filter:t});},_modifyOptions:function(){var e=u.superclass._modifyOptions.apply(this,arguments),t=new r(new s());e.returnItemsActions=t.getActions(),e.operationsPanelConfigReturnGroup=t.getMOPActions(),e.filterButtonConfigReturnGroup=t.getFilterButtonConfig(),e.massActionsVisibilityReturnGroup={edoSetCloseStatusMass:false,edoPostsMass:false,edoDeleteDocumentMass:false},e.tasksExists=!!(e.listData&&e.listData.items&&e.listData.items.getCount&&e.listData.items.getCount()>0),e.foldersExists=!!(e.foldersListData&&e.foldersListData.items&&e.foldersListData.items.getCount&&e.foldersListData.items.getCount()>1);var a=[{name:'ФильтрСписокРассылки',default:[]},{name:'Проект',default:null},{name:'ФильтрПоВехе',default:[]},{name:'ИдРегламента',default:[]}],o=[{name:'ПапкаДокументов',default:'',resetValue:null}],n={key:'ФильтрПоКраткомуСостоянию',value:'8',title:'В обработке'};return e.movementsControllerOptions={taskHier:{excludedFilters:a,includedFilters:o,componentName:'taskHierBrowser',browserName:'FromMe',filterRetriever:i.taskHierFilterRetriever,injectableFilters:{'ФильтрацияПоСчетчику':null},itemDataRetriever:i.extractTaskHierItemsDataForFilters,reloadAfterFilterChange:true,filterForNotReloadControl:'ФильтрацияПоСчетчику',resetOnRequest:true},groups:{excludedFilters:o,includedFilters:a,componentName:'FTasksGroupByType',browserName:'FromMe',filterRetriever:i.groupsWithFastDataFilterRetriever,injectableFilters:{'ФильтрацияПоСчетчику':true},itemDataRetriever:i.extractGroupsItemsDataForFilters,filterForNotReloadControl:'ФильтрацияПоСчетчику',slaveControl:true,getDataForMovingMarkerFromFilterButton:i.extractDataFromChangedGroupsFilters,onClickAdditionalFilter:i.fromMeOnClickAdditionalFilter,fastDataFilter:n}},e;}});return u;});
define('js!SBIS3.Package.FTasks.Common',['js!SBIS3.EDO.FMyTaskTapeTab','js!SBIS3.EDO.FUnallocatedTasksTapeTab','js!SBIS3.EDO.FTasksMonitoringTapeTab','js!SBIS3.EDO.FTasksFromMeTapeTab','Elektronnyj_dokumentooborot_localization'],function(){});
define('js!SBIS3.EDO.FTransferFaceModel',['WS.Data/Entity/Model','Elektronnyj_dokumentooborot_localization'],function(e){'use strict';var t={};return t['ФамилияИО']={get:function(){return this.get('НазваниеКраткое')||this.get('Название');}},t['ИДЛицо']={get:function(){return this.get('@Лицо')||this.get('Лицо');}},e.extend({_moduleName:'SBIS3.EDO.FTransferFaceModel',_$properties:t});});
define("tmpl!SBIS3.EDO.FUserTasks",["Core/tmpl/js/tclosure","js!SBIS3.CONTROLS.Label","js!SBIS3.EDO.FTaskButtons","js!SBIS3.CONTROLS.OperationsPanelButton","js!SBIS3.EDO.FMyTasks"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],s={};s["js!SBIS3.CONTROLS.Label"]=e[1],s["js!SBIS3.EDO.FTaskButtons"]=e[2],s["js!SBIS3.CONTROLS.OperationsPanelButton"]=e[3],s["js!SBIS3.EDO.FMyTasks"]=e[4];var a=function e(a,o,r,n,l){function i(){}var d=0,c=void 0!==t&&t?t:arguments[arguments.length-1];void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure"));var u={};l&&l.isSetts&&(u=l.fullContext||{});var p="string"==typeof r?r:"",T=void 0===s?void 0:s,m={id:[],def:void 0},S=c.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,a),k=this&&this.includedTemplates?this.includedTemplates:{},C=c.getMarkupGenerator(n);try{var g=C.joinElements([C.createTag("div",{class:"edo-FUserTasks__wrapper",style:"height:100%;"},[C.createTag("div",{class:"edo-FUserTasksHead"},[C.createTag("div",{class:"edo-FUserTasksCaption"},[C.createText(""+global.rk("Задачи"))],{},m,this),c.getter(a,["showTasksCounter"])?[C.createControl("wsControl","ws:SBIS3.CONTROLS.Label",{name:"textBox",enabled:!1,className:"edo-FUserTasksCounter",value:"qwer",allowChangeEnable:!1},{name:"textBox",sbisname:"textBox"},{data:a,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:S},r,T,k,c.config,u),C.createTag("div",{class:"edo-FUserTasksCounter"},[C.createTag("span",{id:"taskCounterSpan"},[C.createText("")],{},m,this)],{},m,this)]:C.createText(""),C.createControl("wsControl","ws:SBIS3.EDO.FTaskButtons",{className:"edo-FUserTaskButtons",name:"TaskButtons",addDoc_name:"AddTaskOnCard",showAddDoc:!0,addFolder_advanced:!1,showAddFolder:!1,createTaskTooltip:global.rk("Создать задачу"),createFolderTooltip:global.rk("Создать папку"),showTransfer:!0},{name:"TaskButtons",sbisname:"TaskButtons"},{data:a,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:S},r,T,k,c.config,u),C.createControl("wsControl","ws:SBIS3.CONTROLS.OperationsPanelButton",{name:"panelControlButton",visible:!0},{class:"controls-OperationsPanelButton__showSeparator",name:"panelControlButton",sbisname:"panelControlButton"},{data:a,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:S},r,T,k,c.config,u)],{},m,this),C.createTag("div",{class:"ws-flexbox ws-flex-column ws-flex-grow-1",style:"height:100%;"},[C.createControl("wsControl","ws:SBIS3.EDO.FMyTasks",{browserOptions:{massActionsVisibility:{edoSelectDocs:!0,edoDeleteDocumentMass:!1,edoRestoreDocumentMass:!1,edoPostsMass:!1,edoSetCloseStatusMass:!1,edoSetMarksMass:!1,edoExecuteMass:!1,edoMoveDocumentMass:!1,edoSetDocumentReadedMass:!0,edoShowRegistryHistory:!1}},filterParams:{"Лицо":c.getter(a,["userFaceId"]),"ПростыеВД":!0,"РассчитатьФото":!0,"ПоказИерархии":!1,"ВключитьСписокИсполнителей":!0},operationsPanelConfig:{name:"edo-operationsPanelUserTasks"},partialReloader:{onCreateModelHandlingEnable:!0},name:"edo-FUserTasks",useScrollContainer:!0,useStickyHeader:!1,useAutoRefresh:!1,useScope:!0,dateColTitle:global.rk("Получено"),cssStatus:global.rk("Состояние"),statusPictureTitle:global.rk("Состояние"),historyId:c.getter(a,["MyTaskOnUserCard"]),myTaskBrName:c.getter(a,["userTasks"]),userFaceId:c.getter(a,["userFaceId"]),esc:!1},{name:"edo-FUserTasks",sbisname:"edo-FUserTasks"},{data:a,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:S,internal:{__dirtyCheckingVars_10:c.getter(a,["userFaceId"])}},r,T,k,c.config,u)],{},m,this)],o,m,this)],p,m);m.def&&(g=C.chain(g,m,o),m=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/FRegistry/FUserTasks/FUserTasks.tmpl",e,a)}return g||""};return a.includedFunctions={},a.stable=!0,a.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FUserTasks"}},a});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.FUserTasks", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".AProfileDoublePanel__leftContentParent .edo-FMyTasks__wrapper{display:inline-block;height:calc(100% - 40px)}.AProfileDoublePanel__leftContentParent .edo-FUserTaskButtons{display:inline-block;margin-left:12px;margin-top:7px;vertical-align:baseline}.edo-FUserTaskButtons .edo-TaskButtons-addDocument,.edo-FUserTaskButtons .edo-TaskButtons-transferTask{display:inline-block!important}.edo-FUserTasksCaption{color:#d94700;font-weight:700;margin-left:12px;display:inline-block;vertical-align:top;margin-top:6px}.edo-FUserTasksHead{font-size:18px;font-family:TensorFont,sans-serif;height:40px;display:block}.edo-FUserTasks__wrapper .controls-OperationsPanelButton{display:inline-block;margin-left:8px}.edo-FUserTasksCounter{display:inline-block;vertical-align:top;color:#999;margin-top:6px}"));head.appendChild(style);});}
define('js!SBIS3.EDO.FUserTasks',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FUserTasks','js!SBIS3.EDO.EdoCommon','WS.Data/Source/SbisService','js!SBIS3.CONTROLS.OperationsPanelButton','js!SBIS3.CONTROLS.OperationDelete','js!SBIS3.CONTROLS.OperationPrint','SBIS3.CONTROLS/Label','css!SBIS3.EDO.FUserTasks','Elektronnyj_dokumentooborot_localization'],function(e,t,s,o){'use strict';var n=e.extend({_dotTplFn:t,$protected:{_options:{userFaceId:0,userSName:'',userName:'',userPatr:'',showTasksCounter:true}},init:function(){n.superclass.init.call(this);var e=this,t=[],a=e.getChildControlByName('panelControlButton'),r=e.getChildControlByName('edo-FUserTasks').getChildControlByName('edo-operationsPanelUserTasks'),i={mainObject:e.getTopParent(),tabsObject:e,btnDocName:'AddTaskOnCard',brwName:'MyTasks',actionName:'MyTasksAction',folderAdvancedMode:true,folderAction:'FolderAction'};a.setLinkedPanel(r),t.push({faceID:e._options.userFaceId,faceID_:'"СтруктураПредприятия"',name:e._getUserName()}),i.executerList=t,s.initTaskButtons(i),e.subscribe('onReady',function(){new o({endpoint:'ПапкаДокументов'}).call('СтатистикаДелЛица',{'Лицо':e._options.userFaceId}).addCallback(function(t){var s=t&&t.getRow()?t.getRow().get('Всего'):'',o=s>999?'999+':s;e.getContainer().find('#taskCounterSpan').html(o);});});},_getUserName:function(){var e=this._options.userSName||'';if(this._options.userName)e+=' '+this._options.userName[0]+'.';if(this._options.userPatr)e+=this._options.userPatr[0]+'.';return e;}});return n;});
define("tmpl!SBIS3.EDO.FSubtasks/FSubtasks",["Core/tmpl/js/tclosure","js!SBIS3.EDO2.RulesSelector","js!SBIS3.CONTROLS.MenuLink","js!SBIS3.EDO2.Browser"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],o={};o["js!SBIS3.EDO2.RulesSelector"]=e[1],o["js!SBIS3.CONTROLS.MenuLink"]=e[2],o["js!SBIS3.EDO2.Browser"]=e[3];var r=function e(r,s,a,n,l){function i(){}var c=0,d=void 0!==t&&t?t:arguments[arguments.length-1];void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure"));var u={};l&&l.isSetts&&(u=l.fullContext||{});var m="string"==typeof a?a:"",p=void 0===o?void 0:o,S={id:[],def:void 0},b=d.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,r),h=this&&this.includedTemplates?this.includedTemplates:{},v=d.getMarkupGenerator(n);try{var w=v.joinElements([v.createTag("div",{class:"edo-Subtasks"},[v.createTag("div",{class:"gray_delimiter ws-hidden"},[],{},S,this),v.createTag("div",{class:"edo-Subtasks-btn-cont"},[v.createControl("wsControl","ws:SBIS3.EDO2.RulesSelector",{docTypes:[{docType:"СлужЗап"}],content:d.createDataArray([(new function(){var e=Object.create(r),t=function e(t,o,r,s,a){if(void 0===r)var r=arguments[2];var n=0,l="content";if(void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure")),a&&a.isSetts)var i=a.fullContext||{};t=d.isolateScope(Object.create(this),t,l);var c="string"==typeof r?r:"",u={id:[],def:void 0},m=this&&this.includedTemplates?this.includedTemplates:{},S=d.getMarkupGenerator(s);try{var h=S.joinElements([S.createControl("wsControl","ws:SBIS3.CONTROLS.MenuLink",{allowChangeEnable:!1,name:"ruleSelectorMenuLink",caption:global.rk("Подзадача"),icon:"sprite:icon-16 icon-Check icon-primary"},d.plainMerge(o,{name:"ruleSelectorMenuLink",sbisname:"ruleSelectorMenuLink"}),{data:t,ctx:this,pName:void 0!==l?l:void 0,viewController:b},r,p,m,d.config,i)],c,u);u.def&&(h=S.chain(h,u,o),u=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/components/FSubtasks/FSubtasks.tmpl",e,t)}return h||""};this.func=d.makeFunctionSerializable(t,e)}).func]),name:"addSubtaskFromTaskControls",className:"addSubtaskFromTaskControls",lazyLoading:!0,allowChangeEnable:!1,bindings:[{fieldName:"record/toggleSubtaskReestrButton",propName:"visible",propPath:[],fullPropName:"visible",propPathStr:"",oneWay:!0,direction:"fromContext",bindNonExistent:!0}],visible:!1,esc:!1},{name:"addSubtaskFromTaskControls",sbisname:"addSubtaskFromTaskControls"},{data:r,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:b},a,p,h,d.config,u)],{},S,this),v.createTag("div",{class:"edo-Subtasks-brw-cont"},[v.createControl("wsControl","ws:SBIS3.EDO2.Browser",{browserOptions:{itemsActionsVisibility:{edoSaveDocumentOnDisk:!1,edoSendDocument:!1,edoOpenInNewTab:!1},columns:[{cellTemplate:"tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TMainColumn",className:"controls-DataGridView-cell-overflow-ellipsis",templateBinding:{personId:"firstIspPerson",photoId:"firstIspPhoto",photoKey:"photoKeyIsp",showOvertask:!1,complexKeyField:"@Документ",complexKeySubtaskField:"Подзадача"}},{cellTemplate:"tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TStateColumn",className:"controls-DataGridView-cell-overflow-ellipsis",fixedSize:!0,width:130,templateBinding:{showRule:!1,showPhaseExecutor:!0,stateWidth:125},includedTemplates:{edoStateColumn:"tmpl!SBIS3.EDO2.Browser/resources/columns/tmpl/StateColumn"}},{cellTemplate:"tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TDateMonColumn",className:"controls-DataGridView-cell-overflow-ellipsis",fixedSize:!0,width:55,templateBinding:{only_date:!0,date_field:"Дата",ladder_field:"ladderDateInside"},includedTemplates:{DateCol:"tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TDateColumn"}},{cellTemplate:"tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TResponsibleColumn",className:"controls-DataGridView-cell-overflow-ellipsis",fixedSize:!0,width:140,includedTemplates:{edoResponsibleColumn:"tmpl!SBIS3.EDO2.Browser/resources/columns/tmpl/ResponsibleColumn"}}],ladder:["face_foto","date_col"],handlers:{onChangeHoveredItem:d.getTypeFunc("js!SBIS3.EDO.EdoRecOptions:onChangeHoveredItem ",{}),onItemClick:d.getTypeFunc("js!SBIS3.EDO.EdoClicks:clickDisp",{}),onDrawItems:d.getTypeFunc("js!SBIS3.EDO.FSubtasksHandlers:onDrawItems",{})},common:{objectName:d.getter(r,["objectName"]),method:"List",model:"DeliveryListModel.ext"},infiniteScroll:"demand",pageSize:5,scrollPaging:!1,hasSeparator:!1,multiselect:!1,allowChangeEnable:!1,viewMode:"table",hierarchy:{allow:!0,parentProperty:"Раздел",displayProperty:"Название"}},name:"SubtasksTreeBrowser",emptyHTML:"",searchConfig:"",useScrollContainer:!1,esc:!1},{class:"SubtasksTree",name:"SubtasksTreeBrowser",sbisname:"SubtasksTreeBrowser"},{data:r,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:b,internal:{__dirtyCheckingVars_15:d.getter(r,["objectName"])}},a,p,h,d.config,u),v.createTag("component",{"data-component":"SBIS3.EDO2.OpenDialogAction"},[v.createTag("option",{name:"name"},[v.createText("SubtasksTreeAction")],{},S,this),v.createTag("option",{name:"editMode"},[v.createText("newFloatArea")],{},S,this),v.createTag("option",{name:"objectName"},[v.createText("СлужЗап")],{},S,this)],{},S,this)],{},S,this)],s,S,this)],m,S);S.def&&(w=v.chain(w,S,s),S=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/components/FSubtasks/FSubtasks.tmpl",e,r)}return w||""};return r.includedFunctions={},r.stable=!0,r.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FSubtasks/FSubtasks"}},r});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.FSubtasks", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".gray_delimiter{margin-top:8px;margin-bottom:8px;border-top:1px solid #eaeaea}.edo-Subtasks-brw-cont{position:relative}.edo-Subtasks-brw-cont .ws-browser-add-at-place-link{color:#ccc!important;font-size:11px}.edo-Subtasks-brw-cont .ws-browser-add-at-place-link *{color:#ccc!important}.edo-Subtasks-brw-cont .ws-browser-add-at-place-link:hover{color:#ff7033!important}.edo-Subtasks-brw-cont .ws-browser-add-at-place-link .icon-16{display:none}.edo-Subtasks-brw-cont .edo-Browser-state.edo-Browser-State--visible-state-icons .edo-Browser-states-wrapper .edo-Browser-state-main-states{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:16px}.edo-Subtasks-brw-cont .controls-TreeView__expand{display:none!important}.edo-Subtasks-brw-cont .rt_left{width:34px;position:relative;left:7px}.edo-Subtasks-btn-cont{margin-left:8px}.SubtasksTree.edo-Browser .controls-Browser__view table.controls-DataGridView__table{table-layout:fixed}.SubtasksTree.edo-Browser .controls-Browser__view .first-base-line:before{font-size:18px;line-height:18px}.SubtasksTree.edo-Browser .controls-Browser__view .text-base-line.first-base-line{line-height:18px}.SubtasksTree.edo-Browser .controls-Browser__view .text-base-line.second-base-line{line-height:18px}.SubtasksTree.edo-Browser .controls-Browser__view .second-base-line:before{font-size:16px;line-height:18px}.SubtasksTree .controls-ListView__serviceFooter{padding-left:16px}.SubtasksTree .controls-ListView__serviceFooter .controls-ListView__counter{display:none}.SubtasksTree .controls-DataGridView__td.controls-DataGridView-cell-overflow-ellipsis{padding:3px 10px}.SubtasksTree .rt_wrapper{margin-left:5px}.SubtasksTree .rt_wrapper.edo-BrowserWrapper-MainColumn__subtask-indent{margin-left:72px}.edo-Dialog .SubtasksTree .rt_wrapper.edo-BrowserWrapper-MainColumn__subtask-indent{margin-left:58px}.edo-Dialog .SubtasksTree .rt_right{padding-left:16px}.edo-Dialog .SubtasksTree .Person-PersonPhoto__img{width:32px!important;height:32px!important}.edo-Dialog .SubtasksTree .edo-Browser-State__active-phase-text.edo-Browser__first-base-line{top:-2px}.edo-Dialog .SubtasksTree .edo-Browser-State__active-phase-text.edo-Browser__second-base-line{position:relative;top:-2px}.edo-Dialog .SubtasksTree .edo-Browser-State__wrapper.ws-hidden~.edo-Browser-State__executor{top:-2px;position:relative}.edo-Dialog .SubtasksTree .edo-Browser-Responsible--without-photo{top:-2px}.edo-Dialog .SubtasksTree .edo-Browser-State__active-phase-pause-icon{top:-2px;position:relative}.edo-Dialog .addSubtaskFromTaskControls{margin-left:2px}"));head.appendChild(style);});}
define('js!SBIS3.EDO.FSubtasksHandlers',['Elektronnyj_dokumentooborot_localization'],function(){'use strict';return{onDrawItems:function(t){var e=this.getLinkedContext().getValue('record'),s=this.getDataSet();if(s)if(0===s.getCount())e.set('ДокументРасширение.ЧислоПодзадач',0),this.sendCommand('update'),this.hide();else this.show();}};});
define('js!SBIS3.EDO.FSubtasks',['Core/EventBus','SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FSubtasks/FSubtasks','WS.Data/Source/SbisService','js!SBIS3.EDO.TaskRegistryModel','WS.Data/Di','css!SBIS3.EDO.FSubtasks','js!SBIS3.EDO.EdoRecOptions','js!SBIS3.EDO.EdoClicks','js!SBIS3.EDO.FSubtasksHandlers','css!SBIS3.EDO.TaskCol','css!SBIS3.EDO.BrowserWrapperPP/resources/columnStyles','tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TMainColumn','tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TStateColumn','tmpl!SBIS3.EDO2.Browser/resources/columns/tmpl/StateColumn','tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TDateMonColumn','tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TDateColumn','tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TResponsibleColumn','tmpl!SBIS3.EDO2.Browser/resources/columns/tmpl/ResponsibleColumn','i18n!SBIS3.EDO.FSubtasks','Elektronnyj_dokumentooborot_localization'],function(e,s,t,r,o,n){'use strict';var i=s.extend({$protected:{_options:{name:'FSubtasks',parentTask:null,viewMode:'document',rmBrowser:null,countSubtasks:null,drawColumns:{reestr:{colResponsible:true}}}},_dotTplFn:t,setDSAndVisibility:function(e,s){n.register('TaskRegistryModel',function(e){return new o(e);});var t=new r({endpoint:'СлужЗап',binding:{query:'СписокПодзадач'},model:'TaskRegistryModel',handlers:{onBeforeProviderCall:function(e,t,r){switch(t){case'СписокПодзадач':if(!r['Фильтр'].has('Надзадача'))r['Фильтр'].addField({name:'Надзадача',type:'string'});if(!r['Фильтр'].has('РассчитатьФото'))r['Фильтр'].addField({name:'РассчитатьФото',type:'string'});if(!r['Фильтр'].has('ВключитьСписокИсполнителей'))r['Фильтр'].addField({name:'ВключитьСписокИсполнителей',type:'string'});if(!r['Фильтр'].has('ПростыеВД'))r['Фильтр'].addField({name:'ПростыеВД',type:'string'});if(!r['Фильтр'].has('ДокументЧерновик'))r['Фильтр'].addField({name:'ДокументЧерновик',type:'integer'});r['Фильтр'].set('Надзадача',''+s.getLinkedContext().getValue('record').get('@Документ')),r['Фильтр'].set('РассчитатьФото','true'),r['Фильтр'].set('ВключитьСписокИсполнителей','true'),r['Фильтр'].set('ПростыеВД','true'),r['Фильтр'].set('ДокументЧерновик',1);}}}});s.getView().setDataSource(t),e.setVisible(true);},setCountSubtasks:function(e){var s=this,t=s.getChildControlByName('SubtasksTreeBrowser');if(s._options.countSubtasks=e,e>0)i.prototype.setDSAndVisibility(s,t);else s.setVisible(false);},$constructor:function(){var e=this;if(e._options.countSubtasks)e.waitChildControlByName('SubtasksTreeBrowser').addCallback(function(s){if(!s.getView().getDataSource())i.prototype.setDSAndVisibility(e,s);});},getOptions:function(){return this._options;},init:function(){i.superclass.init.call(this);var s=this,t=this.getTopParent(),r=t&&t.getOpener(),o=r&&r.getParent(),n=o&&o.hasChildControlByName('browserView')&&o.getChildControlByName('browserView'),a=s.getChildControlByName('SubtasksTreeBrowser');s.subscribeTo(a,'onFinishCommand',function(s,t){if('edoDeleteDocument'===t.commandName)if(a.getView().reload(),t.args.length)e.channel('DeleteChannel').notify('deleteToTrash',[t.args[0].rowData.id]);}),s.subscribeTo(e.channel('DeleteChannel'),'deleteToTrash',function(t,r){if(s.sendCommand('edoUpdateFullTrace'),r&&r.length>0){for(var o=[],i,a=0;a<r.length;a++)if(r.hasOwnProperty(a))if(i=parseInt(r[a],10),i)o.push(i);if(o.length>0)e.channel('EdoPartialReloader').notify('onDeleteSubTask',{id:n&&n.getId(),docs:o});}});}});return i;});
define("html!SBIS3.EDO.TermMilestoneLink",function(){var e=function(e){var n=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;e.test(n);)n=n.replace(e,"&#123;&#123;$1&#125;&#125;");return n}}(),o="undefined"!=typeof process,t=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,"<div> <component data-component='SBIS3.CONTROLS/Link' name='termMilestoneLink' class='termMilestoneLink'> <option name='enabled'>true</option> <options name='handlers'> <option name='onActivated' type='function'>js!SBIS3.EDO.TermMilestoneLink:prototype.onActivated</option> </options> </component> </div>");return(t=n(t))+(o&&-1!==t.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.TermMilestoneLink"}},e});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.TermMilestoneLink", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".termMilestoneLinkComponent{min-width:259px}.termMilestoneLink{float:right;line-height:18px;display:inline-block}.termMilestoneLink .milstoneDiv{float:right}.termMilestoneLink span.countMilestones{float:right;margin-left:16px}.termMilestoneLink .nameMilestone,.termMilestoneLink .nameMilestone div{white-space:nowrap;float:right;overflow:hidden;text-overflow:ellipsis;text-align:right}.termMilestoneLink .nameMilestone div{max-width:103px}.termMilestoneLink>.nameMilestone>.countMilestones,.termMilestoneLink>.term{white-space:pre}.termMilestoneLink .iconBlock div{display:block!important}.termMilestoneLink:hover span>div{text-decoration:underline}.termMilestoneLink .startDocDiv{float:right;white-space:pre}.milstoneDiv.difTermTriangle{max-width:10px;width:10px;margin-left:-6px;margin-top:-1px}"));head.appendChild(style);});}
define("html!SBIS3.EDO.TermMilestoneDlg",function(){var o=function(o){var n=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;o.test(n);)n=n.replace(o,"&#123;&#123;$1&#125;&#125;");return n}}(),t=function(o){return o.join?o.join(""):o.toString()},e=function(o){return void 0===o?"":o&&"object"==typeof o?t(o):""+o},i="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="termMilestoneDlg"> <div class="termBlock"> ');return o.showStart&&(a+=' <span class="labelDate">'+n(e(rk("Период")))+'</span> <component data-component="SBIS3.CONTROLS/Date/Picker" name="startDate" class="startDatePicker"> <option name="date">'+n(e(o.startDate))+'</option> <option name="allowChangeEnable">false</option> <option name="tabindex">1</option> <options name="validators" type="array"> <options> <option name="validator" type="function" value="js!SBIS3.EDO.TermMilestoneDlg:prototype.checkStartDate"></option> </options> </options> </component> <component data-component="SBIS3.CONTROLS/Link" name="clearStartDateButton" class="clearDateButton"> <option name="icon">sprite:icon-16 icon-Close icon-primary</option> <option name="tooltip">'+n(e(rk("Сбросить дату начала")))+'</option> <option name="allowChangeEnable">false</option> <option name="tabindex">10</option> <options name=\'handlers\'> <option name="onActivated" type="function">js!SBIS3.EDO.TermMilestoneDlg:prototype.clearStartDate</option> </options> </component> <span class="labelDate">'+n(e(rk("-")))+"</span> "),a+=' <component data-component="SBIS3.CONTROLS/Date/Picker" name="termDate" class="termDatePicker"> <option name="allowChangeEnable">false</option> <option name="tabindex">2</option> <option name="date">'+n(e(o.termDate))+'</option> <options name="validators" type="array"> <options> <option name="validator" type="function" value="js!SBIS3.EDO.TermMilestoneDlg:prototype.checkDocDate"></option> </options> ',o.showMilestone&&(a+=' <options> <option name="validator" type="function" value="js!SBIS3.EDO.TermMilestoneDlg:prototype.checkMilestoneDate"></option> </options> '),a+=' </options> </component> <component data-component="SBIS3.CONTROLS/Link" name="clearTermDateButton" class="clearDateButton"> <option name="icon">sprite:icon-16 icon-Close icon-primary</option> <option name="tooltip">'+n(e(rk("Сбросить дату окончания")))+'</option> <option name="allowChangeEnable">false</option> <option name="tabindex">20</option> <options name=\'handlers\'> <option name="onActivated" type="function">js!SBIS3.EDO.TermMilestoneDlg:prototype.clearTermDate</option> </options> </component> <component data-component="SBIS3.CONTROLS/Link" name="ButtonClose" class="termDlgButtonClose ws-field-button ws-button-classic sbisname-window-title-close"> <option name="allowChangeEnable">false</option> <option name="tabindex">4</option> <options name="handlers"> <option name="onActivated" type="function">js!SBIS3.EDO.TermMilestoneDlg:prototype.closeDlg</option> </options> </component> <component data-component="SBIS3.CONTROLS/Button/IconButton" name="ButtonOk" class="termDlgButtonOk controls-IconButton controls-ButtonBase ws-enabled controls-IconButton__doneBorder controls-IconButton__round-border"> <option name="icon">sprite:icon-16 icon-Yes icon-done</option> <option name="allowChangeEnable">false</option> <option name="primary">true</option> <option name="tabindex">3</option> <option name="tooltip">'+n(e(rk("Подтвердить")))+"</option> <options name='handlers'> <option name='onActivated' type='function'>js!SBIS3.EDO.TermMilestoneDlg:prototype.confirmChange</option> </options> </component> </div> <div class='clearfix'></div> ",o.extManager.checkExtensions(["УПРАВЛЕНИЕ_ПРОЕКТАМИ"])["УПРАВЛЕНИЕ_ПРОЕКТАМИ"]&&(a+=' <div class="milestoneLinkBlock ',o.showMilestone&&!o.countMilestones||!o.beta||(a+="ws-hidden"),a+="\"> <component data-component='SBIS3.CONTROLS/Link' name='milestoneSelectionLink' class='milestoneSelectionLink'> <option name='enabled'>"+n(e(o.showMilestonesLink))+"</option> <option name='caption'>"+n(e(rk("или веха")))+"</option> <option name=\"tabindex\">5</option> <options name='handlers'> <option name='onActivated' type='function'>js!SBIS3.EDO.TermMilestoneDlg:prototype.onMilestoneSelectionActivated</option> </options> </component> <div class=\"milestoneLinkHint\">"+n(e(rk("в качестве срока окончания работы")))+"</div> </div> "),a+=' <component data-component="SBIS3.CONTROLS/DataGridView" class="milestonesDataView"> <opt name="name">milestonesView</opt> <opt name="visible">',o.extManager.checkExtensions(["УПРАВЛЕНИЕ_ПРОЕКТАМИ"])["УПРАВЛЕНИЕ_ПРОЕКТАМИ"]&&o.showMilestone&&o.milestones?a+=" true ":a+=" false ",a+='</opt> <opt name="showPaging" type="boolean">false</opt> <option name="tabindex">6</option> <opt name="showHead" type="boolean">false</opt> <opt name="keyField">@Документ</opt> <opt name="resultsPosition" value="bottom" type="string"></opt> <opt name="resultsText" value="Всего" type="string"></opt> <opt name="resultsTpl" value="html!SBIS3.EDO.MilestoneTotalTpl"></opt> <opts name="columns" type="array"> <opts> <option name="field">Дата</option> <option name="width" type="string">75</option> <option name="cellTemplate">html!SBIS3.EDO.MilestoneDateCol</option> </opts> <opts> <opt name="field">Название</opt> <option name="width" type="string">325</option> <option name="cellTemplate">html!SBIS3.EDO.MilestoneNameCol</option> </opts> </opts> <options name="itemsActions" type="array"> <options> <option name="icon">icon-16 icon-Erase icon-error</option> <option name="name">delete</option> <option name="tooltip">'+n(e(rk("Удалить")))+'</option> <option name="caption">'+n(e(rk("Удалить")))+'</option> <option name="isMainAction">true</option> <option name="onActivated" type="function">js!SBIS3.EDO.EdoRecOptions:deleteRecord</option> </options> </options> <options name="dataSource"> <options name="readerParams"> <option name="createMethodName">Создать</option> <option name="destroyMethodName">Удалить</option> <option name="format">Веха.Список</option> <option name="linkedObject">Веха</option> <option name="queryName">СписокPy</option> <option name="readMethodName">Прочитать</option> <option name="updateMethodName">Записать</option> <option name="nameApplication">Основной сервис inside</option> <option name="nameService">Основной сервис inside</option> </options> <options name="filterParams"> <options name="ФильтрПоДокументуСледствию"> <option name="saveToState">false</option> <option name="fieldName">ФильтрПоДокументуСледствию</option> </options> </options> </options> <options name=\'handlers\'> <option name=\'onItemClick\' type=\'function\'>js!SBIS3.EDO.TermMilestoneDlg:prototype.onMilestoneItemClick</option> <option name=\'onChangeHoveredItem\' type=\'function\'>js!SBIS3.EDO.TermMilestoneDlg:prototype.onChangeHoveredItem</option> <option name=\'onEndDelete\' type=\'function\'>js!SBIS3.EDO.TermMilestoneDlg:prototype.onEndDelete</option> </options> </component> <component data-component="SBIS3.EDO2.OpenDialogAction" name="openDialogAction"></component> <component data-component="SBIS3.CONTROLS/Action/SelectorAction" name="milesoneSelectorAction"> <option name=\'mode\'>floatArea</option> <option name=\'template\'>js!SBIS3.Milestones.MilestoneSelectorDialog</option> <option name=\'multiselect\' type=\'boolean\' value=\'true\'></option> </component> ',o.beta&&(a+=" <component data-component='SBIS3.CONTROLS/Link' class='milestoneAdd'> <option name='name'>milestoneAddLink</option> <option name='caption'>"+n(e(rk("Добавить веху")))+"</option> <option name='visible'>",o.countMilestones?a+="true":a+="false",a+="</option> <options name='handlers'> <option name='onActivated' type='function'>js!SBIS3.EDO.TermMilestoneDlg:prototype.onMilestoneSelectionActivated</option> </options> </component> "),a+=" ",o.beta,a+=" </div>",(a=n(a))+(i&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.TermMilestoneDlg"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.TermMilestoneDlg", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".termMilestoneDlg{width:400px}.termMilestoneDlg .termBlock{background-color:#f9f9f9;height:24px;padding:8px}.termMilestoneDlg .clearDateButton{cursor:pointer;display:inline-block;float:left;padding-top:2px}.termMilestoneDlg .startDatePicker,.termMilestoneDlg .termDatePicker{float:left}.termMilestoneDlg .labelDate{float:left;font-size:14px;font-family:TensorFont,sans-serif;color:#999;margin-right:8px;margin-top:2px}.termMilestoneDlg .termDlgButtonOk{float:right;margin-right:34px;margin-top:-1px}.termMilestoneDlg .controls-IconButton.controls-IconButton__round-border{height:26px;width:26px}.termMilestoneDlg .milestoneLinkBlock{margin-left:8px;margin-bottom:8px;height:22px;display:inline-block}.termMilestoneDlg .milestoneLinkBlock .milestoneLinkHint{display:inline-block;color:#999;cursor:default}.termMilestoneDlg .milestonesDataView .dateMilestone{margin-left:4px}.termMilestoneDlg .milestonesDataView .colMilestoneName{padding-right:4px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.termMilestoneDlg .milestonesDataView .completedMilestone{color:#999}.termMilestoneDlg .milestonesDataView .milestoneTotal{float:right;color:#999;font-size:12px;font-weight:400;padding-bottom:8px;padding-right:8px}.termMilestoneDlg .clearfix{clear:both}.termMilestoneDlg .milestone_history_head{color:#313e78;font-family:TensorFont,sans-serif;font-weight:700;display:inline-block;margin-left:14px}.termMilestoneDlg .milestoneAdd{margin-left:12px;float:left;margin-top:-28px}.termMilestoneDlg .dateMilestone{margin-left:8px}"));head.appendChild(style);});}
define("html!SBIS3.EDO.MilestoneDateCol",function(){var e=function(e){var t=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;e.test(t);)t=t.replace(e,"&#123;&#123;$1&#125;&#125;");return t}}(),n=function(e){return e.join?e.join(""):e.toString()},r=function(e){return void 0===e?"":e&&"object"==typeof e?n(e):""+e},o="undefined"!=typeof process,i=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,""),l=new Date,s=e.item.get(e.field),d="";return l.setHours(0,0,0,0),s&&s<l&&(d="completedMilestone"),i+=" ",e.item.get(e.field)&&(i+=' <div title="'+t(r(rk("Дата")))+'" class="dateMilestone '+t(r(d))+'">'+t(r(e.item.get(e.field).strftime("%d.%m.%y")))+"</div> "),(i=t(i))+(o&&-1!==i.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.MilestoneDateCol"}},e});
define('js!SBIS3.EDO.MilestoneDateCol',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.MilestoneDateCol','Elektronnyj_dokumentooborot_localization'],function(t,n){'use strict';var o=t.extend({_dotTplFn:n,$protected:{_options:{}},$constructor:function(){},init:function(){o.superclass.init.call(this);}});return o;});
define("html!SBIS3.EDO.MilestoneNameCol",function(){var e=function(e){function t(e){return"string"==typeof e?e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"):e}var r=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;e.test(t);)t=t.replace(e,"&#123;&#123;$1&#125;&#125;");return t}}(),n=function(e){return e.join?e.join(""):e.toString()},o=function(e){return void 0===e?"":e&&"object"==typeof e?n(e):""+e},i="undefined"!=typeof process,l=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,""),t=function(e){return e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"):""},a=new Date,u=e.item.get("Дата"),c="";return a.setHours(0,0,0,0),u&&u<a&&(c="completedMilestone"),l+=" ",e.item.get(e.field)&&(l+=' <div title="'+r(o(t(e.item.get(e.field))))+'" class="colMilestoneName '+r(o(c))+'"> '+r(o(t(e.item.get(e.field))))+" </div> "),(l=r(l))+(i&&-1!==l.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.MilestoneNameCol"}},e});
define('js!SBIS3.EDO.MilestoneNameCol',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.MilestoneNameCol','Elektronnyj_dokumentooborot_localization'],function(t,n){'use strict';var o=t.extend({_dotTplFn:n,$protected:{_options:{}},$constructor:function(){},init:function(){o.superclass.init.call(this);}});return o;});
define("html!SBIS3.EDO.MilestoneTotalTpl",function(){var e=function(e){var t=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;e.test(t);)t=t.replace(e,"&#123;&#123;$1&#125;&#125;");return t}}(),r=function(e){return e.join?e.join(""):e.toString()},n=function(e){return void 0===e?"":e&&"object"==typeof e?r(e):""+e},o="undefined"!=typeof process,i=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<tr class="controls-DataGridView__results"> <td colspan="2"> <div class="milestoneTotal">'+t(n(rk("Всего")))+": "+t(n(e.item.get("Всего")))+"</div> </td> </tr>");return(i=t(i))+(o&&-1!==i.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.MilestoneTotalTpl"}},e});
define('js!SBIS3.EDO.MilestoneTotalTpl',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.MilestoneTotalTpl','Elektronnyj_dokumentooborot_localization'],function(t,n){'use strict';var o=t.extend({_dotTplFn:n,$protected:{_options:{}},$constructor:function(){},init:function(){o.superclass.init.call(this);}});return o;});
define('js!SBIS3.EDO.TermMilestoneDlg',['Core/Deferred','SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.TermMilestoneDlg','Core/helpers/date-helpers','Core/helpers/fast-control-helpers','Core/constants','Core/RightsManager','Core/UserInfo','Core/EventBus','WS.Data/Source/SbisService','WS.Data/Entity/Model','WS.Data/Collection/RecordSet','WS.Data/Adapter/Sbis','WS.Data/Entity/Record','SBIS3.CONTROLS/Action/SelectorAction','js!SBIS3.EDO2.OpenDialogAction','optional!js!SBIS3.Milestones.MilestoneSelectorDialog','css!SBIS3.EDO.TermMilestoneDlg','js!SBIS3.EDO.EdoRecOptions','SBIS3.CONTROLS/Date/Picker','SBIS3.CONTROLS/DataGridView','SBIS3.CONTROLS/Link','SBIS3.CONTROLS/Button/IconButton','js!SBIS3.EDO.MilestoneDateCol','js!SBIS3.EDO.MilestoneNameCol','js!SBIS3.EDO.MilestoneTotalTpl','Elektronnyj_dokumentooborot_localization'],function(e,t,n,o,i,s,r,a,l,c,g,d,h,u){'use strict';var f=t.extend({_dotTplFn:n,$protected:{_options:{beta:false}},$constructor:function(){},init:function(){f.superclass.init.call(this);var e=this;if(e.getChildControlByName('termDate').subscribe('onKeyPressed',e.onTermKeyPressed),e._options.showMilestone&&e._options.milestones)e._setMilestoneRS(e._options.milestones.clone());},_checkRight:function(e){if(!e)return false;var t=e.get('Состояние'),n=a.get('ЧастноеЛицо')===e.get('Ответственный'),o=a.get('ЧастноеЛицо')===e.get('Автор'),i=e.get('Пометки')?e.get('Пометки')[2]:null,s=!!r.checkAccessRights(['Администратор вех']),l=r.checkAccessRights(['Добавление в закрытые вехи']),c=!!r.checkAccessRights(['Вехи']),g=this._options.termMilestonesParentTask&&-1!==this._options.termMilestonesParentTask.indexOf(parseInt(e.getId(),10));if(i){if(o||n)return true;}else if(s)return true;else if(n||2===l||g)return 0===t||1===t||2===t;else if(c)return 0===t||1==t;},_milestoneSelectorRSToViewRS:function(e){var t=[],n=[],o=[{n:'@Документ',t:'Идентификатор'},{n:'Состояние',t:'Число целое'},{n:'Название',t:'Строка'},{n:'Дата',t:'Дата'},{n:'Ответственный',t:'Число целое'}];if(e)e.each(function(e){var o=e.get('@Документ');if(-1==n.indexOf(o))n.push(o),t.push([o,e.get('Веха.Состояние')?e.get('Веха.Состояние').get():null,e.get('ДокументРасширение.Название'),e.get('Веха.Дата'),e.get('Сотрудник.@Лицо')]);});return new d({rawData:{_type:'recordset',d:t,s:o},adapter:new h()});},_milestoneViewRSToDlgRS:function(e){var t=[],n=[{n:this._options.idMilestoneFieldName,t:'Идентификатор'},{n:'Состояние',t:'Число целое'},{n:this._options.nameMilestoneFieldName,t:'Строка'},{n:this._options.termMilestoneFieldName,t:'Дата'},{n:'Ответственный',t:'Число целое'}];if(e)e.each(function(e){t.push([e.get('@Документ'),e.get('Состояние'),e.get('Название'),e.get('Дата'),e.get('Ответственный')]);});return new d({rawData:{_type:'recordset',d:t,s:n},adapter:new h()});},_milestonViewRSToSelectorRS:function(e){var t=[],n=[['@Документ','Идентификатор','identity'],['Веха.Состояние','Перечисляемое','enum'],['ДокументРасширение.Название','Строка','string'],['Веха.Дата','Дата','date'],['Сотрудник.@Лицо','Число целое','integer']];function o(e){return n.reduce(function(t,n){var o={};return o[e?'n':'name']=n[0],o[e?'t':'type']=n[e?1:2],t.push(o),t;},[]);}if(e)e.each(function(e){t.push([e.get('@Документ'),e.get('Состояние'),e.get('Название'),e.get('Дата'),e.get('Ответственный')]);});return new d({rawData:{_type:'recordset',d:t,s:o(true)},adapter:new h(),format:o()});},_sortMilestoneRS:function(e){if(e){var t=[];e.each(function(e){t.push(e);}),t.sort(function(e,t){return o.compareDates(e.get('Дата'),'>=',t.get('Дата'));}),e.clear(),e.append(t);}return e;},_openMilestoneSelectorDialog:function(){var t=this,n=new Date(),o=new e(),i=this.getChildControlByName('milestonesView'),s={multiselect:true,dialogOptions:{className:'ws-float-area__block-layout'},componentOptions:{checkRights:true,fullFilter:false,filterByDate:n,termMilestones:this._options.termMilestonesParentTask,forbidSelectFolder:true,selectionType:'leaf'},selectedItems:this._milestonViewRSToSelectorRS(i.getItems()),opener:t,parent:t},r=this.getParent().getChildControlByName('milesoneSelectorAction');r.once('onExecuted',function(e,t,n){o.callback(n);}),r.execute(s),o.addCallback(function(e){if(!e)return;var n=t._milestoneSelectorRSToViewRS(e),o=t._getMilestoneTerm(n);if(t._setMilestoneRS(n),t.hasChildControlByName('milestoneAddLink'))t.getChildControlByName('milestoneAddLink').toggle(!!n.getCount());var i=t.getContainer().find('.milestoneLinkBlock');if(t._options.beta)if(i&&n.getCount())i.addClass('ws-hidden');else if(!n.getCount())i.removeClass('ws-hidden');if(o)t.getChildControlByName('termDate').setDate(o);});},_formRSResults:function(e){var t=e?e.getCount():0,n;if(e)n=new g({idProperty:'Всего',rawData:{'Всего':t}}),e.getMetaData().results=n;},_setMilestoneRS:function(e){var t=this.hasChildControlByName('milestonesView')?this.getChildControlByName('milestonesView'):null,n=t&&e?e.getCount():0;if(this._formRSResults(e),!t)return;t.setItems(this._sortMilestoneRS(e)),t.toggle(!!n);},_getMilestoneTerm:function(e){if(this._options.showMilestone){var e=e||this.getChildControlByName('milestonesView').getItems();if(this._sortMilestoneRS(e)&&e.getCount())return e.at(0).get('Дата');}return null;},_termIsChange:function(e,t){return e=e||this._options.dlgRec.get(this._options.termFieldName),t=t||this.getChildControlByName('termDate').getDate(),t&&!e||!t&&e||o.compareDates(t,'!=',e);},_milestoneListIsChange:function(e,t){if(!this._options.showMilestone)return false;e=e||this._options.milestones,t=t||this.getChildControlByName('milestonesView').getItems();var n=function(e){var t=[];if(e)e.each(function(e){t.push(parseInt(e.getId(),10));});return t;},o=n(e),i=n(t);if(o.length===i.length){for(var s=0;s<o.length;s++)if(o.indexOf(i[s])<0)return true;}else return true;return false;},_confirmTMChanges:function(){var e=this,t=this.getChildControlByName('termDate'),n=e._options.dlgRec,o=t.getDate()||e._getMilestoneTerm(),i=n.get(e._options.termFieldName),s=null,r=null,a=e._options.docDlg,g=e._options.isAvailablePM;if(!t.validate())return;if(e._options.showStart){var d=e.getChildControlByName('startDate');if(!d.validate())return;s=d.getDate(),r=n.get(e._options.startFieldName);}if(e._termIsChange(i,o)||e._termIsChange(s,r)){if(o)o.setHours(23,59,59);if(n.set(e._options.termFieldName,o),delete n._changedFields[e._options.termFieldName],e._options.showStart)n.set(e._options.startFieldName,s),delete n._changedFields[e._options.startFieldName];var f=new c({endpoint:'Документ'}),m='',C={};if(g){m='ЗаписатьСрокиДокументаNew';var p=new u({rawData:{_type:'record',d:[e._options.docId,s?s.toSQL():null,o?o.toSQL():null],s:[{n:'Документ',t:'Число целое'},{n:'ДатаНачала',t:'Дата и время'},{n:'ДатаОкончания',t:'Дата и время'}]},adapter:new h()});C['Параметры']=p;}else m='ЗаписатьСрокДокумента',C['Документ']=e._options.docId,C['Дата']=o?o.toSQL(true):null;f.call(m,C).addCallback(function(){if(e._options.reloadEventChannel){var t=n.has('ТипДокумента.ТипДокумента')?n.get('ТипДокумента.ТипДокумента'):null;l.channel(e._options.reloadEventChannel).notify('needBrowserReload',t);}if(a)a._notify('onUpdateModel',n,{isNewRecord:void 0,key:n.getId()});});}if(e._options.showMilestone){var S=e.getChildControlByName('milestonesView').getItems();if(n.set(e._options.milestonesFieldName,e._milestoneViewRSToDlgRS(S)),delete n._changedFields[e._options.milestonesFieldName],e._milestoneListIsChange()){var _=[],D=new c({endpoint:'Веха'});if(S)S.each(function(e){_.push(parseInt(e.getId(),10));});D.call('ЗаписатьВехуДокумента',{'ДокументСледствие':e._options.docId,'Вехи':_,'Добавить':false}).addCallback(function(e){if(a)a._notify('onUpdateModel',n,{isNewRecord:void 0,key:n.getId()});});}}e.getParent().getOpener().setCaptionByRecDlg(),e.getParent().close();},onMilestoneSelectionActivated:function(){this.getParent()._openMilestoneSelectorDialog();},checkDocDate:function(){var e=this.getParent()._options.creationDate,t=this.getDate();if(e&&t&&o.compareDates(t,'<',e))return rk('Срок не может быть меньше даты создания документа!');else return true;},checkMilestoneDate:function(){var e=this.getParent(),t=this.getDate(),n=e._getMilestoneTerm();if(t&&n&&o.compareDates(t,'>',n))return rk('Срок не может превышать срок ближайшей вехи!');else return true;},checkStartDate:function(){var e=this.getDate(),t=this.getParent().getChildControlByName('termDate').getDate();if(e&&t&&o.compareDates(e,'>',t))return rk('Дата начала периода не может превышать дату конца!');else return true;},clearStartDate:function(){this.getParent().getChildControlByName('startDate').setDate(null);},clearTermDate:function(){this.getParent().getChildControlByName('termDate').setDate(null);},closeDlg:function(){var e=this.getParent(),t=e.getParent();if(e._termIsChange()||e._milestoneListIsChange())i.question(rk('Сохранить изменения?'),{},e).addCallback(function(n){if(true===n)e._confirmTMChanges();else if(false===n)t.close();});else t.close();},onTermKeyPressed:function(e,t){if(t.keyCode==s.key.enter)this.getParent()._confirmTMChanges();},confirmChange:function(){this.getParent()._confirmTMChanges();},onMilestoneItemClick:function(e,t){var n=this.getParent(),s=n.getChildControlByName('milestonesView'),r=s.getContainer(),a=n.getChildControlByName('termDate'),l=n.getChildControlByName('openDialogAction');l.once('onExecuted',function(e,l,g){i.toggleLocalIndicator(r,true),new c({endpoint:'Веха'}).call('Прочитать',{'ИдО':t,'ИмяМетода':'Веха.Список'}).addCallback(function(e){var l=e.getRow(),c=s.getItems(),g=c.getRecordById(t),d=g.get('Дата'),h=l.get('Веха.Дата');if(g.set('Название',l.get('Веха.Название')),g.set('Дата',l.get('Веха.Дата')),g.set('Состояние',l.get('Веха.Состояние')),n._setMilestoneRS(c),o.compareDates(d,'!=',h)){var u=n._getMilestoneTerm(c);a.setDate(u);}i.toggleLocalIndicator(r,false);});}),l.execute({id:t});},onChangeHoveredItem:function(e,t){var n=this.getDataSet()?this.getDataSet().getRecordById(t.key):false,o=this.getItemsActions().getItemsInstances();for(var i in o)if(o.hasOwnProperty(i))switch(i){case'delete':o[i][this.getParent()._checkRight(n)?'show':'hide']();break;default:o[i].show();}},onEndDelete:function(){var e=this.getParent(),t=this.getItems(),n=e._getMilestoneTerm(t);if(e._setMilestoneRS(t),e.getChildControlByName('termDate').setDate(n),!t.getCount()&&e._options.beta)e.getChildControlByName('milestoneAddLink').toggle(false),e.getContainer().find('.milestoneLinkBlock').removeClass('ws-hidden');}});return f;});
define('js!SBIS3.EDO.TermMilestoneLink',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.TermMilestoneLink','Core/RightsManager','Core/ExtensionsManager','Core/constants','Core/helpers/date-helpers','Core/helpers/string-helpers','Core/helpers/fast-control-helpers','Core/ParallelDeferred','WS.Data/Source/SbisService','css!SBIS3.EDO.TermMilestoneLink','SBIS3.CONTROLS/Link','js!SBIS3.EDO.TermMilestoneDlg','Elektronnyj_dokumentooborot_localization'],function(e,t,i,s,o,n,l,a,r,d){'use strict';var m=e.extend({_dotTplFn:t,$protected:{_options:{termFieldName:'ДокументРасширение.Срок',startFieldName:void 0,milestonesFieldName:'Вехи',termMilestoneFieldName:'Дата',nameMilestoneFieldName:'Название',idMilestoneFieldName:'@Документ',docIdFieldName:'@Документ',termIsChangeFieldName:void 0,creationDateFieldName:void 0,termField:void 0,milestonesField:void 0,startField:void 0,curRecord:void 0},_isMlstAccessRights:false,_isPMExtensions:false,_isPMModule:false,_linkCtrl:void 0},$constructor:function(){},getTermField:function(){return this._options.termField;},setTermField:function(e){this._options.termField=e,this.setCaptionByRecDlg();},getStartField:function(){return this._options.startField;},setStartField:function(e){this._options.startField=e,this.setCaptionByRecDlg();},getMilestonesField:function(){return this._options.milestonesField;},setMilestonesField:function(e){this._options.milestonesField=e,this.setCaptionByRecDlg();},getCurRecord:function(){return this._options.curRecord;},setCurRecord:function(e){this._options.curRecord=e,this.setCaptionByRecDlg();},_getDlgRecord:function(){var e=this.getLinkedContext();return this.getCurRecord()||e.getValue('record');},_allowShowMilestone:function(){var e=this._getDlgRecord();return this._isMlstAccessRights&&this._isPMExtensions&&this._isPMModule&&e.has(this._options.milestonesFieldName);},_isAvailablePM:function(){return this._isPMExtensions&&this._isPMExtensions;},_getCurrentMilestone:function(e){var t=this._options.termMilestoneFieldName,i=this._getCountMilestones(e)?e.at(0):null,s=new Date();return e.each(function(e){var o=i.get(t),l=e.get(t);if(n.compareDates(l,'>=',s)&&n.compareDates(l,'<',o))i=e;}),i;},_getDifTermsBlock:function(e,t,i){var s='';if(n.compareDates(e,'!=',t)||i)s='<div class="milstoneDiv difTermTriangle">'+'<span class="icon-16 icon-Listbox icon-attention" title="'+(i?rk('Изменен срок'):rk('Срок отличается от даты вехи'))+'"></span>'+'</div>';else if(this._options.startFieldName)s='<div class="milstoneDiv difTermTriangle"></div>';return s;},_getCountMiesonesBlock:function(e){var t='';if(e>1)t='<div class="milstoneDiv iconBlock" >'+'<div class="ws-button-image ws-hover-target icon-16 icon-BadToGood icon-primary"></div>'+'<span class="countMilestones">('+e+') </span>'+'</div>';return t;},_getStartBlock:function(e){var t='';if(e)t='<div class="startDocDiv">'+e.strftime('%d.%m.%y')+'&nbsp;/&nbsp;'+'</div>';return t;},_getCountMilestones:function(e){if(e)if($.isFunction(e.getCount))return e.getCount();else if($.isFunction(e.getRecordCount))return e.getRecordCount();return 0;},setCaptionByRecDlg:function(){var e=this._getDlgRecord(),t=this._linkCtrl.getContainer(),i='',s=e.has(this._options.termFieldName)&&e.get(this._options.termFieldName)?e.get(this._options.termFieldName):null,o=this._options.startFieldName&&e.has(this._options.startFieldName)&&e.get(this._options.startFieldName)?e.get(this._options.startFieldName):null,n=s?s.strftime('%d.%m.%y'):'',a=this._options.termIsChangeFieldName&&e.has(this._options.termIsChangeFieldName)?e.get(this._options.termIsChangeFieldName):null,r='',d=this._allowShowMilestone(),m=e.get(this._options.milestonesFieldName),c=this._getCountMilestones(m);if(c){var h=this._getCurrentMilestone(m),u=h.get(this._options.termMilestoneFieldName)?h.get(this._options.termMilestoneFieldName):null,g=h.get(this._options.nameMilestoneFieldName)?l.escapeHtml(h.get(this._options.nameMilestoneFieldName)):null;i=(h.get(this._options.nameMilestoneFieldName)||'')+' '+rk('срок до')+' '+n;var p=n.length>0?'<div class="milstoneDiv"> '+rk('срок до')+' '+n+'</div>':'';r='<span class="term">'+this._getDifTermsBlock(s,u,a)+p+'</span>'+'<span class="nameMilestone">'+'<div>'+g+'</div>'+this._getStartBlock(o)+this._getCountMiesonesBlock(c)+'</span>';}else if(o||s)i=s?rk('Срок до')+' '+n:rk('Срок','Заголовок'),r='<span class="term">'+this._getDifTermsBlock(null,null,a)+'<div class="milstoneDiv">'+(s?rk('Срок до')+' '+n:rk('Срок','Заголовок'))+'</div>'+this._getStartBlock(o)+'</span>';else r='<span class="term">'+'<div>'+(i=(d?rk('Веха')+' / ':'')+rk('Срок','Заголовок'))+'</div>'+'</span>';t.attr('title',i),t.html(r);},init:function(){m.superclass.init.call(this),this._isMlstAccessRights=!!i.checkAccessRights(['Вехи']),this._isPMExtensions=!!s.checkExtensions(['УПРАВЛЕНИЕ_ПРОЕКТАМИ'])['УПРАВЛЕНИЕ_ПРОЕКТАМИ'],this._isPMModule='ProjectManagement'in o.modules,this._linkCtrl=this.getChildControlByName('termMilestoneLink'),this.setCaptionByRecDlg();},onActivated:function(){var e=this;function t(){var e=i._options.startFieldName&&o.has(i._options.startFieldName)?o.get(i._options.startFieldName):null,t=i._options.termFieldName&&o.has(i._options.termFieldName)?o.get(i._options.termFieldName):null,n=i._options.creationDateFieldName&&o.has(i._options.creationDateFieldName)?o.get(i._options.creationDateFieldName):null,r=i.getTopParent(),d=r.hasChildControlByName('EDOTaskDialog')?r.getChildControlByName('EDOTaskDialog').getParent():null;a.showFloatArea({autoHide:true,template:'js!SBIS3.EDO.TermMilestoneDlg',opener:i,parent:i,target:i.getContainer(),side:'right',direction:'bottom',border:false,autoCloseOnHide:true,name:'Выбор вех и срока',componentOptions:{showMilestone:true,countMilestones:i._options.milestonesField?i._options.milestonesField.getCount():0,showStart:!!i._options.startFieldName,startDate:e?e.toSQL():null,termDate:t?t.toSQL():null,showMilestonesLink:i._isMlstAccessRights,milestones:m,creationDate:n,docId:l,startFieldName:i._options.startFieldName,termFieldName:i._options.termFieldName,milestonesFieldName:i._options.milestonesFieldName,termMilestoneFieldName:i._options.termMilestoneFieldName,nameMilestoneFieldName:i._options.nameMilestoneFieldName,idMilestoneFieldName:i._options.idMilestoneFieldName,docDlg:d,dlgRec:o,termMilestonesParentTask:i._termMilestonesParentTask,reloadEventChannel:i._options.reloadEventChannel,isAvailablePM:i._isAvailablePM(),extManager:s}});}var i=this.getParent(),o=i._getDlgRecord(),n=new r(),l=i._options.docIdFieldName&&o.has(i._options.docIdFieldName)?o.get(i._options.docIdFieldName):null,m=void 0,c=new d({endpoint:'Веха'});if('СлужЗап'==o.get('ТипДокумента.ТипДокумента')&&'f3384eb8-bc07-11e4-8552-00505691577e'==o.get('ИдРегламента')&&!i._termMilestonesParentTask){var l=i._options.docIdFieldName&&o.has(i._options.docIdFieldName)?o.get(i._options.docIdFieldName):null;n.push(c.call('НайтиВехиРодительскойЗадачи',{'ДокументСледствие':l}).addCallback(function(e){if(e)i._termMilestonesParentTask=e.getRawData();}));}if(i._allowShowMilestone())n.push(c.call('НайтиВехуДокумента',{'ДокументСледствие':l}).addCallback(function(e){if(e)m=e.getAll();}));n.done().getResult().addCallback(function(){t();});}});return m;});
define("tmpl!SBIS3.EDO.FTaskControls/FTaskControls",["Core/tmpl/js/tclosure","js!SBIS3.EDO.TermMilestoneLink","js!SBIS3.EDO.CompetenceFieldLink","js!SBIS3.CONTROLS/FieldLink/Link","js!SBIS3.AddresseeChoice.FieldLink","js!SBIS3.CONTROLS/TextBox","js!SBIS3.CONTROLS/RichEditor"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],o={};o["js!SBIS3.EDO.TermMilestoneLink"]=e[1],o["js!SBIS3.EDO.CompetenceFieldLink"]=e[2],o["js!SBIS3.CONTROLS/FieldLink/Link"]=e[3],o["js!SBIS3.AddresseeChoice.FieldLink"]=e[4],o["js!SBIS3.CONTROLS/TextBox"]=e[5],o["js!SBIS3.CONTROLS/RichEditor"]=e[6];var r=function e(r,i,a,n,s){function l(){}var d=0,c=void 0!==t&&t?t:arguments[arguments.length-1];void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure"));var p={};s&&s.isSetts&&(p=s.fullContext||{});var m="string"==typeof a?a:"",h=void 0===o?void 0:o,N={id:[],def:void 0},f=c.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,r),u=this&&this.includedTemplates?this.includedTemplates:{},S=c.getMarkupGenerator(n);try{var C=S.joinElements([S.createTag("div",{class:"edo-TaskControls"},[S.createTag("div",{class:""+c.wrapUndef(c.utils.escape(c.getter(r,["hasIsp"])?"needPhotoMargin":""))},[c.getter(r,["showMilestone"])?[S.createTag("div",{class:"tc_milestone"},[S.createControl("wsControl","ws:SBIS3.EDO.TermMilestoneLink",{bindings:[{fieldName:"record/ДокументРасширение.Срок",propName:"termField",propPath:[],fullPropName:"termField",propPathStr:"",oneWay:!1,direction:"fromContext",bindNonExistent:!1},{fieldName:"record/РП.ВехаДокумента",propName:"milestonesField",propPath:[],fullPropName:"milestonesField",propPathStr:"",oneWay:!1,direction:"fromContext",bindNonExistent:!1}],termField:void 0,milestonesField:void 0,termFieldName:"ДокументРасширение.Срок",milestonesFieldName:"РП.ВехаДокумента",termMilestoneFieldName:"ДокументРасширение.Срок",nameMilestoneFieldName:"ДокументРасширение.Название",idMilestoneFieldName:"ИдВехи",creationDateFieldName:"ДокументРасширение.ДатаВремяСоздания",docIdFieldName:"@Документ",tabindex:0,accessZone:"Дела",enabled:!0,allowChangeEnable:!1},{class:"termMilestoneLinkComponent"},{data:r,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},a,h,u,c.config,p)],{},N,this)]:S.createText(""),S.createTag("table",{class:"edo-TaskControls_table"},[S.createTag("tr",{},[c.getter(r,["hasIsp"])?[S.createTag("td",{},[S.createControl("wsControl","ws:SBIS3.EDO.CompetenceFieldLink",{allowResponsibilityZone:c.getter(r,["visualView"])===c.getter(r,["guids",1])||"",bindings:[{fieldName:"record/СписокИсполнителей",propName:"userList",propPath:[],fullPropName:"userList",propPathStr:"",oneWay:!1,direction:"fromContext",bindNonExistent:!1},{fieldName:"record/РазличныеДокументы.ЗонаОтветственности",propName:"zone",propPath:[],fullPropName:"zone",propPathStr:"",oneWay:!1,direction:"fromContext",bindNonExistent:!1},{fieldName:"record/ТипДокумента",propName:"docType",propPath:[],fullPropName:"docType",propPathStr:"",oneWay:!0,direction:"fromContext",bindNonExistent:!1},{fieldName:"record/ДокументРасширение.СостояниеКраткое",propName:"docState",propPath:[],fullPropName:"docState",propPathStr:"",oneWay:!0,direction:"fromContext",bindNonExistent:!1}],userList:void 0,zone:void 0,docType:void 0,docState:void 0,tabindex:4},{class:c.utils.escape(c.getter(r,["isNewRecord"])&&c.getter(r,["isEmptyIsp"])?"ws-autofocus":"")},{data:r,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},a,h,u,c.config,p)],{},N,this)]:S.createText(""),c.getter(r,["visualView"])===c.getter(r,["guids",2])?[S.createTag("td",{},[S.createControl("wsControl","ws:SBIS3.CONTROLS/FieldLink/Link",{caption:global.rk("Контрагент"),owner:"/AddresseeChoiceFieldLink",name:"showSelectorAddresseeChoice",tabindex:0,bindings:[{fieldName:"record/isVisibleContragent",propName:"visible",propPath:[],fullPropName:"visible",propPathStr:"",oneWay:!0,direction:"fromContext",bindNonExistent:!0}],visible:!1},{name:"showSelectorAddresseeChoice",sbisname:"showSelectorAddresseeChoice"},{data:r,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},a,h,u,c.config,p),S.createControl("wsControl","ws:SBIS3.AddresseeChoice.FieldLink",{selectedItem:{"Название":void 0,"@Лицо":void 0},handlers:{onSelectedItemsChange:c.getTypeFunc("js!SBIS3.EDO.FTaskControlsHandlers:setFocus ",{})},validators:[{validator:c.getTypeFunc("SBIS3.CONTROLS/Utils/ControlsValidators:required",{}),option:"selectedKey",errorMessage:global.rk("Укажите контрагента"),failOnError:!0}],name:"AddresseeChoiceFieldLink",tabindex:3,bindings:[{fieldName:"record/Лицо1",propName:"selectedKey",propPath:[],fullPropName:"selectedKey",propPathStr:"",oneWay:!1,direction:"fromContext",bindNonExistent:!1},{fieldName:"record/isVisibleContragent",propName:"visible",propPath:[],fullPropName:"visible",propPathStr:"",oneWay:!0,direction:"fromContext",bindNonExistent:!0},{fieldName:"record/Лицо1.Название",propName:"selectedItem/Название",propPath:["Название"],fullPropName:"selectedItem/Название",propPathStr:"Название",oneWay:!1,direction:"fromContext",bindNonExistent:!1},{fieldName:"record/Лицо1",propName:"selectedItem/@Лицо",propPath:["@Лицо"],fullPropName:"selectedItem/@Лицо",propPathStr:"@Лицо",oneWay:!1,direction:"fromContext",bindNonExistent:!1}],selectedKey:void 0,visible:!1,placeholder:global.rk("Название контрагента или ИНН"),labelPosition:"top",multiSelect:!1,captionOnTop:!0,showContragents:!0,showPrivateFaces:!1,showEmployees:!1,pickerClassName:"acn_autocomplete",esc:!1},{class:"taskAddresseeChoice",name:"AddresseeChoiceFieldLink",sbisname:"AddresseeChoiceFieldLink"},{data:r,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},a,h,u,c.config,p)],{},N,this)]:S.createText("")],{},N,this),c.getter(r,["showTheme"])?[S.createTag("tr",{class:"order_theme"},[S.createTag("td",{},[S.createControl("wsControl","ws:SBIS3.CONTROLS/TextBox",{name:"Theme",bindings:[{fieldName:"record/ДокументРасширение.Название",propName:"text",propPath:[],fullPropName:"text",propPathStr:"",oneWay:!1,direction:"fromContext",bindNonExistent:!1},{fieldName:"record/ДокументРасширение.Название",propName:"tooltip",propPath:[],fullPropName:"tooltip",propPathStr:"",oneWay:!0,direction:"fromContext",bindNonExistent:!1}],text:void 0,tooltip:void 0,maxLength:256,className:"inner_text_fld border_top_none",placeholder:global.rk("Тема"),isRelative:!0,tabindex:0},{class:"taskTheme",name:"Theme",sbisname:"Theme"},{data:r,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},a,h,u,c.config,p)],{},N,this)],{},N,this)]:S.createText("")],{},N,this),S.createTag("div",{class:"edo-TaskControls_FieldRichEditor"},[S.createControl("wsControl","ws:SBIS3.CONTROLS/RichEditor",{validators:[{validator:c.getTypeFunc("js!SBIS3.EDO.FTaskControlsHandlers:checkDescription",{}),option:"text",errorMessage:"Введите описание"}],items:[{visible:!0,order:1,name:"smile"},{visible:!1,name:"source"},{visible:!1,name:"image"}],name:"fTaskRichEditor",validateIfHidden:!0,bindings:[{fieldName:"record/РазличныеДокументы.Информация",propName:"text",propPath:[],fullPropName:"text",propPathStr:"",oneWay:!1,direction:"fromContext",bindNonExistent:!1},{fieldName:"record/richHeight",propName:"minimalHeight",propPath:[],fullPropName:"minimalHeight",propPathStr:"",oneWay:!0,direction:"fromContext",bindNonExistent:!0}],text:void 0,isRelative:!0,decorateLinks:!0,decoratorName:"linkDecorator",tabindex:2,spellcheck:!0,toolbarVisible:!1,className:"inner_text_fld border_top_none edo-TaskControls_richBlock",autoHeight:!0,minimalHeight:24,maximalHeight:500,placeholder:global.rk("Описание"),maxLength:35e3,highlightLinks:!0,esc:!1},{class:c.utils.escape(c.getter(r,["visualView"])===c.getter(r,["guids",4])?"rightPad":"")+" "+c.utils.escape(c.getter(r,["isEmptyIsp"])?"":" ws-autofocus"),name:"fTaskRichEditor",sbisname:"fTaskRichEditor"},{data:r,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},a,h,u,c.config,p)],{},N,this)],{},N,this)],i,N,this)],m,N);N.def&&(C=S.chain(C,N,i),N=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/FTaskControls/FTaskControls.tmpl",e,r)}return C||""};return r.includedFunctions={},r.stable=!0,r.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FTaskControls/FTaskControls"}},r});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.FTaskControls", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".FTaskControl .edo-TaskControls_table{width:100%;table-layout:fixed;padding-right:210px}.FTaskControl .edo-TaskControls_table tr td{padding-bottom:8px}.FTaskControl .edo-TaskControls_table .controls-Link{text-decoration:underline;color:#8991a9}.FTaskControl .edo-TaskControls_table .controls-Link:hover{color:#313e78}.FTaskControl .edo-TaskControls_table .controls-Link.ws-disabled{color:#ccc;cursor:default;text-decoration:none}.FTaskControl .edo-TaskControls_table .StaffChoiceClickable{font-weight:700}.FTaskControl .edo-TaskControls_table .taskAddresseeChoice,.FTaskControl .edo-TaskControls_table .taskTheme{width:100%}.FTaskControl .edo-TaskControls_table .taskAddresseeChoice .controls-FieldLink__item-caption{color:#1f2c63}.FTaskControl .edo-TaskControls_isplink{color:#999}.FTaskControl .edo-TaskControls{position:relative}.FTaskControl .edo-TaskControls .acn_autocomplete{width:492px}.FTaskControl .edo-TaskControls .tc_milestone{display:inline-block;position:absolute;right:240px;width:230px;z-index:500;top:-4px}.FTaskControl .edo-TaskControls .tc_milestone_beta{display:inline-block;position:absolute;right:215px;z-index:500;top:-4px}.FTaskControl .edo-TaskControls .richTop{margin-top:27px}.FTaskControl .order_theme div{border-bottom-color:#eaeaea!important}.FTaskControl .edo-TaskControls_FieldRichEditor{margin-right:12px}.FTaskControl .edo-TaskControls_FieldRichEditor .controls-RichEditor .controls-RichEditor__dataReview{border-right:none}.FTaskControl .edo-TaskControls_FieldRichEditor.rightPad{padding-right:210px}.needPhotoMargin .order_theme div[sbisname=Theme]{margin-left:48px}.needPhotoMargin .edo-TaskControls_ispComponent{margin-left:48px}.needPhotoMargin .edo-TaskControls_richBlock{margin-right:0;margin-top:0;margin-left:48px}.edo-FTask_TaskControls .needPhotoMargin .edo-TaskControls_ispComponent{margin-left:46px}.edo-FTask_TaskControls .needPhotoMargin .edo-TaskControls_richBlock{margin-left:46px}.edo-TaskControls_richBlock{margin-top:8px}.edo-TaskControls_ispPhotoBlock{position:absolute!important;display:block!important}.edo-TaskControls_ispComponent .controls-TextBox{color:#313e78;font-size:15px}.edo-TaskControls_ispComponent .controls-TextBox .controls-TextBox__fieldWrapper .controls-TextBox__field{font-size:14px;color:#000}.edo-TaskControls_ispComponent .controls-FieldLink__itemsEdited .controls-FieldLink__item-caption:hover{text-decoration:none}.edo-TaskControls_ispComponent .controls-FieldLink.controls-FieldLink__itemsEdited .controls-FieldLink__item:hover{text-decoration:none}.controls-FieldLink .controls-FieldLink__item:hover .zoneresponsibility_face{text-decoration:underline}.controls-FieldLink .controls-FieldLink__item:hover .zoneresponsibility_zone{text-decoration:underline}"));head.appendChild(style);});}
define('js!SBIS3.EDO.FTaskControls',['Lib/Control/CompoundControl/CompoundControl','tmpl!SBIS3.EDO.FTaskControls/FTaskControls','WS.Data/Source/SbisService','css!SBIS3.EDO.FTaskControls','js!SBIS3.EDO.FTaskControlsHandlers','SBIS3.CONTROLS/Utils/ControlsValidators','SBIS3.CONTROLS/RichEditor','i18n!SBIS3.EDO.FTaskControls','js!SBIS3.Engine.Utils.LinkDecorateUtil','Elektronnyj_dokumentooborot_localization'],function(e,s,t){'use strict';var i=e.extend({$protected:{_options:{name:'FTaskControls',showTheme:false,showContr:false,visualView:'',guids:['6c30baea-27a1-48cd-8c4f-e263e552b15e','0b6bcbcf-aef7-4d5b-9375-2445b94a989e','04eeee29-9045-494d-bacb-d3f08b316dbd','5a22585f-9480-42ab-ad19-77e4aac542dd','09598764-edc7-4719-94b0-73ef967bf109','f4fc62c1-6274-4a61-945b-10c964401dfc'],showMilestone:true,isNewRecord:false,isEmptyIsp:true,hasIsp:true}},_dotTplFn:s,getVisualView:function(){return this._options.visualView;},setVisualView:function(e){this._options.visualView=e,this.setTemplateOptions(this._options),this.updateView();},getOptions:function(){return this._options;},updateView:function(e){this.rebuildMarkup();},setTemplateOptions:function(e){var s=this;switch(e.visualView){case e.guids[1]:case e.guids[3]:break;case e.guids[2]:e.showContr=true,e.hasIsp=false;break;case e.guids[4]:e.hasIsp=false;}if(s.getLinkedContext()&&s.hasChildControlByName('Исполнитель')&&-1!==Array.indexOf([e.guids[2],e.guids[4]],e.visualView))new t({endpoint:'Рассылка'}).call('ЗаполнитьСписокПоДокументу',{'Документ':s.getLinkedContext().getValue('record').get('@Документ'),'Лица':[]}).addCallback(function(){s.getParentByName('EDOTaskDialog').sendCommand('notify','onUpdateModel');});return e;},_modifyOptions:function(e){return e=i.superclass._modifyOptions.call(this,e),this.setTemplateOptions(e);},init:function(){i.superclass.init.call(this);}});return i;});
define("tmpl!SBIS3.EDO.FTask/FTask",["Core/tmpl/js/tclosure","js!SBIS3.EDO2.Dialog","js!SBIS3.EDO.OvertaskCrumbs","js!SBIS3.EDO2.MainTabHeader","js!SBIS3.EDO2.Sticker","js!SBIS3.EDO.FTaskControls","js!SBIS3.EDO2.Spoiler","js!SBIS3.EDO2.AdditionalFields.View","js!SBIS3.EDO.FSubtasks","js!SBIS3.EDO2.AttachButton","js!SBIS3.EDO2.CreateButton","js!SBIS3.EDO2.RulesSelector","js!SBIS3.CONTROLS/Menu/MenuLink","js!SBIS3.DOCVIEW.SwitchVisibilityMode","js!SBIS3.EDO2.Viewer"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],o={};o["js!SBIS3.EDO2.Dialog"]=e[1],o["js!SBIS3.EDO.OvertaskCrumbs"]=e[2],o["js!SBIS3.EDO2.MainTabHeader"]=e[3],o["js!SBIS3.EDO2.Sticker"]=e[4],o["js!SBIS3.EDO.FTaskControls"]=e[5],o["js!SBIS3.EDO2.Spoiler"]=e[6],o["js!SBIS3.EDO2.AdditionalFields.View"]=e[7],o["js!SBIS3.EDO.FSubtasks"]=e[8],o["js!SBIS3.EDO2.AttachButton"]=e[9],o["js!SBIS3.EDO2.CreateButton"]=e[10],o["js!SBIS3.EDO2.RulesSelector"]=e[11],o["js!SBIS3.CONTROLS/Menu/MenuLink"]=e[12],o["js!SBIS3.DOCVIEW.SwitchVisibilityMode"]=e[13],o["js!SBIS3.EDO2.Viewer"]=e[14];var i=function e(i,r,a,n,s){function l(){}var c=0,d=void 0!==t&&t?t:arguments[arguments.length-1];void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure"));var u={};s&&s.isSetts&&(u=s.fullContext||{});var v="string"==typeof a?a:"",p=void 0===o?void 0:o,m={id:[],def:void 0},S=d.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,i),f=this&&this.includedTemplates?this.includedTemplates:{},h=d.getMarkupGenerator(n);try{var b=h.joinElements([h.createTag("div",{class:"FTaskControl"},[h.createControl("wsControl","ws:SBIS3.EDO2.Dialog",{secondLineContent:d.createDataArray([(new function(){var e=Object.create(i),t=function e(t,o,i,r,a){if(void 0===i)var i=arguments[2];var n=0,s="secondLineContent";if(void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure")),a&&a.isSetts)var l=a.fullContext||{};t=d.isolateScope(Object.create(this),t,s);var c="string"==typeof i?i:"",u={id:[],def:void 0},v=this&&this.includedTemplates?this.includedTemplates:{},m=d.getMarkupGenerator(r);try{var f=m.joinElements([m.createControl("wsControl","ws:SBIS3.EDO.OvertaskCrumbs",{name:"OvertaskCrumbs",bindings:[{fieldName:"record/ИерархияНадзадачИПроектов",propName:"data",propPath:[],fullPropName:"data",propPathStr:"",oneWay:!0,direction:"fromContext",bindNonExistent:!1},{fieldName:"record/@Документ",propName:"docID",propPath:[],fullPropName:"docID",propPathStr:"",oneWay:!0,direction:"fromContext",bindNonExistent:!1},{fieldName:"record/ЧислоНадзадачИПроектов",propName:"overtasksCount",propPath:[],fullPropName:"overtasksCount",propPathStr:"",oneWay:!0,direction:"fromContext",bindNonExistent:!1}],data:void 0,docID:void 0,overtasksCount:void 0},d.plainMerge(o,{class:"edo-FTask__OvertaskCrumbs",name:"OvertaskCrumbs",sbisname:"OvertaskCrumbs"}),{data:t,ctx:this,pName:void 0!==s?s:void 0,viewController:S},i,p,v,d.config,l)],c,u);u.def&&(f=m.chain(f,u,o),u=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/components/FTask/FTask.tmpl",e,t)}return f||""};this.func=d.makeFunctionSerializable(t,e)}).func]),tabs:[{title:d.createDataArray([(new function(){var e=Object.create(i),t=function e(t,o,i,r,a){if(void 0===i)var i=arguments[2];var n=0,s="title";if(void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure")),a&&a.isSetts)var l=a.fullContext||{};t=d.isolateScope(Object.create(this),t,s);var c="string"==typeof i?i:"",u={id:[],def:void 0},v=this&&this.includedTemplates?this.includedTemplates:{},m=d.getMarkupGenerator(r);try{var f=m.joinElements([m.createControl("wsControl","ws:SBIS3.EDO2.MainTabHeader",{tabindex:0,docType:"СлужЗап"},d.plainMerge(o,{}),{data:t,ctx:this,pName:void 0!==s?s:void 0,viewController:S},i,p,v,d.config,l)],c,u);u.def&&(f=m.chain(f,u,o),u=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/components/FTask/FTask.tmpl",e,t)}return f||""};this.func=d.makeFunctionSerializable(t,e)}).func]),content:d.createDataArray([(new function(){var e=Object.create(i),t=function e(t,o,i,r,a){if(void 0===i)var i=arguments[2];var n=0,s="content";if(void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure")),a&&a.isSetts)var l=a.fullContext||{};t=d.isolateScope(Object.create(this),t,s);var c="string"==typeof i?i:"",u={id:[],def:void 0},v=this&&this.includedTemplates?this.includedTemplates:{},m=d.getMarkupGenerator(r);try{var f=m.joinElements([m.createTag("div",{class:"edo-FTask_sticker-container"},[m.createControl("wsControl","ws:SBIS3.EDO2.Sticker",{name:"TaskSticker",tabindex:2,mini:!0},{name:"TaskSticker",sbisname:"TaskSticker"},{data:t,ctx:this,pName:void 0!==s?s:void 0,viewController:S},i,p,v,d.config,l)],o,u,this)],c,u);u.def&&(f=m.chain(f,u,o),u=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/components/FTask/FTask.tmpl",e,t)}return f||""};this.func=d.makeFunctionSerializable(t,e)}).func,(new function(){var e=Object.create(i),t=function e(t,o,i,r,a){if(void 0===i)var i=arguments[2];var n=0,s="content";if(void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure")),a&&a.isSetts)var l=a.fullContext||{};t=d.isolateScope(Object.create(this),t,s);var c="string"==typeof i?i:"",u={id:[],def:void 0},v=this&&this.includedTemplates?this.includedTemplates:{},m=d.getMarkupGenerator(r);try{var f=m.joinElements([m.createTag("div",{class:"edo-FTask_TaskControls"},[m.createControl("wsControl","ws:SBIS3.EDO.FTaskControls",{tabindex:1,bindings:[{fieldName:"record/РП.Документ/Регламент/ВизуальноеПредставление/Идентификатор",propName:"visualView",propPath:[],fullPropName:"visualView",propPathStr:"",oneWay:!0,direction:"fromContext",bindNonExistent:!1}],visualView:void 0,ignoreTabCycles:!1,isNewRecord:d.getter(t,["isNewRecord"]),isEmptyIsp:!(d.getter(t,["record","СписокИсполнителей"])&&d.getter(t,["record","СписокИсполнителей","getCount"]).apply(d.getter(t,["record","СписокИсполнителей"]),[])>0)},{},{data:t,ctx:this,pName:void 0!==s?s:void 0,viewController:S},i,p,v,d.config,l)],o,u,this)],c,u);u.def&&(f=m.chain(f,u,o),u=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/components/FTask/FTask.tmpl",e,t)}return f||""};this.func=d.makeFunctionSerializable(t,e)}).func,(new function(){var e=Object.create(i),t=function e(t,o,i,r,a){if(void 0===i)var i=arguments[2];var n=0,s="content";if(void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure")),a&&a.isSetts)var l=a.fullContext||{};t=d.isolateScope(Object.create(this),t,s);var c="string"==typeof i?i:"",u={id:[],def:void 0},v=this&&this.includedTemplates?this.includedTemplates:{},m=d.getMarkupGenerator(r);try{var f=m.joinElements([m.createTag("div",{class:"edo-FTask_Spoiler"},[m.createControl("wsControl","ws:SBIS3.EDO2.Spoiler",{contentTpl:d.createDataArray([(new function(){var e=Object.create(t),o=function e(t,o,i,r,a){if(void 0===i)var i=arguments[2];var n=0,s="contentTpl";if(void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure")),a&&a.isSetts)var l=a.fullContext||{};t=d.isolateScope(Object.create(this),t,s);var c="string"==typeof i?i:"",u={id:[],def:void 0},v=this&&this.includedTemplates?this.includedTemplates:{},m=d.getMarkupGenerator(r);try{var f=m.joinElements([m.createControl("wsControl","ws:SBIS3.EDO2.AdditionalFields.View",{area:"3fcf32c7-702c-42da-9049-9c86bbea7053"},d.plainMerge(o,{}),{data:t,ctx:this,pName:void 0!==s?s:void 0,viewController:S},i,p,v,d.config,l)],c,u);u.def&&(f=m.chain(f,u,o),u=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/components/FTask/FTask.tmpl",e,t)}return f||""};this.func=d.makeFunctionSerializable(o,e)}).func]),collapseHeight:"181",bindings:[{fieldName:"record/enabled",propName:"expanded",propPath:[],fullPropName:"expanded",propPathStr:"",oneWay:!0,direction:"fromContext",bindNonExistent:!1}],expanded:void 0,esc:!1},{class:"edo-FTask__additional-fields"},{data:t,ctx:this,pName:void 0!==s?s:void 0,viewController:S},i,p,v,d.config,l)],o,u,this)],c,u);u.def&&(f=m.chain(f,u,o),u=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/components/FTask/FTask.tmpl",e,t)}return f||""};this.func=d.makeFunctionSerializable(t,e)}).func,(new function(){var e=Object.create(i),t=function e(t,o,i,r,a){if(void 0===i)var i=arguments[2];var n=0,s="content";if(void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure")),a&&a.isSetts)var l=a.fullContext||{};t=d.isolateScope(Object.create(this),t,s);var c="string"==typeof i?i:"",u={id:[],def:void 0},v=this&&this.includedTemplates?this.includedTemplates:{},m=d.getMarkupGenerator(r);try{var f=m.joinElements([m.createTag("div",{class:"edo-FTask_Subtasks"},[m.createControl("wsControl","ws:SBIS3.EDO.FSubtasks",{tabindex:0,viewMode:"document",bindings:[{fieldName:"record/ДокументРасширение.ЧислоПодзадач",propName:"countSubtasks",propPath:[],fullPropName:"countSubtasks",propPathStr:"",oneWay:!0,direction:"fromContext",bindNonExistent:!1}],countSubtasks:void 0,visible:!1},{},{data:t,ctx:this,pName:void 0!==s?s:void 0,viewController:S},i,p,v,d.config,l)],o,u,this)],c,u);u.def&&(f=m.chain(f,u,o),u=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/components/FTask/FTask.tmpl",e,t)}return f||""};this.func=d.makeFunctionSerializable(t,e)}).func,(new function(){var e=Object.create(i),t=function e(t,o,i,r,a){if(void 0===i)var i=arguments[2];var n=0,s="content";if(void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure")),a&&a.isSetts)var l=a.fullContext||{};t=d.isolateScope(Object.create(this),t,s);var c="string"==typeof i?i:"",u={id:[],def:void 0},v=this&&this.includedTemplates?this.includedTemplates:{},m=d.getMarkupGenerator(r);try{var f=m.joinElements([m.createTag("div",{class:"edo-FTask_AttachTo"},[m.createTag("div",{class:"edo-FTask_itembutton"},[m.createControl("wsControl","ws:SBIS3.EDO2.AttachButton",{referenceTypes:{web:!0,employees:!0,companies:!0,videoMessage:!0},tabindex:0,name:"AttachTo",esc:!1},{name:"AttachTo",sbisname:"AttachTo"},{data:t,ctx:this,pName:void 0!==s?s:void 0,viewController:S},i,p,v,d.config,l)],{},u,this),m.createTag("div",{class:"edo-FTask_itembutton"},[m.createControl("wsControl","ws:SBIS3.EDO2.CreateButton",{name:"CreateAttach",tabindex:0},{name:"CreateAttach",sbisname:"CreateAttach"},{data:t,ctx:this,pName:void 0!==s?s:void 0,viewController:S},i,p,v,d.config,l)],{},u,this),m.createTag("div",{class:"edo-FTask_itembutton"},[m.createControl("wsControl","ws:SBIS3.EDO2.RulesSelector",{docTypes:[{docType:"СлужЗап"}],content:d.createDataArray([(new function(){var e=Object.create(t),o=function e(t,o,i,r,a){if(void 0===i)var i=arguments[2];var n=0,s="content";if(void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure")),a&&a.isSetts)var l=a.fullContext||{};t=d.isolateScope(Object.create(this),t,s);var c="string"==typeof i?i:"",u={id:[],def:void 0},v=this&&this.includedTemplates?this.includedTemplates:{},m=d.getMarkupGenerator(r);try{var f=m.joinElements([m.createControl("wsControl","ws:SBIS3.CONTROLS/Menu/MenuLink",{tabindex:0,allowChangeEnable:!1,name:"ruleSelectorMenuLink",caption:global.rk("Подзадача"),icon:"sprite:icon-16 icon-Check icon-primary"},d.plainMerge(o,{name:"ruleSelectorMenuLink",sbisname:"ruleSelectorMenuLink"}),{data:t,ctx:this,pName:void 0!==s?s:void 0,viewController:S},i,p,v,d.config,l)],c,u);u.def&&(f=m.chain(f,u,o),u=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/components/FTask/FTask.tmpl",e,t)}return f||""};this.func=d.makeFunctionSerializable(o,e)}).func]),tabindex:0,name:"addSubtaskFromDoc",lazyLoading:!0,allowChangeEnable:!1,bindings:[{fieldName:"record/toggleSubtaskDocButton",propName:"visible",propPath:[],fullPropName:"visible",propPathStr:"",oneWay:!0,direction:"fromContext",bindNonExistent:!0}],visible:!d.getter(t,["record","ЧислоПодзадач"]),esc:!1},{name:"addSubtaskFromDoc",sbisname:"addSubtaskFromDoc"},{data:t,ctx:this,pName:void 0!==s?s:void 0,viewController:S},i,p,v,d.config,l)],{},u,this),m.createTag("div",{class:"edo-FTask_itembutton"},[m.createControl("wsControl","ws:SBIS3.DOCVIEW.SwitchVisibilityMode",{hasSwitch:{bigPreview:!0,diskClassic:!1,classic:!0},listOptions:{visibilityMode:{defaultMode:"classic",setFromCookie:!0,savedModeField:"Документ"}},name:"ModeSwitcher",tabindex:0,bindings:[{fieldName:"record/toggleFTaskSwitchVisibilityMode",propName:"visible",propPath:[],fullPropName:"visible",propPathStr:"",oneWay:!0,direction:"fromContext",bindNonExistent:!0},{fieldName:"record/РП.Документ/ТипДокумента/ТипДокумента",propName:"listOptions/visibilityMode/savedModeField",propPath:["visibilityMode","savedModeField"],fullPropName:"listOptions/visibilityMode/savedModeField",propPathStr:"visibilityMode/savedModeField",oneWay:!0,direction:"fromContext",bindNonExistent:!0}],visible:!1,esc:!1},{class:"edo-FTask_SwitchVisibility",name:"ModeSwitcher",sbisname:"ModeSwitcher"},{data:t,ctx:this,pName:void 0!==s?s:void 0,viewController:S},i,p,v,d.config,l)],{},u,this)],o,u,this)],c,u);u.def&&(f=m.chain(f,u,o),u=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/components/FTask/FTask.tmpl",e,t)}return f||""};this.func=d.makeFunctionSerializable(t,e)}).func,(new function(){var e=Object.create(i),t=function e(t,o,i,r,a){if(void 0===i)var i=arguments[2];var n=0,s="content";if(void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure")),a&&a.isSetts)var l=a.fullContext||{};t=d.isolateScope(Object.create(this),t,s);var c="string"==typeof i?i:"",u={id:[],def:void 0},v=this&&this.includedTemplates?this.includedTemplates:{},m=d.getMarkupGenerator(r);try{var f=m.joinElements([m.createTag("div",{class:"edo-FTask_FullViewer"},[m.createControl("wsControl","ws:SBIS3.EDO2.Viewer",{name:"DocList"},{name:"DocList",sbisname:"DocList"},{data:t,ctx:this,pName:void 0!==s?s:void 0,viewController:S},i,p,v,d.config,l)],o,u,this)],c,u);u.def&&(f=m.chain(f,u,o),u=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/components/FTask/FTask.tmpl",e,t)}return f||""};this.func=d.makeFunctionSerializable(t,e)}).func]),id:"firstTab",className:"myClass controls-TabButton__main-item"}],name:"EDOTaskDialog",objectName:"СлужЗап",esc:!1},{name:"EDOTaskDialog",sbisname:"EDOTaskDialog"},{data:i,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:S,internal:{__dirtyCheckingVars_5:d.getter(i,["isNewRecord"]),__dirtyCheckingVars_6:d.getter(i,["record","СписокИсполнителей"])&&d.getter(i,["record","СписокИсполнителей","getCount"])&&!(d.getter(i,["record","СписокИсполнителей"])&&d.getter(i,["record","СписокИсполнителей","getCount"]).apply(d.getter(i,["record","СписокИсполнителей"]),[])>0)}},a,p,f,d.config,u)],r,m,this)],v,m);m.def&&(b=h.chain(b,m,r),m=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/components/FTask/FTask.tmpl",e,i)}return b||""};return i.includedFunctions={},i.stable=!0,i.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FTask/FTask"}},i});
define('js!SBIS3.EDO.FTaskModel',['Core/RightsManager','Core/ExtensionsManager','Core/constants','Core/helpers/date-helpers','Core/helpers/String/escapeHtml','js!SBIS3.EDO2.EdoModel','Elektronnyj_dokumentooborot_localization'],function(t,e,a,n,i,o){'use strict';var c=o.extend({_moduleName:'SBIS3.EDO.FTaskModel',constructor:function(n){c.superclass.constructor.call(this,n),this._allowShowMilestone=!!t.checkAccessRights(['Вехи'])&&!!e.checkExtensions(['УПРАВЛЕНИЕ_ПРОЕКТАМИ'])['УПРАВЛЕНИЕ_ПРОЕКТАМИ']&&'ProjectManagement'in a.modules;},_allowShowMilestone:false,_$properties:{isProjectManager:{get:function(){return a.modules['ProjectManagement']&&e.checkExtensions(['УПРАВЛЕНИЕ_ПРОЕКТАМИ'])['УПРАВЛЕНИЕ_ПРОЕКТАМИ'];}},attachToCheckListVisible:{get:function(){return this.get('isProjectManager')&&t.checkAccessRights(['Проверки']);}},attachToPlanVisible:{get:function(){return this.get('isProjectManager')&&t.checkAccessRights(['Планы работ']);}},attachToProjectVisible:{get:function(){return this.get('isProjectManager')&&t.checkAccessRights(['Планы работ'])&&t.checkAccessRights(['Проекты']);}},attachToMeetingsVisible:{get:function(){return t.checkAccessRights(['Совещания']);}},toggleSubtaskDocButton:{get:function(){var t=true;return t=this.get('ДокументРасширение.ЧислоПодзадач')>0?false:true,t;}},toggleSubtaskReestrButton:{get:function(){var t=false;return t=this.get('ДокументРасширение.ЧислоПодзадач')>0?true:false,t;}},toggleFTaskSwitchVisibilityMode:{get:function(){return this.get('РП.Документ').get('СписокВложений').getCount()>0?true:false;}},isVisibleZoneLabel:{get:function(){return!!(!(this.get('СписокИсполнителей')&&this.get('СписокИсполнителей').getCount())||this.get('СписокИсполнителей')&&this.get('СписокИсполнителей').at(0)&&this.get('СписокИсполнителей').at(0).get('ЗонаОтветственности')||this.get('isEditing')||this.get('enabled'));}},isVisibleIsp:{get:function(){return-1!==Array.indexOf(['6c30baea-27a1-48cd-8c4f-e263e552b15e','0b6bcbcf-aef7-4d5b-9375-2445b94a989e','5a22585f-9480-42ab-ad19-77e4aac542dd','f4fc62c1-6274-4a61-945b-10c964401dfc'],this.getModelField('РП.Документ/Регламент/ВизуальноеПредставление/Идентификатор'));}},isVisibleContragent:{get:function(){if(false===this.get('enabled')&&!this.get('Лицо1'))return false;return-1!==Array.indexOf(['6c30baea-27a1-48cd-8c4f-e263e552b15e','04eeee29-9045-494d-bacb-d3f08b316dbd'],this.getModelField('РП.Документ/Регламент/ВизуальноеПредставление/Идентификатор'));}},richHeight:{get:function(){return this.get('enabled')?48:24;}},tMilestoneButton:{get:function(){var t={caption:'',title:'',icon:'',changed:false},e=this.get('ДокументРасширение.Срок')||null,a=e?e.strftime('%d.%m.%y'):'',o=this._allowShowMilestone&&this.has('РП.ВехаДокумента'),c=this.get('РП.ВехаДокумента'),s=c?c.getCount():0,r='',h='';if(s){var l=function(t){var e=14;if(t.length>e)' '===t.charAt(e-1)&&--e,t=t.substr(0,e)+'...';return t;},u=function(t){var e=t.at(0),a=new Date();return t.each(function(t){var i=e.get('ДокументРасширение.Срок'),o=t.get('ДокументРасширение.Срок');if(n.compareDates(o,'>=',a)&&n.compareDates(o,'<',i))e=t;}),e;}(c),g=u.get('ДокументРасширение.Срок')||null,T=u.get('ДокументРасширение.Название')?i(u.get('ДокументРасширение.Название')):null;if(t.title=T+' '+rk('срок до')+' '+a,t.caption=l(T)+' '+(a?rk('срок до')+' '+a:''),s>1)t.icon='icon-16 icon-BadToGood icon-primary',t.caption='('+s+')'+' '+t.caption;if(n.compareDates(e,'!=',g))t.changed=true;}else if(e)t.title=t.caption=e?rk('Срок до')+' '+a:rk('Срок');else t.title=t.caption=(o?rk('Веха')+' / ':'')+rk('Срок');return t;}}},_$userServiceCommands:[{id:'edoShowDocTime',icon:'sprite:icon-24 icon-Time icon-primary',className:'edo-Dialog_header-ServiceButtons_item',visible:!!('Управление рабочим временем'in a.modules),weight:70,caption:rk('Время по документу'),componentType:'SBIS3.CONTROLS/Button/IconButton',command:'fShowDocTime'},{id:'attachTo',icon:'sprite:icon-24 icon-DocumentBase icon-primary',visible:true,caption:rk('Прикрепить к'),componentType:'SBIS3.CONTROLS/Menu/MenuIcon',className:''},{id:'attachTo.attachToTask',visible:true,caption:rk('Задаче'),parent:'attachTo',componentType:'SBIS3.CONTROLS/Button/IconButton',className:'',command:'fTaskAttachToTask'},{id:'attachTo.attachToProject',visible:'attachToProjectVisible',caption:rk('Проекту / Этапу'),parent:'attachTo',componentType:'SBIS3.CONTROLS/Button/IconButton',className:'',command:'fTaskAttachToProject'},{id:'attachTo.attachToPlan',visible:'attachToPlanVisible',caption:rk('Плану работ'),parent:'attachTo',componentType:'SBIS3.CONTROLS/Button/IconButton',className:'',command:'fTaskAttachToPlan'},{id:'attachTo.attachToChecklist',visible:'attachToCheckListVisible',caption:rk('Проверке'),parent:'attachTo',componentType:'SBIS3.CONTROLS/Button/IconButton',className:'',command:'fTaskAttachToChecklist'},{id:'attachTo.attachToMeetings',visible:'attachToMeetingsVisible',caption:rk('Совещанию'),parent:'attachTo',componentType:'SBIS3.CONTROLS/Button/IconButton',className:'',command:'fTaskAttachToMeetings'}]});return c;});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.FTask", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-FTask_sticker-container{position:absolute;right:0;z-index:500}.edo-FTask_TaskControls{padding-top:8px}.edo-FTask_AttachTo,.edo-FTask_TaskControls{margin-left:12px}.edo-FTask_AttachTo{height:24px}.edo-FTask_itembutton{float:left;margin-right:8px}.edo-FTask_FullViewer{margin-top:4px}.edo-FTask_Subtasks{padding-bottom:8px}.edo-FTask_Subtasks .rt_subtasks_captions{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;vertical-align:middle;width:calc(100% - 140px)}.ws-is-mobile-safari .edo-FTask_Subtasks{display:flex}.edo-FTask_Subtasks .edo-Subtasks{margin-top:8px}.edo-FTask_SwitchVisibility{float:right;top:3px;position:relative}.edo-FTask__additional-fields{padding:8px 0 0 50px}.FTaskControl .edo-TaskControls_table{padding-top:14px}.FTaskControl .edo-Dialog_header-secondLineContent{max-height:128px}"));head.appendChild(style);});}
define('js!SBIS3.EDO.FTask',['Core/EventBus','Core/CommandDispatcher','js!SBIS3.EDO2.FormController','tmpl!SBIS3.EDO.FTask/FTask','WS.Data/Source/SbisService','js!SBIS3.EDO.FTaskModel','WS.Data/Di','WS.Data/Entity/Record','js!SBIS3.EDO.EdoServiceCommands','SBIS3.CONTROLS/Action/OpenDialogAction','Lib/ServerEvent/Bus','css!SBIS3.EDO.FTask','js!SBIS3.EDO2.OpenDialogAction','js!SBIS3.EDO2.Dialog','i18n!SBIS3.EDO.FTask','Elektronnyj_dokumentooborot_localization'],function(e,t,a,n,o,i,s,r,d,c,l){'use strict';s.register('edo.model.withFTaskUserServiceCommands',function(e){return new i(e);});var u=a.extend({_dotTplFn:n,$protected:{_options:{dataSource:{endpoint:{contract:'СлужЗап'},binding:{read:'Документ.ПрочитатьДляУчастника',destroy:'Документ.УдалитьДокументы',format:'СлужЗап.Список',query:'Список'},model:'edo.model.withFTaskUserServiceCommands'},readMetaData:{'ИмяОбъекта':'СлужЗап'},btrTextChangedFlag:false}},dimensions:{minWidth:700,width:700,height:'auto',maxWidth:900},$constructor:function(){t.declareCommand(this,'fShowDocTime',d.fShowDocTime),t.declareCommand(this,'fTaskAttachToProject',d.fTaskAttachToProject),t.declareCommand(this,'fTaskAttachToPlan',d.fTaskAttachToPlan),t.declareCommand(this,'fTaskAttachToTask',d.fTaskAttachToTask),t.declareCommand(this,'fTaskAttachToChecklist',d.fTaskAttachToChecklist),t.declareCommand(this,'fTaskAttachToMeetings',d.fTaskAttachToMeetings);},_modifyOptions:function(e){return e.significantFields.push('СписокИсполнителей'),e;},prepareSubtasks:function(){var t=this,a=t.getChildControlByName('SubtasksTreeBrowser'),n=a.getView(),o=t.getLinkedContext().getValue('record'),i=t.getChildControlByName('SubtasksTreeAction'),s=t.getChildControlByName('addSubtaskFromTaskControls'),d=t.getChildControlByName('addSubtaskFromDoc'),l=s.getChildControls()[0],u=d.getChildControls()[0];t.subscribeTo(e.channel('TasksChannel'),'onCreateSubTask',function(){var e=parseInt(o.get('ДокументРасширение.ЧислоПодзадач'),10);o.set('ДокументРасширение.ЧислоПодзадач',e+1),t.sendCommand('update');});function m(e,t){var n=this.getDataSet().getRecordById(t),o={record:n};if(n.has('Раздел@')&&n.get('Раздел@'))return;a.addItem(o);}if(s&&l)l.subscribe('onMenuItemActivate',m);if(d&&u)u.subscribe('onMenuItemActivate',m);a.subscribe('onEdit',function(e,a){var n=t.getLinkedContext().getValue('record');if(a.filter)a.filter['РазличныеДокументы.БазовыйДокумент']=n.get('@Документ');if(t.sendCommand('submit'),t.validate())t.sendCommand('edoSaveDocument').addCallback(function(){i.execute(a);});});var C=function(e,t){if(!e)return false;else if(t&&t.hasColumn)return true;else if(t&&t.get('РП.Документ')&&!t.get('РП.Документ').get('ИдО'))return true;else return false;};i.subscribe('onUpdateModel',function(e){e.setResult(c.ACTION_CUSTOM),n.reload();}),i.subscribe('onDestroyModel',function(e){e.setResult(c.ACTION_CUSTOM),n.reload();}),n.once('onItemsReady',function(){this.getItems().subscribe('onCollectionChange',function(e,t){if('rm'===t)o.set('ДокументРасширение.ЧислоПодзадач',o.get('ДокументРасширение.ЧислоПодзадач')-1);}.bind(this));}),i.subscribe('onExecuted',function(e,t,n){var o=function(e,t){var a=e._panel,n=a&&a.getOpener();n&&n._notify('onSubtaskCreatedFromDocumentCard',parseInt(t.get('@Документ'),10));},i=this,s=i.getLinkedContext().getValue('record'),d=a.getView().getDataSet(),c=function(e){s.set('ДокументРасширение.ЧислоПодзадач',e),o(i,n);},l=s.get('ДокументРасширение.ЧислоПодзадач');if(false!==t&&n&&n.getState()===r.RecordState.DETACHED){if(n.has('РазличныеДокументы.БазовыйДокумент')&&n.get('РазличныеДокументы.БазовыйДокумент')===s.get('@Документ'))if(d){if(l!==d.getMetaData().total)c(d.getMetaData().total);}else c(1);else{if(a.getView().getSelectedItem()&&parseInt(a.getView().getSelectedItem().get('@Документ'),10)===n.get('РазличныеДокументы.БазовыйДокумент'))return;s.set('ДокументРасширение.ЧислоПодзадач',d?d.getCount()-1:1);}if(parseInt(l,10))a.getView().show();else a.getView().hide();i.sendCommand('update'),i.sendCommand('edoUpdateFullTrace'),i.sendCommand('notify','updateModel');}if(n&&n.get('ДокументРасширение.ЧислоПодзадач')||s&&s.get('ДокументРасширение.ЧислоПодзадач'))if(C(t,n))a.getView().reload();});},prepareOvertask:function(){var e=this,t=e.getLinkedContext().getValue('record').get('@Документ'),a=l.serverChannel('edo.tasks.updatelinkeddocs'),n=e.getChildControlByName('OvertaskCrumbs');n.subscribe('onDropOverdocRelation',function(){if(e.hasChildControlByName('EDOTaskDialog')){var t=e.getChildControlByName('EDOTaskDialog');if(t)t.sendCommand('edoReloadLinkedDocs'),t.sendCommand('edoUpdateFullTrace'),t.sendCommand('notify','onUpdateModel');}}),e.subscribeTo(a,'onMessage',function(a,o){var i=JSON.parse(o);if(i.taskId&&i.taskId==t&&e.hasChildControlByName('EDOTaskDialog')){var s=e.getChildControlByName('EDOTaskDialog');n.reloadData().addCallback(function(){s.sendCommand('edoReloadLinkedDocs'),s.sendCommand('edoUpdateFullTrace'),s.sendCommand('notify','onUpdateModel');});}}),e.subscribe('onChangeMaximizeState',function(e,t){if(n)n.redrawBtns();});},prepareRichEditor:function(){var e=this;e.getLinkedContext().subscribe('onFieldChange',function(t,a,n){if(-1!==a.indexOf('РазличныеДокументы.Информация'))e._options.btrTextChangedFlag=true;}),e.subscribeTo(e,'onUpdateModel',function(t,a,n){if(a&&-1==Array.indexOf(a.getChanged(),'РазличныеДокументы.Информация'))require(['Core/Deferred'],function(n){var i=new n();if(t.setResult(i),e._options.btrTextChangedFlag)new o({endpoint:'СлужЗап'}).call('ПолучитьОписание',{'ИдО':a.get('@Документ')}).addCallback(function(e){a.set('РазличныеДокументы.Информация',e.getScalar()),a.acceptChanges(['РазличныеДокументы.Информация']),i.callback();});else i.callback();});});},init:function(){u.superclass.init.call(this),this.prepareOvertask(),this.prepareSubtasks(),this.prepareRichEditor();}});return u;});
define("html!SBIS3.EDO.FZoneResponsibility",function(){var o=function(o){var t=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;o.test(t);)t=t.replace(o,"&#123;&#123;$1&#125;&#125;");return t}}(),e=function(o){return o.join?o.join(""):o.toString()},n=function(o){return void 0===o?"":o&&"object"==typeof o?e(o):""+o},p="undefined"!=typeof process,a=("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),i=function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,m='<div class="StaffChoice"> <component data-component="SBIS3.CONTROLS/FieldLink" name="StaffChoice__fieldLink" class="StaffChoice__fieldLink controls-FieldLink__itemsEdited"> <opt name=\'showEmptyList\' type="boolean" value="false"></opt> <opt name="searchParam" value="СтрокаПоиска"/> <opt name="focusOnActivatedOnMobiles">true</opt> <opt name="idProperty" value="Лицо"></opt> <opt name=\'task1174306848\'>true</opt> <option name=\'historyId\'>IspFZone</option> <option name="itemsSortMethod" type="function">js!SBIS3.EDO.FTaskControlsHandlers:sortm</option> <opt name="autoShow">true</opt> <opts name="showAllConfig"> <opts name="componentOptions"> <opt name="searchString" bind="StaffChoice__text2" oneWay="true" direction="fromContext"/> </opts> <opt name="template" bind="templateDialog"></opt> </opts> <opts name="dataSource"> <opt name="module">WS.Data/Source/SbisService</opt> <opts name="options"> <opt name="idProperty">Лицо</opt> <opt name="endpoint">Документ</opt> <opts name="binding"> <opt name="query">СписокЗонИЛиц</opt> </opts> </opts> </opts> <opt name="text" bind="StaffChoice__text2" oneWay="true" direction="fromProperty"/> <opt name="selectedItems" type="ref">'+t(n(function(o,t){var e=a.randomId();return o[e]=t,e}(i,o.userList)))+'</opt> <opt name="placeholder" value="';return o.zone||(m+=t(n(o.placeholder))),m+='"></opt> <opt name=\'multiselect\' type="boolean" value="'+t(n(o.multiselect))+'"></opt> <opt name="displayProperty" value="Название"></opt> <opt name="useSelectorAction">true</opt> <opt name=\'selectRecordsMode\' value="newFloatArea"></opt> <opts name="dictionaries" type="array"> <opts> <opt name="name">ЧастноеЛицо</opt> <opt name="template">js!SBIS3.Staff.Choice.List</opt> <opt name="readOnly">true</opt> <opts name="dialogOptions"> <opt name="className">ws-float-area__block-layout</opt> </opts> <option name="caption">Исполнитель</option> <options name="componentOptions"> <opt name=\'selectionType\' value="all"></opt> <opt name=\'multiselect\' type="boolean" value="'+t(n(o.multiselect))+'"></opt> <opts name="display"> <opt name="useCustomScroll">true</opt> <opt name="showOtherEmployees">true</opt> </opts> </options> </opts> <options> <opt name="name">ФункциональнаяОбласть</opt> <option name="template">js!SBIS3.WorkingArea.ChooseWorkingArea</option> <option name="caption">Зона ответственности</option> <opt name="readOnly">true</opt> <options name="dialogOptions"> <option name="className">ws-float-area__block-layout</option> </options> </options> </opts> <opts name="list"> <opt name="component" value="SBIS3.CONTROLS/DataGridView"></opt> <opts name="options"> <option name="allowEmptySelection">false</option> <opt name="idProperty" value="Лицо"/> <opt name="pageSize">10</opt> <opt name="highlightEnabled">true</opt> <opts name="columns" type="array"> <opts> <opt name="title">Название</opt> <opt name="field">Название</opt> <opt name="cellTemplate" value="html!SBIS3.EDO.FZoneResponsibility/ListItemTemplate"/> <opts name="includedTemplates"> <opt name="photoTpl">html!SBIS3.PersonCore.Photo/photoTpl</opt> <opt name="employeeTpl">html!SBIS3.Employee.ListEmployees/rowTemplate</opt> <opt name="departmentTpl">html!SBIS3.Employee.ListEmployees/departmentTemplate</opt> </opts> </opts> </opts> <opt name="footerTpl"> <div class="buttonMore"> <component data-component="SBIS3.CONTROLS/Link" class="buttonMoreInner"> <opt name="name">showAllButton</opt> <opt name="caption">Показать все</opt> <opt name="visible">false</opt> </component> </div> </opt> <opts name="itemsActions" type="array"></opts> <option name="content">',"ЧастноеЛицо"==o.entityType?m+=' <opt name="idProperty" value="@Лицо"></opt> ':m+=' <opt name="idProperty" value="Сотрудник"></opt> ',m+='</option> </opts> </opts> <opts name="listFilter"> <opt name="СтрокаПоиска" value=""></opt> <opt name="Задача" value="Персонал"></opt> <opt name="ВидДерева" value="Только листья"></opt> <opt name="ПодразделениеПолныйПуть" value="true"></opt> <opt name="Разворот" value="С разворотом"></opt> <opt name="ViewType" value="List"></opt> <opt name="СтатусАктивности" value="true"/> <opt name=\'ТипРаздела\' value=\'СписокИсполнителей\'></opt> </opts> <option name="itemContentTpl" type="ref">'+t(n(function(o,t){var e=a.randomId();return o[e]=t,e}(i,o.FZoneTemplate)))+'</option> <options name="observableControls" type="array"></options> </component> <component data-component="SBIS3.CONTROLS/Action/OpenDialogAction" name="workAreaDialog"> <option name="dialogComponent" value="js!SBIS3.WorkingArea.WorkAreaDialog"></option> <option name="mode">floatArea</option> <option name="tabindex" value="0"></option> </component> </div>',(m=t(m))+(p&&-1!==m.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.FZoneResponsibility"}},o});
define('js!SBIS3.EDO.ModelZone',['WS.Data/Entity/Model','Elektronnyj_dokumentooborot_localization'],function(e){'use strict';return e.extend({_moduleName:'SBIS3.EDO.ModelZone',_$properties:{'@Лицо':{get:function(e){return e;}},'Название':{get:function(e){return e;}},'РП.идСотрудника':{get:function(e){return e;}},'РП.Сотрудник':{get:function(e){return e;}}}});});
define('js!SBIS3.EDO.ModelStaff',['WS.Data/Entity/Model','Elektronnyj_dokumentooborot_localization'],function(e){'use strict';return e.extend({_moduleName:'SBIS3.EDO.ModelStaff',_$format:[{name:'@СвязиПользователя',type:'string'},{name:'Лицо',type:'string'},{name:'Лицо_',type:'string'},{name:'Название',type:'string'}],_$idProperty:'Лицо'});});
define("html!SBIS3.EDO.FZoneResponsibility/ItemTemplate",function(){var e=function(e){var i=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(i){for(;e.test(i);)i=i.replace(e,"&#123;&#123;$1&#125;&#125;");return i}}(),t=function(e){return e.join?e.join(""):e.toString()},s=function(e){return void 0===e?"":e&&"object"==typeof e?t(e):""+e},n="undefined"!=typeof process,o=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,""),r=global.requirejs("Core/helpers/string-helpers"),l=(e.item.get("Раздел@"),e.item.get("РП.идСотрудника"));l||e.item.get("Лицо");return o+=' <div class="fzone_content"> ',null!=e.item.get("ЗонаОтветственностиНазвание")?o+=' <div class="zoneresponsibility_face">'+i(s(r.escapeHtml(e.item.get("Название"))))+"</div> "+i(s(rk("/")))+' <div class="zoneresponsibility_zone">'+i(s(r.escapeHtml(e.item.get("ЗонаОтветственностиНазвание"))))+"</div> ":(o+=" ",e.item.get("РП.Сотрудник")||1==e.item.get("Тип")?(o+=" ",e.item.get("РП.Сотрудник")?(o+=" ",e.item.get("НазваниеРабочейЗоны")?o+=' <div class="zoneresponsibility_face">'+i(s(r.escapeHtml(e.item.get("РП.Сотрудник"))))+'</div> <div class="zoneresponsibility_zone"> / '+i(s(r.escapeHtml(e.item.get("НазваниеРабочейЗоны"))))+"</div> ":o+=' <div class="zoneresponsibility_face">'+i(s(r.escapeHtml(e.item.get("РП.Сотрудник"))))+'</div> <div class="zoneresponsibility_zone"> / '+i(s(r.escapeHtml(e.item.get("Название"))))+"</div> ",o+="   "):(o+="     ",e.item.get("НазваниеРабочейЗоны")?o+=' <div class="zoneresponsibility_zone">'+i(s(r.escapeHtml(e.item.get("НазваниеРабочейЗоны"))))+"</div> ":o+=' <div class="zoneresponsibility_face">'+i(s(r.escapeHtml(e.item.get("Название"))))+"</div> ",o+=" "),o+="      "):(o+=" ",null!=e.item.get("НазваниеКраткое")?o+=' <div class="zoneresponsibility_face">'+i(s(r.escapeHtml(e.item.get("НазваниеКраткое"))))+"</div> ":o+='     <div class="zoneresponsibility_face">'+i(s(r.escapeHtml(e.item.get("Название"))))+"</div> ",o+=" "),o+=" "),o+=" </div>",(o=i(o))+(n&&-1!==o.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.FZoneResponsibility/ItemTemplate"}},e});
define('js!SBIS3.EDO.ListModelZoneResponsibility',['WS.Data/Entity/Model','js!SBIS3.Staff.StaffBrowser.RenderHelper','WS.Data/Di','Elektronnyj_dokumentooborot_localization'],function(t,e,i){'use strict';var s=t.extend({$protected:{_options:{properties:{employeeTplData:{get:function(){return e.prepareCfgEmployeeRender(null,{'Должность':this.get('Должность'),'Лицо':this.get('РП.идСотрудника')?this.get('РП.идСотрудника'):this.get('Лицо'),'ФИО':this.get('Название'),'Руководитель':this.get('Руководитель'),'Активность':this.get('Активность'),'Подразделение':this.get('ПодразделениеПолныйПуть'),'ДатаРождения':this.get('ДатаРождения'),'Метка':this.get('Метка'),'РасшифровкаМетки':this.get('РасшифровкаМетки'),'МеткаДатаКонца':this.get('МеткаДатаКонца'),'МеткаТипСостояния':this.get('МеткаТипСостояния'),'Работает':this.get('Работает'),'Заблокирован':this.get('Заблокирован'),'ДолжностьСотрудника':this.get('ДолжностьСотрудника'),'Контрагент':null,'Пользователь':this.get('Пользователь'),'Телефон':this.get('РабочийТелефон'),'СтрокаПоиска':null,'ДатаУвольнения':this.get('ДатаУвольнения'),'ДатаПринятия':this.get('ДатаПринятия'),'Пол':this.get('Пол'),ColorMarkCode:this.get('ColorMarkCode'),atWorkplace:this.get('atWorkplace'),Online:this.get('Online'),hasIcons:true},{'ОтобразитьДолжность':true,'ТекущаяЗадача':'Suggest','ОтобразитьОпцииСтроки':false,'ОтобразитьПодразделение':true});}}}}}});return i.register('zoneresponsibility.model.list',s),s;});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.FZoneResponsibility", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".zoneresponsibility-submenu.zoneresponsible>ul>.ws-menu-item{padding-left:8px}.zoneresponsibility-submenu.zoneresponsible>ul>.ws-menu-item>span.menu-span{margin-left:0}.zoneresponsibility-submenu.zoneresponsible>ul>.ws-menu-item>.photo-zoneresponsible{height:32px;width:32px;float:left}.ws-menu.zoneresponsibility-submenu.zoneresponsible{position:relative!important;display:block}.zoneresponsibility-submenu.zoneresponsible .ws-menu-item .menu-span{line-height:18px}.zoneresponsibility-submenu .ws-menu-item .menu-span{margin-right:16px}.ws-menu.zoneresponsibility-submenu.zoneresponsible .listEmpl-second-line{max-width:300px}.ws-menu.zoneresponsibility-submenu.zoneresponsible .menu-span{width:300px}.zoneresponsibility-submenu>ul>.ws-menu-item{height:inherit;padding-top:4px}.employee-row-sugg .listEmpl-first-line .listEmpl-add-info{white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.employee-row-sugg .listEmpl-second-line .listEmpl-add-info{white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.zoneresponsibility-submenu .ws-menu-item:hover{background-color:#f0f5fb}.zoneresponsibility-submenu ul.menu-ul.ws-main-menu{max-width:500px}.zoneresponsibility-submenu .menu-ul .ws-menu-item .menu-span{width:100%}.ws-disabled .edo-TaskControls_isplink{color:#e4e4e4}.row-zoneresponsibility-submenu>.listEmpl-row-empl{padding-right:45px}.buttonMore .buttonMoreInner{padding-left:4px;height:24px}.buttonMore .ws-hidden{padding:0;height:0}.zoneresponsibility_face{display:inline;color:#313e78;font-weight:700}.zoneresponsibility_zone{display:inline;color:#999;font-size:14px}.fzone_content{font-weight:400;overflow:hidden;text-overflow:ellipsis;color:#999;font-size:15px;display:inline}.fzone_content .zoneresponsibility_zone{font-weight:400}"));head.appendChild(style);});}
define("html!SBIS3.EDO.FZoneResponsibility/ListItemTemplate",function(){var e=function(e){var t,i=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;e.test(t);)t=t.replace(e,"&#123;&#123;$1&#125;&#125;");return t}}(),o=function(e){return e.join?e.join(""):e.toString()},n=function(e){return void 0===e?"":e&&"object"==typeof e?o(e):""+e},l="undefined"!=typeof process,s=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,""),a=global.requirejs("Core/helpers/string-helpers"),r=e.item,g=!0===e.item.get("Раздел@"),p=r.get("РП.идСотрудника")?r.get("РП.идСотрудника"):r.get("Лицо"),c=global.requirejs("Core/detection").firefox?" line-height: 17px;":" line-height: 19px;";if(s+=" ",g)s+=" "+i(n(e.included.departmentTpl({name:a.escapeHtml(r.get("Название")),managerFIO:a.escapeHtml(r.get("ФИОРуководителя")),employeeNumber:r.get("КолЧел"),type:r.get("ТипПодразделения"),closingDate:r.get("ДатаУвольнения"),showFolder:!0})))+" ";else{if(s+=" ",r.get("НазваниеРабочейЗоны")){if(s+=" <div>"+i(n(e.decorators.apply(a.escapeHtml(r.get("НазваниеРабочейЗоны")))))+"</div> ",t=r.get("Ответственные")&&r.get("Ответственные").getCount()?r.get("Ответственные").getCount():null,s+=" ",t){s+=" ";d="";r.get("Ответственные").each(function(e){d=d+'<div zone="'+a.escapeHtml(e.get("zoneId"))+'" zonename="'+a.escapeHtml(r.get("НазваниеРабочейЗоны"))+'" name="'+a.escapeHtml(e.get("Название"))+'" postName="'+(a.escapeHtml(e.get("postName"))||"")+'" unit="'+a.escapeHtml(e.get("unit"))+'" type="'+a.escapeHtml(e.get("Тип"))+'" staffid="'+a.escapeHtml(e.get("РП.идСотрудника"))+'" staff="'+(a.escapeHtml(e.get("РП.Сотрудник"))||"")+'" label="'+a.escapeHtml(e.get("Метка"))+'" labeldecoding="'+a.escapeHtml(e.get("РасшифровкаМетки"))+'" activity="'+a.escapeHtml(e.get("Активность"))+'" user="'+a.escapeHtml(e.get("Пользователь"))+'"></div>'}),s+=' <div style="float: right;position: absolute;right: 4px;z-index: 11;" class="sm_call staff icon-16 icon-DayForward icon-primary" zoneid="'+i(n(r.getId()))+'">'+i(n(d))+'</div> <div style="float: right; position: absolute; right: 20px;'+i(n(c))+'" class="sm_call"> '+i(n(t))+' </div> <div class="row-zoneresponsibility-submenu"> '}s+=" "}else{if(s+=" ",t=r.get("РабочиеГруппы")&&r.get("РабочиеГруппы").getCount()?r.get("РабочиеГруппы").getCount():null,s+=" ",t){s+=" ";var d="";r.get("РабочиеГруппы").each(function(e){d=d+'<div zone="'+a.escapeHtml(e.get("zoneId"))+'" zonename="'+a.escapeHtml(e.get("Название"))+'" staffid="'+a.escapeHtml(r.get("Лицо"))+'" staff="'+a.escapeHtml(r.get("НазваниеКраткое"))+'"></div>'}),s+=' <div style="float: right;position: absolute;right: 4px;z-index: 11;" class="sm_call zone icon-16 icon-DayForward icon-primary" zoneid="'+i(n(r.getId()))+'">'+i(n(d))+'</div> <div style="float: right; position: absolute; right: 20px;'+i(n(c))+'" class="sm_call"> '+i(n(t))+' </div> <div class="row-zoneresponsibility-submenu"> '}s+=" "}s+=" ",p>0&&(s+=" "+i(n(e.included.employeeTpl(e.item.get("employeeTplData"))))+" "),s+=" ",t&&(s+=" </div> "),s+=" "}return s+=" ",(s=i(s))+(l&&-1!==s.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.FZoneResponsibility/ListItemTemplate"}},e});
define('js!SBIS3.EDO.FZoneResponsibility',['Deprecated/core-attach','WS.Data/Source/SbisService','Core/helpers/string-helpers','Core/RightsManager','Core/constants','js!SBIS3.Staff.Choice','html!SBIS3.EDO.FZoneResponsibility','WS.Data/Source/SbisService','WS.Data/Entity/Model','js!SBIS3.EDO.ModelZone','js!SBIS3.EDO.ModelStaff','WS.Data/Collection/RecordSet','WS.Data/Adapter/Sbis','html!SBIS3.EDO.FZoneResponsibility/ItemTemplate','js!SBIS3.EDO.ListModelZoneResponsibility','SBIS3.CONTROLS/FieldLink','SBIS3.CONTROLS/Link','SBIS3.CONTROLS/Action/OpenDialogAction','css!SBIS3.EDO.FZoneResponsibility','js!SBIS3.EDO.FTaskControlsHandlers','Core/helpers/string-helpers','html!SBIS3.EDO.FZoneResponsibility/ItemTemplate','html!SBIS3.EDO.FZoneResponsibility/ListItemTemplate','Core/detection','i18n!SBIS3.EDO.FZoneResponsibility','Elektronnyj_dokumentooborot_localization'],function(e,t,n,i,s,o,a,r,l,c,u,g,f,d){'use strict';var h=o.extend({_dotTplFn:a,$protected:{_options:{currentDic:0,placeholder:rk('ФИО исполнителя или название зоны ответственности'),className:'zoneresponsibility',multiselect:true,flSetZone:true,userList:null,zone:null,docType:null,flagChangeZone:false,record:null,eventName:'mouseenter',FZoneTemplate:d}},getDocType:function(){return this._options.docType;},getUserList:function(){return this._options.userList;},setUserList:function(e){var t=function(e,t){var n=void 0,i=void 0;if(e&&e.getSelectedItems()&&1==e.getSelectedItems().getCount())n=e.getSelectedItems().at(0).get('@Лицо');if(t&&1==t.getCount())i=t.at(0).get('@Лицо');if(n!=i)return true;return false;};if(this._options.userList=e,t(this,e))this._setZoneStaffNew();},getZone:function(){return this._options.zone;},setZone:function(e){this._options.zone=e;},differenceArrays:function(e,t){if(!e||!t||e.getCount()!=t.getCount())return true;else{var n=function(e,t){if(e.length!=t.length)return false;for(var n=0,i=0;i<e.length;i++)n+=t.indexOf(e[i])>-1?1:0;return n==e.length;},i=[];e.each(function(e,t){i.push(e.getId());});var s=[];return t.each(function(e,t){s.push(e.getId());}),!n(i,s);}},$constructor:function(){},init:function(){h.superclass.init.call(this),this._options.eventName=!s.browser.isMobilePlatform?'mouseenter':'click';var o=this,a=o.getChildControlByName('StaffChoice__fieldLink'),l=[{validator:function(){var e=this.getSelectedItems(),t=!!(this.getText()||'').trim()?rk('Выберите сотрудника из справочника.'):rk('Поле не может быть пустым. Введите значение.');return!!e&&!!e.getCount()||t;}},{validator:function(){var e=this.getSelectedItems(),t=e.getCount();if(!!t&&e.at(t-1).has('РП.идСотрудника')){if(-1!=e.at(0).get('РП.идСотрудника'))return true;}else return true;},errorMessage:rk('У зоны ответственности нет ответственного.')}],c=new r({endpoint:{contract:'Документ'},binding:{query:'СписокЗонИЛиц'},model:'zoneresponsibility.model.list'});if(!i.checkAccessRights(['Зоны ответственности'])){a.setDictionaries([a._options.dictionaries[0]]);var u=o.getParent();if(u.hasChildControlByName('edo-TaskControls_isplink'))u.getChildControlByName('edo-TaskControls_isplink').hide();if(u.hasChildControlByName('lnkShowZone'))u.getChildControlByName('lnkShowZone').hide();}a.once('onListReady',function(e,t){this.getList().setDataSource(c,true);}),a.subscribe('onReset',function(e){var t=this.getList().getFilter();if(!('СтрокаПоиска'in t))t['СтрокаПоиска']='',this.setFilter(t);}),a.setValidators(l),a.getShowAllConfig=function(){return this._options.showAllConfig;},a.setShowAllConfig=function(e){this._options.showAllConfig=e;};var d=a.getList(),p=d.getDataSource();if(p)p.subscribe('onBeforeProviderCall',function(e,t,n){if(!d.getFilter()['СтрокаПоиска']){if(d.getPageSize())d.setPageSize(null,true);}else if(!d.getPageSize())d.setPageSize(10,true);});a.getList().subscribe('onDrawItems',function(e){var t=this.getItems(),n=false;if(t?t.getCount():0)t.each(function(e){if(e.has('Тип')&&!e.get('Тип'))n=true;}),o.getLinkedContext().setValue('templateDialog',n?'js!SBIS3.Staff.Choice.List':'js!SBIS3.WorkingArea.ChooseWorkingArea');}),a.getList().getContainer().on(o._options.eventName,'.listEmpl-row-empl',function(e){var t=$(this).parents('[data-id]'),n=a.getList();if(!$('.zoneresponsibility-submenu').is(':visible'))n.setSelectedKey(t.attr('data-id'));}),a.getList().getContainer().on(o._options.eventName,'.sm_call.zone',function(t){var i=$(this).find('[staffid]'),s=$(this).parents('[data-id]'),r=a.getList();r.setSelectedKey(s.attr('data-id')),s[o._options.eventName](function(){$('.zoneresponsibility-submenu').remove();}),$('.zoneresponsibility-submenu').remove(),t.stopPropagation(),e.attachInstance('Control/Menu',{name:'МенюРабочиеЗоны',parent:r,opener:r,handlers:{onReady:function(){var e=this;this.getContainer().css('max-width','400px').find('.menu-ul.ws-main-menu').css('max-height',document.documentElement.clientHeight-s.offset().top-24+'px').css('overflow-y','auto'),i.each(function(t,i){i=$(i);var s=n.escapeHtml(i.attr('zonename'));e.addItem({caption:s,tooltip:s,id:i.attr('zone'),handlers:{onActivated:function(e){a.setEmployee(i.attr('zone'),i.attr('zonename'),i.attr('staffid'),i.attr('staff'),r.getSelectedItem().get('Фото'),r.getSelectedItem().get('Фото_mini'),r.getSelectedItem().get('Раздел@'));}}}),e.getContainer().addClass('zoneresponsibility-submenu');}),e.show({clientX:s.offset().left+s.width(),clientY:s.offset().top},{},{},{horizontal:false,vertical:false}),$('.zoneresponsibility-submenu').mouseleave(function(){e.destroy();});}}});}),a.getList().getContainer().on(o._options.eventName,'.sm_call.staff',function(t){var i=$(this).find('[staffid]'),s=$(this).parents('[data-id]'),r=a.getList();s[o._options.eventName](function(){$('.zoneresponsibility-submenu').remove();}),$('.zoneresponsibility-submenu').remove(),t.stopPropagation(),require(['js!SBIS3.Employee.ListEmployees'],function(t){e.attachInstance('Control/Menu',{name:'МенюРабочиеЗоны',parent:r,opener:r,handlers:{onReady:function(){var e=this;this.getContainer().css('max-width','400px').find('.menu-ul.ws-main-menu').css('max-height',document.documentElement.clientHeight-s.offset().top-24+'px').css('overflow-y','auto'),i.each(function(i,s){s=$(s);var o=n.escapeHtml(s.attr('staff'));e.addItem({caption:o,tooltip:o,id:s.attr('staffid'),handlers:{onActivated:function(e){var t=null;if(a.getList().getDataSet().getRecordById(a.getList().getSelectedKey()).get('Ответственные').each(function(n){if(n.has('РП.идСотрудника')&&n.get('РП.идСотрудника')===+e)t=n;}),t)a.setEmployee(s.attr('zone'),s.attr('zonename'),e,s.attr('staff'),t.get('Фото'),t.get('Фото_mini'),t.get('Раздел@'));else a.setEmployee(s.attr('zone'),s.attr('zonename'),e,s.attr('staff'));}}});var r=a.renderSubmenuItem(e,s,t);e.getContainer().addClass('zoneresponsibility-submenu zoneresponsible').find('li.ws-menu-item[id = '+s.attr('staffid')+'] span').empty().append(r).css({'padding-left':'3px','padding-bottom':'3px'});}),e.show({clientX:s.offset().left+s.width(),clientY:s.offset().top+18},{},{},{horizontal:false,vertical:false}),$('.zoneresponsibility-submenu').mouseleave(function(t){if($($(t.relatedTarget).wsControl().getTopParent().getContainer()[0]).children('.PersonMiniCard').length<1)e.destroy();else $($($(t.relatedTarget).wsControl().getTopParent().getContainer()[0]).children('.PersonMiniCard')[0]).mouseleave(function(t){if(!$(t.relatedTarget).hasClass('menu-ul')&&!$(t.relatedTarget).hasClass('ws-float-close-right'))e.destroy();});});}}});});}),a.renderSubmenuItem=function(e,t,i){return i.createBlockInfoEmployee(e,{'ИдО':t.attr('staffid'),'Должность':t.attr('postName')||'&nbsp;','ИдФотоМини':true,'Лицо':t.attr('staffid'),'ФИО':n.escapeHtml(t.attr('name')||' '),'Руководитель':null,'Активность':parseInt(t.attr('activity')),'Подразделение':t.attr('unit'),'Метка':t.attr('label')||false,'РасшифровкаМетки':t.attr('labeldecoding')||false,'Пользователь':parseInt(t.attr('user'))},{'БезФото':false,'ТекущаяЗадача':'Suggest'});},a.setEmployee=function(e,t,n,i,s,r,l){o._options.flSetZone=false,a.setSelectedItems([o._createModelZone(e,t,n,i,s,r,l)]),o._options.currentDic=1;},a.subscribe('onAfterShow',function(e){if(this._options.handlerOnItemActivate=this.getEventHandlers('onItemActivate')[0],this.getSelectedItems()&&this.getSelectedItems().getCount()){var t=this.getSelectedItems().at(0);if(t.has('РП.идСотрудника')&&t.get('РП.идСотрудника')||t.has('Название')&&t.get('Название')&&t.has('РП.Сотрудник')&&t.get('РП.Сотрудник'))this.unsubscribe('onItemActivate',this._options.handlerOnItemActivate);if(t.has('ЗонаОтветственности')&&t.get('ЗонаОтветственности'))this.unsubscribe('onItemActivate',this._options.handlerOnItemActivate);}}),a.subscribe('onFocusIn',function(){if(o._options.flSetZone=false,!this.getSelectedKeys().length)this._options.listFilter.ТипДокумента=this.getParent().getDocType();}),this.getLinkedContext().subscribe('onFieldChange',function(e,t){if('record'==t)o._options.record=this.getValue('record');if('record/РазличныеДокументы.ЗонаОтветственности'==t&&o._options.flagChangeZone){if(o._options.record)o._options.record.acceptChanges();else o.getLinkedContext().getValue('record').acceptChanges();o._options.flagChangeZone=false;}}),a.subscribe('onChooserClick',function(e,t){o._options.flSetZone=false,t.multiselect=false!==t.dialogOptions.multiselect;}),a.subscribe('onSelectedItemsChange',function(e,t,i){var s=null,r=[],l=[],c=a.getSelectedItems(),u=c.getCount(),d=u?a.getSelectedItems().at(u-1):null,h=[];if(u){if(d.has('РП.идСотрудника')&&d.get('РП.идСотрудника')){if(s=d.getId(),r[0]=d.has('РП.идСотрудника')&&d.get('РП.идСотрудника')?parseInt(d.get('РП.идСотрудника'),10):null,l[0]=d.has('РП.Сотрудник')&&d.get('РП.Сотрудник')?d.get('РП.Сотрудник'):null,s===r[0])s=o.getZone();if(this.setPlaceholder(''),this.setMultiselect(false),h.push([r[0],null,r[0],l[0],'','','',null,d.has('Фото')?d.get('Фото'):null,d.has('Фото_mini')?d.get('Фото_mini'):null]),1==t.length&&t[0]==o.getZone()&&o.getUserList()&&o.getUserList().getCount()&&o.getUserList().at(0).getId()!=r[0]);if(c.getCount()>1||c.at(0)!==d)a.setSelectedItems([d]);if(o._options.currentDic=1,this._options.handlerOnItemActivate)this.unsubscribe('onItemActivate',this._options.handlerOnItemActivate);}else if(d.has('ЗонаОтветственности')&&d.get('ЗонаОтветственности'))s=d.get('ЗонаОтветственности'),h.push([d.get('@Лицо'),null,d.get('@Лицо'),n.escapeHtml(d.get('Название')),'','','',null,d.has('Фото')?d.get('Фото'):null,d.has('Фото_mini')?d.get('Фото_mini'):null]),this.setPlaceholder('ФИО исполнителя'),this.setMultiselect(true);else{var p=[];if(this.setPlaceholder('ФИО исполнителя'),this.setMultiselect(true),c.each(function(e){if(e.has('Лицо')&&e.get('Лицо')&&!(e.has('ЗонаОтветственностиНазвание')&&null!==e.get('ЗонаОтветственностиНазвание'))&&!(e.has('РП.идСотрудника')&&e.get('РП.идСотрудника')))if(-1==r.indexOf(e.get('Лицо'))){r.push(e.get('Лицо'));var t=e.has('ФотоБольшое')&&e.get('ФотоБольшое')?e.get('ФотоБольшое'):e.has('Фото')&&e.get('Фото')?e.get('Фото'):null,i=e.get('Название');if(e.get('НазваниеПолное')){var s=e.get('НазваниеПолное').split(' ');if(3==s.length)s.pop(),i=s.join(' ');}h.push([e.get('Лицо'),null,e.get('Лицо'),n.escapeHtml(i),'','','',null,t,e.has('Фото_mini')?e.get('Фото_mini'):e.get('Фото'),e.get('Раздел@')]);}else p.push(e.get('Лицо'));}),p.length)this.removeItemsSelection(p);if(1==o._options.currentDic){var m=[];c.each(function(e){if(e.has('@СвязиПользователя')||e.has('Лицо')&&e.has('Тип')&&!e.get('Тип'))m.push(e);}),o._options.currentDic=0,a.setSelectedItems(m);}if(o._options.currentDic=0,-1==this.getEventHandlers('onItemActivate').indexOf(this._options.handlerOnItemActivate)&&!(d&&d.has('Название')&&d.has('РП.Сотрудник')&&d.get('Название')&&d.get('РП.Сотрудник')&&d.get('Название')!=d.get('РП.Сотрудник')))if(this._options.handlerOnItemActivate)this.subscribe('onItemActivate',this._options.handlerOnItemActivate);}a.validate();}else{if(o._options.flSetZone=false,o._options.currentDic=null,o.getTopParent().hasChildControlByName('execPhotoBlock'))o.getTopParent().getChildControlByName('execPhotoBlock').setPerson(null);this.setPlaceholder(rk('ФИО исполнителя'));}if(o.getZone()!=s&&!(o.getZone()<0&&null==s))o.setZone(s),o._notifyOnPropertyChanged('zone');var S=new g({adapter:new f(),rawData:{_type:'recordset',d:h,s:[{n:'@Лицо',t:'Число целое'},{n:'Документ',t:'Число целое'},{n:'Лицо',t:'Число целое'},{n:'Название',t:'Текст'},{n:'ТипЛица',t:'Текст'},{n:'Подразделение',t:'Текст'},{n:'РуководительПодразделения',t:'Текст'},{n:'РуководительПодразделенияИд',t:'Число целое'},{n:'Фото',t:'Число целое'},{n:'Фото_mini',t:'Число целое'},{n:'Раздел@',t:'Логическое'}]}});if(o.differenceArrays(o.getUserList(),S))o.setUserList(S),o._notifyOnPropertyChanged('userList');}),a.subscribe('onTextChange',function(e,t){o._options.flSetZone=false;}),a.subscribe('onItemActivate',function(e,n){var i=n.item,s=i.has('ЗонаОтветственности')&&i.get('ЗонаОтветственности')?i.get('ЗонаОтветственности'):null;if(o.hasChildControlByName('workAreaDialog')&&n.id&&(i.has('@Лицо')||i.has('Тип')&&i.get('Тип')))if(s)new t({endpoint:'ФункциональнаяОбласть'}).call('Прочитать',{'ИдО':s,'ИмяМетода':'Список'}).addCallback(function(){o.getChildControlByName('workAreaDialog').execute({id:s,item:i});});});},_createLazyModelZone:function(e,t,n,i){var s=new c({rawData:{'@Лицо':e,'Лицо':e,'Название':i,'РП.идСотрудника':n,'РП.Сотрудник':i,'ЗонаОтветственности':e,'ЗонаОтветственностиНазвание':t}});return s.setIdProperty('Лицо'),s;},_createModelZone:function(e,t,n,i,s,o,a){if(s||o)var r=new c({rawData:{'@Лицо':e,'Лицо':e,'Название':t,'РП.идСотрудника':n,'РП.Сотрудник':i,'Фото':s,'Фото_mini':o,'Раздел@':a}});else r=new c({rawData:{'@Лицо':e,'Лицо':e,'Название':t,'РП.идСотрудника':n,'РП.Сотрудник':i,'Раздел@':a}});return r.setIdProperty('Лицо'),r;},_setZoneStaff:function(){var e=this,t=e.getChildControlByName('StaffChoice__fieldLink'),n=e.getLinkedContext().getValue('record');if(e._options.flSetZone=false,e._options.zone&&e._options.zone>0){var i=e._options.userList,s=i&&i.getCount()?i.at(0):null,o=s?s.getId():null,a=s?s.get('Название'):null;t.setSelectedItems([e._createModelZone(n.get('РазличныеДокументы.ЗонаОтветственности'),n.get('ЗонаОтветственностиНазвание'),o,a)]),e._options.currentDic=1;}else if(e._options.userList){var r=[];e._options.userList.each(function(e){var t=new(l.extend({$protected:{_options:{properties:{'@СвязиПользователя':{get:function(e){return e;}},'Лицо':{get:function(e){return e;}},'Название':{get:function(e){return e;}}}}}}))({rawData:{'@СвязиПользователя':e.getKey(),'Лицо':e.getKey(),'Название':e.get('Название')}});t.setIdProperty('@СвязиПользователя'),r.push(t);}),t.setSelectedItems(r),e._options.currentDic=0;}},_setZoneStaffNew:function(){var e=this,t=e.getChildControlByName('StaffChoice__fieldLink');if(e._options.userList&&e._options.userList.getCount())if(e._options.userList.at(0).has('ЗонаОтветственности')&&e._options.userList.at(0).get('ЗонаОтветственности')){var n=e._options.userList.at(0).getId(),i=e._options.userList.at(0).get('Название'),s=e._options.userList.at(0).get('ЗонаОтветственностиНазвание'),o=e._options.userList.at(0).get('ЗонаОтветственности');try{if(!t.getSelectedItems()||!t.getSelectedItems().at(0).get('ЗонаОтветственности'))t.setSelectedItems([e._createModelZone(o,s,n,i)]);else t.setSelectedItems([e._createLazyModelZone(o,s,n,i)]);}catch(a){t.setSelectedItems([e._createModelZone(o,s,n,i)]);}e._options.currentDic=1;}else if(t.getSelectedItems()&&t.getSelectedItems().at(0).get('РП.идСотрудника'))return;else{var a=[];e._options.userList.each(function(e){var t=new u({rawData:{'@СвязиПользователя':e.getId(),'@Лицо':e.getId(),'Лицо':e.getId(),'Лицо_':e.get('Лицо_'),'Название':e.get('Название'),'Раздел@':e.get('Раздел@'),'Фото':e.has('Фото')?e.get('Фото'):null}});t.setIdProperty('Лицо'),a.push(t);}),t.setSelectedItems(a),e._options.currentDic=0;}}});return h;});
define('js!SBIS3.EDO.OperationControl',['SBIS3.CONTROLS/Link','js!SBIS3.EDO.MarkHandlers','i18n!SBIS3.EDO.OperationControl','Elektronnyj_dokumentooborot_localization'],function(e,t){'use strict';var n=e.extend({$protected:{_options:{name:'control',icon:'sprite:icon-24 icon-Show icon-primary',caption:rk('Поставить на контроль'),tooltip:rk('Поставить на контроль'),set:true}},$constructor:function(){this.changeSelectionHandlerDebounce=this._changeSelectionHandler.debounce(100,true);},init:function(){n.superclass.init.call(this);},onSelectedItemsChange:function(e){t.onSelectedItemsChange(this,this.changeSelectionHandlerDebounce,e);},_changeSelectionHandler:function(e,n){if(t.hasLeafInSelected(n,e.getParentProperty&&e.getParentProperty()))this.show();else this.hide();},_clickHandler:function(){var e=this,t=e._options.linkedView,n=t.getSelectedItems().getEnumerator(),o=n.getNext(),r=t.getParentProperty&&t.getParentProperty(),i=[],a=[],s,c,l;while(o){if(!o.get(r+'@'))a.push(parseInt(o.get('@Документ'),10)),i.push(o.getId());o=n.getNext();}if(this._options.set)c='ПоставитьНаКонтрольМассово',s=rk('Ошибка при постановке на контроль')+': ',l=rk('Постановка на контроль')+'...';else c='СнятьСКонтроляМассово',s=rk('Ошибка при снятии с контроля')+': ',l=rk('Снятие с контроля')+'...';if(a.length)require(['WS.Data/Source/SbisService','Core/Indicator','Core/EventBus'],function(n,o,r){o.setMessage(l),o.show(),new n({endpoint:'СвязьПапок'}).call(c,{'ИдО':a,'Лицо':-1}).addCallback(function(n){if(o.hide(),t.removeItemsSelection(i),!e._options.set){var s=t.getTopParent();if(s&&s.hasChildControlByName('PartialReloader'))r.channel('EdoPartialReloader').notify('onRemoveFromControl',{id:t.getId(),docs:a});else t.reload();}else require(['js!SBIS3.EDO.EdoCounters'],function(e){e.updateCounters();});}).addErrback(function(e){o.hide(),require(['Core/core-functions'],function(t){t.alert(s+e.message,'error');});});});}});return n;});
define('js!SBIS3.EDO.OperationPrintDetalization',['Core/helpers/string-helpers','js!SBIS3.EDO.OperationPrint','Elektronnyj_dokumentooborot_localization'],function(t,n){'use strict';var e=n.extend({$constructor:function(){},init:function(){var t=this;e.superclass.init.call(t);},applyOperation:function(n){n['xsl']='Elektronnyj_dokumentooborot/Statistika/Pechatnye_formy/DetalizationEventsPrint.xsl',n['report']='DetalizationEventsPrint',n['dataSet'].each(function(n){var e=['РазличныеДокументы.Информация','ДокументРасширение.Название'];for(var i in e){if(!e.hasOwnProperty(i))continue;var r=n.get(e[i])?t.htmlToText(n.get(e[i])):'';r=r.length>255?r.substr(0,255)+'...':r,n.set(e[i],r);}}),e.superclass.applyOperation.call(this,n);}});return e;});
define('js!SBIS3.EDO.OperationShowHistory',['Core/moduleStubs','SBIS3.CONTROLS/Link','i18n!SBIS3.EDO.OperationShowHistory','Elektronnyj_dokumentooborot_localization'],function(i,t){'use strict';var o=t.extend({$protected:{_options:{icon:'sprite:icon-24 icon-ExpandList icon-primary',tooltip:rk('История'),caption:rk('История'),name:'history',objectHistoryName:'Документ',isCheckSite:true}},$constructor:function(){},init:function(){o.superclass.init.call(this);},_clickHandler:function(){require(['js!SBIS3.HISTORY.HistoryControl'],function(t){t[this._options.showHistoryObject?'showHistoryObject':'showHistoryCatalog'](this,{objectName:this._options.objectHistoryName,isCheckSite:this._options.isCheckSite,isShowSearchByObject:true,openCardFunction:function(t,o,e){i.requireModule('SBIS3.EDO2.OpenDialogAction').addCallback(function(i){new i[0]().execute({id:t,openMode:4});});}});}.bind(this));}});return o;});
define('js!SBIS3.EDO.OperationUnloadDetalization',['Core/core-functions','WS.Data/Source/SbisService','Core/helpers/string-helpers-min','Core/helpers/random-helpers','Core/constants','SBIS3.CONTROLS/Link','Core/EventBus','i18n!SBIS3.EDO.OperationUnloadDetalization','Elektronnyj_dokumentooborot_localization'],function(e,t,i,n,r,o,a){'use strict';var l=o.extend({$protected:{_options:{icon:'sprite:icon-24 action-hover icon-Save icon-primary',title:rk('Выгрузить'),linkText:rk('Выгрузить'),caption:rk('Выгрузить'),tooltip:rk('Выгрузить')}},$constructor:function(){},init:function(){var e=this;l.superclass.init.call(e);},_clickHandler:function(){var o=n.createGUID(),l=i.deserializeURLData(decodeURIComponent(this.getTopParent().getLinkedContext().getValue('phaseReportParams'))),s=(!!l.isDivision&&null!==l.title&&'Всего'!==l.title||!l.isDivision&&'Нераспределенные'===l.title?'':jQuery('div.stat_title_phase').find('span.title_name').text()).replace(/\s{2,}/g,' ').trim(),c=(this.getTopParent().hasChildControlByName('filterLine')&&this.getTopParent().getChildControlByName('filterLine').getContainer().find('span.controls__filterButton__filterLine-items').text()||rk('Выгрузка детализации')).replace(/\s{2,}/g,' ').trim(),p='По ответственному'===l.filter['ФильтрРазрезСтатистики']?'по ответственному':'',d=s+(s&&c?',':'')+c+((s||c)&&p?',':'')+p,h=e.clone(this.getTopParent().getChildControlByName('browserView').getFilter()),g=this&&this.getParent(),u=g&&g.getParent(),f=u&&u._getView(),C=f&&f.getSelectedKeys();h['ФильтрСписокСобытийВыгрузка']=C&&C.length>0?C:null,a.channel('LongOperations').notify('onOperationStarted',rk('Пожалуйста, подождите...')),new t({endpoint:'ДетализацияСтатистики'}).call('ВыгрузкаDWC',{'Фильтр':h,'ИмяФайла':''===d?'Все задачи':d,id:o,isMobile:r.browser.isMobilePlatform,'ИмяХоста':location.host}).addCallback(function(){}).addErrback(function(t){e.alert(t.message,t.details,rk('Ошибка выгрузки детализации'));});}});return l;});
define('js!SBIS3.EDO.OperationsForRedactions',['Deprecated/helpers/fast-control-helpers','Core/core-functions','Core/helpers/fast-control-helpers','Core/Indicator','Core/EventBus','SBIS3.CONTROLS/Utils/InformationPopupManager','WS.Data/Source/SbisService','Core/Deferred','i18n!SBIS3.EDO.EdoOperationsCommon','Elektronnyj_dokumentooborot_localization'],function(e,t,r,a,n,o,s,l){'use strict';return{deleteToTrash:function(o,s,i){require(['WS.Data/Collection/RecordSet','WS.Data/Adapter/Sbis','WS.Data/Source/SbisService'],function(d,g,c){var h=s.getCount?s.getCount():'',f=h?(h>1?rk('отмечено'):rk('отмечена'))+' '+h+' '+rk('запись(-и,-ей)',h):'',u=h?rk('Удалить')+' '+(1===h?rk('отмеченную запись'):rk('отмеченные записи'))+'?':rk('Удалить текущую запись?');if(0===h)return;if(i&&i.eraseFromCart)u=rk('Восстановление документов будет невозможно. Продолжить?'),f='';e.question(u,{detail:f},o).addCallback(function(e){if(true===e){a.setMessage(rk('Удаление')),a.show();var i=o.getTopParent(),f=i&&i.hasChildControlByName('PartialReloader'),u=[],p=[],m=!!h,C=function(e){var r=new l(),n=new d({idProperty:'doc',rawData:{_type:'recordset',d:e,s:[{n:'doc',t:'Число целое'},{n:'event',t:'Число целое'}]},adapter:new g()}),o=new c({endpoint:'Документооборот'});return r.dependOn(o.call('DeleteRedactionMass',{doc_list:n}).addCallback(function(e){var r=e.getAll().getEnumerator(),a=r.getNext();while(a){if(a.get('error_msg'))if(m){var n=S[a.get('doc')];if(n)u.push('\u2116'+n[1]+': '+a.get('error_msg')),delete p[p.indexOf(n[0])];}else t.alert(a.get('error_msg'),'','error'),p=[];a=r.getNext();}}).addErrback(function(e){a.hide(),t.alert(e.message,'error');})),r;};if(m){var k=[],S={},I=s.getEnumerator(),D=I.getNext();while(D)k.push([D.get('ИдРедакции'),D.get('@Событие')]),S[D.get('@Документ')]=[D.getId(),D.get('Номер')],p.push(D.getId()),D=I.getNext();if(k.length)return C(k).addCallback(function(){if(a.hide(),u.length>0)r.openErrorsReportDialog({numSelected:s.getCount(),numSuccess:parseInt(s.getCount(),10)-parseInt(u.length,10),errors:u,title:rk('Итоги операции')+': "'+rk('Удаление документов')+'"'});if(o.removeItemsSelection(p),f)n.channel('EdoPartialReloader').notify('onDeleteToTrash',{id:o.getId(),keys:p});else o.reload();n.channel('DeleteChannel').notify('deleteToTrash',p);});}else return p.push(s.getId()),C([[s.get('ИдРедакции'),s.get('@Событие')]]).addCallback(function(){if(a.hide(),f)n.channel('EdoPartialReloader').notify('onDeleteToTrash',{id:o.getId(),keys:p});else o.reload();n.channel('DeleteChannel').notify('deleteToTrash',p);});}});});},restoreFromTrash:function(e,r){if(!(r.get('Удален')||r.get('РедакцияУдалена')))return;var o=r.has('МетодВосстановления')&&r.get('МетодВосстановления')&&r.has('@Событие')&&r.get('@Событие'),l=r.has('ИдРедакции')&&r.get('ИдРедакции')?parseInt(r.get('ИдРедакции'),10):parseInt(String(r.get('@Документ')).split(',')[0],10),i=o?r.get('МетодВосстановления'):'Восстановить',d={'ключДокумента':l},g=e.getTopParent(),c=g&&g.hasChildControlByName('PartialReloader'),h=[];if(o)d['идСобытия']=r.get('@Событие');return a.setMessage(rk('Восстановление')+'...'),new s({endpoint:'Документ'}).call(i,d).addCallback(function(o){if(a.hide(),e.removeItemsSelection([r.getId()]),o&&(o.length>0||o.message))t.alert(o.message?o.message:o,'error');else if(c)n.channel('EdoPartialReloader').notify('onRestoreFromTrash',{id:e.getId(),docs:[r.get('@Документ')]});else e.reload();h.push(r.getId()),n.channel('DeleteChannel').notify('restoreFromTrash',h);}).addErrback(function(e){a.hide(),t.alert(e.message,'error');});},deleteFromTrash:function(e,t){var r=e.getTopParent(),l=t.get('@Документ')?t.get('@Документ'):t.get('Документ.@Документ')?t.get('Документ.@Документ'):false;require(['Core/core-attach'],function(i){i.attachInstance('Control/Area:DialogConfirm',{resizeable:false,opener:r,message:rk('Восстановление документа будет невозможно. Продолжить?'),handlers:{onConfirm:function(r,i){if(true===i)if(l){a.setMessage(rk('Удаление из корзины')+'...');var d=t.get('ТипДокумента.ТипДокумента');if(d)new s({endpoint:d}).call('Удалить',{'ИдО':[parseInt(l,10)]}).addCallback(function(){a.hide();var t=e.getTopParent();if(t&&t.hasChildControlByName('PartialReloader'))n.channel('EdoPartialReloader').notify('onDeleteFromTrash',{id:e.getId(),docs:[parseInt(l,10)]});else e.reload();}).addErrback(function(e){a.hide(),o.showMessageDialog({message:e.message,status:'error'});});else o.showMessageDialog({message:rk('Ошибка при удалении документа'),status:'error'});}}}});});}};});
define("html!SBIS3.EDO.ReconciliationReportControlsBlock",function(){var o=function(o){var n=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;o.test(n);)n=n.replace(o,"&#123;&#123;$1&#125;&#125;");return n}}(),e=function(o){return o.join?o.join(""):o.toString()},t=function(o){return void 0===o?"":o&&"object"==typeof o?e(o):""+o},i="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,"<div> ");return o.showCommentField&&(a+=' <div class="Report__Comment_Container"> <component data-component="SBIS3.CONTROLS/TextArea" style="width:100%"> <option name="maxLength">256</option> <option name="minLinesCount">2</option> <options name="autoResize"> <option name="state">true</option> <option name="maxLinesCount">3</option> </options> <option name="text" bind="record/'+n(t(o.commentField))+'"></option> <option name="className" bind="record/'+n(t(o.commentClassField))+'" oneWay="true"></option> <option name="placeholder">'+n(t(rk("Комментарий")))+'</option> <option name="tabindex" value="1"></option> <option name="visible" bind="record/'+n(t(o.commentClassField))+'Editable" oneWay="true" nonexistent="false">false</option> </component> <component data-component="SBIS3.EDO.ReconciliationReportLabel"> <option name="text" bind="record/'+n(t(o.commentField))+'"></option> <option name="visible" bind="record/'+n(t(o.commentClassField))+'ReadOnly" oneWay="true" nonexistent="false">false</option> </component> </div> '),a+=" ",o.showChoiceBlock&&(a+=' <div class="Report__OurChoice_container Report__container" data-bind="visible: record/sumConfirmationAllowed"> <component data-component="SBIS3.EDO.ReconciliationReportSumConfirmation" name="SumConfirmation"> <option name="enabled">true</option> <option name="allowChangeEnable">false</option> </component> </div> '),a+=" ",o.showAttachBlock&&(a+=' <div class="Report__Attach_container"> <div class="Report__Attach_item Report__Attach_file"> <component data-component="SBIS3.EDO2.AttachButton" name="AttachTo"> <option name="objectName">'+n(t(o.objectName))+'</option> <options name="referenceTypes"> <option name="sbisDisk">false</option> <option name="web">true</option> <option name="employees">false</option> <option name="companies">false</option> </options> <option name="visible" bind="record/'+n(t(o.attachEnabledField))+'" nonexistent="false">false</option> </component> </div> <div class="Report__Attach_item"> <component data-component="SBIS3.EDO2.DialogImportButton" name="CreateIntegration"> <options name="buttonSettings"> <option name="controlType">Link</option> <option name="caption">'+n(t(rk("Загрузить из учетной системы")))+'</option> <option name="icon">icon-16 icon-Upload icon-primary</option> </options> <option name="visible" bind="record/'+n(t(o.attachEnabledField))+'" nonexistent="false">false</option> </component> </div> <div class="Report__Attach_item"> <component data-component="SBIS3.DOCVIEW.SwitchVisibilityMode" name="ModeSwitcher"> <options name="hasSwitch"> <option name="bigPreview" value="true" type="boolean"></option> <option name="diskClassic" value="false" type="boolean"></option> <option name="classic" value="true" type="boolean"></option> </options> <options name="listOptions"> <options name="visibilityMode"> <option name="defaultMode">classic</option> <option name="setFromCookie">false</option> </options> </options> <option name="visible" bind="record/toggleSwitchVisibilityMode" nonexistent="false">false</option> </component> </div> </div> '),a+=' <div class="Report__FullViewer"> <component data-component="SBIS3.EDO2.Viewer"> <option name="name">'+n(t(o.docviewName))+'</option> <option name="objectName">'+n(t(o.objectName))+'</option> <option name="sourceField">'+n(t(o.sourceAttaches))+'</option> <option name="enabled">'+n(t(o.enabled))+'</option> <option name="allowChangeEnable">'+n(t(o.allowChangeEnable))+"</option> </component> </div> </div>",(a=n(a))+(i&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.ReconciliationReportControlsBlock"}},o});
define("tmpl!SBIS3.EDO.ReconciliationReportLabel",["Core/tmpl/js/tclosure"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={},i=function e(i,n,a,l,o){function s(){}var c=0,d=void 0!==t&&t?t:arguments[arguments.length-1];void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure"));var p={};o&&o.isSetts&&(p=o.fullContext||{});var u="string"==typeof a?a:"",f=void 0===r?void 0:r,v={id:[],def:void 0},m=d.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,i),g=this&&this.includedTemplates?this.includedTemplates:{},b=d.getMarkupGenerator(l);try{var h=b.joinElements([b.createTag("div",{class:"report-Label"+d.wrapUndef(d.utils.escape(d.getter(i,["enabled"])?" ws-enabled":""))+d.wrapUndef(d.utils.escape(d.getter(i,["className"])?" "+d.getter(i,["className"]):""))+d.wrapUndef(d.utils.escape(d.getter(i,["visible"])?"":" ws-hidden")),title:""+d.wrapUndef(d.utils.escape(d.getter(i,["text"])))},[b.createText(""+d.wrapUndef(d.utils.escape(d.getter(i,["text"]))))],n,v,this)],u,v);v.def&&(h=b.chain(h,v,n),v=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/components/ReconciliationReport/Label/ReconciliationReportLabel.tmpl",e,i)}return h||""};return i.includedFunctions={},i.stable=!0,i.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.ReconciliationReportLabel"}},i});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.ReconciliationReportLabel", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".report-Label{margin:4px 5px}.report-Label.ws-hidden,.report-Label:empty{margin:0}.controls-TabButton__caption .report-Label{display:inline;margin:0}"));head.appendChild(style);});}
define('js!SBIS3.EDO.ReconciliationReportLabel',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.ReconciliationReportLabel','css!SBIS3.EDO.ReconciliationReportLabel','Elektronnyj_dokumentooborot_localization'],function(t,i){'use strict';var n=t.extend({_dotTplFn:i,$protected:{_options:{text:''}},$constructor:function(){},init:function(){n.superclass.init.call(this);},setText:function(t){this._options.text=t,this.rebuildMarkup();}});return n;});
define("html!SBIS3.EDO.ReconciliationReportSumConfirmation",function(){var o=function(o){var n=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;o.test(n);)n=n.replace(o,"&#123;&#123;$1&#125;&#125;");return n}}(),t=function(o){return o.join?o.join(""):o.toString()},i=function(o){return void 0===o?"":o&&"object"==typeof o?t(o):""+o},e="undefined"!=typeof process,r=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div> <component data-component="SBIS3.CONTROLS/Radio/Group" name="SumConfirmationRadios" class="ws-Label-content controls-ButtonGroup__vertical SumConfirmationRadios__rel"> <option name="displayProperty">title</option> <option name="idProperty">id</option> <option name="selectedKey" bind="record/ourSumResultKey" oneWay="true"></option> <option name="allowChangeEnable">false</option> <options name="items" type="array"> <options> <option name="id" type="string">0</option> <option name="title">Наши расчеты совпадают с расчетами контрагента</option> </options> <options> <option name="id" type="string">1</option> <option name="title" type="content"> '+n(i(rk("Ввести суммы вручную")))+' <div class="SumConfirmationRadios__inline_edit"> <component data-component="SBIS3.EDO.ReconciliationReportSumConfirmationPanel" class="position"> </component> </div> </option> </options> <options> <option name="id" type="string">2</option> <option name="title">Задолженность отсутствует</option> </options> </options> </component> </div>');return(r=n(r))+(e&&-1!==r.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.ReconciliationReportSumConfirmation"}},o});
define("html!SBIS3.EDO.ReconciliationReportSumConfirmationPanel",function(){var o=function(o){var e=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(e){for(;o.test(e);)e=e.replace(o,"&#123;&#123;$1&#125;&#125;");return e}}(),n=function(o){return o.join?o.join(""):o.toString()},t=function(o){return void 0===o?"":o&&"object"==typeof o?n(o):""+o},i="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div> <label data-lmtype="Label" class="ws-Label ws-Label-titleLeft control-InRadio__position"> <span data-lmchild="label-title" class="ws-Label-title">'+e(t(rk("Нам должны (дебет)")))+':</span> <component data-component="SBIS3.CONTROLS/NumberTextBox" class="position"> <option name="tabindex">1</option> <option name="name">TxtDebit</option> <option name="decimals">2</option> <option name="integers">13</option> <option name="hideEmptyDecimals">false</option> <option name="showEmptyDecimalsOnFocus">false</option> <option name="notNegative">true</option> <option name="numericValue" bind="record/ourDebit"></option> </component> </label> <label data-lmtype="Label" class="ws-Label ws-Label-titleLeft control-InRadio__position"> <span data-lmchild="label-title" class="ws-Label-title">'+e(t(rk("Мы должны (кредит)")))+':</span> <component data-component="SBIS3.CONTROLS/NumberTextBox" class="position txtcredit"> <option name="tabindex">2</option> <option name="name">TxtCredit</option> <option name="decimals">2</option> <option name="integers">13</option> <option name="hideEmptyDecimals">false</option> <option name="showEmptyDecimalsOnFocus">false</option> <option name="notNegative">true</option> <option name="numericValue" bind="record/ourCredit"></option> </component> </label> </div>');return(a=e(a))+(i&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.ReconciliationReportSumConfirmationPanel"}},o});
define('js!SBIS3.EDO.ReconciliationReportSumConfirmationPanel',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.ReconciliationReportSumConfirmationPanel','SBIS3.CONTROLS/NumberTextBox','Elektronnyj_dokumentooborot_localization'],function(n,o){'use strict';var t=n.extend({_dotTplFn:o,$protected:{_options:{ignoreTabCycles:false}},$constructor:function(){},init:function(){t.superclass.init.call(this);}});return t;});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.ReconciliationReportSumConfirmation", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".SumConfirmationRadios__rel .controls-RadioButton__caption{position:relative}.SumConfirmationRadios__inline_edit{position:absolute;top:0;left:100%;margin-left:20px;white-space:nowrap;display:none}.SumConfirmationRadios__inline_edit .control-InRadio__position{margin-left:20px}.SumConfirmationRadios__rel .controls-Checked__checked .SumConfirmationRadios__inline_edit{display:block}.SumConfirmationRadios__rel span.controls-ListView__item.controls-RadioButton{float:left;clear:left;width:200px;overflow:visible;white-space:nowrap}"));head.appendChild(style);});}
define('js!SBIS3.EDO.ReconciliationReportSumConfirmation',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.ReconciliationReportSumConfirmation','SBIS3.CONTROLS/Radio/Group','js!SBIS3.EDO.ReconciliationReportSumConfirmationPanel','css!SBIS3.EDO.ReconciliationReportSumConfirmation','Elektronnyj_dokumentooborot_localization'],function(t,e){'use strict';var i=t.extend({_dotTplFn:e,$protected:{_ctx:null,_options:{}},$constructor:function(){},init:function(){i.superclass.init.call(this),this._ctx=this.getLinkedContext(),this._initRadioListeners();},_initHandwriteListeners:function(){var t=this.getChildControlByName('TxtDebit'),e=this.getChildControlByName('TxtCredit');if(t&&e){var i=function(){if(e.getValue())t.unsubscribe('onTextChange',n),t.setText('0'),t.subscribe('onTextChange',n);},n=function(){if(t.getValue())e.unsubscribe('onTextChange',i),e.setText('0'),e.subscribe('onTextChange',i);};t.subscribe('onTextChange',n),e.subscribe('onTextChange',i);}},_initRadioListeners:function(){var t=this.getChildControlByName('SumConfirmationRadios'),e=this.getChildControlByName('TxtDebit'),i=this.getChildControlByName('TxtCredit');if(t)t.subscribe('onSelectedItemChange',function(t,i){var n=this.getLinkedContext().getValue('record');if(n)switch(i){case'0':n.equalizeDebt();break;case'2':n.setDebtToZero();break;case'1':e.setActive(true);}});}});return i;});
define('js!SBIS3.EDO.ReconciliationReportControlsBlock',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.ReconciliationReportControlsBlock','SBIS3.CONTROLS/TextArea','js!SBIS3.EDO.ReconciliationReportLabel','js!SBIS3.EDO2.AttachButton','js!SBIS3.EDO2.DialogImportButton','js!SBIS3.DOCVIEW.SwitchVisibilityMode','js!SBIS3.EDO2.Viewer','js!SBIS3.EDO.ReconciliationReportSumConfirmation','Elektronnyj_dokumentooborot_localization'],function(o,t){'use strict';var e=o.extend({$protected:{_options:{objectName:'',commentField:'ДокументРасширение.Название',collapseComment:true,showCommentField:true,showChoiceBlock:false,showAttachBlock:true,attachEnabledField:'documentInAction',docviewName:'DocView',sourceAttaches:'record/РП.Документ/СписокВложений'}},_dotTplFn:t,$constructor:function(){},init:function(){e.superclass.init.call(this);var o=this,t=this.hasChildControlByName(o._options.docviewName)?o.getChildControlByName(o._options.docviewName):null;if(t)o.subscribeTo(t,'onFinishCommand',function(){if(/delete/i.test(arguments[1]))o.sendCommand('edoRead');});}});return e;});
define('js!SBIS3.EDO.ReconciliationReportDialogHandlers',['WS.Data/Source/SbisService','Core/helpers/fast-control-helpers','Core/helpers/collection-helpers','Core/Deferred','Elektronnyj_dokumentooborot_localization'],function(e,t,a,c){'use strict';var r=function(e,t,a,c){if(!c.args||c.args.length>0)if(!e.isFace1Filled(t))e.markContractorField(),a.errback();else a.callback();else a.callback();},l=function(e){delete e.getLinkedContext().getValue('record')._propertiesCache.tab1SourceAttaches,delete e.getLinkedContext().getValue('record')._propertiesCache.tab2SourceAttaches,delete e.getLinkedContext().getValue('record')._propertiesCache.newDocumentAttaches,delete e.getLinkedContext().getValue('record')._propertiesCache.successDocumentAttaches;},i=function(e,t,c){if(l(e),c.args&&1===c.args.length){var r=false;if(c.args[0].result&&c.args[0].result.loadedFiles){var i=c.args[0].result.loadedFiles;r=Boolean(a.find(i[0].fileList,function(e){return Boolean('xml'===e.split('.').pop());}));}if(c.args[0].isIntegration)r=true;if(r){var n=e.getLinkedContext().getValue('record'),o={},s=n.getChanged();if(n.acceptFieldModification)for(var d=0;d<s.length;d++)if(e.contextFieldIsSpecific(s[d]))o[s[d]]=n.get(s[d]),n.acceptFieldModification(s[d]);}t.callback();}else t.callback();},n=function(a,c,r,l){if(l&&l.args&&l.args.length>0){var i=l.args[0];if('Утверждено'===i)if(false&&a.isOurAnswerFilled(c))t.question(rk('Утвердить вариант контрагента и удалить свой вариант')+'?',{},a).addCallback(function(t){if(t){var a=c.getValue('record');if(a&&a.getId()>0)new e({endpoint:'АктСверВх'}).call('УдалитьСвойВариант',{'идДокумента':a.getId()}).addCallback(function(){r.callback();}).addErrback(function(e){r.errback(e);});}else r.errback();});else r.callback();else if('Отправить свой вариант'===i)if(!a.isOurAnswerFilled(c))a.switchToOurAnswerControls(),r.errback(new Error(rk('Заполните свой вариант взаиморасчетов')));else if(a.isPossibleAccidentalDenial(c))t.question(rk('Ваш вариант по суммам совпадает с вариантом контрагента. Вы уверены в том, что хотите отклонить вариант контрагента')+'?',{},a).addCallback(function(e){if(e)r.callback();else r.errback();});else r.callback();else r.callback();}else r.callback();};return{onStartCommand:function(e,t){var a=this,o=a.getLinkedContext(),s=new c(),d=e.getResult();if(d&&d instanceof c&&!d.isReady()){var u=new c();d.addCallback(function(){u.dependOn(s);}).addErrback(function(){s.errback();}),e.setResult(u);}else e.setResult(s);if(t&&t.commandName)switch(t.commandName){case'edoSaveDocument':r(a,o,s,t);break;case'edoAttachFileUpdateDocument':i(a,s,t);break;case'edoDoPassage':n(a,o,s,t);break;case'edoLoadAttachFiles':l(a);default:s.callback();}else s.callback();},onAfterAttach:function(){delete this.getLinkedContext().getValue('record')._propertiesCache.tab1SourceAttaches,delete this.getLinkedContext().getValue('record')._propertiesCache.tab2SourceAttaches;}};});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.Reconciliation", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".controls-TabControl.Report__Tabs_container .controls-TabButtons,.controls-TabControl.Report__Tabs_container .edo-Dialog .edo-Dialog_tab .controls-TabButtons{background-color:#fff!important}.controls-TabControl.Report__Tabs_container .controls-TabButtons .controls-TabButton__additionalText1{color:#05b;font-weight:700;margin-left:4px}.edo-align-right{text-align:right}.Report__tabContent{padding:0}.Report__tabContent.emptyReportTabContent{padding:0}.Report__right{float:right;margin-left:10px}.Report__left{position:relative;overflow:hidden}.Report__body{clear:both}.Report__body .success-controls .Report__Comment_Container{min-height:12px}.Report__result{position:absolute;top:6px;right:0;color:#313e78;font-weight:700}.Report__Sticker_container{z-index:500}.Report__Tabs_container{clear:both;margin:26px 0 0 0}.Report__container{width:auto;margin:0 9px 6px 12px}.Report__Addressee_container{margin-right:0;padding-top:19px}@-moz-document url-prefix(){.Report__Addressee_container{margin-right:0;padding-top:19px}}.Report__Addressee_container .controls-TextBox .controls-TextBox__fieldWrapper .controls-TextBox__field{font-size:14px}.Report__ContractorFieldLink__link,.Report__ContractorFieldLink__link:visited{color:#999;margin-bottom:-2px}@-moz-document url-prefix(){.Report__ContractorFieldLink__link,.Report__ContractorFieldLink__link:visited{margin-bottom:-1px}}.Report__ContractorFieldLink__link.controls-Link:not(.ws-disabled):hover{color:#ff7033}.Report__ContractorFieldLink__field{width:100%}.Report__Comment_Container{padding:0 9px 0 12px}.Report__Comment_Container .controls-TextArea{width:100%;margin-bottom:6px;min-height:44px;display:none}.Report__Comment_Container .controls-TextArea.Report__Comment{display:block}.Report__Comment_Container .input-field{margin:2px 5px 0 5px}.Report__tabContent .Report__Comment{margin-top:10px}.Report__Attach_container{float:left;width:100%;margin-left:12px}.Report__Attach_item{float:left;margin-right:20px}.Report__Attach_item .docview-SwitchVisibilityMode_main{margin-top:3px}.Report__FullViewer{clear:both}.ReconciliationReport__ourCompany{padding:8px 0;height:24px;line-height:24px}.ReconciliationReport__ourCompany .controls-SelectorButton__cross{display:none}#contentArea{height:100%}.ws-float-area__block-layout:not(.ws-float-area-maximized-mode) .ReconciliationReport__dialog .controls-NumberTextBox.txtcredit{width:59px}.ReconciliationReport__dialog .Report__Addressee_container .addresseeChoiceItem{font-family:'TensorFont Полужирный',TensorFont,sans-serif;font-weight:700;color:#313e78;font-size:15px}"));head.appendChild(style);});}
define('js!SBIS3.EDO.Reconciliation',['js!SBIS3.EDO2.FormController','css!SBIS3.EDO.Reconciliation','Elektronnyj_dokumentooborot_localization'],function(n){'use strict';var t=n.extend({$protected:{_options:{}},$constructor:function(){},init:function(){t.superclass.init.call(this);}});return t;});
define("html!SBIS3.EDO.ReconciliationReportIn",function(){var o=function(o){var n=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;o.test(n);)n=n.replace(o,"&#123;&#123;$1&#125;&#125;");return n}}(),e=function(o){return o.join?o.join(""):o.toString()},t=function(o){return void 0===o?"":o&&"object"==typeof o?e(o):""+o},i="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="ReconciliationReport__dialog"> <component data-component="SBIS3.EDO2.Dialog" name=\'ReconciliationReportDialog\'> <option name="objectName">'+n(t(o.objectName))+'</option> <option name="stickyHeader">true</option> <options name="fullTrace"> <option name="showToolbar">false</option> </options> <opt name="firstLineContent"> <div class="edo-align-right ReconciliationReport__ourCompany"> <component data-component="SBIS3.Contragents.ChoiceOurCompanyLink" name="OurCompanyLink"> <options name="componentOptions"> <option name="ShowInnerCompany" value="true"></option> <option name="ShowAllCompany" value="false"></option> <option name="ourCompany" value="false"></option> <option name="withAffiliates" value="true"></option> <option name="openCardCompany" bind="record/isOpenCardCompany" type="boolean"></option> <opts name="ScopesAreas" type="array"> <opt value="'+n(t(o.scopeArea))+'"/> </opts> </options> <option name="idProperty" value="@Лицо"></option> <options name="selectedItem"> <option name="@Лицо" bind="record/ДокументНашаОрганизация"></option> <option name="Название" bind="record/ДокументНашаОрганизация.Контрагент.Название"></option> </options> <option name="multiselect" value="false"></option> <option name="className">controls-SelectorButton__asLink</option> <option name="enabled">true</option> <option name="allowChangeEnable">false</option> </component> </div> </opt> <options name="tabs" type="array"> <options> <option name="className">controls-TabButton__main-item</option> <option name="id">firstTab</option> <option name="title"> <component data-component=\'SBIS3.EDO.ReconciliationReportTabHeader\'> <option name=\'docType\'>'+n(t(o.objectName))+'</option> <option name="enabled" bind="record/passagesNotStarted" oneWay="true" nonexistent="false">false</option> <option name="allowChangeEnable" bind="record/passagesNotStarted" oneWay="true" nonexistent="true">true</option> </component> </option> <option name="content"> <div class="Report__head"> <div class="Report__right"> <div class="Report__Sticker_container"> <component data-component="SBIS3.EDO2.Sticker" name="ReportSticker"> <option name="mayDeleteResponsible">false</option> <option name="showContractorInfo">true</option> <option name="mini">false</option> <option name="tabindex" value="0"></option> </component> </div> </div> <div class="Report__left"> <div class="Report__result"> <component data-component="SBIS3.EDO.ReconciliationReportResult"> <option name="name">РезультатВзаиморасчетов</option> <option name="positiveMessage">'+n(t(rk("Нам должны")))+'</option> <option name="negativeMessage">'+n(t(rk("Мы должны")))+'</option> <option name="zeroMessage"></option> <option name="sum" bind="record/passagesResult"></option> <option name="visible" bind="record/passagesSuccessful" oneWay="true" nonexistent="false">false</option> </component> </div> <div class="Report__container Report__Addressee_container"> <component data-component="SBIS3.CONTROLS/Link" name="ContractorLink" class="Report__ContractorFieldLink__link ws-autofocus"> <option name="caption">'+n(t(rk("Контрагент")))+'</option> <option name="tabindex">0</option> <option name="enabled" bind="record/passagesNotStarted" oneWay="true" nonexistent="true">true</option> <option name="allowChangeEnable" bind="record/passagesNotStarted" oneWay="true" nonexistent="true">true</option> </component> <component data-component="SBIS3.AddresseeChoice.FieldLink" name="ContractorFieldLink" class="Report__ContractorFieldLink__field"> <options name="selectedItem" nonExistentValue="{}"> <option name="@Лицо" bind="record/Лицо1"></option> <option name="Название" bind="record/Лицо1.Название"></option> <option name="ИНН" bind="record/Контрагент.ИНН"></option> <option name="КПП" bind="record/Контрагент.КПП"></option> </options> <option name="placeholder">'+n(t(rk("Название контрагента или ИНН")))+'</option> <option name="allowContragentChoice">true</option> <option name="representativeChoice">false</option> <option name="allowRepresentativesChoice" type="boolean">false</option> <option name="multiselect">false</option> <option name="hidePeopleTab">true</option> <option name="favoritesOnly">false</option> <option name="tabindex">1</option> <option name="className">controls-FieldLink__itemsBold controls-FieldLink__itemsEdited</option> <option name="autoShow">false</option> <option name="enabled" bind="record/passagesNotStarted" oneWay="true" nonexistent="false">false</option> <option name="allowChangeEnable" bind="record/passagesNotStarted" oneWay="true" nonexistent="true">true</option> </component> </div> </div> </div> <div class="Report__body"> <component data-component="SBIS3.EDO.ReconciliationReportControlsBlock"> <option name="name">NewDocumentBlock</option> <option name="commentField">ДокументРасширение.Название</option> <option name="commentClassField">showInitiatorComment</option> <option name="showCommentField">true</option> <option name="attachEnabledField">alwaysTrue</option> <option name="showChoiceBlock">false</option> <option name="showAttachBlock">true</option> <option name="docviewName">DocViewIn</option> <option name="objectName">'+n(t(o.objectName))+'</option> <option name="sourceAttaches" value="record/newDocumentAttaches"></option> <option name="enabled" bind="record/passagesNotStarted" oneWay="true" nonexistent="true">true</option> <option name="allowChangeEnable" bind="record/passagesNotStarted" oneWay="true" nonexistent="true">true</option> <option name="visible" bind="record/newDocument" oneWay="true" nonexistent="false">false</option> </component> <component data-component="SBIS3.EDO.ReconciliationReportControlsBlock"> <option name="name">SuccessBlock</option> <option name="className">success-controls</option> <option name="commentField">ДокументРасширение.Название</option> <option name="commentClassField">showInitiatorComment</option> <option name="showCommentField">true</option> <option name="attachEnabledField">alwaysFalse</option> <option name="showChoiceBlock">false</option> <option name="showAttachBlock">false</option> <option name="docviewName">DocViewIn</option> <option name="objectName">'+n(t(o.objectName))+'</option> <option name="sourceAttaches" value="record/successDocumentAttaches"></option> <option name="enabled" bind="record/passagesNotStarted" oneWay="true" nonexistent="false">false</option> <option name="allowChangeEnable" bind="record/passagesNotStarted" oneWay="true" nonexistent="true">true</option> <option name="visible" bind="record/passagesSuccessful" oneWay="true" nonexistent="false">false</option> </component> <component data-component="SBIS3.CONTROLS/Tab/Control"> <option name="name">ReportTabs</option> <option name="tabsDisplayField">title</option> <option name="idProperty">id</option> <option name="selectedKey">ReportFirstTab</option> <option name="className">Report__Tabs_container</option> <option name="tabButtonsExtraClass">controls-TabButtons__simple-view controls-TabButtons__simple-view-select</option> <option name="observeVisibleProperty">true</option> <option name="visible" bind="record/documentInAction" oneWay="true" nonexistent="false">false</option> <options name="items" type="array"> <options> <option name="id">ReportFirstTab</option> <option name="align">left</option> <option name="title" type="content">'+n(t(rk("Вариант контрагента")))+' <span class=\'controls-TabButton__additionalText1\'> <component data-component="SBIS3.EDO.ReconciliationReportSumResultLabel"> <option name="zeroMessage">'+n(t(rk("Задолженность отсутствует")))+'</option> <option name="positiveMessage">'+n(t(rk("Нам должны")))+'</option> <option name="negativeMessage">'+n(t(rk("Мы должны")))+'</option> <option name="text" bind="record/theirSumResult" oneWay="true"></option> <option name="showPenny">true</option> </component> </span> </option> <option name="content"> <div class="Report__tabContent"> <component data-component="SBIS3.EDO.ReconciliationReportControlsBlock"> <option name="commentField">ДокументРасширение.Название</option> <option name="commentClassField">showInitiatorComment</option> <option name="attachEnabledField">isPaperAct</option> <option name="showChoiceBlock">false</option> <option name="showAttachBlock">false</option> <option name="docviewName">DocViewIn</option> <option name="objectName">'+n(t(o.objectName))+'</option> <option name="showCommentField">true</option> <option name="sourceAttaches" value="record/tab1SourceAttaches"></option> <option name="enabled" bind="record/passagesNotStarted" oneWay="true" nonexistent="true">true</option> <option name="allowChangeEnable" bind="record/passagesNotStarted" oneWay="true" nonexistent="true">true</option> </component> </div> </option> </options> <options> <option name="id">ReportSecondTab</option> <option name="align">left</option> <option name="visible" bind="record/tab2StateVisible" oneWay="false" nonexistent="false">false</option> <option name="title" type="content">'+n(t(rk("Наш вариант")))+' <span class=\'controls-TabButton__additionalText1\'> <component data-component="SBIS3.EDO.ReconciliationReportSumResultLabel" data-bind="visible: record/haveDebt"> <option name="zeroMessage">'+n(t(rk("Задолженность отсутствует")))+'</option> <option name="positiveMessage">'+n(t(rk("Мы должны")))+'</option> <option name="negativeMessage">'+n(t(rk("Нам должны")))+'</option> <option name="text" bind="record/ourSumResult" oneWay="true"></option> <option name="showPenny">true</option> </component> </span> </option> <option name="content"> <div class="Report__tabContent"> <component data-component="SBIS3.EDO.ReconciliationReportControlsBlock"> <option name="commentField" value="currentComment"></option> <option name="commentClassField">showResponseComment</option> <option name="attachEnabledField">canGiveAnswer</option> <option name="showChoiceBlock" bind="record/canGiveAnswer" oneWay="true"></option> <option name="showAttachBlock">true</option> <option name="docviewName">DocViewOut</option> <option name="objectName">'+n(t(o.objectName))+'</option> <option name="allowChangeEnable" bind="record/passagesAreOver" oneWay="true"></option> <option name="showCommentField">true</option> <option name="sourceAttaches" value="record/tab2SourceAttaches"></option> </component> </div> </option> </options> <options> <option name="id">ReportThirdTab</option> <option name="align">left</option> <option name="visible" bind="record/tab3StateVisible" oneWay="false" nonexistent="false">false</option> <option name="title" type="content"> <component data-component="SBIS3.EDO.ReconciliationReportLabel"> <option name="text" bind="record/tab3TitleValue" oneWay="true" nonexistent=""></option> </component> <span class=\'controls-TabButton__additionalText1\'> <component data-component="SBIS3.EDO.ReconciliationReportSumResultLabel"> <option name="zeroMessage"></option> <option name="positiveMessage"></option> <option name="negativeMessage"></option> <option name="text" bind="record/differenceSumResult" oneWay="true"></option> <option name="showPenny">true</option> </component> </span> </option> <option name="content"> <div class="Report__tabContent emptyReportTabContent"> <component data-component="SBIS3.EDO.ReconciliationReportControlsBlock"> <option name="commentField">false</option> <option name="attachEnabledField">alwaysFalse</option> <option name="showChoiceBlock">false</option> <option name="showAttachBlock">false</option> <option name="docviewName">DocViewDifference</option> <option name="objectName">'+n(t(o.objectName))+'</option> <option name="showCommentField">false</option> <option name="sourceAttaches" value="record/tab3SourceAttaches"></option> </component> </div> </option> </options> </options> </component> </div> </option> </options> </options> </component> </div> ');return(a=n(a))+(i&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.ReconciliationReportIn"}},o});
define("html!SBIS3.EDO.ReconciliationReportTabHeader",function(){var o=function(o){var n=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;o.test(n);)n=n.replace(o,"&#123;&#123;$1&#125;&#125;");return n}}(),e=function(o){return o.join?o.join(""):o.toString()},t=function(o){return void 0===o?"":o&&"object"==typeof o?e(o):""+o},a="undefined"!=typeof process,i=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<span class="ReconciliationReportTab__tabHeader"> <component data-component="SBIS3.EDO2.MainTabHeaderTemplate" name="ReconciliationReportTab"> <option name="mainInfo"> <component data-component=\'SBIS3.EDO2.RuleChangeSelector\'> <option name=\'name\'>ChangeRule</option> </component> </option> <option name="additionalInfo1"> <component data-component="SBIS3.CONTROLS/EditAtPlace" name="additionalInfoDate"> <option name="text" bind="'+n(t(o.documentDateFieldName))+'"></option> <option name="editorTpl"> <component data-component="SBIS3.CONTROLS/Date/Picker"> <option name="date" bind="'+n(t(o.documentDateFieldName))+'"></option> <option name="notificationMode">complete</option> <option name="validateIfHidden" value="true" type="boolean"></option> <options name="validators" type="array"> <options> <option name="errorMessage" value="'+n(t(rk("Укажите дату")))+'"></option> <option name="validator" type="function">SBIS3.CONTROLS/Utils/ControlsValidators:required</option> <option name="option" value="date"></option> </options> </options> </component> </option> </component> <component data-component="SBIS3.CONTROLS/Panel"> <option name="className">inline-panel</option> <option name="content"> <span class="ReconciliationReportTab__rangeNote">за период</span> <component data-component="SBIS3.CONTROLS/Date/RangeBig" name="DRDates"> <option name="startDate" bind="record/periodStart"></option> <option name="endDate" bind="record/periodEnd"></option> <option name="validateIfHidden" value="false" type="boolean"></option> <option name="className">ReconciliationReport__dateRange</option> <option name="serializationMode" value="date"></option> <option name="enabled" bind="record/periodModificationAllowed" oneWay="true" nonexistent="false">false</option> </component> </option> <option name="visible" bind="record/periodIsVisible" oneWay="true" nonexistent="false">false</option> </component> </option> </component> </span>');return(i=n(i))+(a&&-1!==i.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.ReconciliationReportTabHeader"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.ReconciliationReportTabHeader", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".ReconciliationReportTab__tabHeader .inline-panel{display:inline-block}.ReconciliationReportTab__rangeNote,.controls-TabButton.controls-TabButton__main-item .controls-TabButton__additionalText1>.ReconciliationReportTab__rangeNote{font-size:12px;color:#999;text-decoration:none}.ReconciliationReportTab__rangeNote:active,.ReconciliationReportTab__rangeNote:hover{color:#999;text-decoration:none}.ReconciliationReport__dateRange{top:1px;display:inline-block}@-moz-document url-prefix(){.ReconciliationReport__dateRange{top:0;display:inline-block}}.ReconciliationReport__dateRange .controls-DateBox.ws-control-inactive .controls-FormattedTextBox__fieldWrapper{background:0 0;border-color:transparent}.ReconciliationReport__dateRange .controls-DateRange__Button.ws-disabled{display:none}"));head.appendChild(style);});}
define('js!SBIS3.EDO.ReconciliationReportTabHeader',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.ReconciliationReportTabHeader','js!SBIS3.EDO2.MainTabHeaderTemplate','js!SBIS3.EDO2.RuleChangeSelector','SBIS3.CONTROLS/EditAtPlace/EditAtPlaceGroup','SBIS3.CONTROLS/EditAtPlace','SBIS3.CONTROLS/Menu/MenuLink','SBIS3.CONTROLS/Date/Picker','SBIS3.CONTROLS/Panel','SBIS3.CONTROLS/Date/RangeBig','SBIS3.CONTROLS/TextBox','SBIS3.CONTROLS/Utils/ControlsValidators','css!SBIS3.EDO.ReconciliationReportTabHeader','Elektronnyj_dokumentooborot_localization'],function(e,t){'use strict';var S=e.extend({$protected:{_options:{documentDateFieldName:'record/Дата'}},_dotTplFn:t,$constructor:function(){},init:function(){S.superclass.init.call(this);}});return S;});
define("html!SBIS3.EDO.ReconciliationReportResult",function(){var e=function(e){var n=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;e.test(n);)n=n.replace(e,"&#123;&#123;$1&#125;&#125;");return n}}(),r=function(e){return e.join?e.join(""):e.toString()},t=function(e){return void 0===e?"":e&&"object"==typeof e?r(e):""+e},o="undefined"!=typeof process,i=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,"<div> ");if(0!==e.sum){i+=" ";var s=e.sum>0?e.sum:-e.sum;i+=" "+n(t(e.sum>0?e.positiveMessage:e.negativeMessage))+" =",e.showPenny?i+=n(t(parseInt(s,10).toString().replace(/(\d{1,3}(?=(\d{3})+(?:\.\d|\b)))/g,"$1  ")))+'<span class="sum_penny">'+n(t(s.toFixed(2).slice(s.toFixed(2).indexOf("."))))+"</span>":i+=n(t(parseInt(s,10).toString().replace(/(\d{1,3}(?=(\d{3})+(?:\.\d|\b)))/g,"$1  "))),i+=" "}else i+=" "+n(t(e.zeroMessage))+" ";return i+=" </div> ",(i=n(i))+(o&&-1!==i.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.ReconciliationReportResult"}},e});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.ReconciliationReportResult", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(""));head.appendChild(style);});}
define('js!SBIS3.EDO.ReconciliationReportResult',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.ReconciliationReportResult','css!SBIS3.EDO.ReconciliationReportResult','Elektronnyj_dokumentooborot_localization'],function(e,t){'use strict';var n=e.extend({_dotTplFn:t,$protected:{_options:{positiveMessage:'',negativeMessage:'',zeroMessage:'',sum:0,showPenny:true}},$constructor:function(){},init:function(){n.superclass.init.call(this);}});return n;});
define("html!SBIS3.EDO.ReconciliationReportSumResultLabel",function(){var e=function(e){var t=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;e.test(t);)t=t.replace(e,"&#123;&#123;$1&#125;&#125;");return t}}(),i=function(e){return e.join?e.join(""):e.toString()},s=function(e){return void 0===e?"":e&&"object"==typeof e?i(e):""+e},n="undefined"!=typeof process,l=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,""),r=positiveInvisible=negativeInvisible=textInvisible="sum-result-invisible",a=global.requirejs("Core/defaultRenders");return!1!==e.docData&&null!==e.text&&(r=0===e.text?"":"sum-result-invisible",positiveInvisible=e.text>0?"":"sum-result-invisible",negativeInvisible=e.text<0?"":"sum-result-invisible",textInvisible=e.text>0||e.text<0?"":"sum-result-invisible",(e.text>0||e.text<0)&&(e.text=a.numeric(e.text,16,!0,e.showPenny?2:0,!0,0))),l+=' <span> <span class="'+t(s(r))+' sum-result-ZeroLabel__label">'+t(s(e.zeroMessage))+'</span> <span class="'+t(s(positiveInvisible))+' sum-result-PositiveLabel__label">'+t(s(e.positiveMessage))+'</span> <span class="'+t(s(negativeInvisible))+' sum-result-NegativeLabel__label">'+t(s(e.negativeMessage))+'</span> <span class="'+t(s(textInvisible))+' sum-result-TextField__field">='+t(s(e.text))+"</span> </span> ",(l=t(l))+(n&&-1!==l.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.ReconciliationReportSumResultLabel"}},e});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.ReconciliationReportSumResultLabel", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".sum-result-invisible{display:none}"));head.appendChild(style);});}
define('js!SBIS3.EDO.ReconciliationReportSumResultLabel',['Core/defaultRenders','SBIS3.CONTROLS/TextBox/TextBoxBase','html!SBIS3.EDO.ReconciliationReportSumResultLabel','SBIS3.CONTROLS/Mixins/DataBindMixin','css!SBIS3.EDO.ReconciliationReportSumResultLabel','Core/defaultRenders','Elektronnyj_dokumentooborot_localization'],function(e,t,i,s){'use strict';var l=t.extend([s],{_dotTplFn:i,$protected:{_textField:null,_zeroLabel:null,_positiveLabel:null,_negativeLabel:null,_options:{zeroMessage:'',positiveMessage:'',negativeMessage:'',text:0,showPenny:false,docData:false}},$constructor:function(){var e=this.getContainer().get(0);this._textField=$('.sum-result-TextField__field',e),this._zeroLabel=$('.sum-result-ZeroLabel__label',e),this._positiveLabel=$('.sum-result-PositiveLabel__label',e),this._negativeLabel=$('.sum-result-NegativeLabel__label',e);},init:function(){l.superclass.init.call(this);},setText:function(e){this._options.text=e,this._drawText(this._options.text);},getText:function(){return this._options.text;},getDocData:function(){return this._options.docData;},_drawText:function(e){if(null===e)return this._textField.hide(),this._zeroLabel.hide(),this._positiveLabel.hide(),void this._negativeLabel.hide();var t=e?parseFloat(e).toFixed(2):0;if(0===t)this._textField.hide(),this._zeroLabel.show(),this._positiveLabel.hide(),this._negativeLabel.hide();if(t>0)this._textField.show(),this._zeroLabel.hide(),this._positiveLabel.show(),this._negativeLabel.hide();if(t<0)this._textField.show(),this._zeroLabel.hide(),this._positiveLabel.hide(),this._negativeLabel.show();this._textField.html('='+this._formatText(t<0?-t:t));},_formatText:function(t){if('-'==t)return t;return t=e.numeric(t,16,true,this._options.showPenny?2:0,true,0),t||'';}});return l;});
define('js!SBIS3.EDO.ReconciliationReportsRegistryModel',['js!SBIS3.EDO2.EdoModel','WS.Data/Di','WS.Data/Collection/RecordSet','Elektronnyj_dokumentooborot_localization'],function(e,t,i){'use strict';var s=e.extend({_moduleName:'SBIS3.EDO.ReconciliationReportsRegistryModel',$protected:{_options:{properties:{toggleSwitchVisibilityMode:{get:function(){return this.get('РП.Документ').get('СписокВложений').getCount()>0;}},periodStart:{get:function(){return this.get('ДанныеДокумента.ДатаРегистрации');},set:function(e){this.set('ДанныеДокумента.ДатаРегистрации',e);}},periodEnd:{get:function(){return this.get('ДанныеДокумента.ДатаДокумента');},set:function(e){this.set('ДанныеДокумента.ДатаДокумента',e);}},periodIsSet:{get:function(){return!!this.get('periodStart')&&!!this.get('periodEnd');}},isIncoming:{get:function(){var e=false;if(this.getModelField('ДокументРасширение.Состояние'))e=Boolean(this.getModelField('ДокументРасширение.Состояние').get('Входящий'));var t=this.getModelField('РП.Документ');if(t){var i=t.get('Состояние');if(i)e=i.has('Подписание')?Boolean(i.get('Подписание').get('Входящий')):false;}return e;}},isPaperAct:{get:function(){return this.get('ИдРегламента')&&('e1ee0556-8ae2-11e2-b9da-c328bd709a1c'===this.get('ИдРегламента')||'84609e48-2fbf-44a5-90b8-bbf95092d235'===this.get('ИдРегламента'));}},alwaysTrue:{get:function(){return true;}},alwaysFalse:{get:function(){return false;}},sum1:{get:function(){return this.getModelField('ДанныеДокумента.Сумма1');},set:function(e){this._setModelValueUnchanged('ДанныеДокумента.Сумма1',e);}},sum2:{get:function(){return this.getModelField('ДанныеДокумента.Сумма2');},set:function(e){this._setModelValueUnchanged('ДанныеДокумента.Сумма2',e);}},sum3:{get:function(){return this.getModelField('ДанныеДокумента.Сумма3');},set:function(e){this._setModelValueUnchanged('ДанныеДокумента.Сумма3',e);}},sum4:{get:function(){return this.getModelField('ДанныеДокумента.Сумма4');},set:function(e){this._setModelValueUnchanged('ДанныеДокумента.Сумма4',e);}},ourDebit:{get:function(){return this.get('isIncoming')?this.get('ДанныеДокумента.Сумма3'):this.get('ДанныеДокумента.Сумма1');},set:function(e){if(this.get('isIncoming'))this._setModelValueCheckModification('ДанныеДокумента.Сумма3',null===e?null:parseFloat(e)),this._setModelValueCheckModification('ДанныеДокумента.Сумма4',null);else this.set('ДанныеДокумента.Сумма1',e);}},ourCredit:{get:function(){return this.get('isIncoming')?this.get('ДанныеДокумента.Сумма4'):this.get('ДанныеДокумента.Сумма2');},set:function(e){if(this.get('isIncoming'))this._setModelValueCheckModification('ДанныеДокумента.Сумма4',null===e?null:parseFloat(e)),this._setModelValueCheckModification('ДанныеДокумента.Сумма3',null);else this.set('ДанныеДокумента.Сумма2',e);}},theirDebit:{get:function(){return this.get('isIncoming')?this.get('ДанныеДокумента.Сумма1'):this.get('ДанныеДокумента.Сумма3');},set:function(e){if(this.get('isIncoming'))this.set('sum1',e);else this.set('sum3',e);}},theirCredit:{get:function(){return this.get('isIncoming')?this.get('ДанныеДокумента.Сумма2'):this.get('ДанныеДокумента.Сумма4');},set:function(e){if(this.get('isIncoming'))this.set('sum2',e);else this.set('sum4',e);}},ourSumResult:{get:function(){var e=this.get('ourDebit'),t=this.get('ourCredit');if(null===e&&null===t)return null;return t-e;}},theirSumResult:{get:function(){var e=this.get('theirDebit'),t=this.get('theirCredit');if(null===e&&null===t)return null;return t-e;}},differenceSumResult:{get:function(){var e=this.has('theirSumResult')&&this.get('theirSumResult'),t=this.has('ourSumResult')&&this.get('ourSumResult');if(null===e&&null===t)return null;return this._setDifferenceSum(e,t)||0;}},ourSumResultKey:{get:function(){var e=this.get('isIncoming'),t=parseFloat(this.getModelField('ДанныеДокумента.Сумма1')||0),i=parseFloat(this.getModelField('ДанныеДокумента.Сумма2')||0),s=parseFloat(this.getModelField('ДанныеДокумента.Сумма3')||0),n=parseFloat(this.getModelField('ДанныеДокумента.Сумма4')||0),r='undefined'===typeof this.getModelField('ДанныеДокумента.Сумма1')||null===this.getModelField('ДанныеДокумента.Сумма1'),o='undefined'===typeof this.getModelField('ДанныеДокумента.Сумма2')||null===this.getModelField('ДанныеДокумента.Сумма2'),u='undefined'===typeof this.getModelField('ДанныеДокумента.Сумма3')||null===this.getModelField('ДанныеДокумента.Сумма3'),g='undefined'===typeof this.getModelField('ДанныеДокумента.Сумма4')||null===this.getModelField('ДанныеДокумента.Сумма4');if(!e&&r&&o||e&&u&&g)return 0;if(0===this.get('ourSumResult'))return 2;return 1;}},haveDebt:{get:function(){return 0!==this.get('ourSumResultKey');}},answerExists:{get:function(){if(this.get('canGiveAnswer'))return true;return this.extDocsExists(false,false,false);}},formalAnswerExists:{get:function(){return this.extDocsExists('АктСвер',true,false)||this.extDocsExists('АктСверПолуч',true,false);}},periodModificationAllowed:{get:function(){if(0!==this.get('outerState'))return false;return!this.extDocsExists('АктСвер',false,false)&&!this.extDocsExists('АктСверПолуч',false,false);}},periodIsVisible:{get:function(){return this.get('periodIsSet')||this.get('periodModificationAllowed');}},sumConfirmationAllowed:{get:function(){return this.get('canGiveAnswer')&&!this.get('formalAnswerExists');}},currentComment:{get:function(){if(this.getModelField('ДокументРасширение.Комментарий'))this._setCurrentComment(this.getModelField('ДокументРасширение.Комментарий'));return this.getModelField('ДокументРасширение.Комментарий')||this.getModelField('РП.Документ/Состояние/Обработка/АктивныйЭтап/Комментарий');},set:function(e){this._setCurrentComment(e),this.set('ДокументРасширение.Комментарий',e);}},registrySumResult:{get:function(){var e=parseFloat(this.getModelField('ДанныеДокумента.Сумма1')),t=parseFloat(this.getModelField('ДанныеДокумента.Сумма2'));return this.get('isIncoming')?t-e:e-t;}},registryDebit:{get:function(){var e=this.get('registrySumResult');return e>0?e:0;}},registryCredit:{get:function(){var e=this.get('registrySumResult');return e<0?-e:0;}},outerState:{get:function(){var e=0;if(this.getModelField('ДокументРасширение.СостояниеКраткое'))e=this.getModelField('ДокументРасширение.СостояниеКраткое').get();var t=this.getModelField('РП.Документ');if(t){var i=t.get('Состояние');if(i)e=i.has('Подписание')?i.get('Подписание').get('СостояниеКраткое'):0;}return e;}},zeroOuterState:{get:function(){return 0===this.get('outerState');}},passagesStarted:{get:function(){var e=this.get('outerState');return this.get('isIncoming')?e>=4:e>4;}},newDocument:{get:function(){var e=this.get('isPaperAct'),t=this.get('isIncoming'),i=this.get('passagesNotStarted'),s=this.get('passagesSuccessful'),n=6===this.get('outerState');return e||i||n;}},documentInAction:{get:function(){return!this.get('newDocument')&&!this.get('passagesSuccessful');}},passagesNotStarted:{get:function(){return!this.get('passagesStarted');}},passagesAreOver:{get:function(){switch(this.get('outerState')){case 7:case 9:case 19:case 20:case 22:case 23:return true;default:return false;}}},passagesSuccessful:{get:function(){switch(this.get('outerState')){case 7:case 23:return true;default:return false;}}},passagesResult:{get:function(){var e=parseFloat(this.getModelField('ДанныеДокумента.Сумма1')||0);return parseFloat(this.getModelField('ДанныеДокумента.Сумма2')||0)-e;}},canGiveAnswer:{get:function(){return this.get('isIncoming')&&this.get('passagesStarted')&&!this.get('passagesAreOver');}},showInitiatorComment:{get:function(){var e=this.get('isIncoming'),t=this.get('isPaperAct');return this.getModelField('ДокументРасширение.Название')||!e&&this.getModelField('enabled')||t?'Report__Comment':'';}},showInitiatorCommentEditable:{get:function(){return this.get('isPaperAct')||!this.get('passagesStarted');}},showInitiatorCommentReadOnly:{get:function(){return!this.get('showInitiatorCommentEditable');}},showResponseComment:{get:function(){return this.getModelField('ДокументРасширение.Комментарий')||this.getModelField('enabled')?'Report__Comment':'';}},showResponseCommentEditable:{get:function(){return!this.get('passagesAreOver');}},showResponseCommentReadOnly:{get:function(){return!this.get('showResponseCommentEditable');}},tab2StateVisible:{get:function(){if(this.get('canGiveAnswer'))return true;else return this.extDocsExists(false,true,false);},set:function(e){}},tab3StateVisible:{get:function(){var e=false;if(this.has('РП.Документ')&&this.get('РП.Документ')&&this.get('РП.Документ').has('СписокВложений')){var t=this.get('РП.Документ').get('СписокВложений');if(this.get('isIncoming'))t.each(function(t){if((null===t.get('received')||false===t.get('received'))&&'АктСвер'===t.get('typeDoc')&&'5.01'===t.get('versionForm')&&true===t.get('serviceDoc'))return e=true,false;});else t.each(function(t){if(true===t.get('received')&&'АктСвер'===t.get('typeDoc')&&'5.01'===t.get('versionForm')&&true===t.get('serviceDoc'))return e=true,false;});}return e;},set:function(e){}},newDocumentAttaches:{get:function(){if(!this.get('newDocument'))return new i();return this.twoTabSourceAttaches(true);}},successDocumentAttaches:{get:function(){if(!this.get('passagesSuccessful'))return new i();return this.twoTabSourceAttaches(true);}},tab1SourceAttaches:{get:function(){if(this.get('newDocument')||this.get('passagesSuccessful'))return new i();return this.twoTabSourceAttaches(true);}},tab2SourceAttaches:{get:function(){return this.twoTabSourceAttaches(false);}},tab3SourceAttaches:{get:function(){var e=this.has('РП.Документ')&&this.get('РП.Документ')&&this.get('РП.Документ')&&this.get('РП.Документ').has('СписокВложений')?this.get('РП.Документ').get('СписокВложений'):null;if(!e)return new i();var t=e.clone();if(t.clear(),this.get('isIncoming'))e.each(function(e){if((null===e.get('received')||false===e.get('received'))&&true===e.get('serviceDoc')&&'АктСвер'===e.get('typeDoc')&&'5.01'===e.get('versionForm'))t.add(e);});else e.each(function(e){if(true===e.get('received')&&true===e.get('serviceDoc')&&'АктСвер'===e.get('typeDoc')&&'5.01'===e.get('versionForm'))t.add(e);});return t;}},tab3TitleValue:{get:function(){var e=this.get('differenceSumResult');if(void 0===e||null===e||0===e)return'Расхождений нет';else return'Расхождение';}},enabled:{get:function(){var e=this.get('isPaperAct'),t=this.getModelField('РП.Документ/Состояние/Обработка/СостояниеКраткое')||0,i=this.getModelField('РП.Документ/Состояние/Подписание/СостояниеКраткое')||0,s=!!this.getModelField('РП.Документ/Состояние/Проведение/Проведен'),n=!!this.getModelField('РП.Документ/РазрешенныеДействия/Редактирование'),r=!!((e||0===t&&0===i&&!s||this.get('isEditing'))&&!this.get('Удален'))&&n;if(this.get('canGiveAnswer'))r=!!((!s||this.get('isEditing'))&&!this.get('Удален'))&&n;return r;}},isOpenCardCompany:{get:function(){if(this.get('isEditing')||this.get('enabled'))return false;return true;}}}}},extDocsExists:function(e,t,i){var s=false;if(this.has('РП.Документ')&&this.get('РП.Документ')&&this.get('РП.Документ').has('СписокВложений')){var n=this.get('РП.Документ').get('СписокВложений');if(this.get('isIncoming'))n.each(function(n){if(n.has('typeDoc'))if(n.has('received')&&(!t||null===n.get('received')||false===n.get('received'))&&(!e||n.get('typeDoc')===e&&'5.01'!==n.get('versionForm'))&&(!i||!n.get('serviceDoc')))return s=true,false;});else n.each(function(i){if(i.has('typeDoc'))if(i.has('received')&&(!t||true===i.get('received'))&&(!e||i.get('typeDoc')===e&&'5.01'!==i.get('versionForm')))return s=true,false;});}return s;},twoTabSourceAttaches:function(e){var t=this.has('РП.Документ')&&this.get('РП.Документ')&&this.get('РП.Документ').has('СписокВложений')?this.get('РП.Документ').get('СписокВложений'):null;if(!t)return false;var i=t.clone(),s=e?this.get('isIncoming'):!this.get('isIncoming'),n=this.get('isPaperAct');if(i.clear(),s)t.each(function(e){if(!n){if(true===e.get('received')&&('АктСвер'!==e.get('typeDoc')||'5.01'!==e.get('versionForm'))&&true!==e.get('serviceDoc'))i.add(e);}else if((null===e.get('received')||false===e.get('received'))&&('АктСвер'!==e.get('typeDoc')||'5.01'!==e.get('versionForm'))&&true!==e.get('serviceDoc'))i.add(e);});else t.each(function(e){if((null===e.get('received')||false===e.get('received'))&&('АктСвер'!==e.get('typeDoc')||'5.01'!==e.get('versionForm'))&&true!==e.get('serviceDoc'))i.add(e);});return i;},_setModelValueUnchanged:function(e,t){if(this.set(e,t),this._changedFields.hasOwnProperty(e))delete this._changedFields[e];},_setDifferenceSum:function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e-=100*arguments[t];return e/100;},_setCurrentComment:function(e){var t=this.getModelField('РП.Документ/Состояние/Обработка/АктивныйЭтап');if(t)if(t.set('Комментарий',e),this._changedFields.hasOwnProperty('РП.Документ'))delete this._changedFields['РП.Документ'];},_setModelValueCheckModification:function(e,t){var i=this.getModelField(e);if(this.set(e,t),this._changedFields.hasOwnProperty(e)&&i===t)delete this._changedFields[e];},equalizeDebt:function(){if(this.get('isIncoming'))this.set('ДанныеДокумента.Сумма3',null),this.set('ДанныеДокумента.Сумма4',null);else this.set('ДанныеДокумента.Сумма2',null),this.set('ДанныеДокумента.Сумма1',null);},setDebtToZero:function(){if(this.get('isIncoming'))this.set('ДанныеДокумента.Сумма3',0),this.set('ДанныеДокумента.Сумма4',0);else this.set('ДанныеДокумента.Сумма2',0),this.set('ДанныеДокумента.Сумма1',0);},acceptFieldModification:function(e){this._unsetChanged(e);}});return t.register('ReconciliationReportsRegistryModel',s),s;});
define('js!SBIS3.EDO.ReconciliationReportIn',['Deprecated/MicroSession','html!SBIS3.EDO.ReconciliationReportIn','js!SBIS3.EDO.Reconciliation','js!SBIS3.EDO.ReconciliationReportDialogHandlers','js!SBIS3.EDO.ReconciliationReportTabHeader','js!SBIS3.EDO.ReconciliationReportResult','optional!js!SBIS3.Contragents.ChoiceOurCompanyLink','js!SBIS3.EDO2.Sticker','WS.Data/Source/SbisService','SBIS3.CONTROLS/Link','js!SBIS3.AddresseeChoice.FieldLink','preload!optional!SBIS3.AddresseeChoice.Dialog','SBIS3.CONTROLS/Tab/Control','js!SBIS3.EDO.ReconciliationReportSumResultLabel','js!SBIS3.EDO.ReconciliationReportLabel','js!SBIS3.EDO.ReconciliationReportControlsBlock','SBIS3.CONTROLS/Button','SBIS3.CONTROLS/Utils/ControlsValidators','css!SBIS3.EDO.Reconciliation','js!SBIS3.EDO2.Dialog','js!SBIS3.EDO.ReconciliationReportsRegistryModel','Elektronnyj_dokumentooborot_localization'],function(e,t,i,o){'use strict';var r=i.extend({_dotTplFn:t,$protected:{_options:{objectName:'АктСверкиДок',scopeArea:'Акты сверок',dataSource:{endpoint:{contract:'АктСверкиДок'},binding:{create:'Создать',read:'Документ.ПрочитатьДляУчастника',update:'Записать',destroy:'Документ.УдалитьДокументы',format:'АктСверкиДок.Список',query:'АктСверкиДок.Список'},model:'ReconciliationReportsRegistryModel'},readMetaData:{'ИмяОбъекта':'АктСверкиДок'},significantFields:['Лицо1','Лицо2','Лицо3','Дата','ДокументНашаОрганизация'],saveImmediatelyFields:['Лицо1','ДокументНашаОрганизация'],specificFields:['ДанныеДокумента.ДатаРегистрации','ДанныеДокумента.ДатаДокумента','ДанныеДокумента.Сумма3','ДанныеДокумента.Сумма4']}},$constructor:function(){},init:function(){r.superclass.init.call(this),this.initControls();},initControls:function(){var e=this;if(e.hasChildControlByName('ContractorLink')&&e.hasChildControlByName('ContractorFieldLink')){var t=e.getChildControlByName('ContractorLink'),i=e.getChildControlByName('ContractorFieldLink');e.subscribeTo(t,'onActivated',function(e){require(['js!SBIS3.AddresseeChoice.Dialog'],function(){i.showSelector('js!SBIS3.AddresseeChoice.Dialog',{selectionType:'all'});});});}e.subscribe('onReadModel',function(){e.getLinkedContext().getValue('record').acceptChanges();}.bind(e)),e.subscribe('onReadModel',function(t,i){if(e.hasChildControlByName('ReportTabs')){var o=e.getChildControlByName('ReportTabs');if(i.has('tab2StateVisible')&&i.get('tab2StateVisible'))o.getChildControlById('ReportSecondTab').show();if(i.has('tab3StateVisible')&&i.get('tab3StateVisible'))o.getChildControlById('ReportThirdTab').show();else o.getChildControlById('ReportThirdTab').hide();var r=o.hasChildControlByName('SwitchableArea')?o.getChildControlByName('SwitchableArea'):false;if(r)for(var n=o.getSelectedKey(),a=['ReportFirstTab','ReportSecondTab','ReportThirdTab'],s=0;s<a.length;s++)if(r.getItemById(a[s]))r.getItemById(a[s]).setVisible(n===a[s]);}}),e.subscribe('onAfterLoadAttachment',o.onAfterAttach.bind(e)),e.subscribe('onStartCommand',o.onStartCommand.bind(e));},isOurAnswerFilled:function(e){var t=e.getValue('record');if(t){if(t.has('ourSumResultKey')&&t.get('ourSumResultKey')>0)return true;return t.extDocsExists(false,true,true);}return false;},switchToOurAnswerControls:function(){var e=this;if(e.hasChildControlByName('ReportTabs'))e.getChildControlByName('ReportTabs').setSelectedKey('ReportSecondTab');},isFace1Filled:function(e){var t=e.getValue('record');if(t)if(t.has('Лицо1')&&t.get('Лицо1')>0)return true;return false;},markContractorField:function(){if(this.hasChildControlByName('ContractorFieldLink'))this.getChildControlByName('ContractorFieldLink').markControl(rk('Укажите контрагента'),true);},contextFieldIsSpecific:function(e){for(var t=0;t<this._options.specificFields.length;t++)if(0===String(e).indexOf(this._options.specificFields[t]))return true;return false;},isPossibleAccidentalDenial:function(e){var t=e.getValue('record'),i=function(e,t){return(parseFloat(e)||0).toFixed(t);};if(t)if(t.has('ourSumResult')&&t.has('theirSumResult')){var o=t.get('ourSumResult'),r=t.get('theirSumResult');if(null===o||null===r)return false;return i(t.get('ourSumResult'),2)===i(-1*t.get('theirSumResult'),2);}return false;},saveDenyAccidentFact:function(t){var i=t.getValue('record');if(i)if(i.has('@Документ'))e.set('accid_deny_'+i.get('@Документ'),true);}});return r;});
define("html!SBIS3.EDO.ReconciliationReportOut",function(){var o=function(o){var n=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;o.test(n);)n=n.replace(o,"&#123;&#123;$1&#125;&#125;");return n}}(),e=function(o){return o.join?o.join(""):o.toString()},t=function(o){return void 0===o?"":o&&"object"==typeof o?e(o):""+o},i="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="ReconciliationReport__dialog"> <component data-component="SBIS3.EDO2.Dialog" name=\'ReconciliationReportDialog\'> <option name="objectName">'+n(t(o.objectName))+'</option> <option name="stickyHeader">true</option> <options name="fullTrace"> <option name="showToolbar">false</option> </options> <opt name="firstLineContent"> <div class="edo-align-right ReconciliationReport__ourCompany"> <component data-component="SBIS3.Contragents.ChoiceOurCompanyLink" name="OurCompanyLink"> <options name="componentOptions"> <option name="ShowInnerCompany" value="true"></option> <option name="ShowAllCompany" value="false"></option> <option name="ourCompany" value="false"></option> <option name="withAffiliates" value="true"></option> <option name="openCardCompany" bind="record/isOpenCardCompany" type="boolean"></option> <opts name="ScopesAreas" type="array"> <opt value="'+n(t(o.scopeArea))+'"/> </opts> </options> <option name="idProperty" value="@Лицо"></option> <options name="selectedItem"> <option name="@Лицо" bind="record/ДокументНашаОрганизация"></option> <option name="Название" bind="record/ДокументНашаОрганизация.Контрагент.Название"></option> </options> <option name="multiselect" value="false"></option> <option name="className">controls-SelectorButton__asLink</option> <option name="enabled">true</option> <option name="allowChangeEnable">false</option> </component> </div> </opt> <options name="tabs" type="array"> <options> <option name="className">controls-TabButton__main-item</option> <option name="id">firstTab</option> <option name="title"> <component data-component=\'SBIS3.EDO.ReconciliationReportTabHeader\'> <option name=\'docType\'>'+n(t(o.objectName))+'</option> <option name="enabled" bind="record/passagesNotStarted" oneWay="true" nonexistent="true">false</option> <option name="allowChangeEnable" bind="record/passagesNotStarted" oneWay="true" nonexistent="true">true</option> </component> </option> <option name="content"> <div class="Report__head"> <div class="Report__right"> <div class="Report__Sticker_container"> <component data-component="SBIS3.EDO2.Sticker" name="ReportSticker"> <option name="mayDeleteResponsible">false</option> <option name="showContractorInfo">true</option> <option name="mini">false</option> <option name="tabindex" value="0"></option> </component> </div> </div> <div class="Report__left"> <div class="Report__result"> <component data-component="SBIS3.EDO.ReconciliationReportResult"> <option name="name">РезультатВзаиморасчетов</option> <option name="positiveMessage">'+n(t(rk("Мы должны")))+'</option> <option name="negativeMessage">'+n(t(rk("Нам должны")))+'</option> <option name="zeroMessage"></option> <option name="sum" bind="record/passagesResult"></option> <option name="visible" bind="record/passagesSuccessful" oneWay="true" nonexistent="false">false</option> </component> </div> <div class="Report__container Report__Addressee_container"> <component data-component="SBIS3.CONTROLS/Link" name="ContractorLink" class="Report__ContractorFieldLink__link"> <option name="caption">'+n(t(rk("Контрагент")))+'</option> <option name="tabindex">0</option> </component> <component data-component="SBIS3.AddresseeChoice.FieldLink" name="ContractorFieldLink" class="Report__ContractorFieldLink__field ws-autofocus"> <options name="selectedItem" nonExistentValue="{}"> <option name="@Лицо" bind="record/Лицо1"></option> <option name="Название" bind="record/Лицо1.Название"></option> <option name="ИНН" bind="record/Контрагент.ИНН"></option> <option name="КПП" bind="record/Контрагент.КПП"></option> </options> <option name="placeholder">'+n(t(rk("Название контрагента или ИНН")))+'</option> <option name="representativeChoice">true</option> <option name="representative" bind="record/РП.Документ/Состояние/Подписание/Ответственный/ДанныеФото/personId"></option> <option name="allowContragentChoice">true</option> <option name="allowRepresentativesChoice" type="boolean">false</option> <option name="multiselect">false</option> <option name="hidePeopleTab">true</option> <option name="favoritesOnly">false</option> <option name="tabindex">1</option> <option name="className">controls-FieldLink__itemsBold controls-FieldLink__itemsEdited</option> <option name="autoShow">false</option> </component> </div> </div> </div> <div class="Report__body"> <component data-component="SBIS3.EDO.ReconciliationReportControlsBlock"> <option name="name">NewDocumentBlock</option> <option name="commentField">ДокументРасширение.Название</option> <option name="commentClassField">showInitiatorComment</option> <option name="attachEnabledField">zeroOuterState</option> <option name="showChoiceBlock">false</option> <option name="showAttachBlock">true</option> <option name="docviewName">DocViewOut</option> <option name="objectName">'+n(t(o.objectName))+'</option> <option name="showCommentField">true</option> <option name="sourceAttaches" value="record/newDocumentAttaches"></option> <option name="visible" bind="record/newDocument" oneWay="true" nonexistent="false">false</option> </component> <component data-component="SBIS3.EDO.ReconciliationReportControlsBlock"> <option name="name">SuccessBlock</option> <option name="className">success-controls</option> <option name="commentField">ДокументРасширение.Название</option> <option name="commentClassField">showInitiatorComment</option> <option name="attachEnabledField">alwaysFalse</option> <option name="showChoiceBlock">false</option> <option name="showAttachBlock">false</option> <option name="docviewName">DocViewOut</option> <option name="objectName">'+n(t(o.objectName))+'</option> <option name="sourceAttaches" value="record/successDocumentAttaches"></option> <option name="showCommentField">true</option> <option name="visible" bind="record/passagesSuccessful" oneWay="true" nonexistent="false">false</option> </component> <component data-component="SBIS3.CONTROLS/Tab/Control"> <option name="name">ReportTabs</option> <option name="tabsDisplayField">title</option> <option name="idProperty">id</option> <option name="selectedKey">ReportFirstTab</option> <option name="className">Report__Tabs_container</option> <option name="tabButtonsExtraClass">controls-TabButtons__simple-view controls-TabButtons__simple-view-select</option> <option name="observeVisibleProperty">true</option> <option name="visible" bind="record/documentInAction" oneWay="true" nonexistent="false">false</option> <options name="items" type="array"> <options> <option name="id">ReportFirstTab</option> <option name="align">left</option> <option name="title" type="content"> '+n(t(rk("Наш вариант")))+' <span class=\'controls-TabButton__additionalText1\'> <component data-component="SBIS3.EDO.ReconciliationReportSumResultLabel" data-bind="visible: record/haveDebt"> <option name="zeroMessage">'+n(t(rk("Задолженность отсутствует")))+'</option> <option name="positiveMessage">'+n(t(rk("Мы должны")))+'</option> <option name="negativeMessage">'+n(t(rk("Нам должны")))+'</option> <option name="text" bind="record/ourSumResult" oneWay="true"></option> <option name="showPenny">true</option> </component> </span> </option> <option name="content"> <div class="Report__tabContent"> <component data-component="SBIS3.EDO.ReconciliationReportControlsBlock"> <option name="commentField">ДокументРасширение.Название</option> <option name="commentClassField">showInitiatorComment</option> <option name="attachEnabledField">zeroOuterState</option> <option name="showChoiceBlock">false</option> <option name="showAttachBlock">false</option> <option name="docviewName">DocViewOut</option> <option name="objectName">'+n(t(o.objectName))+'</option> <option name="showCommentField">true</option> <option name="sourceAttaches" value="record/tab1SourceAttaches"></option> </component> </div> </option> </options> <options> <option name="id">ReportSecondTab</option> <option name="align">left</option> <option name="visible" bind="record/tab2StateVisible" oneWay="false" nonexistent="false">false</option> <option name="title" type="content"> '+n(t(rk("Вариант контрагента")))+' <span class=\'controls-TabButton__additionalText1\'> <component data-component="SBIS3.EDO.ReconciliationReportSumResultLabel" data-bind="visible: record/haveDebt"> <option name="zeroMessage">'+n(t(rk("Задолженность отсутствует")))+'</option> <option name="positiveMessage">'+n(t(rk("Нам должны")))+'</option> <option name="negativeMessage">'+n(t(rk("Мы должны")))+'</option> <option name="text" bind="record/theirSumResult" oneWay="true"></option> <option name="showPenny">true</option> </component> </span> </option> <option name="content"> <div class="Report__tabContent"> <component data-component="SBIS3.EDO.ReconciliationReportControlsBlock"> <option name="commentField" value="currentComment"></option> <option name="commentClassField">showResponseComment</option> <option name="attachEnabledField">alwaysFalse</option> <option name="showChoiceBlock">false</option> <option name="showAttachBlock">false</option> <option name="docviewName">DocViewIn</option> <option name="objectName">'+n(t(o.objectName))+'</option> <option name="showCommentField">true</option> <option name="sourceAttaches" value="record/tab2SourceAttaches"></option> </component> </div> </option> </options> <options> <option name="id">ReportThirdTab</option> <option name="align">left</option> <option name="visible" bind="record/tab3StateVisible" oneWay="false" nonexistent="false">false</option> <option name="title" type="content"> <component data-component="SBIS3.EDO.ReconciliationReportLabel"> <option name="text" bind="record/tab3TitleValue" oneWay="true" nonexistent=""></option> </component> <span class=\'controls-TabButton__additionalText1\'> <component data-component="SBIS3.EDO.ReconciliationReportSumResultLabel"> <option name="zeroMessage"></option> <option name="positiveMessage"></option> <option name="negativeMessage"></option> <option name="text" bind="record/differenceSumResult" oneWay="true"></option> <option name="showPenny">true</option> </component> </span> </option> <option name="content"> <div class="Report__tabContent emptyReportTabContent"> <component data-component="SBIS3.EDO.ReconciliationReportControlsBlock"> <option name="commentField">false</option> <option name="attachEnabledField">alwaysFalse</option> <option name="showChoiceBlock">false</option> <option name="showAttachBlock">false</option> <option name="docviewName">DocViewDifference</option> <option name="objectName">'+n(t(o.objectName))+'</option> <option name="showCommentField">false</option> <option name="sourceAttaches" value="record/tab3SourceAttaches"></option> </component> </div> </option> </options> </options> </component> </div> </option> </options> </options> <options name="significantFields" type="array"> <option value="Лицо1"/> <option value="Лицо2"/> <option value="Лицо3"/> <option value="Дата"/> <option value="Номер"/> <option value="ДокументНашаОрганизация"/> <option value="ДанныеДокумента.ДатаРегистрации"/> <option value="ДанныеДокумента.ДатаДокумента"/> </options> </component> </div> ');return(a=n(a))+(i&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.ReconciliationReportOut"}},o});
define('js!SBIS3.EDO.ReconciliationReportOut',['html!SBIS3.EDO.ReconciliationReportOut','js!SBIS3.EDO.Reconciliation','js!SBIS3.EDO.ReconciliationReportDialogHandlers','js!SBIS3.EDO.ReconciliationReportTabHeader','js!SBIS3.EDO.ReconciliationReportResult','optional!js!SBIS3.Contragents.ChoiceOurCompanyLink','js!SBIS3.EDO2.Sticker','WS.Data/Source/SbisService','SBIS3.CONTROLS/Link','js!SBIS3.AddresseeChoice.FieldLink','preload!optional!SBIS3.AddresseeChoice.Dialog','SBIS3.CONTROLS/Tab/Control','js!SBIS3.EDO.ReconciliationReportSumResultLabel','js!SBIS3.EDO.ReconciliationReportLabel','js!SBIS3.EDO.ReconciliationReportControlsBlock','SBIS3.CONTROLS/Utils/ControlsValidators','css!SBIS3.EDO.Reconciliation','js!SBIS3.EDO2.Dialog','js!SBIS3.EDO.ReconciliationReportsRegistryModel','Elektronnyj_dokumentooborot_localization'],function(e,t,i){'use strict';var o=t.extend({_dotTplFn:e,$protected:{_options:{objectName:'АктСверкиДок',scopeArea:'Акты сверок',dataSource:{endpoint:{contract:'АктСверкиДок'},binding:{create:'Создать',read:'Документ.ПрочитатьДляУчастника',update:'Записать',destroy:'Документ.УдалитьДокументы',format:'АктСверкиДок.Список',query:'АктСверкиДок.Список'},model:'ReconciliationReportsRegistryModel'},readMetaData:{'ИмяОбъекта':'АктСверкиДок'},significantFields:['Лицо1','Лицо2','Лицо3','Дата','Номер','ДокументНашаОрганизация'],saveImmediatelyFields:['Лицо1','ДокументНашаОрганизация'],specificFields:['ДанныеДокумента.ДатаРегистрации','ДанныеДокумента.ДатаДокумента']}},$constructor:function(){},init:function(){o.superclass.init.call(this),this.initControls();},initControls:function(){var e=this;if(e.hasChildControlByName('ContractorLink')&&e.hasChildControlByName('ContractorFieldLink')){var t=e.getChildControlByName('ContractorLink'),o=e.getChildControlByName('ContractorFieldLink');e.subscribeTo(t,'onActivated',function(e){require(['js!SBIS3.AddresseeChoice.Dialog'],function(){o.showSelector('js!SBIS3.AddresseeChoice.Dialog',{selectionType:'all'});});});}e.subscribe('onReadModel',function(){e.getLinkedContext().getValue('record').acceptChanges();}.bind(e)),e.subscribe('onReadModel',function(t,i){if(e.hasChildControlByName('ReportTabs')){var o=e.getChildControlByName('ReportTabs');if(i.has('tab2StateVisible')&&i.get('tab2StateVisible'))o.getChildControlById('ReportSecondTab').show();if(i.has('tab3StateVisible')&&i.get('tab3StateVisible'))o.getChildControlById('ReportThirdTab').show();else o.getChildControlById('ReportThirdTab').hide();var n=o.hasChildControlByName('SwitchableArea')?o.getChildControlByName('SwitchableArea'):false;if(n)for(var r=o.getSelectedKey(),a=['ReportFirstTab','ReportSecondTab','ReportThirdTab'],s=0;s<a.length;s++)if(n.getItemById(a[s]))n.getItemById(a[s]).setVisible(r===a[s]);}}),e.subscribe('onAfterLoadAttachment',i.onAfterAttach.bind(e)),e.subscribe('onStartCommand',i.onStartCommand.bind(e));},isFace1Filled:function(e){var t=e.getValue('record');if(t)if(t.has('Лицо1')&&t.get('Лицо1')>0)return true;return false;},markContractorField:function(){if(this.hasChildControlByName('ContractorFieldLink'))this.getChildControlByName('ContractorFieldLink').markControl(rk('Укажите контрагента'),true);},contextFieldIsSpecific:function(e){for(var t=0;t<this._options.specificFields.length;t++)if(0===String(e).indexOf(this._options.specificFields[t]))return true;return false;}});return o;});
define("html!SBIS3.EDO.RegisterDocButton",function(){var n=function(n){var e=function(){var n=/\{\{([\s\S]+?)\}\}/g;return function(e){for(;n.test(e);)e=e.replace(n,"&#123;&#123;$1&#125;&#125;");return e}}(),t=function(n){return n.join?n.join(""):n.toString()},o=function(n){return void 0===n?"":n&&"object"==typeof n?t(n):""+n},r="undefined"!=typeof process,i=("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),u=function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,a='<div class="edo-RegisterMenuButton '+e(o(n.componentClassName))+'"> <component data-component="SBIS3.CONTROLS/Menu/MenuButton" name="RegisterMenuButton"> <option name="caption" value="'+e(o(rk("Зарегистрировать")))+'"></option> <option name="parentProperty">parent</option> <option name="icon">'+e(o(n.image))+'</option> <option name="items" value="'+e(o(function(n,e){var t=i.randomId();return n[t]=e,t}(u,n.items)))+'" type="ref"></option> </component> </div>';return(a=e(a))+(r&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return n.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.RegisterDocButton"}},n});
define('js!SBIS3.EDO.UnallocDocHandlers',['WS.Data/Source/SbisService','WS.Data/Entity/Record','Core/helpers/fast-control-helpers','Core/Indicator','Core/Deferred','js!SBIS3.EDO.EdoCounters','js!SBIS3.EDO2.OpenDialogAction','Elektronnyj_dokumentooborot_localization'],function(e,t,n,a,o,d,i){'use strict';var c;return c={updateCounter:function(){require(['js!SBIS3.Navigation.LeftNavigation'],function(e){var t=e.getInstance();if(t)d.nerasp_count().addCallback(function(e){t.setCounter({event:'registry-Undistr'},{counter:e.getRawData()?e.getRawData():'',title:String(e.getRawData()||'')});});});},createDocFromUnallocDoc:function(n,o,d,i,c,r){var l=new t(),s=n.getTopParent(),u=n.getLinkedContext().getValue('record').getId(),g={_type:'record',d:[],s:[]};if(s.hasChildControlByName('extNameField'))g.s.push({n:'ДокументРасширение.Название',t:'Строка'}),g.d.push(s.getChildControlByName('extNameField').getValue());if(g.s.push({n:'НазваниеТипДокумента',t:'Строка'},{n:'ИдРегламента',t:'Строка'}),g.d.push(o,i?i.guid:null),r)g.s.push({n:'ВызовИзБраузера',t:'Логическое'}),g.d.push(true);l=new t({rawData:g,adapter:'adapter.sbis'}),new e({endpoint:'Документ'}).call('ЕстьРасширение',{'Объект':o}).addCallback(function(t){var n=t.getRawData();new e({endpoint:n}).call('Создать',{'ИмяМетода':n+'.Список','Фильтр':l}).addCallback(function(t){new e({endpoint:'Документ'}).call('СкопироватьВнешниеДокументы',{'ДокументОснование':parseInt(u,10),'ДокументСледствие':parseInt(t.getRow().get('@Документ'),10),'ВидСвязи':1,'СписокВД':d}).addCallback(function(){c(t);}).addErrback(function(){a.hide();});}).addErrback(function(){a.hide();});}).addErrback(function(){a.hide();});},onUnallocDocToSend:function(){var e=this,t=e.getName();if('btnSendCont'==t||'btnSendBuh'==t||'saveButton'==t){var o=this.getTopParent(),d=this.getLinkedContext().getValue('record'),r=o.getChildControlByName('attachments');if(r.getDataSet().getCount()>0){if('btnSendCont'==t){a.show();var l=r.getSelectedKeys();if(!l.length)r.getDataSet().each(function(e){l.push(e.getId());});c.createDocFromUnallocDoc(e,'КоррИсх',l,null,function(e){new i().execute({id:parseInt(e.getRow().get('@Документ'),10),minWidth:o.getContainer().width()}),d.acceptChanges(),o.getLinkedContext().setValue('forceClose',true),o.close(),a.hide();},false);}else if('btnSendBuh'==t){var s=o.getChildControlByName('UnallocDocDialog');if(s){var d=s.getLinkedContext().getValue('record');s.sendCommand('edoSaveDocument',true).addCallback(function(){require(['js!SBIS3.Navigation.LeftNavigation'],function(e){e.getInstance().reloadStructure();}),a.hide();}).addErrback(function(e){a.hide();});}}}else n.alert(rk('Не загружен ни один документ'));}},onReadyDialog:function(){var e=this.getTopParent().getContainer();if(window.location.pathname.indexOf('registry.html')<0)e.find('.edo-uncallocated-attach-button').addClass('edo-attach-button-main-page'),e.find('.edo-unallocated-file-scaner').addClass('edo-file-scaner-main-page');else e.find('.edo-uncallocated-attach-button').addClass('edo-attach-button-un-page'),e.find('.edo-unallocated-file-scaner').addClass('edo-file-scaner-un-page');},onSave:function(e){var t=this.getLinkedContext().getValue('record'),a=this.getTopParent().getChildControlByName('attachments'),o=a&&a.getDataSet()?a.getDataSet().getCount():0;if(t&&t.isChanged()&&o<1)n.alert(rk('Не загружен ни один документ')),e.setResult(false);else e.setResult(true);},onUnallocDocToSave:function(t,n,d,i){var r=new o();a.show();var l={'84609e48-2fbf-44a5-90b8-bbf95092d235':'js!SBIS3.EDO.ReconciliationReportIn','08c06b43-4a26-4c7f-8dfd-30ab59c53d04':'js!SBIS3.EDO.FContractIn','802e79d6-e068-42ad-85d0-5fa1df3fe71c':'js!SBIS3.EDO.FContractOut','c9dae7ed-f013-453d-9d25-9054a117d7d6':'js!SBIS3.EDO.ReconciliationReportOut'}[i.guid];return t.getLinkedContext().getValue('record').acceptChanges(),this.createDocFromUnallocDoc(t,n,d,i,function(a){var o=parseInt(a.getRow().get('@Документ'),10),d=t.getLinkedContext().getValue('record').get('@Документ');require(['js!SBIS3.EDO2.OpenDialogAction'],function(a){var i=new a(),r={};r.id=o,r.dialogComponent=l;var s=i.execute(r);i.subscribe('onExecuted',function(a,o,i){if(!o&&0===i.get('ДокументРасширение.СостояниеКраткое').get())new e({endpoint:n}).call('Удалить',{'ИдО':i.getId()}),c.updateCounter();else{var r=t.getLinkedContext();new e({endpoint:'Документ'}).call('ДобавитьЗаписьВИсторию',{Msg:'Зарегистрирован документ "'+i.get('ТипДокумента.НазваниеКраткое')+' \u2116'+i.get('Номер')+' '+i.get('Дата').strftime('%d.%m.%Y')+'"',Action:'Регистрация документа',Object:'Нерасп',IdO:d}),new e({endpoint:'Нерасп'}).call('КоличествоВнешнихДокументов',{'Документ':parseInt(d,10)}).addCallback(function(e){if(0===e.getRawData())t.sendCommand('edoCloseDocument',true),t.sendCommand('notify','onUpdateModel');else t.sendCommand('edoLoadAttachFiles');}),c.updateCounter();}});});},true),r;},onLoadedScan:function(t,n){var a=this,o=this.getLinkedContext().getValue('record').getId();if(o>0)new e({endpoint:'Документ'}).call('ДобавитьВД',{'ИД':n.result,'Документ':o,'фБезНазвания':true,'фЭтоСкан':true,'вПапку':String(null)}).addCallback(function(e){a.getTopParent().getChildControlByName('UnallocDocDialog').sendCommand('edoLoadAttachFiles');});}};});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.RegisterDocButton", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".lastFavoriteReg{border-bottom:1px #e4e4e4 solid}"));head.appendChild(style);});}
define('js!SBIS3.EDO.RegisterDocButton',['Core/core-functions','Transport/BLObject','Transport/Record','Transport/RecordSetStatic','Core/helpers/fast-control-helpers','Core/Indicator','Core/ExtensionsManager','WS.Data/Source/SbisService','SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.RegisterDocButton','js!SBIS3.EDO.DocflowRulesHelpers','js!SBIS3.EDO.UnallocDocHandlers','css!SBIS3.EDO.RegisterDocButton','SBIS3.CONTROLS/Menu/MenuButton','i18n!SBIS3.EDO.RegisterDocButton','Elektronnyj_dokumentooborot_localization'],function(e,t,i,o,d,n,r,l,c,a,p,u){'use strict';var T=c.extend({_dotTplFn:a,$protected:{_options:{items:[],image:''}},$constructor:function(){},init:function(){T.superclass.init.call(this);var c=this,a=[],y=[],S=[],s=c.getChildControlByName('RegisterMenuButton');if(s.hierField='parent','maxi'==r.checkExtensions(['accordion'])['accordion'])a=[{docType:'ДокОтгрИсх',docSubType:null},{docType:'СчетИсх',docSubType:null},{docType:'ЗаказВх',docSubType:null},{docType:'ДокОтгрВх',docSubType:null},{docType:'СчетВх',docSubType:null},{docType:'ЗаказИсх',docSubType:null},{docType:'Наряд',docSubType:null},{docType:'ВходящийПлатеж',docSubType:null},{docType:'ИсходящийПлатеж',docSubType:null},{docType:'БанковскаяВыписка',docSubType:null},{docType:'ПриходныйОрдер',docSubType:null},{docType:'РасходныйОрдер',docSubType:null},{docType:'ПрочиеКассовыеДокументы',docSubType:null},{docType:'АвансОтчет',docSubType:null},{docType:'ВнутрПрм',docSubType:'ВнутрПрм'},{docType:'АктСписания',docSubType:'АктСписания'},{docType:'АктИнв',docSubType:'АктИнв'},{docType:'КоррВх',docSubType:null},{docType:'АктСверкиДок',docSubType:null},{docType:'ДоговорДок',docSubType:null},{docType:'КоррИсх',docSubType:null},{docType:'ПриемНаРаботу',docSubType:null},{docType:'Больничный',docSubType:null}],y=[{id:4,title:rk('Продажи')},{id:41,title:rk('Реализации'),parent:4},{id:42,title:rk('Счета'),parent:4},{id:43,title:rk('Заказы от покупателя'),parent:4},{id:5,title:rk('Закупки')},{id:51,title:rk('Поступления товаров и услуг'),parent:5},{id:52,title:rk('Счета'),parent:5},{id:53,title:rk('Заказы поставщикам'),parent:5},{id:6,title:rk('Наряды')},{id:7,title:rk('Деньги')},{id:71,title:rk('Банк'),parent:7},{id:711,title:rk('Входящий платеж'),parent:71},{id:712,title:rk('Исходящий платеж'),parent:71},{id:713,title:rk('Движение средств'),parent:71},{id:72,title:rk('Касса'),parent:7},{id:721,title:rk('Приходный кассовый ордер'),parent:72},{id:722,title:rk('Расходный кассовый ордер'),parent:72},{id:723,title:rk('Прочие кассовые документы'),parent:72},{id:73,title:rk('Подотчет'),parent:7},{id:8,title:rk('Склад')},{id:81,title:rk('Перемещения'),parent:8},{id:82,title:rk('Списания'),parent:8},{id:83,title:rk('Инвентаризации'),parent:8},{id:9,title:rk('Входящие')},{id:91,title:rk('Корреспонденция'),parent:9},{id:10,title:rk('Исходящие')},{id:101,title:rk('Корреспонденция'),parent:10},{id:11,title:rk('Кадровый учет')},{id:111,title:rk('Прием на работу'),parent:11},{id:112,title:rk('Больничный','Регламент'),parent:11},{id:12,title:rk('Акты сверки')},{id:13,title:rk('Договоры')}],S=[['ДокОтгрИсх',[41]],['СчетИсх',[42]],['ЗаказВх',[43]],['ДокОтгрВх',[51]],['СчетВх',[52]],['ЗаказИсх',[53]],['Наряд',[6]],['ВходящийПлатеж',[711]],['ИсходящийПлатеж',[712]],['БанковскаяВыписка',[713]],['ПриходныйОрдер',[721]],['РасходныйОрдер',[722]],['ПрочиеКассовыеДокументы',[723]],['АвансОтчет',[73]],['ВнутрПрм',[81]],['АктСписания',[82]],['АктИнв',[83]],['КоррВх',[91]],['КоррИсх',[101]],['АктСверкиДок',[12]],['ДоговорДок',[13]],['ПриемНаРаботу',[111]],['Больничный',[112]]];else a=[{docType:'ДокОтгрВх',docSubType:null},{docType:'КоррВх',docSubType:null},{docType:'АктСверкиДок',docSubType:null},{docType:'ДокОтгрИсх',docSubType:null},{docType:'КоррИсх',docSubType:null},{docType:'ДоговорДок',docSubType:null}],y=[{id:4,title:rk('Входящие')},{id:41,title:rk('Поступления'),parent:4},{id:42,title:rk('Корреспонденция'),parent:4},{id:5,title:rk('Исходящие')},{id:51,title:rk('Реализации'),parent:5},{id:52,title:rk('Корреспонденция'),parent:5},{id:6,title:rk('Акты сверки')},{id:7,title:rk('Договоры')}],S=[['ДокОтгрВх',[41]],['КоррВх',[42]],['АктСверкиДок',[6]],['ДоговорДок',[7]],['ДокОтгрИсх',[51]],['КоррИсх',[52]]];var g={docTypes:a},f=p.createFilterRecord(g),k=new o(),b=[],h=0;for(h=0;h<a.length;h++){var R=a[h],v=new i();if(v.addColumn('ТипДокумента',i.FIELD_TYPE_STRING),v.addColumn('ПодТипДокумента',i.FIELD_TYPE_STRING),'object'===typeof R&&'docType'in R)v.set('ТипДокумента',R['docType']);if('object'===typeof R&&'docSubType'in R)v.set('ПодТипДокумента',R['docSubType']);v.commit(),b.push(v);}k.addRecords(b);var C,D,m,B;new t('Документ').call('ИзбранныеРегламенты',{'ТипыДокументов':k},t.RETURN_TYPE_RECORDSET).addCallback(function(t){if(t){for(C=t.getRecordCount(),h=t.getRecordCount()-1;h>=0;h--)D=t.getRecords()[h].get('Название'),m=t.getRecords()[h].get('Идентификатор'),B=t.getRecords()[h].get('ТипДокумента.ТипДокумента'),y.unshift({id:C,title:D,guidSect:m,typeDoc:B}),C--;if(void 0!==y[t.getRecordCount()-1])y[t.getRecordCount()-1].className='lastFavoriteReg';var i=10000,o=f.getRawData();o.s.push({n:'НеПоказыватьПапки',t:'Логическое'}),o.d.push(true),f.setRawData(o),new l({endpoint:'Regulation'}).call('List',{'Фильтр':f}).addCallback(function(t){var o=t.getRow().getId(),d,r;if(o.getCount()>0){o.each(function(e,t){var n=o.at(t);if(null===n.get('Раздел')){for(B=n.get('ТипДокумента').get('Тип'),D=n.get('Название'),m=n.get('Идентификатор'),d=null,r=[],t=0;t<S.length;t++)if(S[t][0]==B)r=S[t][1];if(r.length>0)for(t=0;t<r.length;t++)i++,y[y.length]={id:i,title:D,parent:r[t],guidSect:m,typeDoc:B};}});var l;o.each(function(e,t){var n=o.at(t);if(null!==n.get('Раздел')){for(B=n.get('ТипДокумента').get('Тип'),D=n.get('Название'),m=n.get('Идентификатор'),d=n.get('Раздел'),l=0,t=0;t<y.length;t++)if(y[t].guidSect==d)l=y[t].id;if(l>0)i++,y[y.length]={id:i,title:D,parent:l,guidSect:m,typeDoc:B};}});}var a={},p;for(h=0;h<y.length;h++)if(void 0!==y[h].guidSect){var T=y[h].id;a[T]=true;}p=Object.keys(a);for(var g,f=function(e){for(var t=0;t<y.length;t++)if(y[t].id==e)if(void 0!==y[t].parent)g=y[t].parent,a[g]=true,f(y[t].parent);},k=0;k<p.length;k++)f(+p[k]);var b=[];for(h=0;h<y.length;h++)if(void 0!==a[y[h].id])b.push(y[h]);s.setItems(b),s.unbind('onMenuItemActivate'),s.subscribe('onMenuItemActivate',function(t,i){var o=0,d=y.length,r=y[0].guidSect,l=y[0].typeDoc;while(y[o].id!=i&&o<d)l=y[++o].typeDoc,r=y[o].guidSect;c.getTopParent().waitChildControlByName('СписокВложений').addCallback(function(t){var i=(t=t.getChildControlByName('attachments')).getSelectedKeys().slice(0);if(0===i.length)t.getDataSet().each(function(e){i.push(e.getId());});if(l)u.onUnallocDocToSave(c,l,i,{guid:r}).addCallback(function(){}).addErrback(function(t){n.hide(),e.alert(t.message,'error');});});});}).addErrback(function(e){d.alert(e.details,{},c.getTopParent());});}});}});return T;});
define("html!SBIS3.EDO.Contracts",function(){var t=function(t){var e=function(){var t=/\{\{([\s\S]+?)\}\}/g;return function(e){for(;t.test(e);)e=e.replace(t,"&#123;&#123;$1&#125;&#125;");return e}}(),o=function(t){return t.join?t.join(""):t.toString()},n=function(t){return void 0===t?"":t&&"object"==typeof t?o(t):""+t},a="undefined"!=typeof process,i=("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),p=function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,l='<div class="'+e(n(t.typeName))+'Contracts ws-flexbox ws-flex-column ws-flex-grow-1" style=\'height: calc(100% - 40px);\'> <component data-component="SBIS3.EDO2.Browser" name="'+e(n(t.typeName))+'ContractsBrowser" class="'+e(n(t.typeName))+'ContractsBrowser ws-flexbox ws-flex-column ws-flex-grow-1" style=\'height:100%;\'> <option name="stickyHeader">true</option> <option name="searchConfig"> '+e(n(t.autocompleteTemplate.apply(this,[t])))+' </option> <options name="ignoreFiltersList" type="array"> <option>ФильтрИзСписка</option> </options> <options name="hierarchy"> <option name="allow">false</option> </options> <option name="breadCrumbsConfig" type="array"> <option name="visible" value="false" type="boolean"></option> </option> <option name="historyId">'+e(n(t.typeName))+'ContractsList</option> <option name="backButtonEditing">true</option> <option name="useScope">true</option> <options name="browserOptions"> <option name="className">controls-TreeDataGridView__withPhoto</option> <option name="emptyHTML">'+e(n(rk("Нет данных")))+'</option> <option name="idProperty">@Документ</option> <option name="bind">'+e(n(t.typeName))+'ContractsFilter/button</option> <option name="infiniteScroll">down</option> <option name="pageSize">50</option> <option name="viewMode">table</option> <option name="showHead">false</option> <options name="columns" type="array"> <options> <option name="cellTemplate">html!SBIS3.EDO2.Browser/resources/columns/DateNumberColumn</option> <option name="fixedSize">true</option> <option name="width">67</option> </options> <options> <option name="cellTemplate">html!SBIS3.EDO2.Browser/resources/columns/MainInfoColumn</option> </options> <options> <option name="cellTemplate">html!SBIS3.EDO2.Browser/resources/columns/StateColumn</option> <option name="fixedSize">true</option> <option name="width">120</option> </options> <options> <option name="cellTemplate">html!SBIS3.EDO2.Browser/resources/columns/ResponsibleColumn</option> <option name="width">1</option> </options> </options> <options name="ladder" type="array"> <option>date_col</option> </options> <options name="common"> <option name="objectName">'+e(n(t.docType))+'</option> <option name="method">СписокХраним</option> <option name="model">'+e(n(t.model||"edo.model.FContractModel"))+'</option> <option name="destroyMethod">Удалить</option> <option name="viewMode">table</option> <options name="filterParams"> ';return t.docRegistryType&&(l+=' <options name="ФильтрТипыДокументов" type="array"> <option name="value" value="'+e(n(t.docRegistryType))+'"></option> </options> '),l+=' </options> </options> <options name="itemsActionsVisibility"> <option name="edoSaveDocumentOnDisk" value="false"></option> <option name="edoSendDocument" value="false"></option> <option name="edoOpenInNewTab" value="false"></option> <option name="edoShowDkPanel" value="false"></option> <option name="edoPostDocument" value="false"></option> <option name="edoLockDocument" value="false"></option> <option name="edoCancelLockDocument" value="false"></option> </options> <options name="massActionsVisibility"> <option name="edoSetCloseStatusMass" value="false"></option> <option name="edoPostsMass" value="false"></option> <option name="edoShowRegistryHistory" value="true"></option> </options> <options name="massActionsSettings"> <options name="edoPrintDocumentMass"> <option name="documentIdField">@Документ</option> <option name="minPrintWindowWidth">667</option> <option name="xsl">/Elektronnyj_dokumentooborot/Reestry/xslt/reestr_excel_full_simple.xsl</option> <option name="exportDocuments" type="boolean">true</option> <options name="handlers"> <option name="onApplyOperation" type="function">js!SBIS3.EDO.ContractsHandlers:setPrintColumns</option> <option name="onPrepareData" type="function">js!SBIS3.EDO.ContractsHandlers:addColumnsToData</option> </options> </options> <options name="edoShowRegistryHistory"> ',t.docRegistryType?l+=' <option name="objectHistoryName">'+e(n(t.docRegistryType))+"</option> ":l+=' <option name="objectHistoryName">'+e(n(t.docType))+"</option> ",l+=' </options> </options> </options> <option name="fastDataFilterConfig"> <opt name="className">edo-tasks__fastDataFilter</opt> <opt name="idProperty" value="name"></opt> <options name="filterStructure" type="array"> <opts> <opt name="internalValueField">FilterAuthorOrResponsibleMe</opt> <opt name="internalCaptionField">FilterAuthorOrResponsibleMeText</opt> <opt name="value" bind="'+e(n(t.typeName))+'ContractsFilter/button/ФильтрВладелец"></opt> <opt name="caption" bind="'+e(n(t.typeName))+'ContractsFilter/caption/ФильтрВладелец"></opt> <opt name="resetValue" type="string">Все</opt> </opts> <opts> <opt name="internalValueField">FilterState</opt> <opt name="internalCaptionField">FilterStateText</opt> <opt name="value" bind="'+e(n(t.typeName))+'ContractsFilter/button/ФильтрСостояние"></opt> <opt name="caption" bind="'+e(n(t.typeName))+'ContractsFilter/caption/ФильтрСостояние"></opt> <opt name="itemTemplate" type="null">null</opt> <opt name="resetValue" type="string">-1</opt> </opts> </options> </option> <option name="advBlockConfig"> \' <option name="blockId">EdoTasks__List</option> <options name="ignoredOptions" type="array"> <option>bind</option> <option>ВключитьСписокИсполнителей</option> <option>ПростыеВД</option> <option>РассчитатьФото</option> </options> <options name="ignoredByValue"> <option name="ИдРегламента" value="null"/> <option name="ФильтрВладелец" value="Все"/> <option name="ФильтрВладелецID" value="null"/> <option name="ФильтрДатаП" value="null"/> <option name="ФильтрДатаПериод" value="Все"/> <option name="ФильтрДатаС" value="null"/> <options name="ФильтрИсполнительСобытия" type="array"/> <option name="ФильтрКонкретныйИсполнитель" value="null"/> <option name="ФильтрКонкретныйИсполнительID" value="null"/> <options name="ФильтрЛицо1" type="array"/> <options name="ФильтрОтветственноеЛицо" type="array"/> <options name="ФильтрПоВехе" type="array"/> <option name="ФильтрПоКраткомуСостоянию" value="-1"/> <options name="ФильтрСписокРассылки" type="array"/> <option name="ФильтрПриоритет" value="null"/> <option name="ФильтрПросроченные" value="null"/> <option name="ФильтрСрокДата" value="null"/> <option name="ФильтрУдаленные" value="null"/> <option name="ФильтрФаза" value="null"/> </options> \' </option> ',t.filterButtonConfig?l+=' <option name="filterButtonConfig" type="ref">'+e(n(function(t,e){var o=i.randomId();return t[o]=e,o}(p,t.filterButtonConfig)))+"</option> ":(l+=' <option name="filterButtonConfig"> <option name="template">js!SBIS3.EDO.FilterContract</option> <option name="additionalFilterParamsTemplate">js!SBIS3.EDO.FilterContractSelector</option> <options name="filterStructure" type="array"> '+e(n(t.MarksStructure({browserBind:t.typeName+t.browserBind})))+" "+e(n(t.UnfixedStructure({browserBind:t.typeName+t.browserBind})))+" "+e(n(t.ListDispatchStructure({browserBind:t.typeName+t.browserBind})))+' <opts> <opt name="internalValueField">FilterDatePeriod</opt> <opt name="internalCaptionField">FilterDatePeriodText</opt> <opt name="value" bind="'+e(n(t.typeName))+'ContractsFilter/button/ФильтрДатаПериод"></opt> <opt name="caption" bind="'+e(n(t.typeName))+'ContractsFilter/caption/ФильтрДатаПериод"></opt> <opt name="resetValue">Все</opt> </opts> <opts> <opt name="internalValueField">FilterIdRegulationMul</opt> <opt name="internalCaptionField">FilterIdRegulationText</opt> <opt name="internalVisibilityField">FilterRegulationVisibility</opt> <opt name="value" bind="'+e(n(t.typeName))+'ContractsFilter/button/ИдРегламента"></opt> <opt name="resetValue" type=\'array\'></opt> <opt name="resetVisibilityValue">false</opt> </opts> <opts> <opt name="internalValueField">FilterOurOrganisation</opt> <opt name="internalCaptionField">FilterOurOrganisationText</opt> <opt name="internalvisibilityField">FilterOurOrganisationVisibility</opt> <opt name="value" bind="'+e(n(t.typeName))+'ContractsFilter/button/ФильтрДокументНашаОрганизация"></opt> <opt name="caption" bind="'+e(n(t.typeName))+'ContractsFilter/caption/ФильтрДокументНашаОрганизация"></opt> <opts name="resetValue" type="array"></opts> <opt name="resetVisibilityValue">false</opt> <opt name="itemTemplate" type="function" value="tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterOurOrg"/> <opt name="historyItemTemplate" type="function" value="tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterOurOrg"/> </opts> <opts> <opt name="internalValueField">FilterDateFrom</opt> <opt name="internalCaptionField">FilterDateFromEmptyText</opt> <opt name="value" bind="'+e(n(t.typeName))+'ContractsFilter/button/ФильтрДатаС"></opt> <opt name="resetValue" type="null">null</opt> <opt name="historyItemTemplate" type="null">null</opt> <opt name="itemTemplate" type="null">null</opt> </opts> <opts> <opt name="internalValueField">FilterDateTo</opt> <opt name="internalCaptionField">FilterDateToEmptyText</opt> <opt name="value" bind="'+e(n(t.typeName))+'ContractsFilter/button/ФильтрДатаП"></opt> <opt name="resetValue" type="null">null</opt> <opt name="historyItemTemplate" type="null">null</opt> <opt name="itemTemplate" type="null">null</opt> </opts> <opts> <opt name="internalValueField">FilterState</opt> <opt name="internalCaptionField">FilterStateText</opt> <opt name="value" bind="'+e(n(t.typeName))+'ContractsFilter/button/ФильтрСостояние"></opt> <opt name="caption" bind="'+e(n(t.typeName))+'ContractsFilter/caption/ФильтрСостояние"></opt> <opt name="itemTemplate" type="null">null</opt> <opt name="resetValue" type="string">-1</opt> </opts> <opts> <opt name="internalValueField">FilterOverdue</opt> <opt name="internalCaptionField">FilterOverdueText</opt> <opt name="value" bind="'+e(n(t.typeName))+'ContractsFilter/button/ФильтрПросроченные"></opt> <opt name="resetValue" type="null">null</opt> </opts> <opts> <opt name="internalValueField">FilterLimitationDate</opt> <opt name="internalCaptionField">FilterLimitationDateText</opt> <opt name="value" bind="'+e(n(t.typeName))+'ContractsFilter/button/ФильтрСрокДата"></opt> <opt name="resetValue" type="null">null</opt> </opts> <opts> <opt name="internalValueField">FilterFace1</opt> <opt name="internalCaptionField">FilterFace1Text</opt> <opt name="internalVisibilityField">FilterFace1Visibility</opt> ',"Incoming"==t.typeName?l+=' <opt name="value" bind="'+e(n(t.typeName))+'ContractsFilter/button/ФильтрЛицо1"></opt> ':l+=' <opt name="value" bind="'+e(n(t.typeName))+'ContractsFilter/button/ФильтрМультисписокРассылки"></opt> ',l+=' <opt name="caption" bind="'+e(n(t.typeName))+'ContractsFilter/caption/ФильтрЛицо1"></opt> <opts name="resetValue" type="array"></opts> <opt name="resetCaption" value=""></opt> <opt name="resetVisibilityValue">false</opt> <opt name="itemTemplate" type="function" value="tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterFace1"/> <opt name="historyItemTemplate" type="function" value="tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterFace1"/> </opts> <opts> <opt name="internalValueField">FilterResponsibleFace</opt> <opt name="internalCaptionField">FilterResponsibleFaceText</opt> <opt name="internalVisibilityField">FilterResponsibleFaceVisibility</opt> <opt name="value" bind="'+e(n(t.typeName))+'ContractsFilter/button/ФильтрОтветственноеЛицо"></opt> <opt name="caption" bind="'+e(n(t.typeName))+'ContractsFilter/caption/ФильтрОтветственноеЛицо"></opt> <opts name="resetValue" type="array"></opts> <opt name="resetCaption" value=""></opt> <opt name="resetVisibilityValue">false</opt> <opt name="itemTemplate" type="function" value="tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterResp"/> <opt name="historyItemTemplate" type="function" value="tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterResp"/> </opts> </options> </option> '),l+=' </component> <component data-component="SBIS3.EDO2.OpenDialogAction"> <option name="name">'+e(n(t.typeName))+'ContractsAction</option> <option name="editMode">newFloatArea</option> <option name="objectName">'+e(n(t.docType))+'</option> <option name="initializingWay" value="delayedRemote"></option> </component> ',!0===t.useAutoRefresh&&(l+=' <component data-component="SBIS3.EDO.FEdoPartialReloader" name="PartialReloader"> <opt name="objectName" value="'+e(n(t.docType))+'"/> <opt name="method" value="'+e(n(t.method||"СписокХраним"))+'"/> <opt name="filterName" value="'+e(n(t.partialReloader.filterName||"СписокИдО"))+'"/> <opt name="sortField" value="'+e(n(t.partialReloader.sortField||"Дата"))+'"/> <opt name="overrideItemsSortMethod" value="true"/> <opt name="updateOnDeleteAndAdd" value="'+e(n(t.partialReloader.updateOnDeleteAndAdd||"false"))+'"/> <opt name="addServerChannelName" value="'+e(n(t.partialReloader.addServerChannelName||""))+'"/> <opt name="fixServerChannelName" value="'+e(n(t.partialReloader.fixServerChannelName||""))+'"/> <opt name="deleteServerChannelName" value="'+e(n(t.partialReloader.deleteServerChannelName||""))+'"/> <opts name="actionEventsToListen" type="array"> <opt value="onUpdateModel"/> ',t.partialReloader.onDestroyModelHandlingEnable&&(l+=' <opt value="onDestroyModel"/> '),l+=" ",t.partialReloader.onCreateModelHandlingEnable&&(l+=' <opt value="onCreateModel"/> '),l+=' </opts> <opt name="edoOpenDialogAction" value="'+e(n(t.typeName))+'ContractsAction"/> <opt name="complexKeyField" value="@Документ"/> </component> '),l+=" </div>",(l=e(l))+(a&&-1!==l.indexOf("{{")?String.fromCharCode(8203,8203):"")};return t.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.Contracts"}},t});
define('js!SBIS3.EDO.ContractsHandlers',['WS.Data/Source/SbisService','Core/helpers/string-helpers','Core/Deferred','WS.Data/Format/StringField','Elektronnyj_dokumentooborot_localization'],function(e,t,i,l){'use strict';var f;return f={setPrintColumns:function(e){e.setResult([{field:'Дата',title:''},{field:'Номер',title:''},{field:'ДокументРасширение.Сумма',title:''},{field:'ДокументРасширение.СостояниеКраткое',title:''},{field:'СтатусПечать',title:''},{field:'НазваниеФайлаПечать',title:''},{field:'ИмяФайлаПечать',title:''},{field:'ДокументРасширение.Название',title:''},{field:'ЗначимыйКомментарий',title:''},{field:'Лицо1.Название',title:''},{field:'РП.РазделТипаДокумента',title:''},{field:'Контрагент.ИНН',title:''},{field:'Контрагент.КПП',title:''},{field:'ДокументНашаОрганизация.Контрагент.Название',title:''},{field:'РП.НОИНН',title:''},{field:'НашаОрганизация.КПП',title:''},{field:'Сотрудник.Название',title:''},{field:'РП.НазваниеПодразделения',title:''},{field:'Подразделение',title:''},{field:'ДатаОтправки',title:''},{field:'ДатаПолучения',title:''},{field:'ДатаУтверждения',title:''},{field:'@Документ',title:''},{field:'Лицо1',title:''},{field:'Лицо1.@Лицо',title:''},{field:'ДокументРасширение.Состояние',title:''},{field:'ДокументНашаОрганизация',title:''},{field:'Удален',title:''},{field:'ТипДокумента.ТипДокумента',title:''},{field:'ИдРегламента',title:''},{field:'Сотрудник',title:''},{field:'ТипДокумента.ФлагиТипаДокумента',title:''},{field:'РП.ИнфоРегламента',title:''}]);},addColumnsToData:function(f,d){var r=f.getTarget();if(r&&'PDF'==r._currentItem)return;var g=new i(),a=['ДатаОтправки','ДатаПолучения','ДатаУтверждения','НазваниеФайлаПечать','ИмяФайлаПечать'],n,s,o;for(n=0;n<a.length;n++)if(-1===d.getFormat().getFieldIndex(a[n]))d.addField(new l({name:a[n]}));var u=[],c={},m=['ДокументРасширение.Название','ЗначимыйКомментарий','РП.КомментарийПоследнейФазы'];for(n=0;n<d.getCount();n++){var v=d.at(n);if(o=parseInt(v.get('@Документ'),10),u.push(o),o in c)c[o].push(v.getId());else c[o]=[v.getId()];for(s=0;s<m.length;s++){var h=m[s];if(v.has(h)&&v.get(h)){var C=v.get(h);if(C.length>255)C=C.substr(0,255)+'...';C=t.escapeHtml(C),v.set(h,C);}}var S=v.get('РП.ПростыеВД')||v.get('РП.ДополнительнаяИнформация'),p=S&&S.getCount&&S.getCount()||0,I='',b='';for(s=0;s<p;s++){var D=S.at(s),F=(s+1).toString()+') ',y=D.get('Название'),H=D.get('ИмяФайла');I+=(I?', ':'')+F+y,b+=(b?', ':'')+F+H;}v.set('НазваниеФайлаПечать',I),v.set('ИмяФайлаПечать',b);}new e({endpoint:'Документ'}).call('ЗначимаяИнформация',{'Документы':u}).addCallback(function(e){var t;e.getAll().each(function(e){if(o=e.get('Документ'),o in c)for(n=0;n<c[o].length;n++){if(t=d.at(d.getIndexByValue(d.getIdProperty()||'@Документ',c[o][n])),t.set('ДатаОтправки',e.get('Отправка')?e.get('Отправка').strftime('%d.%m.%y %H:%M'):''),t.set('ДатаПолучения',e.get('Получение')?e.get('Получение').strftime('%d.%m.%y %H:%M'):''),t.set('ДатаУтверждения',e.get('Завершение')?e.get('Завершение').strftime('%d.%m.%y %H:%M'):''),!t.get('Контрагент.ИНН'))t.set('Контрагент.ИНН',e.get('ИНН')?e.get('ИНН'):'');if(!t.get('Контрагент.КПП'))t.set('Контрагент.КПП',e.get('КПП')?e.get('КПП'):'');if(!t.get('РП.НОИНН'))t.set('РП.НОИНН',e.get('ИННОрг')?e.get('ИННОрг'):'');if(!t.get('НашаОрганизация.КПП'))t.set('НашаОрганизация.КПП',e.get('КППОрг')?e.get('КППОрг'):'');var i=t.get('ДокументРасширение.СостояниеКраткое'),l=i&&i.getAsValue&&i.getAsValue();if('ВОбработке'===l)l='В обработке';}}),g.callback(d);}).addErrback(function(){g.callback(d);}),f.setResult(g);}};});
define('js!SBIS3.EDO.Contracts',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.Contracts','js!SBIS3.EDO.AutocompleteHandlers','tmpl!SBIS3.EDO.BaseFilter.Period/resources/PeriodStructure','tmpl!SBIS3.EDO.BaseFilter.Marks/resources/MarksStructure','tmpl!SBIS3.EDO.BaseFilter.ResponsibleFace/resources/ResponsibleFaceStructure','tmpl!SBIS3.EDO.BaseFilter.Face1/resources/Face1Structure','tmpl!SBIS3.EDO.BaseFilter.Regulation/resources/RegulationStructure','tmpl!SBIS3.EDO.BaseFilter.Unfixed/resources/UnfixedStructure','tmpl!SBIS3.EDO.BaseFilter.Unread/resources/UnreadStructure','tmpl!SBIS3.EDO.BaseFilter.OurOrganisation/resources/OurOrganisationStructure','tmpl!SBIS3.EDO.BaseFilter.ListDispatch/resources/ListDispatchStructure','js!SBIS3.EDO.ContractsHandlers','js!SBIS3.EDO2.Browser','html!SBIS3.EDO2.Browser/resources/columns/ResponsibleColumn','html!SBIS3.EDO2.Browser/resources/columns/DateNumberColumn','html!SBIS3.EDO2.Browser/resources/columns/StateColumn','html!SBIS3.EDO2.Browser/resources/columns/MainInfoColumn','js!SBIS3.EDO2.OpenDialogAction','js!SBIS3.EDO.FEdoPartialReloader','js!SBIS3.EDO.EdoOperationsCommon','js!SBIS3.EDO2.EdoColumnsClickDispatcher','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterFace1','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterResp','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterListDispatch','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterOurOrg','tmpl!SBIS3.EDO2.MarksFilterRowTemplate/tmpl/MarksFilterRowTemplate','js!SBIS3.EDO.OperationPrint','Elektronnyj_dokumentooborot_localization'],function(t,e,r,s,o,l,S,i,u,a,c,n){'use strict';var B=t.extend({_dotTplFn:e,$protected:{_options:{autocompleteTemplate:r.autocompleteTemplate,browserBind:'ContractsFilter/button',periodStructure:s,MarksStructure:o,ResponsibleFaceStructure:l,Face1Structure:S,RegulationStructure:i,UnfixedStructure:u,UnreadStructure:a,OurOrganisationStructure:c,ListDispatchStructure:n}},$constructor:function(){},init:function(){B.superclass.init.call(this),r.setProcessingAutocompletion(this,'ФильтрПоЛицуИзСписка');var t=this.getChildControlByName('browserFastDataFilter');if(t)t.setItems(this._options.fastDataFilterConfig.data);}});return B;});
define('js!SBIS3.EDO.AllContracts',['js!SBIS3.EDO.Contracts','js!SBIS3.EDO.FContractModel','Elektronnyj_dokumentooborot_localization'],function(t){'use strict';var e=t.extend({$protected:{_options:{model:'edo.model.FContractModel',fastDataFilterConfig:{data:[{keyField:'key',displayField:'title',name:'FilterAuthorOrResponsibleMe',multiselect:false,className:'controls-DropdownList__withoutCross controls-DropdownList__linkStyle',values:[{key:'Все',value:'Все',title:rk('Все')},{key:'От меня',value:'От меня',title:rk('От меня')},{key:'От моего отдела',value:'От моего отдела',title:rk('От моего отдела')}]},{keyField:'key',displayField:'title',name:'FilterState',multiselect:false,className:'controls-DropdownList controls-DropdownList__linkStyle',values:[{key:'-1',title:rk('В любом состоянии')},{key:'10',title:rk('Внутренняя обработка')},{key:'2,3',title:rk('Недоставленные')},{key:'4',title:rk('Не получен ответ')},{key:'7',title:rk('Утвержденные')},{key:'9',title:rk('Отклоненные')},{key:'6',title:rk('С ошибками')},{key:'22',title:rk('Аннулированные')},{key:'19,20',title:rk('Удалено мной/контрагентом')},{key:'0,1',title:rk('Черновики')}]}]}}},$constructor:function(){},init:function(){e.superclass.init.call(this);}});return e;});
define("tmpl!SBIS3.EDO.ContractsChoiceDialog",["Core/tmpl/js/tclosure","js!SBIS3.CONTROLS/Action/Selector/SelectorWrapper","js!SBIS3.EDO.AllContracts"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.CONTROLS/Action/Selector/SelectorWrapper"]=e[1],r["js!SBIS3.EDO.AllContracts"]=e[2];var o=function e(o,a,i,n,l){function c(){}var s=0,d=void 0!==t&&t?t:arguments[arguments.length-1];void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure"));var u={};l&&l.isSetts&&(u=l.fullContext||{});var p="string"==typeof i?i:"",v=void 0===r?void 0:r,C={id:[],def:void 0},h=d.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),S=this&&this.includedTemplates?this.includedTemplates:{},m=d.getMarkupGenerator(n);try{var f=m.joinElements([m.createTag("div",{class:"edo-ContractsChoiceDialog"},[m.createTag("div",{class:"ws-window-titlebar-custom edo-ContractsChoiceDialog__header-title","data-lmchild":"WindowTitle"},[m.createTag("span",{class:"ws-float-area-title"},[m.createText(""+global.rk("��������"))],{},C,this)],{},C,this),m.createControl("wsControl","ws:SBIS3.CONTROLS/Action/Selector/SelectorWrapper",{content:d.createDataArray([(new function(){var e=Object.create(o),t=function e(t,r,o,a,i){if(void 0===o)var o=arguments[2];var n=0,l="content";if(void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure")),i&&i.isSetts)var c=i.fullContext||{};t=d.isolateScope(Object.create(this),t,l);var s="string"==typeof o?o:"",u={id:[],def:void 0},p=this&&this.includedTemplates?this.includedTemplates:{},C=d.getMarkupGenerator(a);try{var S=C.joinElements([C.createControl("wsControl","ws:SBIS3.EDO.AllContracts",{docType:"����������",typeName:"All"},d.plainMerge(r,{}),{data:t,ctx:this,pName:void 0!==l?l:void 0,viewController:h},o,v,p,d.config,c)],s,u);u.def&&(S=C.chain(S,u,r),u=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/components/Registry/Contracts/ContractsChoiceDialog/ContractsChoiceDialog.tmpl",e,t)}return S||""};this.func=d.makeFunctionSerializable(t,e)}).func]),linkedObjectName:"browserView",esc:!1},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:h},i,v,S,d.config,u)],a,C,this)],p,C);C.def&&(f=m.chain(f,C,a),C=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/components/Registry/Contracts/ContractsChoiceDialog/ContractsChoiceDialog.tmpl",e,o)}return f||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.ContractsChoiceDialog"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.ContractsChoiceDialog", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-ContractsChoiceDialog{height:calc(66%)}.edo-ContractsChoiceDialog__header-title{font-size:0;padding-right:30px}"));head.appendChild(style);});}
define('js!SBIS3.EDO.ContractsChoiceDialog',['SBIS3.CONTROLS/Action/Selector/SelectorController','js!SBIS3.EDO2.OpenDialogAction','tmpl!SBIS3.EDO.ContractsChoiceDialog','Core/helpers/Object/find','css!SBIS3.EDO.ContractsChoiceDialog','Elektronnyj_dokumentooborot_localization'],function(t,e,i,n){'use strict';return t.extend({_dotTplFn:i,$protected:{_options:{extraFilterData:[]}},$constructor:function(){this.once('onReady',function(){this._setExtraFilterData(),this._setExtraItemsActions();}.bind(this));},_setExtraFilterData:function(){var t=this.getChildControlByName('browserFilterButton'),e=function(t,e){t=t||[],e=e||[];var i,o;for(i=0;i<e.length;i++)if(o=n(t,function(t){return t.internalValueField===e[i].internalValueField;}),o)o.value=e[i].value,o.caption=e[i].caption;},i;if(this._options.extraFilterData.length)e(i=t.getFilterStructure(),this._options.extraFilterData),t.setFilterStructure(i);},_setExtraItemsActions:function(){var t=new e();this.getChildControlByName('browserView').setItemsActions([{name:'edit',icon:'icon-16 icon-Edit icon-primary',isMainAction:true,tooltip:rk('\uFFFD\uFFFD\uFFFD\uFFFD\uFFFD\uFFFD\uFFFD\uFFFD\uFFFD\uFFFD\uFFFD\uFFFD\uFFFD'),onActivated:function(e,i){t.execute({id:parseInt(i,10),openMode:4});}}]);}});});
define("tmpl!SBIS3.EDO.FilterContract",["Core/tmpl/js/tclosure","js!SBIS3.EDO.BaseFilter.Period","js!SBIS3.EDO.BaseFilter.State","js!SBIS3.EDO.BaseFilter.LimitationOverdue","js!SBIS3.EDO.BaseFilter.Marks","js!SBIS3.EDO.BaseFilter.Regulation","js!SBIS3.EDO.BaseFilter.ResponsibleFace","js!SBIS3.EDO.BaseFilter.Face1","js!SBIS3.EDO.BaseFilter.Unfixed","js!SBIS3.EDO.BaseFilter.OurOrganisation","js!SBIS3.EDO.BaseFilter.DocumentType"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.EDO.BaseFilter.Period"]=e[1],r["js!SBIS3.EDO.BaseFilter.State"]=e[2],r["js!SBIS3.EDO.BaseFilter.LimitationOverdue"]=e[3],r["js!SBIS3.EDO.BaseFilter.Marks"]=e[4],r["js!SBIS3.EDO.BaseFilter.Regulation"]=e[5],r["js!SBIS3.EDO.BaseFilter.ResponsibleFace"]=e[6],r["js!SBIS3.EDO.BaseFilter.Face1"]=e[7],r["js!SBIS3.EDO.BaseFilter.Unfixed"]=e[8],r["js!SBIS3.EDO.BaseFilter.OurOrganisation"]=e[9],r["js!SBIS3.EDO.BaseFilter.DocumentType"]=e[10];var o=function e(o,i,a,l,n){function s(){}var c=0,d=void 0!==t&&t?t:arguments[arguments.length-1];void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure"));var S={};n&&n.isSetts&&(S=n.fullContext||{});var u="string"==typeof a?a:"",p=void 0===r?void 0:r,B={id:[],def:void 0},y=d.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),m=this&&this.includedTemplates?this.includedTemplates:{},f=d.getMarkupGenerator(l);try{var F=f.joinElements([f.createTag("div",{class:"edo-BaseFilter__filterPicker"},[f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Period",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},a,p,m,d.config,S),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.State",{items:[{key:"-1",title:global.rk("В любом состоянии")},{key:"10",title:global.rk("Внутренняя обработка")},{key:"2,3",title:global.rk("Недоставленные")},{key:"4",title:global.rk("Не получен ответ")},{key:"7",title:global.rk("Утвержденные")},{key:"9",title:global.rk("Отклоненные")},{key:"6",title:global.rk("С ошибками")},{key:"19,20,22",title:global.rk("Аннулированные")},{key:"0,1",title:global.rk("Черновики")},{key:"-2",title:global.rk("Удаленные")}],esc:!1},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},a,p,m,d.config,S),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.LimitationOverdue",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},a,p,m,d.config,S),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Marks",{reestrName:d.getter(o,["docType"])},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},a,p,m,d.config,S),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Regulation",{multiselect:!0,docTypes:d.getter(o,["docTypes"])},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},a,p,m,d.config,S),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ResponsibleFace",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},a,p,m,d.config,S),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Face1",{caption:d.getter(o,["title"])},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},a,p,m,d.config,S),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Unfixed",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},a,p,m,d.config,S),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.OurOrganisation",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},a,p,m,d.config,S),f.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.DocumentType",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},a,p,m,d.config,S)],i,B,this)],u,B);B.def&&(F=f.chain(F,B,i),B=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/components/Registry/Contracts/Filters/FilterContract.tmpl",e,o)}return F||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FilterContract"}},o});
define('js!SBIS3.EDO.FilterContract',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FilterContract','js!SBIS3.EDO.BaseFilter.Period','js!SBIS3.EDO.BaseFilter.State','js!SBIS3.EDO.BaseFilter.Marks','js!SBIS3.EDO.BaseFilter.LimitationOverdue','js!SBIS3.EDO.BaseFilter.ResponsibleFace','js!SBIS3.EDO.BaseFilter.Face1','js!SBIS3.EDO.BaseFilter.Regulation','js!SBIS3.EDO.BaseFilter.Unfixed','js!SBIS3.EDO.BaseFilter.OurOrganisation','js!SBIS3.EDO.BaseFilter.DocumentType','js!SBIS3.EDO.ScopeFilters','Elektronnyj_dokumentooborot_localization'],function(e,t){'use strict';var i=e.extend({_dotTplFn:t,$protected:{_options:{autoHeight:true,autoWidth:true}},$constructor:function(){},init:function(){i.superclass.init.call(this);}});return i;});
define("tmpl!SBIS3.EDO.FilterContractSelector",["Core/tmpl/js/tclosure","js!SBIS3.EDO.BaseFilter.MarksSelector","js!SBIS3.EDO.BaseFilter.LimitationOverdueSelector","js!SBIS3.EDO.BaseFilter.ResponsibleFaceSelector","js!SBIS3.EDO.BaseFilter.Face1Selector","js!SBIS3.EDO.BaseFilter.RegulationSelector","js!SBIS3.EDO.BaseFilter.UnfixedSelector","js!SBIS3.EDO.BaseFilter.OurOrganisationSelector","js!SBIS3.EDO.BaseFilter.RightsLimText"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.EDO.BaseFilter.MarksSelector"]=e[1],r["js!SBIS3.EDO.BaseFilter.LimitationOverdueSelector"]=e[2],r["js!SBIS3.EDO.BaseFilter.ResponsibleFaceSelector"]=e[3],r["js!SBIS3.EDO.BaseFilter.Face1Selector"]=e[4],r["js!SBIS3.EDO.BaseFilter.RegulationSelector"]=e[5],r["js!SBIS3.EDO.BaseFilter.UnfixedSelector"]=e[6],r["js!SBIS3.EDO.BaseFilter.OurOrganisationSelector"]=e[7],r["js!SBIS3.EDO.BaseFilter.RightsLimText"]=e[8];var o=function e(o,i,l,n,a){function s(){}var c=0,S=void 0!==t&&t?t:arguments[arguments.length-1];void 0===S&&(eval("var thelpers = null;"),S=global.requirejs("View/Runner/tclosure"));var d={};a&&a.isSetts&&(d=a.fullContext||{});var u="string"==typeof l?l:"",p=void 0===r?void 0:r,B={id:[],def:void 0},m=S.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),f=this&&this.includedTemplates?this.includedTemplates:{},F=S.getMarkupGenerator(n);try{var O=F.joinElements([F.createTag("div",{class:"edo-BaseFilter__filterPicker  edo-twoColumnSelectors"},[F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.MarksSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},l,p,f,S.config,d),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.LimitationOverdueSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},l,p,f,S.config,d),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ResponsibleFaceSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},l,p,f,S.config,d),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Face1Selector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},l,p,f,S.config,d),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.RegulationSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},l,p,f,S.config,d),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.UnfixedSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},l,p,f,S.config,d),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.OurOrganisationSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},l,p,f,S.config,d),F.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.RightsLimText",{textRender:S.getTypeFunc("js!SBIS3.EDO.ScopeFilters:setScopeTextForFilter ",{}),esc:!1},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:m},l,p,f,S.config,d)],i,B,this)],u,B);B.def&&(O=F.chain(O,B,i),B=void 0)}catch(e){S.templateError("resources/Elektronnyj_dokumentooborot/components/Registry/Contracts/Filters/FilterContractSelector/FilterContractSelector.tmpl",e,o)}return O||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FilterContractSelector"}},o});
define('js!SBIS3.EDO.FilterContractSelector',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FilterContractSelector','js!SBIS3.EDO.BaseFilter.MarksSelector','js!SBIS3.EDO.BaseFilter.ResponsibleFaceSelector','js!SBIS3.EDO.BaseFilter.Face1Selector','js!SBIS3.EDO.BaseFilter.RegulationSelector','js!SBIS3.EDO.BaseFilter.LimitationOverdueSelector','js!SBIS3.EDO.BaseFilter.UnfixedSelector','js!SBIS3.EDO.BaseFilter.OurOrganisationSelector','js!SBIS3.EDO.BaseFilter.RightsLimText','js!SBIS3.EDO.FilterDeliveryMethod','js!SBIS3.EDO.FilterDeliveryMethodSelector','js!SBIS3.EDO.DeliveryMethodSelector','Elektronnyj_dokumentooborot_localization'],function(e,t){var r=e.extend({_dotTplFn:t,$protected:{_options:{autoHeight:true,autoWidth:true}},$constructor:function(){},init:function(){r.superclass.init.call(this);}});return r;});
define('js!SBIS3.EDO.FilterIncomingContract',['js!SBIS3.EDO.FilterContract','Elektronnyj_dokumentooborot_localization'],function(t){'use strict';var e=t.extend({$protected:{_options:{docType:['ДоговорВх'],typeName:'Incoming',kitTitle:rk('Отправителя'),title:rk('Отправитель'),titleFromMe:rk('Мои'),titleFromMyDepartment:rk('Моего отдела'),scopeArea:'Входящие договора'}},$constructor:function(){},init:function(){e.superclass.init.call(this);}});return e;});
define('js!SBIS3.EDO.FilterOutgoingContract',['js!SBIS3.EDO.FilterContract','Elektronnyj_dokumentooborot_localization'],function(t){'use strict';var e=t.extend({$protected:{_options:{docType:['ДоговорИсх'],typeName:'Outgoing',isState23:true,isState4:true,isState6:true,kitTitle:rk('Получателя'),title:rk('Получатель'),titleFromMe:rk('От меня'),titleFromMyDepartment:rk('От моего отдела'),scopeArea:'Исходящие договора'}},$constructor:function(){},init:function(){e.superclass.init.call(this);}});return e;});
define('js!SBIS3.EDO.IncomingContracts',['js!SBIS3.EDO.Contracts','js!SBIS3.EDO.FContractModel','js!SBIS3.EDO.FilterIncomingContract','Elektronnyj_dokumentooborot_localization'],function(t){'use strict';var e=t.extend({$protected:{_options:{model:'edo.model.FContractModel',docRegistryType:'ДоговорВх',fastDataFilterConfig:{data:[{keyField:'key',displayField:'title',name:'FilterAuthorOrResponsibleMe',multiselect:false,className:'controls-DropdownList__withoutCross controls-DropdownList__linkStyle',values:[{key:'Все',value:'Все',title:rk('Все')},{key:'От меня',value:'От меня',title:rk('От меня')},{key:'От моего отдела',value:'От моего отдела',title:rk('От моего отдела')}]},{keyField:'key',displayField:'title',name:'FilterState',multiselect:false,className:'controls-DropdownList controls-DropdownList__linkStyle',values:[{key:'-1',title:rk('В любом состоянии')},{key:'10',title:rk('Внутренняя обработка')},{key:'7',title:rk('Утвержденные')},{key:'9',title:rk('Отклоненные')},{key:'19,20,22',title:rk('Аннулированные')},{key:'0,1',title:rk('Черновики')}]}]}}},$constructor:function(){},init:function(){e.superclass.init.call(this);}});return e;});
define('js!SBIS3.EDO.OutgoingContracts',['js!SBIS3.EDO.Contracts','js!SBIS3.EDO.FContractModel','js!SBIS3.EDO.FilterOutgoingContract','Elektronnyj_dokumentooborot_localization'],function(t){'use strict';var e=t.extend({$protected:{_options:{model:'edo.model.FContractModel',docRegistryType:'ДоговорИсх',fastDataFilterConfig:{data:[{keyField:'key',displayField:'title',name:'FilterAuthorOrResponsibleMe',multiselect:false,className:'controls-DropdownList__withoutCross controls-DropdownList__linkStyle',values:[{key:'Все',value:'Все',title:rk('Все')},{key:'От меня',value:'От меня',title:rk('От меня')},{key:'От моего отдела',value:'От моего отдела',title:rk('От моего отдела')}]},{keyField:'key',displayField:'title',name:'FilterState',multiselect:false,className:'controls-DropdownList controls-DropdownList__linkStyle',values:[{key:'-1',title:rk('В любом состоянии')},{key:'10',title:rk('Внутренняя обработка')},{key:'2,3',title:rk('Недоставленные')},{key:'4',title:rk('Не получен ответ')},{key:'7',title:rk('Утвержденные')},{key:'9',title:rk('Отклоненные')},{key:'6',title:rk('С ошибками')},{key:'19,20,22',title:rk('Аннулированные')},{key:'0,1',title:rk('Черновики')}]}]}}},$constructor:function(){},init:function(){e.superclass.init.call(this);}});return e;});
define("html!SBIS3.EDO.ContractTabTemplate",function(){var o=function(o){var n=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;o.test(n);)n=n.replace(o,"&#123;&#123;$1&#125;&#125;");return n}}(),t=function(o){return o.join?o.join(""):o.toString()},e=function(o){return void 0===o?"":o&&"object"==typeof o?t(o):""+o},i="undefined"!=typeof process,p=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div style="height:100%;"> <component data-component="SBIS3.Engine.BrowserTabs" name="'+n(e(o.typeName))+'ContractsTabs" class="ContractsTabs ws-flexbox ws-flex-column ws-flex-grow-1"> <options name="tabsArea" type="array"> <options> <option name="id">aGroup</option> <option name="content"> <div> <div style="display: inline-block; float: left;"> <component data-component="SBIS3.EDO2.RulesSelector" name="addDocumentButton'+n(e(o.typeName))+'"> <option name="width">200</option> <option name=\'showFavorites\'>false</option> <options name="docTypes" type="array"> <options> ');return o.docRegistryType?p+=' <option name="docType">'+n(e(o.docRegistryType))+"</option> ":p+=' <option name="docType">'+n(e(o.docType))+"</option> ",p+=' </options> </options> <option name="content"> <component data-component="SBIS3.CONTROLS/Menu/MenuButton" name="addDocumentMenuButton'+n(e(o.typeName))+'"> <option name="caption">+ '+n(e(rk("Документ")))+'</option> <option name="primary">true</option> </component> </option> </component> </div> <div style="display: inline-block; float: left; margin-left: 12px;"> <component data-component="SBIS3.EDO.LoadButton" data-access="',"Incoming"===o.typeName?p+="Входящие договора":"Outgoing"===o.typeName?p+="Исходящие договора":p+="Договоры",p+='"> <option name="from1C">true</option> <option name="incoming">',"Incoming"===o.typeName?p+="true":p+="false",p+="</option> ",o.docRegistryType?p+=' <option name="docType">'+n(e(o.docRegistryType))+"</option> ":p+=' <option name="docType">'+n(e(o.docType))+"</option> ",p+=' </component> </div> <div style="display: inline-block; float: left; margin-left: 12px;"> <component data-component="SBIS3.EDO2.ExportButton"> <option name="incoming">',"Incoming"===o.typeName?p+="true":p+="false",p+="</option> ",o.docRegistryType?p+=' <option name="docType">'+n(e(o.docRegistryType))+"</option> ":p+=' <option name="docType">'+n(e(o.docType))+"</option> ",p+=' <options name="exportSettings"> <option name="registryName">Договоры</option> <option name="fileName">Документы</option> <options name="items"> <options name="PDF"> <option name="pageOrientation">2</option> <option name="serverSideExport" type="boolean">false</option> <option name="xsl">/Elektronnyj_dokumentooborot/Reestry/xslt/reestr_agreements_pdf.xsl</option> </options> <options name="Excel"> <option name="serverSideExport" type="boolean">false</option> <option name="xsl">/Elektronnyj_dokumentooborot/Reestry/xslt/reestr_excel_full_simple.xsl</option> </options> </options> <options name="handlers"> <option name="onApplyOperation" type="function">js!SBIS3.EDO.ContractsHandlers:setPrintColumns</option> <option name="onPrepareData" type="function">js!SBIS3.EDO.ContractsHandlers:addColumnsToData</option> </options> </options> </component> </div> </div> </option> </options> </options> <options name="mainArea" type="array"> <options> <option name="id">ListGroup</option> <option name="content"> <component data-component="SBIS3.EDO.'+n(e(o.typeName))+'Contracts"> <option name="docType">'+n(e(o.docType))+'</option> <option name="typeName">'+n(e(o.typeName))+'</option> <option name="useAutoRefresh">true</option> <opts name="partialReloader"> ',o.fixServerChannelName&&(p+=' <opt name="fixServerChannelName" value="'+n(e(o.fixServerChannelName))+'"/> '),p+=' <opt name="onCreateModelHandlingEnable" value="true"/> <opt name="onDestroyModelHandlingEnable" value="true"/> </opts> </component> </option> </options> </options> <options name="tabs" type="array"> <options> <option name="id">ListTab</option> <option name="mainArea">ListGroup</option> <option name="tabsArea">aGroup</option> <option name="title">'+n(e(rk("Список")))+'</option> </options> </options> <option name="defaultTab">ListTab</option> <options name="handlers"> <option name="onTabChange" type="function">js!SBIS3.EDO.EdoCommon:onTabChangeNewRegistry</option> <option name="onTabAndMainLoaded" type="function">js!SBIS3.EDO.'+n(e(o.typeName))+"ContractTab:prototype.onTabAndMainLoaded</option> </options> </component> </div>",(p=n(p))+(i&&-1!==p.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.ContractTabTemplate"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.Contracts", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".event_date .datecol_small .datecol_date{color:#000;font-size:14px;vertical-align:top!important;text-align:right!important}.pereh_col .no_icon{padding-left:0}.ContractsBrowser .edo-Browser .controls-Browser__view table.controls-DataGridView__table{table-layout:fixed}.Contracts .inOutDoc_responsible{max-width:160px}#contentArea{height:100%}.ContractsTabs{height:100%}.ws-is-firefox .ContractsTabs,.ws-is-ie .ContractsTabs{height:calc(100% - 30px)}.ws-is-chrome .AllContractTabBrArea,.ws-is-chrome div[sbisname=\"SBIS3.EDO.AllContractTab\"],.ws-is-desktop-safari div[sbisname=\"SBIS3.EDO.AllContractTab\"],.ws-is-mobile-safari div[sbisname=\"SBIS3.EDO.AllContractTab\"]{height:calc(100% - 34px)!important}"));head.appendChild(style);});}
define('js!SBIS3.EDO.ContractTabTemplate',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.ContractTabTemplate','js!SBIS3.EDO.EdoCommon','css!SBIS3.EDO.Contracts','js!SBIS3.Engine.BrowserTabs','js!SBIS3.EDO2.RulesSelector','SBIS3.CONTROLS/Menu/MenuButton','js!SBIS3.EDO.LoadButton','js!SBIS3.EDO2.ExportButton','js!SBIS3.EDO.ContractsHandlers','js!SBIS3.EDO.StatFuncs','Elektronnyj_dokumentooborot_localization'],function(t,n,o){'use strict';var a=t.extend({_dotTplFn:n,$protected:{},$constructor:function(){},init:function(){a.superclass.init.call(this);},onTabAndMainLoaded:function(t,n,a){if('ListTab'===n)o.initTaskButtons({mainObject:this.getCurrentTabArea('main'),tabsObject:this.getCurrentTabArea('tabs'),btnDocName:'addDocumentMenuButton'+a,brwName:a+'ContractsBrowser',actionName:a+'ContractsAction',dialogComponents:{'904203de-34b9-411d-bd05-e51e6b91ab40':'js!SBIS3.EDO.FContractOut','635f32d6-974d-4096-935a-44822f8672d0':'js!SBIS3.EDO.FContractIn'}});var e=this.hasChildControlByName(a+'ContractsBrowser')&&this.getChildControlByName(a+'ContractsBrowser');o.initScopes(e);}});return a;});
define('js!SBIS3.EDO.AllContractTab',['js!SBIS3.EDO.ContractTabTemplate','js!SBIS3.EDO.AllContracts','js!SBIS3.Engine.BrowserTabs','Elektronnyj_dokumentooborot_localization'],function(n){'use strict';var t=n.extend({$protected:{_options:{typeName:'All',docType:'ДоговорДок',fixServerChannelName:'edo.task-fix'}},$constructor:function(){},init:function(){t.superclass.init.call(this);},onTabAndMainLoaded:function(){return n.prototype.onTabAndMainLoaded.apply(this,[].slice.call(arguments).concat(['All']));}});return t;});
define('js!SBIS3.EDO.IncomingContractTab',['js!SBIS3.EDO.ContractTabTemplate','js!SBIS3.EDO.IncomingContracts','js!SBIS3.EDO.StatIncoming','Elektronnyj_dokumentooborot_localization'],function(n){'use strict';var t=n.extend({$protected:{_options:{typeName:'Incoming',docType:'ДоговорДок',docRegistryType:'ДоговорВх',fixServerChannelName:'edo.task-fix'}},$constructor:function(){},init:function(){t.superclass.init.call(this);},onTabAndMainLoaded:function(){return n.prototype.onTabAndMainLoaded.apply(this,[].slice.call(arguments).concat(['Incoming']));}});return t;});
define('js!SBIS3.EDO.OutgoingContractTab',['js!SBIS3.EDO.ContractTabTemplate','js!SBIS3.EDO.OutgoingContracts','js!SBIS3.EDO.StatOutgoing','Elektronnyj_dokumentooborot_localization'],function(t){'use strict';var n=t.extend({$protected:{_options:{typeName:'Outgoing',docType:'ДоговорДок',docRegistryType:'ДоговорИсх',fixServerChannelName:''}},$constructor:function(){},init:function(){n.superclass.init.call(this);},onTabAndMainLoaded:function(){return t.prototype.onTabAndMainLoaded.apply(this,[].slice.call(arguments).concat(['Outgoing']));}});return n;});
define('js!SBIS3.EDO.DocHandlers',['WS.Data/Source/SbisService','Elektronnyj_dokumentooborot_localization'],function(e){'use strict';var t;return t={setProcessingAutocompletion:function(t,i,s,n){var o=t.getChildControlByName('browserSearch'),r=t.getChildControlByName(i).getView(),a=false,f;if(void 0===n)n='ФильтрИзСписка';if(o&&r){if(!s)o.subscribe('onListReady',function(t,i){i.setDataSource(new e({endpoint:'Контрагент',idProperty:'НазваниеИНН',binding:{query:'СписокНашихПоИНН'}}),false);});o.subscribe('onListItemSelect',function(e,t,i){a=true,f=t.get('Название');}),o.subscribe('onReset',function(e){var t=r.getFilter();a=false,t[n]='Нет',r.setFilter(t,false);}),o.subscribe('onSearch',function(e,t){var i=r.getFilter();if(a){if(i[n]='Да',r.setFilter(i,false),a=false,f)o.setText(f),r.setHighlightText(f);}else i[n]='Нет',r.setFilter(i,false);});}},onBeforeDataLoadCompaniesTab:function(e,t){if(t.usePages)t['Источник']=1;},onBeforeDataLoadPeopleTab:function(e,t){if(t.usePages)t['сущности']=['физлица'];}};});
define("html!SBIS3.EDO.IncomingEventTab",function(){var o=function(o){var n=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;o.test(n);)n=n.replace(o,"&#123;&#123;$1&#125;&#125;");return n}}(),t=function(o){return o.join?o.join(""):o.toString()},e=function(o){return void 0===o?"":o&&"object"==typeof o?t(o):""+o},i="undefined"!=typeof process,a=("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),p=function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,r='<div class="ws-flexbox ws-flex-column ws-flex-grow-1 edo-IncomintEventTab_wrapper"> <component data-component="SBIS3.Engine.BrowserTabs" name="IncomingEventsTabs" class="ws-flexbox ws-flex-column ws-flex-grow-1" style="height:100%;"> <options name="tabsArea" type="array"> <options> <option name="id">aGroup</option> <option name="content"> <component data-component="SBIS3.EDO.InOutDocumentButtons" name="InOutDocumentButtons"> <options name="docTypes" type="array"> <option>ДокОтгрВх</option> <option>ФактураВх</option> <option>КоррВх</option> <option>АктСверкиДок</option> <option>ДоговорДок</option> <option>СчетВх</option> </options> <option name="from1C">false</option> <option name="incoming">true</option> <option name="LBdocType">Входящие</option> </component> </option> </options> </options> <options name="mainArea" type="array"> <options> <option name="id">StatGroup</option> <option name="content">  <component name="КомпонентСтатистикиВходящие" data-component="SBIS3.EDO.StatTemplate"> <option name="docType" value="КоррВх"></option> <option name="StatTemplateName" value="ШаблонСтатистики"></option> <option name="template">js!SBIS3.EDO.StatIncomingEvents</option> <option name="needStatPrintBtn">true</option> <option name="className" value="external-statistics-indent"></option> </component>  </option> </options> <options> <option name="id">ListGroup</option> <option name="content"> <component data-component="SBIS3.EDO.IncomingEvents"> <option name="useAutoRefresh">true</option> <opts name="partialReloader"> <opt name="fixServerChannelName" value="edo.task-fix"/> <opt name="onCreateModelHandlingEnable" value="true"/> <opt name="onDestroyModelHandlingEnable" value="true"/> </opts> ';return o.url&&(r+='<option name="url" type="ref">'+n(e(function(o,n){var t=a.randomId();return o[t]=n,t}(p,o.url)))+"</option>"),r+=' </component> </option> </options> </options> <options name="tabs" type="array"> <options> <option name="id">StatTab</option> <option name="title">'+n(e(rk("Статистика")))+'</option> <option name="mainArea">StatGroup</option> </options> <options> <option name="id">ListTab</option> <option name="mainArea">ListGroup</option> <option name="tabsArea">aGroup</option> <option name="title">'+n(e(rk("Список")))+'</option> </options> </options> <option name="defaultTab">ListTab</option> <options name="handlers"> <option name="onTabChange" type="function">js!SBIS3.EDO.EdoCommon:onTabChangeNewRegistry</option> <option name="onTabAndMainLoaded" type="function">js!SBIS3.EDO.IncomingEventTab:prototype.onTabAndMainLoaded</option> </options> </component> </div>',(r=n(r))+(i&&-1!==r.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.IncomingEventTab"}},o});
define("html!SBIS3.EDO.IncomingEvents",function(){var o=function(o){var e=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(e){for(;o.test(e);)e=e.replace(o,"&#123;&#123;$1&#125;&#125;");return e}}(),n=function(o){return o.join?o.join(""):o.toString()},t=function(o){return void 0===o?"":o&&"object"==typeof o?n(o):""+o},i="undefined"!=typeof process,p=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,""),a=o.url,r=!(!a||!a.filterState),s={undeveloped:10,clear:-1},l=a?s[a.filterState]||-1:-1,m=global.requirejs("Core/UserConfig");return r&&m.removeParam("IncomingEvents1"),p+=' <div class="ws-flexbox ws-flex-column ws-flex-grow-1" style="height:100%;"> <component data-component="SBIS3.EDO2.Browser" name="IncomingEventsBrowser" class="IncomingEventsBrowser ws-flexbox ws-flex-column ws-flex-grow-1" style="height:100%;"> <option name="searchConfig"> '+e(t(o.autocompleteTemplate.apply(this,[o])))+' </option> <options name="ignoreFiltersList" type="array"> <option>ФильтрИзСписка</option> </options> <options name="hierarchy"> <option name="hierarchy">false</option> </options> <option name="breadCrumbsConfig" type="array"> <option name="visible" value="false" type="boolean"></option> </option> <option name="historyId">IncomingEvents1</option> <option name="useScope">true</option> <option name="backButtonEditing">true</option> <option name="isSingleTypeBrowser">false</option> <options name="browserOptions"> <option name="bind">incomingEventsFilter/button</option> <options name="common"> <option name="objectName">РеестрВходящих</option> <option name="method">СписокСобытий</option> <option name="destroyMethod">Удалить</option> <option name="viewMode">table</option> <option name="model">'+e(t(o.model||"DocsInOutModel"))+"</option> ",r&&(p+=' <options name="filterParams"> <option name="ФильтрСостояние" value="'+e(t(l))+'"></option> </options> <option name="firstRequest" type="boolean">false</option> '),p+=' </options> <option name="infiniteScroll">down</option> <option name="pageSize">25</option> <option name="viewMode">table</option> <option name="idProperty">@Событие</option> <option name="showHead">false</option> <options name="columns" type="array"> <options> <option name="cellTemplate">tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TDocDateTimeColumn</option> <options name="includedTemplates"> <option name="DateNumberColumn">tmpl!SBIS3.EDO2.Browser/resources/columns/tmpl/DateNumberColumn</option> </options> <option name="width">1</option> </options> <options> <option name="cellTemplate">html!SBIS3.EDO2.Browser/resources/columns/MainInfoColumn</option> </options> <options> <option name="cellTemplate">html!SBIS3.EDO2.Browser/resources/columns/StateColumn</option> <option name="width">1</option> </options> <options> <option name="cellTemplate">html!SBIS3.EDO2.Browser/resources/columns/ResponsibleColumn</option> <option name="width">1</option> </options> </options> <options name="ladder" type="array"> <option>date_col</option> </options> <options name="handlers"> ',r&&(p+=' <options name="onReady" type="array"> <option name="onReady" type="function">js!SBIS3.EDO.IncomingEvents:prototype.onReady</option> </options> '),p+=' <options name="onItemClick" type="array"> <option name="onItemClick" type="function">js!SBIS3.EDO.EdoClicks:clickDispPartialReloaderSetCookie</option> </options> <options name="onChangeHoveredItem" type="array"> <option name="onChangeHoveredItem" type="function">js!SBIS3.EDO.EdoRecOptions:onChangeHoveredItemEvents</option> </options> </options> <options name="itemsActionsVisibility"> <option name="edoSaveDocumentOnDisk" value="false"></option> <option name="edoSendDocument" value="false"></option> <option name="edoOpenInNewTab" value="false"></option> <option name="edoDeleteDocument" value="false"></option> <option name="edoShowDkPanel" value="false"></option> <option name="edoPostDocument" value="false"></option> <option name="edoRestoreDocument" value="false"></option> </options> <options name="massActionsVisibility"> <option name="edoDeleteDocumentMass" value="false"></option> <option name="edoRestoreDocumentMass" value="false"></option> </options> <options name="itemsActions" type="array"> <options> <option name="icon">sprite:icon-16 icon-Erase icon-error</option> <option name="name">edoDeleteDocument</option> <option name="tooltip">'+e(t(rk("Удалить")))+'</option> <option name="caption">'+e(t(rk("Удалить")))+'</option> <option name="isMainAction">false</option> <option name="onActivated" type="function">js!SBIS3.EDO.EdoRecOptions:deleteRecordToTrashNew</option> </options> <options> <option name="icon">sprite:icon-16 icon-Restore icon-done</option> <option name="name">edoRestoreRedaction</option> <option name="tooltip">'+e(t(rk("Восстановить")))+'</option> <option name="caption">'+e(t(rk("Восстановить")))+'</option> <option name="isMainAction">false</option> <option name="onActivated" type="function">js!SBIS3.EDO.EdoRecOptions:restoreRecordFromTrash</option> </options> </options> </options> <option name="filterButtonConfig"> <option name="template">js!SBIS3.EDO.FilterIncomingNew</option> <option name="additionalFilterParamsTemplate">js!SBIS3.EDO.FilterIncomingNewSelector</option> <options name="filterStructure" type="array"> '+e(t(o.periodStructure({browserBind:o.browserBind})))+' <opts> <opt name="internalValueField">FilterState</opt> <opt name="internalCaptionField">FilterStateText</opt> <opt name="value" bind="incomingEventsFilter/button/ФильтрСостояние"></opt> <opt name="caption" bind="incomingEventsFilter/caption/ФильтрСостояние"></opt> <opt name="resetValue" type="string">-1</opt> <opt name="itemTemplate" type="null">null</opt> </opts> <opts> <opt name="internalValueField">FilterOurOrganisation</opt> <opt name="internalCaptionField">FilterOurOrganisationText</opt> <opt name="value" bind="incomingEventsFilter/button/ФильтрДокументНашаОрганизация"></opt> <opt name="caption" bind="incomingEventsFilter/caption/ФильтрДокументНашаОрганизация"></opt> <opts name="resetValue" type="array"></opts> <opt name="itemTemplate" type="function" value="tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterOurOrg"/> <opt name="historyItemTemplate" type="function" value="tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterOurOrg"/> </opts> '+e(t(o.MarksStructure({browserBind:o.browserBind})))+" "+e(t(o.ResponsibleFaceStructure({browserBind:o.browserBind})))+" "+e(t(o.Face1Structure({browserBind:o.browserBind})))+" "+e(t(o.RegulationStructure({browserBind:o.browserBind})))+" "+e(t(o.AuthorOrResponsibleMeStructure({browserBind:o.browserBind,captionBind:"incomingEventsFilter/caption/ФильтрВладелец"})))+" "+e(t(o.UnreadStructure({browserBind:o.browserBind})))+" "+e(t(o.UnfixedStructure({browserBind:o.browserBind})))+" "+e(t(o.SpecificPerformerStructure({browserBind:o.browserBind})))+" "+e(t(o.DocumentTypeStructure({browserBind:o.browserBind,captionBind:"incomingEventsFilter/caption/ФильтрТипДокументаВД"})))+' </options> </option> <option name="fastDataFilterConfig"> <opt name="className">edo-tasks__fastDataFilter</opt> <opt name="idProperty" value="name"></opt> <options name="filterStructure" type="array"> <opts> <opt name="internalValueField">FilterAuthorOrResponsibleMe</opt> <opt name="internalCaptionField">FilterAuthorOrResponsibleMeText</opt> <opt name="value" bind="incomingEventsFilter/button/ФильтрВладелец"></opt> <opt name="caption" bind="incomingEventsFilter/caption/ФильтрВладелец"></opt> <opt name="resetValue">Все</opt> </opts> <opts> <opt name="internalValueField">FilterState</opt> <opt name="internalCaptionField">FilterStateText</opt> <opt name="value" bind="incomingEventsFilter/button/ФильтрСостояние"></opt> <opt name="caption" bind="incomingEventsFilter/caption/ФильтрСостояние"></opt> <opt name="resetValue" type="string">-1</opt> </opts> <opts> <opt name="internalValueField">FilterDocType</opt> <opt name="internalCaptionField">FilterDocTypeText</opt> <opt name="value" bind="incomingEventsFilter/button/ТипДокументаВД"></opt> <opt name="caption" bind="incomingEventsFilter/caption/ФильтрТипДокументаВД"></opt> <opt name="pickerClassName">controls-DropdownList__picker inc_events</opt> <opt name="allowDblClick" type="boolean">false</opt> <options name="resetValue" type="array"> <option type="string">Все</option> </options> </opts> </options> </option> <option name="operationsPanelConfig"> <options name="items" type="array"> <options> <option name="name">print</option> <option name="componentType">js!SBIS3.EDO.OperationPrint</option> <options name="type"> <option name="mass">true</option> <option name="selection" type="boolean">true</option> </options> <options name="options"> <option name="documentIdField">@Документ</option> <options name="items" type="array"> <options> <option name="id">filtered</option> <option name="title">'+e(t(rk("Фактуры, накладные, акты")))+'</option> <option name="onActivated" type="function">js!SBIS3.EDO.OperationPrint:prototype.filteredPrint</option> </options> <options> <option name="id">files_print</option> <option name="title">'+e(t(rk("Все документы")))+'</option> <option name="onActivated" type="function">js!SBIS3.EDO.OperationPrint:prototype.filesPrint</option> </options> </options> <option name="minPrintWindowWidth">666</option> <option name="exportDocuments" type="boolean">true</option> <option name="xsl" value="Электронный документооборот/Реестры/xslt/reestr_events_new.xsl"></option> <option name="filteredObjectName">ДокОтгрВх</option> <option name="filteredMethodName">ПечатьВложенийСФильтром</option> <options name="handlers"> <option name="onApplyOperation" type="function">js!SBIS3.EDO.EdoOperationsCommon:documentsPreparePrintColumns</option> </options> </options> </options> <options> <option name="name">edoDeleteRedactionMass</option> <option name="componentType">js!SBIS3.EDO.OperationDelete</option> <options name="type"> <option name="selection" type="boolean">true</option> </options> <options name="options"> <option name="registryMode">events</option> </options> </options> <options> <option name="name">btnRestoreDocs</option> <option name="componentType">js!SBIS3.EDO.OperationRestore</option> <options name="type"> <option name="selection" type="boolean">true</option> </options> </options> </options> </option> </component> <component data-component="SBIS3.EDO2.OpenDialogAction" name="action"> <option name="name">IncomingEventsAction</option> <option name="editMode">newFloatArea</option> <option name="isDocsReestr">true</option> </component> ',!0===o.useAutoRefresh&&(p+=' <component data-component="SBIS3.EDO.FEdoPartialReloader" name="PartialReloader"> <opt name="objectName" value="'+e(t(o.objectName||"РеестрВходящих"))+'"/> <opt name="method" value="'+e(t(o.method||"СписокСобытий"))+'"/> <opt name="filterName" value="'+e(t(o.partialReloader.filterName||"СписокИдО"))+'"/> <opt name="sortField" value="'+e(t(o.partialReloader.sortField||"Начало"))+'"/> <opt name="overrideItemsSortMethod" value="true"/> <opt name="updateOnDeleteAndAdd" value="'+e(t(o.partialReloader.updateOnDeleteAndAdd||"false"))+'"/> <opt name="addServerChannelName" value="'+e(t(o.partialReloader.addServerChannelName||""))+'"/> <opt name="fixServerChannelName" value="'+e(t(o.partialReloader.fixServerChannelName||""))+'"/> <opt name="deleteServerChannelName" value="'+e(t(o.partialReloader.deleteServerChannelName||""))+'"/> <opts name="actionEventsToListen" type="array"> <opt value="onUpdateModel"/> ',o.partialReloader.onDestroyModelHandlingEnable&&(p+=' <opt value="onDestroyModel"/> '),p+=" ",o.partialReloader.onCreateModelHandlingEnable&&(p+=' <opt value="onCreateModel"/> '),p+=' </opts> <opt name="edoOpenDialogAction" value="IncomingEventsAction"/> <opt name="registryKeyFromCookie" value="PartialReloader_CurrentEvent"/> </component> '),p+=" </div>",(p=e(p))+(i&&-1!==p.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.IncomingEvents"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.IncomingEvents", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".event_date .datecol_small .datecol_date{color:#000;font-size:14px;vertical-align:top!important;text-align:right!important}.event_date .datecol_small .datecol_time{color:#ccc!important}.controls-DropdownList__picker .inc_events .controls-ListView__defaultItem{display:none}.pereh_col .no_icon{padding-left:0}.ws-is-mobile-platform .controls-Browser__filterButton{max-width:160px!important}.IncomingEventsBrowser .datecol_small{padding-top:1px}.IncomingEventsBrowser .edo-DateCol_icon_unread{position:absolute;margin-top:-17px;margin-left:5px}#contentArea{height:100%}"));head.appendChild(style);});}
define('js!SBIS3.EDO.IncomingEvents',['Core/Deferred','SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.IncomingEvents','WS.Data/Source/SbisService','js!SBIS3.EDO.AutocompleteHandlers','tmpl!SBIS3.EDO.BaseFilter.Period/resources/PeriodStructure','tmpl!SBIS3.EDO.BaseFilter.Marks/resources/MarksStructure','tmpl!SBIS3.EDO.BaseFilter.ResponsibleFace/resources/ResponsibleFaceStructure','tmpl!SBIS3.EDO.BaseFilter.AuthorOrResponsibleMe/resources/AuthorOrResponsibleMeStructure','tmpl!SBIS3.EDO.BaseFilter.Face1/resources/Face1Structure','tmpl!SBIS3.EDO.BaseFilter.Regulation/resources/RegulationStructure','tmpl!SBIS3.EDO.BaseFilter.Unfixed/resources/UnfixedStructure','tmpl!SBIS3.EDO.BaseFilter.Unread/resources/UnreadStructure','tmpl!SBIS3.EDO.BaseFilter.SpecificPerformer/resources/SpecificPerformerStructure','tmpl!SBIS3.EDO.BaseFilter.OurOrganisation/resources/OurOrganisationStructure','tmpl!SBIS3.EDO.BaseFilter.DocumentType/resources/DocumentTypeStructure','css!SBIS3.EDO.IncomingEvents','js!SBIS3.EDO2.Browser','html!SBIS3.EDO2.Browser/resources/columns/ResponsibleColumn','js!SBIS3.EDO.DocDateCol','js!SBIS3.EDO.DateCol','html!SBIS3.EDO2.Browser/resources/columns/StateColumn','html!SBIS3.EDO2.Browser/resources/columns/MainInfoColumn','tmpl!SBIS3.EDO2.Browser/resources/columns/tmpl/DateNumberColumn','tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TDocDateTimeColumn','js!SBIS3.EDO2.OpenDialogAction','js!SBIS3.EDO.FEdoPartialReloader','js!SBIS3.EDO.EdoRecOptions','js!SBIS3.EDO.EdoOperationsCommon','js!SBIS3.EDO.EdoClicks','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterResp','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterEventPerformer','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterStateListItem','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterFace1','js!SBIS3.EDO2.MarksFilterRowTemplate','js!SBIS3.EDO.OperationPrint','Core/UserConfig','js!SBIS3.EDO.DocsInOutModel','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterOurOrg','Elektronnyj_dokumentooborot_localization'],function(e,t,r,o,s,i,l,n,a,c,u,S,m,p,d,B){'use strict';var D=t.extend({_dotTplFn:r,$protected:{_options:{autocompleteTemplate:s.autocompleteTemplate,fastDataFilterConfig:{data:[{keyField:'key',displayField:'title',name:'FilterAuthorOrResponsibleMe',multiselect:false,className:'controls-DropdownList__withoutCross controls-DropdownList__linkStyle',values:[{key:'Все',value:'Все',title:rk('Все')},{key:'От меня',value:'От меня',title:rk('Мои')},{key:'От моего отдела',value:'От моего отдела',title:rk('Моего отдела')}]},{keyField:'key',displayField:'title',name:'FilterState',multiselect:false,className:'controls-DropdownList controls-DropdownList__linkStyle',values:[{key:'-1',title:rk('В любом состоянии')},{key:'10',title:rk('Внутренняя обработка')},{key:'7',title:rk('Утвержденные')},{key:'9',title:rk('Отклоненные')},{key:'22',title:rk('Аннулированные')},{key:'19,20',title:rk('Удалено мной/контрагентом')},{key:'0,1',title:rk('Черновики')},{key:'-2',title:rk('Удаленные')}]},{keyField:'ТипДокументаВД',displayField:'Название',name:'FilterDocType',multiselect:true,className:'controls-DropdownList__withoutCross controls-DropdownList__linkStyle',values:[{'ТипДокументаВД':'Все','Название':rk('Все типы документов')},{'ТипДокументаВД':'АктВР,АктПП','Название':rk('Акты (услуги, работы, права)')},{'ТипДокументаВД':'ЭДОНакл','Название':rk('Накладные')},{'ТипДокументаВД':'СчФктр,УпдСчфДоп','Название':rk('Счета-фактуры (вкл. в составе УПД)')},{'ТипДокументаВД':'УпдДоп','Название':rk('Передаточные документы')},{'ТипДокументаВД':'счФактКор','Название':rk('Счета-фактуры корректировочные')},{'ТипДокументаВД':'АктСвер','Название':rk('Акты сверки')},{'ТипДокументаВД':'Договор','Название':rk('Договоры')},{'ТипДокументаВД':'ЭДОСч','Название':rk('Счета')}]}]},browserBind:'incomingEventsFilter/button',periodStructure:i,MarksStructure:l,ResponsibleFaceStructure:n,AuthorOrResponsibleMeStructure:a,Face1Structure:c,RegulationStructure:u,UnfixedStructure:S,UnreadStructure:m,SpecificPerformerStructure:p,OurOrganisationStructure:d,DocumentTypeStructure:B}},$constructor:function(){},init:function(){D.superclass.init.call(this);var t=this,r=this.getChildControlByName('IncomingEventsBrowser'),o=this.getChildControlByName('browserFastDataFilter'),i=this.getChildControlByName('browserFilterButton');if(o)o.setItems(this._options.fastDataFilterConfig.data);if(o)o.subscribe('onApplyFilter',function(){var e=this.getFilterStructure()[2];if('FilterDocType'==e.internalValueField){var t=e.value;if(t&&'object'==typeof t&&t.length>0&&'Все'==t[0])if(i&&i._picker)i._picker.getChildControlByName('EDOFilter').getLinkedContext().setValue('FilterDocTypeShow',false);}});if(s.setProcessingAutocompletion(t),r.subscribeTo(r,'onStartCommand',function(e,t){if('edoCopyDocument'===t.commandName)t.args[0].createStartEvent=true;}),this.hasChildControlByName('IncomingEventsBrowser'))(r=this.getChildControlByName('IncomingEventsBrowser')).subscribe('onStartSending',function(t,r){var o=new e();if(t.setResult(o),r.docRecord&&r.docRecord.has('ТипДокумента.ТипДокумента')&&'АктСверВх'===r.docRecord.get('ТипДокумента.ТипДокумента'))require(['js!SBIS3.EDO.ReconciliationReportsHandlers'],function(e){e.processPassage(r,o);});else o.callback();});},onReady:function(e){var t=this,r=this.getFilter(),s=this.getParent().getParent(),i=s.getParent()._options.url,l={undeveloped:10,clear:-1},n=new o({endpoint:s._options.browserOptions.common.objectName,binding:{query:s._options.browserOptions.common.method,destroy:s._options.browserOptions.common.destroyMethod},model:s._options.browserOptions.common.model}),a;if(i&&i.filterState)a=l[i.filterState]||-1,r['ФильтрСостояние']=a,s._options['applyHistoryFilterOnLoad']=false,s.setViewDataSource(n,null,r),t.setFilter(r);}});return D;});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.IncomingEventTab", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-IncomintEventTab_wrapper{height:100%;min-height:1px}.ws-is-firefox.ws-is-desktop-platform .edo-IncomintEventTab_wrapper,.ws-is-ie.ws-is-desktop-platform .edo-IncomintEventTab_wrapper{height:calc(100% - 34px)}"));head.appendChild(style);});}
define('js!SBIS3.EDO.IncomingEventTab',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.IncomingEventTab','js!SBIS3.EDO.EdoCommon','WS.Data/Source/SbisService','js!SBIS3.EDO.InOutDocumentButtons','js!SBIS3.EDO.IncomingEvents','js!SBIS3.Engine.BrowserTabs','js!SBIS3.EDO.EdoOperationsCommon','css!SBIS3.EDO.IncomingEventTab','Elektronnyj_dokumentooborot_localization'],function(t,n,o,e){'use strict';var a=t.extend({_dotTplFn:n,$protected:{_options:{url:null}},$constructor:function(){},init:function(){a.superclass.init.call(this);var t=this;new e({endpoint:'ГлобальныеПараметрыКлиента'}).call('ПолучитьЗначение',{'Путь':'unit_contracts_converted'}).addCallback(function(n){if('true'!==n.getRawData()){for(var o=t.getChildControlByName('InOutDocumentButtons').getChildControlByName('addDocumentButton'),e=o._options.docTypes,a=0;a<e.length;a++)if('ДоговорДок'===e[a].docType)e[a].docType='ДоговорВх';o.setDocTypes(e);}}),new e({endpoint:'ГлобальныеПараметрыКлиента'}).call('ПолучитьЗначение',{'Путь':'unit_reconciliations_converted'}).addCallback(function(n){if('true'!==n.getRawData()){for(var o=t.getChildControlByName('InOutDocumentButtons').getChildControlByName('addDocumentButton'),e=o._options.docTypes,a=0;a<e.length;a++)if('АктСверкиДок'===e[a].docType)e[a].docType='АктСверВх';o.setDocTypes(e);}});},onTabAndMainLoaded:function(t,n){if('StatTab'!=n)o.initTaskButtons({mainObject:this.getCurrentTabArea('main'),tabsObject:this.getCurrentTabArea('tabs'),btnDocName:'addDocumentButton',brwName:'IncomingEventsBrowser',actionName:'IncomingEventsAction',folderButtonName:null,rootFolderName:null,folderAction:null,dialogComponents:{'bc5f60fd-2633-45e0-a817-41a89910d074':'js!SBIS3.EDO.ReconciliationReportIn','534888e6-8c29-4c11-9530-774d485b639b':'js!SBIS3.EDO.ReconciliationReportIn','635f32d6-974d-4096-935a-44822f8672d0':'js!SBIS3.EDO.FContractIn','904203de-34b9-411d-bd05-e51e6b91ab40':'js!SBIS3.EDO.FContractOut','fdbbfd83-64f6-4ae1-9761-625b114ec4bd':'js!SBIS3.EDO.ReconciliationReportOut'}});}});return a;});
define("html!SBIS3.EDO.LinkAnswerColumn",function(){var n=function(n){var o,e,t,r=function(){var n=/\{\{([\s\S]+?)\}\}/g;return function(o){for(;n.test(o);)o=o.replace(n,"&#123;&#123;$1&#125;&#125;");return o}}(),i=function(n){return n.join?n.join(""):n.toString()},a=function(n){return void 0===n?"":n&&"object"==typeof n?i(n):""+n},s="undefined"!=typeof process,p=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,""),u=n.item.get("Ответ")||!1;return u&&(o=u.get("doc_sled"),(e=u.get("doc_date"))&&(t=("0"+e.getDate()).slice(-2)+"."+("0"+(e.getMonth()+1)).slice(-2))),p+=" ",e&&(p+=' <component data-component="SBIS3.CONTROLS/Link"> <option name="caption">Ответ '+r(a(t))+'</option> <options name="paramsObj"> <option name="answer_id">'+r(a(o))+'</option> </options> <options name="handlers"> <options name="onActivated" type="array"> <option type="function">js!SBIS3.EDO.LinkAnswerColumn:prototype.OnAnswerClick</option> </options> </options> </component> '),(p=r(p))+(s&&-1!==p.indexOf("{{")?String.fromCharCode(8203,8203):"")};return n.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.LinkAnswerColumn"}},n});
define('js!SBIS3.EDO.LinkAnswerColumn',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.LinkAnswerColumn','js!SBIS3.EDO2.OpenDialogAction','SBIS3.CONTROLS/Link','Elektronnyj_dokumentooborot_localization'],function(n,t,i){'use strict';var e=n.extend({_dotTplFn:t,$protected:{_options:{name:'LinkAnswerColumn'}},$constructor:function(){},init:function(){var n=this;e.superclass.init.call(n);},OnAnswerClick:function(n){var t=n.getTarget()._options.paramsObj,e=new i.prototype.$constructor();if(t)e.execute({id:t.answer_id,initializingWay:'delayRemote'});}});return e;});
define("html!SBIS3.EDO.IncomingLetter",function(){var o=function(o){var n=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;o.test(n);)n=n.replace(o,"&#123;&#123;$1&#125;&#125;");return n}}(),e=function(o){return o.join?o.join(""):o.toString()},t=function(o){return void 0===o?"":o&&"object"==typeof o?e(o):""+o},a="undefined"!=typeof process,i=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="edo-IncomingLetter"> <component data-component="SBIS3.EDO2.Dialog" name=\'IncomingLetterDialog\'> <option name="objectName">'+n(t(o.objectName))+'</option> <option name="stickyHeader">true</option> <options name="fullTrace"> <option name="showToolbar">false</option> </options> <opt name="firstLineContent"> <div class="edo-IncomingLetter_align-right edo-IncomingLetter__ourCompany-container"> <component data-component="SBIS3.Contragents.ChoiceOurCompanyLink"> <options name="componentOptions"> <opt name="ShowInnerCompany" value="true"></opt> <opt name="ourCompany" value="false"></opt> <opts name="ScopesAreas" type="array"> <opt value="'+n(t(o.scopeArea))+'"/> </opts> <opt name="ShowAllCompany" value="false"></opt> <opt name="withAffiliates" value="true"></opt> <option name="openCardCompany" bind="record/isOpenCardCompany" type="boolean"></option> </options> <opt name="multiselect" value="false"></opt> <opt name="className" value="edo-IncomingLetter__ourCompany controls-SelectorButton__asLink"></opt> <opt name="enabled">true</opt> <opt name="allowChangeEnable">false</opt> <opt name="idProperty" value="@Лицо"></opt> <options name="selectedItem"> <option name="@Лицо" bind="record/ДокументНашаОрганизация"></option> <option name="Название" bind="record/ДокументНашаОрганизация.Контрагент.Название"></option> </options> </component> </div> </opt> <options name="tabs" type="array"> <options> <option name="className">controls-TabButton__main-item</option> <option name="id">firstTab</option> <option name="title"> <component data-component=\'SBIS3.EDO2.MainTabHeader\'> <option name=\'docType\'>'+n(t(o.objectName))+'</option> </component> </option> <option name="content"> <div class="edo-IncomingLetter__header"> <div class="edo-IncomingLetter__addresseeChoice-container"> <component data-component="SBIS3.CONTROLS/Link" name="IncomingLetterLink" class="edo-IncomingLetter__addresseeChoice-link"> <option name="caption">'+n(t(rk("Отправитель")))+'</option> <option name="tabindex">0</option> </component> <component data-component="SBIS3.AddresseeChoice.FieldLink" name="IncomingLetterFieldLink" class="edo-IncomingLetter_fieldLink ws-autofocus"> <option name="contacts">false</option> <options name="selectedItem" nonExistentValue="{}"> <option name="@Лицо" bind="record/Лицо1"></option> <option name="Название" bind="record/Лицо1.Название"></option> </options> <option name="placeholder">'+n(t(rk("Название контрагента или ИНН")))+'</option> <option name="allowContragentChoice">true</option> <option name="representativeChoice">false</option> <option name="multiselect">false</option> <option name="favoritesOnly">false</option> <option name="tabindex">1</option> <option name="autoShow">false</option> <options name="validators" type="array"> <options> <option name="errorMessage" value="'+n(t(o.placeholderCaption))+'"/> <option name="validator" type="function">SBIS3.CONTROLS/Utils/ControlsValidators:required</option> <option name="option" value="selectedKeys"/> </options> </options> </component> </div> <div class="edo-IncomingLetter__header-rightSide"> <component data-component="SBIS3.EDO.LetterDetails"> <option name="showRespondButton" type="boolean" value="'+n(t("КоррВх"==o.objectName))+'"></option> <option name="tabindex">0</option> </component> <component data-component="SBIS3.EDO2.Sticker" class="edo-IncomingLetter__sticker" name="IncomingLetterSticker"> <option name="mayDeleteResponsible">false</option> <option name="showContractorInfo">true</option> <option name="mini">false</option> <option name="tabindex">0</option> </component> </div> </div> <div> <component data-component="SBIS3.EDO.LetterEditor"> <option name="name" value="ДокументРасширение.Название_editor"></option> </component> </div> <div class="IncomingLetter__Attach_container"> <div class="IncomingLetter_attach_item Report__Attach_file"> <component data-component="SBIS3.EDO2.AttachButton" name="AttachTo"> <option name="objectName">'+n(t(o.objectName))+'</option> <option name="canAttachExternalLinks">true</option> </component> </div> <div class="IncomingLetter_attach_item Report__Attach_external"> <component data-component="SBIS3.EDO2.CreateButton" name="CreateAttach"> <option name="objectName">'+n(t(o.objectName))+'</option> </component> </div> </div> <div class="edo-Viewer"> <component data-component="SBIS3.EDO2.Viewer" name="IncomingLetterViewer"> </component> </div> </option> </options> </options> <options name="handlers"> <options name="onReady" type="array"> <option type="function">js!SBIS3.EDO.LetterHandlers:onReadyLetterDialog</option> </options> </options> </component> </div> ');return(i=n(i))+(a&&-1!==i.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.IncomingLetter"}},o});
define('js!SBIS3.EDO.LetterHandlers',['WS.Data/Source/SbisService','Core/moduleStubs','Elektronnyj_dokumentooborot_localization'],function(e,t){'use strict';var n;return n={onOrigPlaceMenu:function(){var e=this.getTopParent().getChildControlByName('SelectorButtonLocationOrig'),t=e._options.dictionaries[0];e._getSelectorAction().execute({template:t.template,componentOptions:t.componentOptions||{},multiselect:e.getMultiselect(),selectionType:t.selectionType||'all'});},onDeliveryChange:function(e){var t=this.getChildControlByName('DropdownListDelivery');if(void 0!==e)t.show(),t.setSelectedKeys([e]),this.getLinkedContext().getValue('record').get('ДанныеДокумента.Доставка').set(e);},onReadyLetterDialog:function(e,o){var i=this,o=i.getContext().getValue('record'),l=i.getChildControlByName('DropdownListDelivery');l.subscribe('onSelectedItemsChange',function(e,t){n.onDeliveryCtrlChange.call(l,e,t);}),t.require(['js!SBIS3.Staff.StaffFunction']);},onDeliveryCtrlChange:function(e,t){if(this.getLinkedContext().getValue('record').get('ДанныеДокумента.Доставка').get()!==(null===t[0]?null:parseInt(t[0],10)))this.getLinkedContext().getValue('record').set('ДанныеДокумента.Доставка',t[0]);if(t&&t.length&&null===t[0])this.hide();},onStartSending:function(){new e({endpoint:'КоррИсх'}).call('УстановитьСпособДоставки',{'ИдО':parseInt(this.getLinkedContext().getValue('record').get('@Документ'),10),'Доставка':5});}};});
define("html!SBIS3.EDO.LetterDetails",function(){var e=function(e){var t=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;e.test(t);)t=t.replace(e,"&#123;&#123;$1&#125;&#125;");return t}}(),o=function(e){return e.join?e.join(""):e.toString()},n=function(e){return void 0===e?"":e&&"object"==typeof e?o(e):""+e},a="undefined"!=typeof process,p=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="edo-LetterDetails"> <div class="edo-LetterDetails__dropdownList-container"> <component data-component="SBIS3.CONTROLS/DropdownList" class="edo-LetterDetails__dropdownList" name="DropdownListDelivery"> <opt name="idProperty" value="key"></opt> <opt name="displayProperty" value="title"></opt> <opt name="mode" value="click"></opt> <opt name="multiselect">false</opt> <opt name="visible" bind="record/letterDetails/deliveryList/visible" oneWay="true" nonexistent="false"></opt> <opt name="allowChangeEnable" type="boolean">true</opt> <opt name="emptyValue">true</opt> <opts name="selectedKeys" type="array"> <opt bind="record/letterDetails/deliveryList/selectedKey" oneWay="true"></opt> </opts> <opts name="items" type="array"> <opts> <opt name="key" type="string">0</opt> <opt name="title">'+t(n(rk("Почтой")))+'</opt> </opts> <opts> <opt name="key" type="string">1</opt> <opt name="title">'+t(n(rk("На e-mail")))+'</opt> </opts> <opts> <opt name="key" type="string">2</opt> <opt name="title">'+t(n(rk("Доставка курьером")))+'</opt> </opts> <opts> <opt name="key" type="string">3</opt> <opt name="title">'+t(n(rk("По факсу")))+'</opt> </opts> <opts> <opt name="key" type="string">4</opt> <opt name="title">'+t(n(rk("Телефонограммой")))+'</opt> </opts> <opts> <opt name="key" type="string">5</opt> <opt name="title">'+t(n(rk("Электронно")))+'</opt> </opts> <opts> <opt name="key" type="string">6</opt> <opt name="title">'+t(n(rk("Доставка нашим сотрудником")))+'</opt> </opts> <opts> <opt name="key" type="string">7</opt> <opt name="title">'+t(n(rk("Заказным письмом")))+'</opt> </opts> <opts> <opt name="key" type="string">8</opt> <opt name="title">'+t(n(rk("Ценным письмом")))+'</opt> </opts> <opts> <opt name="key" type="string">10</opt> <opt name="title">'+t(n(rk("Экспресс-почтой")))+'</opt> </opts> </opts> <opts name="handlers"> </opts> </component> </div> <div class="edo-LetterDetails_linkAnswer_wrapper"> <component name="LinkAnswer" data-component="SBIS3.CONTROLS/Link" class="edo-LetterDetails_linkAnswer"> <opt name="allowChangeEnable" type="boolean" value="false"></opt> <opt name="visible" bind="record/letterDetails/linkAnswer/visible" oneWay="true" nonexistent="false"></opt> <opt name="caption" bind="record/letterDetails/linkAnswer/caption" oneWay="true"></opt> <opts name="handlers"> <opt name="onActivated" type="function">js!SBIS3.EDO.LetterDetailsHandlers:onOpenDocumentActivated</opt> </opts> </component> </div> ');return e.showRespondButton&&(p+=" <div class=\"edo-LetterDetails_rulesSelector_wrapper\"> <component data-component='SBIS3.EDO2.RulesSelector'> <opt name='name'>linkRespondRulesSelector</opt> <opt name=\"allowChangeEnable\">false</opt> <opt name=\"visible\" bind=\"record/letterDetails/linkRespond/visible\" oneWay=\"true\" nonexistent=\"false\"></opt> <opts name='docTypes' type='array'> <opts> <opt name='docType'>КоррИсх</opt> </opts> </opts> <opt name='content'> <component data-component='SBIS3.CONTROLS/Menu/MenuLink' class='edo-LetterDetails_menuLink'> <opt name='name'>ruleSelectorMenuLink</opt> <opt name='caption'>"+t(n(rk("Ответить")))+'</opt> <opt name="allowChangeEnable">false</opt> <opt name=\'idProperty\'>id</opt> <opts name="handlers"> <opt name="onMenuItemActivate" type="function">js!SBIS3.EDO.LetterDetailsHandlers:MenuLinkOnMenuItemActivate</opt> </opts> </component> </opt> </component> </div> '),p+=' <div class="edo-LetterDetails_linkCorrList_wrapper"> <component name="LinkCorrList" data-component="SBIS3.CONTROLS/Link" class="edo-LetterDetails_linkCorrList"> <opt name="caption" value="'+t(n(rk("Вся переписка")))+'"></opt> <opt name="visible" bind="record/РП.ЕстьПереписка" oneWay="true" nonexistent="false"></opt> <opt name="allowChangeEnable" type="boolean" value="false"></opt> <opts name="handlers"> <opt name="onActivated" type="function">js!SBIS3.EDO.LetterDetailsHandlers:onShowCorrListActivated</opt> </opts> </component> </div> <component data-component="SBIS3.EDO.LetterRegistrationButton"> <opt name="name">letterRegistrationButton</opt> <opt name="headerTitle">'+t(n(rk("Регистрация у")))+" ",e.showRespondButton?p+=t(n(rk("отправителя"))):p+=t(n(rk("получателя"))),p+='</opt> </component> <div class="edo-LetterDetails_selectorButton_wrapper"> <div class="edo-LetterDetails_selectorButton_Label ws-hidden" data-bind="visible: record/letterDetails/locationOrig/visible">'+t(n(rk("Местонахождение оригинала")))+'</div> <component data-component="SBIS3.CONTROLS/SelectorButton" name="SelectorButtonLocationOrig" class="edo-LetterDetails_selectorButton"> <opt name="allowChangeEnable" type="boolean">false</opt> <opt name="visible" bind="record/letterDetails/locationOrig/visible" oneWay="true" nonexistent="false"></opt> <opts name="selectedKeys" type="array"> <opt bind="record/ДанныеДокумента.Местонахождение"></opt> </opts> <opt name="useSelectorAction" value="true"/> <opts name="dictionaries" type="array"> <opts> <opt name="name">СтруктураПредприятия</opt> <opt name="template">js!SBIS3.Staff.DepartmentChoice.List</opt> <opt name="readOnly" type="boolean">true</opt> <opts name="componentOptions"> <opt name="multiselect" value="false" type="boolean"/> </opts> </opts> </opts> <opt name="idProperty" value="@Лицо"/> <opt name="displayProperty" value="Название"/> <opt name="chooserMode" value="floatArea"></opt> <opt name="multiselect" type="boolean" value="false"></opt> <opts name="handlers"> <opt name="onSelectedItemsChange" type="function" value="js!SBIS3.EDO.LetterDetailsHandlers:onLocationChange"></opt> </opts> <opts name="dataSource"> <opt name="module" value="WS.Data/Source/SbisService"></opt> <opts name="options"> <opts name="endpoint"> <opt name="contract" value="СтруктураПредприятия"></opt> </opts> <opts name="binding"> <opt name="read" value="Прочитать"></opt> </opts> <opt name="idProperty" value="@Лицо"></opt> </opts> </opts> </component> </div> </div>',(p=t(p))+(a&&-1!==p.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.LetterDetails"}},e});
define('js!SBIS3.EDO.LetterDetailsHandlers',['Core/core-attach','WS.Data/Source/SbisService','WS.Data/Entity/Record','Core/Indicator','Core/EventBus','Core/Context','js!SBIS3.EDO2.OpenDialogAction','WS.Data/Adapter/Sbis','Elektronnyj_dokumentooborot_localization'],function(e,t,n,o,a,i,r){'use strict';var l;return l={onAnswerReady:function(){var e=this.getLinkedContext().getValue('record').get('Ответ');if(e&&e.get('Дата'))this.setCaption(rk('Ответ')+' '+e.get('Дата').strftime('%d.%m'));},onOpenDocumentActivated:function(){var e=new r.prototype.$constructor();e.execute({id:parseInt(this.getLinkedContext().getValue('record').get('Ответ').get('@Документ'),10),initializingWay:'delayRemote'}),e.getLinkedContext().setValue('record',this.getLinkedContext().getValue('record')),e.getLinkedContext().setValue('dlg',this.getTopParent()),e.once('onExecuted',l.panel_onClose_handler);},MenuLinkOnMenuItemActivate:function(e,a){var i=this,d=i.getItems().getRecordById(a);if(d&&!d.get('Раздел@')){var s=parseInt(i.getLinkedContext().getValue('record').get('Лицо1'),10),g=d.get('Идентификатор')||'ad2d4160-6303-475d-bf4b-6a7b25459286',c=new n({rawData:{_type:'record',d:[s,true,g],s:[{n:'Лицо1',t:'Число целое'},{n:'ВызовИзБраузера',t:'Логическое'},{n:'ИдРегламента',t:'Строка'}]},adapter:'adapter.sbis'});o.show(),new t({endpoint:'КоррИсх'}).call('Создать',{'ИмяМетода':'КоррИсх.Список','Фильтр':c}).addCallback(function(e){new t({endpoint:'Документ'}).call('СкопироватьВнешниеДокументы',{'ДокументОснование':parseInt(i.getLinkedContext().getValue('record').get('@Документ'),10),'ДокументСледствие':parseInt(e.getRow().get('@Документ'),10),'ВидСвязи':1,'СписокВД':[]}).addCallback(function(){o.hide();var t=new r.prototype.$constructor();t.execute({id:parseInt(e.getRow().get('@Документ'),10),initializingWay:'delayRemote'}),t.getLinkedContext().setValue('record',i.getLinkedContext().getValue('record')),t.getLinkedContext().setValue('dlg',i.getTopParent()),t.once('onExecuted',l.panel_onClose_handler);});}).addErrback(function(){o.hide();});}},panel_onClose_handler:function(e,n){var o=this,i=o.getLinkedContext().getValue('record'),r=i.get('ТипДокумента.ТипДокумента');new t({endpoint:r}).call('Прочитать',{'ИдО':parseInt(i.get('@Документ'),10),'ИмяМетода':r+'.Список'}).addCallback(function(e){var t=e.getRow().get('Ответ'),n=o.getLinkedContext().getValue('dlg'),r=t?t.get('@Документ'):null,l=i.get('Ответ')?i.get('Ответ').get('@Документ'):null;if(n.getChildControlByName('LinkAnswer')[t?'show':'hide'](),n.getChildControlByName('LinkCorrList')[e.getRow().get('РП.ЕстьПереписка')?'show':'hide'](),n.hasChildControlByName('linkRespondRulesSelector'))n.getChildControlByName('linkRespondRulesSelector')[t?'hide':'show']();if(!l&&r||r!==l)if(i.set('Ответ',t),i.set('РП.ЕстьПереписка',e.getRow().get('РП.ЕстьПереписка')),i.acceptChanges(['Ответ','РП.ЕстьПереписка']),a.channel('lettersChannel').notify('onCloseDialogAnswer',i),t)n.getChildControlByName('LinkAnswer').setCaption(rk('Ответ')+' '+t.get('Дата').strftime('%d.%m'));});},onLocationChange:function(e,t){var n=!!t.length,o=this.getParent().getContainer().find('.edo-LetterDetails_selectorButton_Label');if(this[n?'show':'hide'](),n)o.removeClass('ws-hidden');else o.addClass('ws-hidden');this.getLinkedContext().getValue('record').set('ДанныеДокумента.Местонахождение',!!t.length?t[0]:null);},onShowCorrListActivated:function(){var t=this,n=t.getLinkedContext().getValue('record'),o=new i();o.setValue('ДокументПереписки',n.get('@Документ')),o.setValue('ДокументПерепискиТип',n.get('ТипДокумента.ТипДокумента'));var a={opener:t,className:'edo-floatAreaLetterList',autoCloseOnHide:true,template:'js!SBIS3.EDO.LetterList',target:t.getContainer(),side:'right',isStack:true,overlay:false,showDelay:300,animationLength:300,parent:null,width:800,autoWidth:false,keepSize:false,offset:{x:1,y:0},context:o};e.attachInstance('Lib/Control/FloatArea/FloatArea',a);}};});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.LetterDetails", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-LetterDetails_linkAnswer,.edo-LetterDetails_linkCorrList,.edo-LetterDetails_linkRespond,.edo-LetterDetails_menuLink{height:18px;line-height:18px}.edo-LetterDetails_deliveryList{text-align:right;display:block;min-height:18px;height:18px;line-height:24px}.edo-LetterDetails .edo-LetterDetails_deliveryList.controls-DropdownList .controls-DropdownList__selectedItem{display:block}.edo-LetterDetails{-webkit-flex-shrink:1;-ms-flex-negative:1;-ms-flex-shrink:1;flex-shrink:1;padding:4px 0 0 6px;max-width:185px;overflow:hidden}.edo-LetterDetails_selectorButton{margin-right:-3px;max-width:182px;z-index:1;line-height:18px;height:18px}.edo-LetterDetails_selectorButton_Label{color:#999;font-family:'TensorFont Regular',TensorFont;font-size:14px;height:18px;line-height:18px}.edo-LetterDetails_selectorButton .controls-SelectorButton__text{color:#05b}.edo-LetterDetails_selectorButton .controls-SelectorButton__text:hover{color:#ff7033;text-decoration:underline}.edo-LetterDetails_linkAnswer_wrapper,.edo-LetterDetails_linkCorrList_wrapper,.edo-LetterDetails_linkRespond_wrapper,.edo-LetterDetails_rulesSelector_wrapper{text-align:right;line-height:18px}.edo-LetterDetails__dropdownList-container{text-align:right;line-height:18px}.edo-LetterDetails__dropdownList{height:18px;line-height:18px;min-height:18px}.edo-LetterDetails_selectorButton_wrapper{text-align:right}.edo-LetterDetails__dropdownList.ws-disabled .controls-DropdownList__selectedItem .controls-DropdownList__textWrapper,.edo-LetterDetails__dropdownList.ws-disabled .controls-DropdownList__value:hover{color:#ccc!important}"));head.appendChild(style);});}
define('js!SBIS3.EDO.LetterDetails',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.LetterDetails','js!SBIS3.Staff.StaffFunction','js!SBIS3.EDO.LetterDetailsHandlers','SBIS3.CONTROLS/DropdownList','SBIS3.CONTROLS/SelectorButton','js!SBIS3.Staff.DepartmentChoice.List','WS.Data/Source/SbisService','SBIS3.CONTROLS/Link','js!SBIS3.EDO2.RulesSelector','SBIS3.CONTROLS/Menu/MenuLink','js!SBIS3.EDO.LetterRegistrationButton','css!SBIS3.EDO.LetterDetails','Core/moduleStubs','Elektronnyj_dokumentooborot_localization'],function(t,S){'use strict';return t.extend({$protected:{_options:{}},_dotTplFn:S,$constructor:function(){}});});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.IncomingLetter", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-IncomingLetter_align-right{text-align:right}.edo-IncomingLetter_right{float:right;margin-left:10px}.edo-IncomingLetter_left{position:relative;overflow:hidden}.edo-IncomingLetter_sticker_container{z-index:500}.edo-IncomingLetter_container{width:auto;margin:0 9px 6px 12px}.edo-IncomingLetter_Addressee_container{margin-right:0;padding-top:19px}.edo-IncomingLetter__addresseeChoice-link{color:#8991a9;text-decoration:underline}.edo-IncomingLetter_fieldLink{width:100%}.IncomingLetter__Attach_container{width:100%;margin:8px 9px 6px 12px}.IncomingLetter_attach_item{display:inline-block;margin-right:8px}.edo-IncomingLetter__ourCompany{max-width:300px}.edo-IncomingLetter__ourCompany-container{padding:8px 0;height:24px;line-height:24px}.edo-IncomingLetter__ourCompany-container .controls-SelectorButton__cross{display:none}.edo-IncomingLetter__header{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-justify-content:space-between;-ms-justify-content:space-between;justify-content:space-between;-ms-flex-pack:justify;-webkit-flex-shrink:1;-ms-flex-negative:1;-ms-flex-shrink:1;flex-shrink:1;padding-bottom:6px}.edo-IncomingLetter__sticker{-webkit-flex-shrink:1;-ms-flex-negative:1;-ms-flex-shrink:1;flex-shrink:1;margin-left:10px}.edo-IncomingLetter__addresseeChoice-container{-webkit-flex-shrink:1;-ms-flex-negative:1;-ms-flex-shrink:1;flex-shrink:1;width:100%;overflow:hidden;padding:19px 0 0 12px}.edo-IncomingLetter__header-rightSide{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-justify-content:flex-end;-ms-justify-content:flex-end;justify-content:flex-end;-ms-flex-pack:end;-webkit-flex-shrink:0;-ms-flex-negative:0;-ms-flex-shrink:0;flex-shrink:0}.edo-IncomingLetter__addresseeChoice-container .controls-FieldLink__item-caption{color:#313e78;font-size:15px;font-weight:700}"));head.appendChild(style);});}
define('js!SBIS3.EDO.IncomingLetter',['WS.Data/Source/SbisService','Core/EventBus','Core/Deferred','Core/CommandDispatcher','html!SBIS3.EDO.IncomingLetter','js!SBIS3.EDO2.FormController','js!SBIS3.EDO.LetterHandlers','SBIS3.CONTROLS/Utils/InformationPopupManager','js!SBIS3.EDO.EdoServiceCommands','js!SBIS3.EDO2.Dialog','js!SBIS3.EDO.LetterModel','js!SBIS3.EDO2.MainTabHeader','optional!js!SBIS3.Contragents.ChoiceOurCompanyLink','js!SBIS3.EDO2.Sticker','SBIS3.CONTROLS/Link','js!SBIS3.AddresseeChoice.FieldLink','preload!optional!SBIS3.AddresseeChoice.Dialog','SBIS3.CONTROLS/Button','SBIS3.CONTROLS/Utils/ControlsValidators','js!SBIS3.EDO2.Viewer','js!SBIS3.EDO2.CreateButton','js!SBIS3.EDO2.AttachButton','js!SBIS3.EDO.LetterDetails','js!SBIS3.EDO.LetterEditor','css!SBIS3.EDO.IncomingLetter','Elektronnyj_dokumentooborot_localization'],function(e,t,o,i,n,r,a,s,c){'use strict';var d=r.extend({_dotTplFn:n,$protected:{_options:{dataSource:{endpoint:{contract:'КоррВх'},binding:{create:'Создать',update:'Записать',destroy:'Документ.УдалитьДокументы',read:'Документ.ПрочитатьДляУчастника',format:'КоррВх.Список',query:'КоррВх.Список'},model:'edo.model.LetterModel'},readMetaData:{'ИмяОбъекта':'КоррВх'},objectName:'КоррВх',scopeArea:'Входящая корреспонденция',isNewDocument:false,saveImmediatelyFields:['Лицо1'],placeholderCaption:'Укажите контрагента'}},$constructor:function(){i.declareCommand(this,'delivery_change',a.onDeliveryChange),i.declareCommand(this,'edoRegDate',function(){this.getChildControlByName('letterRegistrationButton').sendCommand('showRegistrationDialog');}.bind(this)),i.declareCommand(this,'edoOrigPlace',a.onOrigPlaceMenu),i.declareCommand(this,'fShowDocTime',c.fShowDocTime);},init:function(){d.superclass.init.call(this);var e=this;if(e.subscribeTo(e,'onCommandCatch',function(t,o){if('edoEditDocument'===o)e.getChildControlByName('ДокументРасширение.Название_editor')._setVisibleIconResize('edit');else if('edoSaveDocument'===o)e.getChildControlByName('ДокументРасширение.Название_editor')._setVisibleIconResize('save');}),t.channel('lettersChannel').subscribe('onCloseDialogAnswer',function(t,o){e._notify('onUpdateModel',o,{idProperty:void 0,isNewRecord:void 0,key:o.getId()});}),e.hasChildControlByName('IncomingLetterLink')&&e.hasChildControlByName('IncomingLetterFieldLink')){var i=e.getChildControlByName('IncomingLetterLink'),n=e.getChildControlByName('IncomingLetterFieldLink');e.subscribeTo(i,'onActivated',function(e){require(['js!SBIS3.AddresseeChoice.Dialog'],function(){n.showSelector('js!SBIS3.AddresseeChoice.Dialog',{selectionType:'all'});});});}this.subscribe('onBeforeUpdateModel',function(e,t){if(t.isChanged&&!t.isChanged())return;var i=new o(),n=t.get('ТипДокумента.ТипДокумента');e.setResult(i),this._checkExistingCorrDoc(n,t).addCallback(function(e){if(e.getScalar())s.showConfirmDialog({message:'Для указанного контрагента<br>письмо с таким номером<br>уже зарегистрировано!',details:'Хотите сохранить письмо?'},function(){i.callback();},function(){i.errback();});else i.callback();});});},_checkExistingCorrDoc:function(t,o){var i={'@Документ':o.get('@Документ'),'ТипДокумента':o.get('ТипДокумента'),'НомерУКонтрагента':o.get('ДанныеДокумента.НомерУКонтрагента'),'Лицо1':o.get('Лицо1')};return new e({endpoint:t}).call('НайтиДокументПоТипуИНомеру',{'ПараметрыДокумента':i});}});return d;});
define("html!SBIS3.EDO.OutgoingLetter",function(){var o=function(o){var t=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;o.test(t);)t=t.replace(o,"&#123;&#123;$1&#125;&#125;");return t}}(),e=function(o){return o.join?o.join(""):o.toString()},n=function(o){return void 0===o?"":o&&"object"==typeof o?e(o):""+o},a="undefined"!=typeof process,i=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="edo-OutgoingLetter"> <component data-component="SBIS3.EDO2.Dialog" name=\'OutgoingLetterDialog\'> <option name="objectName">'+t(n(o.objectName))+'</option> <option name="stickyHeader">true</option> <options name="fullTrace"> <option name="showToolbar">false</option> </options> <opt name="firstLineContent"> <div class="edo-OutgoingLetter_align-right edo-OutgoingLetter__ourCompany-container"> <component data-component="SBIS3.Contragents.ChoiceOurCompanyLink"> <options name="componentOptions"> <opt name="ShowInnerCompany" value="true"></opt> <opt name="ourCompany" value="false"></opt> <opts name="ScopesAreas" type="array"> <opt value="'+t(n(o.scopeArea))+'"/> </opts> <opt name="ShowAllCompany" value="false"></opt> <opt name="withAffiliates" value="true"></opt> <option name="openCardCompany" bind="record/isOpenCardCompany" type="boolean"></option> </options> <opt name="multiselect" value="false"></opt> <opt name="className" value="edo-OutgoingLetter__ourCompany controls-SelectorButton__asLink"></opt> <opt name="enabled">true</opt> <opt name="allowChangeEnable">false</opt> <opt name="idProperty" value="@Лицо"></opt> <options name="selectedItem"> <option name="@Лицо" bind="record/ДокументНашаОрганизация"></option> <option name="Название" bind="record/ДокументНашаОрганизация.Контрагент.Название"></option> </options> </component> </div> </opt> <options name="tabs" type="array"> <options> <option name="className">controls-TabButton__main-item</option> <option name="id">firstTab</option> <option name="title"> <component data-component=\'SBIS3.EDO2.MainTabHeader\'> <option name=\'docType\'>'+t(n(o.objectName))+'</option> </component> </option> <option name="content"> <div class="edo-OutgoingLetter__header"> <div class="edo-OutgoingLetter__addresseeChoice-container"> <component data-component="SBIS3.CONTROLS/Link" name="OutgoingLetterLink" class="edo-OutgoingLetter__addresseeChoice-link"> <option name="caption">'+t(n(rk("Получатель")))+'</option> <option name="tabindex">0</option> </component> <component data-component="SBIS3.AddresseeChoice.FieldLink" name="OutgoingLetterFieldLink" class="edo-OutgoingLetter_fieldLink ws-autofocus"> <option name="autoShow">false</option> <option name="contacts">false</option> <option name="representativeChoice">true</option> <option name="representative" oneWay="true" bind="record/РП.Документ/Состояние/Подписание/Ответственный/Профиль"></option> <options name="selectedItem" nonExistentValue="{}"> <option name="@Лицо" bind="record/Лицо1"></option> <option name="Название" bind="record/Лицо1.Название"></option> <option name="ИНН" bind="record/Контрагент.ИНН"></option> </options> <option name="placeholder">'+t(n(rk("Название контрагента или ИНН")))+'</option> <option name="allowContragentChoice">true</option> <option name="multiselect">false</option> <option name="favoritesOnly">false</option> <option name="tabindex">1</option> <options name="validators" type="array"> <options> <option name="errorMessage" value="'+t(n(o.placeholderCaption))+'"/> <option name="validator" type="function">SBIS3.CONTROLS/Utils/ControlsValidators:required</option> <option name="option" value="selectedKeys"/> </options> </options> </component> </div> <div class="edo-OutgoingLetter__header-rightSide"> <component data-component="SBIS3.EDO.LetterDetails"> <option name="showRespondButton" type="boolean" value="'+t(n("КоррВх"==o.objectName))+'"></option> <option name="tabindex">0</option> </component> <component data-component="SBIS3.EDO2.Sticker" class="edo-OutgoingLetter__sticker" name="OutgoingLetterSticker"> <option name="mayDeleteResponsible">false</option> <option name="showContractorInfo">true</option> <option name="mini">false</option> <option name="tabindex">0</option> </component> </div> </div> <div> <component data-component="SBIS3.EDO.LetterEditor"> <option name="name" value="ДокументРасширение.Название_editor"></option> </component> </div> <div class="OutgoingLetter__Attach_container"> <div class="OutgoingLetter_attach_item Report__Attach_file"> <component data-component="SBIS3.EDO2.AttachButton" name="AttachTo"> <option name="objectName">'+t(n(o.objectName))+'</option> <option name="canAttachExternalLinks">true</option> </component> </div> <div class="OutgoingLetter_attach_item Report__Attach_external"> <component data-component="SBIS3.EDO2.CreateButton" name="CreateAttach"> <option name="objectName">'+t(n(o.objectName))+'</option> </component> </div> </div> <div class="edo-Viewer"> <component data-component="SBIS3.EDO2.Viewer" name="OutgoingLetterViewer"> </component> </div> </option> </options> </options> <options name="handlers"> <options name="onReady" type="array"> <option type="function">js!SBIS3.EDO.LetterHandlers:onReadyLetterDialog</option> </options> </options> </component> </div> ');return(i=t(i))+(a&&-1!==i.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.OutgoingLetter"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.OutgoingLetter", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-OutgoingLetter_align-right{text-align:right}.edo-OutgoingLetter_right{float:right;margin-left:10px}.edo-OutgoingLetter_left{position:relative;overflow:hidden}.edo-OutgoingLetter_container{width:auto;margin:0 9px 6px 12px}.edo-OutgoingLetter__addresseeChoice-link{color:#8991a9;text-decoration:underline}.edo-OutgoingLetter_fieldLink{width:100%}.OutgoingLetter__Attach_container{width:100%;margin:8px 9px 6px 12px}.OutgoingLetter_attach_item{display:inline-block;margin-right:8px}.edo-OutgoingLetter__ourCompany{max-width:300px}.edo-OutgoingLetter__ourCompany-container{padding:8px 0;height:24px;line-height:24px}.edo-OutgoingLetter__ourCompany-container .controls-SelectorButton__cross{display:none}.edo-OutgoingLetter__header{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-justify-content:space-between;-ms-justify-content:space-between;justify-content:space-between;-ms-flex-pack:justify;-webkit-flex-shrink:1;-ms-flex-negative:1;-ms-flex-shrink:1;flex-shrink:1;padding-bottom:6px}.edo-OutgoingLetter__sticker{-webkit-flex-shrink:1;-ms-flex-negative:1;-ms-flex-shrink:1;flex-shrink:1;margin-left:10px}.edo-OutgoingLetter__addresseeChoice-container{-webkit-flex-shrink:1;-ms-flex-negative:1;-ms-flex-shrink:1;flex-shrink:1;width:100%;overflow:hidden;padding:19px 0 0 12px}.edo-OutgoingLetter__header-rightSide{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-justify-content:flex-end;-ms-justify-content:flex-end;justify-content:flex-end;-ms-flex-pack:end;-webkit-flex-shrink:0;-ms-flex-negative:0;-ms-flex-shrink:0;flex-shrink:0}.edo-OutgoingLetter__addresseeChoice-container .controls-FieldLink__item-caption{color:#313e78;font-size:15px;font-weight:700}"));head.appendChild(style);});}
define('js!SBIS3.EDO.OutgoingLetter',['WS.Data/Source/SbisService','Core/Deferred','Core/CommandDispatcher','html!SBIS3.EDO.OutgoingLetter','js!SBIS3.EDO2.FormController','js!SBIS3.EDO.LetterHandlers','SBIS3.CONTROLS/Utils/InformationPopupManager','js!SBIS3.EDO.EdoServiceCommands','js!SBIS3.EDO2.Dialog','js!SBIS3.EDO.LetterModel','js!SBIS3.EDO2.MainTabHeader','optional!js!SBIS3.Contragents.ChoiceOurCompanyLink','js!SBIS3.EDO2.Sticker','SBIS3.CONTROLS/Link','js!SBIS3.AddresseeChoice.FieldLink','preload!optional!SBIS3.AddresseeChoice.Dialog','SBIS3.CONTROLS/Button','SBIS3.CONTROLS/Utils/ControlsValidators','js!SBIS3.EDO2.Viewer','js!SBIS3.EDO2.CreateButton','js!SBIS3.EDO2.AttachButton','js!SBIS3.EDO.LetterDetails','js!SBIS3.EDO.LetterEditor','css!SBIS3.EDO.OutgoingLetter','Elektronnyj_dokumentooborot_localization'],function(e,t,o,i,n,r,a,s){'use strict';var d=n.extend({_dotTplFn:i,$protected:{_options:{dataSource:{endpoint:{contract:'КоррИсх'},binding:{create:'Создать',update:'Записать',destroy:'Документ.УдалитьДокументы',read:'Документ.ПрочитатьДляУчастника',format:'КоррИсх.Список',query:'КоррИсх.Список'},model:'edo.model.LetterModel'},readMetaData:{'ИмяОбъекта':'КоррИсх'},objectName:'КоррИсх',scopeArea:'Исходящая корреспонденция',isNewDocument:false,saveImmediatelyFields:['Лицо1'],placeholderCaption:'Укажите контрагента'}},$constructor:function(){o.declareCommand(this,'delivery_change',r.onDeliveryChange),o.declareCommand(this,'edoRegDate',function(){this.getChildControlByName('letterRegistrationButton').sendCommand('showRegistrationDialog');}.bind(this)),o.declareCommand(this,'edoOrigPlace',r.onOrigPlaceMenu),o.declareCommand(this,'fShowDocTime',s.fShowDocTime);},init:function(){d.superclass.init.call(this);var e=this;if(e.subscribe('onStartSending',r.onStartSending.bind(e)),e.subscribeTo(e,'onCommandCatch',function(t,o){if('edoEditDocument'===o)e.getChildControlByName('ДокументРасширение.Название_editor')._setVisibleIconResize('edit');else if('edoSaveDocument'===o)e.getChildControlByName('ДокументРасширение.Название_editor')._setVisibleIconResize('save');}),e.hasChildControlByName('OutgoingLetterLink')&&e.hasChildControlByName('OutgoingLetterFieldLink')){var o=e.getChildControlByName('OutgoingLetterLink'),i=e.getChildControlByName('OutgoingLetterFieldLink');e.subscribeTo(o,'onActivated',function(e){require(['js!SBIS3.AddresseeChoice.Dialog'],function(){i.showSelector('js!SBIS3.AddresseeChoice.Dialog',{selectionType:'all'});});});}this.subscribe('onBeforeUpdateModel',function(e,o){if(o.isChanged&&!o.isChanged())return;var i=new t(),n=o.get('ТипДокумента.ТипДокумента');e.setResult(i),this._checkExistingCorrDoc(n,o).addCallback(function(e){if(e.getScalar())a.showConfirmDialog({message:'Для указанного контрагента<br>письмо с таким номером<br>уже зарегистрировано!',details:'Хотите сохранить письмо?'},function(){i.callback();},function(){i.errback();});else i.callback();});});},_checkExistingCorrDoc:function(t,o){var i={'@Документ':o.get('@Документ'),'ТипДокумента':o.get('ТипДокумента'),'НомерУКонтрагента':o.get('ДанныеДокумента.НомерУКонтрагента'),'Лицо1':o.get('Лицо1')};return new e({endpoint:t}).call('НайтиДокументПоТипуИНомеру',{'ПараметрыДокумента':i});}});return d;});
define("tmpl!SBIS3.EDO.LetterRegistrationDialog",["Core/tmpl/js/tclosure","js!SBIS3.CONTROLS/TextBox","js!SBIS3.CONTROLS/Date/Picker","js!SBIS3.CONTROLS/Link","js!SBIS3.CONTROLS/Button/IconButton"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],o={};o["js!SBIS3.CONTROLS/TextBox"]=e[1],o["js!SBIS3.CONTROLS/Date/Picker"]=e[2],o["js!SBIS3.CONTROLS/Link"]=e[3],o["js!SBIS3.CONTROLS/Button/IconButton"]=e[4];var r=function e(r,n,a,i,l){function s(){}var c=0,d=void 0!==t&&t?t:arguments[arguments.length-1];void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure"));var m={};l&&l.isSetts&&(m=l.fullContext||{});var u="string"==typeof a?a:"",p=void 0===o?void 0:o,g={id:[],def:void 0},S=d.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,r),N=this&&this.includedTemplates?this.includedTemplates:{},f=d.getMarkupGenerator(i);try{var C=f.joinElements([f.createTag("div",{class:"edo-LetterRegistrationDialog"},[f.createTag("span",{class:"edo-LetterRegistrationDialog-caption"},[f.createText(""+d.wrapUndef(d.utils.escape(d.getter(r,["headerTitle"]))))],{},g,this),f.createTag("div",{class:"edo-LetterRegistrationDialog__body"},[f.createText(" "+global.rk("№")+" "),f.createControl("wsControl","ws:SBIS3.CONTROLS/TextBox",{name:"textBox",className:"edo-LetterRegistrationDialog__textBox",bindings:[{fieldName:"record/ДанныеДокумента.НомерУКонтрагента",propName:"text",propPath:[],fullPropName:"text",propPathStr:"",oneWay:!0,direction:"fromContext",bindNonExistent:!0}],text:"",trim:!0,allowChangeEnable:!1},{name:"textBox",sbisname:"textBox"},{data:r,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:S},a,p,N,d.config,m),f.createText(" "+global.rk("от")+" "),f.createControl("wsControl","ws:SBIS3.CONTROLS/Date/Picker",{name:"datePicker",className:"edo-LetterRegistrationDialog__datePicker",bindings:[{fieldName:"record/ДанныеДокумента.ДатаРегистрации",propName:"date",propPath:[],fullPropName:"date",propPathStr:"",oneWay:!0,direction:"fromContext",bindNonExistent:!0}],date:null,allowChangeEnable:!1},{name:"datePicker",sbisname:"datePicker"},{data:r,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:S},a,p,N,d.config,m),f.createControl("wsControl","ws:SBIS3.CONTROLS/Link",{name:"closeLink",className:"edo-LetterRegistrationDialog__closeLink ws-field-button ws-button-classic sbisname-window-title-close",allowChangeEnable:!1,command:"hideDialog"},{name:"closeLink",sbisname:"closeLink"},{data:r,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:S},a,p,N,d.config,m),f.createControl("wsControl","ws:SBIS3.CONTROLS/Button/IconButton",{name:"confirmButton",className:"edo-LetterRegistrationDialog__confirmButton controls-IconButton__round-border-24",icon:"sprite:icon-16 icon-Yes icon-done",allowChangeEnable:!1,primary:!0,tooltip:global.rk("Подтвердить"),command:"confirmChange"},{name:"confirmButton",sbisname:"confirmButton"},{data:r,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:S},a,p,N,d.config,m)],{},g,this)],n,g,this)],u,g);g.def&&(C=f.chain(C,g,n),g=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/components/Registry/Documents/Letters/EDO2DialogLetter/resources/LetterDetails/LetterRegistrationDialog/LetterRegistrationDialog.tmpl",e,r)}return C||""};return r.includedFunctions={},r.stable=!0,r.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.LetterRegistrationDialog"}},r});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.LetterRegistrationDialog", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-LetterRegistrationDialog{height:53px;width:317px;background:#f3f3f3!important}.edo-LetterRegistrationDialog-caption{color:#999;float:right;padding:0 3px 5px 0}.edo-LetterRegistrationDialog__body{clear:both;padding-left:7px}.edo-LetterRegistrationDialog__datePicker .controls-FormattedTextBox{margin:0 5px}.edo-LetterRegistrationDialog__textBox{width:88px;margin:0 5px}.edo-LetterRegistrationDialog__confirmButton{margin-right:8px}.edo-LetterRegistrationDialog__closeLink,.edo-LetterRegistrationDialog__confirmButton{position:static!important;float:right}"));head.appendChild(style);});}
define('js!SBIS3.EDO.LetterRegistrationDialog',['SBIS3.CONTROLS/CompoundControl','SBIS3.CONTROLS/Utils/InformationPopupManager','Core/CommandDispatcher','Core/helpers/date-helpers','tmpl!SBIS3.EDO.LetterRegistrationDialog','css!SBIS3.EDO.LetterRegistrationDialog','Elektronnyj_dokumentooborot_localization'],function(e,t,n,i,o){'use strict';var s=e.extend({_dotTplFn:o,$protected:{_options:{}},$constructor:function(){this.once('onReady',function(){this._declareCommand();}.bind(this));},init:function(){s.superclass.init.call(this);},_declareCommand:function(){n.declareCommand(this,'hideDialog',function(){this.hideDialog();}.bind(this)),n.declareCommand(this,'confirmChange',function(){this.confirmChange();}.bind(this));},hideDialog:function(){if(function(e,t){var n=this.getLinkedContext().getValue('record/ДанныеДокумента.ДатаРегистрации');return e!==this.getLinkedContext().getValue('record/ДанныеДокумента.НомерУКонтрагента')||t&&!n||!t&&n||i.compareDates(t,'!=',this.getLinkedContext().getValue('record/ДанныеДокумента.ДатаРегистрации'));}.bind(this)(this.getChildControlByName('textBox').getText(),this.getChildControlByName('datePicker').getDate()))new t.showConfirmDialog({message:rk('Сохранить изменения?'),opener:this},function(){this.sendCommand('confirmChange');}.bind(this),function(){this.sendCommand('close');}.bind(this));else this.sendCommand('close');},confirmChange:function(){this.getLinkedContext().setValue('record/ДанныеДокумента.НомерУКонтрагента',this.getChildControlByName('textBox').getText()||null),this.getLinkedContext().setValue('record/ДанныеДокумента.ДатаРегистрации',this.getChildControlByName('datePicker').getDate()||null),this.sendCommand('close');}});return s;});
define("html!SBIS3.EDO.LetterList",function(){var o=function(o){var n=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;o.test(n);)n=n.replace(o,"&#123;&#123;$1&#125;&#125;");return n}}(),e=function(o){return o.join?o.join(""):o.toString()},t=function(o){return void 0===o?"":o&&"object"==typeof o?e(o):""+o},i="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div> <component data-component="SBIS3.Engine.BrowserTabs" name="LetterListTabBrowserTabs"> <option name="stickyHeader">true</option> <option name="operationsButtonVisibility">false</option> <options name="tabsArea" type="array"> <options> <option name="id">aGroup</option> <option name="content"> <div> <div class="edo-LetterListTab_toolbarItem"> <span class="edo-LetterList_addDocButtonLabel">'+n(t(rk("Переписка")))+'</span> <component data-component="SBIS3.CONTROLS/Button" name="LetterListTabAddDocButton"> <option name="caption">+ '+n(t(rk("Письмо")))+'</option> </component> </div> </div> </option> </options> </options> <options name="mainArea" type="array"> <options> <option name="id">ListGroup</option> <option name="content"> <div> <component data-component="SBIS3.EDO2.Browser" name="LetterListBrowser" class="edo-LetterList_Browser"> <option name="stickyHeader">true</option> <option name="searchConfig"> <option name="placeholder">'+n(t(rk("Найти...")))+'</option> <option name="searchDelay">600</option> <option name="trim">true</option> <option name="usePicker">true</option> <option name="text" bind="searchFormField"></option> <option name="showEmptyList">false</option> <options name="listFilter"> <option name="Поиск" bind="searchFormField" oneWay="true"></option> </options> <options name="resultBindings" type="array"> <options> <option name="contextField">searchFormField</option> <option name="itemField">ИНН</option> </options> </options> <options name="list"> <option name="component" value="SBIS3.CONTROLS/DataGridView"></option> <options name="options"> <option name="showHead">false</option> <options name="itemsActions" type="array"> </options> <options name="columns" type="array"> <options> <option name="field">НазваниеИНН</option> </options> </options> <option name="idProperty" value="@Лицо"></option> <option name="pageSize">5</option> </options> </options> </option> <options name="browserOptions"> <option name="multiselect">false</option> <options name="common"> <option name="showListTabName">false</option> <option name="objectName">КоррИсх</option> <option name="method">Переписка</option> <options name="filterParams"> <option name="ДокументПереписки" bind="ДокументПереписки"></option> </options> </options> <option name="idProperty">@Документ</option> <option name="showHead">true</option> <option name="viewMode">table</option> <options name="columns" type="array"> <options> <option name="cellTemplate">html!SBIS3.EDO2.Browser/resources/columns/DateNumberColumn</option> <option name="fixedSize">false</option> <option name="width">65</option> </options> <options> <option name="cellTemplate">html!SBIS3.EDO.LetterList/resources/columns/IconMailColumn</option> <option name="fixedSize">false</option> <option name="width">10</option> </options> <options> <option name="cellTemplate">html!SBIS3.EDO2.Browser/resources/columns/MainInfoColumn</option> </options> <options> <option name="cellTemplate">html!SBIS3.EDO2.Browser/resources/columns/StateColumn</option> <option name="width">1</option> </options> <options> <option name="cellTemplate">html!SBIS3.EDO2.Browser/resources/columns/ResponsibleColumn</option> <option name="fixedSize">false</option> <option name="width">160</option> </options> </options> <options name="itemsActionsVisibility"> <option name="edoSaveDocumentOnDisk" value="false"></option> <option name="edoSendDocument" value="false"></option> <option name="edoOpenInNewTab" value="false"></option> <option name="edoShowDkPanel" value="false"></option> <option name="edoPostDocument" value="false"></option> </options> </options> </component> <component data-component="SBIS3.EDO2.OpenDialogAction"> <option name="name">LetterListOpenDialogAction</option> <option name="editMode">newFloatArea</option> <option name="mode">floatArea</option> <option name="objectName">КоррИсх</option> <option name="initializingWay" value="delayedRemote"></option> </component> <component data-component="SBIS3.EDO.FEdoPartialReloader" name="PartialReloader"> <opt name="objectName" value="КоррИсх"/> <opt name="method" value="Переписка"/> <opt name="filterName" value="СписокИдО"/> <opt name="sortField" value="Дата"/> <opt name="overrideItemsSortMethod" value="true"/> <opt name="updateOnDeleteAndAdd" value="false"/> <opt name="addServerChannelName" value=""/> <opt name="fixServerChannelName" value=""/> <opt name="deleteServerChannelName" value=""/> <opts name="actionEventsToListen" type="array"> <opt value="onUpdateModel"/> <opt value="onDestroyModel"/> <opt value="onCreateModel"/> </opts> <opt name="edoOpenDialogAction" value="LetterListOpenDialogAction"/> <opt name="complexKeyField" value="@Документ"/> </component> </div> </option> </options> </options> <options name="tabs" type="array"> <options> <option name="id">ListTab</option> <option name="mainArea">ListGroup</option> <option name="tabsArea">aGroup</option> <option name="title">'+n(t(rk("Список")))+'</option> <option name="visible">false</option> </options> </options> <option name="defaultTab">ListTab</option> <option name="tabsName">LetterListInnerTabs</option> <options name="handlers"> <option name="onTabAndMainLoaded" type="function">js!SBIS3.EDO.LetterList:prototype.onTabAndMainLoaded</option> </options> </component> </div> ');return(a=n(a))+(i&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.LetterList"}},o});
define("html!SBIS3.EDO.LetterList/resources/columns/IconMailColumn",function(){var e=function(e){var n=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;e.test(n);)n=n.replace(e,"&#123;&#123;$1&#125;&#125;");return n}}(),t=function(e){return e.join?e.join(""):e.toString()},r=function(e){return void 0===e?"":e&&"object"==typeof e?t(e):""+e},o="undefined"!=typeof process,i=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,""),u="КоррИсх"==e.item.get("ТипДокумента.ТипДокумента")?"MailOutgoing":"MailIncoming",l=e.item.get("mainInfo").header1.title,s=("КоррИсх"==e.item.get("ТипДокумента.ТипДокумента")?rk("Отправлено в"):rk("Получено от"))+" "+l;return i+=' <div class="icon-16 icon-'+n(r(u))+' icon-disabled" title="'+n(r(s))+'" style="color: #999999 !important; margin-top: 4px;"></div>',(i=n(i))+(o&&-1!==i.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.LetterList/resources/columns/IconMailColumn"}},e});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.LetterList", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-LetterList_addDocButtonLabel{font-size:18px;font-weight:700;font-style:italic;display:inline-block;margin-top:-4px;margin-right:4px;color:#000}.edo-floatAreaLetterList .sbisname-window-title-close{z-index:999!important}"));head.appendChild(style);});}
define('js!SBIS3.EDO.LetterList',['WS.Data/Source/SbisService','WS.Data/Entity/Record','Core/Indicator','SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.LetterList','js!SBIS3.EDO.DocHandlers','js!SBIS3.EDO2.OpenDialogAction','js!SBIS3.Engine.BrowserTabs','SBIS3.CONTROLS/Button','js!SBIS3.EDO2.Browser','html!SBIS3.EDO2.Browser/resources/columns/DateNumberColumn','html!SBIS3.EDO.LetterList/resources/columns/IconMailColumn','html!SBIS3.EDO2.Browser/resources/columns/MainInfoColumn','html!SBIS3.EDO2.Browser/resources/columns/StateColumn','html!SBIS3.EDO2.Browser/resources/columns/ResponsibleColumn','js!SBIS3.EDO2.OpenDialogAction','js!SBIS3.EDO.FEdoPartialReloader','css!SBIS3.EDO.LetterList','Elektronnyj_dokumentooborot_localization'],function(t,e,o,n,r,s){'use strict';var i=n.extend({_dotTplFn:r,$protected:{_options:{}},$constructor:function(){},init:function(){i.superclass.init.call(this),s.setProcessingAutocompletion(this,'LetterListBrowser'),this.setActive(true);},onTabAndMainLoaded:function(n,r){if('ListTab'==r){var s=this,i=s.getChildControlByName('LetterListTabAddDocButton'),a=s.getChildControlByName('LetterListBrowser'),c=s.getChildControlByName('LetterListOpenDialogAction');if(i)i.subscribe('onActivated',function(n){var r=a.getView(),s=r.getItems().at(0),i=new e({rawData:{_type:'record',d:[parseInt(s.get('Лицо1'),10),true],s:[{n:'Лицо1',t:'Число целое'},{n:'ВызовИзБраузера',t:'Логическое'}]},adapter:'adapter.sbis'});o.show(),new t({endpoint:'КоррИсх'}).call('Создать',{'ИмяМетода':'КоррИсх.Список','Фильтр':i}).addCallback(function(e){new t({endpoint:'Документ'}).call('СкопироватьВнешниеДокументы',{'ДокументОснование':parseInt(s.get('@Документ'),10),'ДокументСледствие':parseInt(e.getRow().get('@Документ'),10),'ВидСвязи':1,'СписокВД':[]}).addCallback(function(){o.hide(),c.execute({id:parseInt(e.getRow().get('@Документ'),10),initializingWay:'delayRemote'}),c.once('onExecuted',function(){r.reload();});});}).addErrback(function(){o.hide();});});if(c&&a)a.subscribe('onEdit',function(t,e){c.execute(e);});}}});return i;});
define("html!SBIS3.EDO.IncomingLetters",function(){var o=function(o){var e=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(e){for(;o.test(e);)e=e.replace(o,"&#123;&#123;$1&#125;&#125;");return e}}(),t=function(o){return o.join?o.join(""):o.toString()},n=function(o){return void 0===o?"":o&&"object"==typeof o?t(o):""+o},i="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="ws-flexbox ws-flex-column ws-flex-grow-1 ws-flex-shrink-1" style="min-height: 1px;"> <component data-component="SBIS3.EDO2.Browser" name="IncomingLettersBrowser" class="ws-flexbox ws-flex-column ws-flex-grow-1 ws-flex-shrink-1" style="min-height: 1px;"> <option name="historyId">IncomingLetters</option> <option name="searchConfig"> '+e(n(o.autocompleteTemplate.apply(this,[o])))+' </option> <option name="useScope">true</option> <options name="browserOptions"> <option name="bind">IncomingLettersFilter/button</option> <options name="common"> <option name="objectName">'+e(n(o.objectName))+'</option> <option name="method">'+e(n(o.method))+'</option> <options name="filterParams"> <option name="ПростыеВД" value="true"></option> <option name="ВключитьСписокИсполнителей" value="true"></option> <option name="НазваниеТипаДокумента">'+e(n(o.objectName))+'</option> </options> <option name="model">'+e(n(o.model))+'</option> </options> <option name="idProperty">@Документ</option> <option name="showHead">false</option> <option name="multiselect">true</option> <option name="viewMode">table</option> <options name="columns" type="array"> <options> <option name="cellTemplate">html!SBIS3.EDO2.Browser/resources/columns/DateNumberColumn</option> <option name="fixedSize">false</option> <option name="width">65</option> </options> <options> <option name="cellTemplate">html!SBIS3.EDO2.Browser/resources/columns/MainInfoColumn</option> </options> <options> <option name="cellTemplate">html!SBIS3.EDO.LinkAnswerColumn</option> <option name="fixedSize">false</option> <option name="width">90</option> </options> <options> <option name="cellTemplate">html!SBIS3.EDO2.Browser/resources/columns/StateColumn</option> <option name="width">1</option> </options> <options> <option name="cellTemplate">html!SBIS3.EDO2.Browser/resources/columns/ResponsibleColumn</option> <option name="fixedSize">false</option> <option name="width">160</option> </options> </options> <options name="itemsActionsVisibility"> <option name="edoSaveDocumentOnDisk" value="false"></option> <option name="edoSendDocument" value="false"></option> <option name="edoOpenInNewTab" value="false"></option> <option name="edoShowDkPanel" value="false"></option> <option name="edoPostDocument" value="false"></option> <option name="edoLockDocument" value="false"></option> <option name="edoCancelLockDocument" value="false"></option> </options> <options name="massActionsVisibility"> <option name="edoSetCloseStatusMass" value="false"></option> <option name="edoPostsMass" value="false"></option> <option name="edoShowRegistryHistory" value="true"></option> </options> <options name="massActionsSettings"> <options name="edoPrintDocumentMass"> <option name="documentIdField">@Документ</option> <option name="infinityPrint" type="boolean">true</option> <option name="minPrintWindowWidth">667</option> <option name="xsl">/Elektronnyj_dokumentooborot/Reestry/xslt/reestr_letters.xsl</option> <option name="exportDocuments" type="boolean">true</option> <options name="handlers"> <option name="onApplyOperation" type="function">js!SBIS3.EDO.LettersHandlers:setIncomingPrintColumns</option> </options> </options> <options name="edoShowRegistryHistory"> <option name="objectHistoryName">КоррВх</option> </options> </options> </options> <option name="filterButtonConfig"> <option name="template">js!SBIS3.EDO.FilterIncomingLetter</option> <option name="additionalFilterParamsTemplate">js!SBIS3.EDO.FilterIncomingLetterSelector</option> <options name="filterStructure" type="array"> '+e(n(o.periodStructure({browserBind:o.browserBind})))+" "+e(n(o.MarksStructure({browserBind:o.browserBind})))+" "+e(n(o.ResponsibleFaceStructure({browserBind:o.browserBind})))+" "+e(n(o.RegulationStructure({browserBind:o.browserBind})))+" "+e(n(o.Face1Structure({browserBind:o.browserBind})))+" "+e(n(o.UnansweredStructure({browserBind:o.browserBind})))+" "+e(n(o.OurOrganisationStructure({browserBind:o.browserBind})))+' <opts> <opt name="internalVisibilityField">FilterDeliveryMethodVisibility</opt> <opt name="internalValueField">FilterDeliveryMethod</opt> <opt name="internalCaptionField">FilterDeliveryMethodText</opt> <opt name="value" bind="IncomingLettersFilter/button/ФильтрСпособДоставки"></opt> <opts name="resetValue" type="array"></opts> <opt name="itemTemplate" type="function" value="html!SBIS3.EDO.FilterDeliveryMethodTemplate"/> </opts> <opts> <opt name="internalValueField">FilterState</opt> <opt name="internalCaptionField">FilterStateText</opt> <opt name="value" bind="IncomingLettersFilter/button/ФильтрСостояние"></opt> <opt name="caption" bind="IncomingLettersFilter/caption/ФильтрСостояние"></opt> <opt name="resetValue" type="string">-1</opt> <opt name="itemTemplate" type="null">null</opt> </opts> </options> </option> <option name="fastDataFilterConfig"> <opt name="className">edo-tasks__fastDataFilter</opt> <opt name="idProperty" value="name"></opt> <options name="filterStructure" type="array"> <opts> <opt name="internalValueField">FilterAuthorOrResponsibleMe</opt> <opt name="internalCaptionField">FilterAuthorOrResponsibleMeText</opt> <opt name="value" bind="IncomingLettersFilter/button/ФильтрВладелец"></opt> <opt name="caption" bind="IncomingLettersFilter/caption/ФильтрВладелец"></opt> <opt name="resetValue">Все</opt> </opts> <opts> <opt name="internalValueField">FilterState</opt> <opt name="internalCaptionField">FilterStateText</opt> <opt name="value" bind="IncomingLettersFilter/button/ФильтрСостояние"></opt> <opt name="caption" bind="IncomingLettersFilter/caption/ФильтрСостояние"></opt> <opt name="resetValue" type="string">-1</opt> </opts> </options> </option> <option name="operationsPanelConfig"> <options name="items" type="array"> <options> <option name="name">save</option> <option name="componentType">js!SBIS3.EDO.OperationUnload</option> <options name="type"> <option name="mass">true</option> <option name="selection" type="boolean">true</option> </options> <options name="options"> <option name="fileName" value="Документы"></option> <options name="handlers"> <option name="onApplyOperation" type="function">js!SBIS3.EDO.LettersHandlers:setIncomingPrintColumns</option> </options> </options> </options> </options> </option> </component> <component data-component="SBIS3.EDO2.OpenDialogAction"> <option name="name">IncomingLettersOpenDialogAction</option> <option name="editMode">newFloatArea</option> <option name="mode">floatArea</option> <option name="objectName">'+e(n(o.objectName))+'</option> <option name="initializingWay" value="delayedRemote"></option> </component> ');return!0===o.useAutoRefresh&&(a+=' <component data-component="SBIS3.EDO.FEdoPartialReloader" name="PartialReloader"> <opt name="objectName" value="'+e(n(o.objectName))+'"/> <opt name="method" value="'+e(n(o.method))+'"/> <opt name="filterName" value="'+e(n(o.partialReloader.filterName||"СписокИдО"))+'"/> <opt name="sortField" value="'+e(n(o.partialReloader.sortField||"Дата"))+'"/> <opt name="overrideItemsSortMethod" value="true"/> <opt name="updateOnDeleteAndAdd" value="'+e(n(o.partialReloader.updateOnDeleteAndAdd||"false"))+'"/> <opt name="addServerChannelName" value="'+e(n(o.partialReloader.addServerChannelName||""))+'"/> <opt name="fixServerChannelName" value="'+e(n(o.partialReloader.fixServerChannelName||""))+'"/> <opt name="deleteServerChannelName" value="'+e(n(o.partialReloader.deleteServerChannelName||""))+'"/> <opts name="actionEventsToListen" type="array"> <opt value="onUpdateModel"/> ',o.partialReloader.onDestroyModelHandlingEnable&&(a+=' <opt value="onDestroyModel"/> '),a+=" ",o.partialReloader.onCreateModelHandlingEnable&&(a+=' <opt value="onCreateModel"/> '),a+=' </opts> <opt name="edoOpenDialogAction" value="IncomingLettersOpenDialogAction"/> <opt name="complexKeyField" value="@Документ"/> </component> '),a+=" </div>",(a=e(a))+(i&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.IncomingLetters"}},o});
define('js!SBIS3.EDO.LettersHandlers',['Elektronnyj_dokumentooborot_localization'],function(){'use strict';return{setIncomingPrintColumns:function(t){t.setResult([{field:'Дата',title:'Дата'},{field:'Номер',title:'Номер'},{field:'Лицо1.Название',title:'Контрагент'},{field:'ДокументРасширение.Название',title:'Описание'},{field:'Сотрудник.Название',title:'Ответственный'}]);},setOutgoingPrintColumns:function(t){t.setResult([{field:'Дата',title:'Дата'},{field:'Номер',title:'Номер'},{field:'Лицо1.Название',title:'Контрагент'},{field:'ДокументРасширение.Название',title:'Описание'},{field:'Сотрудник.Название',title:'Ответственный'}]);}};});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.IncomingLetters", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(""));head.appendChild(style);});}
define('js!SBIS3.EDO.IncomingLetters',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.IncomingLetters','js!SBIS3.EDO.AutocompleteHandlers','tmpl!SBIS3.EDO.BaseFilter.Period/resources/PeriodStructure','tmpl!SBIS3.EDO.BaseFilter.Marks/resources/MarksStructure','tmpl!SBIS3.EDO.BaseFilter.ResponsibleFace/resources/ResponsibleFaceStructure','tmpl!SBIS3.EDO.BaseFilter.Face1/resources/Face1Structure','tmpl!SBIS3.EDO.BaseFilter.Unanswered/resources/UnansweredStructure','tmpl!SBIS3.EDO.BaseFilter.OurOrganisation/resources/OurOrganisationStructure','tmpl!SBIS3.EDO.BaseFilter.Regulation/resources/RegulationStructure','js!SBIS3.EDO2.Browser','html!SBIS3.EDO2.Browser/resources/columns/ResponsibleColumn','html!SBIS3.EDO2.Browser/resources/columns/DateNumberColumn','html!SBIS3.EDO2.Browser/resources/columns/MainInfoColumn','js!SBIS3.EDO.LinkAnswerColumn','html!SBIS3.EDO2.Browser/resources/columns/StateColumn','js!SBIS3.EDO2.OpenDialogAction','js!SBIS3.EDO.FEdoPartialReloader','js!SBIS3.EDO2.EdoColumnsClickDispatcher','js!SBIS3.EDO.LettersHandlers','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterResp','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterEventPerformer','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterOurOrg','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterFace1','js!SBIS3.EDO.FilterDeliveryMethodTemplate','js!SBIS3.EDO.LetterModel','css!SBIS3.EDO.IncomingLetters','Elektronnyj_dokumentooborot_localization'],function(e,t,r,s,l,o,i,n,a,u){'use strict';var S=e.extend({_dotTplFn:t,$protected:{_options:{name:'IncomingLetters',objectName:'КоррВх',method:'СписокХраним',model:'edo.model.LetterModel',autocompleteTemplate:r.autocompleteTemplate,fastDataFilterConfig:{data:[{keyField:'key',displayField:'title',name:'FilterAuthorOrResponsibleMe',multiselect:false,className:'controls-DropdownList__withoutCross controls-DropdownList__linkStyle',values:[{key:'Все',value:'Все',title:rk('Все')},{key:'От меня',value:'От меня',title:rk('Мои')},{key:'От моего отдела',value:'От моего отдела',title:rk('Моего отдела')}]},{keyField:'key',displayField:'title',name:'FilterState',multiselect:false,className:'controls-DropdownList controls-DropdownList__linkStyle',values:[{key:'-1',title:rk('В любом состоянии')},{key:'10',title:rk('Внутренняя обработка')},{key:'7',title:rk('Утвержденные')},{key:'9',title:rk('Отклоненные')},{key:'22',title:rk('Аннулированные')},{key:'0,1',title:rk('Черновики')},{key:'-2',title:rk('Удаленные')}]}]},browserBind:'IncomingLettersFilter/button',periodStructure:s,MarksStructure:l,ResponsibleFaceStructure:o,Face1Structure:i,UnansweredStructure:n,OurOrganisationStructure:a,RegulationStructure:u}},$constructor:function(){},init:function(){S.superclass.init.call(this);var e=this.getChildControlByName('browserFastDataFilter');if(e)e.setItems(this._options.fastDataFilterConfig.data);r.setProcessingAutocompletion(this,'ФильтрПоЛицуИзСписка');}});return S;});
define("html!SBIS3.EDO.IncomingLettersTab",function(){var o=function(o){var n=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;o.test(n);)n=n.replace(o,"&#123;&#123;$1&#125;&#125;");return n}}(),t=function(o){return o.join?o.join(""):o.toString()},e=function(o){return void 0===o?"":o&&"object"==typeof o?t(o):""+o},a="undefined"!=typeof process,i=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="ws-flexbox ws-flex-column ws-flex-grow-1 ws-flex-shrink-1 edo-IncomingLettersTab"> <component data-component="SBIS3.Engine.BrowserTabs" name="IncomingLettersTabBrowserTabs" class="edo-IncomingLettersTab_tabs ws-flexbox ws-flex-column ws-flex-grow-1 ws-flex-shrink-1"> <options name="tabsArea" type="array"> <options> <option name="id">aGroup</option> <option name="content"> <div> <div class="edo-IncomingLettersTab_toolbarItem"> <component data-component="SBIS3.EDO2.RulesSelector" name="IncomingLettersTabRulesSelector"> <option name="width">200</option> <options name="docTypes" type="array"> <options> <option name="docType">'+n(e(o.objectName))+'</option> </options> </options> <option name="content"> <component data-component="SBIS3.CONTROLS/Menu/MenuButton" name="IncomingLettersTabAddDocMenuButton"> <option name="caption">+ '+n(e(rk("Документ")))+'</option> <option name="primary">true</option> </component> </option> </component> </div> <div class="edo-IncomingLettersTab_toolbarItem edo-IncomingLettersTab_toolbarGap"> <component data-component="SBIS3.EDO.LoadButton" data-access="Входящая корреспонденция"> <option name="from1C">true</option> <option name="incoming">true</option> <option name="docType">'+n(e(o.objectName))+'</option> </component> </div> </div> </option> </options> </options> <options name="mainArea" type="array"> <options> <option name="id">StatGroup</option> <option name="content">  <component name="IncomingLettersTabStat" data-component="SBIS3.EDO.StatTemplate"> <option name="docType" value="'+n(e(o.objectName))+'"></option> <option name="StatTemplateName" value="ШаблонСтатистики"></option> <option name="template">js!SBIS3.EDO.StatIncoming</option> <option name="needStatPrintBtn">true</option> <option name="className" value="external-statistics-indent"></option> </component>  </option> </options> <options> <option name="id">ListGroup</option> <option name="content"> <component data-component="SBIS3.EDO.IncomingLetters"> <option name="useAutoRefresh">true</option> <opts name="partialReloader"> <opt name="onCreateModelHandlingEnable" value="true"/> <opt name="onDestroyModelHandlingEnable" value="true"/> </opts> </component> </option> </options> </options> <options name="tabs" type="array"> <options> <option name="id">StatTab</option> <option name="title">'+n(e(rk("Статистика")))+'</option> <option name="mainArea">StatGroup</option> </options> <options> <option name="id">ListTab</option> <option name="mainArea">ListGroup</option> <option name="tabsArea">aGroup</option> <option name="title">'+n(e(rk("Список")))+'</option> </options> </options> <option name="defaultTab">ListTab</option> <option name="tabsName">IncomingLettersInnerTabs</option> <options name="handlers"> <option name="onTabChange" type="function">js!SBIS3.EDO.EdoCommon:onTabChangeNewRegistry</option> <option name="onTabAndMainLoaded" type="function">js!SBIS3.EDO.IncomingLettersTab:prototype.onTabAndMainLoaded</option> </options> </component> </div>');return(i=n(i))+(a&&-1!==i.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.IncomingLettersTab"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.IncomingLettersTab", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-IncomingLettersTab_toolbarItem{display:inline-block;float:left}.edo-IncomingLettersTab_toolbarGap{margin-left:12px}.edo-IncomingLettersTab,.edo-IncomingLettersTab_tabs{height:100%;min-height:1px}.ws-webkit-old .edo-IncomingLettersTab{height:calc(100% - 34px)}#contentArea{height:100%}"));head.appendChild(style);});}
define('js!SBIS3.EDO.IncomingLettersTab',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.IncomingLettersTab','optional!js!SBIS3.EDO.DocflowRulesHelpers','js!SBIS3.EDO.EdoCommon','SBIS3.CONTROLS/Button','js!SBIS3.EDO2.RulesSelector','SBIS3.CONTROLS/Menu/MenuButton','js!SBIS3.EDO.LoadButton','js!SBIS3.Engine.BrowserTabs','js!SBIS3.EDO.IncomingLetters','js!SBIS3.EDO.StatTemplate','css!SBIS3.EDO.IncomingLettersTab','Elektronnyj_dokumentooborot_localization'],function(t,e,n,o){'use strict';var i=t.extend({_dotTplFn:e,$protected:{_options:{name:'IncomingLettersTab',objectName:'КоррВх'}},$constructor:function(){},init:function(){i.superclass.init.call(this);},onTabAndMainLoaded:function(t,e){if('ListTab'==e){var i=this,s=i.getChildControlByName('IncomingLettersTabRulesSelector'),r=i.getChildControlByName('IncomingLettersBrowser'),c=i.getChildControlByName('IncomingLettersOpenDialogAction');if(s){var S=s.getChildControlByName('IncomingLettersTabAddDocMenuButton');if(S)S.subscribe('onMenuItemActivate',function(t,e){var o=this.getItems().getRecordById(e),i;if(o&&!n.ruleIsFolder(o))i={record:o},r.addItem(i);});}if(c&&r)r.subscribe('onEdit',function(t,e){c.execute(e);});o.initScopes(r);}}});return i;});
define("html!SBIS3.EDO.OutgoingLetters",function(){var o=function(o){var e=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(e){for(;o.test(e);)e=e.replace(o,"&#123;&#123;$1&#125;&#125;");return e}}(),t=function(o){return o.join?o.join(""):o.toString()},n=function(o){return void 0===o?"":o&&"object"==typeof o?t(o):""+o},i="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="ws-flexbox ws-flex-column ws-flex-grow-1 ws-flex-shrink-1" style="min-height: 1px;"> <component data-component="SBIS3.EDO2.Browser" name="OutgoingLettersBrowser" class="edo-OutgoingLetters_Browser ws-flexbox ws-flex-column ws-flex-grow-1 ws-flex-shrink-1" style="min-height: 1px;"> <option name="historyId">OutgoingLetters</option> <option name="searchConfig"> '+e(n(o.autocompleteTemplate.apply(this,[o])))+' </option> <option name="useScope">true</option> <options name="browserOptions"> <option name="bind">OutgoingLettersFilter/button</option> <options name="common"> <option name="objectName">'+e(n(o.objectName))+'</option> <option name="method">'+e(n(o.method))+'</option> <options name="filterParams"> <option name="ПростыеВД" value="true"></option> <option name="ВключитьСписокИсполнителей" value="true"></option> <option name="НазваниеТипаДокумента">'+e(n(o.objectName))+'</option> </options> <option name="model">'+e(n(o.model))+'</option> </options> <option name="idProperty">@Документ</option> <option name="showHead">false</option> <option name="multiselect">true</option> <option name="viewMode">table</option> <options name="columns" type="array"> <options> <option name="cellTemplate">html!SBIS3.EDO2.Browser/resources/columns/DateNumberColumn</option> <option name="fixedSize">false</option> <option name="width">65</option> </options> <options> <option name="cellTemplate">html!SBIS3.EDO2.Browser/resources/columns/MainInfoColumn</option> </options> <options> <option name="cellTemplate">html!SBIS3.EDO2.Browser/resources/columns/StateColumn</option> <option name="width">1</option> </options> <options> <option name="cellTemplate">html!SBIS3.EDO2.Browser/resources/columns/ResponsibleColumn</option> <option name="width">1</option> </options> </options> <options name="itemsActionsVisibility"> <option name="edoSaveDocumentOnDisk" value="false"></option> <option name="edoSendDocument" value="false"></option> <option name="edoOpenInNewTab" value="false"></option> <option name="edoShowDkPanel" value="false"></option> <option name="edoPostDocument" value="false"></option> <option name="edoLockDocument" value="false"></option> <option name="edoCancelLockDocument" value="false"></option> </options> <options name="massActionsVisibility"> <option name="edoSetCloseStatusMass" value="false"></option> <option name="edoPostsMass" value="false"></option> <option name="edoShowRegistryHistory" value="true"></option> </options> <options name="massActionsSettings"> <options name="edoPrintDocumentMass"> <option name="documentIdField">@Документ</option> <option name="infinityPrint" type="boolean">true</option> <option name="minPrintWindowWidth">667</option> <option name="xsl">/Elektronnyj_dokumentooborot/Reestry/xslt/reestr_letters.xsl</option> <option name="exportDocuments" type="boolean">true</option> <options name="handlers"> <option name="onApplyOperation" type="function">js!SBIS3.EDO.LettersHandlers:setOutgoingPrintColumns</option> </options> </options> <options name="edoShowRegistryHistory"> <option name="objectHistoryName">КоррИсх</option> </options> </options> </options> <option name="filterButtonConfig"> <option name="template">js!SBIS3.EDO.FilterOutgoingLetter</option> <option name="additionalFilterParamsTemplate">js!SBIS3.EDO.FilterOutgoingLetterSelector</option> <options name="filterStructure" type="array"> '+e(n(o.periodStructure({browserBind:o.browserBind})))+" "+e(n(o.MarksStructure({browserBind:o.browserBind})))+" "+e(n(o.ResponsibleFaceStructure({browserBind:o.browserBind})))+" "+e(n(o.Face1Structure({browserBind:o.browserBind})))+" "+e(n(o.UnansweredStructure({browserBind:o.browserBind})))+" "+e(n(o.OurOrganisationStructure({browserBind:o.browserBind})))+" "+e(n(o.RegulationStructure({browserBind:o.browserBind})))+' <opts> <opt name="internalValueField">FilterState</opt> <opt name="internalCaptionField">FilterStateText</opt> <opt name="value" bind="OutgoingLettersFilter/button/ФильтрСостояние"></opt> <opt name="caption" bind="OutgoingLettersFilter/caption/ФильтрСостояние"></opt> <opt name="resetValue" type="string">-1</opt> <opt name="itemTemplate" type="null">null</opt> </opts> </options> </option> <option name="fastDataFilterConfig"> <opt name="className">edo-tasks__fastDataFilter</opt> <opt name="idProperty" value="name"></opt> <options name="filterStructure" type="array"> <opts> <opt name="internalValueField">FilterAuthorOrResponsibleMe</opt> <opt name="internalCaptionField">FilterAuthorOrResponsibleMeText</opt> <opt name="value" bind="OutgoingLettersFilter/button/ФильтрВладелец"></opt> <opt name="caption" bind="OutgoingLettersFilter/caption/ФильтрВладелец"></opt> <opt name="resetValue">Все</opt> </opts> <opts> <opt name="internalValueField">FilterState</opt> <opt name="internalCaptionField">FilterStateText</opt> <opt name="value" bind="OutgoingLettersFilter/button/ФильтрСостояние"></opt> <opt name="caption" bind="OutgoingLettersFilter/caption/ФильтрСостояние"></opt> <opt name="resetValue" type="string">-1</opt> </opts> </options> </option> <option name="operationsPanelConfig"> <options name="items" type="array"> <options> <option name="name">save</option> <option name="componentType">js!SBIS3.EDO.OperationUnload</option> <options name="type"> <option name="mass">true</option> <option name="selection" type="boolean">true</option> </options> <options name="options"> <option name="fileName" value="Документы"></option> <options name="handlers"> <option name="onApplyOperation" type="function">js!SBIS3.EDO.LettersHandlers:setOutgoingPrintColumns</option> </options> </options> </options> </options> </option> </component> <component data-component="SBIS3.EDO2.OpenDialogAction"> <option name="name">OutgoingLettersOpenDialogAction</option> <option name="editMode">newFloatArea</option> <option name="mode">floatArea</option> <option name="objectName">'+e(n(o.objectName))+'</option> <option name="initializingWay" value="delayedRemote"></option> </component> ');return!0===o.useAutoRefresh&&(a+=' <component data-component="SBIS3.EDO.FEdoPartialReloader" name="PartialReloader"> <opt name="objectName" value="'+e(n(o.objectName))+'"/> <opt name="method" value="'+e(n(o.method))+'"/> <opt name="filterName" value="'+e(n(o.partialReloader.filterName||"СписокИдО"))+'"/> <opt name="sortField" value="'+e(n(o.partialReloader.sortField||"Дата"))+'"/> <opt name="overrideItemsSortMethod" value="true"/> <opt name="updateOnDeleteAndAdd" value="'+e(n(o.partialReloader.updateOnDeleteAndAdd||"false"))+'"/> <opt name="addServerChannelName" value="'+e(n(o.partialReloader.addServerChannelName||""))+'"/> <opt name="fixServerChannelName" value="'+e(n(o.partialReloader.fixServerChannelName||""))+'"/> <opt name="deleteServerChannelName" value="'+e(n(o.partialReloader.deleteServerChannelName||""))+'"/> <opts name="actionEventsToListen" type="array"> <opt value="onUpdateModel"/> ',o.partialReloader.onDestroyModelHandlingEnable&&(a+=' <opt value="onDestroyModel"/> '),a+=" ",o.partialReloader.onCreateModelHandlingEnable&&(a+=' <opt value="onCreateModel"/> '),a+=' </opts> <opt name="edoOpenDialogAction" value="OutgoingLettersOpenDialogAction"/> <opt name="complexKeyField" value="@Документ"/> </component> '),a+=" </div>",(a=e(a))+(i&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.OutgoingLetters"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.OutgoingLetters", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".letter_col_face1_pattern span{white-space:normal}"));head.appendChild(style);});}
define('js!SBIS3.EDO.OutgoingLetters',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.OutgoingLetters','js!SBIS3.EDO.AutocompleteHandlers','tmpl!SBIS3.EDO.BaseFilter.Period/resources/PeriodStructure','tmpl!SBIS3.EDO.BaseFilter.Marks/resources/MarksStructure','tmpl!SBIS3.EDO.BaseFilter.ResponsibleFace/resources/ResponsibleFaceStructure','tmpl!SBIS3.EDO.BaseFilter.Face1/resources/Face1Structure','tmpl!SBIS3.EDO.BaseFilter.Unanswered/resources/UnansweredStructure','tmpl!SBIS3.EDO.BaseFilter.OurOrganisation/resources/OurOrganisationStructure','tmpl!SBIS3.EDO.BaseFilter.Regulation/resources/RegulationStructure','js!SBIS3.EDO2.Browser','html!SBIS3.EDO2.Browser/resources/columns/ResponsibleColumn','html!SBIS3.EDO2.Browser/resources/columns/DateNumberColumn','html!SBIS3.EDO2.Browser/resources/columns/MainInfoColumn','html!SBIS3.EDO2.Browser/resources/columns/StateColumn','js!SBIS3.EDO2.OpenDialogAction','js!SBIS3.EDO.FEdoPartialReloader','js!SBIS3.EDO2.EdoColumnsClickDispatcher','js!SBIS3.EDO.LettersHandlers','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterResp','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterEventPerformer','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterOurOrg','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterFace1','js!SBIS3.EDO.FilterDeliveryMethodTemplate','js!SBIS3.EDO.LetterModel','css!SBIS3.EDO.OutgoingLetters','Elektronnyj_dokumentooborot_localization'],function(e,t,r,s,l,o,i,a,u,n){'use strict';var S=e.extend({_dotTplFn:t,$protected:{_options:{name:'OutgoingLetters',objectName:'КоррИсх',method:'СписокХраним',model:'edo.model.LetterModel',autocompleteTemplate:r.autocompleteTemplate,fastDataFilterConfig:{data:[{keyField:'key',displayField:'title',name:'FilterAuthorOrResponsibleMe',multiselect:false,className:'controls-DropdownList__withoutCross controls-DropdownList__linkStyle',values:[{key:'Все',value:'Все',title:rk('Все')},{key:'От меня',value:'От меня',title:rk('Мои')},{key:'От моего отдела',value:'От моего отдела',title:rk('Моего отдела')}]},{keyField:'key',displayField:'title',name:'FilterState',multiselect:false,className:'controls-DropdownList controls-DropdownList__linkStyle',values:[{key:'-1',title:rk('В любом состоянии')},{key:'10',title:rk('Внутренняя обработка')},{key:'2,3',title:rk('Недоставленные')},{key:'4',title:rk('Не получен ответ')},{key:'7',title:rk('Утвержденные')},{key:'9',title:rk('Отклоненные')},{key:'6',title:rk('С ошибками')},{key:'22',title:rk('Аннулированные')},{key:'0,1',title:rk('Черновики')},{key:'-2',title:rk('Удаленные')}]}]},browserBind:'OutgoingLettersFilter/button',periodStructure:s,MarksStructure:l,ResponsibleFaceStructure:o,Face1Structure:i,UnansweredStructure:a,OurOrganisationStructure:u,RegulationStructure:n}},$constructor:function(){},init:function(){S.superclass.init.call(this);var e=this.getChildControlByName('browserFastDataFilter');if(e)e.setItems(this._options.fastDataFilterConfig.data);r.setProcessingAutocompletion(this,'ФильтрПоЛицуИзСписка');}});return S;});
define("html!SBIS3.EDO.OutgoingLettersTab",function(){var o=function(o){var t=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;o.test(t);)t=t.replace(o,"&#123;&#123;$1&#125;&#125;");return t}}(),n=function(o){return o.join?o.join(""):o.toString()},e=function(o){return void 0===o?"":o&&"object"==typeof o?n(o):""+o},a="undefined"!=typeof process,i=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="ws-flexbox ws-flex-column ws-flex-grow-1 ws-flex-shrink-1 edo-OutgoingLettersTab"> <component data-component="SBIS3.Engine.BrowserTabs" name="OutgoingLettersTabBrowserTabs" class="edo-OutgoingLettersTab_tabs ws-flexbox ws-flex-column ws-flex-grow-1 ws-flex-shrink-1"> <options name="tabsArea" type="array"> <options> <option name="id">aGroup</option> <option name="content"> <div> <div class="edo-OutgoingLettersTab_toolbarItem"> <component data-component="SBIS3.EDO2.RulesSelector" name="OutgoingLettersTabRulesSelector"> <option name="width">200</option> <options name="docTypes" type="array"> <options> <option name="docType">'+t(e(o.objectName))+'</option> </options> </options> <option name="content"> <component data-component="SBIS3.CONTROLS/Menu/MenuButton" name="OutgoingLettersTabAddDocMenuButton"> <option name="caption">+ '+t(e(rk("Документ")))+'</option> <option name="primary">true</option> </component> </option> </component> </div> <div class="edo-OutgoingLettersTab_toolbarItem edo-OutgoingLettersTab_toolbarGap"> <component data-component="SBIS3.EDO.LoadButton" data-access="Исходящая корреспонденция"> <option name="from1C">true</option> <option name="incoming">false</option> <option name="docType">'+t(e(o.objectName))+'</option> </component> </div> </div> </option> </options> </options> <options name="mainArea" type="array"> <options> <option name="id">StatGroup</option> <option name="content">  <component name="OutgoingLettersTabStat" data-component="SBIS3.EDO.StatTemplate"> <option name="docType" value="'+t(e(o.objectName))+'"></option> <option name="StatTemplateName" value="ШаблонСтатистики"></option> <option name="template">js!SBIS3.EDO.StatOutgoing</option> <option name="needStatPrintBtn">true</option> <option name="className" value="external-statistics-indent"></option> </component>  </option> </options> <options> <option name="id">ListGroup</option> <option name="content"> <component data-component="SBIS3.EDO.OutgoingLetters"> <option name="useAutoRefresh">true</option> <opts name="partialReloader"> <opt name="onCreateModelHandlingEnable" value="true"/> <opt name="onDestroyModelHandlingEnable" value="true"/> </opts> </component> </option> </options> </options> <options name="tabs" type="array"> <options> <option name="id">StatTab</option> <option name="title">'+t(e(rk("Статистика")))+'</option> <option name="mainArea">StatGroup</option> </options> <options> <option name="id">ListTab</option> <option name="mainArea">ListGroup</option> <option name="tabsArea">aGroup</option> <option name="title">'+t(e(rk("Список")))+'</option> </options> </options> <option name="defaultTab">ListTab</option> <option name="tabsName">OutgoingLettersInnerTabs</option> <options name="handlers"> <option name="onTabChange" type="function">js!SBIS3.EDO.EdoCommon:onTabChangeNewRegistry</option> <option name="onTabAndMainLoaded" type="function">js!SBIS3.EDO.OutgoingLettersTab:prototype.onTabAndMainLoaded</option> </options> </component> </div>');return(i=t(i))+(a&&-1!==i.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.OutgoingLettersTab"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.OutgoingLettersTab", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-OutgoingLettersTab_toolbarItem{display:inline-block;float:left}.edo-OutgoingLettersTab_toolbarGap{margin-left:12px}.edo-OutgoingLettersTab,.edo-OutgoingLettersTab_tabs{height:100%;min-height:1px}.ws-webkit-old .edo-OutgoingLettersTab{height:calc(100% - 34px)}#contentArea{height:100%}"));head.appendChild(style);});}
define('js!SBIS3.EDO.OutgoingLettersTab',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.OutgoingLettersTab','optional!js!SBIS3.EDO.DocflowRulesHelpers','js!SBIS3.EDO.EdoCommon','SBIS3.CONTROLS/Button','js!SBIS3.EDO2.RulesSelector','SBIS3.CONTROLS/Menu/MenuButton','js!SBIS3.EDO.LoadButton','js!SBIS3.Engine.BrowserTabs','js!SBIS3.EDO.OutgoingLetters','js!SBIS3.EDO.StatTemplate','css!SBIS3.EDO.OutgoingLettersTab','Elektronnyj_dokumentooborot_localization'],function(t,e,o,n){'use strict';var i=t.extend({_dotTplFn:e,$protected:{_options:{name:'OutgoingLettersTab',objectName:'КоррИсх'}},$constructor:function(){},init:function(){i.superclass.init.call(this);},onTabAndMainLoaded:function(t,e){if('ListTab'==e){var i=this,s=i.getChildControlByName('OutgoingLettersTabRulesSelector'),r=i.getChildControlByName('OutgoingLettersBrowser'),u=i.getChildControlByName('OutgoingLettersOpenDialogAction');if(s){var S=s.getChildControlByName('OutgoingLettersTabAddDocMenuButton');if(S)S.subscribe('onMenuItemActivate',function(t,e){var n=this.getItems().getRecordById(e),i;if(n&&!o.ruleIsFolder(n))i={record:n},r.addItem(i);});}if(u&&r)r.subscribe('onEdit',function(t,e){u.execute(e);});n.initScopes(r);}}});return i;});
define("html!SBIS3.EDO.OutgoingEventTab",function(){var o=function(o){var n=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;o.test(n);)n=n.replace(o,"&#123;&#123;$1&#125;&#125;");return n}}(),t=function(o){return o.join?o.join(""):o.toString()},e=function(o){return void 0===o?"":o&&"object"==typeof o?t(o):""+o},i="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="ws-flexbox ws-flex-column ws-flex-grow-1 edo-OutgoingEventTab_wrapper"> <component data-component="SBIS3.Engine.BrowserTabs" name="OutgoingEventsTabs" class="ws-flexbox ws-flex-column ws-flex-grow-1" style="height:100%;"> <options name="tabsArea" type="array"> <options> <option name="id">aGroup</option> <option name="content" type="content"> <component data-component="SBIS3.EDO.InOutDocumentButtons" name="InOutDocumentButtons"> <options name="docTypes" type="array"> <option>ДокОтгрИсх</option> <option>ФактураИсх</option> <option>КоррИсх</option> <option>АктСверкиДок</option> <option>ДоговорДок</option> <option>СчетИсх</option> </options> <option name="from1C">true</option> <option name="incoming">false</option> <option name="LBdocType">'+n(e(rk("Исходящие")))+'</option> </component> </option> </options> </options> <options name="mainArea" type="array"> <options> <option name="id">StatGroup</option> <option name="content">  <component name="КомпонентСтатистикиИсходящие" data-component="SBIS3.EDO.StatTemplate"> <option name="docType" value="КоррИсх"></option> <option name="StatTemplateName" value="ШаблонСтатистики"></option> <option name="template">js!SBIS3.EDO.StatOutgoingEvents</option> <option name="needStatPrintBtn">true</option> <option name="className" value="external-statistics-indent"></option> </component>  </option> </options> <options> <option name="id">ContrListGroup</option> <option name="content"> <component data-component="SBIS3.EDO.OutgoingEvents"> <option name="contragentAnswers" value="true"></option> <option name="useAutoRefresh">true</option> <opts name="partialReloader"> <opt name="fixServerChannelName" value="edo.task-fix"/> <opt name="onDestroyModelHandlingEnable" value="true"/> </opts> </component> </option> </options> <options> <option name="id">ListGroup</option> <option name="content"> <component data-component="SBIS3.EDO.OutgoingEvents"> <option name="useAutoRefresh">true</option> <opts name="partialReloader"> <opt name="onCreateModelHandlingEnable" value="true"/> <opt name="onDestroyModelHandlingEnable" value="true"/> <opt name="allowedSeveralPhasesOfDoc" value="true"/> </opts> </component> </option> </options> </options> <options name="tabs" type="array"> <options> <option name="id">StatTab</option> <option name="title">'+n(e(rk("Статистика")))+'</option> <option name="mainArea">StatGroup</option> </options> <options> <option name="id">ContrListTab</option> <option name="mainArea">ContrListGroup</option> <option name="tabsArea">aGroup</option> <option name="title">'+n(e(rk("Ответы контрагентов")))+'</option> </options> <options> <option name="id">ListTab</option> <option name="mainArea">ListGroup</option> <option name="tabsArea">aGroup</option> <option name="title">'+n(e(rk("Отправленные")))+'</option> </options> </options> <option name="defaultTab">ListTab</option> <options name="handlers"> <option name="onTabChange" type="function">js!SBIS3.EDO.EdoCommon:onTabChangeNewRegistry</option> <option name="onTabAndMainLoaded" type="function">js!SBIS3.EDO.OutgoingEventTab:prototype.onTabAndMainLoaded</option> </options> </component> </div>');return(a=n(a))+(i&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.OutgoingEventTab"}},o});
define("html!SBIS3.EDO.OutgoingEvents",function(){var o=function(o){var e=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(e){for(;o.test(e);)e=e.replace(o,"&#123;&#123;$1&#125;&#125;");return e}}(),t=function(o){return o.join?o.join(""):o.toString()},n=function(o){return void 0===o?"":o&&"object"==typeof o?t(o):""+o},i="undefined"!=typeof process,p=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div style="height:100%;" class="ws-flexbox ws-flex-column ws-flex-grow-1"> <component data-component="SBIS3.EDO2.Browser" name="OutgoingEventsBrowser" class="OutgoingEventsBrowser ws-flexbox ws-flex-column ws-flex-grow-1" style="height:100%;"> <option name="searchConfig"> '+e(n(o.autocompleteTemplate.apply(this,[o])))+' </option> <options name="hierarchy"> <option name="hierarchy">false</option> </options> <option name="breadCrumbsConfig" type="array"> <option name="visible" value="false" type="boolean"></option> </option> ');return o.contragentAnswers?p+=' <option name="historyId">OutgoingEventsAnswer1</option> ':p+=' <option name="historyId">OutgoingEvents1</option> ',p+=' <option name="useScope">true</option> <options name="ignoreFiltersList" type="array"> <option>ФильтрОтветыКонтрагентов</option> <option>ФильтрИзСписка</option> </options> <option name="isSingleTypeBrowser">false</option> <options name="browserOptions"> <option name="bind">outgoingEventsFilter/button</option> <options name="common"> <option name="objectName">РеестрИсходящих</option> <option name="method">СписокСобытий</option> <option name="destroyMethod">Удалить</option> <option name="viewMode">table</option> <option name="model">'+e(n(o.model||"DocsInOutModel"))+"</option> ",o.contragentAnswers&&(p+=' <options name="filterParams"> <option name="ФильтрОтветыКонтрагентов" value="true"></option> </options> '),p+=' </options> <option name="infiniteScroll">down</option> <option name="pageSize">25</option> <option name="viewMode">table</option> <option name="idProperty">@Событие</option> <option name="showHead">false</option> <options name="columns" type="array"> <options> <option name="cellTemplate">tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TDocDateTimeColumn</option> <options name="includedTemplates"> <option name="DateNumberColumn">tmpl!SBIS3.EDO2.Browser/resources/columns/tmpl/DateNumberColumn</option> </options> <option name="width">1</option> </options> <options> <option name="cellTemplate">html!SBIS3.EDO2.Browser/resources/columns/MainInfoColumn</option> </options> <options> <option name="cellTemplate">html!SBIS3.EDO2.Browser/resources/columns/StateColumn</option> <option name="width">1</option> </options> <options> <option name="cellTemplate">html!SBIS3.EDO2.Browser/resources/columns/ResponsibleColumn</option> <option name="fixedSize">true</option> <option name="width">1</option> <option name="className">inOutDoc_responsible</option> </options> </options> <options name="ladder" type="array"> <option>date_col</option> </options> <options name="handlers"> <options name="onItemClick" type="array"> <option name="onItemClick" type="function">js!SBIS3.EDO.EdoClicks:clickDispPartialReloaderSetCookie</option> </options> <options name="onChangeHoveredItem" type="array"> <option name="onChangeHoveredItem" type="function">js!SBIS3.EDO.EdoRecOptions:onChangeHoveredItemEvents</option> </options> </options> <options name="itemsActionsVisibility"> <option name="edoSaveDocumentOnDisk" value="false"></option> <option name="edoSendDocument" value="false"></option> <option name="edoOpenInNewTab" value="false"></option> <option name="edoDeleteDocument" value="false"></option> <option name="edoShowDkPanel" value="false"></option> <option name="edoPostDocument" value="false"></option> <option name="edoRestoreDocument" value="false"></option> </options> <options name="massActionsVisibility"> <option name="edoDeleteDocumentMass" value="false"></option> <option name="edoRestoreDocumentMass" value="false"></option> </options> <options name="itemsActions" type="array"> <options> <option name="icon">sprite:icon-16 icon-Erase icon-error</option> <option name="name">edoDeleteDocument</option> <option name="tooltip">'+e(n(rk("Удалить")))+'</option> <option name="caption">'+e(n(rk("Удалить")))+'</option> <option name="isMainAction">false</option> <option name="onActivated" type="function">js!SBIS3.EDO.EdoRecOptions:deleteRecordToTrashNew</option> </options> <options> <option name="icon">sprite:icon-16 icon-Restore icon-done</option> <option name="name">edoRestoreRedaction</option> <option name="tooltip">'+e(n(rk("Восстановить")))+'</option> <option name="caption">'+e(n(rk("Восстановить")))+'</option> <option name="isMainAction">false</option> <option name="onActivated" type="function">js!SBIS3.EDO.EdoRecOptions:restoreRecordFromTrash</option> </options> </options> </options> <option name="filterButtonConfig"> ',o.contragentAnswers?p+=' <option name="template">js!SBIS3.EDO.FilterOutgoingNewAnswer</option> ':p+=' <option name="template">js!SBIS3.EDO.FilterOutgoingNew</option> ',p+=' <option name="additionalFilterParamsTemplate">js!SBIS3.EDO.FilterOutgoingNewSelector</option> <options name="filterStructure" type="array"> '+e(n(o.periodStructure({browserBind:o.browserBind})))+' <opts> <opt name="internalValueField">FilterState</opt> <opt name="internalCaptionField">FilterStateText</opt> <opt name="value" bind="outgoingEventsFilter/button/ФильтрСостояние"></opt> <opt name="caption" bind="outgoingEventsFilter/caption/ФильтрСостояние"></opt> <opt name="resetValue" type="string">-1</opt> <opt name="itemTemplate" type="null">null</opt> </opts> <opts> <opt name="internalValueField">FilterOurOrganisation</opt> <opt name="internalCaptionField">FilterOurOrganisationText</opt> <opt name="value" bind="outgoingEventsFilter/button/ФильтрДокументНашаОрганизация"></opt> <opt name="caption" bind="outgoingEventsFilter/caption/ФильтрДокументНашаОрганизация"></opt> <opts name="resetValue" type="array"></opts> <opt name="itemTemplate" type="function" value="tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterOurOrg"/> <opt name="historyItemTemplate" type="function" value="tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterOurOrg"/> </opts> '+e(n(o.MarksStructure({browserBind:o.browserBind})))+" "+e(n(o.ResponsibleFaceStructure({browserBind:o.browserBind})))+" "+e(n(o.Face1Structure({browserBind:o.browserBind})))+" "+e(n(o.AuthorOrResponsibleMeStructure({browserBind:o.browserBind,captionBind:"outgoingEventsFilter/caption/ФильтрВладелец"})))+" "+e(n(o.RegulationStructure({browserBind:o.browserBind})))+" "+e(n(o.UnreadStructure({browserBind:o.browserBind})))+" "+e(n(o.UnfixedStructure({browserBind:o.browserBind})))+" "+e(n(o.SpecificPerformerStructure({browserBind:o.browserBind})))+" "+e(n(o.DocumentTypeStructure({browserBind:o.browserBind,captionBind:"outgoingEventsFilter/caption/ФильтрТипДокументаВД"})))+' </options> </option> <option name="fastDataFilterConfig"> <opt name="className">edo-tasks__fastDataFilter</opt> <opt name="idProperty" value="name"></opt> <options name="filterStructure" type="array"> <opts> <opt name="internalValueField">FilterAuthorOrResponsibleMe</opt> <opt name="internalCaptionField">FilterAuthorOrResponsibleMeText</opt> <opt name="value" bind="outgoingEventsFilter/button/ФильтрВладелец"></opt> <opt name="caption" bind="outgoingEventsFilter/caption/ФильтрВладелец"></opt> <opt name="resetValue">Все</opt> <opt name="itemTemplate" type="null">null</opt> </opts> <opts> <opt name="internalValueField">FilterState</opt> <opt name="internalCaptionField">FilterStateText</opt> <opt name="value" bind="outgoingEventsFilter/button/ФильтрСостояние"></opt> <opt name="caption" bind="outgoingEventsFilter/caption/ФильтрСостояние"></opt> <opt name="resetValue" type="string">-1</opt> <opt name="itemTemplate" type="null">null</opt> </opts> <opts> <opt name="internalValueField">FilterDocType</opt> <opt name="internalCaptionField">FilterDocTypeText</opt> <opt name="value" bind="outgoingEventsFilter/button/ТипДокументаВД"></opt> <opt name="caption" bind="outgoingEventsFilter/caption/ФильтрТипДокументаВД"></opt> <opt name="pickerClassName">controls-DropdownList__picker out_events</opt> <opt name="allowDblClick" type="boolean">false</opt> <options name="resetValue" type="array"> <option type="string">Все</option> </options> </opts> </options> </option> <option name="operationsPanelConfig"> <options name="items" type="array"> <options> <option name="name">print</option> <option name="componentType">js!SBIS3.EDO.OperationPrint</option> <options name="type"> <option name="mass">true</option> <option name="selection" type="boolean">true</option> </options> <options name="options"> <option name="documentIdField">@Документ</option> <options name="items" type="array"> <options> <option name="id">filtered</option> <option name="title">'+e(n(rk("Фактуры, накладные, акты")))+'</option> <option name="onActivated" type="function">js!SBIS3.EDO.OperationPrint:prototype.filteredPrint</option> </options> <options> <option name="id">files_print</option> <option name="title">'+e(n(rk("Все документы")))+'</option> <option name="onActivated" type="function">js!SBIS3.EDO.OperationPrint:prototype.filesPrint</option> </options> </options> <option name="minPrintWindowWidth">666</option> <option name="exportDocuments" type="boolean">true</option> <option name="xsl" value="Электронный документооборот/Реестры/xslt/reestr_events_new.xsl"></option> <option name="filteredObjectName">ДокОтгрИсх</option> <option name="filteredMethodName">ПечатьВложенийСФильтром</option> <options name="handlers"> <option name="onApplyOperation" type="function">js!SBIS3.EDO.EdoOperationsCommon:documentsPreparePrintColumns</option> </options> </options> </options> <options> <option name="name">edoDeleteRedactionMass</option> <option name="componentType">js!SBIS3.EDO.OperationDelete</option> <options name="type"> <option name="selection" type="boolean">true</option> </options> <options name="options"> <option name="registryMode">events</option> </options> </options> <options> <option name="name">btnRestoreDocs</option> <option name="componentType">js!SBIS3.EDO.OperationRestore</option> <options name="type"> <option name="selection" type="boolean">true</option> </options> </options> <options> <option name="name">btnMassAccounting</option> <option name="componentType">js!SBIS3.EDO.OperationMassAccounting</option> <options name="type"> <option name="selection" type="boolean">true</option> </options> </options> </options> </option> </component> <component data-component="SBIS3.EDO2.OpenDialogAction" name="action"> <option name="name">OutgoingEventsAction</option> <option name="editMode">newFloatArea</option> <option name="isDocsReestr">true</option> </component> ',!0===o.useAutoRefresh&&(p+=' <component data-component="SBIS3.EDO.FEdoPartialReloader" name="PartialReloader"> <opt name="objectName" value="'+e(n(o.objectName||"РеестрИсходящих"))+'"/> <opt name="method" value="'+e(n(o.method||"СписокСобытий"))+'"/> <opt name="filterName" value="'+e(n(o.partialReloader.filterName||"СписокИдО"))+'"/> <opt name="sortField" value="'+e(n(o.partialReloader.sortField||"Начало"))+'"/> <opt name="overrideItemsSortMethod" value="true"/> <opt name="updateOnDeleteAndAdd" value="'+e(n(o.partialReloader.updateOnDeleteAndAdd||"false"))+'"/> <opt name="addServerChannelName" value="'+e(n(o.partialReloader.addServerChannelName||""))+'"/> <opt name="fixServerChannelName" value="'+e(n(o.partialReloader.fixServerChannelName||""))+'"/> <opt name="deleteServerChannelName" value="'+e(n(o.partialReloader.deleteServerChannelName||""))+'"/> <opts name="actionEventsToListen" type="array"> <opt value="onUpdateModel"/> ',o.partialReloader.onDestroyModelHandlingEnable&&(p+=' <opt value="onDestroyModel"/> '),p+=" ",o.partialReloader.onCreateModelHandlingEnable&&(p+=' <opt value="onCreateModel"/> '),p+=' </opts> <opt name="edoOpenDialogAction" value="OutgoingEventsAction"/> <opt name="allowedSeveralPhasesOfDoc" value="'+e(n(o.partialReloader.allowedSeveralPhasesOfDoc||"false"))+'"/> <opt name="registryKeyFromCookie" value="PartialReloader_CurrentEvent"/> </component> '),p+=" </div> ",(p=e(p))+(i&&-1!==p.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.OutgoingEvents"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.OutgoingEvents", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".event_date .datecol_small .datecol_date{color:#000;font-size:14px;vertical-align:top!important;text-align:right!important}.event_date .datecol_small .datecol_time{color:#ccc!important}.controls-DropdownList__picker .out_events .controls-ListView__defaultItem{display:none}.pereh_col .no_icon{padding-left:0}.ws-is-mobile-platform .controls-Browser__filterButton{max-width:160px!important}.OutgoingEventsBrowser .datecol_small{padding-top:1px}.OutgoingEventsBrowser .edo-DateCol_icon_unread{position:absolute;margin-top:-19px;margin-left:5px}#contentArea{height:100%}"));head.appendChild(style);});}
define('js!SBIS3.EDO.OutgoingEvents',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.OutgoingEvents','js!SBIS3.EDO.AutocompleteHandlers','tmpl!SBIS3.EDO.BaseFilter.Period/resources/PeriodStructure','tmpl!SBIS3.EDO.BaseFilter.Marks/resources/MarksStructure','tmpl!SBIS3.EDO.BaseFilter.ResponsibleFace/resources/ResponsibleFaceStructure','tmpl!SBIS3.EDO.BaseFilter.AuthorOrResponsibleMe/resources/AuthorOrResponsibleMeStructure','tmpl!SBIS3.EDO.BaseFilter.Face1/resources/Face1Structure','tmpl!SBIS3.EDO.BaseFilter.Regulation/resources/RegulationStructure','tmpl!SBIS3.EDO.BaseFilter.Unfixed/resources/UnfixedStructure','tmpl!SBIS3.EDO.BaseFilter.Unread/resources/UnreadStructure','tmpl!SBIS3.EDO.BaseFilter.SpecificPerformer/resources/SpecificPerformerStructure','tmpl!SBIS3.EDO.BaseFilter.OurOrganisation/resources/OurOrganisationStructure','tmpl!SBIS3.EDO.BaseFilter.DocumentType/resources/DocumentTypeStructure','css!SBIS3.EDO.OutgoingEvents','js!SBIS3.EDO2.Browser','html!SBIS3.EDO2.Browser/resources/columns/ResponsibleColumn','js!SBIS3.EDO.DocDateCol','js!SBIS3.EDO.DateCol','html!SBIS3.EDO2.Browser/resources/columns/StateColumn','html!SBIS3.EDO2.Browser/resources/columns/MainInfoColumn','tmpl!SBIS3.EDO2.Browser/resources/columns/tmpl/DateNumberColumn','tmpl!SBIS3.EDO.BrowserWrapperPP/resources/columns/TDocDateTimeColumn','js!SBIS3.EDO2.OpenDialogAction','js!SBIS3.EDO.FEdoPartialReloader','js!SBIS3.EDO.EdoRecOptions','js!SBIS3.EDO.EdoOperationsCommon','js!SBIS3.EDO.EdoClicks','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterOurOrg','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterResp','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterEventPerformer','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterFace1','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterStateListItem','js!SBIS3.EDO2.MarksFilterRowTemplate','js!SBIS3.EDO.OperationPrint','js!SBIS3.EDO.OperationUnload','js!SBIS3.EDO.DocsInOutModel','Elektronnyj_dokumentooborot_localization'],function(e,t,r,l,s,o,i,u,n,a,S,c,p,m){'use strict';var B=e.extend({_dotTplFn:t,$protected:{_options:{autocompleteTemplate:r.autocompleteTemplate,fastDataFilterConfig:{data:[{keyField:'key',displayField:'title',name:'FilterAuthorOrResponsibleMe',multiselect:false,className:'controls-DropdownList__withoutCross controls-DropdownList__linkStyle',values:[{key:'Все',title:rk('Все'),value:'Все',level:0},{key:'От меня',title:rk('От меня'),value:'От меня',level:0},{key:'От моего отдела',value:'От моего отдела',title:rk('От моего отдела'),level:0}]},{keyField:'key',displayField:'title',name:'FilterState',multiselect:false,className:'controls-DropdownList controls-DropdownList__linkStyle',values:[{key:'-1',title:rk('В любом состоянии'),level:0},{key:'10',title:rk('Внутренняя обработка'),level:0},{key:'2,3',title:rk('Недоставленные'),level:0},{key:'4',title:rk('Не получен ответ'),level:0},{key:'7',title:rk('Утвержденные'),level:0},{key:'9',title:rk('Отклоненные'),level:0},{key:'6',title:rk('С ошибками'),level:0},{key:'22',title:rk('Аннулированные'),level:0},{key:'19,20',title:rk('Удалено мной/контрагентом'),level:0},{key:'0,1',title:rk('Черновики'),level:0},{key:'-2',title:rk('Удаленные'),level:0}]},{keyField:'ТипДокументаВД',displayField:'Название',name:'FilterDocType',multiselect:true,className:'controls-DropdownList__withoutCross controls-DropdownList__linkStyle',values:[{'ТипДокументаВД':'Все','Название':rk('Все типы документов')},{'ТипДокументаВД':'АктВР,АктПП','Название':rk('Акты (услуги, работы, права)')},{'ТипДокументаВД':'ЭДОНакл','Название':rk('Накладные')},{'ТипДокументаВД':'СчФктр,УпдСчфДоп','Название':rk('Счета-фактуры (вкл. в составе УПД)')},{'ТипДокументаВД':'УпдДоп','Название':rk('Передаточные документы')},{'ТипДокументаВД':'счФактКор','Название':rk('Счета-фактуры корректировочные')},{'ТипДокументаВД':'АктСвер','Название':rk('Акты сверки')},{'ТипДокументаВД':'Договор','Название':rk('Договоры')},{'ТипДокументаВД':'ЭДОСч','Название':rk('Счета')}]}]},browserBind:'outgoingEventsFilter/button',periodStructure:l,MarksStructure:s,ResponsibleFaceStructure:o,AuthorOrResponsibleMeStructure:i,Face1Structure:u,RegulationStructure:n,UnfixedStructure:a,UnreadStructure:S,SpecificPerformerStructure:c,OurOrganisationStructure:p,DocumentTypeStructure:m}},$constructor:function(){},init:function(){B.superclass.init.call(this);var e=this,t=this.getChildControlByName('OutgoingEventsBrowser'),l=this.getChildControlByName('browserFastDataFilter'),s=this.getChildControlByName('browserFilterButton');if(l)l.setItems(this._options.fastDataFilterConfig.data);if(l)l.subscribe('onApplyFilter',function(){var e=this.getFilterStructure()[2];if('FilterDocType'==e.internalValueField){var t=e.value;if(t&&'object'==typeof t&&t.length>0&&'Все'==t[0])if(s&&s._picker)s._picker.getChildControlByName('EDOFilter').getLinkedContext().setValue('FilterDocTypeShow',false);}});r.setProcessingAutocompletion(e),t.subscribeTo(t,'onStartCommand',function(e,t){if('edoCopyDocument'===t.commandName)t.args[0].createStartEvent=true;});}});return B;});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.OutgoingEventTab", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-OutgoingEventTab_wrapper{height:100%;min-height:1px}.ws-is-firefox.ws-is-desktop-platform .edo-OutgoingEventTab_wrapper,.ws-is-ie.ws-is-desktop-platform .edo-OutgoingEventTab_wrapper{height:calc(100% - 34px)}"));head.appendChild(style);});}
define('js!SBIS3.EDO.OutgoingEventTab',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.OutgoingEventTab','js!SBIS3.EDO.EdoCommon','WS.Data/Source/SbisService','js!SBIS3.EDO.InOutDocumentButtons','js!SBIS3.EDO.OutgoingEvents','js!SBIS3.Engine.BrowserTabs','js!SBIS3.EDO.EdoOperationsCommon','css!SBIS3.EDO.OutgoingEventTab','Elektronnyj_dokumentooborot_localization'],function(t,n,o,e){'use strict';var a=t.extend({_dotTplFn:n,$protected:{_options:{}},$constructor:function(){},init:function(){a.superclass.init.call(this);var t=this;new e({endpoint:'ГлобальныеПараметрыКлиента'}).call('ПолучитьЗначение',{'Путь':'unit_contracts_converted'}).addCallback(function(n){if('true'!==n.getRawData()){for(var o=t.getChildControlByName('InOutDocumentButtons').getChildControlByName('addDocumentButton'),e=o._options.docTypes,a=0;a<e.length;a++)if('ДоговорДок'===e[a].docType)e[a].docType='ДоговорИсх';o.setDocTypes(e);}}),new e({endpoint:'ГлобальныеПараметрыКлиента'}).call('ПолучитьЗначение',{'Путь':'unit_reconciliations_converted'}).addCallback(function(n){if('true'!==n.getRawData()){for(var o=t.getChildControlByName('InOutDocumentButtons').getChildControlByName('addDocumentButton'),e=o._options.docTypes,a=0;a<e.length;a++)if('АктСверкиДок'===e[a].docType)e[a].docType='АктСверИсх';o.setDocTypes(e);}});},onTabAndMainLoaded:function(t,n){if('StatTab'!=n)o.initTaskButtons({mainObject:this.getCurrentTabArea('main'),tabsObject:this.getCurrentTabArea('tabs'),btnDocName:'addDocumentButton',brwName:'OutgoingEventsBrowser',actionName:'OutgoingEventsAction',folderButtonName:null,rootFolderName:null,folderAction:null,dialogComponents:{'904203de-34b9-411d-bd05-e51e6b91ab40':'js!SBIS3.EDO.FContractOut','fdbbfd83-64f6-4ae1-9761-625b114ec4bd':'js!SBIS3.EDO.ReconciliationReportOut','bc5f60fd-2633-45e0-a817-41a89910d074':'js!SBIS3.EDO.ReconciliationReportIn','534888e6-8c29-4c11-9530-774d485b639b':'js!SBIS3.EDO.ReconciliationReportIn','635f32d6-974d-4096-935a-44822f8672d0':'js!SBIS3.EDO.FContractIn'}});}});return a;});
define("html!SBIS3.EDO.RegistryUnallocatedMode",function(){var o=function(o){var e=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(e){for(;o.test(e);)e=e.replace(o,"&#123;&#123;$1&#125;&#125;");return e}}(),t=function(o){return o.join?o.join(""):o.toString()},n=function(o){return void 0===o?"":o&&"object"==typeof o?t(o):""+o},i="undefined"!=typeof process,a=("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),p='<div class="edo-RegistryUnallocated ws-flexbox ws-flex-column ws-flex-grow-1 ws-flex-shrink-1" style="min-height:1px;"> <component data-component="SBIS3.EDO2.Browser" name="RegistryUnallocatedModeBrowser" class="RegistryUnallocatedModeBrowser ws-flex-shrink-1 ws-flexbox ws-flex-column ws-flex-grow-1" style="min-height:1px;"> <options name="browserOptions"> <option name="bind">docsUnallocatedFilter/button</option> <option name="historyId">RegistryUnallocated</option> <options name="ladder" type="array"> <option>face_foto</option> <option>date_col</option> </options> <option name="tileTemplate" type="ref" value="'+e(n(function(o,e){var t=a.randomId();return o[t]=e,t}(function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,o.tileTemplate)))+'"></option> <options name="includedTemplates"> <option name="photoTpl">html!SBIS3.PersonCore.Photo/photoCellTpl</option> </options> <options name="templateBinding"> <option name="photoFldName">userPhotoData</option> <option name="cssClass">person-photo-mini-large</option> </options> <options name="columns" type="array"> <options> <option name="cellTemplate">html!SBIS3.EDO.TaskCol</option> <option name="title">&nbsp;</option> <options name="includedTemplates"> <option name="photoTpl">html!SBIS3.PersonCore.Photo/photoCellTpl</option> </options> <option name="className">controls-DataGridView-cell-overflow-ellipsis</option> <options name="templateBinding"> <option name="photoFldName">userPhotoData</option> <option name="cssClass">person-photo-mini-large</option> <option name="useFaceField">true</option> <option name="useFilelist">true</option> </options> </options> <options> <option name="cellTemplate">html!SBIS3.EDO.DocDateCol</option> <options name="includedTemplates"> <option name="DateCol">html!SBIS3.EDO.DateCol</option> </options> <options name="templateBinding"> <option name="only_date">true</option> </options> <option name="className">event_date</option> <option name="fixedSize">true</option> <option name="title">&nbsp;</option> <option name="width">50</option> </options> </options> <options name="itemsActionsVisibility"> <option name="edoSaveDocumentOnDisk" value="false"></option> <option name="edoSendDocument" value="false"></option> <option name="edoOpenInNewTab" value="false"></option> <option name="edoShowDkPanel" value="false"></option> <option name="edoPostDocument" value="false"></option> <option name="edoLockDocument" value="false"></option> <option name="edoCancelLockDocument" value="false"></option> <option name="edoShowMarksPanel" value="false"></option> <option name="edoCopyDocument" value="false"></option> </options> <options name="massActionsVisibility"> <option name="edoSetCloseStatusMass" value="false"></option> <option name="edoPostsMass" value="false"></option> <option name="edoSetMarksMass" value="false"></option> <option name="edoExecuteMass" value="false"></option> <option name="edoPrintDocumentMass" value="true"></option> <option name="edoSetDocumentReadedMass" value="false"></option> </options> <options name="massActionsSettings"> <options name="edoPrintDocumentMass"> <option name="minPrintWindowWidth">666</option> <option name="exportDocuments" value="false"></option> <options name="handlers"> <option name="onApplyOperation" type="function">js!SBIS3.EDO.RegistryUnallocatedModeHandlers:setPrintColumns</option> </options> </options> </options> <options name="common"> <option name="objectName">Нерасп</option> <option name="method">СписокДокументов</option> <option name="model">UnallocDocModel</option> </options> </options> <option name="breadCrumbsConfig" type="array"> <option name="visible" value="false" type="boolean"></option> </option> <option name="operationsPanelConfig"> <options name="items" type="array"> <options> <option name="name">save</option> <option name="componentType">SBIS3.CONTROLS/OperationsPanel/Unload</option> <options name="type"> <option name="mass">true</option> <option name="selection" type="boolean">true</option> </options> <options name="options"> <option name="fileName" value="Реестр"></option> <options name="handlers"> <options name="onApplyOperation" type="array"> <option name="onApplyOperation" type="function">js!SBIS3.EDO.RegistryUnallocatedModeHandlers:setPrintColumns</option> </options> </options> </options> </options> </options> </option> <option name="filterButtonConfig"> <option name="template"> js!SBIS3.EDO.UnallocatedFilterNew </option> <option name="additionalFilterParamsTemplate"> js!SBIS3.EDO.UnallocatedFilterNewSelector </option> <options name="filterStructure" type="array"> <opts> <opt name="internalValueField">FilterDatePeriod</opt> <opt name="internalCaptionField">FilterDatePeriodText</opt> <opt name="value" bind="docsUnallocatedFilter/button/ФильтрДатаПериод"></opt> <opt name="resetValue">Все</opt> </opts> <opts> <opt name="internalValueField">FilterDateFrom</opt> <opt name="internalCaptionField">FilterDateFromEmptyText</opt> <opt name="value" bind="docsUnallocatedFilter/button/ФильтрДатаС"></opt> <opt name="resetValue" type="null">null</opt> <opt name="itemTemplate" type="null">null</opt> <opt name="historyItemTemplate" type="null">null</opt> </opts> <opts> <opt name="internalValueField">FilterDateTo</opt> <opt name="internalCaptionField">FilterDateToEmptyText</opt> <opt name="value" bind="docsUnallocatedFilter/button/ФильтрДатаП"></opt> <opt name="resetValue" type="null">null</opt> <opt name="itemTemplate" type="null">null</opt> <opt name="historyItemTemplate" type="null">null</opt> </opts> <opts> <opt name="internalValueField">FilterDeleted</opt> <opt name="internalCaptionField">FilterDeletedText</opt> <opt name="internalVisibilityField">FilterDeletedVisibility</opt> <opt name="value" bind="docsUnallocatedFilter/button/ФильтрУдаленные"></opt> <opt name="resetValue" type="boolean">null</opt> <opt name="resetVisibilityValue">false</opt> </opts> <opts> <opt name="internalValueField">FilterRegistered</opt> <opt name="internalCaptionField">FilterRegisteredText</opt> <opt name="internalVisibilityField">FilterRegisteredVisibility</opt> <opt name="value" bind="docsUnallocatedFilter/button/ФильтрРаспределенные"></opt> <opt name="resetValue" type="boolean">null</opt> <opt name="resetVisibilityValue">false</opt> </opts> <opts> <opt name="internalValueField">FilterAuthorOrResponsible</opt> <opt name="internalCaptionField">FilterAuthorOrResponsibleText</opt> <opt name="internalVisibilityField">FilterAuthorOrResponsibleVisibility</opt> <opt name="value" bind="docsUnallocatedFilter/button/ФильтрАвтор"></opt> <opts name="resetValue" type="array"></opts> <opt name="resetVisibilityValue">false</opt> <opt name="itemTemplate" type="function" value="tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterAuthor"/> <opt name="historyItemTemplate" type="function" value="tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterAuthor"/> </opts> <opts> <opt name="internalValueField">FilterAuthorOrResponsibleMe</opt> <opt name="internalCaptionField">FilterAuthorOrResponsibleMeText</opt> <opt name="internalVisibilityField">FilterAuthorOrResponsibleMeVisibility</opt> <opt name="value" bind="docsUnallocatedFilter/button/ФильтрВладелец" nonexistent="Все"></opt> <opt name="resetValue">Все</opt> <opt name="resetVisibilityValue">false</opt> </opts> </options> </option> </component> <component data-component="SBIS3.EDO2.OpenDialogAction" name="action"> <option name="name">UnallocatedActionMode</option> <option name="editMode">newFloatArea</option> </component> <component data-component="SBIS3.EDO.FEdoPartialReloader" name="PartialReloader"> <opt name="objectName" value="Нерасп"/> <opt name="method" value="СписокДокументов"/> <opt name="filterName" value="СписокИдО"/> <opt name="sortField" value="Дата"/> <opt name="docKeyField" value="@Документ"/> <opt name="edoOpenDialogAction" value="UnallocatedActionMode"/> <opts name="actionEventsToListen" type="array"> <opt value="onUpdateModel"/> <opt value="onDestroyModel"/> <opt value="onCreateModel"/> </opts> <opt name="updateAccordeonCountersEventName" value=""/> </component> </div>';return(p=e(p))+(i&&-1!==p.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.RegistryUnallocatedMode"}},o});
define('js!SBIS3.EDO.UnallocDocModel',['js!SBIS3.EDO2.EdoModel','WS.Data/Collection/RecordSet','Elektronnyj_dokumentooborot_localization'],function(e,i){'use strict';return e.extend({$protected:{_options:{from_registry:true,is_opendoc:false,properties:{visibleRegisterButton:{get:function(){return(this._isFromRegistry()||this._isOpenDoc())&&!this.get('Удален')&&!this._isRegistered();}},visibleAttachFile:{get:function(){return!this.get('Удален')&&!this._isRegistered();}},visibleSendBuhButton:{get:function(){return!this._isFromRegistry()&&!this._isOpenDoc();}},visibleSendContButton:{get:function(){return!this._isFromRegistry()&&!this._isOpenDoc();}},attachedDocsList:{get:function(){return this.getModelField('РП.Документ/СписокВложений');}},visibleSwitchVisibilityMode:{get:function(){return this.get('РП.Документ').get('СписокВложений').getCount()>0;}},commandsData:{get:function(){return{passageButton:{visible:false,primary:false},saveButton:{visible:(this._isFromRegistry()||this._isOpenDoc())&&!this.get('Удален')&&!this._isRegistered(),primary:(this._isFromRegistry()||this._isOpenDoc())&&!this.get('Удален')&&!this._isRegistered()},restoreButton:{visible:this.get('Удален')&&!this._isRegistered(),primary:this.get('Удален')&&!this._isRegistered()}};}},serviceButtonsData:{get:function(){var e=this._getDkConfig(),t=[{id:'edoPrintDocument',className:'edo-Dialog_header-ServiceButtons_item',icon:'sprite:icon-24 icon-Print icon-primary',caption:rk('Распечатать'),visible:true,showType:1,command:'edoPrintDocument',componentType:'SBIS3.CONTROLS/Button/IconButton'},{id:'edoDeleteDocument',className:'edo-Dialog_header-ServiceButtons_item',icon:'sprite:icon-24 icon-Erase icon-error',caption:rk('Удалить'),visible:true,minRights:2,showType:1,command:'edoDeleteDocument',componentType:'SBIS3.CONTROLS/Button/IconButton'},{id:'edoSaveDocumentOnDisk',className:'edo-Dialog_header-ServiceButtons_item',icon:'sprite:icon-24 icon-Save icon-primary',caption:rk('Выгрузить'),visible:!this._isRegistered(),showType:1,componentType:'SBIS3.CONTROLS/Menu/MenuIcon'},{id:'edoSaveDocumentOnDisk_asZIP',className:'edo-Dialog_header-ServiceButtons_item',caption:rk('в ZIP'),visible:!this._isRegistered(),showType:0,icon:'sprite:icon-24 icon-DocumentZip icon-primary',componentType:'SBIS3.CONTROLS/Button/IconButton',command:'edoSaveDocumentOnDisk',parent:'edoSaveDocumentOnDisk',commandArgs:[{type:'zip'}]},{id:'edoSaveDocumentOnDisk_asPDF',className:'edo-Dialog_header-ServiceButtons_item',caption:rk('в PDF'),icon:'sprite:icon-24 icon-PDF icon-primary',visible:!this._isRegistered(),showType:0,command:'edoSaveDocumentOnDisk',componentType:'SBIS3.CONTROLS/Button/IconButton',parent:'edoSaveDocumentOnDisk',commandArgs:[{type:'pdf'}]},{id:'edoOpenInNewTab',className:'edo-Dialog_header-ServiceButtons_item',icon:'sprite:icon-24 icon-NewTab icon-primary',caption:rk('Открыть в новой вкладке'),visible:true,showType:0,command:'edoOpenInNewTab',componentType:'SBIS3.CONTROLS/Button/IconButton'},{id:'edoSendMessage',className:'edo-Dialog_header-ServiceButtons_item',icon:'sprite:icon-24 icon-EmptyMessage icon-primary',caption:rk('Сообщения'),visible:true,showType:0,command:'edoSendMessage',componentType:'SBIS3.CONTROLS/Button/IconButton'},{id:'edoGetLink',className:'edo-Dialog_header-ServiceButtons_item',icon:'sprite:icon-24 icon-Link icon-primary',caption:rk('Получить ссылку на документ'),visible:true,showType:0,command:'edoGetLink',componentType:'SBIS3.CONTROLS/Button/IconButton'},{id:'edoShowMonitoringDialog',className:'edo-Dialog_header-ServiceButtons_item',icon:'sprite:icon-24 icon-Show icon-primary',caption:rk('Поставить на контроль'),visible:true,showType:0,command:'edoShowMonitoringDialog',componentType:'SBIS3.CONTROLS/Button/IconButton'},{id:'edoShowHistory',className:'edo-Dialog_header-ServiceButtons_item',icon:'sprite:icon-24 icon-ExpandList icon-primary',caption:rk('История'),visible:true,showType:0,command:'edoShowHistory',componentType:'SBIS3.CONTROLS/Button/IconButton'}],o=new i({idProperty:'id',rawData:t}),n=this._getUserServiceCommands();return o.append(n),o;}}}}},$constructor:function(){var e=window.location.pathname;this._options.from_registry=e.indexOf('registry.html')>=0,this._options.is_opendoc=e.indexOf('opendoc.html')>=0;},_isFromRegistry:function(){return this._options.from_registry;},_isOpenDoc:function(){return this._options.is_opendoc;},_isRegistered:function(){return 7===this.get('ДокументРасширение.СостояниеКраткое').get();}});});
define('js!SBIS3.EDO.UnallocatedHandlers',['Lib/Control/Control','WS.Data/Source/SbisService','WS.Data/Entity/Record','WS.Data/Collection/RecordSet','WS.Data/Adapter/Sbis','Core/helpers/fast-control-helpers','Core/UserConfig','Core/Indicator','Core/EventBus','Core/ParallelDeferred','Core/Deferred','Core/constants','js!SBIS3.EDO.EdoHandlers','js!SBIS3.EDO.EdoCounters','js!SBIS3.EDO.Filters','js!SBIS3.EDO2.OpenDialogAction','SBIS3.CONTROLS/Utils/InformationPopupManager','Elektronnyj_dokumentooborot_localization'],function(e,t,n,o,a,r,i,l,s,d,c,u,f,C,g,h,p){'use strict';var S;return S={loadNeraspDocs:function(){var t=this,n=new d(),o,a,r;n.push(e.ControlStorage.waitChildByName('ОбластьКомандСКнопкой').addCallback(function(e){e.getTopParent().getLinkedContext().setValue('СоздаватьБезРегламента',true),o=e;})),n.push(e.ControlStorage.waitChildByName('ОбластьДляВставкиКнопокЗакладок').addCallback(function(e){a=e;})),n.push(e.ControlStorage.waitChildByName('ШаблонБраузеров').addCallback(function(e){r=e;})),n.done().getResult().addCallback(function(){i.getParam(g.generateBrowserFilterParameterName('НераспДок')).addCallback(function(t){f.setDocBookmark(a);var n=o.getLinkedContext();o.getTopParent().getLinkedContext().setValue('ТипыДокументов',[{docType:'Нерасп',docSubType:null}]),n.setValue('РучныеРегламенты',void 0),n.setValue('ИмяБраузера','НераспДок'),n.setValue('СоздаватьБезРегламента',true),r.setTemplate('js!SBIS3.EDO.UnallocatedList').addCallback(function(n){e.ControlStorage.waitChildByName('НераспДок').addCallback(function(e){var n=e.getQuery();if(null!==t&&void 0!==t)n=f.deSerializeString(t);return e.setQuery(n),e;});}),o.setTemplate('КнопкиДокументовВнутренние'),a.clearTemplate();});});},onNeraspDocToSave:function(e,n,o,a){var r=new c();return l.show(),this.createDocFromNerasp(e,n,o,a,function(o){var a=parseInt(o.get('@Документ'),10),r=new h();r.subscribe('onExecuted',function(o,a,r){if(!a)new t({endpoint:n}).call('Удалить',{'ИдО':r.getId()}),S.updateCounter();else{var i=e.getLinkedContext(),l=i.getRecord().get('@Документ');e.getRecord().commit(),new t({endpoint:'Нерасп'}).call('КоличествоВнешнихДокументов',{'Документ':parseInt(l,10)}).addCallback(function(t){if(0===t){var n=i.getRecord()||i.getValue('record');if(n)if(n.commit)n.commit();else if(n.acceptChanges)n.acceptChanges();i.setValue('forceClose',true),e.close();}else e._controllerEDO.reload();}),S.updateCounter();}}),r.execute({id:a,isNewRecord:true,minWidth:e.getTopParent().getContainer().width()});},true),r;},onExtFilesDataLoaded:function(t){if(!this.getRecordCount())e.ControlStorage.waitChildByName('RegisterMenuButton').addCallback(function(e){e.setEnabled(false);});else e.ControlStorage.waitChildByName('RegisterMenuButton').addCallback(function(e){e.setEnabled(true);});},onChangeSelection:function(t,n,o){if(this.getSelection(true).length>0)e.ControlStorage.waitChildByName('RegisterMenuButton').addCallback(function(e){e.setCaption(rk('Зарегистрировать отмеченные'));});else e.ControlStorage.waitChildByName('RegisterMenuButton').addCallback(function(e){e.setCaption(rk('Зарегистрировать'));});},onLoadedFileClipboard:function(e,n){var o=this.getTopParent(),a=o.getTopParent().getLinkedContext().getRecord().get('@Документ'),r=null;try{r=o.getChildControlByName('СписокВложений').getCurrentRootId();}catch(e){r=null;}if(a>0)new t({endpoint:'Документ'}).call('ДобавитьВД',{'ИД':n.result,'Документ':a,'фБезНазвания':true,'фЭтоСкан':false,'вПапку':String(r)}).addCallback(function(e){s.channel('loadEDODoc').notify('onLoadEDODoc',a);});},onLoadedScan:function(e,n){var o=this.getTopParent(),a=o.getLinkedContext().getRecord().get('@Документ'),r=null;try{r=o.getChildControlByName('СписокВложений').getCurrentRootId();}catch(e){r=null;}if(a>0)new t({endpoint:'Документ'}).call('ДобавитьВД',{'ИД':n.result,'Документ':a,'фБезНазвания':true,'фЭтоСкан':true,'вПапку':String(r)}).addCallback(function(e){s.channel('loadEDODoc').notify('onLoadEDODoc',a);});},onSelectType:function(e,t,n){var o=e.get('ТипДокумента'),a=this,r=a.getOpener();a.close(),S.onNeraspDocToSave(r,o);},onNeraspDocToSend:function(){var t=this.getName();if('btnSendCont'==t||'btnSendBuh'==t||'saveButton'==t){var n=e.ControlStorage.getByName(t).getTopParent(),o=n.getRecord();if(n.getChildControlByName('СписокВложений').getRecordSet().getRecordCount()>0){if('btnSendCont'==t){l.show();var a=this.getTopParent().getChildControlByName('СписокВложений'),i=a.getSelection(true).length?a.getSelection(true):a.getRecordSet().getRecords(),s=[];for(var d in i)if(i.hasOwnProperty(d))s.push(i[d].get('ИдО'));S.createDocFromNerasp(n,'КоррИсх',s,null,function(e){DocOpener.openDocByIDDocument(parseInt(e.get('@Документ'),10),{onlyNew:true,minWidth:n.getContainer().width()}),o.commit(),n.getLinkedContext().setValue('forceClose',true),n.close(),l.hide();},false);}else if('btnSendBuh'==t){var u=new c();n.getChildControlByName('ДокументНерасп').sendCommand('save',u,true),u.createDependent().addCallback(function(){require(['js!SBIS3.Navigation.LeftNavigation'],function(e){e.getInstance().reloadStructure();}),l.hide(),n.close();}).addErrback(function(e){l.hide();});}}else r.alert(rk('Не загружен ни один документ'));}},createDocFromNerasp:function(e,o,a,r,i,s){var d=new n();if(e.getTopParent().hasChildControlByName('extNameField'))d.addColumn('ДокументРасширение.Название',n.FIELD_TYPE_STRING),d.set('ДокументРасширение.Название',e.getTopParent().getChildControlByName('extNameField').getValue());if(d.addColumn('НазваниеТипДокумента',n.FIELD_TYPE_STRING),d.addColumn('ИдРегламента',n.FIELD_TYPE_STRING),d.set('НазваниеТипДокумента',o),d.set('ИдРегламента',r?r.guid:null),s)d.addColumn('ВызовИзБраузера',n.FIELD_TYPE_BOOLEAN),d.set('ВызовИзБраузера',true);new t({endpoint:'Документ'}).call('ЕстьРасширение',{'Объект':o}).addCallback(function(n){new t({endpoint:n}).call('Создать',{'ИмяМетода':n+'.Список','Фильтр':d}).addCallback(function(n){new t({endpoint:'Документ'}).call('СкопироватьВнешниеДокументы',{'ДокументОснование':parseInt(e.getTopParent().getContext().getRecord().get('@Документ'),10),'ДокументСледствие':parseInt(n.get('@Документ'),10),'ВидСвязи':1,'СписокВД':a}).addCallback(function(){i(n);}).addErrback(function(){l.hide();});}).addErrback(function(){l.hide();});}).addErrback(function(){l.hide();});},afterLoadHandler:function(e,t,n){var o=S.parseResultFiles(t);if(0===t.loadedFiles.length&&o.hasUnallocated&&!o.hasErrors)l.setMessage(rk('Пожалуйста, подождите')+'...'),S.createNeraspFromFiles(t.errorFiles,n,function(e){var t=parseInt(e.getRow().get('@Документ'),10);require(['js!SBIS3.EDO2.OpenDialogAction'],function(e){var n=new e(),o={},a;if(o.id=t,o.isNewRecord=true,a=n.execute(o),a)n.subscribe('onReady',function(){l.hide(),n.getLinkedContext().setValue('isMainLoad',true);});});},true),e.setResult(false);},afterScanHandler:function(e,o,a,r){if(o.result){l.show();var i=new n({rawData:{_type:'record',d:[],s:[{n:'ВызовИзБраузера',t:'Логическое'}]},adapter:'adapter.sbis'});i.set('ВызовИзБраузера',true),new t({endpoint:'Нерасп'}).call('Создать',{'ИмяМетода':'Нерасп.Список','Фильтр':i}).addCallback(function(e){var n=parseInt(e.getRow().get('@Документ'),10);new t({endpoint:'Документ'}).call('ДобавитьВД',{'ИД':o.result,'Документ':n,'фБезНазвания':true,'фЭтоСкан':true}).addCallback(function(){var e;if(r)e={brows:r,onlyNew:true,componentOptions:{}};else e={onlyNew:true,componentOptions:{}};require(['js!SBIS3.EDO2.OpenDialogAction'],function(e){var t=new e(),o={},a;if(o.id=n,o.isNewRecord=true,a=t.execute(o),a)t.subscribe('onExecuted',function(e,t,n){if(l.hide(),r)r.getChildControlByName('RegistryUnallocatedModeBrowser').getView().reload();S.updateCounter();});});}).addErrback(function(){l.hide();});}).addErrback(function(){l.hide();});}},afterScanHandlerIntf:function(e,t){var n=this.getTopParent();S.afterScanHandler(e,t,false,n);},createNeraspFromFiles:function(e,o,a,r){var i=new n();if(r)i=new n({rawData:{_type:'record',d:[true],s:[{n:'ВызовИзБраузера',t:'Логическое'}]},adapter:'adapter.sbis'});new t({endpoint:'Нерасп'}).call('Создать',{'ИмяМетода':'Нерасп.Список','Фильтр':i}).addCallback(function(t){S.loadFilesToDoc(e,t,o,function(e){a(t);});}).addErrback(function(){l.hide();});},loadFilesToDoc:function(e,n,r,i){var s=[],d='number'===$.type(n)?n:parseInt(n.getRow().get('@Документ'),10),c,u=[];for(c in e)if(e.hasOwnProperty(c))u.push([e[c].fileKey,d,'ЭДО']);var f=new o({adapter:new a(),rawData:{_type:'recordset',d:u,s:[{n:'@ЗагружаемыйФайл',t:'Число целое'},{n:'Документ',t:'Число целое'},{n:'ТипЗагрузчика',t:'Строка'}]}});new t({endpoint:'СессияЗагрузки'}).call('ДополнитьДанныеФайлов',{'ДанныеФайлов':f}).addCallback(function(){new t({endpoint:'СессияЗагрузки'}).call('Загрузить',{'ИдСессии':r}).addCallback(function(){var e=500,n=function(){new t({endpoint:'СессияЗагрузки'}).call('ПолучитьРезультат',{'ИдСессии':r}).addCallback(function(t){var o=t.getScalar();if(!o)setTimeout(function(){n();},e);else i(o);}).addErrback(function(){l.hide();});};n();});}).addErrback(function(e){l.hide();});},onBeforeRenderUnloadedFilesHandler:function(e,t){var n=S.parseResultFiles(t);e.setResult({template:'js!SBIS3.EDO.UnallocatedLoader',errorFiles:n.errorFiles,unallocatedFiles:n.unallocatedFiles});},showDocTypePanel:function(e){var t={opener:e,name:'TypeListSelect',template:'js!SBIS3.EDO.UnallocatedTypeList',isStack:true,overlay:false,parent:null,autoHeight:true,handlers:{}};r.showFloatAreaSelector(t,S.onSelectType);},listHeadRender:function(e){var t=e.find('td');t.eq(2).attr('colspan',2).addClass('colspan-title'),t.eq(1).remove();},isInside:function(){if('inside.tensor.ru'==window.location.host||'dev-online.sbis.ru'==window.location.host||'test-inside.tensor.ru'==window.location.host||'dev-inside.tensor.ru'==window.location.host)return true;else return false;},parseResultFiles:function(e){var t={hasFormat:false,hasUnallocated:false,hasErrors:false,unallocatedFiles:[],errorFiles:[]},n;if(e.loadedFiles.length>0)t.hasFormat=true;if(e.errorFiles.length>0)for(n in e.errorFiles)if(1==e.errorFiles[n].errorCode)t.hasUnallocated=true,t.unallocatedFiles.push(e.errorFiles[n]);else t.hasErrors=true,t.errorFiles.push(e.errorFiles[n]);return t;},onSelectReportTransform:function(e,t,n,o,a,r){if('excel'===r)e.setResult('Elektronnyj_dokumentooborot/Reestry/xslt/reestr_excel_unallocated.xsl');},updateCounter:function(){require(['js!SBIS3.Navigation.LeftNavigation'],function(e){var t=e.getInstance();if(t)C.nerasp_count().addCallback(function(e){t.setCounter({event:'registry-Undistr'},{counter:e.getRawData()?e.getRawData():'',title:String(e.getRawData()||'')});});});},onSearchStringSuggest:function(e,t,n){var o=this.getTopParent();if(!o)return;var a=o.getChildControlByName('ФильтрДокументовПоМаске');a.setValue(t.get('НазваниеИНН')),_filter_by_mask(a,t.get('ИНН'),'НераспДок');},onReadyDialog:function(){var e=this.getTopParent(),t=e.getChildControlByName('ListDocumentBigPrev'),n=e.getLinkedContext(),o=n.getRecord(),a=this,r=this.getOpener(),i=this.getContainer();if(!r&&'/Nerasp.html'!=window.location.pathname)i.find('.edoVDButtonsUnallocated').addClass('edoVDButtonsMainPage'),i.find('.edoUnallocatedFileScaner').addClass('edoFileScanerMainPage'),e.getChildControlByName('КомандыЭДО').subscribe('onReadyButtons',function(){this.getTopParent().getContainer().find('a.edo-ChangeDocButton').hide(),e.waitChildControlByName('btnSendBuh').addCallback(function(e){e.show();}),e.waitChildControlByName('btnSendCont').addCallback(function(e){e.show();}),e.waitChildControlByName('ChangeDocButtonPrimary').addCallback(function(e){e.hide();});});else i.find('.edoVDButtonsUnallocated').addClass('edoVDButtonsUnPage'),i.find('.edoUnallocatedFileScaner').addClass('edoFileScanerUnPage'),e.getChildControlByName('КомандыЭДО').subscribe('onReadyButtons',function(){if(e.getChildControlByName('extNameField').setActive(true),!o.get('Удален'))e.waitChildControlByName('Зарегистрировать').addCallback(function(e){e.show();});});if(e.subscribe('onBeforeShowConfirmDialog',function(e,t){if(!this.getTopParent().getOpener())t.commit();return e.setResult(true),true;}),require(['js!SBIS3.EDO.UnallocatedHandlers'],function(t){e.once('onBeforeClose',t.onClose);}),this._controllerEDO.isDocDisabled()&&!n.getValue('ДокументРасширение.Название'))e.getChildControlByName('extNameField').hide();t.subscribe('onRowOptions',function(e,t,n,o){if(1===this.getRecordCount()){var a=o;return a.push('deleteDocument'),a;}}),t.subscribe('onAfterLoadRecordSet',function(e,t,n){if(1===t.getRecordCount())if(this._options.documentViewer.panel.deleteDocument=false,this.hasChildControlByName('ПросмотрщикДокументов')){var o=this.getChildControlByName('ПросмотрщикДокументов');o._options.panel.deleteDocument=false,o._options.panel.isCanDeleteDoc=false;}});},onSave:function(e){if(this.getTopParent().getChildControlByName('СписокВложений').getRecordSet().getRecordCount()<1)r.alert(rk('Не загружен ни один документ')),e.setResult(false);else{var t=this;e.setResult(true),require(['js!SBIS3.EDO.UnallocatedHandlers'],function(e){t.getTopParent().unsubscribe('onBeforeClose',e.onClose),t.getTopParent().once('onBeforeClose',e.onCloseDoc);});}},onCloseDoc:function(e){var t=this.getOpener();if(t)t.getTopParent().getChildControlByName('browserView').reload(),S.updateCounter();},onClose:function(e){var n=this;if(!n.getTopParent().getOpener())if(e.setResult(false),!n.getLinkedContext().getValue('forceClose'))p.showConfirmDialog({message:rk('Отправить в бухгалтерию?'),details:rk('Чтобы продолжить редактирование нажмите, \xABОтмена\xBB.'),hasCancelButton:true},function(){var e=new c();n.getTopParent().getChildControlByName('ДокументНерасп').sendCommand('save',e,true),e.createDependent().addCallback(function(){n.close();});},function(){n.close();},function(){require(['js!SBIS3.EDO.UnallocatedHandlers'],function(e){n.getTopParent().once('onBeforeClose',e.onClose);});});else e.setResult(true),n.close();else{e.setResult(true);var o=this.getRecord().get('@Документ');this.getChildControlByName('СписокВложений').getRecordsCount().addCallback(function(e){if(0==e)new t({endpoint:'Документ'}).call('Удалить',{'ИдО':o}).addCallback(function(){S.updateCounter();});});}},renderFace1ColumnTitle:function(){return $('<span>&nbsp;</span>');},onFinishCommand:function(e,t){if('staticDeleteDocument'===t)S.updateCounter();this.getTopParent().getLinkedContext().setValue('forceClose',true);},onReadyFileScaner:function(){if(u.browser.IOSVersion||u.browser.isMobileAndroid||u.browser.isMobileSafari||u.browser.isMacOSDesktop||navigator&&-1==navigator.appVersion.indexOf('Win'))this.hide();}};});
define('js!SBIS3.EDO.RegistryUnallocatedModeHandlers',['i18n!SBIS3.EDO.RegistryUnallocatedModeHandlers','Elektronnyj_dokumentooborot_localization'],function(){'use strict';return{setPrintColumns:function(e){e.setResult([{field:'Дата',title:rk('Дата')},{field:'ДокументРасширение.Название',title:rk('Комментарий')},{field:'Сотрудник.Название',title:rk('Ответственный')}]);}};});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.RegistryUnallocatedMode", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".RegistryUnallocatedModeBrowser .controls-Browser__view table.controls-DataGridView__table{table-layout:fixed}.ws-webkit-old .edo-RegistryUnallocatedTabs_wrapper{height:calc(100% - 34px)}#contentArea{height:100%}"));head.appendChild(style);});}
define('js!SBIS3.EDO.RegistryUnallocatedMode',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.RegistryUnallocatedMode','html!SBIS3.EDO.TaskColBigPreview','WS.Data/Di','js!SBIS3.EDO.UnallocDocModel','WS.Data/Source/SbisService','js!SBIS3.EDO.UnallocatedHandlers','js!SBIS3.EDO.TaskColBigPreview','css!SBIS3.EDO.TaskColBigPreview','html!SBIS3.EDO.TaskCol','js!SBIS3.EDO.TaskCol','css!SBIS3.EDO.TaskCol','html!SBIS3.PersonCore.Photo/photoCellTpl','js!SBIS3.EDO2.Browser','js!SBIS3.EDO.EdoClicks','js!SBIS3.EDO.DocDateCol','js!SBIS3.EDO2.OpenDialogAction','js!SBIS3.EDO.RegistryUnallocatedModeHandlers','js!SBIS3.DOCVIEW.Preview','css!SBIS3.EDO.RegistryUnallocatedMode','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterAuthor','js!SBIS3.EDO.FEdoPartialReloader','i18n!SBIS3.EDO.RegistryUnallocatedMode','Elektronnyj_dokumentooborot_localization'],function(e,o,t,n,a,s,i){'use strict';var l=e.extend({_dotTplFn:o,$protected:{_options:{tileTemplate:t}},$constructor:function(){},init:function(){l.superclass.init.call(this),n.register('UnallocDocModel',a);var e=this.getChildControlByName('RegistryUnallocatedModeBrowser'),o=this.getChildControlByName('UnallocatedActionMode');e.subscribe('onEdit',function(e,t){t.initializingWay='delayedRemote',o.execute(t);}),o.subscribe('onExecuted',function(o,t,n){var a=n.get('@Документ'),l=n.get('ДокументРасширение.СостояниеКраткое');new s({endpoint:'Нерасп'}).call('КоличествоВнешнихДокументов',{'Документ':parseInt(a,10)}).addCallback(function(o){if(0===o.getRawData()&&0===l.get())e.sendCommand('notify','onUpdateModel'),i.updateCounter();});}),e.subscribe('onFinishCommand',function(e,o){if('edoDeleteDocument'==o.commandName||'edoRestoreDocument'==o.commandName)i.updateCounter();}),e.subscribe('onFinishMassOperation',function(e,o){if('edoDeleteDocumentMass'==o.operationName||'edoRestoreDocumentMass'==o.operationName)i.updateCounter();});}});return l;});
define("html!SBIS3.EDO.RegistryUnallocatedTabs",function(){var o=function(o){var n=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;o.test(n);)n=n.replace(o,"&#123;&#123;$1&#125;&#125;");return n}}(),t=function(o){return o.join?o.join(""):o.toString()},e=function(o){return void 0===o?"":o&&"object"==typeof o?t(o):""+o},a="undefined"!=typeof process,i=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="edo-RegistryUnallocatedTabs_wrapper ws-flexbox ws-flex-column ws-flex-grow-1 ws-flex-shrink-1" style="min-height:1px;"> <component data-component="SBIS3.Engine.BrowserTabs" class="edo-RegistryUnallocatedTabs ws-flexbox ws-flex-column ws-flex-grow-1 ws-flex-shrink-1" name="UnallocatedTabs" style="min-height:1px;"> <options name="tabs" type="array"> <options> <option name="id">ListTabUnallocated</option> <option name="mainArea">mainArea_Unallocated</option> <option name="tabsArea">tabsArea_Unallocated</option> <option name="title">'+n(e(rk("Нераспределенные")))+'</option> <option name="visible">false</option> </options> </options> <options name="mainArea" type="array"> <options> <option name="id">mainArea_Unallocated</option> <option name="content"> <component data-component="SBIS3.EDO.RegistryUnallocatedMode"> </component> </option> </options> </options> <options name="tabsArea" type="array"> <options> <option name="id">tabsArea_Unallocated</option> <option name="content"> <component data-component="SBIS3.EDO.UnallocatedTabButtons" name="UnallocatedTabButtons"></component> </option> </options> </options> <option name="tabsName">UnallocatedList</option> <option name="defaultTab">ListTabUnallocated</option> </component> </div>');return(i=n(i))+(a&&-1!==i.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.RegistryUnallocatedTabs"}},o});
define("html!SBIS3.EDO.UnallocatedTabButtons",function(){var o=function(o){var n=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;o.test(n);)n=n.replace(o,"&#123;&#123;$1&#125;&#125;");return n}}(),e=function(o){return o.join?o.join(""):o.toString()},t=function(o){return void 0===o?"":o&&"object"==typeof o?e(o):""+o},a="undefined"!=typeof process,i=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div> <div style="display: inline; float: left;"> <component name="scanButton" data-component="Lib/Control/FileScaner/FileScaner"> <option name="visible">true</option> <option name="className" value=""></option> <option name="renderStyle" value="asLink"></option> <option name="method" value="Документ.ЗагрузитьФайл"></option> <option name="createZip" value="false" type="boolean"></option> <option name="showInterface" value="false" type="boolean"></option> <option name="default" value="false" type="boolean"></option> <option name="image">sprite:icon-24 icon-Scan icon-primary</option> <option name="tabindex">3</option> <option name="imageAlign" value="left"></option> <option name="caption">'+n(t(rk("Скан")))+'</option> <option name="allowChangeEnable">true</option> <option name="enable">true</option> <options name="handlers"> <option name="onLoaded" type="function" value="js!SBIS3.EDO.UnallocatedHandlers:afterScanHandlerIntf"></option> <options name="onInit" type="array"> <option name="onInit" type="function" value="js!SBIS3.EDO.UnallocatedHandlers:onReadyFileScaner"></option> </options> </options> </component> </div> <div style="display: inline; float: left;"> <component data-component="SBIS3.EDO.UnallocatedAttachFile" name="bttAttachFile"> <option name="visible">true</option> </component> </div> <div style="display: inline; float: right;"> <component data-component="SBIS3.CONTROLS/Button/IconButton" name="switchDocMode"> <option name="name" value="switchDocMode"></option> <option name="className" value="ctrSwitchDocMode"></option> <option name="tooltip" value="Режим просмотра списка документов"></option> <options name="handlers"> <option name="onActivated" type="function" value="js!SBIS3.EDO.UnallocatedTabButtons:prototype.switchDocMode"></option> </options> </component> </div> </div>');return(i=n(i))+(a&&-1!==i.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.UnallocatedTabButtons"}},o});
define('js!SBIS3.EDO.UnallocatedTabButtonsHandlers',['Elektronnyj_dokumentooborot_localization'],function(){'use strict';var n;return n={};});
define("html!SBIS3.EDO.UnallocatedAttachFile",function(){var o=function(o){var n=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;o.test(n);)n=n.replace(o,"&#123;&#123;$1&#125;&#125;");return n}}(),e="undefined"!=typeof process,t=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div> <component data-component="SBIS3.CONTROLS/Menu/MenuLink" name="unallocatedAttachFile"> <option name="caption">Прикрепить</option> <option name="className">edoUnallocatedAttachFile</option> <option name="icon">sprite:icon-24 icon-Attach icon-primary</option> <option name="enabled" value="true" type="boolean"></option> <option name="allowChangeEnable" value="true" type="boolean"></option> <option name="visible" value="true"></option> <option name="parentProperty" value="hier"></option> <option name="idProperty">id</option> <options name="items" type="array"> <options> <option name="id">attachFromPC</option> <option name="title">с компьютера</option> </options> ');return o.notClipWorkSystem||(t+=' <options> <option name="id">attachFromBuffer</option> <option name="title">из буфера обмена</option> </options> '),t+=" </options> </component> <component data-component='Lib/Control/FileBrowse/FileBrowse'> <option name='name'>LoadFromHDD</option> <option name='multiple'>true</option> <option name='method'>Документ.ЗагрузитьФайл</option> <option name='visible'>false</option> <options name='handlers'> <option name='onLoaded' value='js!SBIS3.EDO.UnallocatedAttachFile:prototype.onLoadedFile' type='function'></option> </options> </component> <component data-component='Lib/Control/FileClipboardLoader/FileClipboardLoader'> <option name='name'>LoadFromClpb</option> <option name='method'>Документ.ЗагрузитьФайл</option> <option name='visible'>false</option> <options name='handlers'> <option name='onLoaded' value='js!SBIS3.EDO.UnallocatedAttachFile:prototype.onLoadedFile' type='function'></option> </options> </component> </div>",(t=n(t))+(e&&-1!==t.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.UnallocatedAttachFile"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.UnallocatedAttachFile", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edoUnallocatedAttachFile{padding-left:7px!important}"));head.appendChild(style);});}
define('js!SBIS3.EDO.UnallocatedAttachFile',['Core/core-functions','WS.Data/Source/SbisService','WS.Data/Entity/Record','Core/Indicator','Core/constants','SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.UnallocatedAttachFile','js!SBIS3.EDO.UnallocatedHandlers','SBIS3.CONTROLS/Menu/MenuLink','Lib/Control/FileBrowse/FileBrowse','Lib/Control/FileClipboardLoader/FileClipboardLoader','css!SBIS3.EDO.UnallocatedAttachFile','i18n!SBIS3.EDO.UnallocatedAttachFile','Elektronnyj_dokumentooborot_localization'],function(e,t,a,r,n,o,i,l){'use strict';var s=o.extend({_dotTplFn:i,$protected:{_options:{notClipWorkSystem:n.browser.IOSVersion||n.browser.isMobileAndroid||n.browser.isMobileSafari||n.browser.isMacOSDesktop||navigator&&-1==navigator.appVersion.indexOf('Win')},_insts:{_browser:null,_clipboard:null}},$constructor:function(){},_attachHandler:function(e,t){var a=this,r=a._notify('onBeforeStartLoad'),n=a.getParent(),o=a.getTopParent().getContext();switch(t){case'attachFromPC':n.getChildControlByName('LoadFromHDD').activate(window.event);break;case'attachFromBuffer':n.getChildControlByName('LoadFromClpb').getScreenshot();}},onLoadedFile:function(n,o,i){var s=this.getParent(),c;if(!o.error){if(i&&o.result>0)c=o.result;else{if(c='',o.result)c=o.result;else for(var d in o)if(o.hasOwnProperty(d))c+=o[d]['result']+',';if(!o.result&&c.length>0)c=c.substr(0,c.length-1);}if(c.length>0){var u=new a();u=new a({rawData:{_type:'record',d:[true],s:[{n:'ВызовИзБраузера',t:'Логическое'}]},adapter:'adapter.sbis'}),new t({endpoint:'Нерасп'}).call('Создать',{'ИмяМетода':'Нерасп.Список','Фильтр':u}).addCallback(function(e){var a=parseInt(e.getRow().get('@Документ'),10);new t({endpoint:'Документ'}).call('ДобавитьГруппуВД',{IDs:c,'Документ':a,'фБезНазвания':false,'фЭтоСкан':false}).addCallback(function(){require(['js!SBIS3.EDO2.OpenDialogAction'],function(e){var t=new e(),r={},n;if(r.id=a,r.isNewRecord=true,n=t.execute(r),n)t.subscribe('onExecuted',function(e,t,a){s.getTopParent().getChildControlByName('RegistryUnallocatedModeBrowser').getView().reload(),l.updateCounter();});});}).addErrback(function(){r.hide();});}).addErrback(function(){r.hide();});}}else e.alert(o.error.message,'error');},init:function(){var e=this;s.superclass.init.call(this),e._attachMenu=e.getChildControlByName('unallocatedAttachFile'),e._attachMenu.subscribe('onMenuItemActivate',e._attachHandler),e._attachMenu.subscribe('onActivated',function(t){e._attachMenu.setEnabled(true);});}});return s;});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.UnallocatedTabButtons", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".ctrSwitchDocMode{padding-left:8px;padding-right:2px}"));head.appendChild(style);});}
define('js!SBIS3.EDO.UnallocatedTabButtons',['Core/UserConfig','SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.UnallocatedTabButtons','js!SBIS3.EDO.UnallocatedHandlers','js!SBIS3.EDO.UnallocatedTabButtonsHandlers','SBIS3.CONTROLS/Button/IconButton','js!SBIS3.EDO.UnallocatedAttachFile','Lib/Control/FileScaner/FileScaner','css!SBIS3.EDO.UnallocatedTabButtons','Elektronnyj_dokumentooborot_localization'],function(e,t,n){'use strict';var o=t.extend({_dotTplFn:n,$protected:{_options:{}},$constructor:function(){this._publish('onChangeModeSwArea');},init:function(){o.superclass.init.call(this);},switchDocMode:function(){var t=this,n=t.getTopParent();e.getParam('modeUnallocatedDocs').addCallback(function(n){switch(n){case'bigPreview':e.setParam('modeUnallocatedDocs','listPreview'),t.setIcon('sprite:icon-24 icon-ArrangeList icon-primary'),t._notify('onChangeModeSwArea','table');break;case'listPreview':e.setParam('modeUnallocatedDocs','bigPreview'),t.setIcon('sprite:icon-24 icon-ArrangeSmallIconsPreview icon-primary'),t._notify('onChangeModeSwArea','tile');break;default:e.setParam('modeUnallocatedDocs','listPreview'),t.setIcon('sprite:icon-24 icon-ArrangeList icon-primary'),t._notify('onChangeModeSwArea','table');}});}});return o;});
define('js!SBIS3.EDO.RegistryUnallocatedTabs',['Core/UserConfig','Core/EventBus','SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.RegistryUnallocatedTabs','js!SBIS3.EDO.UnallocatedHandlers','Core/RightsManager','js!SBIS3.Engine.BrowserTabs','js!SBIS3.EDO.UnallocatedTabButtons','js!SBIS3.EDO.RegistryUnallocatedMode','i18n!SBIS3.EDO.RegistryUnallocatedTabs','Elektronnyj_dokumentooborot_localization'],function(e,t,n,o,a,i){'use strict';var r=n.extend({_dotTplFn:o,$protected:{_options:{}},$constructor:function(){},init:function(){r.superclass.init.call(this);var n=this,o=n.getChildControlByName('browserView'),s=n.getChildControlByName('switchDocMode'),l=n.getChildControlByName('unallocatedAttachFile'),c=n.getChildControlByName('scanButton');if(e.getParam('modeUnallocatedDocs').addCallback(function(e){if('bigPreview'==(e||'listPreview'))s.setIcon('sprite:icon-24 icon-ArrangeSmallIconsPreview icon-primary'),o.setViewMode('tile'),o.redraw();else s.setIcon('sprite:icon-24 icon-ArrangeList icon-primary'),o.setViewMode('table'),o.redraw();}),s.subscribe('onChangeModeSwArea',n._changeModeHandler.bind(n)),1==i.checkAccessRights(['Нераспределенные']))l.setEnabled(false),c.setEnabled(false);t.channel('DeleteChannel').subscribe('deleteToTrash',function(){a.updateCounter();});},_changeModeHandler:function(e,t){var n=this.getChildControlByName('browserView');n.setViewMode(t),n.redraw();}});return r;});
define("html!SBIS3.EDO.CustomStateColumn",function(){var e=function(e){var t=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;e.test(t);)t=t.replace(e,"&#123;&#123;$1&#125;&#125;");return t}}(),n=function(e){return e.join?e.join(""):e.toString()},r=function(e){return void 0===e?"":e&&"object"==typeof e?n(e):""+e},o="undefined"!=typeof process,u=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,"");return e.stateWidth=125,u+=" "+t(r(e.included.edoStateColumn(e))),(u=t(u))+(o&&-1!==u.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.CustomStateColumn"}},e});
define('js!SBIS3.EDO.CustomStateColumn',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.CustomStateColumn','Elektronnyj_dokumentooborot_localization'],function(t,n){'use strict';var o=t.extend({_dotTplFn:n,$protected:{_options:{}},$constructor:function(){},init:function(){o.superclass.init.call(this);}});return o;});
define("html!SBIS3.EDO.DateWithoutNumberColumn",function(){var e=function(e){var r=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(r){for(;e.test(r);)r=r.replace(e,"&#123;&#123;$1&#125;&#125;");return r}}(),n=function(e){return e.join?e.join(""):e.toString()},t=function(e){return void 0===e?"":e&&"object"==typeof e?n(e):""+e},o="undefined"!=typeof process,u=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,"");return e.showNumber=!1,u+=" "+r(t(e.included.edoDateNumber(e))),(u=r(u))+(o&&-1!==u.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.DateWithoutNumberColumn"}},e});
define('js!SBIS3.EDO.DateWithoutNumberColumn',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.DateWithoutNumberColumn','Elektronnyj_dokumentooborot_localization'],function(t,n){'use strict';var o=t.extend({_dotTplFn:n,$protected:{_options:{}},$constructor:function(){},init:function(){o.superclass.init.call(this);}});return o;});
define("html!SBIS3.EDO.OnDate",function(){var e=function(e){var t=function(){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},t=/&(?!#?\w+;)|<|>|"|'|\//g;return function(r){return r?r.toString().replace(t,function(t){return e[t]||t}):r}}(),r=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;e.test(t);)t=t.replace(e,"&#123;&#123;$1&#125;&#125;");return t}}(),n=function(e){return e.join?e.join(""):e.toString()},i=function(e){return void 0===e?"":e&&"object"==typeof e?n(e):""+e},o="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,""),d="Дата";e.templateBinding.date_field&&(d=e.templateBinding.date_field);e.ladder.setConverter(d,function(e){return e?rk("на","актуально")+" "+e.strftime("%d.%m"):""});var s=e.item.get(d)?e.item.get(d).strftime("%d.%m"):"";return a+=' <div class="on_date_col small-text" title="'+r(i(t(e.item.get(d)?e.item.get(d).strftime("%d.%m.%y"):"")))+'"> ',a+=" "+r(i('<span class="controls-ladder '+(e.ladder.isPrimary(e.item,d)?"":"ws-invisible")+'">'+(s?rk("на")+" "+s:"")+"</span>"))+" </div> ",(a=r(a))+(o&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.OnDate"}},e});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.OnDate", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".Reports .on_date_col{text-align:right;white-space:nowrap;color:#8991a9;line-height:25px}.controls-ListView__hoveredItem .on_date_col span.controls-ladder.ws-invisible{visibility:visible!important}.ws-is-firefox .Reports .on_date_col{line-height:26px}"));head.appendChild(style);});}
define('js!SBIS3.EDO.OnDate',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.OnDate','css!SBIS3.EDO.OnDate','i18n!SBIS3.EDO.OnDate','Elektronnyj_dokumentooborot_localization'],function(n,t){'use strict';var e=n.extend({_dotTplFn:t,$protected:{_options:{name:'OnDate'}},$constructor:function(){},init:function(){var n=this;e.superclass.init.call(n);}});return e;});
define("html!SBIS3.EDO.ReconciliationReportsBrowser",function(){var o=function(o){var e=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(e){for(;o.test(e);)e=e.replace(o,"&#123;&#123;$1&#125;&#125;");return e}}(),t=function(o){return o.join?o.join(""):o.toString()},n=function(o){return void 0===o?"":o&&"object"==typeof o?t(o):""+o},i="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="edo-ReconciliationBrowser ws-flexbox ws-flex-column ws-flex-grow-1"> <component data-component="SBIS3.EDO2.Browser" name="ReportsBrowser" class="Reports controls-Browser__hide-path ws-flexbox ws-flex-column ws-flex-grow-1"> <option name="useScope">true</option> <option name="searchConfig"> '+e(n(o.autocompleteTemplate.apply(this,[o])))+" </option> ");return o.incoming?a+=' <option name="historyId">ReconciliationReportsListIn</option> ':a+=' <option name="historyId">ReconciliationReportsListOut</option> ',a+=' <options name="browserOptions"> <option name=\'infiniteScroll\' value=\'down\'></option> <options name="common"> <option name="objectName">'+e(n(o.objectName))+'</option> <option name="method">'+e(n(o.method||"СписокХраним"))+'</option> <options name="filterParams"> <option name="ПростыеВД" value="true"></option> <option name="ВключитьСписокИсполнителей" value="true"></option> <option name="НазваниеТипаДокумента">'+e(n(o.objectName))+"</option> ",o.docRegistryType&&(a+=' <options name="ФильтрТипыДокументов" type="array"> <option name="value" value="'+e(n(o.docRegistryType))+'"></option> </options> '),a+=' </options> <option name="model">'+e(n(o.model||"ReconciliationReportsRegistryModel"))+'</option> </options> <option name="idProperty">@Документ</option> <option name="showHead">true</option> <option name="stickyHeader">true</option> <option name="multiselect">true</option> <option name="viewMode">table</option> <option name="className">reportsEdoBrowser</option> <option name="bind">reportsAllFilter/button</option> <options name="columns" type="array"> <options> <option name="cellTemplate">html!SBIS3.EDO.DateWithoutNumberColumn</option> <option name="fixedSize">false</option> <option name="width">58</option> <options name="includedTemplates"> <option name="edoDateNumber">html!SBIS3.EDO2.Browser/resources/columns/DateNumberColumn</option> </options> </options> <options> <option name="cellTemplate">html!SBIS3.EDO2.Browser/resources/columns/MainInfoColumn</option> <option name="fixedSize">false</option> <option name="width">*</option> </options> <options> <option name="cellTemplate">html!SBIS3.EDO.OnDate</option> <options name="templateBinding"> <option name="date_field">ДанныеДокумента.ДатаДокумента</option> </options> <option name="className">report-onDateField</option> <option name="fixedSize">false</option> <option name="width">58</option> </options> <options> <option name="title">'+e(n(rk("Нам должны")))+'</option> <option name="cellTemplate">html!SBIS3.EDO2.Browser/resources/columns/SumColumn</option> <options name="templateBinding"> <option name="fieldName">registryDebit</option> <option name="showPenny">true</option> </options> <option name="fixedSize">false</option> <option name="width">80</option> <option name="className">report-debitField controls-DataGridView__td__textAlignRight</option> </options> <options> <option name="title">'+e(n(rk("Мы должны")))+'</option> <option name="cellTemplate">html!SBIS3.EDO2.Browser/resources/columns/SumColumn</option> <options name="templateBinding"> <option name="fieldName">registryCredit</option> <option name="showPenny">true</option> </options> <option name="fixedSize">false</option> <option name="width">80</option> <option name="className">report-creditField controls-DataGridView__td__textAlignRight</option> </options> <options> <option name="cellTemplate">html!SBIS3.EDO2.Browser/resources/columns/StateColumn</option> <option name="width">1</option> </options> <options> <option name="cellTemplate">html!SBIS3.EDO2.Browser/resources/columns/ResponsibleColumn</option> <option name="width">1</option> </options> </options> <options name="ladder" type="array"> <option>date</option> <option>on_date_col</option> </options> <options name="itemsActionsVisibility"> <option name="edoSaveDocumentOnDisk" value="false"></option> <option name="edoSendDocument" value="false"></option> <option name="edoOpenInNewTab" value="false"></option> <option name="edoShowDkPanel" value="false"></option> <option name="edoPostDocument" value="false"></option> <option name="edoLockDocument" value="false"></option> <option name="edoCancelLockDocument" value="false"></option> </options> <options name="massActionsVisibility"> <option name="edoSetCloseStatusMass" value="false"></option> <option name="edoPostsMass" value="false"></option> <option name="edoShowRegistryHistory" value="true"></option> </options> <options name="massActionsSettings"> <options name="edoPrintDocumentMass"> <option name="documentIdField">@Документ</option> <option name="minPrintWindowWidth">667</option> <option name="xsl">/Elektronnyj_dokumentooborot/Reestry/xslt/reestr.xsl</option> <option name="exportDocuments" type="boolean">true</option> <options name="handlers"> <option name="onApplyOperation" type="function">js!SBIS3.EDO.ReconciliationReportsHandlers:setPrintColumns</option> <option name="onPrepareData" type="function">js!SBIS3.EDO.ReconciliationReportsHandlers:prepareData</option> </options> </options> <options name="edoShowRegistryHistory"> ',o.docRegistryType?a+=' <option name="objectHistoryName">'+e(n(o.docRegistryType))+"</option> ":a+=' <option name="objectHistoryName">'+e(n(o.docType))+"</option> ",a+=' </options> </options> </options> <option name="fastDataFilterConfig"> <opt name="className">edo-tasks__fastDataFilter</opt> <opt name="idProperty" value="name"></opt> <options name="filterStructure" type="array"> <opts> <opt name="internalValueField">FilterAuthorOrResponsibleMe</opt> <opt name="internalCaptionField">FilterAuthorOrResponsibleMeText</opt> <opt name="value" bind="reportsAllFilter/button/ФильтрВладелец"></opt> <opt name="caption" bind="reportsAllFilter/caption/ФильтрВладелец"></opt> <opt name="resetValue" type="string">Все</opt> </opts> <opts> <opt name="internalValueField">FilterState</opt> <opt name="internalCaptionField">FilterStateText</opt> <opt name="value" bind="reportsAllFilter/button/ФильтрСостояние"></opt> <opt name="caption" bind="reportsAllFilter/caption/ФильтрСостояние"></opt> <opt name="itemTemplate" type="null">null</opt> <opt name="resetValue" type="string">-1</opt> </opts> </options> </option> <option name="filterButtonConfig"> ',o.incoming?a+=' <option name="template">js!SBIS3.EDO.FilterReconciliationReportsIn</option> ':!1===o.incoming?a+=' <option name="template">js!SBIS3.EDO.FilterReconciliationReportsOut</option> ':a+=' <option name="template">js!SBIS3.EDO.FilterReconciliationReportsAll</option> ',a+=' <option name="additionalFilterParamsTemplate">js!SBIS3.EDO.FilterReconciliationReportsAllSelector</option> <options name="filterStructure" type="array"> <opts> <opt name="internalValueField">FilterState</opt> <opt name="internalCaptionField">FilterStateText</opt> <opt name="value" bind="reportsAllFilter/button/ФильтрСостояние"></opt> <opt name="caption" bind="reportsAllFilter/caption/ФильтрСостояние"></opt> <opt name="itemTemplate" type="null">null</opt> <opt name="resetValue" type="string">-1</opt> </opts> '+e(n(o.periodStructure({browserBind:o.browserBind})))+" "+e(n(o.DeletedStructure({browserBind:o.browserBind})))+" "+e(n(o.MarksStructure({browserBind:o.browserBind})))+" "+e(n(o.ResponsibleFaceStructure({browserBind:o.browserBind})))+" "+e(n(o.Face1Structure({browserBind:o.browserBind})))+" "+e(n(o.SignedStructure({browserBind:o.browserBind})))+" "+e(n(o.RegulationStructure({browserBind:o.browserBind})))+" "+e(n(o.OurOrganisationStructure({browserBind:o.browserBind})))+' </options> </option> <option name="operationsPanelConfig"> <options name="items" type="array"> <options> <option name="name">setControl</option> <option name="componentType">js!SBIS3.EDO.OperationControl</option> <options name="type"> <option name="selection" type="boolean">true</option> </options> <options name="options"> <option name="set">true</option> </options> </options> </options> </option> </component> <component data-component="SBIS3.EDO2.OpenDialogAction"> <option name="name">ReportsOpenDialogAction</option> <option name="editMode">newFloatArea</option> <option name="objectName">'+e(n(o.objectName))+'</option> <option name="initializingWay">delayedRemote</option> </component> ',!0===o.useAutoRefresh&&(a+=' <component data-component="SBIS3.EDO.FEdoPartialReloader" name="PartialReloader"> <option name="objectName">'+e(n(o.objectName))+'</option> <opt name="method" value="'+e(n(o.method||"СписокХраним"))+'"/> <opt name="filterName" value="'+e(n(o.partialReloader.filterName||"СписокИдО"))+'"/> <opt name="sortField" value="'+e(n(o.partialReloader.sortField||"Дата"))+'"/> <opt name="overrideItemsSortMethod" value="true"/> <opt name="updateOnDeleteAndAdd" value="'+e(n(o.partialReloader.updateOnDeleteAndAdd||"false"))+'"/> <opt name="addServerChannelName" value="'+e(n(o.partialReloader.addServerChannelName||""))+'"/> <opt name="fixServerChannelName" value="'+e(n(o.partialReloader.fixServerChannelName||""))+'"/> <opt name="deleteServerChannelName" value="'+e(n(o.partialReloader.deleteServerChannelName||""))+'"/> <opts name="actionEventsToListen" type="array"> <opt value="onUpdateModel"/> ',o.partialReloader.onDestroyModelHandlingEnable&&(a+=' <opt value="onDestroyModel"/> '),a+=" ",o.partialReloader.onCreateModelHandlingEnable&&(a+=' <opt value="onCreateModel"/> '),a+=' </opts> <opt name="edoOpenDialogAction" value="ReportsOpenDialogAction"/> </component> '),a+=" </div>",(a=e(a))+(i&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.ReconciliationReportsBrowser"}},o});
define('js!SBIS3.EDO.ReconciliationReportsHandlers',['Elektronnyj_dokumentooborot_localization'],function(){'use strict';return{setPrintColumns:function(e,t,i){e.setResult([{field:'ДатаПечать',title:rk('Дата')},{field:'Контрагент.ИНН',title:rk('КонтрагентИНН')},{field:'Контрагент.КПП',title:rk('КонтрагентКПП')},{field:'РП.НОИНН',title:rk('ОрганизацияИНН')},{field:'НашаОрганизация.КПП',title:rk('ОрганизацияКПП')},{field:'Лицо1.Название',title:rk('Описание')},{field:'ИнфоРегламентаПечать',title:rk('ТипДокумента')},{field:'Сотрудник.Название',title:rk('Ответственный')},{field:'РП.НазваниеПодразделения',title:rk('Подразделение')},{field:'ДокументРасширение.СостояниеКраткое',title:rk('Состояние')},{field:'ДатаРегистрацииПечать',title:rk('Дата начала периода')},{field:'ДатаДокументаПечать',title:rk('Дата окончания периода')}]);},prepareData:function(e,t){for(var i=['ДатаПечать','ДатаДокументаПечать','ДатаРегистрацииПечать','ИнфоРегламентаПечать'],l=0;l<i.length;l++)if(-1===t.getFormat().getFieldIndex(i[l]))t.addField({name:i[l],type:'string'});t.each(function(e){if(e.set('ДатаПечать',e.get('Дата')?e.get('Дата').strftime('%d.%m.%y'):''),e.set('ДатаДокументаПечать',e.get('ДанныеДокумента.ДатаДокумента')?e.get('ДанныеДокумента.ДатаДокумента').strftime('%d.%m.%y'):''),e.set('ДатаРегистрацииПечать',e.get('ДанныеДокумента.ДатаРегистрации')?e.get('ДанныеДокумента.ДатаРегистрации').strftime('%d.%m.%y'):''),e.getModelField('РП.Документ/Регламент'))e.set('ИнфоРегламентаПечать',e.getModelField('РП.Документ/Регламент/Название')?e.getModelField('РП.Документ/Регламент/Название'):'');});}};});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.ReconciliationReportsBrowser", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".controls-DataGridView.reportsEdoBrowser .controls-DataGridView__th.report-creditField,.controls-DataGridView.reportsEdoBrowser .controls-DataGridView__th.report-debitField{padding-right:20px;white-space:nowrap}td.controls-DataGridView__td.report-creditField,td.controls-DataGridView__td.report-debitField{white-space:nowrap;min-width:96px}.controls-DataGridView .controls-DataGridView__table .controls-DataGridView__th:nth-child(7){min-width:137px}.controls-DataGridView .controls-DataGridView__table .controls-DataGridView__th:nth-child(8){min-width:134px}.controls-DataGridView .controls-DataGridView__table .controls-DataGridView__th.report-creditField .controls-DataGridView__th-content,.controls-DataGridView .controls-DataGridView__table .controls-DataGridView__th.report-debitField .controls-DataGridView__th-content{overflow:visible;text-overflow:clip}.Reports .controls-ListView__item-type-hidden .controls-TreeView__expand{display:none}td.controls-DataGridView__td.report-onDateField,th.controls-DataGridView__th.report-onDateField{display:table-cell}@media only screen and (max-width:1400px){td.controls-DataGridView__td.report-onDateField,th.controls-DataGridView__th.report-onDateField{display:none}.reportsEdoBrowser .controls-DataGridView__colgroup col:nth-child(4){display:none}}.edo-RegistryColumn-MainInfo_header1_contragent:active,.edo-RegistryColumn-MainInfo_header1_contragent:hover{text-decoration:underline}.Reports .edo-RegistryColumn-MainInfo_additionalInfoTable .icon-Attach:before{content:''}.Reports .edo-RegistryColumn-MainInfo_additionalInfoTable .icon-16{display:none}.Reports .controls-DataGridView__th{white-space:nowrap}.ReconciliationBrowser{min-height:1px;height:calc(100% - 40px)}.ReconciliationBrowser .Reports{min-height:1px;height:calc(100% - 40px)}#contentArea{height:100%}.edo-ReconciliationBrowser{height:calc(100% - 40px)}.ws-is-firefox .ReconciliationsBrArea,.ws-is-firefox div[sbisname='SBIS3.EDO.Reconciliations'],.ws-is-ie .ReconciliationsBrArea,.ws-is-ie div[sbisname='SBIS3.EDO.Reconciliations']{height:calc(100% - 40px)!important}"));head.appendChild(style);});}
define('js!SBIS3.EDO.ReconciliationReportsBrowser',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.ReconciliationReportsBrowser','js!SBIS3.EDO.AutocompleteHandlers','tmpl!SBIS3.EDO.BaseFilter.Period/resources/PeriodStructure','tmpl!SBIS3.EDO.BaseFilter.Deleted/resources/DeletedStructure','tmpl!SBIS3.EDO.BaseFilter.Marks/resources/MarksStructure','tmpl!SBIS3.EDO.BaseFilter.ResponsibleFace/resources/ResponsibleFaceStructure','tmpl!SBIS3.EDO.BaseFilter.Face1/resources/Face1Structure','tmpl!SBIS3.EDO.BaseFilter.Signed/resources/SignedStructure','tmpl!SBIS3.EDO.BaseFilter.Regulation/resources/RegulationStructure','tmpl!SBIS3.EDO.BaseFilter.OurOrganisation/resources/OurOrganisationStructure','js!SBIS3.EDO2.Browser','js!SBIS3.EDO.ReconciliationReportsRegistryModel','js!SBIS3.EDO.EdoCommon','html!SBIS3.EDO2.Browser/resources/columns/DateNumberColumn','js!SBIS3.EDO.DateWithoutNumberColumn','html!SBIS3.EDO2.Browser/resources/columns/MainInfoColumn','js!SBIS3.EDO.OnDate','html!SBIS3.EDO2.Browser/resources/columns/SumColumn','html!SBIS3.EDO2.Browser/resources/columns/StateColumn','js!SBIS3.EDO.CustomStateColumn','html!SBIS3.EDO2.Browser/resources/columns/ResponsibleColumn','js!SBIS3.EDO.FEdoPartialReloader','js!SBIS3.EDO2.OpenDialogAction','js!SBIS3.EDO2.EdoColumnsClickDispatcher','js!SBIS3.EDO.ReconciliationReportsHandlers','js!SBIS3.EDO.OperationPrint','SBIS3.CONTROLS/OperationsPanel/Unload','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterResp','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterFace1','js!SBIS3.EDO2.MarksFilterRowTemplate','css!SBIS3.EDO.ReconciliationReportsBrowser','Elektronnyj_dokumentooborot_localization'],function(e,t,r,s,o,S,l,i,u,n,c){'use strict';var a=e.extend({_dotTplFn:t,$protected:{_options:{name:'ReconciliationReportsBrowser',objectName:'АктСверкиДок',incoming:true,method:'СписокХраним',model:'ReconciliationReportsRegistryModel',autocompleteTemplate:r.autocompleteTemplate,browserBind:'reportsAllFilter/button',periodStructure:s,DeletedStructure:o,MarksStructure:S,ResponsibleFaceStructure:l,Face1Structure:i,SignedStructure:u,RegulationStructure:n,OurOrganisationStructure:c}},init:function(){a.superclass.init.call(this),r.setProcessingAutocompletion(this,'ФильтрПоЛицуИзСписка');}});return a;});
define("html!SBIS3.EDO.ReconciliationReportsIn",function(){var e=function(e){var o=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(o){for(;e.test(o);)o=o.replace(e,"&#123;&#123;$1&#125;&#125;");return o}}(),n=function(e){return e.join?e.join(""):e.toString()},t=function(e){return void 0===e?"":e&&"object"==typeof e?n(e):""+e},i="undefined"!=typeof process,r=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="ws-flexbox ws-flex-column ws-flex-grow-1" style="height:100%;"> <component data-component="SBIS3.EDO.ReconciliationReportsTabs" name="ReconciliationReportsIn" class="ws-flexbox ws-flex-column ws-flex-grow-1" style="height:100%;"> <option name="objectName">АктСверкиДок</option> <option name="docRegistryType">'+o(t(e.docRegistryType))+'</option> <option name="incoming">true</option> </component> </div> ');return(r=o(r))+(i&&-1!==r.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.ReconciliationReportsIn"}},e});
define("html!SBIS3.EDO.ReconciliationReportsTabs",function(){var o=function(o){var n=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;o.test(n);)n=n.replace(o,"&#123;&#123;$1&#125;&#125;");return n}}(),t=function(o){return o.join?o.join(""):o.toString()},e=function(o){return void 0===o?"":o&&"object"==typeof o?t(o):""+o},i="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="edo-ReconciliationTabs ws-flexbox ws-flex-column ws-flex-grow-1"> <component data-component="SBIS3.Engine.BrowserTabs" name="'+n(e(o.name))+'" class="ReconcilBrTabs ws-flexbox ws-flex-column ws-flex-grow-1"> <option name="stickyHeader">true</option> <options name="tabsArea" type="array"> <options> <option name="id">aGroup</option> <option name="content"> <div> <div class="tab_toolbar__item"> <component data-component="SBIS3.EDO2.RulesSelector" name="addDocumentButton"> <option name="width">200</option> <option name=\'allowChangeEnable\'>false</option> <option name=\'showFavorites\'>false</option> <options name="docTypes" type="array"> <options> ');return o.docRegistryType?a+=' <option name="docType">'+n(e(o.docRegistryType))+"</option> ":a+=' <option name="docType">'+n(e(o.objectName))+"</option> ",a+=' </options> </options> <option name="content"> <component data-component="SBIS3.CONTROLS/Menu/MenuButton" name="addDocumentMenuButton"> <option name="caption">+ '+n(e(rk("Документ")))+'</option> <option name="primary">true</option> </component> </option> </component> </div> <div class="tab_toolbar__item tab_toolbar__gap"> <component data-component="SBIS3.EDO.LoadButton" data-access="',"Incoming"===o.typeName?a+="Входящие акты сверки":"Outgoing"===o.typeName?a+="Исходящие акты сверки":a+="Акты сверок",a+='"> <option name="from1C">true</option> <option name="incoming">'+n(e(o.incoming))+"</option> ",o.docRegistryType?a+=' <option name="docType">'+n(e(o.docRegistryType))+"</option> ":a+=' <option name="docType">'+n(e(o.objectName))+"</option> ",a+=' </component> </div> <component data-component="SBIS3.EDO2.ExportButton" style="float: left; margin-left: 12px;"> <option name="incoming">'+n(e(o.incoming))+"</option> ",o.docRegistryType?a+=' <option name="docType" value="'+n(e(o.docRegistryType))+'"></option> ':a+=' <option name="docType" value="'+n(e(o.objectName))+'"></option> ',a+=' <options name="exportSettings"> <option name="fileName">Акты сверок</option> <options name="items"> <options name="PDF"> <option name="pageOrientation">2</option> <option name="serverSideExport" type="boolean">false</option> <option name="xsl">/Elektronnyj_dokumentooborot/Reestry/xslt/reestr.xsl</option> </options> <options name="Excel"> <option name="serverSideExport" type="boolean">false</option> <option name="xsl">/Elektronnyj_dokumentooborot/Reestry/xslt/reestr.xsl</option> </options> </options> <options name="handlers"> <option name="onApplyOperation" type="function">js!SBIS3.EDO.ReconciliationReportsHandlers:setPrintColumns</option> <option name="onPrepareData" type="function">js!SBIS3.EDO.ReconciliationReportsHandlers:prepareData</option> </options> </options> </component> </div> </option> </options> </options> <options name="mainArea" type="array"> <options> <option name="id">ListGroup</option> <option name="content"> <component data-component="SBIS3.EDO.ReconciliationReportsBrowser"> <option name="useAutoRefresh">true</option> <option name="objectName">'+n(e(o.objectName))+"</option> ",o.docRegistryType&&(a+=' <option name="docRegistryType">'+n(e(o.docRegistryType))+"</option> "),a+=' <option name="incoming">'+n(e(o.incoming))+'</option> <opts name="partialReloader"> <opt name="onCreateModelHandlingEnable" value="true"/> <opt name="onDestroyModelHandlingEnable" value="true"/> </opts> </component> </option> </options> </options> <options name="tabs" type="array"> <options> <option name="id">ListTab</option> <option name="mainArea">ListGroup</option> <option name="tabsArea">aGroup</option> <option name="title">'+n(e(rk("Список")))+'</option> </options> </options> <option name="defaultTab">ListTab</option> ',o.incoming?a+=' <option name="tabsName">IncomingReportsInnerTabs</option> ':a+=' <option name="tabsName">OutgoingReportsInnerTabs</option> ',a+=' <options name="handlers"> <option name="onTabChange" type="function">js!SBIS3.EDO.EdoCommon:onTabChangeNewRegistry</option> <option name="onTabAndMainLoaded" type="function"> js!SBIS3.EDO.ReconciliationReportsTabs:prototype.onTabAndMainLoaded </option> </options> </component> </div>',(a=n(a))+(i&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.ReconciliationReportsTabs"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.ReconciliationReportsTabs", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".tab_toolbar__item{display:inline-block;float:left}.tab_toolbar__gap{margin-left:12px}.edo-ReconciliationTabs{min-height:1px}#contentArea{height:100%}.edo-ReconciliationBrowser .reportsEdoBrowser .controls-DataGridView__table{height:100%}.edo-ReconciliationTabs .ReconcilBrTabs{height:100%}"));head.appendChild(style);});}
define('js!SBIS3.EDO.ReconciliationReportsTabs',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.ReconciliationReportsTabs','js!SBIS3.EDO.EdoCommon','SBIS3.CONTROLS/Button','js!SBIS3.EDO2.RulesSelector','SBIS3.CONTROLS/Menu/MenuButton','js!SBIS3.EDO.LoadButton','js!SBIS3.Engine.BrowserTabs','js!SBIS3.EDO.ReconciliationReportsHandlers','js!SBIS3.EDO.ReconciliationReportsBrowser','css!SBIS3.EDO.ReconciliationReportsTabs','js!SBIS3.EDO2.ExportButton','Elektronnyj_dokumentooborot_localization'],function(t,o,n){'use strict';var e=t.extend({_dotTplFn:o,$protected:{_options:{name:'ReconciliationReportsTabs',incoming:true,objectName:'АктСверкиДок'}},$constructor:function(){},init:function(){e.superclass.init.call(this);},onTabAndMainLoaded:function(t,o){if('ListTab'==o)n.initTaskButtons({mainObject:this.getCurrentTabArea('main'),tabsObject:this.getCurrentTabArea('tabs'),btnDocName:'addDocumentMenuButton',brwName:'ReportsBrowser',actionName:'ReportsOpenDialogAction',dialogComponents:{'fdbbfd83-64f6-4ae1-9761-625b114ec4bd':'js!SBIS3.EDO.ReconciliationReportOut','bc5f60fd-2633-45e0-a817-41a89910d074':'js!SBIS3.EDO.ReconciliationReportIn','534888e6-8c29-4c11-9530-774d485b639b':'js!SBIS3.EDO.ReconciliationReportIn'}});}});return e;});
define('js!SBIS3.EDO.ReconciliationReportsIn',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.ReconciliationReportsIn','js!SBIS3.EDO.ReconciliationReportsTabs','Elektronnyj_dokumentooborot_localization'],function(t,e){'use strict';var i=t.extend({_dotTplFn:e,$protected:{_options:{docRegistryType:'АктСверВх',fastDataFilterConfig:{data:[{keyField:'key',displayField:'title',name:'FilterAuthorOrResponsibleMe',multiselect:false,className:'controls-DropdownList__withoutCross controls-DropdownList__linkStyle',values:[{key:'Все',value:'Все',title:rk('Все')},{key:'От меня',value:'От меня',title:rk('От меня')},{key:'От моего отдела',value:'От моего отдела',title:rk('От моего отдела')}]},{keyField:'key',displayField:'title',name:'FilterState',multiselect:false,className:'controls-DropdownList controls-DropdownList__linkStyle',values:[{key:'-1',title:rk('В любом состоянии')},{key:'10',title:rk('Внутренняя обработка')},{key:'7',title:rk('Утвержденные')},{key:'9',title:rk('Отклоненные')},{key:'22',title:rk('Аннулированные')},{key:'19,20',title:rk('Удалено мной/контрагентом')},{key:'0,1',title:rk('Черновики')}]}]}}},$constructor:function(){},init:function(){if(i.superclass.init.call(this),this.hasChildControlByName('browserFastDataFilter')){var t=this.getChildControlByName('browserFastDataFilter');if(t)t.setItems(this._options.fastDataFilterConfig.data);}}});return i;});
define("html!SBIS3.EDO.ReconciliationReportsOut",function(){var e=function(e){var o=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(o){for(;e.test(o);)o=o.replace(e,"&#123;&#123;$1&#125;&#125;");return o}}(),n=function(e){return e.join?e.join(""):e.toString()},t=function(e){return void 0===e?"":e&&"object"==typeof e?n(e):""+e},i="undefined"!=typeof process,r=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="ws-flexbox ws-flex-column ws-flex-grow-1" style="height:100%;"> <component data-component="SBIS3.EDO.ReconciliationReportsTabs" name="ReconciliationReportsOut" class="ws-flexbox ws-flex-column ws-flex-grow-1" style="height:100%;"> <option name="objectName">АктСверкиДок</option> <option name="docRegistryType">'+o(t(e.docRegistryType))+'</option> <option name="incoming">false</option> </component> </div>');return(r=o(r))+(i&&-1!==r.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.ReconciliationReportsOut"}},e});
define('js!SBIS3.EDO.ReconciliationReportsOut',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.ReconciliationReportsOut','js!SBIS3.EDO.ReconciliationReportsTabs','Elektronnyj_dokumentooborot_localization'],function(t,e){'use strict';var i=t.extend({_dotTplFn:e,$protected:{_options:{docRegistryType:'АктСверИсх',fastDataFilterConfig:{data:[{keyField:'key',displayField:'title',name:'FilterAuthorOrResponsibleMe',multiselect:false,className:'controls-DropdownList__withoutCross controls-DropdownList__linkStyle',values:[{key:'Все',value:'Все',title:rk('Все')},{key:'От меня',value:'От меня',title:rk('От меня')},{key:'От моего отдела',value:'От моего отдела',title:rk('От моего отдела')}]},{keyField:'key',displayField:'title',name:'FilterState',multiselect:false,className:'controls-DropdownList controls-DropdownList__linkStyle',values:[{key:'-1',title:rk('В любом состоянии')},{key:'10',title:rk('Внутренняя обработка')},{key:'2,3',title:rk('Недоставленные')},{key:'4',title:rk('Не получен ответ')},{key:'7',title:rk('Утвержденные')},{key:'9',title:rk('Отклоненные')},{key:'6',title:rk('С ошибками')},{key:'22',title:rk('Аннулированные')},{key:'19,20',title:rk('Удалено мной/контрагентом')},{key:'0,1',title:rk('Черновики')}]}]}}},$constructor:function(){},init:function(){if(i.superclass.init.call(this),this.hasChildControlByName('browserFastDataFilter')){var t=this.getChildControlByName('browserFastDataFilter');if(t)t.setItems(this._options.fastDataFilterConfig.data);}}});return i;});
define("html!SBIS3.EDO.Reconciliations",function(){var e=function(e){var o=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(o){for(;e.test(o);)o=o.replace(e,"&#123;&#123;$1&#125;&#125;");return o}}(),n=function(e){return e.join?e.join(""):e.toString()},t=function(e){return void 0===e?"":e&&"object"==typeof e?n(e):""+e},i="undefined"!=typeof process,r=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div style="height:100%;" class="ws-flexbox ws-flex-column ws-flex-grow-1"> <component data-component="SBIS3.EDO.ReconciliationReportsTabs" name="Reconciliations" class="ws-flexbox ws-flex-column ws-flex-grow-1" style="height:100%;"> <option name="objectName">АктСверкиДок</option> <option name=\'incoming\'>null</option> <option name="docRegistryType">'+o(t(e.docRegistryType))+"</option> </component> </div>");return(r=o(r))+(i&&-1!==r.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.Reconciliations"}},e});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.Reconciliations", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode("#contentArea{height:100%}"));head.appendChild(style);});}
define('js!SBIS3.EDO.Reconciliations',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.Reconciliations','js!SBIS3.EDO.ReconciliationReportsTabs','css!SBIS3.EDO.Reconciliations','Elektronnyj_dokumentooborot_localization'],function(t,e){'use strict';var i=t.extend({_dotTplFn:e,$protected:{_options:{docRegistryType:'АктСверкиДок',fastDataFilterConfig:{data:[{keyField:'key',displayField:'title',name:'FilterAuthorOrResponsibleMe',multiselect:false,className:'controls-DropdownList__withoutCross controls-DropdownList__linkStyle',values:[{key:'Все',value:'Все',title:rk('Все')},{key:'От меня',value:'От меня',title:rk('От меня')},{key:'От моего отдела',value:'От моего отдела',title:rk('От моего отдела')}]},{keyField:'key',displayField:'title',name:'FilterState',multiselect:false,className:'controls-DropdownList controls-DropdownList__linkStyle',values:[{key:'-1',title:rk('В любом состоянии')},{key:'10',title:rk('Внутренняя обработка')},{key:'7',title:rk('Утвержденные')},{key:'9',title:rk('Отклоненные')},{key:'22',title:rk('Аннулированные')},{key:'19,20',title:rk('Удалено мной/контрагентом')},{key:'0,1',title:rk('Черновики')}]}]}}},$constructor:function(){},init:function(){if(i.superclass.init.call(this),this.hasChildControlByName('browserFastDataFilter')){var t=this.getChildControlByName('browserFastDataFilter');if(t)t.setItems(this._options.fastDataFilterConfig.data);}}});return i;});
define("tmpl!SBIS3.EDO.RegistryColumns",["Core/tmpl/js/tclosure"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={},n=function e(n,o,i,l,s){function u(){}var a=0,c=void 0!==t&&t?t:arguments[arguments.length-1];void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure"));var d={};s&&s.isSetts&&(d=s.fullContext||{});var m="string"==typeof i?i:"",p=void 0===r?void 0:r,v={id:[],def:void 0},f=c.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,n),y=this&&this.includedTemplates?this.includedTemplates:{},g=c.getMarkupGenerator(l);try{var h=g.joinElements([g.createTag("div",{},[],o,v,this)],m,v);v.def&&(h=g.chain(h,v,o),v=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/Registry/RegistryColumns/RegistryColumns.tmpl",e,n)}return h||""};return n.includedFunctions={},n.stable=!0,n.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.RegistryColumns"}},n});
define('js!SBIS3.EDO.RegistryColumns',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.RegistryColumns','Elektronnyj_dokumentooborot_localization'],function(t,n){'use strict';var o=t.extend({_dotTplFn:n,$protected:{_options:{}},$constructor:function(){},init:function(){o.superclass.init.call(this);}});return o;});
define("html!SBIS3.EDO.TaskSelect",function(){var o=function(o){var e=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(e){for(;o.test(e);)e=e.replace(o,"&#123;&#123;$1&#125;&#125;");return e}}(),t=function(o){return o.join?o.join(""):o.toString()},n=function(o){return void 0===o?"":o&&"object"==typeof o?t(o):""+o},i="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="edo-taskSelect"> <component data-component="SBIS3.Engine.BrowserTabs" name="TaskSelectTabs" class="edo-taskSelectTabs ');return o.showAllTask&&!o.multiselect&&(a+="edo-taskSelect__hideTaskOperationsPanelButton"),a+='"> <options name="tabsArea" type="array"> <options> <option name="id">afGroup</option> ',o.showTaskButton&&(a+=' <option name="content"> <component data-component="SBIS3.EDO.FTaskButtons" name="TaskButtons"> <option name="addDoc_name">AddTaskOnSelect</option> <option name="showAddDoc">'+e(n(o.showAddDoc))+'</option> <option name="showAddFolder">'+e(n(o.showAddFolder))+'</option> <option name="showTransfer">'+e(n(o.showTransfer))+'</option> <option name="transfer_faceField">'+e(n(o.transfer_faceField))+"</option> </component> </option> "),a+=' </options> </options> <options name="mainArea" type="array"> ',o.showExecTask&&(a+=' <options> <option name="id">doneGroup</option> <option name="content"> <component data-component="SBIS3.CONTROLS/Action/Selector/SelectorWrapper" class="controls-Browser__view"> <option name="linkedObjectName">browserView</option> <option name=\'content\'> <component data-component="SBIS3.EDO.FMyTasks"> <option name="myTaskBrName">ExecutedTasks</option> ',o.infiniteScrollContainer?a+=' <option name="infiniteScrollContainer">'+e(n(o.infiniteScrollContainer))+'</option> <option name="useScrollContainer">false</option> ':a+=' <option name="useScrollContainer">true</option> ',a+=' <option name="addClass">doneTasksGroup</option> <option name="objectName">Документ</option> <option name="method">Выполненные</option> <option name="showHead">true</option> <option name="cssStatus">fieldStatusAlign</option> <option name="dateColWidth">100</option> <option name="dateColTitle">'+e(n(rk("Выполнено")))+'</option> <option name="dateColHeadTemplate"> <component data-component="SBIS3.CONTROLS/Link" name="LinkReceived" class="ctrFilterLinkReceived"> <option name="caption">'+e(n(rk("Выполнено")))+'</option> <options name="handlers"> <option name="onActivated" type="function">js!SBIS3.EDO.EdoCommon:onTitleClickReceived</option> </options> </component> </option> <option name="isExecuted">true</option> <option name="onChangeHoveredItemHandler">onChangeHoveredItemHierMyTasks</option> <option name="isNotCheckShortStateForPeriodRender" type="boolean">true</option> <option name="hierAllow" type="boolean">false</option> <option name="idProperty">@Событие</option> <option name="operationsPanelConfig"> <options name="items" type="array"> <options> <option name="name">markOperations</option> <option name="componentType">SBIS3.CONTROLS/OperationsPanel/Mark</option> <options name="type"> <option name="mark">true</option> </options> </options> <options> <option name="name">print</option> <option name="componentType">js!SBIS3.EDO.OperationPrint</option> <options name="type"> <option name="mass">true</option> <option name="selection" type="boolean">true</option> </options> <options name="options"> <option name="disablePrintingTemplates">true</option> <options name="handlers"> <option name="onApplyOperation" type="function">js!SBIS3.EDO.MyTasksHandlers:setPrintColumns_executed</option> </options> </options> </options> <options> <option name="name">setControl</option> <option name="componentType">js!SBIS3.EDO.OperationControl</option> <options name="type"> <option name="selection" type="boolean">true</option> </options> <options name="options"> <option name="set">true</option> </options> </options> </options> <option name="hasItemsMenu">true</option> </option> ',o.execTaskHistoryId&&(a+=' <option name="historyId">'+e(n(o.execTaskHistoryId))+"</option> "),a+=" <option name='showMoveTasksMass'>"+e(n(o.showMoveTasksMass))+'</option> <options name="filterParams"> <option name="ФильтрДатаПериод" value="Месяц"></option> </options> <option name="filterButtonConfig"> <option name="template">js!SBIS3.EDO.FilterTasksExecute</option> <option name="additionalFilterParamsTemplate">js!SBIS3.EDO.FilterTasksExecuteSelector</option> <option name="resetLinkText">'+e(n(rk("За последний месяц")))+'</option> <options name="filterStructure" type="array"> <opts> <opt name="internalValueField">FilterDatePeriod</opt> <opt name="internalCaptionField">FilterDatePeriodText</opt> <opt name="value" bind="browser.filter/ФильтрДатаПериод"></opt> <opt name="resetValue">Месяц</opt> <opt name="itemTemplate" type="function" value="html!SBIS3.EDO.DetalizationEvents/tplFilterDatePeriod"/> </opts> <opts> <opt name="internalValueField">FilterDateFrom</opt> <opt name="internalCaptionField">FilterDateFrom</opt> <opt name="value" bind="browser.filter/ФильтрДатаС"></opt> <opt name="resetValue" type="null">null</opt> <opt name="itemTemplate" type="null">null</opt> <opt name="historyItemTemplate" type="null">null</opt> </opts> <opts> <opt name="internalValueField">FilterDateTo</opt> <opt name="internalCaptionField">FilterDateTo</opt> <opt name="value" bind="browser.filter/ФильтрДатаП"></opt> <opt name="resetValue" type="null">null</opt> <opt name="itemTemplate" type="null">null</opt> <opt name="historyItemTemplate" type="null">null</opt> </opts> <opts> <opt name="internalValueField">FilterOverdue</opt> <opt name="internalCaptionField">FilterOverdueText</opt> <opt name="internalVisibilityField">FilterLimitationOverdueVisibility</opt> <opt name="value" bind="browser.filter/ФильтрПросроченные" nonexistent="null"></opt> <opt name="resetValue" type="null">null</opt> <opt name="resetVisibilityValue">false</opt> </opts> <opts> <opt name="internalValueField">FilterMarksIncluded</opt> <opt name="internalCaptionField">FilterMarksIncludedText</opt> <opt name="internalVisibilityField">FilterMarksVisibility</opt> <opt name="value" bind="browser.filter/ФильтрПометкиВкл"></opt> <opts name="resetValue" type="array"></opts> <opt name="resetVisibilityValue">false</opt> <opt name="itemTemplate" type="function" value="tmpl!SBIS3.EDO2.MarksFilterRowTemplate/tmpl/MarksFilterRowTemplate"/> </opts> <opts> <opt name="internalValueField">FilterMarksExcluded</opt> <opt name="internalCaptionField">FilterMarksExcludedText</opt> <opt name="value" bind="browser.filter/ФильтрПометкиИскл"></opt> <opts name="resetValue" type="array"></opts> <opt name="resetVisibilityValue">false</opt> <opt name="itemTemplate" type="function" value="tmpl!SBIS3.EDO2.MarksFilterRowTemplate/tmpl/MarksFilterRowTemplate"/> </opts> <opts> <opt name="internalValueField">FilterIdRegulationMul</opt> <opt name="internalCaptionField">FilterIdRegulationText</opt> <opt name="internalVisibilityField">FilterRegulationVisibility</opt> <opt name="value" bind="browser.filter/ИдРегламента"></opt> <opts name="resetValue" type="array"></opts> <opt name="resetVisibilityValue">false</opt> </opts> <opts> <opt name="internalValueField">FilterIdPhase</opt> <opt name="internalCaptionField">FilterIdPhaseText</opt> <opt name="value" bind="browser.filter/ФильтрИдФазы"></opt> <opt name="resetValue" type="null">null</opt> </opts> <opts> <opt name="internalValueField">FilterFace1</opt> <opt name="internalCaptionField">FilterFace1Text</opt> <opt name="internalVisibilityField">FilterFace1Visibility</opt> <opt name="value" bind="browser.filter/ФильтрЛицо1"></opt> <opts name="resetValue" type="array"></opts> <opt name="resetCaption" value=""></opt> <opt name="resetVisibilityValue">false</opt> <opt name="itemTemplate" type="function" value="tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterFace1"/> <opt name="historyItemTemplate" type="function" value="tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterFace1"/> </opts> <opts> <opt name="internalValueField">FilterSender</opt> <opt name="internalCaptionField">FilterSenderText</opt> <opt name="internalVisibilityField">FilterSenderVisibility</opt> <opt name="value" bind="browser.filter/ФильтрОтправитель"></opt> <opts name="resetValue" type="array"></opts> <opt name="resetCaption" value=""></opt> <opt name="resetVisibilityValue">false</opt> <opt name="itemTemplate" type="function" value="tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterSender"/> <opt name="historyItemTemplate" type="function" value="tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterSender"/> </opts> <opts> <opt name="internalValueField">FilterMilestone</opt> <opt name="internalCaptionField">FilterMilestoneText</opt> <opt name="internalVisibilityField">FilterMilestoneVisibility</opt> <opt name="value" bind="browser.filter/ФильтрПоВехе"></opt> <opts name="resetValue" type="array"></opts> <opt name="resetVisibilityValue">false</opt> </opts> <opts> <opt name="internalValueField">FilterReceiver</opt> <opt name="internalCaptionField">FilterReceiverText</opt> <opt name="internalVisibilityField">FilterReceiverVisibility</opt> <opt name="value" bind="browser.filter/ФильтрПолучатель"></opt> <opts name="resetValue" type="array"></opts> <opt name="resetCaption" value=""></opt> <opt name="resetVisibilityValue">false</opt> <opt name="itemTemplate" type="function" value="tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterReceiver"/> <opt name="historyItemTemplate" type="function" value="tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterReceiver"/> </opts> </options> </option> <option name="needStatusPictureClass">false</option> </component> </option> </component> </option> </options> '),a+=" ",o.showOnCtrl&&(a+=' <options> <option name="id">onCtrlGroup</option> <option name="content"> <component data-component="SBIS3.CONTROLS/Action/Selector/SelectorWrapper" class="controls-Browser__view"> <option name="linkedObjectName">browserView</option> <option name=\'content\'> <component data-component="SBIS3.EDO.FTasksMonitoring"> ',o.infiniteScrollContainer?a+=' <option name="infiniteScrollContainer">'+e(n(o.infiniteScrollContainer))+'</option> <option name="useScrollContainer">false</option> ':a+=' <option name="useScrollContainer">true</option> ',a+=' <option name="useAutoRefresh">true</option> <opts name="partialReloader"> <opt name="addServerChannelName" value="edo.task-added"/> <opt name="fixServerChannelName" value="edo.task-fix"/> <opt name="deleteServerChannelName" value="edo.task-delete"/> <opt name="onCreateModelHandlingEnable" value="true"/> <opt name="updateOnDeleteAndAdd" value="false"/> </opts> <option name="showHead">true</option> <option name="hierAllow" type="boolean">'+e(n(o.selectTask))+'</option> <options name="filterParams"> <option name="ПапкаДокументов" value=""></option> <option name="ПростыеВД" value="true"></option> <option name="РассчитатьФото" value="true"></option> <option name="ВключитьСписокИсполнителей" value="true"></option> <option name="ПоказИерархии" type="boolean">'+e(n(o.selectTask))+"</option> ",o.subTask&&(a+=' <option name="ИсключитьИзСпискаПрикрепления" value="'+e(n(o.subTask))+'"></option> '),a+=" </options> ",o.onCtrlHistoryId&&(a+=' <option name="historyId">'+e(n(o.onCtrlHistoryId))+"</option> "),a+=" </component> </option> </component> </option> </options> "),a+=" ",o.showAllTask&&(a+=' <options> <option name="id">allTaskGroup</option> <option name="content"> <component data-component="SBIS3.CONTROLS/Action/Selector/SelectorWrapper" class="controls-Browser__view"> <option name="linkedObjectName">browserView</option> <option name=\'content\'> <component data-component="SBIS3.EDO.FTasks"> <option name="useAutoRefresh">true</option> <opts name="partialReloader"> <opt name="addServerChannelName" value="edo.task-added"/> <opt name="fixServerChannelName" value="edo.task-fix"/> <opt name="deleteServerChannelName" value="edo.task-delete"/> <opt name="onCreateModelHandlingEnable" value="true"/> <opt name="updateOnDeleteAndAdd" value="false"/> </opts> <options name="filterParams"> <option name="ПростыеВД" value="true"></option> <option name="РассчитатьФото" value="true"></option> <option name="ВключитьСписокИсполнителей" value="true"></option> ',o.subTask&&(a+=' <option name="ИсключитьИзСпискаПрикрепления" value="'+e(n(o.subTask))+'"></option> '),a+=' </options> <option name="allowDragNDropMove">true</option> <option name="showHead">true</option> <option name="hierAllow" type="boolean">false</option> ',o.allTaskHistoryId&&(a+=' <option name="historyId">'+e(n(o.allTaskHistoryId))+"</option> "),a+=" </component> </option> </component> </option> </options> "),a+=" ",o.showMyTask&&(a+=' <options> <option name="id">userTaskGroup</option> <option name="content" type="content"> <component data-component="SBIS3.CONTROLS/Action/Selector/SelectorWrapper" class="controls-Browser__view"> <option name="linkedObjectName">browserView</option> <option name=\'content\'> <component data-component="SBIS3.EDO.FMyTasks"> <option name="hasItemsMenu">true</option> ',o.infiniteScrollContainer?a+=' <option name="infiniteScrollContainer">'+e(n(o.infiniteScrollContainer))+'</option> <option name="useScrollContainer">false</option> ':a+=' <option name="useScrollContainer">true</option> ',a+=' <option name="useAutoRefresh">true</option> ',o.useScope&&(a+=' <option name="useScope">true</option> <option name="listMethodByScope">'+e(n(o.listMethodByScope))+"</option> "),a+=' <opts name="partialReloader"> ',o.useUserTaskPartialReloader&&(a+=' <opt name="addServerChannelName" value="edo.task-added"/> <opt name="fixServerChannelName" value="edo.task-fix"/> <opt name="deleteServerChannelName" value="edo.task-delete"/> '),a+=' <opt name="onCreateModelHandlingEnable" value="true"/> <opt name="updateOnDeleteAndAdd">'+e(n(o.useUserTaskPartialReloader))+"</opt> </opts> ",o.selectTask||(a+=' <option name="arrowActivatedHandler" type="function">js!SBIS3.EDO.EdoClicks:myFolderClick</option> '),a+=' <option name="allowDragNDropMove">true</option> <option name="showHead">true</option> <option name="hierAllow" type="boolean">'+e(n(o.selectTask))+'</option> <option name="statusPictureTitle">'+e(n(rk("Состояние")))+'</option> <option name="cssStatus">fieldStatusAlign</option> <option name="dateColTitle">'+e(n(rk("Получено")))+'</option> <option name="dateColHeadTemplate"> <component data-component="SBIS3.CONTROLS/Link" name="LinkReceived" class="ctrFilterLinkReceived"> <option name="caption">'+e(n(rk("Получено")))+'</option> <options name="handlers"> <option name="onActivated" type="function">js!SBIS3.EDO.EdoCommon:onTitleClickReceived</option> </options> </component> </option> <options name="filterParams"> <option name="ПростыеВД" value="true"></option> <option name="РассчитатьФото" value="true"></option> <option name="ПоказИерархии" type="boolean">'+e(n(o.selectTask))+'</option> <option name="ВключитьСписокИсполнителей" value="true"></option> ',o.userFaceId&&(a+=' <option name="Лицо">'+e(n(o.userFaceId))+"</option> "),a+=' <option name="ВключитьСписокИсполнителей" value="true"></option> ',o.subTask&&(a+=' <option name="ИсключитьИзСпискаПрикрепления" value="'+e(n(o.subTask))+'"></option> '),a+=" </options> ",o.myTaskHistoryId&&(a+=' <option name="historyId">'+e(n(o.myTaskHistoryId))+"</option> "),a+=" ",o.hideOperationMove&&(a+=' <option name="hideOperationMove" value="true"></option> '),a+=" </component> </option> </component> </option> </options> "),a+=' </options> <options name="tabs" type="array"> ',o.showExecTask&&(a+=' <options> <option name="id">DoneTab</option> <option name="mainArea">doneGroup</option> <option name="tabsArea">afGroup</option> <option name="title">'+e(n(rk("Выполненные")))+'</option> <option name="visible">true</option> </options> '),a+=" ",o.showOnCtrl&&(a+=' <options> <option name="id">OnCtrlTab</option> <option name="mainArea">onCtrlGroup</option> <option name="tabsArea">afGroup</option> <option name="title">'+e(n(rk("На контроле")))+'</option> <option name="visible">true</option> </options> '),a+=" ",o.showAllTask&&(a+=' <options> <option name="id">AllTaskTab</option> <option name="mainArea">allTaskGroup</option> <option name="tabsArea">afGroup</option> <option name="title">'+e(n(rk("Все")))+'</option> <option name="visible">true</option> </options> '),a+=" ",o.showMyTask&&(a+=' <options> <option name="id">UserTaskTab</option> <option name="mainArea">userTaskGroup</option> <option name="tabsArea">afGroup</option> <option name="title">'+e(n(rk("На мне")))+'</option> <option name="visible">'+e(n(!!o.showAllTask))+"</option> </options> "),a+=" </options> ",o.defaultTabName?a+=' <option name="defaultTab">'+e(n(o.defaultTabName))+"</option> ":a+=' <option name="defaultTab">UserTaskTab</option> ',a+=' <options name="handlers"> <option name="onTabAndMainLoaded" type="function">js!SBIS3.EDO.TaskSelect:prototype.onTabAndMainLoaded</option> <option name="onTabChange" type="function">js!SBIS3.EDO.TaskSelect:prototype.onTabChange</option> </options> </component> </div> ',(a=e(a))+(i&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.TaskSelect"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.TaskSelect", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-taskSelectTabs .controls-operationsPanel__relocated .controls-operationsPanel__wrapper-background{border-bottom:none}.edo-taskSelect .controls-operationsPanel__relocated{z-index:0}.edo-taskSelect{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-moz-flex-direction:column;-ms-flex-direction:column;flex-direction:column;height:100%}.ws-is-firefox .edo-taskSelect,.ws-is-ie12 .edo-taskSelect{height:calc(100% - 40px)}.edo-taskSelect .edo-taskSelectTabs{height:100%}.edo-taskSelect .edo-taskSelectTabs .controls-SelectorWrapper{height:100%}.edo-taskSelect .rt_subtasks{display:none}.edo-taskSelect__hideTaskOperationsPanelButton .engine-browserTabs__operationsPanelButton{display:none}"));head.appendChild(style);});}
define('js!SBIS3.EDO.TaskSelect',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.TaskSelect','js!SBIS3.EDO.EdoCommon','Core/UserInfo','js!SBIS3.Engine.BrowserTabs','js!SBIS3.EDO.FTaskButtons','js!SBIS3.EDO.FMyTasks','js!SBIS3.EDO.FTasks','js!SBIS3.EDO.FTasksMonitoring','js!SBIS3.EDO.EdoClicks','SBIS3.CONTROLS/Link','html!SBIS3.EDO.TaskCol','html!SBIS3.EDO.TaskColDetalization','html!SBIS3.EDO.DetalizationEvents/tplFilterDatePeriod','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterFace1','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterSender','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterReceiver','tmpl!SBIS3.EDO2.MarksFilterRowTemplate/tmpl/MarksFilterRowTemplate','SBIS3.CONTROLS/Action/Selector/SelectorWrapper','css!SBIS3.EDO.TaskSelect','Elektronnyj_dokumentooborot_localization'],function(s,t,e,o){'use strict';var a=s.extend({_dotTplFn:t,$protected:{_options:{showMyTask:true,showAllTask:false,showTaskButton:false,showAddDoc:true,allowEditTasks:false,showAddFolder:false,showTransfer:true,showOnCtrl:false,showExecTask:false,useScope:false,userFaceId:0,userSName:'',userName:'',userPatr:'',selectTask:false,multiselect:false,chooseButtonName:'',useUserTaskPartialReloader:false,subTask:false,showMoveTasksMass:true}},$constructor:function(s){this._options.showAllTask=s.showAllTask||this._options.showAllTask,this._options.showOnCtrl=s.showOnCtrl||this._options.showOnCtrl,this._options.showTaskButton=s.showTaskButton||this._options.showTaskButton,this._options.showMoveTasksMass=s.showMoveTasksMass||this._options.showMoveTasksMass;},_modifyOptions:function(s){if(s=a.superclass._modifyOptions.call(this,s),s['userFaceId'])s['useUserTaskPartialReloader']=s['userFaceId']&&s['userFaceId']==o.get('ЧастноеЛицо');return s;},init:function(){a.superclass.init.call(this);var s=this.hasChildControlByName('TaskSelectTabs')&&this.getChildControlByName('TaskSelectTabs');s&&s.setOperationsButtonVisibility(this._options.showTaskButton);},getCurBrowser:function(){var s=this._getCurBrowserNameByTabID(this._curTabID);if(s&&this.hasChildControlByName(s))return this.getChildControlByName(s);return;},_getCurBrowserNameByTabID:function(s){var t='';switch(s){case'UserTaskTab':t='MyTasks';break;case'AllTaskTab':t='Tasks';break;case'OnCtrlTab':t='OnCtrl';break;case'DoneTab':t='ExecutedTasks';}return t;},_isMultiselect:function(){return this._options.multiselect;},_isShowAddDoc:function(){return this._options.showAddDoc;},_isShowAllTask:function(){return this._options.showAllTask;},_getUserFaceId:function(){return this._options.userFaceId;},_isShowTaskButton:function(){return this._options.showTaskButton;},_isAllowEditTasks:function(){return this._options.allowEditTasks;},_isUseScope:function(){return this._options.useScope;},_getUserName:function(){var s=this._options.userSName||'';if(this._options.userName)s+=' '+this._options.userName[0]+'.';if(this._options.userPatr)s+=this._options.userPatr[0]+'.';return s;},_getChooseButtonName:function(){return this._options.chooseButtonName;},onTabAndMainLoaded:function(s,t){var o=this,a=this.getParentByClass('SBIS3.EDO.TaskSelect'),i=this.getCurrentTabArea('main'),n=this.getCurrentTabArea('tabs'),r=a._getCurBrowserNameByTabID(t);if(a._curTabID=t,!a._isShowAllTask())this.getChildControlByName('tab-buttons').getContainer().find('.controls-TabButtons__tabSpace-template').css('border','none');else if(!a._isMultiselect())this.getChildControlByName('operationsButton').hide();var l=function(s){if(a._isMultiselect()&&r&&a._getChooseButtonName()){var t=i.getChildControlByName(s).getView(),e=o.getTopParent().getChildControlByName(a._getChooseButtonName());o.subscribeTo(t,'onSelectedItemsChange',function(){e.setVisible(this.getSelectedKeys().length>0);});}};if('UserTaskTab'==t){var u={mainObject:i,tabsObject:n,brwName:r,folderAdvancedMode:false};if(a._isShowTaskButton()){var c=[];if(c.push({faceID:a._getUserFaceId(),faceID_:'"СтруктураПредприятия"',name:a._getUserName()}),u.executerList=c,a._isShowAddDoc())u.btnDocName='AddTaskOnSelect';u.actionName=a._isAllowEditTasks()?'MyTasksAction':null;}e.initTaskButtons(u);}else if('AllTaskTab'==t){var h={mainObject:i,tabsObject:n,brwName:r,actionName:a._isAllowEditTasks()?'TasksAction':null};h.btnDocName=a._isShowTaskButton()&&a._isShowAddDoc()?'AddTaskOnSelect':void 0,e.initTaskButtons(h);}else if('OnCtrlTab'==t)e.initTaskButtons({mainObject:i,tabsObject:n,brwName:r,actionName:a._isAllowEditTasks()?'OnCtrl':null});else if('DoneTab'==t)e.initTaskButtons({mainObject:i,tabsObject:n,brwName:r,folderAdvancedMode:false,actionName:a._isAllowEditTasks()?'ExecutedTasks':null});l(r);},onTabChange:function(s,t){var e=this.getParentByClass('SBIS3.EDO.TaskSelect');this.setOperationsButtonVisibility(e._isShowTaskButton()&&e._isMultiselect()),e._curTabID=t;}});return a;});
define('js!SBIS3.EDO.TasksMoveStrategy',['SBIS3.CONTROLS/Utils/InformationPopupManager','WS.Data/Source/SbisService','Core/Indicator','Core/ParallelDeferred','Core/Deferred','Core/Abstract','i18n!SBIS3.EDO.TasksMoveStrategy','Elektronnyj_dokumentooborot_localization'],function(e,t,r,n,o,a){'use strict';function i(e,t,n,o){if(n)return o.call('СменитьРодителя',{'Папка':e,'ПапкаЦелевая':t}).addErrback(function(e){return r.hide(),e;});else return o.call('ПереместитьВПапку',{'СвязьПапок':e,'Папка':t}).addErrback(function(e){return r.hide(),e;});}function s(e,t,r){var n='taskHierBrowser'===e.getName(),o=null===e.getSelectedItem(),a=Boolean(!o&&e.getSelectedItem().get('@СвязьПапок')===r),i=Boolean(!t||1!==t.length),s=Boolean(e.getParentProperty&&true!==t[0].get(e.getParentProperty()+'@'));return n&&a&&(i||s);}function d(e){return null===e||e&&e.indexOf('ПапкаДокументов')>-1;}function l(e,t){return t&&u(e);}function u(e){return e&&(e.get('Переназначение')||!e.get('МояПапка'));}function g(e){var t=!e.isBranch,r='browserView'===e.browserView.getName(),n=e.foldersOnLeftSideMode&&null===e.brw.getChildControlByName('taskHierBrowser').getSelectedItem(),o=e.foldersOnLeftSideMode?!n:e.record.get('ПапкаДокументов')===e.toFolderValue;return t&&r&&e.toCurrentFolder&&o;}function c(e,t,r){if(!e)return false;var n=r.getChildControlByName('taskHierBrowser'),o='taskHierBrowser'===t.getName()&&null===t.getSelectedItem(),a='browserView'===t.getName()&&n&&null===n.getSelectedItem();return o||a;}var f=a.extend({$protected:{_options:{dataView:null,contract:null}},$constructor:function(){this._options.listView=this._options.dataView;},_getOrderValue:function(e,t,r,n){var o=this._options.dataView,a=o[r?'getPrevItemById':'getNextItemById'](e.getId()),i=a?o.getItems().getRecordById(a.data('id')):null;if(e.has(n)){var s=i?i.get(n):void 0,d=e.get(n);if(s&&d)return(d+s)/2;return d;}return;},_moveInItems:function(e,t,r){var n=this,o=this._options.dataView.getDataSource(),a=o?o.getOrderProperty():'ПорНомер',i=this._getOrderValue(t,e[0],r,a);e.forEach(function(e){e.set(a,i);});},makeMoveResponse:function(r){return new t({endpoint:'ПапкаДокументов'}).call('ИзменитьПорядокПапок',{'ИдО':r.id,'ИдОДо':r.id_before,'ИдОПосле':r.id_after,'ПеремещаемВверх':r.direction_bl}).addCallback(function(e){return r.obj._moveInItems(r.recs_move,r.to_move,r.direction_call),'MoveInItems';}).addErrback(function(t){e.showMessageDialog({message:t.message,status:'error'});});},move:function(e,r,n){var a=this,i=this._options.dataView,s=i.getParentProperty&&true===r.get(i.getParentProperty()+'@'),d=i.getParentProperty?i.getParentProperty():false,l=i.getFilter(),u;if(d&&null===r.get(d)&&'ВнешняяИерархия'in l===false)for(var g=0;e[g];g++)if(null!==e[g].get(d))return'Custom';for(var c=0;e[c];c++){var f=e[c],I=f.getId(),m=i.getParentProperty&&true===f.get(i.getParentProperty()+'@'),p=i.getPrevItemById(I)?i.getPrevItemById(I).data('id'):false,v=p?i.getDataSet().getRecordById(p):'',P=p?i.getParentProperty&&true===v.get(i.getParentProperty()+'@'):'',y=i.getNextItemById(I)?i.getNextItemById(I).data('id'):false,h=y?i.getDataSet().getRecordById(y):'',B=y?i.getParentProperty&&true===h.get(i.getParentProperty()+'@'):'';if(-1===parseInt(I,10)||-1===parseInt(r.getId(),10))return'Custom';if(m&&s)if(p=-1===parseInt(p,10)?null:p,r.getId()==y||r.getId()==p)return a.makeMoveResponse({obj:a,id:parseInt(I,10),id_before:p&&P?parseInt(p,10):null,id_after:y&&B?parseInt(y,10):null,direction_bl:!n,direction_call:n,recs_move:e,to_move:r});else{if(r.get(d)!==f.get(d))return'Custom';if(u=I,I=r.getId(),true===n)return y=i.getNextItemById(I)?i.getNextItemById(I).data('id'):false,h=y?i.getDataSet().getRecordById(y):'',B=y?i.getParentProperty&&true===h.get(i.getParentProperty()+'@'):'',a.makeMoveResponse({obj:a,id:parseInt(u,10),id_before:y!==u&&y&&B?parseInt(y,10):null,id_after:parseInt(I,10),direction_bl:null,direction_call:!n,recs_move:e,to_move:r});else return p=i.getPrevItemById(I)?i.getPrevItemById(I).data('id'):false,v=p?i.getDataSet().getRecordById(p):'',P=p?i.getParentProperty&&true===v.get(i.getParentProperty()+'@'):'',a.makeMoveResponse({obj:a,id:parseInt(u,10),id_before:parseInt(I,10),id_after:p!==u&&p&&P?parseInt(p,10):null,direction_bl:null,direction_call:n,recs_move:e,to_move:r});}if(!m&&!s){var _=new o();return require(['js!SBIS3.EDO.EdoCommon','SBIS3.CONTROLS/Utils/InformationPopupManager'],function(o,s){if(o.sortIsOn(i))return s.showMessageDialog({message:rk('Перемещение невозможно, так как включена сортировка записей'),status:'default'}),_.callback('Custom');if(e.length&&e[0].get('@СвязьПапок').indexOf('СвязьПапокПодзадача')>-1)return _.callback('Custom');var d=e.map(function(e){return e.getId();}),l=new t({endpoint:a._options.contract});_.dependOn(l.move(d,null===r?null:r.getId(),{position:n?'before':'after',parentProperty:i.getParentProperty(),nodeProperty:i.getNodeProperty()}).addCallback(function(){return a._moveInItems(e,r,!n),'MoveInItems';}));}),_;}return'Custom';}},hierarchyMove:function(o,a,f){if(1===o.length&&-1===parseInt(o[0].getId(),10)||u(a))return'Custom';f=void 0===f?true:Boolean(f);var I=this._options.dataView,m=I.getParent().getParent(),p=m.hasChildControlByName('taskHierBrowser'),v=new n(),P=new t({endpoint:'ПапкаДокументов'}),y=[],h=[],B=a&&a.get('@СвязьПапок'),_=I.getFilter()['ПапкаДокументов']||'',C=a&&B===_||!a&&''===_,b,w=false,S=I.getParentProperty?I.getParentProperty():false;if(s(I,o,B)||!d(B))return'Custom';r.setMessage(rk('Перемещение записей')+'...'),r.show();for(var M=0;o[M];M++){b=S&&true===o[M].get(S+'@');var k={browserView:I,record:o[M],isBranch:b,toCurrentFolder:C,foldersOnLeftSideMode:p,toFolderValue:B,brw:m};if(u(o[M])||l(o[M],b)||g(k))continue;if(a&&b&&S&&null===o[M].get(S)&&-1===parseInt(a.getId()))continue;var O=parseInt(o[M].getId(),10),N=a&&a.getId()?parseInt(a.getId(),10):-1;if(v.push(i(O,N,b,P)),b)w=true,h.push(o[M]);else y.push(o[M]);}var V=c(p,I,m);if('taskHierBrowser'===I.getName()&&null===I.getSelectedItem()&&V||!h.length&&!y.length)return r.hide(),'Custom';else f=!V;return v.done().getResult().addCallback(function(){if(r.hide(),f){var e=I&&I.getTopParent();if(e&&e.hasChildControlByName('PartialReloader')){if(require(['Core/EventBus'],function(e){e.channel('EdoPartialReloader').notify('onHierarhyMove',{id:I.getId(),recs:y,dirs:h,parent:a&&-1!==parseInt(a.get('@СвязьПапок')||'-1',10)?a:null,dontNotifyOnItemsCountChange:true});}),w)I.reload(void 0,void 0,void 0,void 0,true);}else if(I)I.reload();}return'Custom';}).addErrback(function(t){return r.hide(),e.showMessageDialog({message:t.message,status:'error'}),'Custom';});},onBeginMoveHandler:function(e,t,r,n){var o='Custom';if('on'===n)o=this.hierarchyMove(t,r);else o=this.move(t,r,'after'===n);e.setResult(o);}});return f.bindOnBeginMove=function(e,t){var r=new f({dataView:e,contract:t});e.subscribe('onBeginMove',r.onBeginMoveHandler.bind(r));},f;});
define("html!SBIS3.EDO.TaskSelection",function(){var o=function(o){var n=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;o.test(n);)n=n.replace(o,"&#123;&#123;$1&#125;&#125;");return n}}(),t=function(o){return o.join?o.join(""):o.toString()},e=function(o){return void 0===o?"":o&&"object"==typeof o?t(o):""+o},i="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div data-lmtype="Dialog" class="plan_selector"> <div class="ws-window-titlebar-custom ws-float-area__close-button-wrapper" data-lmchild="WindowTitle" style="font-size:0; padding-right:30px; min-height: 40px;"> <component data-component="SBIS3.CONTROLS/Button" name="SelectorControllerButton" class="edo-SelectorBtn"> <option name="caption">Выбрать</option> <option name="primary">true</option> <option name="visible">false</option> </component> </div> <component data-component="SBIS3.CONTROLS/Action/Selector/SelectorWrapper" class="edo-TaskSelection_SelectorWrapper"> <option name="linkedObjectName">browserView</option> <option name="content"> <div class="edo-TaskSelection"> <component data-component="SBIS3.EDO.TaskSelect" name="TaskSelectControl" class="tasksTabControl"> ');return o.multiselect&&(a+=' <option name="showTaskButton">true</option> <option name="showAddDoc">false</option> <option name="showAddFolder">false</option> <option name="showTransfer">false</option> <option name="multiselect">true</option> '),a+=' <option name="showAllTask">true</option> <option name="showOnCtrl">true</option> <option name="selectTask">true</option> <option name="showExecTask">true</option> <option name="myTaskHistoryId">MyTaskSelectionRegistry</option> <option name="allTaskHistoryId">AllTaskSelectionRegistry</option> <option name="onCtrlHistoryId">OnCtrlTaskSelectionRegistry</option> <option name="execTaskHistoryId">ExecutedTaskSelectionRegistry</option> ',void 0!==o.infiniteScrollContainer?a+=' <option name="infiniteScrollContainer">'+n(e(o.infiniteScrollContainer))+"</option> ":a+=' <option name="infiniteScrollContainer">true</option> ',a+=" ",o.subTask&&(a+=' <option name="subTask" value="'+n(e(o.subTask))+'"></option> '),a+=" </component> </div> </option> </component> </div> ",(a=n(a))+(i&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.TaskSelection"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.TaskSelection", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".tasksTabControl{width:810px}.tasksTabControl .subtasks_cont{display:none}.taskListAddBtn{position:absolute;left:8px;top:30px;height:auto;width:108px;z-index:100}.taskListAddBtn .addDocumentButton_mainBtn{width:108px}.edo-TaskSelection .ws-OperationsPanel{display:none}.edo-TaskSelection .ELO-Search{left:7px!important}.edo-TaskSelection,.edo-TaskSelection_SelectorWrapper,.plan_selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-moz-flex-direction:column;-ms-flex-direction:column;flex-direction:column}.edo-TaskSelection,.plan_selector{height:100%}.edo-SelectorBtn{position:absolute;right:40px;top:8px}"));head.appendChild(style);});}
define('js!SBIS3.EDO.TaskSelection',['SBIS3.CONTROLS/Action/Selector/SelectorController','html!SBIS3.EDO.TaskSelection','css!SBIS3.EDO.TaskSelection','js!SBIS3.EDO.TaskSelect','SBIS3.CONTROLS/Button','SBIS3.CONTROLS/Action/Selector/SelectorWrapper','i18n!SBIS3.EDO.TaskSelection','Elektronnyj_dokumentooborot_localization'],function(e,t){'use strict';var o=e.extend({_dotTplFn:t,$protected:{_options:{browserName:'МоиДокументы',subTask:false}},$constructor:function(){},init:function(){o.superclass.init.call(this);var e=this,t=e.getChildControlByName('TaskSelectTabs'),n=e._options.multiselect,r=e.getChildControlById('userTaskGroup'),l=e.hasChildControlByName('browserView')?e.getChildControlByName('browserView'):null;if(t.subscribe('onTabChange',function(e,t){var o=this._getTabById(t),n=o&&o.mainArea?this.getChildControlById(o.mainArea):null;if(l=n&&n.hasChildControlByName('browserView')?n.getChildControlByName('browserView'):null,l)l.subscribe('onItemClick',function(e,t,o){if(o&&o.get('ТипДокумента.ТипДокумента')){var r={added:[],removed:[]};n.sendCommand('selectorWrapperSelectionChanged',r),n.sendCommand('selectComplete');}});}),n){var i=e.getChildControlByName('SelectorControllerButton');e.subscribeTo(i,'onActivated',function(e){var t={added:[],removed:[]};r.sendCommand('selectorWrapperSelectionChanged',t),r.sendCommand('selectComplete');});}}});return o;});
define("tmpl!SBIS3.EDO.TMilestoneButton",["Core/tmpl/js/tclosure","js!SBIS3.CONTROLS/Link"],function(){var t=Array.prototype.slice.call(arguments),e=t[0],o={};o["js!SBIS3.CONTROLS/Link"]=t[1];var n=function t(n,i,r,l,a){function s(){}var c=0,d=void 0!==e&&e?e:arguments[arguments.length-1];void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure"));var p={};a&&a.isSetts&&(p=a.fullContext||{});var u="string"==typeof r?r:"",m=void 0===o?void 0:o,f={id:[],def:void 0},N=d.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,n),h=this&&this.includedTemplates?this.includedTemplates:{},v=d.getMarkupGenerator(l);try{var S=v.joinElements([v.createTag("div",{class:"edo-TMilestoneButton"},[v.createControl("wsControl","ws:SBIS3.CONTROLS/Link",{name:"link",bindings:[{fieldName:"record/tMilestoneButton/caption",propName:"caption",propPath:[],fullPropName:"caption",propPathStr:"",oneWay:!0,direction:"fromContext",bindNonExistent:!0},{fieldName:"record/tMilestoneButton/title",propName:"tooltip",propPath:[],fullPropName:"tooltip",propPathStr:"",oneWay:!0,direction:"fromContext",bindNonExistent:!0},{fieldName:"record/tMilestoneButton/icon",propName:"icon",propPath:[],fullPropName:"icon",propPathStr:"",oneWay:!0,direction:"fromContext",bindNonExistent:!0}],caption:"",tooltip:"",icon:"",className:"edo-TMilestoneButton_link",enabled:!0,command:"showDialog"},{name:"link",sbisname:"link"},{data:n,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:N},r,m,h,d.config,p),v.createTag("span",{"data-bind":"visible : 'record/tMilestoneButton/changed'",class:"icon-16 icon-Listbox icon-attention edo-TMilestoneButton_triangle ws-hidden",title:""+global.rk("Срок отличается от даты вехи")},[],{},f,this)],i,f,this)],u,f);f.def&&(S=v.chain(S,f,i),f=void 0)}catch(t){d.templateError("resources/Elektronnyj_dokumentooborot/components/TermMilestoneLink/TMilestoneButton/TMilestoneButton.tmpl",t,n)}return S||""};return n.includedFunctions={},n.stable=!0,n.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.TMilestoneButton"}},n});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.TMilestoneButton", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-TMilestoneButton_link{line-height:18px}.edo-TMilestoneButton_link.controls-Link .controls-Button__icon+.controls-Button__text{margin-left:0}.edo-TMilestoneButton_triangle{position:absolute;bottom:4px;right:-10px}"));head.appendChild(style);});}
define('js!SBIS3.EDO.TMilestoneButton',['SBIS3.CONTROLS/CompoundControl','WS.Data/Source/SbisService','Core/RightsManager','Core/ExtensionsManager','Core/constants','Core/helpers/fast-control-helpers','Core/ParallelDeferred','Core/Deferred','Core/CommandDispatcher','tmpl!SBIS3.EDO.TMilestoneButton','css!SBIS3.EDO.TMilestoneButton','Elektronnyj_dokumentooborot_localization'],function(e,t,n,i,s,o,l,a,r,c){'use strict';var u=e.extend({_dotTplFn:c,$protected:{_options:{},_isMlstAccessRights:false,_isPMExtensions:false,_isPMModule:false},$constructor:function(){r.declareCommand(this,'showDialog',function(){this.showDialog();}.bind(this)),this.once('onReady',function(){this._initialize();}.bind(this));},init:function(){u.superclass.init.call(this);},_initialize:function(){this._isMlstAccessRights=!!n.checkAccessRights(['Вехи']),this._isPMExtensions=!!i.checkExtensions(['УПРАВЛЕНИЕ_ПРОЕКТАМИ'])['УПРАВЛЕНИЕ_ПРОЕКТАМИ'],this._isPMModule='ProjectManagement'in s.modules;},showDialog:function(){var e=this.getLinkedContext().getValue('record'),n=new t({endpoint:'Веха'});new l({steps:[function(){if('СлужЗап'===e.get('ТипДокумента.ТипДокумента')&&'f3384eb8-bc07-11e4-8552-00505691577e'===e.get('ИдРегламента'))return n.call('НайтиВехиРодительскойЗадачи',{'ДокументСледствие':e.get('@Документ')}).addCallback(function(e){return new a().callback(e.getRawData());});else return new a().callback(null);}.bind(this)(),function(){if(this._isPMExtensions)return n.call('НайтиВехуДокумента',{'ДокументСледствие':e.get('@Документ')}).addCallback(function(e){return new a().callback(e.getAll());});else return new a().callback(null);}.bind(this)()]}).done().getResult().addCallback(function(e){o.showFloatArea({animation:'fade',autoHide:true,template:'js!SBIS3.EDO.TMilestoneDialog',opener:this,parent:this,target:this.getContainer(),side:'right',verticalAlign:'top',direction:'bottom',border:false,autoCloseOnHide:true,name:'Выбор вех и срока',offset:{x:205,y:-13},componentOptions:{parentMilestonesItems:e[0],milestoneItems:e[1]}});}.bind(this));},_allowShowMilestone:function(){return this._isMlstAccessRights&&this._isPMExtensions&&this._isPMModule;}});return u;});
define("tmpl!SBIS3.EDO.TMilestoneDialog",["Core/tmpl/js/tclosure","js!SBIS3.CONTROLS/DataGridView","js!SBIS3.CONTROLS/Link","js!SBIS3.CONTROLS/Button/IconButton"],function(){var e=Array.prototype.slice.call(arguments),o=e[0],t={};t["js!SBIS3.CONTROLS/DataGridView"]=e[1],t["js!SBIS3.CONTROLS/Link"]=e[2],t["js!SBIS3.CONTROLS/Button/IconButton"]=e[3];var n=function e(n,i,r,a,s){function l(){}var c=0,d=void 0!==o&&o?o:arguments[arguments.length-1];void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure"));var m={};s&&s.isSetts&&(m=s.fullContext||{});var u="string"==typeof r?r:"",g=void 0===t?void 0:t,h={id:[],def:void 0},p=d.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,n),w=this&&this.includedTemplates?this.includedTemplates:{},C=d.getMarkupGenerator(a);try{var S=C.joinElements([void(w.footer=function(e,o){var t=this&&this.includedTemplates?this.includedTemplates:{},n=d.getMarkupGenerator(a);try{var i=n.joinElements([n.createTag("span",{},[n.createText(""+global.rk("История изменения"))],o,h,this),n.createControl("wsControl","ws:SBIS3.CONTROLS/DataGridView",{name:"historyView"},d.plainMerge(o,{name:"historyView",sbisname:"historyView"}),{data:e,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:p},r,g,t,d.config,m)],u,h);h.def&&(i=n.chain(i,h,o),h=void 0)}catch(o){d.templateError("resources/Elektronnyj_dokumentooborot/components/TermMilestoneLink/TMilestoneDialog/TMilestoneDialog.tmpl",o,e)}return i||""}.bind({includedTemplates:w})),C.createTag("div",{class:"edo-TMilestoneDialog"},[C.createTag("div",{class:"edo-TMilestoneDialog_head"},[C.createControl("wsControl","ws:SBIS3.CONTROLS/Link",{name:"closeLink",allowChangeEnable:!1,command:"hideDialog",commandArgs:[d.getter(n,["isAuthor"])]},{class:"edo-TMilestoneDialog_closeLink ws-field-button ws-button-classic sbisname-window-title-close",name:"closeLink",sbisname:"closeLink"},{data:n,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:p},r,g,w,d.config,m),d.getter(n,["isAuthor"])?[C.createControl("wsControl","ws:SBIS3.CONTROLS/Button/IconButton",{name:"confirmButton",icon:"sprite:icon-16 icon-Yes icon-done",allowChangeEnable:!1,primary:!0,tooltip:global.rk("Подтвердить"),command:"confirmChange"},{class:"edo-TMilestoneDialog_confirmButton controls-IconButton controls-ButtonBase ws-enabled controls-IconButton__doneBorder controls-IconButton__round-border",name:"confirmButton",sbisname:"confirmButton"},{data:n,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:p},r,g,w,d.config,m)]:C.createText(""),d.getter(n,["isAuthor"])?C.createText(""):[C.createControl("wsControl","ws:SBIS3.CONTROLS/Link",{name:"changeLink",className:"edo-TMilestoneDialog_changeLink",allowChangeEnable:!1,caption:global.rk("Изменить"),command:"showChangeDialog"},{name:"changeLink",sbisname:"changeLink"},{data:n,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:p},r,g,w,d.config,m)],C.createControl("resolver",d.getter(n,["header"]),d.uniteScope(d.utils.escape(d.getter(n,["headConfiguration"])),{}),{},{data:n,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:p},r,g,w,d.config,m,h)],{},h,this),C.createTag("div",{class:"edo-TMilestoneDialog_body"},[],{},h,this),d.getter(n,["historyChangesView","count"])?[C.createTag("div",{class:"edo-TMilestoneDialog_footer"},[C.createControl("wsControl","ws:SBIS3.CONTROLS/Link",{name:"resizeLink",icon:"icon-16 icon-CollapseLight icon-hover",caption:"История изменений",className:"edo-TMilestoneDialog_resizeLink",allowChangeEnable:!1,command:"resizeHistoryChangesView"},{name:"resizeLink",sbisname:"resizeLink"},{data:n,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:p},r,g,w,d.config,m),C.createControl("wsControl","ws:SBIS3.CONTROLS/DataGridView",{name:"historyChangesView",items:d.getter(n,["historyChangesView","items"]),allowChangeEnable:!1,enabledMove:!1,className:"edo-TMilestoneDialog_viewFooter edo-TMilestoneDialog-cursor_auto controls-ListView__padding-S controls-ListView__withoutMarker",showPaging:!1,showHead:!1,pageSize:3,infiniteScroll:"demand",scrollPaging:!1,hasSeparator:!1,itemsActions:[],keyField:"@Документ",columns:[{width:"334",cellTemplate:"tmpl!SBIS3.EDO.TMilestoneDialog/resources/columns/HistoryChangesColumn"}]},{name:"historyChangesView",sbisname:"historyChangesView"},{data:n,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:p},r,g,w,d.config,m)],{},h,this)]:C.createText("")],i,h,this)],u,h);h.def&&(S=C.chain(S,h,i),h=void 0)}catch(e){d.templateError("resources/Elektronnyj_dokumentooborot/components/TermMilestoneLink/TMilestoneDialog/TMilestoneDialog.tmpl",e,n)}return S||""};return n.includedFunctions={},n.stable=!0,n.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.TMilestoneDialog"}},n});
define("tmpl!SBIS3.EDO.TMilestoneDialog/resources/template/Head",["Core/tmpl/js/tclosure","js!SBIS3.CONTROLS/Date/Picker","js!SBIS3.CONTROLS/Link","js!SBIS3.CONTROLS/DataGridView","js!SBIS3.EDO2.OpenDialogAction","js!SBIS3.CONTROLS/Action/SelectorAction"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],o={};o["js!SBIS3.CONTROLS/Date/Picker"]=e[1],o["js!SBIS3.CONTROLS/Link"]=e[2],o["js!SBIS3.CONTROLS/DataGridView"]=e[3],o["js!SBIS3.EDO2.OpenDialogAction"]=e[4],o["js!SBIS3.CONTROLS/Action/SelectorAction"]=e[5];var a=function e(a,n,i,r,l){function s(){}var c=0,m=void 0!==t&&t?t:arguments[arguments.length-1];void 0===m&&(eval("var thelpers = null;"),m=global.requirejs("View/Runner/tclosure"));var d={};l&&l.isSetts&&(d=l.fullContext||{});var g="string"==typeof i?i:"",p=void 0===o?void 0:o,S={id:[],def:void 0},u=m.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,a),v=this&&this.includedTemplates?this.includedTemplates:{},w=m.getMarkupGenerator(r);try{var N=w.joinElements([w.createTag("span",{class:"edo-TMilestoneDialog_label"},[w.createText(""+m.wrapUndef(m.utils.escape(m.getter(a,["caption"]))))],n,S,this),m.getter(a,["isAuthor"])?[w.createControl("wsControl","ws:SBIS3.CONTROLS/Date/Picker",{name:m.getter(a,["datePicker","name"]),allowChangeEnable:!1,date:m.getter(a,["datePicker","date"]),validators:m.getter(a,["datePicker","validators"]),handlers:m.getter(a,["datePicker","handlers"])},{class:m.utils.escape(m.getter(a,["datePicker","className"])),name:m.getter(a,["datePicker","name"]),sbisname:m.getter(a,["datePicker","name"])},{data:a,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:u},i,p,v,m.config,d)]:w.createText(""),m.getter(a,["allowShowMilestone"])?[w.createTag("div",{class:"edo-TMilestoneDialog_milestonesContainer"},[w.createControl("wsControl","ws:SBIS3.CONTROLS/Link",{name:m.getter(a,["linkAbove","name"]),className:"edo-TMilestoneDialog_addMilestoneLink",enabled:m.getter(a,["linkAbove","enabled"]),allowChangeEnable:!1,visible:m.getter(a,["linkAbove","visible"]),caption:"или веха",command:"showMilestoneSelection",commandArgs:[{viewName:m.getter(a,["view","name"]),datePickerName:m.getter(a,["datePicker","name"]),selectorActionName:m.getter(a,["selectorAction","name"]),linkAboveName:m.getter(a,["linkAbove","name"]),linkBelowName:m.getter(a,["linkBelow","name"])}]},{name:m.getter(a,["linkAbove","name"]),sbisname:m.getter(a,["linkAbove","name"])},{data:a,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:u},i,p,v,m.config,d),w.createTag("span",{class:"edo-TMilestoneDialog_linkHhint"},[w.createText(""+global.rk("в качестве срока окончания работы"))],{},S,this),w.createControl("wsControl","ws:SBIS3.CONTROLS/DataGridView",{name:m.getter(a,["view","name"]),items:m.getter(a,["view","items"]),enabled:m.getter(a,["view","enabled"]),enabledMove:!1,className:" edo-TMilestoneDialog_view controls-ListView__padding-S controls-ListView__withoutMarker "+m.getter(a,["view","additionalClass"]),showPaging:!1,showHead:!1,keyField:"@Документ",columns:[{field:"Название",width:"259",cellTemplate:"tmpl!SBIS3.EDO.TMilestoneDialog/resources/columns/MilestoneNameColumn"},{field:"Дата",width:"75",cellTemplate:"tmpl!SBIS3.EDO.TMilestoneDialog/resources/columns/MilestoneDateColumn"}],itemsActions:[{icon:"icon-16 icon-Erase icon-error",name:"delete",tooltip:"Удалить",caption:"Удалить",isMainAction:!0,onActivated:m.getter(a,["view","deleteRecord"])}],dataSource:{readerParams:{createMethodName:"Создать",destroyMethodName:"Удалить",format:"Веха.Список",linkedObject:"Веха",queryName:"СписокPy",readMethodName:"Прочитать",updateMethodName:"Записать",nameApplication:"Основной сервис inside",nameService:"Основной сервис inside"},filterParams:{"ФильтрПоДокументуСледствию":{saveToState:!1,fieldName:"ФильтрПоДокументуСледствию"}}},handlers:m.getter(a,["view","handlers"])},{name:m.getter(a,["view","name"]),sbisname:m.getter(a,["view","name"])},{data:a,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:u},i,p,v,m.config,d),w.createControl("wsControl","ws:SBIS3.EDO2.OpenDialogAction",{name:m.getter(a,["edoOpenDialogAction","name"])},{name:m.getter(a,["edoOpenDialogAction","name"]),sbisname:m.getter(a,["edoOpenDialogAction","name"])},{data:a,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:u},i,p,v,m.config,d),w.createControl("wsControl","ws:SBIS3.CONTROLS/Action/SelectorAction",{name:m.getter(a,["selectorAction","name"]),mode:"floatArea",template:"js!SBIS3.Milestones.MilestoneSelectorDialog",multiselect:!0},{name:m.getter(a,["selectorAction","name"]),sbisname:m.getter(a,["selectorAction","name"])},{data:a,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:u},i,p,v,m.config,d),w.createControl("wsControl","ws:SBIS3.CONTROLS/Link",{name:m.getter(a,["linkBelow","name"]),icon:"icon-16 icon-Add",className:"edo-TMilestoneDialog_plus controls-Link__disabledHover",enabled:m.getter(a,["linkBelow","enabled"]),allowChangeEnable:!1,visible:m.getter(a,["linkBelow","visible"]),caption:"Веха",command:"showMilestoneSelection",commandArgs:[{viewName:m.getter(a,["view","name"]),datePickerName:m.getter(a,["datePicker","name"]),selectorActionName:m.getter(a,["selectorAction","name"]),linkAboveName:m.getter(a,["linkAbove","name"]),linkBelowName:m.getter(a,["linkBelow","name"])}]},{name:m.getter(a,["linkBelow","name"]),sbisname:m.getter(a,["linkBelow","name"])},{data:a,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:u},i,p,v,m.config,d)],{},S,this)]:w.createText("")],g,S);S.def&&(N=w.chain(N,S,n),S=void 0)}catch(e){m.templateError("resources/Elektronnyj_dokumentooborot/components/TermMilestoneLink/TMilestoneDialog/resources/template/Head.tmpl",e,a)}return N||""};return a.includedFunctions={},a.stable=!0,a.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.TMilestoneDialog/resources/template/Head"}},a});
define("tmpl!SBIS3.EDO.TMilestoneDialog/resources/columns/MilestoneNameColumn",["Core/tmpl/js/tclosure"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={},o=function e(o,n,l,i,s){function a(){}var u=0,c=void 0!==t&&t?t:arguments[arguments.length-1];void 0===c&&(eval("var thelpers = null;"),c=global.requirejs("View/Runner/tclosure"));var d={};s&&s.isSetts&&(d=s.fullContext||{});var m="string"==typeof l?l:"",p=void 0===r?void 0:r,f={id:[],def:void 0},g=c.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),v=this&&this.includedTemplates?this.includedTemplates:{},T=c.getMarkupGenerator(i);try{var h=T.joinElements([c.getter(o,["item",c.getter(o,["field"])])?[T.createTag("div",{title:""+c.wrapUndef(c.utils.escape(c.getter(o,["item",c.getter(o,["field"])]))),class:"edo-TMilestoneDialog_nameColumn"},[T.createText(" "+c.wrapUndef(c.utils.escape(c.getter(o,["item",c.getter(o,["field"])])))+" ")],{},f,this)]:T.createText("")],m,f);f.def&&(h=T.chain(h,f,n),f=void 0)}catch(e){c.templateError("resources/Elektronnyj_dokumentooborot/components/TermMilestoneLink/TMilestoneDialog/resources/columns/MilestoneNameColumn.tmpl",e,o)}return h||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.TMilestoneDialog/resources/columns/MilestoneNameColumn"}},o});
define("tmpl!SBIS3.EDO.TMilestoneDialog/resources/columns/MilestoneDateColumn",["Core/tmpl/js/tclosure"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={},o=function e(o,i,l,n,s){function a(){}var c=0,u=void 0!==t&&t?t:arguments[arguments.length-1];void 0===u&&(eval("var thelpers = null;"),u=global.requirejs("View/Runner/tclosure"));var d={};s&&s.isSetts&&(d=s.fullContext||{});var m="string"==typeof l?l:"",p=void 0===r?void 0:r,f={id:[],def:void 0},g=u.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),v=this&&this.includedTemplates?this.includedTemplates:{},y=u.getMarkupGenerator(n);try{var D=y.joinElements([u.getter(o,["item",u.getter(o,["field"])])?[y.createTag("div",{title:""+u.wrapUndef(u.utils.escape(u.getDecorators().strftime.apply(void 0,[u.getter(o,["item",u.getter(o,["field"])]),"%d.%m.%y"]))),class:"edo-TMilestoneDialog_dateColumn"},[y.createText(" "+u.wrapUndef(u.utils.escape(u.getDecorators().strftime.apply(void 0,[u.getter(o,["item",u.getter(o,["field"])]),"%d.%m.%y"])))+" ")],{},f,this)]:y.createText("")],m,f);f.def&&(D=y.chain(D,f,i),f=void 0)}catch(e){u.templateError("resources/Elektronnyj_dokumentooborot/components/TermMilestoneLink/TMilestoneDialog/resources/columns/MilestoneDateColumn.tmpl",e,o)}return D||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.TMilestoneDialog/resources/columns/MilestoneDateColumn"}},o});
define("tmpl!SBIS3.EDO.TMilestoneDialog/resources/columns/HistoryChangesColumn",["Core/tmpl/js/tclosure","js!SBIS3.Person.PersonPhoto","js!SBIS3.CONTROLS/Link"],function(){var e=Array.prototype.slice.call(arguments),o=e[0],t={};t["js!SBIS3.Person.PersonPhoto"]=e[1],t["js!SBIS3.CONTROLS/Link"]=e[2];var n=function e(n,i,r,a,s){function l(){}var c=0,p=void 0!==o&&o?o:arguments[arguments.length-1];void 0===p&&(eval("var thelpers = null;"),p=global.requirejs("View/Runner/tclosure"));var d={};s&&s.isSetts&&(d=s.fullContext||{});var m="string"==typeof r?r:"",g=void 0===t?void 0:t,h={id:[],def:void 0},u=p.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,n),f=this&&this.includedTemplates?this.includedTemplates:{},C=p.getMarkupGenerator(a);try{var y=C.joinElements([C.createTag("div",{},[C.createTag("span",{},[C.createText("C "+p.wrapUndef(p.utils.escape(p.getDecorators().strftime.apply(void 0,[p.getter(n,["item","Старый срок"]),"%d.%m.%y"])))+" на "+p.wrapUndef(p.utils.escape(p.getDecorators().strftime.apply(void 0,[p.getter(n,["item","Новый срок"]),"%d.%m.%y"]))))],{},h,this),C.createTag("span",{class:"edo-TMilestoneDialog__historyChangesView-date"},[C.createText(""+p.wrapUndef(p.utils.escape(p.getDecorators().strftime.apply(void 0,[p.getter(n,["item","Дата"]),"%d.%m.%y"]))))],{},h,this),C.createTag("span",{class:""+p.wrapUndef(p.utils.escape("edo-TMilestoneDialog__historyChangesView-icon "+(p.getter(n,["item","Состояние"])?"icon-24 icon-Successful icon-done":"icon-24 icon-Unsuccess icon-error")))},[],{},h,this),C.createTag("div",{class:"edo-TMilestoneDialog__historyChangesView-photoContainer"},[C.createTag("div",{class:"edo-TMilestoneDialog__historyChangesView-photo"},[C.createControl("wsControl","ws:SBIS3.Person.PersonPhoto",{bindings:[{fieldName:"record/responsible/photo",propName:"data",propPath:[],fullPropName:"data",propPathStr:"",oneWay:!0,direction:"fromContext",bindNonExistent:!0}],data:{},settings:{size:32}},{},{data:n,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:u},r,g,f,p.config,d)],{},h,this),C.createTag("div",{class:"edo-TMilestoneDialog__historyChangesView-linkWrapper"},[C.createControl("wsControl","ws:SBIS3.CONTROLS/Link",{className:"edo-TMilestoneDialog__historyChangesView-changeResponsibleLink",name:"ChangeResponsibleLink",bindings:[{fieldName:"record/stickerInfo/responsible/mainInfo",propName:"caption",propPath:[],fullPropName:"caption",propPathStr:"",oneWay:!0,direction:"fromContext",bindNonExistent:!1}],caption:void 0,enabled:!1,allowChangeEnabled:!1},{name:"ChangeResponsibleLink",sbisname:"ChangeResponsibleLink"},{data:n,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:u},r,g,f,p.config,d),C.createTag("span",{class:"edo-TMilestoneDialog__historyChangesView-slash"},[C.createText(""+global.rk("/"))],{},h,this),C.createControl("wsControl","ws:SBIS3.CONTROLS/Link",{className:"edo-TMilestoneDialog__historyChangesView-changeTermBlockAdditionalInfo",bindings:[{fieldName:"record/stickerInfo/responsible/additionalInfo",propName:"caption",propPath:[],fullPropName:"caption",propPathStr:"",oneWay:!0,direction:"fromContext",bindNonExistent:!0}],caption:"",enabled:!1,escapeCaptionHtml:!1,allowChangeEnabled:!1},{},{data:n,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:u},r,g,f,p.config,d)],{},h,this),C.createTag("div",{},[C.createText(" "+p.wrapUndef(p.utils.escape(p.getter(n,["item","Описание"])))+" ")],{},h,this)],{},h,this)],i,h,this)],m,h);h.def&&(y=C.chain(y,h,i),h=void 0)}catch(e){p.templateError("resources/Elektronnyj_dokumentooborot/components/TermMilestoneLink/TMilestoneDialog/resources/columns/HistoryChangesColumn.tmpl",e,n)}return y||""};return n.includedFunctions={},n.stable=!0,n.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.TMilestoneDialog/resources/columns/HistoryChangesColumn"}},n});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.TMilestoneDialog", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-TMilestoneDialog{width:334px;min-height:30px}.edo-TMilestoneDialog_head{background-color:#f9f9f9;min-height:25px;padding:10px 12px}.edo-TMilestoneDialog_footer{padding:0 12px}.edo-TMilestoneDialog_label{color:#333;font-family:'TensorFont Полужирный',TensorFont;font-weight:700;font-style:normal;font-size:15px;margin-right:5px;padding-top:1px}.edo-TMilestoneDialog_changeLink,.edo-TMilestoneDialog_confirmButton{position:absolute;right:46px;top:8px}.edo-TMilestoneDialog_linkHhint{color:#999;margin-left:4px}.edo-TMilestoneDialog_milestonesContainer{margin-top:8px}.edo-TMilestoneDialog_addMilestoneLink.ws-hidden+.edo-TMilestoneDialog_linkHhint{display:none}.edo-TMilestoneDialog_view .controls-DataGridView__table,.edo-TMilestoneDialog_viewFooter .controls-DataGridView__table{left:-12px}.edo-TMilestoneDialog_dateColumn{color:#999;text-align:right;text-overflow:ellipsis;overflow:hidden}.edo-TMilestoneDialog_plus{font-size:12px;right:3px;color:#8991a9}.edo-TMilestoneDialog_plus .controls-Button__text,.edo-TMilestoneDialog_resizeLink .controls-Button__text{margin-left:0!important}.edo-TMilestoneDialog .controls-ItemActions .controls-ItemActions__itemsContainer>*{margin:0}.edo-TMilestoneDialog_resizeLink{color:#313e78;font-weight:700}.edo-TMilestoneDialog_resizeLink .controls-Button__wrapper{flex-direction:row-reverse}.edo-TMilestoneDialog_resizeLink .controls-Button__icon{margin-left:6px}.edo-TMilestoneDialog-cursor_auto .controls-DataGridView__td{cursor:auto}.edo-TMilestoneDialog_nameColumn{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.edo-TMilestoneDialog-min-height_body{min-height:221px}.edo-TMilestoneDialog__historyChangesView-photoContainer{padding:3px 0}.edo-TMilestoneDialog__historyChangesView-photo{margin-right:8px;float:left}.edo-TMilestoneDialog__historyChangesView-changeResponsibleLink{font-size:14px;color:#000!important;height:16px;line-height:16px}.edo-TMilestoneDialog__historyChangesView-changeTermBlockAdditionalInfo{color:#999!important;font-size:12px;cursor:default;text-align:left;height:16px;line-height:16px;overflow:hidden;text-overflow:ellipsis}.edo-TMilestoneDialog__historyChangesView-linkWrapper{display:flex}.edo-TMilestoneDialog__historyChangesView-date{color:#999;position:absolute;right:12px}.edo-TMilestoneDialog__historyChangesView-icon{position:absolute;right:70px;top:-1px}.edo-TMilestoneDialog__historyChangesView-slash{margin:0 4px;height:16px;line-height:16px;color:#999}"));head.appendChild(style);});}
define('js!SBIS3.EDO.TMilestoneDialog',['SBIS3.CONTROLS/CompoundControl','SBIS3.CONTROLS/Utils/InformationPopupManager','WS.Data/Source/SbisService','WS.Data/Collection/RecordSet','WS.Data/Collection/Factory/RecordSet','WS.Data/Adapter/Sbis','WS.Data/Chain','Core/ExtensionsManager','Core/CommandDispatcher','Core/helpers/date-helpers','Core/helpers/Hcontrol/toggleLocalIndicator','Core/RightsManager','Core/UserInfo','tmpl!SBIS3.EDO.TMilestoneDialog','tmpl!SBIS3.EDO.TMilestoneDialog/resources/template/Head','tmpl!SBIS3.EDO.TMilestoneDialog/resources/columns/MilestoneNameColumn','tmpl!SBIS3.EDO.TMilestoneDialog/resources/columns/MilestoneDateColumn','tmpl!SBIS3.EDO.TMilestoneDialog/resources/columns/HistoryChangesColumn','css!SBIS3.EDO.TMilestoneDialog','Elektronnyj_dokumentooborot_localization'],function(e,t,i,n,o,s,a,l,r,d,c,h,m,g,u){'use strict';var C=e.extend({_dotTplFn:g,$protected:{_options:{milestoneItems:null,parentMilestonesItems:null,historyChangesItems:null,reconciliation:null},_$state:{reconciliationDialogInstance:null,isHistoryChangesViewCollapsed:true}},$constructor:function(){this.once('onReady',function(){this._declareCommand();}.bind(this));},init:function(){C.superclass.init.call(this);},_declareCommand:function(){r.declareCommand(this,'hideDialog',function(e){this.hideDialog(e);}.bind(this)),r.declareCommand(this,'confirmChange',function(){this.confirmChange();}.bind(this)),r.declareCommand(this,'showChangeDialog',function(){this.showChangeDialog();}.bind(this)),r.declareCommand(this,'showMilestoneSelection',function(e){this.showMilestoneSelection(e);}.bind(this)),r.declareCommand(this,'getNearestMilestoneTerm',function(e){return this._getNearestMilestoneTerm(this.getChildControlByName(e).getItems());}.bind(this)),r.declareCommand(this,'resizeHistoryChangesView',function(){return this.resizeHistoryChangesView();}.bind(this)),r.declareCommand(this,'getParentComponent',function(){return this;}.bind(this));},_modifyOptions:function(){var e=C.superclass._modifyOptions.apply(this,arguments),t=!!h.checkAccessRights(['Вехи']),i=!!l.checkExtensions(['УПРАВЛЕНИЕ_ПРОЕКТАМИ'])['УПРАВЛЕНИЕ_ПРОЕКТАМИ'];e.isAuthor=m.get('ЧастноеЛицо')===this.getLinkedContext().getValue('record/ЛицоСоздал'),e.isAvailablePM=i,e.allowShowMilestone=e.allowShowMilestone||i,e.enabledMilestonesLink=t,e.countMilestones=e.milestoneItems?e.milestoneItems.getCount():0,e.header=u,e.date=this.getLinkedContext().getValue('record/ДокументРасширение.Срок'),e.headConfiguration=this._getHeaderConfiguration(e),e.historyChangesView={items:null,count:6};var o=[[1,new Date(),new Date(),'описание',true,new Date()],[2,new Date(),new Date(),'описание',false,new Date()],[3,new Date(),new Date(),'описание',true,new Date()]],a=[{n:'@Документ',t:'Идентификатор'},{n:'Старый срок',t:'Дата'},{n:'Новый срок',t:'Дата'},{n:'Описание',t:'Строка'},{n:'Состояние',t:'Логическое'},{n:'Дата',t:'Дата'}];return e.historyChangesView.items=new n({more:true,rawData:{_type:'recordset',d:o,s:a},adapter:new s()}),e;},_getHeaderConfiguration:function(e){var t={datePicker:{name:'datePickerHead',className:'edo-TMilestoneDialog_datePickerHead',date:e.date,validators:[{validator:C.prototype.checkDate}],handlers:{onKeyPressed:C.prototype.onKeyPressed}},linkAbove:{name:'aboveLinkAddMilestoneHead',enabled:e.enabledMilestonesLink,visible:!e.countMilestones&&e.isAuthor},linkBelow:{name:'belowLinkAddMilestoneHead',enabled:e.enabledMilestonesLink,visible:e.countMilestones&&e.isAuthor},view:{name:'viewHead',items:e.milestoneItems&&e.milestoneItems.clone(),enabled:e.isAuthor,deleteRecord:function(e,t,i){this.deleteRecords(t);},handlers:{},additionalClass:!e.isAuthor?'edo-TMilestoneDialog-cursor_auto':''},edoOpenDialogAction:{name:'openDialogActionHead'},selectorAction:{name:'milesoneSelectorActionHead'},caption:'Срок',isAuthor:e.isAuthor,allowShowMilestone:e.allowShowMilestone};if(e.allowShowMilestone)t.datePicker.validators.push({validator:C.prototype.checkMilestoneDate});if(!e.isAuthor)t.caption+=e.date?' до '+e.date.strftime('%d.%m.%y'):' не задан';else t.caption+=' до';if(e.isAuthor)t.view.handlers={onItemClick:C.prototype.onMilestoneItemClick,onChangeHoveredItem:C.prototype.onChangeHoveredItem,onEndDelete:C.prototype.onEndDelete};return t;},_getBodyConfiguration:function(e){var t={templateConfiguration:{datePicker:{name:'datePickerBody',className:'edo-TMilestoneDialog_datePickerBody',date:e.date,validators:[{validator:C.prototype.checkDate}]},linkAbove:{name:'aboveLinkAddMilestoneBody',enabled:e.enabledMilestonesLink,visible:!e.countMilestones},linkBelow:{name:'belowLinkAddMilestoneBody',enabled:e.enabledMilestonesLink,visible:e.countMilestones},view:{name:'viewBody',items:e.milestoneItems&&e.milestoneItems.clone(),enabled:true,deleteRecord:function(e,t,i){this.deleteRecords(t);},handlers:{onItemClick:C.prototype.onMilestoneItemClick,onChangeHoveredItem:C.prototype.onChangeHoveredItem,onEndDelete:C.prototype.onEndDelete},additionalClass:''},edoOpenDialogAction:{name:'openDialogActionBody'},selectorAction:{name:'milesoneSelectorActionBody'},caption:'Новый срок',isAuthor:true,allowShowMilestone:e.allowShowMilestone}};if(e.allowShowMilestone)t.templateConfiguration.datePicker.validators.push({validator:C.prototype.checkMilestoneDate});return t;},checkDate:function(){var e=this.getLinkedContext().getValue('record/ДокументРасширение.ДатаВремяСоздания'),t=this.getDate();if(e&&t&&d.compareDates(t,'<',e))return rk('Срок не может быть меньше даты создания документа');else return true;},checkMilestoneDate:function(){var e=this.getDate(),t=this.sendCommand('getNearestMilestoneTerm','datePickerHead'===this.getName()?'viewHead':'viewBody');if(e&&true!==t&&d.compareDates(e,'>',t))return rk('Срок не может превышать дату ближайшей вехи');else return true;},onKeyPressed:function(e,t){if(13===t.keyCode)this.sendCommand('confirmChange');},hideDialog:function(e){if(e&&(this._termIsChange()||this._milestoneListIsChange()))new t.showConfirmDialog({message:rk('Сохранить изменения?'),opener:this},function(){this.sendCommand('confirmChange');}.bind(this),function(){this.sendCommand('close');}.bind(this));else this.sendCommand('close');},confirmChange:function(){var e=this.getChildControlByName('datePickerHead'),t=this.getLinkedContext().getValue('record'),n=t.get('@Документ'),o=t.get('ДокументРасширение.Срок'),s=e.getDate()||this._getNearestMilestoneTerm(this.getChildControlByName('viewHead').getItems()),a=this._options.isAvailablePM;if(!e.validate())return;if(this._termIsChange(o,s)){var l,r={};if(t.set('ДокументРасширение.Срок',s),t.acceptChanges(['ДокументРасширение.Срок']),a)l='ЗаписатьСрокиДокументаNew',r['Документ']=n,r['ДатаНачала']=null,r['ДатаОкончания']=s?s.toSQL(true):null;else l='ЗаписатьСрокДокумента',r['Документ']=n,r['Дата']=s?s.toSQL(true):null;new i({endpoint:'Документ'}).call(l,r).addCallback(function(){this.sendCommand('notify','onUpdateModel',{record:t,isNewRecord:void 0,key:t.getId()});}.bind(this));}if(this._options.allowShowMilestone){var d=this.getChildControlByName('viewHead').getItems();if(t.set('РП.ВехаДокумента',this._milestoneViewRSToDlgRS(d)),t.acceptChanges(['РП.ВехаДокумента']),this._milestoneListIsChange()){var c=[];if(d)d.each(function(e){c.push(parseInt(e.getId(),10));});new i({endpoint:'Веха'}).call('ЗаписатьВехуДокумента',{'ДокументСледствие':n,'Вехи':c,'Добавить':false}).addCallback(function(e){this.sendCommand('notify','onUpdateModel',{record:t,isNewRecord:void 0,key:t.getId()});}.bind(this));}}this.sendCommand('close');},onMilestoneItemClick:function(e,t,n){(function(e){var t=this.getChildControlByName(e.dialogActionName),n=this.getChildControlByName(e.viewName);t.once('onExecuted',function(t,o,s){c(n.getContainer(),true),new i({endpoint:'Веха'}).call('Прочитать',{'ИдО':e.item.get('@Документ'),'ИмяМетода':'Веха.Список'}).addCallback(function(t){var i=t.getRow(),o=n.getItems(),s=e.item.get('Дата'),a=i.get('Веха.Дата');if(function(e,t){return e.get('Название')!==t.get('Веха.Название')||d.compareDates(e.get('Дата'),'!=',t.get('Веха.Дата'))||e.get('Состояние')!==t.get('Веха.Состояние').get();}(e.item,i))if(e.item.set('Название',i.get('Веха.Название')),e.item.set('Дата',i.get('Веха.Дата')),e.item.set('Состояние',i.get('Веха.Состояние').get()),n.setItems(this._sort(o)),d.compareDates(s,'!=',a))this.getChildControlByName(e.datePickerName).setDate(o.at(0).get('Дата'));c(n.getContainer(),false);}.bind(this));}.bind(this)),t.execute({id:e.item.get('@Документ')});}.bind(this.sendCommand('getParentComponent'))({item:n,viewName:this.getName(),dialogActionName:'viewHead'===this.getName()?'openDialogActionHead':'openDialogActionBody',datePickerName:'viewHead'===this.getName()?'datePickerHead':'datePickerBody'}));},onChangeHoveredItem:function(e,t){var i=this.getItemsActions().getItemsInstances(),n=function(e){var t=e.get('Состояние'),i=m.get('ЧастноеЛицо')===e.get('Ответственный'),n=!!h.checkAccessRights(['Администратор вех']),o=h.checkAccessRights(['Добавление в закрытые вехи']),s=!!h.checkAccessRights(['Вехи']),a=this._options.parentMilestonesItems&&-1!==this._options.parentMilestonesItems.indexOf(parseInt(e.getId(),10));if(n)return true;else if(i||2===o||a)return 0===t||1===t||2===t;else if(s)return 0===t||1==t;}.bind(this),o;for(o in i)if(i.hasOwnProperty(o))switch(o){case'delete':i[o][t.record&&n(t.record)?'show':'hide']();}},onEndDelete:function(){(function(e){var t=this.getChildControlByName(e.viewName),i=this._sort(t.getItems()),n=i.getCount()?i.at(0).get('Дата'):null;if(t.setItems(i),this.getChildControlByName(e.datePickerName).setDate(n),this.hasChildControlByName(e.aboveLinkName))this.getChildControlByName(e.aboveLinkName).setVisible(!i.getCount());if(this.hasChildControlByName(e.belowLinkName))this.getChildControlByName(e.belowLinkName).setVisible(i.getCount());}.bind(this.sendCommand('getParentComponent'))({viewName:this.getName(),datePickerName:'viewHead'===this.getName()?'datePickerHead':'datePickerBody',aboveLinkName:'viewHead'===this.getName()?'aboveLinkAddMilestoneHead':'aboveLinkAddMilestoneBody',belowLinkName:'viewHead'===this.getName()?'belowLinkAddMilestoneHead':'belowLinkAddMilestoneBody'}));},showMilestoneSelection:function(e){var t=this.getChildControlByName(e.selectorActionName);t.once('onExecuted',function(t,i,n){if(!n)return;var o=this.getChildControlByName(e.viewName),s=this._sort(this._milestoneSelectorRSToViewRS(n)),a=s.at(0).get('Дата');if(o.setItems(s),this.hasChildControlByName(e.linkAboveName))this.getChildControlByName(e.linkAboveName).setVisible(!s.getCount());if(this.hasChildControlByName(e.linkBelowName))this.getChildControlByName(e.linkBelowName).setVisible(s.getCount());if(a)this.getChildControlByName(e.datePickerName).setDate(a);}.bind(this)),t.execute({multiselect:true,dialogOptions:{className:'ws-float-area__block-layout'},componentOptions:{checkRights:true,fullFilter:false,filterByDate:new Date(),termMilestones:this._options.parentMilestonesItems,forbidSelectFolder:true,selectionType:'leaf'},selectedItems:this._milestonViewRSToSelectorRS(this.getChildControlByName(e.viewName).getItems()),opener:this,parent:this});},showChangeDialog:function(){if(this._$state.reconciliationDialogInstance)this._$state.reconciliationDialogInstance.destroy(),this._$state.reconciliationDialogInstance=void 0;this.getChildControlByName('changeLink').destroy(),require(['js!SBIS3.EDO.TMilestoneReconciliationDialog'],function(e){var t=window.jQuery('<div>'),i=this._getBodyConfiguration(this._options);i.element=t,i.parent=this,i.linkedContext=this.getLinkedContext(),this._$state.reconciliationDialogInstance=new e(i),$(this.getContainer()[0].getElementsByClassName('edo-TMilestoneDialog_body')).addClass('edo-TMilestoneDialog-min-height_body ').append(t);}.bind(this));},resizeHistoryChangesView:function(){var e=this.getChildControlByName('resizeLink'),t=this._$state.isHistoryChangesViewCollapsed;this._$state.isHistoryChangesViewCollapsed=!t,e.setIcon(t?'icon-16 icon-ExpandLight icon-hover':'icon-16 icon-CollapseLight icon-hover');},_termIsChange:function(e,t){return e=e||this.getLinkedContext().getValue('record').get('ДокументРасширение.Срок'),t=t||this.hasChildControlByName('datePickerHead')&&this.getChildControlByName('datePickerHead').getDate(),!!(t&&!e||!t&&e||d.compareDates(t,'!=',e));},_milestoneSelectorRSToViewRS:function(e){var t=[],i=[],o=[{n:'@Документ',t:'Идентификатор'},{n:'Состояние',t:'Число целое'},{n:'Название',t:'Строка'},{n:'Дата',t:'Дата'},{n:'Ответственный',t:'Число целое'}];if(e)e.each(function(e){var n=e.get('@Документ');if(-1==i.indexOf(n))i.push(n),t.push([n,e.get('Веха.Состояние')?e.get('Веха.Состояние').get():null,e.get('ДокументРасширение.Название'),e.get('Веха.Дата'),e.get('Сотрудник.@Лицо')]);});return new n({rawData:{_type:'recordset',d:t,s:o},adapter:new s()});},_milestoneViewRSToDlgRS:function(e){var t=[],i=[{n:'ИдВехи',t:'Идентификатор'},{n:'Состояние',t:'Число целое'},{n:'ДокументРасширение.Название',t:'Строка'},{n:'ДокументРасширение.Срок',t:'Дата'},{n:'Ответственный',t:'Число целое'}];if(e)e.each(function(e){t.push([e.get('@Документ'),e.get('Состояние'),e.get('Название'),e.get('Дата'),e.get('Ответственный')]);});return new n({rawData:{_type:'recordset',d:t,s:i},adapter:new s()});},_milestonViewRSToSelectorRS:function(e){var t=[],i=[['@Документ','Идентификатор','identity'],['Веха.Состояние','Перечисляемое','enum'],['ДокументРасширение.Название','Строка','string'],['Веха.Дата','Дата','date'],['Сотрудник.@Лицо','Число целое','integer']];function o(e){return i.reduce(function(t,i){var n={};return n[e?'n':'name']=i[0],n[e?'t':'type']=i[e?1:2],t.push(n),t;},[]);}if(e)e.each(function(e){t.push([e.get('@Документ'),e.get('Состояние'),e.get('Название'),e.get('Дата'),e.get('Ответственный')]);});return new n({rawData:{_type:'recordset',d:t,s:o(true)},adapter:new s(),format:o()});},_getNearestMilestoneTerm:function(e){var t=this._sort(e);if(t&&t.getCount())return t.at(0).get('Дата');return null;},_sort:function(e,t){return t=t||'viewHead',new a(e||this.getChildControlByName(t).getItems()).sort(function(e,t){return d.compareDates(e.get('Дата'),'>=',t.get('Дата'));}).value(o,{adapter:new s(),idProperty:'@Документ'});},_milestoneListIsChange:function(e,t){if(!this._options.allowShowMilestone)return false;e=e||this._options.milestoneItems,t=t||this.getChildControlByName('viewHead').getItems();var i=function(e){var t=[];if(e)e.each(function(e){t.push(parseInt(e.getId(),10));});return t;},n=i(e),o=i(t);if(n.length===o.length){for(var s=0;s<n.length;s++)if(n.indexOf(o[s])<0)return true;}else return true;return false;}});return C;});
define("tmpl!SBIS3.EDO.TMilestoneReconciliationDialog",["Core/tmpl/js/tclosure","js!SBIS3.CONTROLS/Button","js!SBIS3.Person.PersonPhoto","js!SBIS3.CONTROLS/Link","js!SBIS3.CONTROLS/TextArea"],function(){var e=Array.prototype.slice.call(arguments),o=e[0],t={};t["js!SBIS3.CONTROLS/Button"]=e[1],t["js!SBIS3.Person.PersonPhoto"]=e[2],t["js!SBIS3.CONTROLS/Link"]=e[3],t["js!SBIS3.CONTROLS/TextArea"]=e[4];var n=function e(n,i,r,a,l){function s(){}var c=0,p=void 0!==o&&o?o:arguments[arguments.length-1];void 0===p&&(eval("var thelpers = null;"),p=global.requirejs("View/Runner/tclosure"));var d={};l&&l.isSetts&&(d=l.fullContext||{});var m="string"==typeof r?r:"",u=void 0===t?void 0:t,g={id:[],def:void 0},T=p.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,n),f=this&&this.includedTemplates?this.includedTemplates:{},N=p.getMarkupGenerator(a);try{var S=N.joinElements([N.createTag("div",{class:"edo-TMilestoneReconciliationDialog"},[N.createTag("span",{class:"edo-TMilestoneReconciliationDialog_label"},[N.createText(""+global.rk("Требуется согласование"))],{},g,this),N.createControl("wsControl","ws:SBIS3.CONTROLS/Button",{caption:"Согласовать",className:"edo-TMilestoneReconciliationDialog_button edo-TMilestoneDialog_changeTermBlockButton",primary:!0,command:""},{},{data:n,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:T},r,u,f,p.config,d),N.createTag("div",{class:"edo-TMilestoneReconciliationDialog_photoContainer"},[N.createTag("div",{class:"edo-TMilestoneReconciliationDialog_photo"},[N.createControl("wsControl","ws:SBIS3.Person.PersonPhoto",{bindings:[{fieldName:"record/responsible/photo",propName:"data",propPath:[],fullPropName:"data",propPathStr:"",oneWay:!0,direction:"fromContext",bindNonExistent:!0}],data:{},settings:{size:32}},{},{data:n,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:T},r,u,f,p.config,d)],{},g,this),N.createTag("div",{class:"edo-TMilestoneDialog_linkWrapper"},[N.createControl("wsControl","ws:SBIS3.CONTROLS/Link",{className:"edo-TMilestoneReconciliationDialog_changeResponsibleLink",name:"ChangeResponsibleLink",bindings:[{fieldName:"record/stickerInfo/responsible/mainInfo",propName:"caption",propPath:[],fullPropName:"caption",propPathStr:"",oneWay:!0,direction:"fromContext",bindNonExistent:!1}],caption:void 0},{name:"ChangeResponsibleLink",sbisname:"ChangeResponsibleLink"},{data:n,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:T},r,u,f,p.config,d)],{},g,this),N.createTag("div",{class:"edo-TMilestoneDialog_linkWrapper"},[N.createControl("wsControl","ws:SBIS3.CONTROLS/Link",{className:"edo-TMilestoneReconciliationDialog_changeTermBlockAdditionalInfo",bindings:[{fieldName:"record/stickerInfo/responsible/additionalInfo",propName:"caption",propPath:[],fullPropName:"caption",propPathStr:"",oneWay:!0,direction:"fromContext",bindNonExistent:!0}],caption:"",enable:!1,escapeCaptionHtml:!1,allowChangeEnabled:!1},{},{data:n,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:T},r,u,f,p.config,d)],{},g,this)],{},g,this),N.createControl("resolver",p.getter(n,["template"]),p.uniteScope(p.utils.escape(p.getter(n,["templateConfiguration"])),{}),{},{data:n,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:T},r,u,f,p.config,d,g),N.createTag("div",{class:"edo-TMilestoneReconciliationDialog_TextAreaWrapper"},[N.createControl("wsControl","ws:SBIS3.CONTROLS/TextArea",{name:"TextArea",minLinesCount:"2",placeholder:"Укажите причину",autoResize:{maxLinesCount:5,state:!0}},{class:"edo-TMilestoneReconciliationDialog_TextArea",name:"TextArea",sbisname:"TextArea"},{data:n,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:T},r,u,f,p.config,d)],{},g,this)],i,g,this)],m,g);g.def&&(S=N.chain(S,g,i),g=void 0)}catch(e){p.templateError("resources/Elektronnyj_dokumentooborot/components/TermMilestoneLink/TMilestoneDialog/resources/TMilestoneReconciliationDialog/TMilestoneReconciliationDialog.tmpl",e,n)}return S||""};return n.includedFunctions={},n.stable=!0,n.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.TMilestoneReconciliationDialog"}},n});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.TMilestoneReconciliationDialog", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-TMilestoneReconciliationDialog{padding:10px 12px}.edo-TMilestoneReconciliationDialog_label{color:#d94700;font-size:15px;font-weight:700}.edo-TMilestoneReconciliationDialog_button{position:absolute;right:12px}.edo-TMilestoneReconciliationDialog_photoContainer{padding:12px 0}.edo-TMilestoneReconciliationDialog_photo{margin-right:8px;float:left}.edo-TMilestoneDialog_linkWrapper{margin-top:-3px;overflow:hidden}.edo-TMilestoneReconciliationDialog_changeResponsibleLink{font-size:14px;font-weight:700;color:#313e78;text-align:left;height:16px;line-height:16px}.edo-TMilestoneReconciliationDialog_changeTermBlockAdditionalInfo{color:#999;font-size:12px;cursor:default;text-align:left;height:16px;line-height:16px}.edo-TMilestoneReconciliationDialog_TextArea{width:100%}.edo-TMilestoneReconciliationDialog_TextAreaWrapper{padding:15px 0}"));head.appendChild(style);});}
define('js!SBIS3.EDO.TMilestoneReconciliationDialog',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.TMilestoneReconciliationDialog','tmpl!SBIS3.EDO.TMilestoneDialog/resources/template/Head','css!SBIS3.EDO.TMilestoneReconciliationDialog','Elektronnyj_dokumentooborot_localization'],function(i,n,t){'use strict';var o=i.extend({_dotTplFn:n,$protected:{_options:{}},$constructor:function(){this.once('onReady',function(){this._declareCommand();}.bind(this));},init:function(){o.superclass.init.call(this);},_declareCommand:function(){},_modifyOptions:function(){var i=o.superclass._modifyOptions.apply(this,arguments);return i.template=t,i;}});return o;});
define("html!SBIS3.EDO.TransitionsList",function(){var o=function(o){var n=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;o.test(n);)n=n.replace(o,"&#123;&#123;$1&#125;&#125;");return n}}(),e="undefined"!=typeof process,t=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div style="width:416px;height:416px;"> <component data-component="Deprecated/Controls/TableView/TableView" name="СписокПереходов" class="TransitionsList"> <options name="display"> <options name="columns" type="array"> <options> <option name="field">Название</option> <option name="width" type="string">350</option> <option name="fixedSize">true</option> </options> </options> </options> <options name="dataSource"> <options name="readerParams"> <option name="linkedObject">Переход</option> <option name="nameApplication">Основной сервис</option> <option name="nameService">Основной сервис</option> <option name="queryName">Список</option> <option name="createMethodName">Создать</option> <option name="format">Переход.Список</option> <option name="updateMethodName">Записать</option> <option name="readMethodName">Прочитать</option> <option name="destroyMethodName">Удалить</option> </options> </options> <options name="filterParams"> <options name="Фаза"> <option name="saveToState">false</option> <option name="autoreload">true</option> <option name="fieldName">ФильтрФаза</option> </options> </options> </component> </div>');return(t=n(t))+(e&&-1!==t.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.TransitionsList"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.TransitionsList", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".TransitionsList{margin-left:0;margin-right:0;bottom:16px;height:100%;position:relative}"));head.appendChild(style);});}
define('js!SBIS3.EDO.TransitionsList',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.TransitionsList','css!SBIS3.EDO.TransitionsList','Deprecated/Controls/TableView/TableView','Elektronnyj_dokumentooborot_localization'],function(t,i){'use strict';var n=t.extend({_dotTplFn:i,$protected:{_options:{autoHeight:true,autoWidth:true}},$constructor:function(){},init:function(){n.superclass.init.call(this);}});return n.title='Результат',n;});
define("html!SBIS3.EDO.TypeExternalDocument",function(){var o=function(o){var t=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;o.test(t);)t=t.replace(o,"&#123;&#123;$1&#125;&#125;");return t}}(),n=function(o){return o.join?o.join(""):o.toString()},e=function(o){return void 0===o?"":o&&"object"==typeof o?n(o):""+o},i="undefined"!=typeof process,r=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div> <div> <div class="blockTitle ws-float-area-title"> '+t(e(rk("Типы документов")))+' </div> <div class="blockButt"> <component data-component="SBIS3.CONTROLS/Button" name="VDSelectButton" class="ctVDSelectButton"> <option name="caption">Выбрать</option> <option name="primary">true</option> </component> </div> </div> <component data-component="SBIS3.CONTROLS/DataGridView" name="Таблица" class="controls-ListView__showCheckBoxes ctVDDataGridView"> <options name="columns" type="array"> <options> <option name="className" type="string">ctVDDataGridClm</option> <option name="field">Название</option> </options> </options> <option name="showHead">false</option> <options name="itemsActions" type="array"></options> <option name="emptyHTML">Нет записей</option> <option name="multiselect">true</option> <option name="itemsDragNDrop">false</option> </component> </div>');return(r=t(r))+(i&&-1!==r.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.TypeExternalDocument"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.TypeExternalDocument", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".ctVDDataGridView{height:auto;width:320px;margin-top:10px}.ctVDDataGridClm{width:220px}.blockTitle{display:inline-block;height:40px;text-align:center;line-height:40px;text-align:left}.blockButt{display:inline-block;height:40px;line-height:40px;width:100px;vertical-align:top;padding-left:54px}"));head.appendChild(style);});}
define('js!SBIS3.EDO.TypeExternalDocument',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.TypeExternalDocument','WS.Data/Source/SbisService','SBIS3.CONTROLS/DataGridView','SBIS3.CONTROLS/Button','css!SBIS3.EDO.TypeExternalDocument','Elektronnyj_dokumentooborot_localization'],function(e,t,n){'use strict';var i=e.extend({_dotTplFn:t,$protected:{_options:{resizable:false}},$constructor:function(){},init:function(){i.superclass.init.call(this);var e=this,t=e.getChildControlByName('Таблица'),o=e.getChildControlByName('VDSelectButton'),s=new n({endpoint:'Документ',binding:{query:'СписокТиповВДДляФильтра'},idProperty:'ТипДокумента'});t.setDataSource(s),o.subscribe('onActivated',function(){e.sendCommand('close',t.getSelectedKeys());}),o.hide(),t.subscribe('onSelectedItemsChange',function(){var e=this.getSelectedKeys();if(1==e.length&&0==e.indexOf('Все'))o.hide();else o.show();});}});return i;});
define("html!SBIS3.EDO.TypeExternalDocumentLV",function(){var o=function(o){var n=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;o.test(n);)n=n.replace(o,"&#123;&#123;$1&#125;&#125;");return n}}(),e=function(o){return o.join?o.join(""):o.toString()},t=function(o){return void 0===o?"":o&&"object"==typeof o?e(o):""+o},i="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div> <div> <div class="blockTitle ws-float-area-title"> '+n(t(rk("Типы документов")))+' </div> <div class="blockButt"> <component data-component="SBIS3.CONTROLS/Button" name="VDSelectButtonLV" class="btnVDSelectButton"> <option name="caption">Выбрать</option> <option name="primary">true</option> </component> </div> </div> <component data-component="Deprecated/Controls/TableView/TableView" name="TVTypeDocLV" class="ctVDDataTableView"> <options name="display"> <option name="showSelectionCheckbox">true</option> <options name="columns" type="array"> <options> <option name="className" type="string">ctVDTableViewClm</option> <option name="field">Название</option> </options> </options> </options> <options name="dataSource"> <options name="readerParams"> <option name="linkedObject">Документ</option> <option name="queryName">СписокТиповВДДляФильтра</option> <option name="format">Документ.СписокТиповВДДляФильтра</option> <option name="nameApplication">Основной сервис</option> <option name="nameService">Основной сервис</option> </options> <options name="filterParams"> <option name="ТипРеестра" value="Вх"></option> </options> </options> <option name="showHead">false</option> <option name="emptyHTML">Нет записей</option> <option name="multiselect">true</option> <option name="useSelection">true</option> </component> </div>');return(a=n(a))+(i&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.TypeExternalDocumentLV"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.TypeExternalDocumentLV", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".btnVDSelectButton{left:90px}.ctVDDataTableView{height:auto;width:320px}.ctVDTableViewClm{width:220px;padding-left:4px!important}.blockTitle{display:inline-block;height:40px;text-align:center;line-height:40px;width:100px;text-align:left}.blockButt{display:inline-block;height:40px;line-height:40px;width:200px}"));head.appendChild(style);});}
define('js!SBIS3.EDO.TypeExternalDocumentLV',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.TypeExternalDocumentLV','Deprecated/Controls/TableView/TableView','SBIS3.CONTROLS/Button','css!SBIS3.EDO.TypeExternalDocumentLV','Elektronnyj_dokumentooborot_localization'],function(e,t){'use strict';var n=e.extend({_dotTplFn:t,$protected:{_options:{}},$constructor:function(){},init:function(){n.superclass.init.call(this);var e=this,t=e.getTopParent().getChildControlByName('TVTypeDocLV'),o=e.getTopParent().getChildControlByName('VDSelectButtonLV'),r=e.getLinkedContext().getValue('ИмяБраузера');t.toggleColumn({'ТипДокумента':false}),t.setSource({readerParams:{linkedObject:'Документ',queryName:'СписокТиповВДДляФильтра',format:'Документ.СписокТиповВДДляФильтра',nameApplication:'Основной сервис',nameService:'Основной сервис'},filterParams:{'ТипРеестра':r}}),o.subscribe('onActivated',function(){t.sendCommand('confirmSelection');});}});return n;});
define("html!SBIS3.EDO.UnallocDoc",function(){var o=function(o){var n=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;o.test(n);)n=n.replace(o,"&#123;&#123;$1&#125;&#125;");return n}}(),e=function(o){return o.join?o.join(""):o.toString()},t=function(o){return void 0===o?"":o&&"object"==typeof o?e(o):""+o},i="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="edo-UnallocDoc"> <component data-component="SBIS3.EDO2.Dialog" name=\'UnallocDocDialog\'> <option name="objectName" value="Нерасп"></option> <option name="stickyHeader">true</option> <opt name="firstLineContent"> <component data-component="SBIS3.EDO.RegisterDocButton" name="Зарегистрировать" class="edo-left-doc-butt edo-Dialog_header-Comment"> <option name="caption">'+n(t(rk("Зарегистрировать")))+'</option> <option name="visible" bind="record/visibleRegisterButton" value="true"></option> <option name="tabindex" value="0"></option> </component> <div class="edo-left-doc-butt edo-Dialog_header-Comment"> <component name="btnSendBuh" data-component="SBIS3.CONTROLS.Button" class="btnSendBuh"> <option name="caption">'+n(t(rk("Отправить в бухгалтерию")))+'</option> <option name="visible" bind="record/visibleSendBuhButton" value="false"></option> <options name="handlers"> <option name="onActivated" type="function">js!SBIS3.EDO.UnallocDocHandlers:onUnallocDocToSend</option> </options> </component> <component name="btnSendCont" data-component="SBIS3.CONTROLS.Link" class="btnSendCont"> <option name="caption">'+n(t(rk("Отправить контрагенту")))+'</option> <option name="visible" bind="record/visibleSendContButton" value="false"></option> <options name="handlers"> <option name="onActivated" type="function">js!SBIS3.EDO.UnallocDocHandlers:onUnallocDocToSend</option> </options> </component> </div> <div class="edo-Dialog_header-Comment"> <div class="edo-unallocated-div-right-button"> <component data-component="SBIS3.EDO2.AttachButton" name="AttachTo" class="edo-uncallocated-attach-button"> <options name=\'referenceTypes\'> <option name=\'sbisDisk\'>true</option> <option name=\'web\'>false</option> </options> <option name="tabindex" value="0"></option> <option name="visible" bind="record/visibleAttachFile" value="false"></option> </component> <component name="scanButton" data-component="Lib/Control/FileScaner/FileScaner" class="edo-unallocated-file-scaner"> <option name="visible" bind="record/visibleAttachFile" value="false"></option> <option name="className" value=""></option> <option name="renderStyle" value="asLink"></option> <option name="method" value="Документ.ЗагрузитьФайл"></option> <option name="createZip" value="false" type="boolean"></option> <option name="showInterface" value="false" type="boolean"></option> <option name="default" value="false" type="boolean"></option> <option name="image">sprite:icon-24 icon-Scan icon-primary</option> <option name="tabindex">3</option> <option name="imageAlign" value="left"></option> <option name="caption">'+n(t(rk("Скан")))+'</option> <option name="allowChangeEnable">false</option> <option name="enable">true</option> <option name="tabindex" value="0"></option> <options name="handlers"> <option name="onLoaded" type="function" value="js!SBIS3.EDO.UnallocDocHandlers:onLoadedScan"></option> </options> </component> <div class="edo-switch-visibility-mode-butt"> <component data-component="SBIS3.DOCVIEW.SwitchVisibilityMode" name="ModeSwitcher"> <option name=\'visible\' value="record/visibleSwitchVisibilityMode"></option> <option name="tabindex" value="0"></option> <options name="hasSwitch"> <option name="bigPreview" value="true" type="boolean"></option> <option name="diskClassic" value="false" type="boolean"></option> <option name="classic" value="true" type="boolean"></option> </options> <options name="listOptions"> <options name="visibilityMode"> <option name="defaultMode">bigPreview</option> <option name="setFromCookie">false</option> </options> </options> </component> </div> </div> </div> </opt> <option name="secondLineContent"> </option> <options name="tabs" type="array"> <options> <option name="id">firstTab</option> <option name="title"> <component data-component=\'SBIS3.EDO2.MainTabHeaderTemplate\'> <option name=\'mainInfo\'>Нераспределенные</option> <option name=\'additionalInfo1\'> <component data-component=\'SBIS3.CONTROLS.EditAtPlace\' name=\'additionalInfo1\'> <option name=\'text\' bind=\'record/Дата\'></option> <option name=\'editorTpl\'> <component data-component=\'SBIS3.CONTROLS.DatePicker\'> <option name=\'date\' bind=\'record/Дата\'></option> <option name="allowChangeEnable" type="boolean">false</option> <option name=\'notificationMode\'>complete</option> <option name=\'validateIfHidden\' value=\'true\' type=\'boolean\'></option> <options name=\'validators\' type=\'array\'> <options> <option name=\'errorMessage\' value=\''+n(t(rk("Укажите дату")))+'\'></option> <option name=\'validator\' type=\'function\'>SBIS3.CONTROLS/Utils/ControlsValidators:required</option> <option name=\'option\' value=\'date\'></option> </options> </options> </component> </option> </component> </option> </component> </option> <option name="content" type="content"> <div class="edo-uncallocated_controls"> <div class="edo-unallocated_sticker-container"> <component data-component="SBIS3.EDO2.Sticker" name="TaskSticker"> <option name="tabindex" value="2"></option> <option name="mini">true</option> </component> </div> <table class="edo-unallocated_table"> <tr> <td> <div> <component data-component="SBIS3.CONTROLS.TextBox" data-bind="{Text : record/ДокументРасширение.Название}"> <option name="name" value="extNameField"></option> <option name="placeholder">'+n(t(rk("Комментарий")))+'</option> </component> </div> </td> </tr> </table> <div> <component data-component="SBIS3.DOCVIEW.FullViewer" name="СписокВложений"> <option name="className" value="edo-unallocated_fullViewer"></option> <options name="mainOptions"> <option name="ctxLinkList" value="record/РП.Документ/СписокВложений"></option> <opt name="objectName" type="string" bind="record/РП.Документ/ТипДокумента/ТипДокумента" notexistent="Документ" oneWay="true"></opt> <opt name="directLinkRouting" type="string" value="document"></opt> <opt name="isDisk">false</opt> <options name="commands"> <option name="rename">true</option> <option name="print">true</option> <option name="fullScreen">true</option> <option name="saveToPdf">true</option> <option name="upload">true</option> <option name="edit">false</option> <option name="editInApp">false</option> <option name="sendMessage">false</option> <option name="addPage">false</option> <option name="deleteDoc">true</option> <option name="deletePage">false</option> <option name="deletePermanentlyDoc">false</option> <option name="rights">false</option> <option name="restore">false</option> <option name="move">false</option> <option name="closeFullScreen">true</option> <option name="copyToBuffer">false</option> <option name="links">false</option> <option name="redactions">false</option> <option name="directLink">false</option> <option name="signDocument">false</option> </options> </options> <options name="viewOptions"> <option name="mode" value="view"></option> <option name="autoWidth" value="true"></option> </options> <options name="listOptions"> <option name="previewWidth">269</option> <option name="previewHeight">269</option> <option name="itemsDragNDrop">false</option> <option name="multiselect">true</option> <option name="hideBreadCrumbs">true</option> <option name="calcMargin">false</option> <options name="visibilityMode"> <option name="defaultMode">bigPreview</option> </options> </options> </component> </div> </div> </option> </options> </options> <options name="handlers"> <options name="onReady" type="array"> <option type="function">js!SBIS3.EDO.UnallocDocHandlers:onReadyDialog</option> <option name="fnc" type="function" value="js!SBIS3.EDO.UnallocDocHandlers:onSave"></option> </options> </options> </component> </div>');return(a=n(a))+(i&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.UnallocDoc"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.UnallocDoc", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-switch-visibility-mode-butt{border-left:none;height:25px;float:right!important;margin-top:4px;margin-right:6px}.edo-left-doc-butt{height:25px;text-align:left;top:1px;float:left;left:3px}.edo-unallocated-div-right-button{margin-top:8px}.edo-uncallocated-attach-button{height:25px;float:right!important;margin-right:2px}.edo-unallocated-file-scaner{height:25px;width:60px!important;float:right!important;margin-right:8px}.btnSendCont{color:#999;text-decoration:none;padding-left:10px}.btnSendCont:hover{color:#313e78!important;text-decoration:underline;border-style:none!important}.btnSendBuh{height:24px;text-align:left;float:left;left:3px}.edo-unallocated_sticker-container{position:absolute;right:0;z-index:500}.edo-uncallocated_controls{margin-left:8px}.edo-unallocated_table{width:100%;table-layout:fixed;padding-right:211px}.edo-unallocated_table tr td{padding-top:8px;padding-bottom:8px}.edo-unallocated_table .controls-Link{color:#999}.edo-unallocated_table .controls-Link:hover{color:#ff7033}.edo-unallocated_table .controls-Link.ws-disabled{color:#ccc;cursor:default;text-decoration:none}.edo-unallocated_table .StaffChoiceClickable{font-weight:700}.edo-unallocated_table tr td div{width:100%}.docview-FullViewer.edo-unallocated_fullViewer{margin-top:10px}.edo-unallocated_fullViewer .docview-list__path{display:none}.edo-unallocated_fullViewer .controls-CompositeView .controls-CompositeView__listItem.dv-classic-item{padding-left:28px}.edo-unallocated_fullViewer .dv-classic-item .controls-ListView__itemCheckBox{left:8px}"));head.appendChild(style);});}
define('js!SBIS3.EDO.UnallocDoc',['js!SBIS3.EDO2.FormController','html!SBIS3.EDO.UnallocDoc','js!SBIS3.EDO.UnallocDocModel','js!SBIS3.CONTROLS.Utils.InformationPopupManager','js!SBIS3.EDO.UnallocatedHandlers','js!SBIS3.EDO2.Dialog','css!SBIS3.EDO.UnallocDoc','js!SBIS3.EDO2.MainTabHeader','js!SBIS3.EDO2.Sticker','js!SBIS3.EDO.RegisterDocButton','js!SBIS3.DOCVIEW.FullViewer','js!SBIS3.DOCVIEW.SwitchVisibilityMode','Lib/Control/FileScaner/FileScaner','js!SBIS3.CONTROLS.Button','js!SBIS3.EDO.UnallocDocHandlers','js!SBIS3.EDO2.AttachButton','js!SBIS3.EDO2.MainTabHeaderTemplate','js!SBIS3.CONTROLS.EditAtPlace','js!SBIS3.CONTROLS.DatePicker','js!SBIS3.CONTROLS.ControlsValidators','js!SBIS3.CONTROLS.TextBox','js!SBIS3.CONTROLS.Link','i18n!SBIS3.EDO.UnallocDoc','Elektronnyj_dokumentooborot_localization'],function(e,t,o,n,i){'use strict';var s=e.extend({_dotTplFn:t,$protected:{_options:{dataSource:{endpoint:{contract:'Нерасп'},binding:{read:'Документ.ПрочитатьДляУчастника',destroy:'Документ.УдалитьДокументы',format:'Нерасп.Список',query:'Список'},model:o},readMetaData:{'ИмяОбъекта':'Нерасп'}}},$constructor:function(){},_showConfirmDialog:function(){if(window.location.pathname.indexOf('registry.html')<0)this._saving=true,this._isConfirmDialogShowed=true,n.showConfirmDialog({message:rk('Отправить в бухгалтерию')+'?',details:rk('Чтобы продолжить редактирование, нажмите \xABОтмена\xBB.'),hasCancelButton:true},e.superclass._confirmDialogHandler.bind(this,true),e.superclass._confirmDialogHandler.bind(this,false),e.superclass._confirmDialogHandler.bind(this));else e.superclass._showConfirmDialog.call(this);},init:function(){s.superclass.init.call(this);var e=this,t=e.getChildControlByName('СписокВложений'),o=e.getChildControlByName('attachments'),n=e.getChildControlByName('extNameField'),a=e.getChildControlByName('RegisterMenuButton');o.subscribe('onSelectedItemsChange',function(){var e=this.getSelectedKeys().length>0?rk('Зарегистрировать отмеченные'):rk('Зарегистрировать');a.setCaption(e);}),o.subscribe('onDataLoad',function(e,t){a.setEnabled(t.getCount()>0),n.setActive(true);}),t.subscribe('onFinishCommand',function(o,n){if('deleteDoc'==n)if(e.sendCommand('edoLoadAttachFiles'),0==t.viewerRecordSet.getCount())e.sendCommand('edoCloseDocument',true),e.sendCommand('notify','onUpdateModel'),i.updateCounter();}),e.subscribe('onFinishCommand',function(e,t){if('edoDeleteDocument'==t.commandName||'edoRestoreDocument'==t.commandName)i.updateCounter();});}});return s.dimensions={width:'900'},s;});
define("html!SBIS3.EDO.UnallocatedLoader",function(){var e=function(e){var i=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(i){for(;e.test(i);)i=i.replace(e,"&#123;&#123;$1&#125;&#125;");return i}}(),n=function(e){return e.join?e.join(""):e.toString()},r=function(e){return void 0===e?"":e&&"object"==typeof e?n(e):""+e},o="undefined"!=typeof process,t=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,"<div> ");if(e.result.unallocatedFiles&&e.result.unallocatedFiles.length>0){t+=' <div class="error-files-area"> <div class="ws-separator ws-separator-marker ws-separator-line"><div>'+i(r(rk("Что сделать с прочими документами?")))+'</div></div> <div id="error_files_message" class="error_files_message"></div> <div class="error-files-links"> <component data-component="Deprecated/Controls/LinkButton/LinkButton" name="BtnToBuh"> <option name="caption">отдать в бухгалтерию или отправить контрагенту</option> </component> ',e.result.loadedFiles&&e.result.loadedFiles.length>0&&(t+=' <div id="error_files_links" style="display: inline-block;"> <span style="display: inline-block; vertical-align: bottom; height: 24px;">'+i(r(rk(",")))+'</span> <component data-component="Deprecated/Controls/LinkButton/LinkButton" name="BtnToFirst"> <option name="caption">прикрепить к первому загруженному документу</option> </component> </div> '),t+=' </div> <div class="error-files-list"> ';var a=e.result.unallocatedFiles;if(a)for(var l=-1,s=a.length-1;l<s;)t+=" <div> "+i(r(a[l+=1].fileName))+" </div> ";t+=' </div> </div> <div class="error-files-area-sent"> <div class="loaded-document-item"> <a class="unallocated-link">'+i(r(rk("Отправлено в бухгалтерию или контрагенту")))+"</a> <div> ";var d=e.result.unallocatedFiles;if(d)for(var l=-1,c=d.length-1;l<c;)t+=' <div class="loadedFileName"> '+i(r(d[l+=1].fileName))+" </div> ";t+=" </div> </div> </div> "}return t+=" </div>",(t=i(t))+(o&&-1!==t.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.UnallocatedLoader"}},e});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.UnallocatedLoader", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".unallocated-title{font-size:18px;display:inline-block;vertical-align:middle;margin-right:16px}.error-files-area,.error-files-area-sent{padding:0 16px 8px 0}.error-files-links{vertical-align:top;padding:0 0 0 32px}.error-files-list{margin:0 0 0 32px}.error-files-area-sent{display:none}.error-files-area-sent a.unallocated-link{cursor:pointer;display:inline-block;font-size:15px}.error_files_message{color:#ef463a;padding-left:32px}"));head.appendChild(style);});}
define('js!SBIS3.EDO.UnallocatedLoader',['WS.Data/Source/SbisService','Core/moduleStubs','Core/Indicator','SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.UnallocatedLoader','js!SBIS3.EDO.UnallocatedHandlers','js!SBIS3.EDO2.OpenDialogAction','css!SBIS3.EDO.UnallocatedLoader','Deprecated/Controls/LinkButton/LinkButton','Elektronnyj_dokumentooborot_localization'],function(e,o,t,n,i,l,r){'use strict';var a=n.extend({_dotTplFn:i,$protected:{_options:{result:{},sessionId:''}},$constructor:function(){},init:function(){a.superclass.init.call(this);var n=this,i=new r();if(this.hasChildControlByName('BtnToBuh'))this.getChildControlByName('BtnToBuh').subscribe('onClick',function(){t.show(),l.createNeraspFromFiles(n._options.result.unallocatedFiles,n._options.sessionId,function(e){n.showNewUnallocated(e,n._options.result),t.hide();},false);});if(this.hasChildControlByName('BtnToFirst')){var s,d,c=this.getChildControlByName('BtnToFirst');if(jQuery.inArray(n._options.result.loadedFiles[0]['Параметры'].d[3],['ДокОтгрВх','ДокОтгрИсх','АктСверВх','АктСверИсх','АктСверкиДок','СчетВх','СчетИсх','ДоговорДок','ДоговорВх','ДоговорИсх','ЗаказВх','ЗаказИсх','Нерасп'])>-1)s=n._options.result.loadedFiles[0]['Параметры'].d[0],d=n._options.result.loadedFiles[0]['Параметры'].d[3];if(s&&s>0)t.show(),new e({endpoint:'Документ'}).call('НаРедактировать',{'ИдО':s}).addCallback(function(){new e({endpoint:'Документ'}).call('Прочитать',{'ИдО':s,'ИмяМетода':d+'.Список'}).addCallback(function(e){var r=e.getRow().get('ИдентификаторДокумента');l.loadFilesToDoc(n._options.result.unallocatedFiles,s,n._options.sessionId,function(e){o.requireModule('SBIS3.FL.FileLoader').addCallback(function(){t.hide(),c.subscribe('onClick',function(){i.execute({guid:r,openMode:0}),n.getTopParent().close();});});});});}).addErrback(function(){t.hide();});else $(n.getTopParent().getContainer().find('#error_files_links')).hide(),n.getTopParent().getContainer().find('#error_files_message')[0].textContent=rk('Невозможно прикрепить файл к отчету. Выберите другие действия')+':';}},showNewUnallocated:function(e,o){var t=parseInt(e.getRow().get('@Документ'),10),n=new r();if($('div.error-files-area').hide(),o.loadedFiles.length)$($($('.allLoadArea').children()[0]).children()[o.loadedFiles.length]).after($($('.error-files-area-sent').html())),$($($('.allLoadArea').children()[0]).children()[o.loadedFiles.length+1]).css('cursor','pointer').click(function(){n.execute({id:t,openMode:0});});else $($($('.allLoadArea').children()[0]).children()[o.loadedFiles.length]).before('<div class="ws-separator ws-separator-marker ws-separator-line"><div>'+rk('Загруженные файлы','EDO')+'</div></div>'),$($($('.allLoadArea').children()[0]).children()[0]).after($('.error-files-area-sent').html()),$('.loaded-document-item').css('cursor','pointer').click(function(){n.execute({id:t,openMode:0});});}});return a;});
define("html!SBIS3.EDO.UnallocatedTypeList",function(){var o=function(o){var n=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;o.test(n);)n=n.replace(o,"&#123;&#123;$1&#125;&#125;");return n}}(),e="undefined"!=typeof process,t=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div> <component data-component="Deprecated/Controls/SearchString/SearchString" name="ФильтрДокументовПоМаске" class="TypesListSearchString"> <option name="tooltip">Поиск...</option> <option name="linkedBrowser">TypesList</option> <option name="filterName">НазваниеКраткое</option> <option name="useBrowserFilter">true</option> </component> <component data-component="Deprecated/Controls/TreeView/TreeView" name="TypesList" class="types-list ws-browser-hover"> <option name="autoHeight">true</option> <option name="autoWidth">true</option> <option name="verticalAlignment">Top</option> <options name="display"> <option name="rootNode" value="-1"></option> <option name="cutLongRows">true</option> <option name="emptyHtml">нет данных</option> <options name="columns" type="array"> <options> <option name="title" value=""></option> <option name="field">НазваниеКраткое</option> </options> </options> <option name="addRecordInEmptyTable">false</option> <option name="allowHorizontalScroll">false</option> <options name="mainRowOptions"> <option name="edit">false</option> </options> <option name="partiallyLoad">false</option> <option name="usePaging" value=""></option> <option name="showRecordsCount">false</option> <option name="hierColumn">Раздел</option> <option name="titleColumn">НазваниеКраткое</option> <option name="rootName" value=""></option> <option name="showPaging">false</option> <option name="recordsPerPage">100</option> <option name="viewType">true</option> </options> <option name="allowAdd">false</option> <option name="allowDelete">false</option> <option name="allowEdit">false</option> <option name="allowChangeEnable">false</option> <option name="useSelection">false</option> <options name="dataSource"> <options name="readerParams"> <option name="linkedObject">ТипДокумента</option> <option name="queryName">СписокДляНерасп</option> </options> </options> </component> </div>');return(t=n(t))+(e&&-1!==t.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.UnallocatedTypeList"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.UnallocatedTypeList", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".TypesListSearchString{width:150px;margin:10px 8px}.types-list .ws-browser-head-container{display:none}"));head.appendChild(style);});}
define('js!SBIS3.EDO.UnallocatedTypeList',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.UnallocatedTypeList','css!SBIS3.EDO.UnallocatedTypeList','Deprecated/Controls/TreeView/TreeView','Deprecated/Controls/SearchString/SearchString','js!SBIS3.EDO.UnallocatedHandlers','Elektronnyj_dokumentooborot_localization'],function(t,e){'use strict';var n=t.extend({_dotTplFn:e,$protected:{_options:{width:300,autoHeight:true}},$constructor:function(){},init:function(){n.superclass.init.call(this);}});return n;});
define("html!SBIS3.EDO.UserFolderDialog",function(){var o=function(o){var e,t=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(e){for(;o.test(e);)e=e.replace(o,"&#123;&#123;$1&#125;&#125;");return e}}(),n=function(o){return o.join?o.join(""):o.toString()},i=function(o){return void 0===o?"":o&&"object"==typeof o?n(o):""+o},a="undefined"!=typeof process,p=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,"");return o.record&&(o.rec=o.record),void 0!=o.rec&&(e=o.rec.get("Условие")),e&&void 0!=e?(void 0!=(e=JSON.parse(e))["Проекты"]&&e["Проекты"].length>0&&(o.showProjectsInput=!0),void 0!=e["Вехи"]&&e["Вехи"].length>0&&(o.showMilestonesInput=!0),void 0!=e["Регламенты"]&&e["Регламенты"].length>0&&(o.showRulesInput=!0),void 0!=e["Этапы"]&&e["Этапы"].length>0&&(o.showStagesInput=!0,o.stagesField=e["Этапы"][0]),void 0!=e["Метки"]&&e["Метки"].length>0&&(o.showTagsInput=!0),o.descText=o.descWhenSet,o.descriptionMoved=!0):(o.descText=o.descWhenClear,o.descriptionMoved=!1),p+=' <div data-lmtype="Dialog" class="edo-UserFolderDialog"> <div class="ws-window-titlebar-custom" data-lmchild="WindowTitle" style="font-size:0; padding-right:40px;"> <component data-component="SBIS3.CONTROLS/Button" name="saveButton" class="edo-UserFolderDialog__saveButton"> <option name="caption">'+t(i(rk("Сохранить")))+'</option> <option name="primary">true</option> <option name="tabindex">7</option> </component> </div> <div> <component data-component="SBIS3.CONTROLS/TextBox" class="edo-UserFolderDialog__title_block" name="Название"> <option name="placeholder" value="'+t(i(rk("Название")))+'"></option> <option name="text" bind="Название"></option> <option name="tabindex">1</option> <option name="trim">true</option> <options name="validators" type="array"> <options> <option name="errorMessage" value="Необходимо заполнить название">'+t(i(rk("Необходимо заполнить название")))+"</option> <option name=\"validator\" type=\"function\">SBIS3.CONTROLS/Utils/ControlsValidators:required</option> <option name='option' value='text'></option> </options> </options> </component> </div> ",o.advanced&&(p+=' <div style="margin-bottom:16px;float:left;width:428px;" class="edo-UserFolderDialog__desctext"> <div id="fieldsHeader" class="edo-UserFolderDialog__bottomarea_title',o.showProjectsInput&&o.showPMFields||o.showMilestonesInput&&o.showPMFields||o.showRulesInput||o.showStagesInput||o.showTagsInput||(p+=" ws-hidden"),p+='">'+t(i(rk("В эту папку автоматически перемещаются задания")))+'</div> <div id="projectsArea" class="edo-UserFolderDialog__alg_areas',o.showProjectsInput&&o.showPMFields||(p+=" ws-hidden"),p+='"> <span class="edo-UserFolderDialog__area_title">'+t(i(rk("проекта")))+'</span> <component data-component="SBIS3.CONTROLS/FieldLink" name="projectsField" style="width:428px;"> <option name="tabindex">2</option> <opt name="text" bind="text1"></opt> <opt name="useSelectorAction" type="boolean">true</opt> <opt name="placeholder" value="'+t(i(rk("Укажите проект")))+'"></opt> <opt name="displayField" value="ДокументРасширение.Название"></opt> <opt name="idProperty" value="@Документ"></opt> <opt name="keyField" value="@Документ"></opt> <option name=\'multiselect\' type="boolean">true</option> <option name=\'selectRecordsMode\'>newFloatArea</option> <option name=\'oldViews\' type="boolean">true</option> <options name=\'dataSource\'> <option name=\'module\'>WS.Data/Source/SbisService</option> <options name=\'options\'> <option name=\'endpoint\'>Проект</option> <options name=\'binding\'> <option name=\'query\'>СписокРу</option> </options> </options> </options> <options name="dictionaries" type="array"> <options> <option name="caption" value="Проекты"></option> <option name="template" value="js!SBIS3.ProjectManagement.DialogProjectsWithWorks"></option> <option name="editMode">newFloatArea</option> <option name="name">Проекты</option> <option name="objectName">Проект</option> <option name="readOnly" type="boolean">true</option> <option name="selectionType">leaf</option> </options> </options> <opts name="list"> <opt name="component" value="SBIS3.CONTROLS/DataGridView"/> <opts name="options"> <opt name="footerTpl" value="tmpl!SBIS3.EDO.BaseFiltersStyles/footerTpl"/> <opt name="pageSize" value="5"/> <opt name="ignoreLocalPageSize" value="true" type="boolean"/> <opts name="itemsActions"></opts> <opts name="columns" type="array"> <opts> <opt name="title">Название</opt> <opt name="field">ДокументРасширение.Название</opt> </opts> </opts> <opt name="keyField" value="@Документ"></opt> </opts> </opts> <opts name="listFilter"> <opt name="ФильтрПоМаске" bind="text1" oneWay="true"/> <option name="ПолучитьПлоскийСписок" type="boolean">true</option> </opts> </component> </div> <div id="milestonesArea" class="edo-UserFolderDialog__alg_areas',o.showMilestonesInput&&o.showPMFields||(p+=" ws-hidden"),p+='"> <span class="edo-UserFolderDialog__area_title">'+t(i(rk("включенные в веху")))+'</span> <component data-component="SBIS3.CONTROLS/FieldLink" name="milestonesField" style="width:428px;"> <option name="tabindex">3</option> <options name=\'dataSource\'> <option name=\'module\'>WS.Data/Source/SbisService</option> <options name=\'options\'> <option name=\'endpoint\'>Веха</option> <options name=\'binding\'> <option name=\'query\'>СписокPy</option> <option name=\'format\'>Веха.Список</option> </options> </options> </options> <options name="dictionaries" type="array"> <options> <option name="editMode">newFloatArea</option> <option name="keyField">@Документ</option> <option name="name">Веха</option> <option name="objectName">Веха</option> <option name="template">js!SBIS3.Milestones.MilestoneSelectorDialog</option> <option name="readOnly" type="boolean">true</option> <option name="selectionType">all</option> <options name="dialogOptions"> <option name="className">ws-float-area__block-layout</option> </options> </options> </options> <opt name="useSelectorAction" type="boolean">true</opt> <opt name="keyField" value="@Документ"></opt> <opt name="displayField" value="ДокументРасширение.Название"></opt> <opt name="placeholder" value="'+t(i(rk("включенные в веху")))+'"></opt> <option name=\'multiselect\' type="boolean">true</option> <option name=\'selectRecordsMode\'>newFloatArea</option> <option name=\'oldViews\' type="boolean">false</option> <opt name="text" bind="text2"></opt> <opts name="list"> <opt name="component" value="SBIS3.CONTROLS/DataGridView"/> <opts name="options"> <opt name="footerTpl" value="tmpl!SBIS3.EDO.BaseFiltersStyles/footerTpl"/> <opt name="pageSize" value="5"/> <opt name="ignoreLocalPageSize" value="true" type="boolean"/> <opts name="itemsActions"></opts> <opts name="columns" type="array"> <opts> <opt name="title">Название</opt> <opt name="field">ДокументРасширение.Название</opt> </opts> </opts> <opt name="keyField" value="@Документ"></opt> </opts> </opts> <opts name="listFilter"> <opt name="ФильтрПоМаске" bind="text2" oneWay="true"/> <option name="ПолучитьПлоскийСписок" type="boolean">true</option> </opts> </component> </div> <div id="rulesArea" class="edo-UserFolderDialog__alg_areas',o.showRulesInput||(p+=" ws-hidden"),p+='"> <span class="edo-UserFolderDialog__area_title">'+t(i(rk("с операцией")))+'</span> <component data-component="'+t(i(o.RulesSelectorTemplate))+'" name="rulesField" style="width:428px;"> <option name="tabindex">4</option> <option name="multiSelect" type="boolean">true</option> <option name="selectionType">leaf</option> <option name="showTypes" type="boolean">true</option> <option name="placeholder" value="'+t(i(rk("с операцией")))+'"></option> <option name="keyField" value="Идентификатор"></option> <option name="hidePhase">true</option> <option name="displayField" value="Название"></option> </component> </div> <div id="stagesArea" class="edo-UserFolderDialog__alg_areas',o.showStagesInput||(p+=" ws-hidden"),p+='"> <span class="edo-UserFolderDialog__area_title">'+t(i(rk("на этапе")))+'</span> <component data-component="SBIS3.CONTROLS/TextBox" style="width:428px;" name="stagesField"> <option name="tabindex">5</option> <option name="placeholder" value="'+t(i(rk("Введите название этапа")))+'"></option> <option name="text">'+t(i(o.stagesField))+'</option> </component> </div> <div id="tagsArea" class="edo-UserFolderDialog__alg_areas',o.showTagsInput||(p+=" ws-hidden"),p+='"> <span class="edo-UserFolderDialog__area_title">'+t(i(rk("с пометкой")))+'</span> <component data-component="SBIS3.CONTROLS/TextBox" style="width:428px;" name="tagsField"> <option name="tabindex">0</option> <option name="placeholder" value="Метка"></option> </component> </div> <div id="priorityArea" class="',o.showProjectsInput&&o.showPMFields||o.showMilestonesInput&&o.showPMFields||o.showRulesInput||o.showStagesInput||o.showTagsInput||(p+=" ws-hidden"),p+='">'+t(i(rk("Вы можете установить приоритет перемещения в текущую папку")))+' <component name="infoPriority" data-component="SBIS3.CONTROLS/Button/IconButton"> <option name="icon">sprite:icon-24 icon-Question2 icon-disabled action-hover</option> </component> <div> <component data-component="SBIS3.CONTROLS/Radio/Group" name="priorityGroup" class="edo-priority_group"> <option name="tabindex">0</option> <option name="selectedKey">2</option> <option name="idProperty">id</option> <option name="displayProperty">title</option> <options name="items" type="array"> <options> <option name="id">3</option> <option name="title">'+t(i(rk("Высокий")))+'</option> </options> <options> <option name="id">2</option> <option name="title">'+t(i(rk("Средний")))+'</option> </options> <options> <option name="id">1</option> <option name="title">'+t(i(rk("Низкий")))+'</option> </options> </options> </component> </div> </div> <div id="descriptionBottom" ',(o.showProjectsInput&&o.showPMFields||o.showMilestonesInput&&o.showPMFields||o.showRulesInput||o.showStagesInput||o.showTagsInput)&&(p+=' class="edo-UserFolderDialog__desctext_right" '),p+='> <div id="descriptionBottomText">'+t(i(o.descText))+'</div> <div> <span class="',o.showPMFields||(p+="ws-hidden"),p+='"><component data-component="SBIS3.CONTROLS/Link" name="projectsButton" class="edo-UserFolderDialog__alglink',o.showPMFields||(p+=" ws-hidden"),p+='"> <option name="caption">',o.descriptionMoved?p+=t(i(rk("проектов"))):p+=t(i(rk("проекта"))),p+='</option> <option name="tabindex">0</option> </component></span>',o.showPMFields&&(p+=", "),p+=' <span class="',o.showPMFields||(p+="ws-hidden"),p+='"><component data-component="SBIS3.CONTROLS/Link" name="milestonesButton" class="edo-UserFolderDialog__alglink',o.showPMFields||(p+=" ws-hidden"),p+='"> <option name="caption">',o.descriptionMoved?p+=t(i(rk("вехи"))):p+=t(i(rk("вех"))),p+='</option> <option name="tabindex">0</option> </component></span>',o.showPMFields&&(p+=", "),p+=' <component data-component="SBIS3.CONTROLS/Link" name="rulesButton" class="edo-UserFolderDialog__alglink"> <option name="caption">',o.descriptionMoved?p+=t(i(rk("операций"))):p+=t(i(rk("операции"))),p+='</option> <option name="tabindex">0</option> </component> '+t(i(rk("или")))+' <component data-component="SBIS3.CONTROLS/Link" name="stagesButton" class="edo-UserFolderDialog__alglink"> <option name="caption">'+t(i(rk("этапов обработки")))+'</option> <option name="tabindex">0</option> </component> </div> </div> </div> '),p+=" </div>",(p=t(p))+(a&&-1!==p.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.UserFolderDialog"}},o});
define('js!SBIS3.EDO.UserFolderHandlers',['WS.Data/Source/SbisService','WS.Data/Entity/Record','Core/ExtensionsManager','Core/EventBus','Core/Context','Core/Deferred','i18n!SBIS3.EDO.UserFolderHandlers','Elektronnyj_dokumentooborot_localization'],function(e,a,n,r,t,o){'use strict';var d,i=rk('Папка с таким именем уже существует'),l=rk('Данное название для папки недопустимо');return d={folderCreateDialog:function(e,a,r){var d=new o(),i=void 0==r?new t():r.getLinkedContext(),l=e||{},c=e.left,s=e.top;if(void 0!=a)i.setValue('Раздел',a);return l.advanced=void 0==l.advanced?false:l.advanced,l.useOwnDataMethods=void 0==l.useOwnDataMethods?true:l.useOwnDataMethods,l.showPMFields=n.checkExtensions(['УПРАВЛЕНИЕ_ПРОЕКТАМИ'])['УПРАВЛЕНИЕ_ПРОЕКТАМИ'],d;},folderEditDialog:function(e,a,r,t){var d=new o(),i=t?t.getLinkedContext():null,l=a||{},c=a.left,s=a.top;if(i)i.setValue('Раздел',r);return l.advanced=void 0==l.advanced?false:l.advanced,l.useOwnDataMethods=void 0==l.useOwnDataMethods?true:l.useOwnDataMethods,l.rec=e,l.showPMFields=n.checkExtensions(['УПРАВЛЕНИЕ_ПРОЕКТАМИ'])['УПРАВЛЕНИЕ_ПРОЕКТАМИ'],require(['Deprecated/Controls/DialogRecord/DialogRecord'],function(a){new a({template:'js!SBIS3.EDO.UserFolderDialog',record:e,resizable:false,left:c,top:s,componentOptions:l,handlers:{onAfterClose:function(e,a){if(a)d.callback(a);}}});}),d;},editFolder:function(n,t,d){var c=new o();if('На контроле'==t||'От меня'==t||'Мои задания'==t)return c.errback(new Error(l)),c;var s=new a({rawData:{_type:'record',d:[n,t,d],s:[{n:'@ПапкаДокументов',t:'Число целое'},{n:'Название',t:'Строка'},{n:'Условие',t:'Строка'}]},adapter:'adapter.sbis'});return new e({endpoint:'ПапкаДокументов'}).call('Записать',{'Запись':s}).addCallback(function(e){if(c.callback(),e.getRawData())r.channel('EdoPartialReloader').notify('onEditFolder',{key:e.getRawData(),name:t,condition:d});}).addErrback(function(e){var a=e.message;if(-1!==a.indexOf('одинаковых'))a=i;c.errback(new Error(a));}),c;},createFolder:function(a,n,t,d){var c=new o();return new e({endpoint:'ПапкаДокументов'}).call('ДобавитьППапкуРаспределенияВКорень',{'Название':a,'Раздел':t,'Служебная':null,'АлгоритмыРаспределения':n||'','СЧужимиПапками':true,'ИмяКорневойПапки':d||null}).addCallback(function(e){if(e&&e.getRawData&&-1==e.getRawData())c.errback(new Error(i));else if(e&&e.getRawData&&-2==e.getRawData())c.errback(new Error(l));else if(c.callback(),e)r.channel('EdoPartialReloader').notify('onCreateFolder',{key:e,parent:t});}).addErrback(function(e){c.errback(e);}),c;}};});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.UserFolderDialog", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-UserFolderDialog{padding-left:16px;padding-right:16px}.ws-window-title{font-weight:700;font-style:normal;font-size:18px}.edo-priority_group{display:flex;justify-content:space-around}.edo-UserFolderDialog__windowtitle{font-weight:700;font-style:normal;font-size:18px}.edo-UserFolderDialog__desctext{font-size:14px;display:inline-block;word-wrap:break-word}.edo-UserFolderDialog__desctext_right{float:right}.edo-UserFolderDialog__alglink{font-size:14px;display:inline-block;min-height:14px;height:14px;line-height:normal;overflow:visible}.edo-UserFolderDialog__alglink .ws-link-body{overflow:visible;line-height:normal}.edo-UserFolderDialog__alglink .ws-button-caption{line-height:normal}.edo-UserFolderDialog__alg_areas{margin-bottom:8px}.edo-UserFolderDialog__area_title{font-weight:400;font-style:normal;font-size:14px;color:#999;text-align:left;line-height:normal}.edo-UserFolderDialog__bottomarea_title{font-size:14px;margin-bottom:7px}.edo-UserFolderDialog__saveButton{width:100px;vertical-align:top;display:inline-block;position:absolute;right:40px;top:8px}.edo-UserFolderDialog__title_block{width:428px;margin-bottom:11px;float:left}"));head.appendChild(style);});}
define('js!SBIS3.EDO.UserFolderDialog',['WS.Data/Source/SbisService','Core/helpers/collection-helpers','Core/ExtensionsManager','Core/Context','SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.UserFolderDialog','js!SBIS3.EDO.UserFolderHandlers','SBIS3.CONTROLS/Utils/InformationPopupManager','Lib/Control/Infobox/Infobox','optional!js!SBIS3.EDO2.RuleChoice','tmpl!SBIS3.EDO.BaseFiltersStyles/footerTpl','css!SBIS3.EDO.UserFolderDialog','SBIS3.CONTROLS/Button','SBIS3.CONTROLS/TextBox','SBIS3.CONTROLS/Link','SBIS3.CONTROLS/FieldLink','SBIS3.CONTROLS/Utils/ControlsValidators','SBIS3.CONTROLS/Radio/Group','i18n!SBIS3.EDO.UserFolderDialog','Elektronnyj_dokumentooborot_localization'],function(e,t,o,s,i,n,r,l,a,d){'use strict';var c=i.extend({_dotTplFn:n,$protected:{warnOnSimilarFolders:false,_options:{caption:rk('Папка'),advanced:false,rootFolderName:'Мои задания',descriptionMoved:false,descWhenClear:rk('Можно настроить автоматическое перемещение в эту папку заданий')+' ',descWhenSet:rk('Можно настроить перемещение заданий других')+' ',useOwnDataMethods:true,showPMFields:o.checkExtensions(['УПРАВЛЕНИЕ_ПРОЕКТАМИ'])['УПРАВЛЕНИЕ_ПРОЕКТАМИ']}},$constructor:function(e){this.rec=e.rec||e.record;},init:function(){c.superclass.init.call(this);var o=this,i=o._options.record||o.rec,n=this.getLinkedContext(),d=n.getValue('Условие')||(!!this.rec?this.rec.get('Условие'):null);if(this.rec)n.setValue('Название',this.rec.get('Название'));if(!!d&&d.length>0)try{if(d=JSON.parse(d),void 0!=d['Проекты'])if(d['Проекты'].length>0)this.getChildControlByName('projectsField').setSelectedKeys(this.toItemsPresetDict(d['Проекты'],'@Документ','Название')),this._options.showProjectsInput=true;if(void 0!=d['Вехи'])if(d['Вехи'].length>0)this.getChildControlByName('milestonesField').setSelectedKeys(this.toItemsPresetDict(d['Вехи'],'@Документ','ДокументРасширение.Название')),this._options.showMilestonesInput=true;if(void 0!=d['Регламенты'])if(d['Регламенты'].length>0)this.getChildControlByName('rulesField').setSelectedKeys(this.toItemsPresetDict(d['Регламенты'],'Идентификатор','Название')),this._options.showRulesInput=true;if(void 0!=d['Этапы'])if(d['Этапы'].length>0)n.setValue('stagesField',d['Этапы'][0]),this._options.showStagesInput=true;if(void 0!=d['Приоритет'])this.getChildControlByName('priorityGroup').setSelectedKey(d['Приоритет']);this._options.descText=this._options.descWhenSet,this.descriptionMoved=true;}catch(e){l.showMessageDialog({message:'Не удалось разобрать JSON условия!',status:'error'});}else this._options.descText=this._options.descWhenClear,this.descriptionMoved=false;if(o._options.advanced)o.getChildControlByName('infoPriority').subscribe('onActivated',function(){a.show({control:this.getContainer(),message:rk('Если будет найдена папка с пересекающимся \n условием, то будет выбрана та, у которой \n больший приоритет.'),position:'tr',hideDelay:4000});});var u=o._options.advanced?o.getChildControlByName('projectsField'):void 0,h=void 0,g=void 0!=(n=o.getLinkedContext()).getValue('Раздел')?n.getValue('Раздел'):o._options.parentFolder;if(!!g&&g.length>0)g=g.split(',')[0];try{h=i.get('@СвязьПапок').split(',')[0];}catch(e){}if(!h)try{h=i.getKey();}catch(e){}if(o.getChildControlByName('saveButton').subscribe('onActivated',function(i,a){if(!o.validate())return void o.getChildControlByName('Название').setActive(true);if(o._options.advanced){var d={},c,u=[];if(c=[],!!o.getChildControlByName('projectsField').getSelectedItems())o.getChildControlByName('projectsField').getSelectedItems().each(function(e){c.push([e.get('@Документ'),e.get('ДокументРасширение.Название')]);});if(void 0!=c)if(c.length>0)d['Проекты']=c,u.push('("Проекты":\\[(d+,)*('+d['Проекты'].join('|')+')(,d+)*\\])');if(c=[],!!o.getChildControlByName('milestonesField').getSelectedItems())o.getChildControlByName('milestonesField').getSelectedItems().each(function(e){c.push([e.get('@Документ'),e.get('ДокументРасширение.Название')]);});if(void 0!=c)if(c.length>0)d['Вехи']=c,u.push('("Вехи":\\[("d+",)*('+t.map(d['Вехи'],function e(t){return'("'+t+'")';}).join('|')+')(,"d+")*\\])');if(c=[],!!o.getChildControlByName('rulesField').getSelectedItems())o.getChildControlByName('rulesField').getSelectedItems().each(function(e){c.push([e.get('Идентификатор'),e.get('Название')]);});if(void 0!=c)if(c.length>0)d['Регламенты']=c,u.push('("Регламенты":\\[(d+,)*('+d['Регламенты'].join('|')+')(,d+)*\\])');if(c=o.getChildControlByName('stagesField').getText(),void 0!=c)if(c.length>0)d['Этапы']=[c],u.push('("Этапы":\\[("d+",)*('+t.map(d['Этапы'],function e(t){return'("'+t+'")';}).join('|')+')(,"d+")*\\])');if(d['Проекты']||d['Этапы']||d['Вехи']||d['Регламенты'])d['Приоритет']=o.getChildControlByName('priorityGroup').getSelectedKey();if(o.warnOnSimilarFolders)try{if(u.length>0)new e({endpoint:'ПапкаДокументов'}).call('КоличествоПохожихППапок',{'Условия':u.join('|'),'Лицо':s.global.getValue('myuserid'),'Папка':h}).addCallback(function(e){if(e>0)l.showMessageDialog({message:rk('Существуют другие папки')+' ('+e+') '+rk('с похожим алгоритмом! Новые документы могут быть распределены в них.'),status:'error'});});}catch(e){}d=Object.keys(d).length>0?JSON.stringify(d):null,n.setValue('Условие',d);}if(o._options.useOwnDataMethods)if(i.setResult(false),void 0!=h)r.editFolder(h,o.getChildControlByName('Название').getText('Название'),n.getValue('Условие')).addCallback(function(e){o.sendCommand('close',true),o.sendCommand('save');}).addErrback(function(e){l.showMessageDialog({message:e.message||e.details,status:'error'}),o.getChildControlByName('Название').markControl();});else r.createFolder(o.getChildControlByName('Название').getText('Название'),n.getValue('Условие'),g,o._options.rootFolderName).addCallback(function(e){o.sendCommand('save'),o.sendCommand('close',true);}).addErrback(function(e){l.showMessageDialog({message:e.message||e.details,status:'error'}),o.getChildControlByName('Название').markControl();});else o.sendCommand('save',{close:true});}),!o._options.advanced)return;if(o.rButton=o.getChildControlByName('rulesButton'),o.sButton=o.getChildControlByName('stagesButton'),o._options.showPMFields)o.pButton=o._options.showPMFields?o.getChildControlByName('projectsButton'):null,o.mButton=o._options.showPMFields?o.getChildControlByName('milestonesButton'):null,o.pButton.subscribe('onActivated',function(e,t){o.showAlgArea('projects',false,o.pButton,o.mButton,o.rButton,o.sButton,o.tButton),o.getChildControlByName('projectsField').sendCommand('showSelector');}),o.mButton.subscribe('onActivated',function(e,t){o.showAlgArea('milestones',false,o.pButton,o.mButton,o.rButton,o.sButton,o.tButton),o.getChildControlByName('milestonesField').sendCommand('showSelector');});o.rButton.subscribe('onActivated',function(e,t){o.showAlgArea('rules',false,o.pButton,o.mButton,o.rButton,o.sButton,o.tButton),o.getChildControlByName('rulesField').showSelector();}),o.sButton.subscribe('onActivated',function(e,t){o.showAlgArea('stages',true,o.pButton,o.mButton,o.rButton,o.sButton,o.tButton);});},toItemsPresetDict:function(e,t,o){var s=[];if(Array.isArray(e))e.forEach(function(e,i,n){if(Array.isArray(e)&&2==e.length){var r={};r[t]=e[0],r[o]=e[1],s.push(e[0]);}});return s;},showAlgArea:function(e,t,o,s,i,n,r){var l=this,a=$('#'+e+'Area'),d=$('#priorityArea');if(a.removeClass('ws-hidden'),d.removeClass('ws-hidden'),t)this.getChildControlByName(e+'Field').setActive(t);if(!l.descriptionMoved){if($('#descriptionBottom').addClass('edo-UserFolderDialog__desctext_right'),$('#descriptionBottomText').text(rk('Можно настроить перемещение заданий других')+' '),$('#fieldsHeader').removeClass('ws-hidden'),l.descriptionMoved=true,o)o.setCaption(rk('проектов'));if(s)s.setCaption(rk('вех'));i.setCaption(rk('операций'));}this._notifyOnSizeChanged();},_modifyOptions:function(e){return e.showPMFields=o.checkExtensions(['УПРАВЛЕНИЕ_ПРОЕКТАМИ'])['УПРАВЛЕНИЕ_ПРОЕКТАМИ'],e.RulesSelectorTemplate=!!d?'SBIS3.EDO2.RuleChoice':'',e;}});return c.dimensions={width:'460'},c;});
define("html!SBIS3.EDO.UserTasks",function(){var o=function(o){var e=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(e){for(;o.test(e);)e=e.replace(o,"&#123;&#123;$1&#125;&#125;");return e}}(),n=function(o){return o.join?o.join(""):o.toString()},t=function(o){return void 0===o?"":o&&"object"==typeof o?n(o):""+o},i="undefined"!=typeof process,r=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="edo-UserTasks__wrapper"> <component data-component="SBIS3.EDO.TaskSelect" name="UserTasks"> <option name="showAllTask">false</option> <option name="showTaskButton">true</option> <option name="allowEditTasks">true</option> <option name="useScope">true</option> <option name="listMethodByScope">СлужЗап.СписокВнутренних</option> <option name="userFaceId" bind="ЛицоСотрудника"></option> <option name="userSName" bind="ЧастноеЛицо.Фамилия"></option> <option name="userName" bind="ЧастноеЛицо.Имя"></option> <option name="userPatr" bind="ЧастноеЛицо.Отчество"></option> <option name="myTaskHistoryId">MyTaskOnUserCard</option> <option name="infiniteScrollContainer">.staff-CardEmployee</option> <option name="hideOperationMove" value="true"></option> <option name="transfer_faceField">'+e(t(o.transfer_faceField))+"</option> </component> </div>");return(r=e(r))+(i&&-1!==r.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.UserTasks"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.UserTasks", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".ws-UserTasks__MoiDokumenty{position:relative;margin:10px 0 20px 0;padding-bottom:20px}.ws-UserTasks__PanelSFiltrom{height:32px;text-align:right;width:360px;float:right}.ws-Reestr-Moi__ObschijPoiskZadachi{position:absolute;top:8px;left:8px}.User_task_taskTransfer{top:8px}.ws-Reestr-Moi__ObschijPoiskZadachi .ELO-Search__Button__userSearch.ELO-Search__Button.ws-button-link{width:220px!important;margin-right:16px}.ws-Reestr-Moi__ObschijPoiskZadachi.ELO-Search .ELO-Search__clearSearch{left:180px!important}.edo-UserTasks__wrapper{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-moz-flex-direction:column;-ms-flex-direction:column;flex-direction:column;height:100%;position:relative}"));head.appendChild(style);});}
define('js!SBIS3.EDO.UserTasks',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.UserTasks','css!SBIS3.EDO.UserTasks','js!SBIS3.EDO.TaskSelect','Elektronnyj_dokumentooborot_localization'],function(s,t){'use strict';var e=s.extend({_dotTplFn:t,$protected:{_options:{userFaceId:0}},$constructor:function(){},init:function(){e.superclass.init.call(this);}});return e;});
define("html!SBIS3.EDO.CD.Notification",function(){var i=function(i){var t=function(){var i={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},t=/&(?!#?\w+;)|<|>|"|'|\//g;return function(n){return n?n.toString().replace(t,function(t){return i[t]||t}):n}}(),n=function(){var i=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;i.test(t);)t=t.replace(i,"&#123;&#123;$1&#125;&#125;");return t}}(),o=function(i){return i.join?i.join(""):i.toString()},e=function(i){return void 0===i?"":i&&"object"==typeof i?o(i):""+i},s="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="sdNotification__container"> <div class="sdNotification sdNotification__'+n(e(t(i.style))));!0===i.short&&(a+=" sdNotification__short-size"),a+='"> <div class="sdNotification__color-header"></div> <div class="sdNotification__title"> <div class="sdNotification__title-icon icon-24 ',"success"===i.style?a+=" icon-Yes icon-done ":(a+=" ","error"===i.style?a+=" icon-Alert icon-error ":a+=" icon-Refresh icon-primary ",a+=" "),a+='"></div> <div class="sdNotification__title-text">'+n(e(t(i.title)))+'</div> <component data-component="SBIS3.CONTROLS/Button" name="CancelButton" class="sdNotification__cancel-btn"> <option name="caption">Отменить</option> <options name="handlers"> <option name="onActivated" type="function">js!SBIS3.EDO.CD.Notification:prototype._onCancelButtonClick</option> </options> <option name="visible" type="boolean" value="'+n(e(t(!!i.cancellable)))+'"></option> </component> </div> <div class="sdNotification__body',i.message.length||(a+=" ws-hidden"),i.isCenterAlign&&(a+=" sdNotification__body-center"),a+='"> ';var c=i.message;if(c)for(var r,d=-1,l=c.length-1;d<l;)a+=' <span class="sdNotification__message-item ',(r=c[d+=1]).isDynamic&&(a+=" sdNotification__message-item_dynamic"),a+=" ",r.isLink&&(a+=" sdNotification__message-item_link"),a+=" ",r.addCalss&&(a+=" "+n(e(t(r.addCalss)))+" "),a+=' " title="'+n(e(t(r.text)))+'"> ',r.isLink?a+=' <span class="asLink" data-id="'+n(e(t(r.id)))+'" data-value="'+n(e(t(r.value)))+'">'+n(e(t(r.text)))+"</span> ":a+=" "+n(e(t(r.text)))+" ",a+=" </span> ";return a+=" </div> </div> </div>",(a=n(a))+(s&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return i.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.CD.Notification"}},i});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.CD.Notification", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".cd-notifications{position:fixed;bottom:0;right:35px;z-index:1040}.cd-notification{min-width:200px;max-width:400px;border:2px solid #e4e4e4;border-radius:6px;margin-top:8px;display:inline-block;text-align:left;cursor:pointer}.sdNotification{margin-bottom:16px;border-bottom:#ccc 1px solid;border-left:#ccc 1px solid;border-right:#ccc 1px solid}.sdNotification__short-size{width:262px!important}.sdNotification{width:388px}.sdNotification__color-header{height:3px}.sdNotification__title{background-color:#fff}.sdNotification__success .sdNotification__color-header{background-color:#7acb49}.sdNotification__error .sdNotification__color-header{background-color:#ef463a}.sdNotification__progress .sdNotification__color-header{background-color:#313e78}.sdNotification__title-icon{float:left;margin:10px 8px 8px 8px}.sdNotification__title{height:48px}.sdNotification__title-text{display:inline-block;line-height:48px;font-size:15px;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;max-width:85%}.sdNotification__body{background-color:#f4f4f4;font-size:12px;color:#999;padding:8px}.sdNotification__body-center{text-align:center}.sdNotification__message-item{display:inline-block;overflow:hidden}.sdNotification__message-item_dynamic{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.sdNotification__first-item{max-width:65%}.sdNotification__second-item{max-width:100%}.sdNotification__cancel-btn{float:right;margin-top:12px;margin-right:8px}.commonDocs-notification__footer{min-height:32px;background:#f3f3f3;padding:8px;max-width:388px;box-sizing:border-box}.commonDocs-notification__footer-text{background:#f3f3f3;font-size:12px;color:#999;max-width:388px;overflow:hidden}"));head.appendChild(style);});}
define('js!SBIS3.EDO.CD.Notification',['Core/helpers/collection-helpers','Core/WindowManager','SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.CD.Notification','css!SBIS3.EDO.CD.Notification','SBIS3.CONTROLS/Button','SbisDiskBase_localization'],function(t,e,i,s){'use strict';var n=null,o=[],l=i.extend({$protected:{_options:{title:'',message:'',style:'success',timeout:10000},_isMouseOver:false,_isTimeoutOver:false,_isCancelled:false,_isClicked:false,_timeout:null},_dotTplFn:s,$constructor:function(){this._publish('onCancel','onMessageClick');},init:function(){l.superclass.init.call(this);var t=this;if(this.getContainer().on({'mouseover.notification':function(){t._isMouseOver=true;},'mouseleave.notification':function(){t._isMouseOver=false,t._tryClose();}}),this._options.timeout>0)this._timeout=setTimeout(function(){t._isTimeoutOver=true,t._tryClose();},this._options.timeout);this.subscribeTo(this,'onClick',this._onClick);},destroy:function(){l.superclass.destroy.call(this),clearTimeout(this._timeout),this.getContainer().off('.notification');var t=o.length;while(t--)if(o[t]===this){o.splice(t,1);break;}},_tryClose:function(){if(this._isCancelled||this._isClicked||this._isTimeoutOver&&!this._isMouseOver)this._close();},_close:function(){if(this._isCancelled)this.hide(),this._notify('onCancel');this.destroy();},_onCancelButtonClick:function(){var t=this.getParent();t._isCancelled=true,t._tryClose();},_onClick:function(t,e){var i=e.target;if(this._isClicked=true,i&&'SPAN'===i.nodeName&&'asLink'===i.classList[0])this._notify('onMessageClick',i.getAttribute('data-id'),i.getAttribute('data-value'));if('sdNotification__body'===i.classList[0]||'sdNotification__body'===i.parentNode.classList[0])return;this._tryClose();}});return l.show=function i(s,a,r){if(2===arguments.length)r=a,a=null;if(!a)a=[];else if(a instanceof l.Message)a=a.value();else if(!(a instanceof Array))a=new l.Message(a).value();if(r=r||{},!n)n=$('<div class="cd-notifications"></div>'),$(document.body).append(n);var u=0;t.forEach(a,function(t){if(t.isDynamic)if(u++,1==u)t.addCalss='sdNotification__first-item';else if(2==u)t.addCalss='sdNotification__second-item';});var c={title:s,message:a,isCenterAlign:u>1||true===r.isCenterAlign,cancellable:false!==r.cancellable,element:$('<div></div>').prependTo(n),handlers:r.handlers};if(null!=r.timeout)c.timeout=r.timeout;if(null!=r.style)c.style='success'===r.style||'error'===r.style||'info'===r.style?r.style:'success';if(r.opener)c.opener=r.opener;if(null===r.short||void 0===r.short)c.short=s&&(s.length<17&&c.cancellable||s.length<29&&!c.cancellable);else c.short=false!==r.short;n.css('z-index',e.getMaxZIndex()+5);var f=new l(c);return o.push(f),f.getId();},l.close=function t(e){for(var i=0,s=o.length;i<s;i++)if(o[i].getId()===e)return void o[i].destroy();},l.closeAll=function t(){var e=o.length;while(e--)if(null!=o[e])o[e].destroy();o.length=0;},l.Message=function(){function t(t){if(this._value=[],t)this.addText(t);}return t.prototype.addText=function(t){return this._value.push({text:String(t)}),this;},t.prototype.addDynamicText=function(t){return this._value.push({text:t,isDynamic:true}),this;},t.prototype.addLink=function(t,e,i){return this._value.push({text:t,isLink:true,id:e,value:i}),this;},t.prototype.addDynamicLink=function(t,e,i){return this._value.push({text:t,isDynamic:true,isLink:true,id:e,value:i}),this;},t.prototype.value=function(){return this._value;},t;}(),l;});
define('js!SBIS3.EDO.CD.DiskOperations',['Transport/BLObject','Core/helpers/string-helpers','Core/helpers/fast-control-helpers','Core/helpers/collection-helpers','Core/EventBus','Core/Deferred','WS.Data/Entity/Record','js!SBIS3.EDO.CD.CommonDocsHelpers','js!SBIS3.EDO.CD.Notification','js!SBIS3.BL.FileSD','js!SBIS3.BL.FileSD.CancellableOperations','SbisDiskBase_localization'],function(e,t,n,o,i,a,r,l,s,c,f){'use strict';function d(e){return!!e.get('folder@');}function u(e,t){if(e instanceof Array)return o.filter(e,function(e){return void 0===e.get('Deleted')||e.get('Deleted')==!!t;});else if(e.get)if(void 0===e.get('Deleted')||e.get('Deleted')==!!t)return[e];else return[];return e;}function g(e){n.alert(e&&e.details?e.details:e);}function m(){}function k(e,t){var n=l.getFileUrl(e,t);l.downloadFiles([n],t?'/disksharedrest/download':null);}function p(e){if(e instanceof Array&&1==e.length&&e[0].get)return e[0].get('title')||e[0].get('Name');if(e.get)return e.get('title')||e.get('Name');else if(e&&e.name)return e.name;return;}function v(e){var t;if(e instanceof Array)t=o.map(e,function(e){return e.get('attachId');});else if(e.get)t=[e.get('attachId')];else t=[String(e)];return t;}function O(e,t){var n={},o=e instanceof Array&&1===e.length?e[0]:e;if(o.get)n.name=o.get('Name'),n.fileId=!d(o)&&o.get(t||'attachId');return n;}function D(e,t,n,r){var l=new a(),f={};if(false!==r)e=u(e,false);if(e instanceof Array){if(!e.length)return l;f=o.reduce(e,function(e,t){return e[t.get('attachId')]={name:t.get('title')||t.get('Name'),isFolder:d(t)},e;},{});}else if(e.get)f[e.get('attachId')]={name:e.get('title')||e.get('Name'),isFolder:d(e)};else if('object'===typeof e)f[e.Id]={name:e.name};else f[String(e)]={};n=n||{},requirejs(['js!SBIS3.EDO.CD.SaveToSbisDisk'],function(e){var n=o.map(f,function(e,t){return t;});e.show(n,t).addCallback(m);});function m(e){var a=o.filter(e,function(e){return null===e.error;});if(!a.length)return void l.callback({success:false,result:e});var r=o.map(a,function(e){return e.newObjectId;}),d=a[0],u=f[d.id],m=u.name,k=!u.isFolder&&d.newObjectId,p={folderName:d.destinationFolderName,folderId:d.destinationFolderId,folderRoot:d.destinationFolderRoot,originFileId:k},v=(d.isLink?n.titleLink:d.isSwap?n.titleSwap:n.titleCopy)||rk('Скопировано'),O=n.message||(d.isLink?h.getCreateLinkResult(r.length,m,k,p):d.isSwap?h.getSwapResult(r.length,m,k,p):h.getCopyResult(r.length,m,k,p));s.show(v,O,{opener:t.opener,handlers:{onCancel:D,onMessageClick:C}});function D(){if(d.isSwap){var e=o.map(a,function(e){return{Id:e.newObjectId,SourceId:e.id};});c.UndoTakeAwayHardLink(e).addCallbacks(function(t){N(t),i.channel('SbisDiskEvents').notify('onCancelOperation',{operationName:'TakeAwayHardLink',cancelMethod:'UndoTakeAwayHardLink',ids:e});},g);}else c.Delete(r).addCallbacks(function(e){N(e),i.channel('SbisDiskEvents').notify('onCancelOperation',{operationName:'Copy',cancelMethod:'Delete',ids:r});},g);}l.callback({success:true,result:e});}return l;}var h={getObjectName:function(e){return e.get('Name');},getCopyResult:function(e,n,o,i){var a=new s.Message();if(1===e&&n){if(o)a.addDynamicLink(n,'file',o);else a.addDynamicText(n);a.addText(' '+rk('скопирован в')+' ');}else a.addText(e+l.getPluralForm(e,' '+rk('объект скопирован'),' '+rk('объекта скопированы'),' '+rk('объектов скопированы'))+' '+rk('в'));return a.addDynamicLink(i.folderName,'folder',t.escapeHtml(JSON.stringify(i))),a.value();},getCreateLinkResult:function(e,t,n,o){var i=new s.Message();if(1===e&&t)if(i.addText(rk('Ссылка на')+' '),n)i.addDynamicLink(t,'file',n);else i.addDynamicText(t);else i.addText(rk('Ссылки на')+' '),i.addText(e+l.getPluralForm(e,' '+rk('объект'),' '+rk('объекта'),' '+rk('объектов')));return i.addText(' '+rk('в','папке')+' '),i.addDynamicText('"'+o.folderName+'"'),i.value();},getSwapResult:function(e,t,n,o){var i=new s.Message();if(1===e&&t){if(n)i.addDynamicLink(t,'file',n);else i.addDynamicText(t);i.addText(' '+rk('помещен'));}else i.addText(e+l.getPluralForm(e,' '+rk('объект'),' '+rk('объекта'),' '+rk('объектов'))),i.addText(' '+rk('помещены'));return i.addText(' '+rk('в','папке')+' '),i.addDynamicText('"'+o.folderName+'"'),i.value();},getRecoverTitle:function(){return rk('Восстановлено');},getRecoverResult:function(e,n,o,i){var a=new s.Message();if(1===e&&n){if(o)a.addDynamicLink(n,'file',o);else a.addDynamicText('"'+n+'"');a.addText(' '+rk('восстановлен'));}else a.addText(e+l.getPluralForm(e,' '+rk('объект восстановлен'),' '+rk('объекта восстановлено'),' '+rk('объектов восстановлено')));if(i&&i.folderName)a.addText(' '+rk('в','папке')+' '),a.addDynamicLink(i.folderName,'folder',t.escapeHtml(JSON.stringify(i)));return a.value();},getDeletionTitle:function(){return rk('Удалено');},getDeletionResult:function(e,t){if(1===e&&t)return new s.Message().addDynamicText(t).addText(' '+rk('был удалён')).value();return new s.Message(e+l.getPluralForm(e,' '+rk('объект был удалён'),' '+rk('объекта были удалены'),' '+rk('объектов были удалены'))).value();},getMoveTitle:function(){return rk('Перемещено');},getMoveResult:function(e,n,o,i,a){var r=new s.Message();if(1===e&&n){if(o)r.addDynamicLink(n,'file',o);else r.addDynamicText(n);r.addText(' '+rk('перемещён в')+' ');}else r.addText(e+l.getPluralForm(e,' '+rk('объект перемещён'),' '+rk('объекта перемещены'),' '+rk('объектов перемещены'))+' '+rk('в','папке'));if(a)r.addDynamicLink(i.folderName,'folder',t.escapeHtml(JSON.stringify(i)));else r.addDynamicText(i.folderName);return r.value();}};function R(e,t){var n=e.get('КолСОшибками'),o=e.get('КолУспешно');if(n>0)l.showErrorNotification(rk('Не удалось выполнить операцию'),e.get('ТекстОшибки'));if(o>0&&t)t(o);}function N(e,t){var n=0,i=0,a='';if(o.forEach(e.getRecords(),function(e){if(null!==e.get('ErrorCode'))n++,a=e.get('ErrorMsg');else i++;}),n>0)l.showErrorNotification(rk('Не удалось выполнить операцию'),a);if(i>0&&t)t(i);}function C(e,t,n){var o={};if('file'===t)w.openDocument(n);else if('folder'===t)o=JSON.parse(n),w.openFolder({openInFullInterface:true,folderId:o.folderId,rootName:o.folderRoot,folderIsDeleted:false,fileId:o.originFileId});}function b(){s.close(this);}function y(e){var t=false;if(e instanceof Array)t=o.reduce(e,function(e,t){return t.get('OppositeFileParentDeleted')?true:e;},t);else if(e.get)t=e.get('OppositeFileParentDeleted');return t;}var w={isCommonDocs:function(){return this.inCommonDocs;},isMyDocs:function(){return this.inMyDocs;},getCurrentRootName:function(){return w.isCommonDocs()?l.ROOT_FOLDER_COMMON:l.ROOT_FOLDER_MY;},copyToCommonDocuments:function(e,t){var n=this,o=p(e);t=t||{};var i={title:o?rk('Сохранить')+' "'+o+'"':rk('Сохранить'),rootFolderId:l.ROOT_FOLDER_COMMON,opener:this};if(t.onlyLink)i.title=rk('В общие'),i.copyButton={visible:false},i.linkButton={caption:rk('Ссылку')},i.swapButton={visible:false};else if(t.onlySwap)i.title=o?rk('Сохранить')+' "'+o+'"':rk('Сохранить'),i.copyButton={visible:false},i.linkButton={visible:false},i.swapButton={visible:true};if(t.opener)i.opener=t.opener;return D(e,i,{titleCopy:rk('Скопировано в общие документы'),titleSwap:rk('Помещено в общие документы'),titleLink:rk('Создана ссылка в общих документах')});},copyToMyDocuments:function(e,t){var n=this,o=p(e);t=t||{};var i={title:rk('В мои'),rootFolderId:l.ROOT_FOLDER_MY,opener:this};if(t.onlyLink)i.copyButton={visible:false},i.linkButton={caption:rk('Ссылку')};else if(t.onlySwap)i.copyButton={visible:false},i.linkButton={visible:false},i.swapButton={visible:true};if(t.opener)i.opener=t.opener;return D(e,i,{titleCopy:rk('Скопировано в мои документы'),titleLink:rk('Создана ссылка в моих документах')});},copyObject:function(e){var t=p(e);D(e,{title:t?rk('Создать копию')+' "'+t+'"':rk('Создать копию'),copyButton:{caption:rk('Скопировать')},linkButton:{visible:false},opener:this},{},false);},restoreObjects:function(e,t){var o=new a();if(t=t||{},e=u(e,true),e instanceof Array&&!e.length)return new a().callback();var c=t.browser,d=e instanceof Array&&e.length>1,m=null,k={needResetDeletedFilter:true},p=new a();if(y(e))require(['js!SBIS3.EDO.CD.MoveDialog'],function(e){e.showForSelect(t.opener,{rootFolder:w.isCommonDocs()?l.ROOT_FOLDER_COMMON:l.ROOT_FOLDER_MY,handlers:{onAfterClose:function(e,t){if(t)if(t instanceof r){if(!t.get('folder'))k.folderName=l.getRootName(t.get('Name'));else k.folderName=t.get('Name');k.folderId=t.get('attachId'),k.folderRoot=w.isCommonDocs()?l.ROOT_FOLDER_COMMON:l.ROOT_FOLDER_MY,p.callback(k.folderId);}else k.folderName=l.getRootName(t),k.folderId=t,k.folderRoot=t,p.callback(t);}}});});else{if(e instanceof Array&&1===e.length){var D=e[0].get('OppositeFileParentName'),M=e[0].get('OppositeFileParentId');if(!D&&M)D=l.getRootName(M);k.folderName=D,k.folderId=M,k.folderRoot=w.isCommonDocs()?l.ROOT_FOLDER_COMMON:l.ROOT_FOLDER_MY;}p.callback(null);}return p.addCallback(function(a){if(d)m=s.show(rk('Восстановление')+'...',{cancellable:false,style:'info',timeout:100000});var r;if(!a)r=new f.Recover(v(e));else r=new f.RecoverInNewPlace(v(e),a);var l=r.exec();if(l.addCallbacks(u,p),d&&m)l.addBoth(b.bind(m));function c(){t&&t.callback&&t.callback();}function u(e){N(e,D),o.callback(e);}function p(e){n.alert(e&&e.details?e.details:e),o.errback(e);}function D(t){c(),k['forceSetRootName']=true;var n=O(e,'OppositeFileId'),o=h.getRecoverTitle(),i=h.getRecoverResult(t,n.name,n.fileId,k);s.show(o,i,{cancellable:false,handlers:{onCancel:y,onMessageClick:C}});}function y(){r.undo().addCallbacks(function(e){R(e,c),i.channel('SbisDiskEvents').notify('onCancelOperation',{operationName:'Recover',cancelMethod:'Delete'});},g);}}),o;},permanentlyDeleteObjects:function(e,t){var o=new a();if(t=t||{},e=u(e,true),e instanceof Array&&!e.length)return;var i=v(e);if(t.confirm){var r=rk('Вы действительно хотите навсегда удалить')+' '+(1===i.length?rk('текущую запись?'):rk('выбранные записи?'));n.question(r,{},t.opener).addCallback(function(e){if(e)f();else o.errback('cancel');});}else f();function f(){var e=i.length>1,t=null;if(e)t=s.show(rk('Окончательное удаление')+'...',{cancellable:false,style:'info',timeout:100000});var n=c.DeletePermanently(i);if(n.addCallbacks(d,g),n.addBoth(function(){o.callback();}),e&&t)n.addBoth(b.bind(t));}function d(e){N(e,m);}function m(e){var t=e+l.getPluralForm(e,' '+rk('объект удалён'),' '+rk('объекта удалены'),' '+rk('объектов удалены'))+' '+rk('навсегда');s.show(rk('Окончательно удалено'),t,{isCenterAlign:true,cancellable:false});}return o;},onFinishDeleteObjects:function(e,t,n){var o=1==e.length?e[0].get('Name'):null,a=h.getDeletionTitle(),r=h.getDeletionResult(e.length,o);s.show(a,r,{isCenterAlign:true,opener:t,handlers:{onCancel:l}});function l(){var t=v(e);c.Recover(t).addCallbacks(function(){i.channel('SbisDiskEvents').notify('onCancelOperation',{operationName:'Delete',cancelMethod:'Recover',ids:t}),n&&n();},g);}},onFinishMove:function(e,t,n,o){var a=O(e),r=h.getMoveTitle(),f=h.getMoveResult(e.length,a.name,null,{folderName:t.get('Name'),folderId:t.get('attachId'),folderRoot:w.isMyDocs()?l.ROOT_FOLDER_MY:l.ROOT_FOLDER_COMMON,originFileId:e&&e[0]&&e[0].get('attachId')},n);s.show(r,f,{opener:o,handlers:{onCancel:d,onMessageClick:C}});function d(){var t=v(e),n=e&&e[0]&&e[0].get('folder');if(n)c.Move(t,n).addCallbacks(function(){i.channel('SbisDiskEvents').notify('onCancelOperation',{operationName:'Move',cancelMethod:'Move',ids:t});},g);}},moveObjects:function(e,t){e=e&&(e instanceof Array?e:[e]),t=t||{};var n=new a();return require(['js!SBIS3.EDO.CD.MoveDialog'],function(o){o.show({opener:t.opener,rootFolder:t.rootFolder,InitialRootId:t.InitialRootId,objectName:t.objectName,withoutNotification:t.withoutNotification,records:e,handlers:{onAfterClose:function(e,t){n.callback(t);}}});}),n;},moveObjectWithOptions:function(t,n,o){if(t=u(t,false),t instanceof Array&&!t.length)return;var a=this,c=o.initialRoot||w.getCurrentRootName(),d=f.getCancellableMoveDataNew(t,c),m,k,p;if(n instanceof r){if(m=n.get('attachId'),k=n.get('Name'),k===l.ROOT_FOLDER_MY||k===l.ROOT_FOLDER_COMMON)k=l.getRootName(k);if(!m)m=o.initialRoot||w.getCurrentRootName(),k=l.getRootName(m);}else m=String(n),k=l.getRootName(m);if(p=new f.Move(d,m),'FileSD'!==o.objectName)p.operation=function(t,n){return new e(o.objectName).call('MoveExt',{Ids:t instanceof Array?t:[t],Parent:n},e.RETURN_TYPE_RECORDSET);};var v=t instanceof Array&&t.length>1,D=null;if(v)D=s.show(rk('Перемещение')+'...',{cancellable:false,style:'info',timeout:100000});var y=p.exec();if(y.addCallbacks(I,g),v&&D)y.addBoth(b.bind(D));function M(){o&&o.callback&&o.callback();}function I(e){N(e,S);}function S(e){M();var n={folderName:k,folderId:m,folderRoot:c},i=O(t),a=h.getMoveTitle(),r=h.getMoveResult(e,i.name,i.fileId,n,o.toAsLink);if(true!==o.withoutNotification)s.show(a,r,{opener:o.opener,handlers:{onCancel:F,onMessageClick:C}});}function F(){p.undo().addCallbacks(function(e){R(e,o&&o.cancellationCallback&&o.cancellationCallback),i.channel('SbisDiskEvents').notify('onCancelOperation',{operationName:'Move',cancelMethod:'Move'});},g);}},openFolder:function(e){if(false===e.hasRightsToFolder)return void l.showErrorNotification(rk('Ошибка перехода'),l.NOT_ACCESS_ERROR_MESSAGE);if(e.openFromLink){var t=window.open('about:blank','_blank');return void c.GetPublicAccessRight(e.fileId).addCallback(function(e){t.location.href=e.get('HRef');});}if(!e.navigationName&&e.rootName)e.navigationName=e.rootName==l.ROOT_FOLDER_COMMON||e.rootName==l.ROOT_FOLDER_COMMON_TRASH?'CommonDocs':'MyDocs';var n=e.openInFullInterface||e.rootName&&!w.isCommonDocs()&&!w.isMyDocs(),o={folderId:e.folderId,fileId:e.fileId,rootName:e.rootName,folderIsDeleted:e.folderIsDeleted||false,clearPath:true};if(n||e.openInCurrentPage){if(e.openedWindow&&e.openedWindow.sessionStorage)e.openedWindow.sessionStorage.setItem('SbisDiskOpenFolder',JSON.stringify(o));else if(window&&window.sessionStorage)window.sessionStorage.setItem('SbisDiskOpenFolder',JSON.stringify(o));l.isPersonalAccount().addCallback(function(t){var o=t?'/SbisDisk.html':'/disk.html';if(n)if(e.openedWindow)e.openedWindow.location.href=document.location.protocol+'//'+document.location.host+o+'?region_left='+e.navigationName+'#region_left='+e.navigationName;else window.open(document.location.protocol+'//'+document.location.host+o+'?region_left='+e.navigationName+'#region_left='+e.navigationName);else i.channel('navigation').once('onReady',function(t,n,i){if(i)i.activateElem({url:o,event:e.navigationName},true);});});}else if(e.openInCurrentPageWithoutReload)i.channel('SbisDiskEvents').notify('onOpenFolder',o);},openDocument:function(e,t){if(!t)t={_privateMegaFixOption:true,mainOptions:{objectName:'FileSD',serviceUrl:l.getDiskServiceURL(),useOnlyCtx:false,multiPage:false,isDisk:true,isOneRec:true},viewOptions:{justAttach:false,canEditFED:false},listOptions:{defaultRecordPK:e}};else t.listOptions.defaultRecordPK=e,t.viewOptions.justAttach=false,t.mainOptions.isOneRec=true;require(['js!SBIS3.DOCVIEW.Funcs'],function(e){e.openFullScreen({_options:t});});},downloadFolder:function(e){k(e);},downloadPublicFolder:function(e){k(e,true);},inMyDocs:false,inCommonDocs:false};return w;});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.CD.CommonDocsArea", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".cd-cdArea__search-cell{width:345px}.cd-cdArea__search-string{width:335px;margin-left:12px;margin-top:8px}.cd-cdArea__filter-cell{width:100%}.cd-cdArea__table{width:100%;display:table;table-layout:fixed}.cd-cdArea__tableRow{height:auto;display:table-row}.cd-cdArea__tableCell{display:table-cell;vertical-align:top}.cd-cdArea__head-container{width:100%;height:40px;z-index:1;padding-top:2px}.cd-cdArea__td-stiker-not-show{display:none}.cd-cdArea__td-stiker{width:27%;margin-left:-27%}.cd-cdArea__td-stiker-decoration{background-color:#f9f9f9;border-left:1px solid #d5d5cf;height:100%;float:left;box-sizing:border-box}.cd-cdArea__filter-controller{float:right;max-width:100%}.sbisDisk__qouta-container{float:right;height:16px;margin-right:8px;line-height:24px}.sbisDisk__qouta-container:hover>div{color:#313e78!important;cursor:pointer}.sbisDisk__qouta-container:hover>.sbisDisk__qouta-info{text-decoration:underline}.sbisDisk__qouta-icon{font-size:20px!important;float:left;padding-top:4px;width:24px}.sbisDisk__qouta-icon:hover{color:#313e78!important}.sbisDisk__qouta-info{float:left;color:#05b;font-size:14px}.sbisDisk__qouta-title{font-size:15px;font-family:TensorFontBold,TensorFont;font-weight:700;color:#313e78}.sbisDisk__quota-progressbar-container{width:234px;height:7px;margin-top:8px;background-color:#eaeaea;border-top:#dfdfdf 1px solid;display:inline-block}.sbisDisk__progressbar{height:7px;width:0;max-width:234px;background-color:#61b1ee}.cd-cdArea__td-stiker-height{height:1000px}.cd-cdArea__switchable-area{height:calc(100% - 40px);position:relative}.operations-panel-opened .cd-cdArea__switchable-area{height:calc(100% - 70px)}.cd-cdArea__switchable-area .ws-SwitchableArea__item{height:100%;position:relative}.cd-cdArea__main-content{height:100%;width:100%;float:left}.cd-cdArea__main-content.with-recent{margin-right:27%;width:73%}"));head.appendChild(style);});}
define("tmpl!SBIS3.EDO.CD.FolderStiker",["Core/tmpl/js/tclosure","js!SBIS3.DOCVIEW.List"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],i={};i["js!SBIS3.DOCVIEW.List"]=e[1];var r=function e(r,o,n,a,s){function l(){}var c=0,d=void 0!==t&&t?t:arguments[arguments.length-1];void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure"));var m={};s&&s.isSetts&&(m=s.fullContext||{});var p="string"==typeof n?n:"",g=void 0===i?void 0:i,v={id:[],def:void 0},u=d.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,r),h=this&&this.includedTemplates?this.includedTemplates:{},C=d.getMarkupGenerator(a);try{var S=C.joinElements([C.createTag("div",{class:"cd-FolderStiker"},[C.createTag("div",{class:"cd-FolderStiker__last-files-title"},[C.createTag("div",{class:"cd-FolderStiker__title"},[d.getter(r,["withFavorite"])?[C.createTag("div",{},[C.createText(""+global.rk("Избранные"))],{},v,this)]:[C.createTag("div",{},[C.createText(""+global.rk("Последние"))],{},v,this)]],{},v,this)],{},v,this),C.createControl("wsControl","ws:SBIS3.DOCVIEW.List",{viewOptions:{canEditFED:!1},listOptions:{visibilityMode:{defaultMode:"diskClassic",changedId:"recentId"},countDocWithoutScroll:0,autoQuery:!1,pageSize:40,previewWidth:110,previewHeight:110,multiselect:!1,itemsDragNDrop:d.getter(r,["withFavorite"]),hideBreadCrumbs:!0,wrapInScrollContainer:!0,columns:d.getter(r,["_columns"]),root:d.getter(r,["listRoot"]),groupBy:d.getter(r,["groupBy"]),serializedItems:d.getter(r,["recents"]),itemsSortMethod:null,infiniteScroll:!0},mainOptions:{userCommands:[{name:"deleteFromRecent",icon:"sprite:icon-16 icon-Erase icon-disabled",tooltip:global.rk("Удалить из списка"),caption:global.rk("Удалить из списка"),weight:230,inInline:!1,inList:!0,inMas:!1,typeCmd:"r",inDisk:!0,isMainAction:!1,cmdClass:"js!SBIS3.DOCVIEW.deleteFromRecent"},{isAvailable:d.getTypeFunc("js!SBIS3.EDO.CD.FolderStiker:prototype._isAvailableAddFavorite",{}),name:"addFavorites",icon:"sprite:icon-16 icon-Favourite icon-primary",tooltip:global.rk("Добавить в избранные"),caption:global.rk("Добавить в избранные"),weight:1,inInline:!1,inList:d.getter(r,["withFavorite"]),inMas:!1,typeCmd:"r",inDisk:!0,isMainAction:!0,cmdClass:"js!SBIS3.DOCVIEW.addFavorites"},{isAvailable:d.getTypeFunc("js!SBIS3.EDO.CD.FolderStiker:prototype._isAvailableRemoveFavorites",{}),name:"removeFavorites",icon:"sprite:icon-16 icon-Unfavourite icon-primary",tooltip:global.rk("Убрать из избранных"),caption:global.rk("Убрать из избранных"),weight:1,inInline:!1,inList:d.getter(r,["withFavorite"]),inMas:!1,typeCmd:"r",inDisk:!0,isMainAction:!0,cmdClass:"js!SBIS3.DOCVIEW.removeFavorites"}],objectName:"FileSD",serviceUrl:"/disk/api/v1/",serviceBLName:"СБИСДиск.Приватный",useOnlyCtx:d.getter(r,["useOnlyCtx"]),multiPage:!1,isDisk:!0,filter:void 0,commands:d.getter(r,["listCommands"]),modelAlias:d.getter(r,["modelAlias"])},name:"RecentFiles",className:"cd-FolderStiker__last-files docview-short-list docview-list_no-expand",_privateMegaFixOption:!0,esc:!1,bindings:[{fieldName:"recentRoot",propName:"listOptions/root",propPath:["root"],fullPropName:"listOptions/root",propPathStr:"root",oneWay:!0,direction:"fromContext",bindNonExistent:!0},{fieldName:"recentFilters",propName:"mainOptions/filter",propPath:["filter"],fullPropName:"mainOptions/filter",propPathStr:"filter",oneWay:!0,direction:"fromContext",bindNonExistent:!1},{fieldName:"recentCommands",propName:"mainOptions/commands",propPath:["commands"],fullPropName:"mainOptions/commands",propPathStr:"commands",oneWay:!0,direction:"fromContext",bindNonExistent:!0}]},{name:"RecentFiles",sbisname:"RecentFiles"},{data:r,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:u,internal:{__dirtyCheckingVars_7:d.getter(r,["withFavorite"]),__dirtyCheckingVars_10:d.getter(r,["_columns"]),__dirtyCheckingVars_11:d.getter(r,["groupBy"]),__dirtyCheckingVars_12:d.getter(r,["recents"]),__dirtyCheckingVars_27:d.getter(r,["withFavorite"]),__dirtyCheckingVars_35:d.getter(r,["withFavorite"]),__dirtyCheckingVars_39:d.getter(r,["useOnlyCtx"]),__dirtyCheckingVars_42:d.getter(r,["modelAlias"])}},n,g,h,d.config,m)],o,v,this)],p,v);v.def&&(S=C.chain(S,v,o),v=void 0)}catch(e){d.templateError("resources/SbisDiskDocuments/Base/PageComponent/RecentsPanel.tmpl",e,r)}return S||""};return r.includedFunctions={},r.stable=!0,r.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.CD.FolderStiker"}},r});
define("tmpl!SBIS3.EDO.CD.FolderStiker/templates/GroupRecentTemplate",["Core/tmpl/js/tclosure"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={},o=function e(o,l,n,i,a){function s(){}var c=0,u=void 0!==t&&t?t:arguments[arguments.length-1];void 0===u&&(eval("var thelpers = null;"),u=global.requirejs("View/Runner/tclosure"));var d={};a&&a.isSetts&&(d=a.fullContext||{});var p="string"==typeof n?n:"",m=void 0===r?void 0:r,v={id:[],def:void 0},f=u.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),S=this&&this.includedTemplates?this.includedTemplates:{},h=u.getMarkupGenerator(i);try{var g=h.joinElements([h.createTag("div",{class:"cd-FolderStiker__separator"},[],l,v,this)],p,v);v.def&&(g=h.chain(g,v,l),v=void 0)}catch(e){u.templateError("resources/SbisDiskDocuments/Base/PageComponent/templates/GroupRecentTemplate.tmpl",e,o)}return g||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.CD.FolderStiker/templates/GroupRecentTemplate"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.CD.FolderStiker", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".cd-FolderStiker{min-height:100%;height:100%;width:100%;position:relative}.cd-FolderStiker__title{font-size:15px;font-family:TensorFontBold,TensorFont;font-weight:700;color:#313e78;float:left;padding-left:8px}.cd-FolderStiker__last-files-title{padding-top:8px;height:27px}.cd-FolderStiker__last-files .controls-DataGridView__table tr:first-child .cd-FolderStiker__separator{display:none}.cd-FolderStiker__last-files .controls-DataGridView__table tr.controls-ListView__item-type-node+tr[data-group=\"@true\"] .cd-FolderStiker__separator{display:none}.cd-FolderStiker__last-files.docview-list{height:calc(100% - 35px)}.cd-FolderStiker__last-files .controls-ScrollContainer{height:100%}.cd-FolderStiker__last-files.docview-list .docview-list__container{overflow-y:hidden!important}.cd-FolderStiker__last-files .controls-ListView__item__selected.dv-classic-item,.cd-FolderStiker__last-files .controls-ListView__item__selected.dv-diskClassic-item{background-image:none!important}.cd-FolderStiker__last-files .dv-bigpreview-item.controls-ListView__item__multiSelected .dv-bigpreview-vis,.cd-FolderStiker__last-files .dv-bigpreview-item.controls-ListView__item__selected .dv-bigpreview-vis,.cd-FolderStiker__last-files .dv-bigpreview-item.controls-ListView__item__selected .dv-folder-background{outline:0}.cd-FolderStiker__last-files.docview-list_mode-bigpreview .controls-ListView{margin-left:12px;margin-right:12px;margin-bottom:24px;padding-bottom:40px;padding-top:12px}.cd-FolderStiker__last-files .controls-DataGridView.controls-DataGridView__hasSeparator .controls-DataGridView__table{border-width:0}.cd-FolderStiker__last-files .dv-diskClassic__title .signs-count{background:#f8f7ef}.cd-FolderStiker__separator{height:6px;margin-bottom:6px;border-bottom:1px solid #dfdfdf}.cd-FolderStiker__last-files .controls-DataGridView.controls-DataGridView__hasSeparator.controls-ListView__dataLoaded .controls-DataGridView__tr:nth-last-child(1) .controls-DataGridView__td{border-bottom:none}"));head.appendChild(style);});}
define('js!SBIS3.EDO.CD.FolderStiker',['Core/EventBus','Core/core-merge','SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.CD.FolderStiker','js!SBIS3.EDO.CD.CommonDocsHelpers','js!SBIS3.DOCVIEW.Funcs','js!SBIS3.DOCVIEW.List.DiskClassicColumns','tmpl!SBIS3.EDO.CD.FolderStiker/templates/GroupRecentTemplate','js!SBIS3.BL.FileSD','js!SBIS3.SBISDISK.FileSDService','Core/Serializer','js!SBIS3.DOCVIEW.SbisDiskModel','WS.Data/Di','css!SBIS3.EDO.CD.FolderStiker','js!SBIS3.DOCVIEW.List','SbisDiskDocuments_localization'],function(e,t,o,n,r,i,s,a,l,c,d,h,u){'use strict';var f='docview.sbisdisk.model',g=o.extend({_dotTplFn:n,$protected:{_windowHeight:null,_options:{autoHeight:true,recentVisible:true,withFavorite:false,useOnlyCtx:false,recents:null,modelAlias:f,_columns:s.getColumns(['title']),groupRecentTemplate:a,groupBy:{}}},_cacheElements:function(){this.controls={recentFiles:this.getChildControlByName('RecentFiles')},this.controls.recentBrowser=this.controls.recentFiles.getTreeView();},$constructor:function(){this._publish('onDataLoadError','onDragFromRecent'),this.recentHandledIds=[];},_modifyOptions:function(e){if(e.withFavorite)d.setToJsonForFunction(this._recentGroupMethod,'js!SBIS3.EDO.CD.FolderStiker','prototype._recentGroupMethod'),e.groupBy={field:'IsFavorite',template:a,method:this._recentGroupMethod,contentTemplate:'tmpl!SBIS3.EDO.CD.FolderStiker/templates/GroupRecentTemplate'};if(e.recents)e.useOnlyCtx=true;else e.modelAlias=null;return e;},init:function(){g.superclass.init.call(this),this._cacheElements();var t=this;if(this.subscribeTo(t.controls.recentBrowser,'onDataLoadError',this._onDataLoadErrorHandler.bind(this)),this.subscribeTo(t.controls.recentBrowser,'onEndDrag',this._onEndDrag.bind(this)),this.subscribeTo(t.controls.recentBrowser,'onDataMerge',this._onDataMerge.bind(this)),this.subscribeTo(t.controls.recentBrowser,'onItemClick',this._onItemClick.bind(this)),this.subscribeTo(t.controls.recentBrowser,'onDrawItems',this._onDrawItems.bind(this)),this.subscribeTo(t.controls.recentBrowser,'onNodeExpand',this._onNodeExpand),this.subscribeTo(e.channel('SbisDiskEvents'),'onRedrawRecentFile',this._onRedrawRecentFile.bind(this)),this.subscribeTo(t.controls.recentFiles,'onErrorCommand',this._onErrorCommand.bind(this)),this.subscribeTo(t.controls.recentFiles,'onStartCommand',this._onStartCommand.bind(this)),this.subscribeTo(t.controls.recentFiles,'onFinishCommand',this._onFinishCommand.bind(this)),this.controls.recentFiles.setCommandCfg('upload',{isMainAction:false,weightlist:4}),this._options.withFavorite)this.controls.recentFiles.setCommandCfg('rights',{isMainAction:false});},destroy:function(){g.superclass.destroy.call(this),this.controls=null;},updateRecentList:function(){var e=this;if(!this._options.recentVisible)return;this.controls.recentFiles.mergeFromBL({deleteItems:true});},clearList:function(){if(this.controls.recentBrowser)this.controls.recentBrowser.getItems().clear();},setVisibleControls:function(e){this.controls.recentFiles.setVisible(e);},getDocviewList:function(){return this.controls.recentFiles;},onChangeRecent:function(t){var o=this,n=this.recentHandledIds.indexOf(t.FileId);if(-1!==n)this.recentHandledIds.splice(n,1);else if(1===t.EventType||8===t.EventType||2===t.EventType&&t.ParentId===r.ROOT_FOLDER_FAVORITES)setTimeout(function(){o._onRedrawRecentFile(null,t.FileId,t.FileType);},200);else clearTimeout(this.reloadTimeoutRecent),this.reloadTimeoutRecent=setTimeout(function(){e.channel('SbisDiskEvents').notify('onUpdateRecentFilesLazy');},500);},handleAddFavorites:function(e,t){this.handleChanges({ids:[e.get('Id')],type:t});},changeDataSource:function(){this.controls.recentFiles.switchToRemoteDataSource(),this.controls.recentFiles.reloadItemInstances(),this.controls.recentBrowser.setInfiniteScroll('down',true);},_onRedrawRecentFile:function(e,t,o){var n=this;(0===o?i.readFolderInfo:i.readAttachmentInfo)({objectName:'FileSD',serviceUrl:r.getDiskServiceURL(),id:t}).addCallback(function(e){n.controls.recentFiles.redrawItemDocview(t,e);});},_onEndDrag:function(e,t){e.setResult(false);var o=this,n=t.getTargetsControl(),i=t.getTarget(),s=i?i.getPosition():null;if(!t.getSource()||!t.getSource().getCount())return;if(n!==o.controls.recentBrowser)return void o._notify('onDragFromRecent',t);if('on'===s)t.getSource().each(function(e){if(!e.getModel().get('Deleted'))l.AddInFavorites(e.getModel().getId()).addCallbacks(function(e){o.handleChanges({ids:[e.get('Id')],type:'AddInFavorites'});},function(e){r.showErrorNotification(rk('Ошибка')+'!',e.message||rk('Неизвестная ошибка'));});});else if('after'===s||'before'===s){var a=this.controls.recentBrowser.getItems(),d=i.getModel(),h=d.get('attachId'),u=a.getIndex(d),f=d.get('IsFavorite')?r.ROOT_FOLDER_FAVORITES:r.ROOT_FOLDER_RECENT,g=null,m=null,I=null,F=null;if(g='after'===s?u:u-1,m='before'===s?u:u+1,m>=a.getCount())I=h;else if(g<0)F=h;else if(a.at(g).get('IsFavorite')!==a.at(m).get('IsFavorite'))I='after'===s?h:null,F='before'===s?h:null;else I=a.at(g).get('attachId'),F=a.at(m).get('attachId');var S=[];t.getSource().each(function(e){if(!e.getModel().get('Deleted'))S.push(e.getModel().getId());}),c.SetFavouritesPosition({Id:S,DestinationRoot:f,IdBefore:F,IdAfter:I}).addCallbacks(function(e){var t=[],n=[];if(e&&e.getAll().each(function(e){if(e.get('ErrorMsg'))t.push(e.get('ErrorMsg'));else n.push(e.get('NewId'));}),t.length)r.showErrorNotification(rk('Ошибка при перемещении')+'!',t.join(', '));o.handleChanges({ids:n,type:'SetFavouritesPosition'});},function(e){r.showErrorNotification(rk('Ошибка при перемещении')+'!',e.message||rk('Неизвестная ошибка'));});}},_onItemClick:function(e,t,o){if(o.get('folder@')){e.setResult(false);var n=window.open('about:blank','_blank');l.GetPublicAccessRight(o.get('attachId')).addCallback(function(e){n.location.href=e.get('HRef');});}},_onDrawItems:function(){var e=true,t=false,o=this.controls.recentBrowser.getItems();if(o&&o.getCount())for(var n=0;n<o.getCount();n++){var r=o.at(n);if(!!r.get('folder@')&&r.get('IsFavorite'))e=false;else if(!r.get('folder@')&&r.get('IsFavorite'))e=true,t=true;else if(!r.get('IsFavorite'))break;}var i=this.controls.recentBrowser.getContainer().find('.controls-GroupBy');if(e&&!(t&&1===i.length)||2===i.length)i.hide(),$(i[1]).show();if(!e&&1===i.length)$(i[0]).show();},_onNodeExpand:function(e,t){this.collapseNode(t);},_onDataMerge:function(e,t){if(t&&t.getCount()&&'recent'!==t.at(0).get('folder'))t.clear();},_onDataLoadErrorHandler:function(e,t){var o=this._notify('onDataLoadError',t);e.setResult(o);},_onErrorCommand:function(e,t,o){if('deleteFromRecent'===t&&o&&o.error)r.showErrorNotification('Не удалось удалить один или несколько файлов',o.error.message);},_onStartCommand:function(e,t,o){if(e.setResult(this._notify('onStartCommand',t,o)),'addFavorites'===t&&o.records&&o.records.length)this.recentHandledIds.push(o.records[0].get('attachId'));},_onFinishCommand:function(e,t,o){if('deleteFromRecent'===t&&o.records&&o.records.length)this.controls.recentFiles.deleteItem(o.records[0].get('attachId'));else if('addFavorites'===t||'removeFavorites'===t)this.controls.recentFiles.deleteItem(o.records[0].get('attachId')),this.handleAddFavorites(o.finishParams.methodResult,t);},_isAvailableAddFavorite:function(e,t){return'list'===t.place&&t.command.inList&&!e.get('IsFavorite');},_isAvailableRemoveFavorites:function(e,t){return'list'===t.place&&t.command.inList&&e.get('IsFavorite');},_recentGroupMethod:function(e){return''+e.get('IsFavorite');},handleChanges:function(e){this.recentHandledIds=this.recentHandledIds.concat(e.ids),this.updateRecentList();}});return function e(){if(!u.isRegistered(f)){var o={serviceUrl:'/disk/api/v1/',objectName:'FileSD',previewWidth:110,previewHeight:110,_isAuth:true};u.register(f,function(e){var n=t(e,o);return new h(n);});}}(),g;});
define('js!SBIS3.EDO.CertificateTrust',['SBIS3.CONTROLS/Utils/InformationPopupManager','Lib/Control/FloatArea/FloatArea','Lichnye_sertifikaty_localization'],function(e,t){return{renderTrustButton:r,openTrustDialog:i};function r(e){if(e.get('ОтображатьДоверие')){var t=e.get('комуДоверяет')||'',r=(t=t.replace(new RegExp(';','g'),', '))?'div':'span';return'<'+r+' class="trust_click edo-CertificateTrust_signatureText '+(t?'edo-CertificateTrust_signatureName':'edo-CertificateTrust_signatureIco')+'">'+'<span class="edo-CertificateTrust_trustIco">'+'<span class="edo-CertificateTrust_trustIco_normal icon-16 icon-Share icon-primary"></span>'+'<span class="edo-CertificateTrust_trustIco_hover icon-16 icon-Share icon-hover"></span>'+'</span>'+'<span class="edo-CertificateTrust_trustName">'+(t?rk('Доверена')+': '+t:rk('Доверить'))+'</span>'+'</'+r+'>';}else return'<div style="display:inline-block;"></div>';}function i(r){var i=this,s=i.getTopParent();if(!r)return void e.showMessageDialog({message:rk('Эта подпись еще не получена. Для оформления доверия, сначала получите электронную подпись!'),status:'error',opener:s});var a=i.getRecordSet(),n=a.getRecordByPrimaryKey(r);if(!n.get('Контрагент'))return void e.showMessageDialog({message:rk('Данной электронной подписи не соответствует контрагент. Убедитесь в наличии контрагента с правильным ИНН в списке организаций и попробуйте ещё раз зарегистрировать ЭП.'),status:'error',opener:s});if(!n.get('Владелец'))return void e.showMessageDialog({message:rk('Подпись на этого сотрудника ещё не получена. Для оформления доверия сначала получите электронную подпись.'),status:'error',opener:s});if(n.has('Название')&&null===n.get('Название')&&null!==n.get('Контрагент'))try{var o=a.getRecordByPrimaryKey(n.get('Контрагент')+',Лицо');if(null!==o.get('Название'))n.set('Название',o.get('Название').length>45?o.get('Название').slice(0,45)+'...':o.get('Название')),n.commit();}catch(e){}new t({name:'TrustSignListArea',template:'js!SBIS3.EDO.TrustSignList',context:n,parent:null,opener:i,componentOptions:{reloadOpener:true},side:'right',direction:'left',width:'600px',minWidth:'600px',minHeight:'600px',autoHeight:true,isStack:true,animation:'slide',fixed:false});}});
define("html!SBIS3.EDO.CD.TKPFolderDialog",function(){var e=function(e){var o=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(o){for(;e.test(o);)o=o.replace(e,"&#123;&#123;$1&#125;&#125;");return o}}(),t="undefined"!=typeof process,n=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="cd-tkpFolderDialog"> <div class="ws-window-titlebar-custom"> <div class="cd-tkpFolderDialog__save-btn"> <component data-component="Deprecated/Controls/Button/Button" style="width:100px;" name="кнСохранитьРаздел"> <option name="caption">Сохранить</option> <option name="defaultButton">true</option> </component> </div> </div> <div class="cd-tkpFolderDialog__name-field"> <component data-component="Deprecated/Controls/FieldString/FieldString" style="width:408px;margin-left:8px;" name="Название"> <option name="tooltip">Новая папка</option> </component> </div> </div>');return(n=o(n))+(t&&-1!==n.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.CD.TKPFolderDialog"}},e});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.CD.TKPFolderDialog", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".cd-tkpFolderDialog{width:425px;height:40px}.cd-tkpFolderDialog__save-btn{position:absolute;right:40px;top:8px}"));head.appendChild(style);});}
define('js!SBIS3.EDO.CD.TKPFolderDialog',['Transport/BLObject','SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.CD.TKPFolderDialog','css!SBIS3.EDO.CD.TKPFolderDialog','Deprecated/Controls/Button/Button','Deprecated/Controls/FieldString/FieldString','Lib/CoreValidators/CoreValidators','i18n!SBIS3.EDO.CD.TKPFolderDialog','OnControlDocs_localization'],function(e,t,o){var n=t.extend({_dotTplFn:o,$protected:{_options:{resizable:false,modal:true,autoHeight:true,autoWidth:true}},$constructor:function(){},init:function(){n.superclass.init.call(this),this.getChildControlByName('кнСохранитьРаздел').subscribe('onActivated',function(){this.sendCommand('save');}.bind(this)),this.getParent().subscribe('onSave',function(t){var o=this,n=o.getOpener().getQuery()['Иерархия'],r=o.getLinkedContext().getFieldOrigin('Название').getRecord();if(r.set('Иерархия',parseInt(n,10)),t.setResult(false),!r.get('Название'))o.getChildControlByName('Название').markControl('Поле обязательно для заполнения!');else return new e('Каталог').call('Записать',{'Запись':r},e.RETURN_TYPE_ASIS).addCallback(function(e){o.getOpener().reload(),o.sendCommand('close',true);});});}});return n.title=rk('Папка документов'),n;});
define("html!SBIS3.EDO.CD.TKPDocumentDialog",function(){var t=function(t){var o=function(){var t=/\{\{([\s\S]+?)\}\}/g;return function(o){for(;t.test(o);)o=o.replace(t,"&#123;&#123;$1&#125;&#125;");return o}}(),e=function(t){return t.join?t.join(""):t.toString()},n=function(t){return void 0===t?"":t&&"object"==typeof t?e(t):""+t},p="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class=\'tkpDoc-dialog\'> <component data-component=\'SBIS3.EDO2.Dialog\' name=\'TKPDoc\'> <opt name=\'tabindex\'>1</opt> <opts name=\'tabs\' type=\'array\'> <opts> <opt name=\'content\' type=\'content\'> <div class="tkpDoc-dialog__sticker-container"> <component data-component=\'SBIS3.EDO2.Sticker\' class=\'tkpDoc-dialog__sticker\'> <opt name=\'name\'>Stick</opt> </component> </div> <component data-component="SBIS3.DOCVIEW.FullViewer"> <opt name="name">TKPViewer</opt> <opt name=\'_gotozip\'>false</opt> <opts name="viewOptions"> <opt name="showStampFED">false</opt> </opts> <opts name="listOptions"> <opt name="multiselect">false</opt> <opt name="hideEmptyBackButton">true</opt> <opt name="itemsDragNDrop">false</opt> <options name="visibilityMode"> <opt name="setFromCookie">false</opt> </options> </opts> <opts name="mainOptions"> <opt name="ctxLinkList" type="string" value="record/РП.Документ/СписокВложений"></opt> <opt name="objectName" bind="record/РП.Документ/ТипДокумента/ТипДокумента" nonexistent="Документ" oneWay="true"></opt> <opt name="serviceUrl" type="string" value="/"></opt> <opt name="directLinkRouting" type="string" value="commondoc"></opt> <opt name="isDisk">false</opt> <opt name="fixId" bind="record/РП.Документ/ИдО" oneWay="true"></opt> <opt name="autoSaveFED">false</opt> <opts name="commands"> <opt name="fullScreen">true</opt> <opt name="directLink">true</opt> <opt name="print">true</opt> <opt name="upload">true</opt> <opt name="zoomMinus">true</opt> <opt name="zoomPlus">true</opt> <opt name="saveToPdf">true</opt> <opt name="deleteDoc">false</opt> <opt name="deletePage">false</opt> <opt name="copyToBuffer">false</opt> <opt name="addPage">false</opt> <opt name="edit">false</opt> <opt name="links">false</opt> <opt name="redactions">false</opt> <opt name="editPdf">false</opt> <opt name="signDocument">false</opt> </opts> </opts> </component> </opt> <opt name=\'id\'>contentTab</opt> <opt name=\'title\'>'+o(n(rk("Карточка документа")))+"</opt> </opts> </opts> </component> </div>");return(a=o(a))+(p&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return t.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.CD.TKPDocumentDialog"}},t});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.CD.TKPDocumentDialog", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".tkpDoc-dialog__sticker-container{width:100%;height:44px;margin-bottom:4px}.tkpDoc-dialog__sticker{float:right}"));head.appendChild(style);});}
define('js!SBIS3.EDO.CD.TKPDocumentDialog',['Lib/Control/Control','Transport/BLObject','Core/helpers/fast-control-helpers','Core/CommandDispatcher','js!SBIS3.EDO2.FormController','html!SBIS3.EDO.CD.TKPDocumentDialog','Core/ParallelDeferred','Core/moduleStubs','WS.Data/Entity/Record','css!SBIS3.EDO.CD.TKPDocumentDialog','js!SBIS3.EDO2.Dialog','js!SBIS3.EDO2.Sticker','js!SBIS3.EDO2.Viewer','js!SBIS3.DOCVIEW.FullViewer','OnControlDocs_localization'],function(e,t,o,n,a,i,l,r,s){var d=a.extend({_dotTplFn:i,$protected:{_options:{resizable:false,record:null,significantFields:['Лицо1','Лицо2','Лицо3','ДокументРасширение.Сумма','Дата','Номер','ДокументНашаОрганизация'],modal:true,autoHeight:true,autoWidth:true}},$constructor:function(){},init:function(){d.superclass.init.call(this),n.declareCommand(this,'tkpDeleteDoc',this._onDeleteHandler),n.declareCommand(this,'tkpPrintDoc',this._onPrintHandler),this.waitChildControlByName('task').addCallback(function(e){setTimeout(function(){e.setVisible(false),e.setAllowChangeEnable(false);},100);});},_onDeleteHandler:function(){var n=this,a=n.getRecordField('@СвязьКаталогов'),i=t('Каталог');o.question(rk('Удалить документ?'),{},n).addCallback(function(l){if(l)i.call('Удалить',{'ИдО':[a]},t.RETURN_TYPE_ASIS).addCallback(function(t){if(n.sendCommand('edoCloseDocument',{result:true}),e.ControlStorage.containsByName('РеестрСписокОбщих'))e.ControlStorage.getByName('РеестрСписокОбщих').reload();}).addErrback(function(e){o.alert(e.message,{},n);});});},_onPrintHandler:function(){var e=this.getRecordField('РП.Документ/ИдО'),t=this.getRecordField('РП.Документ/СписокВложений'),o=new s({rawData:{'СписокРедакций':null,'СписокВложений':t.clone(),'НастройкиШтампа':null,'НастройкиПодписантов':null}});return o.get('СписокВложений').each(function(e){e.set('signs',false);}),new l({steps:[r.requireModule('Lib/Control/FloatArea/FloatArea')]}).done().getResult().addCallback(function(t){var n=Boolean(this.hasChildControlByName('DocumentTabs'))&&this.getChildControlByName('DocumentTabs'),a=n&&'timelineTab'===n._options.selectedKey;new t[0][0]({template:'js!SBIS3.EDO2.PrintPanel',name:'PrintPanel',target:this,autoHeight:true,modal:true,animation:'slide',autoHide:false,isStack:true,autoCloseOnHide:true,parent:this,linkedContext:this.getContext(),componentOptions:{parent:this,docId:e,data:o,docType:this.getRecordField('РП.Документ/ТипДокумента/ТипДокумента'),redactionsList:void 0,hasAuth:!!this.getRecordField('isAuthorized'),serviceDocs:a}});}.bind(this));}});return d;});
define("html!SBIS3.EDO.CD.TKPDocsFilter",function(){var o=function(o){var e=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(e){for(;o.test(e);)e=e.replace(o,"&#123;&#123;$1&#125;&#125;");return e}}(),n=function(o){return o.join?o.join(""):o.toString()},t=function(o){return void 0===o?"":o&&"object"==typeof o?n(o):""+o},i="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="cd-tkpDocsFilter"> <div class="cd-tkpDocsFilter__select-filter ws-labeled-control ws-non-control" style="height:100%; width: 335px;"> <div class="cd-tkpDocsFilter__label ws-field-label ws-field-binding-left"> <label for="fld-ФильтрДатаПериод"> <span>'+e(t(rk("Отбираются")))+'</span> </label> </div> <component data-component="Deprecated/Controls/FieldDropdown/FieldDropdown" name="ФильтрДатаПериод" style="height: 24px;width: 195px;margin-left: 22px;"> <option name="tabindex" value="2"></option> <option name="autoWidth" value="true" type="boolean"></option> <option name="name" value="ФильтрДатаПериод"></option> <option name="extendedTooltip" value="false" type="boolean"></option> <option name="showSelectedInList" value="true" type="boolean"></option> <option name="value" value="Все"></option> <options name="data" type="array"> <options> <option name="key" value="Все"></option> <option name="value" value="'+e(t(rk("За весь период")))+'"></option> </options> <options> <option name="key" value="Сегодня"></option> <option name="value" value="'+e(t(rk("За сегодня")))+'"></option> </options> <options> <option name="key" value="Месяц"></option> <option name="value" value="'+e(t(rk("За последний месяц")))+'"></option> </options> <options> <option name="key" value="Полгода"></option> <option name="value" value="'+e(t(rk("За последние полгода")))+'"></option> </options> <options> <option name="key" value="Год"></option> <option name="value" value="'+e(t(rk("За последний год")))+'"></option> </options> <options> <option name="key" value="Период"></option> <option name="value" value="'+e(t(rk("За период")))+'"></option> </options> </options> <options name="handlers"> <option name="onValueChange" value="js!SBIS3.EDO.Filters:onChangeFilterPeriod" type="function"></option> </options> </component> </div> <div class="cd-tkpDocsFilter__filterDat-block"> <component data-component="Deprecated/Controls/DateRange/DateRange" name="ФильтрДат" style="height: 24px;width: 172px;margin-left: 120px;"> <option name="visible" value="false" type="boolean"></option> <option name="tabindex" value="3"></option> <option name="name" value="ФильтрДат"></option> <option name="dateFromName" value="ФильтрДатаС"></option> <option name="dateToName" value="ФильтрДатаП"></option> <option name="extendedTooltip" value="false" type="boolean"></option> <options name="handlers"> <option name="onChange" value="js!SBIS3.EDO.Filters:onChangePeriodDates" type="function"></option> </options> <options name="validators" type="array"> <options> <option name="validator" value="js!SBIS3.EDO.Filters:periodAndDateValidation" type="function"></option> </options> </options> </component> </div> <div class="cd-tkpDocsFilter__order-filter ws-labeled-control ws-non-control" style="height:100%; width: 335px; padding-bottom: 12px;"> <div class="cd-tkpDocsFilter__label ws-field-label ws-field-binding-left"> <label for="fld-СортироватьПо"> <span>'+e(t(rk("Сортировать по")))+'</span> </label> </div> <component data-component="Deprecated/Controls/FieldDropdown/FieldDropdown" name="СортироватьПо" style="height: 24px;width: 195px;"> <option name="tabindex" value="1"></option> <option name="name" value="СортироватьПо"></option> <option name="extendedTooltip" value="false" type="boolean"></option> <option name="showSelectedInList" value="true" type="boolean"></option> <option name="value" value="'+e(t(rk("Сортировать по названию")))+'"></option> <options name="data" type="array"> <options> <option name="key" value="Сортировать по названию"></option> <option name="value" value="'+e(t(rk("названию")))+'"></option> </options> <options> <option name="key" value="Сортировать по дате изменения"></option> <option name="value" value="'+e(t(rk("дате изменения")))+'"></option> </options> </options> </component> </div> </div>');return(a=e(a))+(i&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.CD.TKPDocsFilter"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.CD.TKPDocsFilter", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".cd-tkpDocsFilter{width:335px;min-width:335px;display:inline-block}.cd-tkpDocsFilter__label{float:left;text-align:right;margin-right:8px;font-size:11px}.cd-tkpDocsFilter__order-filter,.cd-tkpDocsFilter__select-filter{margin:8px 16px 0 16px;float:left}"));head.appendChild(style);});}
define('js!SBIS3.EDO.CD.TKPDocsFilter',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.CD.TKPDocsFilter','css!SBIS3.EDO.CD.TKPDocsFilter','Deprecated/Controls/DateRange/DateRange','Deprecated/Controls/FieldDropdown/FieldDropdown','js!SBIS3.EDO.Filters','i18n!SBIS3.EDO.CD.TKPDocsFilter','OnControlDocs_localization'],function(t,e){var o=t.extend({_dotTplFn:e,$protected:{_options:{autoHeight:true,autoWidth:true}},$constructor:function(){},init:function(){o.superclass.init.call(this);}});return o;});
define("html!SBIS3.EDO.CD.TKPDocsReestr",function(){var o=function(o){var e=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(e){for(;o.test(e);)e=e.replace(o,"&#123;&#123;$1&#125;&#125;");return e}}(),n=function(o){return o.join?o.join(""):o.toString()},t=function(o){return void 0===o?"":o&&"object"==typeof o?n(o):""+o},i="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="tkpReestr"> <table class="tkpReestr__head-controls"> <tr> <td class="tkpReestr__td-mass-panel"> <component data-component="Deprecated/Controls/OperationsPanel/OperationsPanel" name="ПанельМассовыхОперацийОбщихДокументов" class="tkpReestr__mass-panel-control"> <option name="linkedView" value="/РеестрСписокОбщих"></option> <options name="selectedOperations"> <options name="move"></options> <options name="userOperations"> <options name="Удалить"> <option name="action" type="function" value="js!SBIS3.EDO.CD.TKPDocsReestr:prototype.onDeleteDocsFromMassOperations"></option> <option name="img" value="sprite:icon-24 icon-Erase icon-error"></option> <option name="tooltip" value="'+e(t(rk("Удалить документы")))+'"></option> </options> </options> </options> <options name="markOperations"> <options name="selectCurrentPage"></options> <options name="invertSelection"></options> <options name="removeSelection"></options> </options> <option name="tabindex" value="1"></option> </component> </td> <td class="tkpReestr__td-search-string"> <component data-component="Deprecated/Controls/SearchString/SearchString" name="СтрокаПоискаХД" class="tkpReestr__search-string"> <option name="linkedBrowser" value="/РеестрСписокОбщих"></option> <option name="tooltip" value="Поиск..."></option> <option name="filterName" value="ФильтрНазвание"></option> <option name="useBrowserFilter" value="true"></option> <option name="receiveContextValue" value="false"></option> <option name="tabindex" value="2"></option> </component> </td> <td> <component data-component="SBIS3.EDO.FilterController" name="ПанельФильтровХД"> <option name="browserId" value="/РеестрСписокОбщих"></option> <option name="filterLine" type="function" value="js!SBIS3.EDO.FastFilters:filterLineRender"></option> <options name="filters"> <options name="СортироватьПо"> <option name="defaultValue" value="'+e(t(rk("Сортировать по названию")))+'"></option> <options name="value"> <option name="fieldName" value="СортироватьПо"></option> </options> </options> </options> <option name="mode" value="hover"></option> <option name="template" value="js!SBIS3.EDO.CD.TKPDocsFilter"></option> <options name="filterButtonHandlers"> <options name="onChange" type="array"> <option type="function" value="js!SBIS3.EDO.Filters:renderFilterDate"></option> </options> </options> <options name="pathFilterHandlers"> <option name="onCreatePoint" type="function" value="js!SBIS3.EDO.FastFilters:onCreateSortPoint"></option> </options> <option name="tabindex" value="3"></option> <option name="autoWidth" value="true"></option> </component> <component data-component="Deprecated/Controls/Menu/Menu" name="БФСортировка"> <option name="visible" value="false"></option> <option name="name" value="БФСортировка"></option> <options name="data" type="array"> <options> <option name="caption" value="'+e(t(rk("Сортировать по названию")))+'"></option> <option name="id" value="Сортировать по названию"></option> </options> <options> <option name="caption" value="'+e(t(rk("Сортировать по дате изменения")))+'"></option> <option name="id" value="Сортировать по дате изменения"></option> </options> </options> </component> </td> </tr> </table> <component data-component="Deprecated/Controls/HierarchyView/HierarchyView" name="РеестрСписокОбщих" class="ws-browser-small-paddings docs_warehouse_list tkpReestr__reestr"> <option name="tabindex" value="5"></option> <option name="autoHeight" value="true"></option> <option name="className" value="ws-browser-small-paddings docs_warehouse_list"></option> <option name="saveState" value="true"></option> <option name="editBranchDialogTemplate" value="js!SBIS3.EDO.CD.TKPFolderDialog"></option> <option name="allowMove" value="true"></option> <option name="editMode" value="newFloatArea"></option> <options name="colorMarkedColumns" type="array"></options> <options name="display"> <option name="width" value="100%"></option> <option name="height" value="100%"></option> <option name="cutLongRows" value="true"></option> <option name="usePaging" value="parts"></option> <option name="showPaging" value="true"></option> <option name="useSorting" value="false"></option> <option name="partiallyLoad" value="true"></option> <option name="rootName" value=""></option> <option name="showRoot" value="false"></option> <option name="titleColumn" value="'+e(t(rk("Название")))+'"></option> <option name="hierColumn" value="Раздел"></option> <option name="rowRender" value="js!SBIS3.EDO.CD.TKPDocsReestr:prototype.onRowRender" type="function"></option> <option name="allowHorizontalScroll" value="false"></option> <option name="showSelectionCheckbox" value="true"></option> <option name="rowOptions" value="true"></option> <option name="showEditArrow" value="false"></option> <option name="emptyHtml"> <div>'+e(t(rk("Нет данных")))+'</div> </option> <options name="columns" type="array"> <options> <option name="title" value=""></option> <option name="field" value="Название"></option> <option name="render" value="js!SBIS3.EDO.CD.TKPDocsReestr:prototype.onTitleRender" type="function"></option> <option name="width" value="214"></option> <option name="decimals" value="9"></option> <option name="filterName" value="Название"></option> <option name="captionAlign" value="left"></option> </options> <options> <option name="title" value=""></option> <option name="render" value="js!SBIS3.EDO.CD.TKPDocsReestr:prototype.onSizeRender" type="function"></option> <option name="width" value="80"></option> <option name="fixedSize" value="true"></option> <option name="decimals" value="9"></option> <option name="textAlign" value="right"></option> <option name="captionAlign" value="right"></option> <option name="className" value="full_size"></option> </options> <options> <option name="title" value="'+e(t(rk("Ответственный")))+'"></option> <option name="render" value="js!SBIS3.EDO.CD.TKPDocsReestr:prototype.onOtvRender" type="function"></option> <option name="width" value="175"></option> <option name="fixedSize" value="true"></option> <option name="decimals" value="9"></option> <option name="captionAlign" value="left"></option> </options> <options> <option name="title" value=""></option> <option name="render" value="js!SBIS3.EDO.CD.TKPDocsReestr:prototype.onDateRender" type="function"></option> <option name="width" value="82"></option> <option name="fixedSize" value="true"></option> <option name="decimals" value="9"></option> <option name="textAlign" value="right"></option> <option name="captionAlign" value="left"></option> <option name="useForFolder" value="true"></option> </options> </options> <options name="mainRowOptions"> <option name="edit" value="true"></option> <option name="copy" value="false"></option> <option name="move" value="true"></option> <option name="delete" value="true"></option> <option name="history" value="false"></option> <option name="printRecord" value="false"></option> <option name="addFolder" value="false"></option> <option name="addItem" value="false"></option> </options> </options> <options name="dataSource"> <option name="readerType" value="ReaderUnifiedSBIS"></option> <option name="firstRequest" value="false"></option> <options name="readerParams"> <option name="queryName" value="Список"></option> <option name="linkedObject" value="Каталог"></option> <option name="createMethodName" value="Создать"></option> <option name="readMethodName" value="Прочитать"></option> <option name="updateMethodName" value="Записать"></option> <option name="destroyMethodName" value="Удалить"></option> </options> </options> <options name="handlers"> <option name="onRowActivated" value="js!SBIS3.EDO.CD.TKPDocsReestr:prototype.onItemClick" type="function"></option> </options> <option name="verticalAlignment" value="Top"></option> </component> </div>');return(a=e(a))+(i&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.CD.TKPDocsReestr"}},o});
define('js!SBIS3.EDO.CD.TKPHelpers',['OnControlDocs_localization'],function(){return{testFunc:function(){alert('FFF');},makeGrayTail:function(r){var e=r.split('.'),t;if(e.length>1)if(t=e[e.length-1],t.length)return r.substr(0,r.length-t.length-1)+'<span style="color: #999999">.'+t+'</span>';else return r;else return r;},getPluralForm:function(r,e,t,n){return r%10==1&&r%100!=11?e:r%10>=2&&r%10<=4&&(r%100<10||r%100>=20)?t:n;},prettyFileSize:function(r){var e=1024,t=[rk('байт'),rk('КБ'),rk('МБ'),rk('ГБ'),rk('ТБ')];if(0===r)return rk('0 байт');var n=parseInt(Math.floor(Math.log(r)/Math.log(e)),10);if(t[n]===rk('байт')||t[n]===rk('КБ'))return(r/Math.pow(e,n)).toFixed(0)+' '+t[n];else if(t[n]===rk('МБ'))return(r/Math.pow(e,n)).toFixed(1)+' '+t[n];else if(t[n]===rk('ГБ')||t[n]===rk('ТБ'))return(r/Math.pow(e,n)).toFixed(2)+' '+t[n];}};});
define('js!SBIS3.EDO.CD.TKPDocumentModel',['Core/core-extend','js!SBIS3.EDO2.EdoModel','OnControlDocs_localization'],function(e,o){'use strict';return e(o,[],{_moduleName:'SBIS3.EDO.CD.TKPDocumentModel',$protected:{_options:{properties:{},serviceCommandsVisibility:{edoShowMarksPanel:false,edoSendMessage:false,edoSaveDocumentOnDisk:false,edoShowMonitoringDialog:false,edoGetLink:false,edoOpenInNewTab:false,edoShowHistory:false,edoSendToAgreement:false,edoDeleteDocument:false,edoPrintDocument:false,edoGetLinkRoot:false,edoShareLink:false,edoLinkedDocs:false,edoCreateNote:false},userServiceCommands:[{id:'tkpPrintDoc',icon:'sprite:icon-24 icon-Print icon-primary',visible:true,caption:rk('Распечатать'),componentType:'SBIS3.CONTROLS/Button/IconButton',command:'tkpPrintDoc',showType:1},{id:'tkpDeleteDoc',icon:'sprite:icon-24 icon-Erase icon-error',visible:'РП.Документ/РазрешенныеДействия/Удаление',caption:rk('Удалить'),componentType:'SBIS3.CONTROLS/Button/IconButton',command:'tkpDeleteDoc',showType:1}]}}});});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.CD.TKPDocsReestr", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".tkpReestr__head-controls{width:100%;padding-top:33px}.tkpReestr__td-mass-panel{width:48px}.tkpReestr__td-search-string{width:250px}.tkpReestr__search-string{width:220px}.tkpReestr__reestr .ws-browser-cell-container{height:auto}.tkpReestr__mass-panel-control{padding-left:8px}.cd_title{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;line-height:17px}.cd_sotr{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.cd_file_item{color:#999;font-size:11px;overflow:hidden;padding-left:10px;text-overflow:ellipsis;white-space:nowrap;padding-right:8px}.full_size .cd_file_item{font-size:13px}.cd_sotr_otd{color:#999;font-size:11px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.cd_dt_gray{color:#999;font-size:11px}.edo-DateNumber__captionPlace{max-width:450px!important}.cd_tabcaption{font:italic bold 18px;border-bottom:none!important;padding-left:1px}.edo-DateNumber__control div[name=\"Название\"]{width:250px!important}.docs_warehouse_list .ws-browser-table-row td{vertical-align:top}.sortTitle{z-index:100}.folder_common_doc{font-size:16px!important;padding-bottom:2px}.folder_row_common_doc{padding-top:5px!important;padding-bottom:5px!important}.leaf_row_common_doc{margin-top:7px}.cd_file_item.leaf_common_doc{font-size:12px!important}.leaf_common_doc{font-size:14px!important;padding-bottom:1px}.cd_checkbox{padding-top:8px!important}.tkp_photo_div{float:left;padding-right:5px}.common_docs_tabs .ws-tabs-body-pad{padding-top:28px!important}.docs_warehouse_list span.ws-PathSelector__point[data-index=\"0\"]:before{content:\"\\e64c\"}"));head.appendChild(style);});}
define('js!SBIS3.EDO.CD.TKPDocsReestr',['Lib/Control/Control','Core/core-functions','Transport/BLObject','Core/helpers/string-helpers','Core/helpers/fast-control-helpers','SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.CD.TKPDocsReestr','js!SBIS3.EDO.CD.TKPHelpers','js!SBIS3.Employee.ListEmployees','WS.Data/Source/SbisService','js!SBIS3.EDO.CD.TKPDocumentModel','js!SBIS3.EDO2.OpenDialogAction','js!SBIS3.EDO.CD.TKPDocsFilter','js!SBIS3.EDO.CD.TKPFolderDialog','Deprecated/Controls/OperationsPanel/OperationsPanel','Deprecated/Controls/SearchString/SearchString','js!SBIS3.EDO.FilterController','js!SBIS3.EDO.FastFilters','js!SBIS3.EDO.Filters','Deprecated/Controls/HierarchyView/HierarchyView','Deprecated/Controls/Menu/Menu','Deprecated/Controls/DataViewAbstract/plugins/Move-plugin','css!SBIS3.EDO.CD.TKPDocsReestr','js!SBIS3.EDO.CD.TKPDocumentDialog','OnControlDocs_localization'],function(e,t,r,o,l,n,i,a,s,c,d,g){var u=n.extend({_dotTplFn:i,$protected:{_options:{}},$constructor:function(){},init:function(){u.superclass.init.call(this),document.title=rk('На контроле/СБИС');var e=this.getChildControlByName('РеестрСписокОбщих'),t=e.getQuery();t['Иерархия']=0,e.setQuery(t);},destroy:function(){u.superclass.destroy.call(this);},onRowRender:function(e,t){if(e.get('Раздел@'))t.find('td').addClass('folder_row_common_doc');else t.find('.ws-browser-checkbox-holder').addClass('cd_checkbox');var r=e.hasColumn('ИмяПоУмолчанию')&&e.get('ИмяПоУмолчанию')?true:false;if(e.get('ВнешниеФайлы').getRecords().length<=1&&r)t.find('.leaf_common_doc').addClass('leaf_row_common_doc');},onTitleRender:function(e,t){var r,l=0,n=e.get('ВнешниеФайлы').getRecords(),i,s=e.hasColumn('ИмяПоУмолчанию')&&e.get('ИмяПоУмолчанию')?true:false,c=[],d='';i='<div class="cd_title ws-browser-text-highlight" title="'+(d=(r=null!==e.get(t)?o.escapeHtml(e.get(t)):'').replace('"',''))+'">'+(s?a.makeGrayTail(r):r)+'</div>';var g,u='';if(n.length){if(s){for(g=1;n[g];g++)c.push(n[g]);n=c;}if(n.length>3){for(g=0;g<2;g++)i+='<div class="cd_file_item" title="'+(u=o.escapeHtml(n[g].get('ИмяФайла'))).replace('"','')+'">'+u+'</div>';for(l=0,g=2;n[g];g++)l+=n[g].get('Размер');i+='<div class="cd_file_item">'+rk('еще','количество')+' '+(n.length-2)+' '+a.getPluralForm(n.length-2,rk('файл'),rk('файла'),rk('файлов'))+'</div>';}else for(g=0;n[g];g++)i+='<div class="cd_file_item" title="'+(u=o.escapeHtml(n[g].get('ИмяФайла'))).replace('"','')+'">'+u+'</div>';}var m=$(i);return m.addClass(e.get('Раздел@')?'folder_common_doc':'leaf_common_doc'),m;},onSizeRender:function(e,t){for(var r=0,o=e.get('ВнешниеФайлы').getRecords(),l=0;o[l];l++)r+=o[l].get('Размер');return $('<div class="cd_file_item">'+a.prettyFileSize(r)+'</div>');},onOtvRender:function(t,r){var l=null!==t.get('ОтветственныйОтдел')?t.get('ОтветственныйОтдел'):null!==t.get('ОтветственныйКонтрагент')?o.escapeHtml(t.get('ОтветственныйКонтрагент')):'',n=l.length>55?l.substr(0,55)+'...':l;l=l.replace(/"/g,'&quot;');var i=t.hasColumn('ОтветственныйИдО')&&null!==t.get('ОтветственныйИдО')?'user_id="'+t.get('ОтветственныйИдО')+'"':'',a=t.hasColumn('ОтветственныйФИО')&&null!==t.get('ОтветственныйФИО')?o.escapeHtml(t.get('ОтветственныйФИО')):'',c='<div class="tkp_photo_div"></div>',d=t.hasColumn('ОтветственныйИдО')&&null!==t.get('ОтветственныйИдО')?t.get('ОтветственныйИдО'):null,g=s.createDivPhoto(e.ControlStorage.getByName('РеестрСписокОбщих'),t.getKey(),null,void 0,d),u=$(c+'<div '+i+' >'+a+'</div>'+'<div title="'+l+'" class="cd_sotr_otd">'+n+'</div>');$(u[0]).html(g);var m=$('<div class="cd_sotr" '+i+'></div>');return m.html(u),m;},onDateRender:function(e,t){var r=e.get('ДатаИзменения');if(!r)return $('<div class="cd_dt_gray"></div>');var o=r.strftime('%d %b').toLowerCase(),l=r.getFullYear()!==new Date().getFullYear()?' \''+r.strftime('%y'):'',n=r.strftime('%H:%M'),i=o+(l||', '+n);return $('<div class="cd_dt_gray">'+i+'</div>');},onDeleteDocsFromMassOperations:function(o){var n=[],i=this;l.question(rk('Удалить отмеченные документы?'),{},i.getTopParent()).addCallback(function(a){if(a){for(var s=0;s<o.length;s++)n.push(parseInt(o[s].get('@СвязьКаталогов'),10));new r('Каталог').call('УдалитьМассово',{'ИдО':n},r.RETURN_TYPE_RECORD).addCallback(function(t){if(t.get('КолСОшибками')>0)return void l.alert(t.get('ТекстОшибки'),{},i.getTopParent());if(e.ControlStorage.containsByName('РеестрСписокОбщих')){var r=i.getCurrentView();r.removeSelection(),r.reload();}}).addErrback(function(e){t.alert(e.message);});}});},onItemClick:function(e,t,r){if(r.get('Раздел@'))return true;e.setResult(false);var o=this;new c({endpoint:'Документ',model:d,idProperty:'@СвязьКаталогов'}).call('ПрочитатьДляУчастника',{'ИдО':r.get('@СвязьКаталогов'),'ИмяМетода':'Каталог.Список','ДопПоля':{'ИмяОбъекта':'Каталог'}}).addCallback(function(e){var t=e.getRow();new g({parent:o.getParent(),editMode:'floatArea',dialogComponent:'js!SBIS3.EDO.CD.TKPDocumentDialog'}).execute({item:t,id:t.getId(),initializingWay:'Local',dialogOptions:{showOnControlsReady:true,isStack:true,side:'right',autoHide:true},componentOptions:{openedFromTimeline:false,isEventsReestr:false},hideLoadingIndicator:true});}).addErrback(function(e){l.alert(e.message);});}});return u.webPage={htmlTemplate:'/Тема Скрепка/Шаблоны/grayTheme_newAccrodion.html',outFileName:'oncontroldocs'},u;});
define("html!SBIS3.EDO.FOrder",function(){var o=function(o){var n=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;o.test(n);)n=n.replace(o,"&#123;&#123;$1&#125;&#125;");return n}}(),e=function(o){return o.join?o.join(""):o.toString()},t=function(o){return void 0===o?"":o&&"object"==typeof o?e(o):""+o},i="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="FTaskControl"> <component data-component="SBIS3.EDO2.Dialog" name=\'EDOOrderDialog\'> <option name="objectName" value="Приказ"></option> <option name="secondLineContent"> </option> <options name="fullTrace"> <option name="showToolbar">false</option> </options> <opt name="firstLineContent"> <component data-component="SBIS3.Contragents.ChoiceOurCompanyLink"> <opts name="componentOptions"> <option name="ShowInnerCompany" value="true"></option> <option name="ShowAllCompany" value="false"></option> <option name="ourCompany" value="false"></option> <option name="withAffiliates" value="true"></option> </opts> <option name="idProperty" value="@Лицо"></option> <option name="selectedKey" bind="record/ДокументНашаОрганизация"/> <option name="multiselect" value="false"></option> <option name="className">controls-SelectorButton__asLink edo-FOrder_ChoiceOurCompany</option> <option name="enabled">true</option> <option name="allowChangeEnable">false</option> <options name="validators" type="array"> <options> <option name="validator" type="function">SBIS3.CONTROLS/Utils/ControlsValidators:required</option> <option name="option">selectedKey</option> </options> </options> </component> </opt> <options name="tabs" type="array"> <options> <option name="className">myClass controls-TabButton__main-item</option> <option name="content"> <div class="edo-FOrder_sticker-container"> <component data-component="SBIS3.EDO2.Sticker" name="OrderSticker"> <option name="tabindex" value="2"></option> <option name="mini">true</option> </component> </div> <div class="edo-FOrder_TaskControls"> <component data-component="SBIS3.EDO.FTaskControls"> <opt name="tabindex" value="1"/> <opt name="visualView" bind="record/РП.Документ/Регламент/ВизуальноеПредставление/Идентификатор"/> <opt name="ignoreTabCycles" value="false"/> <opt name="showTheme" value="true"/> <opt name="showMilestone" value="false"/> <opt name="isNewRecord">'+n(t(o.isNewRecord))+"</opt> <opt name='isEmptyIsp'>"+n(t(!o.record||!o.record.get("СписокИсполнителей")))+'</opt> </component> </div> <div class="edo-FOrder_AttachTo"> <div class="edo-FOrder_itembutton"> <component data-component="SBIS3.EDO2.AttachButton" name="AttachTo"> <option name=\'canAttachExternalLinks\'>true</option> </component> </div> <div class="edo-FOrder_itembutton"> <component data-component="SBIS3.EDO2.CreateButton" name="CreateAttach"> </component> </div> <div class="edo-FOrder_itembutton"> <component data-component="SBIS3.DOCVIEW.SwitchVisibilityMode" name="ModeSwitcher" class="edo-FOrder_SwitchVisibility"> <option name=\'visible\' bind="record/toggleFOrderSwitchVisibilityMode" value="true" nonexistent="false"></option> <options name="hasSwitch"> <option name="bigPreview" value="true" type="boolean"></option> <option name="diskClassic" value="false" type="boolean"></option> <option name="classic" value="true" type="boolean"></option> </options> <options name="listOptions"> <options name="visibilityMode"> <option name="defaultMode">classic</option> <option name="setFromCookie">false</option> </options> </options> </component> </div> </div> <div class="edo-FOrder_FullViewer"> <component data-component=\'SBIS3.EDO2.Viewer\'> <option name=\'name\'>DocList</option> </component> </div> </option> <option name="id">firstTab</option> <option name="title"> '+n(t(rk("<component data-component='SBIS3.EDO2.MainTabHeader'> <option name='docType'>Приказ</option> </component>")))+" </option> </options> </options> </component> </div>");return(a=n(a))+(i&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.FOrder"}},o});
define('js!SBIS3.EDO.FOrderModel',['Core/constants','Core/helpers/string-helpers','Deprecated/helpers/string-helpers','js!SBIS3.EDO2.EdoModel','Core/Sanitize','Orders_localization'],function(e,t,n,o,i){'use strict';return o.extend({_moduleName:'SBIS3.EDO.FOrderModel',$protected:{_options:{userServiceCommand:[{id:'edoShowDocTime',icon:'sprite:icon-24 icon-Time icon-primary',className:'edo-Dialog_header-ServiceButtons_item',visible:!!('Управление рабочим временем'in e.modules),weight:70,caption:rk('Время по документу','Длина'),componentType:'SBIS3.CONTROLS/Button/IconButton',command:'fShowDocTime'}],properties:{toggleFOrderSwitchVisibilityMode:{get:function(){var e=this.get('РП.Документ'),t;if(e)t=e.get('СписокВложений');if(t&&t.getCount())return true;return false;},set:function(){}},mainInfo:{get:function(){var e=new o({adapter:this.getAdapter(),rawData:this.getRawData()}).get('mainInfo'),r;if(e&&void 0!==e.comment4&&'string'===typeof e.comment4){if(r=t.unEscapeHtml(e.comment4||''),r=i(r),r=n.htmlToText(r)||'',r.length>250)r=r.substr(0,250)+'...';r=t.escapeHtml(r),e.comment4=r,e.comment5=null;}return e;},set:function(){}},richHeight:{get:function(){return this.get('enabled')?48:24;},set:function(){}}}}}});});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.FOrder", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-FOrder_sticker-container{position:absolute;right:0;z-index:500}.edo-FOrder_TaskControls{padding-top:8px}.edo-FOrder_AttachTo,.edo-FOrder_TaskControls{margin-left:8px}.edo-FOrder_AttachTo{height:24px}.edo-FOrder_itembutton{float:left;margin-right:8px}.edo-FOrder_FullViewer{margin-top:4px}.edo-FOrder_Subtasks{padding-bottom:8px}.edo-FOrder_Subtasks .edo-Subtasks{margin-top:8px}.edo-FOrder_SwitchVisibility{float:right;margin-top:4px}.FTaskControl .edo-TaskControls_table{padding-top:18px}.edo-Dialog_header-secondLineContent{max-height:32px}.edo-FOrder_ChoiceOurCompanyLink .controls-SelectorButton__cross{display:none}.edo-FOrder_ChoiceOurCompany{float:right;width:auto;max-width:100%;margin-top:8px}"));head.appendChild(style);});}
define('js!SBIS3.EDO.FOrder',['Core/CommandDispatcher','js!SBIS3.EDO2.FormController','html!SBIS3.EDO.FOrder','js!SBIS3.EDO.FOrderModel','js!SBIS3.EDO.EdoServiceCommands','js!SBIS3.EDO2.Dialog','js!SBIS3.EDO2.Viewer','js!SBIS3.DOCVIEW.SwitchVisibilityMode','js!SBIS3.EDO2.MainTabHeader','js!SBIS3.EDO2.Sticker','SBIS3.CONTROLS/Menu/MenuLink','css!SBIS3.EDO.FOrder','js!SBIS3.EDO.FTaskControls','js!SBIS3.EDO2.AttachButton','js!SBIS3.EDO2.CreateButton','js!SBIS3.Contragents.ChoiceOurCompanyLink','SBIS3.CONTROLS/Utils/ControlsValidators','i18n!SBIS3.EDO.FOrder','Orders_localization'],function(S,e,t,o,r){var n=e.extend({_dotTplFn:t,$protected:{_options:{dataSource:{endpoint:'Приказ',binding:{read:'Документ.ПрочитатьДляУчастника',format:'Приказ.Список',query:'Список'},model:o},readMetaData:{'ИмяОбъекта':'Приказ','ИмяМетода':'Прочитать'}}},$constructor:function(){S.declareCommand(this,'fShowDocTime',r.fShowDocTime);},init:function(){n.superclass.init.call(this);}});return n;});
define("tmpl!SBIS3.EDO.FilterOrdersAddTpl",["Core/tmpl/js/tclosure","js!SBIS3.EDO.BaseFilter.DeletedSelector","js!SBIS3.EDO.BaseFilter.MarksSelector","js!SBIS3.EDO.BaseFilter.OurOrganisationSelector","js!SBIS3.EDO.BaseFilter.ListDispatchSelector","js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleSelector","js!SBIS3.EDO.BaseFilter.OverdueSelector","js!SBIS3.EDO.BaseFilter.RegulationSelector","js!SBIS3.EDO.BaseFilter.ResponsibleFaceSelector","js!SBIS3.EDO.BaseFilter.EventPerformerSelector","js!SBIS3.EDO.BaseFilter.SpecificPerformerSelector"],function(){var e=Array.prototype.slice.call(arguments),r=e[0],t={};t["js!SBIS3.EDO.BaseFilter.DeletedSelector"]=e[1],t["js!SBIS3.EDO.BaseFilter.MarksSelector"]=e[2],t["js!SBIS3.EDO.BaseFilter.OurOrganisationSelector"]=e[3],t["js!SBIS3.EDO.BaseFilter.ListDispatchSelector"]=e[4],t["js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleSelector"]=e[5],t["js!SBIS3.EDO.BaseFilter.OverdueSelector"]=e[6],t["js!SBIS3.EDO.BaseFilter.RegulationSelector"]=e[7],t["js!SBIS3.EDO.BaseFilter.ResponsibleFaceSelector"]=e[8],t["js!SBIS3.EDO.BaseFilter.EventPerformerSelector"]=e[9],t["js!SBIS3.EDO.BaseFilter.SpecificPerformerSelector"]=e[10];var o=function e(o,l,i,s,a){function n(){}var c=0,S=void 0!==r&&r?r:arguments[arguments.length-1];void 0===S&&(eval("var thelpers = null;"),S=global.requirejs("View/Runner/tclosure"));var d={};a&&a.isSetts&&(d=a.fullContext||{});var p="string"==typeof i?i:"",u=void 0===t?void 0:t,B={id:[],def:void 0},O=S.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),f=this&&this.includedTemplates?this.includedTemplates:{},m=S.getMarkupGenerator(s);try{var v=m.joinElements([m.createTag("div",{class:"Orders-UI-FilterTpl Orders-UI-FilterTpl__rows"},[m.createTag("div",{class:"Orders-UI-FilterTpl__left"},[m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.DeletedSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:O},i,u,f,S.config,d),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.MarksSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:O},i,u,f,S.config,d),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.OurOrganisationSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:O},i,u,f,S.config,d),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ListDispatchSelector",{caption:global.rk("Исполнителя")},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:O},i,u,f,S.config,d),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.AuthorOrResponsibleSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:O},i,u,f,S.config,d)],{},B,this),m.createTag("div",{class:"Orders-UI-FilterTpl__right"},[m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.OverdueSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:O},i,u,f,S.config,d),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.RegulationSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:O},i,u,f,S.config,d),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ResponsibleFaceSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:O},i,u,f,S.config,d),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.EventPerformerSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:O},i,u,f,S.config,d),m.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.SpecificPerformerSelector",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:O},i,u,f,S.config,d)],{},B,this)],l,B,this)],p,B);B.def&&(v=m.chain(v,B,l),B=void 0)}catch(e){S.templateError("resources/Orders/components/FilterOrdersAddTpl/FilterOrdersAddTpl.tmpl",e,o)}return v||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FilterOrdersAddTpl"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.FilterOrdersAddTpl", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".Orders-UI-FilterTpl{width:386px}.Orders-UI-FilterTpl__rows{display:flex;flex-direction:row;display:-ms-flexbox;-ms-flex-direction:row}.Orders-UI-FilterTpl__left{width:186px;display:flex;flex-direction:column;display:-ms-flexbox;-ms-flex-direction:column}.Orders-UI-FilterTpl__right{display:flex;flex-direction:column;display:-ms-flexbox;-ms-flex-direction:column}"));head.appendChild(style);});}
define('js!SBIS3.EDO.FilterOrdersAddTpl',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FilterOrdersAddTpl','css!SBIS3.EDO.FilterOrdersAddTpl','js!SBIS3.EDO.BaseFilter.MarksSelector','js!SBIS3.EDO.BaseFilter.DeletedSelector','js!SBIS3.EDO.BaseFilter.OurOrganisationSelector','js!SBIS3.EDO.BaseFilter.EventPerformerSelector','js!SBIS3.EDO.BaseFilter.ListDispatchSelector','js!SBIS3.EDO.BaseFilter.ResponsibleFaceSelector','js!SBIS3.EDO.BaseFilter.RegulationSelector','js!SBIS3.EDO.BaseFilter.OverdueSelector','js!SBIS3.EDO.BaseFilter.AuthorOrResponsibleSelector','js!SBIS3.EDO.BaseFilter.SpecificPerformerSelector','Orders_localization'],function(e,r){var t=e.extend({_dotTplFn:r,$protected:{_options:{}},$constructor:function(){},init:function(){t.superclass.init.call(this);}});return t;});
define("tmpl!SBIS3.EDO.FilterOrdersTpl",["Core/tmpl/js/tclosure","js!SBIS3.EDO.BaseFilter.Period","js!SBIS3.EDO.BaseFilter.ShortState","js!SBIS3.EDO.BaseFilter.Deleted","js!SBIS3.EDO.BaseFilter.Marks","js!SBIS3.EDO.BaseFilter.OurOrganisation","js!SBIS3.EDO.BaseFilter.ListDispatch","js!SBIS3.EDO.BaseFilter.Overdue","js!SBIS3.EDO.BaseFilter.Regulation","js!SBIS3.EDO.BaseFilter.ResponsibleFace","js!SBIS3.EDO.BaseFilter.EventPerformer","js!SBIS3.EDO.BaseFilter.AuthorOrResponsible","js!SBIS3.EDO.BaseFilter.SpecificPerformer"],function(){var e=Array.prototype.slice.call(arguments),r=e[0],t={};t["js!SBIS3.EDO.BaseFilter.Period"]=e[1],t["js!SBIS3.EDO.BaseFilter.ShortState"]=e[2],t["js!SBIS3.EDO.BaseFilter.Deleted"]=e[3],t["js!SBIS3.EDO.BaseFilter.Marks"]=e[4],t["js!SBIS3.EDO.BaseFilter.OurOrganisation"]=e[5],t["js!SBIS3.EDO.BaseFilter.ListDispatch"]=e[6],t["js!SBIS3.EDO.BaseFilter.Overdue"]=e[7],t["js!SBIS3.EDO.BaseFilter.Regulation"]=e[8],t["js!SBIS3.EDO.BaseFilter.ResponsibleFace"]=e[9],t["js!SBIS3.EDO.BaseFilter.EventPerformer"]=e[10],t["js!SBIS3.EDO.BaseFilter.AuthorOrResponsible"]=e[11],t["js!SBIS3.EDO.BaseFilter.SpecificPerformer"]=e[12];var o=function e(o,i,s,a,n){function l(){}var c=0,S=void 0!==r&&r?r:arguments[arguments.length-1];void 0===S&&(eval("var thelpers = null;"),S=global.requirejs("View/Runner/tclosure"));var d={};n&&n.isSetts&&(d=n.fullContext||{});var p="string"==typeof s?s:"",u=void 0===t?void 0:t,B={id:[],def:void 0},f=S.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),m=this&&this.includedTemplates?this.includedTemplates:{},O=S.getMarkupGenerator(a);try{var v=O.joinElements([O.createTag("div",{class:"Orders-UI-FilterTpl"},[O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Period",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},s,u,m,S.config,d),O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ShortState",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},s,u,m,S.config,d),O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Deleted",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},s,u,m,S.config,d),O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Marks",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},s,u,m,S.config,d),O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.OurOrganisation",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},s,u,m,S.config,d),O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ListDispatch",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},s,u,m,S.config,d),O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Overdue",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},s,u,m,S.config,d),O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.Regulation",{docTypes:[{docTypeString:"Приказ"}],multiselect:!1,esc:!1},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},s,u,m,S.config,d),O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.ResponsibleFace",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},s,u,m,S.config,d),O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.EventPerformer",{showCustom:!0},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},s,u,m,S.config,d),O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.AuthorOrResponsible",{showCustom:!0},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},s,u,m,S.config,d),O.createControl("wsControl","ws:SBIS3.EDO.BaseFilter.SpecificPerformer",{},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},s,u,m,S.config,d)],i,B,this)],p,B);B.def&&(v=O.chain(v,B,i),B=void 0)}catch(e){S.templateError("resources/Orders/components/FilterOrdersTpl/FilterOrdersTpl.tmpl",e,o)}return v||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.FilterOrdersTpl"}},o});
define('js!SBIS3.EDO.FilterOrdersTpl',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.FilterOrdersTpl','css!SBIS3.EDO.FilterOrdersAddTpl','js!SBIS3.EDO.BaseFilter.Period','js!SBIS3.EDO.BaseFilter.ShortState','js!SBIS3.EDO.BaseFilter.Marks','js!SBIS3.EDO.BaseFilter.Deleted','js!SBIS3.EDO.BaseFilter.OurOrganisation','js!SBIS3.EDO.BaseFilter.EventPerformer','js!SBIS3.EDO.BaseFilter.ListDispatch','js!SBIS3.EDO.BaseFilter.ResponsibleFace','js!SBIS3.EDO.BaseFilter.Regulation','js!SBIS3.EDO.BaseFilter.Overdue','js!SBIS3.EDO.BaseFilter.AuthorOrResponsible','js!SBIS3.EDO.BaseFilter.SpecificPerformer','Orders_localization'],function(e,s){var r=e.extend({_dotTplFn:s,$protected:{_options:{}},$constructor:function(){},init:function(){r.superclass.init.call(this);}});return r;});
define("html!SBIS3.EDO.OrderTabs",function(){var o=function(o){var n=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;o.test(n);)n=n.replace(o,"&#123;&#123;$1&#125;&#125;");return n}}(),t=function(o){return o.join?o.join(""):o.toString()},e=function(o){return void 0===o?"":o&&"object"==typeof o?t(o):""+o},a="undefined"!=typeof process,i=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="Orders_tabs ws-flexbox ws-flex-column ws-flex-grow-1 ws-flex-shrink-1"> <component data-component="SBIS3.CONTROLS/Button" name="кВыбрать" class="TaskListSelectBtn"> <option name="isRelative" value="true" type="boolean"></option> <option name="visible" value="false" type="boolean"></option> <option name="tabindex" value="5"></option> <option name="width" value="100%"></option> <option name="height" value="100%"></option> <option name="name" value="кВыбрать"></option> <option name="imgAlign" value="left"></option> <option name="defaultButton" value="true" type="boolean"></option> <option name="caption">'+n(e(rk("Выбрать")))+'</option> </component> <component data-component="SBIS3.Engine.BrowserTabs" name="OrderTabs" class="Orders_orderTabs ws-flexbox ws-flex-column ws-flex-grow-1 ws-flex-shrink-1"> <option name="operationsButtonVisibility" value="true" type="boolean"></option> <options name="tabsArea" type="array"> <options> <option name="id">aGroup</option> <option name="content"> <component data-component="SBIS3.EDO.FTaskButtons" name="TaskButtons" class="Orders_orderTabs-addBtn"> <option name="addDoc_name">AddOrder</option> <option name="addDoc_type">Приказ</option> <option name="showAddDoc">true</option> </component> <component data-component="SBIS3.EDO2.ExportButton" name="ExportBtn" class="Orders_orderTabs-exportBtn"> <option name="docType">Приказ</option> <options name="exportSettings"> <option name="customObjectName"/> <option name="fileName">Печать</option> <option name="exportDocuments">false</option> <options name="handlers"> <option name="onApplyOperation" type="function">js!SBIS3.EDO.OrdersHandlers:setPrintColumns</option> </options> </options> </component> </option> </options> </options> <options name="mainArea" type="array"> <options> <option name="content"> <component data-component="SBIS3.EDO.Orders"> <option name="useAutoRefresh">true</option> <opts name="partialReloader"> <opt name="onCreateModelHandlingEnable" value="true"/> <opt name="onDestroyModelHandlingEnable" value="true"/> </opts> </component> </option> <option name="id">ListGroup</option> </options> ');return o.onlyList||(i+=' <options> <option name="id">StatGroup</option> <option name="content"><component name="КомпонентСтатистики" data-component="SBIS3.EDO.StatTemplateNew" class="Orders_stat ws-flexbox ws-flex-column ws-flex-grow-1 ws-flex-shrink-1"> <option name="docType" value="Приказ"></option> <option name="StatTemplateName" value="ШаблонСтатистики"></option> <option name="statisticsType" value="period"></option> <option name="loadOnDemand" value="false" type="boolean"></option> <option name="maPrintId" value="@Документ"></option> <options name="customizeFilters"> <option name="FilterRepeatStages" value="true"></option> </options> </component> </option> </options> <options> <option name="id">ProcessGroup</option> <option name="content"> <component name="КомпонентСтатистикиВОбработке" data-component="SBIS3.EDO.StatTemplateNew" class="Orders_statInProcess ws-flex-grow-1 ws-flex-shrink-1"> <option name="docType" value="Приказ"></option> <option name="StatTemplateName" value="ШаблонСтатистикиВОбработке"></option> <option name="statisticsType" value="current"></option> <option name="loadOnDemand" value="false" type="boolean"></option> <option name="maPrintId" value="@Документ"></option> </component></option> </options> '),i+=' </options> <options name="tabs" type="array"> ',o.onlyList||(i+=' <options> <option name="id">ProcessTab</option> <option name="title">'+n(e(rk("В обработке")))+'</option> <option name="mainArea">ProcessGroup</option> </options> <options> <option name="id">StatTab</option> <option name="title">'+n(e(rk("Статистика")))+'</option> <option name="mainArea">StatGroup</option> </options> '),i+=' <options> <option name="id">ListTab</option> <option name="mainArea">ListGroup</option> <option name="tabsArea">aGroup</option> <option name="title">'+n(e(rk("Список")))+"</option> </options> </options> ",o.onlyList||(i+=' <option name="defaultTab">ListTab</option> '),i+=' <option name="tabsName">OrderTabs</option> <options name="handlers"> <option name="onTabChange" type="function">js!SBIS3.EDO.OrderTabs:prototype.onTabChange</option> <option name="onTabAndMainLoaded" type="function">js!SBIS3.EDO.OrderTabs:prototype.onTabAndMainLoaded</option> </options> </component> </div>',(i=n(i))+(a&&-1!==i.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.OrderTabs"}},o});
define("html!SBIS3.EDO.Orders",function(){var e=function(e){var t=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;e.test(t);)t=t.replace(e,"&#123;&#123;$1&#125;&#125;");return t}}(),o=function(e){return e.join?e.join(""):e.toString()},n=function(e){return void 0===e?"":e&&"object"==typeof e?o(e):""+e},i="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="Orders ws-flexbox ws-flex-column ws-flex-grow-1 ws-flex-shrink-1"> <component data-component="SBIS3.EDO2.Browser" name="Orders" class="Orders controls-Browser__hide-path"> <option name="historyId">OrdersList</option> <option name="backButtonEditing">true</option> <options name="ignoreFiltersList" type="array"> <option>ФильтрПриоритет</option> </options> <option name="useScope">true</option> <options name="browserOptions"> <option name="className">controls-TreeDataGridView__withPhoto</option> <option name="hasSeparator">false</option> <option name="emptyHTML">'+t(n(rk("Нет данных")))+'</option> <option name="idProperty">@Документ</option> <option name="bind">ordersAllFilter/button</option> <options name="columns" type="array"> <options> <option name="cellTemplate">tmpl!SBIS3.EDO2.Browser/resources/columns/tmpl/MainInfoColumn</option> <options name="includedTemplates"> <option name="photoTpl">html!SBIS3.PersonCore.Photo/photoCellTpl</option> </options> <options name="templateBinding"> <option name="photoFldName">userPhotoData</option> <option name="cssClass">person-photo-mini-large</option> </options> </options> <options> <option name="cellTemplate">tmpl!SBIS3.EDO2.Browser/resources/columns/tmpl/StateColumn</option> <option name="width">180</option> </options> <options> <option name="cellTemplate">tmpl!SBIS3.EDO.Orders/resources/tmpl/DateColumnTemplate</option> <options name="includedTemplates"> <option name="edoDateNumberColumn">tmpl!SBIS3.EDO2.Browser/resources/columns/tmpl/DateNumberColumn</option> </options> <option name="width">50</option> <option name="fixedSize">true</option> </options> <options> <option name="cellTemplate">tmpl!SBIS3.EDO2.Browser/resources/columns/tmpl/ResponsibleColumn</option> <option name="fixedSize">true</option> <option name="className">col_resp_pattern</option> <option name="width">140</option> </options> </options> <options name="ladder" type="array"> <option>face_foto</option> <option>date_col</option> </options> <options name="common"> <option name="objectName">Приказ</option> <option name="method">СписокВнутренних</option> <option name="model">SBIS3.EDO.FOrderModel</option> <options name="filterParams"> <option name="ПростыеВД" value="true"/> <option name="РассчитатьФото" value="true"/> <option name="ВключитьСписокИсполнителей" value="true"/> </options> </options> <options name="handlers"> <options name="onChangeHoveredItem" type="array"> <option name="onChangeHoveredItem" type="function">js!SBIS3.EDO.EdoRecOptions:onChangeHoveredItem</option> </options> <options name="onItemClick" type="array"> <option name="onItemClick" type="function">js!SBIS3.EDO.EdoClicks:clickDisp</option> </options> </options> <option name="viewMode">table</option> <options name="hierarchy"> <option name="allow">true</option> <option name="parentProperty">Раздел</option> <option name="displayProperty">Название</option> </options> <options name="itemsActions" type="array"/> <options name="massActionsVisibility"> <option name="edoPostsMass">false</option> <option name="edoSetCloseStatusMass">false</option> <option name="edoPrintDocumentMass">true</option> <option name="edoShowRegistryHistory">true</option> </options> <options name="massActionsSettings"> <options name="edoPrintDocumentMass"> <option name="minPrintWindowWidth">666</option> <option name="disablePrintingTemplates">false</option> <option name="documentIdField">@Документ</option> <options name="handlers"> <option name="onApplyOperation" type="function">js!SBIS3.EDO.OrdersHandlers:setPrintColumns</option> </options> <options name="subItemsVisibility"> <option name="printAttachments">false</option> </options> </options> <options name="edoShowRegistryHistory"> <option name="objectHistoryName">Приказ</option> <option name="allowChangeEnable">false</option> </options> </options> </options> <option name="fastDataFilterConfig"> <opt name="className">edo-tasks__fastDataFilter</opt> <opt name="keyField" value="name"/> <options name="filterStructure" type="array"> <opts> <opt name="internalValueField">FilterShortState</opt> <opt name="internalCaptionField">FilterShortStateText</opt> <opt name="value" bind="ordersAllFilter/button/ФильтрПоКраткомуСостоянию"/> <opt name="caption" bind="ФильтрПоКраткомуСостоянию"/> <opt name="resetValue">-1</opt> </opts> </options> </option> <option name="advBlockConfig"> \' <option name="blockId">EdoTasks__List</option> <options name="ignoredOptions" type="array"> <option>bind</option> <option>ВключитьСписокИсполнителей</option> <option>ПростыеВД</option> <option>РассчитатьФото</option> </options> <options name="ignoredByValue"> <option name="ИдРегламента" value="null"/> <options name="ФильтрВладелец" type="array"/> <options name="ФильтрАвторИлиОтветственный" type="array"/> <option name="ФильтрВладелецID" value="null"/> <option name="ФильтрДатаП" value="null"/> <option name="ФильтрДатаПериод" value="Все"/> <option name="ФильтрДатаС" value="null"/> <options name="ФильтрИсполнительСобытия" type="array"/> <option name="ФильтрКонкретныйИсполнитель" value="null"/> <option name="ФильтрКонкретныйИсполнительID" value="null"/> <options name="ФильтрЛицо1" type="array"/> <options name="ФильтрОтветственноеЛицо" type="array"/> <option name="ФильтрПоКраткомуСостоянию" value="-1"/> <options name="ФильтрСписокРассылки" type="array"/> <option name="ФильтрПриоритет" value="null"/> <option name="ФильтрПросроченные" value="null"/> <option name="ФильтрУдаленные" value="null"/> <option name="ФильтрФаза" value="null"/> </options> \' </option> <option name="filterButtonConfig"> <option name="template">js!SBIS3.EDO.FilterOrdersTpl</option> <option name="additionalFilterParamsTemplate">js!SBIS3.EDO.FilterOrdersAddTpl</option> <options name="filterStructure" type="array"> <opts> <opt name="internalValueField">FilterDatePeriod</opt> <opt name="internalCaptionField">FilterDatePeriodText</opt> <opt name="value" bind="ordersAllFilter/button/ФильтрДатаПериод"/> <opt name="resetValue">Все</opt> </opts> <opts> <opt name="internalValueField">FilterDateFrom</opt> <opt name="internalCaptionField">FilterDateFromEmptyText</opt> <opt name="value" bind="ordersAllFilter/button/ФильтрДатаС"/> <opt name="resetValue" type="null">null</opt> <opt name="itemTemplate" type="null">null</opt> <opt name="historyItemTemplate" type="null">null</opt> </opts> <opts> <opt name="internalValueField">FilterDateTo</opt> <opt name="internalCaptionField">FilterDateToEmptyText</opt> <opt name="value" bind="ordersAllFilter/button/ФильтрДатаП"/> <opt name="resetValue" type="null">null</opt> <opt name="itemTemplate" type="null">null</opt> <opt name="historyItemTemplate" type="null">null</opt> </opts> <opts> <opt name="internalValueField">FilterShortState</opt> <opt name="internalCaptionField">FilterShortStateText</opt> <opt name="value" bind="ordersAllFilter/button/ФильтрПоКраткомуСостоянию"/> <opt name="caption" bind="ФильтрПоКраткомуСостоянию"/> <opt name="itemTemplate" type="null">null</opt> <opt name="resetValue" type="string">-1</opt> </opts> <opts> <opt name="internalValueField">FilterDeleted</opt> <opt name="internalCaptionField">FilterDeletedText</opt> <opt name="internalVisibilityField">FilterDeletedVisibility</opt> <opt name="value" bind="ordersAllFilter/button/ФильтрУдаленные"/> <opt name="resetValue" type="null">null</opt> <opt name="resetVisibilityValue" type="boolean">false</opt> </opts> <opts> <opt name="internalValueField">FilterOverdue</opt> <opt name="internalCaptionField">FilterOverdueText</opt> <opt name="internalVisibilityField">FilterLimitationOverdueVisibility</opt> <opt name="value" bind="ordersAllFilter/button/ФильтрПросроченные"/> <opt name="resetValue" type="null">null</opt> <opt name="resetVisibilityValue" type="boolean">false</opt> </opts> <opts> <opt name="internalValueField">FilterIdRegulation</opt> <opt name="internalCaptionField">FilterIdRegulationText</opt> <opt name="internalVisibilityField">FilterRegulationVisibility</opt> <opt name="value" bind="ordersAllFilter/button/ИдРегламента"/> <opt name="resetValue" type="null">null</opt> <opt name="resetVisibilityValue" type="boolean">false</opt> </opts> <opts> <opt name="internalValueField">FilterIdPhase</opt> <opt name="internalCaptionField">FilterIdPhaseText</opt> <opt name="internalVisibilityField">FilterIdPhaseVisibility</opt> <opt name="value" bind="ordersAllFilter/button/ФильтрИдФазы"/> <opt name="resetValue" type="null">null</opt> <opt name="resetVisibilityValue" type="boolean">false</opt> </opts> <opts> <opt name="internalValueField">FilterMarksIncluded</opt> <opt name="internalCaptionField">FilterMarksIncludedText</opt> <opt name="value" bind="ordersAllFilter/button/ФильтрПометкиВкл"></opt> <opts name="resetValue" type="array"></opts> <opt name="itemTemplate" type="function" value="html!SBIS3.EDO2.MarksFilterRowTemplate"/> </opts> <opts> <opt name="internalValueField">FilterMarksExcluded</opt> <opt name="internalCaptionField">FilterMarksExcludedText</opt> <opt name="value" bind="ordersAllFilter/button/ФильтрПометкиИскл"></opt> <opts name="resetValue" type="array"></opts> <opt name="itemTemplate" type="function" value="html!SBIS3.EDO2.MarksFilterRowTemplate"/> </opts> <opts> <opt name="internalValueField">FilterResponsibleFace</opt> <opt name="internalCaptionField">FilterResponsibleFaceText</opt> <opt name="internalVisibilityField">FilterResponsibleFaceVisibility</opt> <opt name="value" bind="ordersAllFilter/button/ФильтрОтветственноеЛицо"/> <opts name="resetValue" type="array"/> <opt name="resetCaption" value=""/> <opt name="itemTemplate" type="function" value="tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterResp"/> <opt name="historyItemTemplate" type="function" value="tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterResp"/> <opt name="resetVisibilityValue" type="boolean">false</opt> </opts> <opts> <opt name="internalValueField">FilterAuthorOrResponsible</opt> <opt name="internalCaptionField">FilterAuthorOrResponsibleText</opt> <opt name="internalVisibilityField">FilterAuthorOrResponsibleVisibility</opt> <opt name="value" bind="ordersAllFilter/button/ФильтрАвторИлиОтветственный"/> <opts name="resetValue" type="array"/> <opt name="resetCaption" value=""/> <opt name="resetVisibilityValue" type="boolean">false</opt> </opts> <opts> <opt name="internalValueField">FilterListDispatch</opt> <opt name="internalCaptionField">FilterListDispatchText</opt> <opt name="internalVisibilityField">FilterListDispatchVisibility</opt> <opt name="value" bind="ordersAllFilter/button/ФильтрСписокРассылки"/> <opts name="resetValue" type="array"/> <opt name="resetCaption" value=""/> <opt name="itemTemplate" type="function" value="tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterListDispatch"/> <opt name="historyItemTemplate" type="function" value="tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterListDispatch"/> <opt name="resetVisibilityValue" type="boolean">false</opt> </opts> <opts> <opt name="internalValueField">FilterEventPerformer</opt> <opt name="internalCaptionField">FilterEventPerformerText</opt> <opt name="internalVisibilityField">FilterEventPerformerVisibility</opt> <opt name="value" bind="ordersAllFilter/button/ФильтрИсполнительСобытия"/> <opts name="resetValue" type="array"/> <opt name="resetCaption" value=""/> <opt name="itemTemplate" type="function" value="tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterEventPerformer"/> <opt name="historyItemTemplate" type="function" value="tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterEventPerformer"/> <opt name="resetVisibilityValue" type="boolean">false</opt> </opts> <opts> <opt name="internalValueField">FilterOurOrganisation</opt> <opt name="internalCaptionField">FilterOurOrganisationText</opt> <opt name="internalVisibilityField">FilterOurOrganisationVisibility</opt> <opt name="value" bind="ordersAllFilter/button/ФильтрДокументНашаОрганизация"/> <opt name="caption" bind="ordersAllFilter/caption/ФильтрДокументНашаОрганизация"/> <opts name="resetValue" type="array"/> <opt name="resetVisibilityValue" type="boolean">false</opt> </opts> <opts> <opt name="internalValueField">FilterSpecificPerformer</opt> <opt name="internalCaptionField">FilterSpecificPerformerText</opt> <opt name="internalVisibilityField">FilterSpecificPerformerVisibility</opt> <opt name="value" bind="ordersAllFilter/button/ФильтрКонкретныйИсполнитель" nonexistent="Все"/> <opt name="resetValue">Все</opt> <opt name="resetVisibilityValue" type="boolean">false</opt> </opts> </options> </option> </component> <component data-component="SBIS3.EDO2.OpenDialogAction"> <option name="name">OrdersAction</option> <option name="editMode">newFloatArea</option> <option name="objectName">Приказ</option> <option name="initializingWay" value="delayedRemote"/> </component> ');return!0===e.useAutoRefresh&&(a+=' <component data-component="SBIS3.EDO.FEdoPartialReloader" name="PartialReloader"> <opt name="objectName" value="'+t(n(e.objectName||"Приказ"))+'"/> <opt name="method" value="'+t(n(e.method||"СписокВнутренних"))+'"/> <opt name="filterName" value="'+t(n(e.partialReloader.filterName||"СписокИдО"))+'"/> <opt name="sortField" value="'+t(n(e.partialReloader.sortField||"Дата"))+'"/> <opt name="overrideItemsSortMethod" value="true"/> <opt name="updateOnDeleteAndAdd" value="'+t(n(e.partialReloader.updateOnDeleteAndAdd||"false"))+'"/> <opt name="addServerChannelName" value="'+t(n(e.partialReloader.addServerChannelName||""))+'"/> <opt name="fixServerChannelName" value="'+t(n(e.partialReloader.fixServerChannelName||""))+'"/> <opt name="deleteServerChannelName" value="'+t(n(e.partialReloader.deleteServerChannelName||""))+'"/> <opts name="actionEventsToListen" type="array"> <opt value="onUpdateModel"/> ',e.partialReloader.onDestroyModelHandlingEnable&&(a+=' <opt value="onDestroyModel"/> '),a+=" ",e.partialReloader.onCreateModelHandlingEnable&&(a+=' <opt value="onCreateModel"/> '),a+=' </opts> <opt name="edoOpenDialogAction" value="OrdersAction"/> <opt name="complexKeyField" value="@Документ"/> </component> '),a+=" </div>",(a=t(a))+(i&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.Orders"}},e});
define("tmpl!SBIS3.EDO.Orders/resources/tmpl/DateColumnTemplate",["Core/tmpl/js/tclosure"],function(){var e=Array.prototype.slice.call(arguments),r=e[0],t={},o=function e(o,n,l,i,a){function s(){}var d=0,u=void 0!==r&&r?r:arguments[arguments.length-1];void 0===u&&(eval("var thelpers = null;"),u=global.requirejs("View/Runner/tclosure"));var c={};a&&a.isSetts&&(c=a.fullContext||{});var m="string"==typeof l?l:"",p=void 0===t?void 0:t,v={id:[],def:void 0},f=u.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),h=this&&this.includedTemplates?this.includedTemplates:{},g=u.getMarkupGenerator(i);try{var y=g.joinElements([g.createTag("div",{},[g.createControl("resolver",u.getter(o,["included","edoDateNumberColumn"]),{showNumber:!1,showYear:!1,item:u.getter(o,["item"]),ladder:u.getter(o,["ladder"])},{},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:f},l,p,h,u.config,c,v)],n,v,this)],m,v);v.def&&(y=g.chain(y,v,n),v=void 0)}catch(e){u.templateError("resources/Orders/components/Orders/resources/tmpl/DateColumnTemplate.tmpl",e,o)}return y||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.Orders/resources/tmpl/DateColumnTemplate"}},o});
define('js!SBIS3.EDO.OrdersHandlers',['i18n!SBIS3.EDO.OrdersHandlers','Orders_localization'],function(){return{setPrintColumns:function(e){e.setResult([{field:'Дата',title:rk('Дата')},{field:'Номер',title:rk('Номер')},{field:'РазличныеДокументы.Информация',title:rk('Описание')},{field:'Сотрудник.Название',title:rk('Ответственный')}]);}};});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.Orders", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".Orders.edo-Browser .controls-Browser__view table.controls-DataGridView__table{table-layout:fixed}.Orders .edo-Browser-date-number-mark-dot{right:-5px}.Orders .controls-ListView__item-type-hidden .controls-TreeView__expand{display:none}.Orders .edo-tasks__fastDataFilter{margin-right:4px}.Orders .edo-Browser-main .edo-Browser-main-comment4{white-space:nowrap;text-overflow:ellipsis}.Orders_columnValue{padding-top:5px!important}#container,#contentArea{height:100%!important}.Orders,.Orders .edo-Browser__scroll-container,.Orders_orderTabs,.Orders_tabs{height:100%;max-height:100%}.Orders,.Orders_orderTabs,.Orders_stat,.Orders_statInProcess,.Orders_tabs{min-height:0}.ws-is-webkit .Orders_orderTabs .edo-LazyLinkedDocs__scroll-container,.ws-is-webkit .Orders_orderTabs .edo-StatEdoBrowser-scrollContainer{height:calc(100% - 110px)!important}.Orders_orderTabs .edo-LazyLinkedDocs__scroll-container{max-height:100%}.Orders_orderTabs-addBtn,.Orders_orderTabs-exportBtn{display:block;float:left}.Orders_orderTabs .Orders_orderTabs-exportBtn{margin-left:12px}"));head.appendChild(style);});}
define('js!SBIS3.EDO.Orders',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.Orders','preload!js!SBIS3.EDO.FOrder','WS.Data/Di','js!SBIS3.EDO.FOrderModel','js!SBIS3.EDO.EdoCommon','tmpl!SBIS3.EDO2.Browser/resources/columns/tmpl/DateNumberColumn','tmpl!SBIS3.EDO2.Browser/resources/columns/tmpl/MainInfoColumn','tmpl!SBIS3.EDO2.Browser/resources/columns/tmpl/ResponsibleColumn','tmpl!SBIS3.EDO2.Browser/resources/columns/tmpl/StateColumn','tmpl!SBIS3.EDO.Orders/resources/tmpl/DateColumnTemplate','js!SBIS3.EDO.EdoRecOptions','css!SBIS3.PersonCore.Photo','js!SBIS3.PersonCore.MiniCard','js!SBIS3.EDO.OrdersHandlers','js!SBIS3.EDO.EdoClicks','js!SBIS3.EDO2.Browser','css!SBIS3.EDO.Orders','js!SBIS3.EDO2.OpenDialogAction','js!SBIS3.EDO.FEdoPartialReloader','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterResp','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterListDispatch','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterEventPerformer','tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterStateListItem','js!SBIS3.EDO2.MarksFilterRowTemplate','js!SBIS3.EDO.FilterOrdersTpl','js!SBIS3.EDO.FilterOrdersAddTpl','i18n!SBIS3.EDO.Orders','Orders_localization'],function(e,t,s,r,l){var o=e.extend({_dotTplFn:t,$protected:{_options:{fastDataFilterConfig:{data:[{keyField:'key',displayField:'title',name:'FilterShortState',multiselect:false,className:'controls-DropdownList__withoutCross controls-DropdownList__linkStyle',itemContentTpl:'tmpl!SBIS3.EDO.BaseFiltersStyles/FtplFilterStateListItem',showSelectedInList:true,values:[{key:'-1',title:rk('В любом состоянии')},{key:'4',title:rk('В обработке')},{key:'1',title:rk('Завершенные')},{key:'2',title:rk('Завершенные положительно'),listTitle:rk('положительно')},{key:'3',title:rk('Завершенные отрицательно'),listTitle:rk('отрицательно')},{key:'5',title:rk('Черновики')}]}]}}},$constructor:function(){r.register('SBIS3.EDO.FOrderModel',l);},init:function(){o.superclass.init.call(this);var e=this,t=this.getChildControlByName('browserFastDataFilter');if(t)t.setItems(this._options.fastDataFilterConfig.data);e.getChildControlByName('Orders').getView().once('onItemsReady',function(){s();});}});return o;});
define('js!SBIS3.EDO.OrderTabs',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.OrderTabs','js!SBIS3.EDO.EdoCommon','browser!js!SBIS3.EDO.EDONavigationHandlers','js!SBIS3.EDO.Orders','js!SBIS3.EDO.StatTemplateNew','js!SBIS3.Engine.BrowserTabs','js!SBIS3.EDO.FTaskButtons','js!SBIS3.EDO2.ExportButton','i18n!SBIS3.EDO.OrderTabs','SBIS3.CONTROLS/Button','Orders_localization'],function(t,s,n){var e=t.extend({_dotTplFn:s,$protected:{_options:{onlyList:false}},$constructor:function(t){this._options.onlyList=t.onlyList||this._options.onlyList;},init:function(){e.superclass.init.call(this);},onTabAndMainLoaded:function(t,s){if('ListTab'==s)n.initTaskButtons({mainObject:this.getCurrentTabArea('main'),tabsObject:this.getCurrentTabArea('tabs'),btnDocName:'AddOrder',brwName:'Orders',actionName:'OrdersAction'});},onTabChange:function(t,s){var n=this;switch(s){case'StatTab':case'ProcessTab':n.setOperationsButtonVisibility(false);break;default:n.setOperationsButtonVisibility(true);}}});return e;});
define('js!SBIS3.EDO.RegulationsConfigHandler',['Lib/Control/Control','Deprecated/BLObject','Deprecated/helpers/transport-helpers','Core/EventBus','Core/core-merge','Reglamenty_localization'],function(e,t,a,n,o){var i={onRegulationNavigate:function(n,i,r,l){if(-1===r.indexOf('regulations')&&-1===r.indexOf('dt_number_settings')&&'func_roles'!==r)return;var d=e.ControlStorage.getByName('nav-acc-tpl-area'),u,s,c,f,g,C;d.waitChildControlByName('Шаблон кнопок').addCallback(function(n){return u=n,d.waitChildControlByName('ШаблонБраузеров').addCallback(function(n){if(s=n,c=s.getCurrentTemplateName(),-1!==r.indexOf('regulations')){g='',f='js!SBIS3.RULE.ConfigurationConstructor';var i={},d={idProperty:'Идентификатор',endpoint:'RegulationNew',binding:{query:'StdList',read:'Read',create:'Create',destroy:'Delete',update:'Write'}};if(i.dataSource=o(d,l.dataSource||{}),c!==f)requirejs(['js!SBIS3.RULE.ConfigurationBLHelper'],function(e){e.getDataForConfiguration(l).addCallback(function(e){i.modelData=e,u.setTemplate(g),s.setTemplate(f,i),u.show(),s.show();});});e.ControlStorage.waitChildByName('ConfigurationConstructor').addCallback(function(e){if(e){var t=l['ТипДокумента'],a=l['ПодТипДокумента'];if(t+(a?':'+a:'')!==e.getModelField('docTypesString')[0])requirejs(['js!SBIS3.RULE.ConfigurationBLHelper'],function(t){t.getDataForConfiguration(l).addCallback(function(t){e.setModelData(t.getRawData());});});}});}else if('func_roles'===r){if(g='',f='js!SBIS3.RULE.FuncRolesList',c!==f)u.setTemplate(g),s.setTemplate(f),u.show(),s.show();}else if(-1!==r.indexOf('dt_number_settings'))if(g='',f='js!SBIS3.EDO.ConfigDocNumberTemplate',c!==f)a.newRecordSet('ТипДокумента','Найти',void 0,void 0,false).addCallback(function(e){e.setQuery({'ТипДокумента':l['ТипДокумента'],'ПодТипДокумента':l['ПодТипДокумента'],'Удален':false}).addCallback(function(a){if(a>0)new t('ШаблонНомера').call('ПолучитьШаблон',{'ТипДокумента':e.at(0).get('@ТипДокумента'),'Дата':new Date().toSQL()},t.RETURN_TYPE_RECORD).addCallback(function(t){if(t){var a=t.hasColumn('ОбщаяНумерация')?t.get('ОбщаяНумерация'):null,n={docType:l['ТипДокумента'],docSubType:l['ПодТипДокумента'],docTypeID:e.at(0).get('@ТипДокумента'),templateID:t.get('ИД'),templatePeriod:t.get('РезНачинатьСначала'),templatePattern:t.get('ПользовательскийВидШаблона'),templateType:a&&a.get('ТекстДляОтображения')?a:null};u.show(),s.show(),s.setTemplate(g),u.setTemplate(f,n);}});});});return n;}),n;});}};return n.channel('navigation').subscribe('onNavigate',i.onRegulationNavigate),i;});
define("html!SBIS3.EDO.ConfigDocNumberTemplate",function(){var o=function(o){var e=function(){var o={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},e=/&(?!#?\w+;)|<|>|"|'|\//g;return function(n){return n?n.toString().replace(e,function(e){return o[e]||e}):n}}(),n=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(e){for(;o.test(e);)e=e.replace(o,"&#123;&#123;$1&#125;&#125;");return e}}(),t=function(o){return o.join?o.join(""):o.toString()},i=function(o){return void 0===o?"":o&&"object"==typeof o?t(o):""+o},p="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="edo-ConfigDocNumberTemplate"> <div class="edo-ConfigDocNumberTemplate_content"> <div class="edo-ConfigDocNumberTemplate_div_help"> <div class="edo-ConfigDocNumberTemplate_help"> <div> '+n(i(rk("Шаблон состоит из")))+' <span class="edo-ConfigDocNumberTemplate_helpLink">'+n(i(rk("{Служебных слов}")))+"</span> <br/> "+n(i(rk("и произвольных символов.")))+' </div> <div class="edo-ConfigDocNumberTemplate_upMargin"> <span class="edo-ConfigDocNumberTemplate_helpLink">'+n(i(rk("{Служебные слова}")))+"</span> "+n(i(rk("заменяются")))+" <br/> "+n(i(rk("данными, другие символы остаются")))+" <br/> "+n(i(rk("неизменными.")))+' </div> <div class="edo-ConfigDocNumberTemplate_upMargin"> '+n(i(rk("Например, по шаблону")))+" <br/> "+n(i(rk("ВК_")))+'<span class="edo-ConfigDocNumberTemplate_helpLink">'+n(i(rk("{Месяц}")))+"</span>"+n(i(rk("/")))+'<span class="edo-ConfigDocNumberTemplate_helpLink">'+n(i(rk("{Номер}")))+"</span> <br/> "+n(i(rk("номера документов будут")))+" <br/> "+n(i(rk("ВК_08/123, ВК_08/124 и т.д.")))+' </div> </div> </div> <div class="edo-ConfigDocNumberTemplate_div_content"> <div class="edo-ConfigDocNumberTemplate_margin"> <div class="edo-ConfigDocNumberTemplate_captionText"> '+n(i(rk("Шаблон формирования номера документов")))+" </div> ");return o.templateType&&(a+=' <div class="edo-ConfigDocNumberTemplate_upMargin"> <div> <span class="edo-ConfigDocNumberTemplate_line"> '+n(i(e(o.templateType.get("Название"))))+' </span> <component data-component="SBIS3.CONTROLS/DropdownList" name="ddType" class="controls-DropdownList__withoutCross" data-access="Регламенты"> <option name="keyField">key</option> <option name="displayField">title</option> <option name="itemTpl">html!SBIS3.EDO.ConfigDocNumberTemplate/resources/typeTemplate</option> <option name="mode">click</option> <option name="multiselect">false</option> <options name="handlers"> <option name="onInit" type="function">js!SBIS3.EDO.ConfigDocNumberTemplate:prototype.onInitDdType</option> </options> </component> </div> </div> '),a+=' <div class="edo-ConfigDocNumberTemplate_upMargin edo-ConfigDocNumberTemplate_line"> <div class="edo-ConfigDocNumberTemplate_line_preview"> <component data-component="SBIS3.CONTROLS/TextBox" name="tbPreview" class="edo-ConfigDocNumberTemplate_line_preview_field"> <option name="text" bind="docNumberTemplate_Preview" oneWay="true" direction="fromContext"></option> <option name="enabled">false</option> <option name="allowChangeEnable">false</option> </component> <div class="edo-ConfigDocNumberTemplate_symbolNumber">'+n(i(rk("№")))+'</div> <div class="icon-16 icon-TFFollow icon-disabled edo-ConfigDocNumberTemplate_arrow"></div> </div> <div class="edo-ConfigDocNumberTemplate_line_field"> <component data-component="SBIS3.EDO.NumberTemplateRichArea" name="tbTemplate" class="edo-ConfigDocNumberTemplate_template_field"> <options name="validators" type="array"> <options> <option name="validator" type="function">js!SBIS3.EDO.ConfigDocNumberTemplate:prototype.validatorTemplate</option> </options> </options> <options name="handlers"> <option name="onInit" type="function">js!SBIS3.EDO.ConfigDocNumberTemplate:prototype.onInitRichArea</option> <option name="onTextChange" type="function">js!SBIS3.EDO.ConfigDocNumberTemplate:prototype.onTextChangeRichArea</option> <option name="onFocusOut" type="function">js!SBIS3.EDO.ConfigDocNumberTemplate:prototype.onFocusOutRichArea</option> </options> </component> </div> </div> </div> <div class="edo-ConfigDocNumberTemplate_upMargin "> <component data-component="SBIS3.CONTROLS/DataGridView" name="dgFunctionWords" class="edo-ConfigDocNumberTemplate_words_list controls-ListView__withoutMarker controls-ListView__hideCheckBoxes" data-access="Регламенты"> <option name="notSaveTemplate">true</option> <option name="displayField">text</option> <option name="keyField">id</option> <options name="columns" type="array"> <options> <option name="cellTemplate">html!SBIS3.EDO.ConfigDocNumberTemplate/resources/functionWordsCellTemplate</option> </options> </options> <options name="items" type="array"> <options> <option name="id" value="number"></option> <option name="title" value="{Номер}"></option> <option name="text" value="Номер по порядку, начинать сначала"></option> <option name="content"> <component data-component="SBIS3.CONTROLS/DropdownList" name="ddPeriod" class="controls-DropdownList__withoutCross" data-access="Регламенты"> <option name="keyField">key</option> <option name="displayField">title</option> <option name="mode">click</option> <option name="multiselect">false</option> <options name="handlers"> <option name="onInit" type="function">js!SBIS3.EDO.ConfigDocNumberTemplate:prototype.onInitDdPeriod</option> </options> </component> </option> </options> <options> <option name="id" value="day"></option> <option name="title" value="{День}"></option> <option name="text" value="День из даты документа"></option> </options> <options> <option name="id" value="month"></option> <option name="title" value="{Месяц}"></option> <option name="text" value="Месяц из даты документа, например, 08"></option> </options> <options> <option name="id" value="year"></option> <option name="title" value="{Год}"></option> <option name="text" value="Год из даты документа, например, 2016"></option> </options> <options> <option name="id" value="yearbrief"></option> <option name="title" value="{ГодКратко}"></option> <option name="text" value="Две последние цифры года, например, 16"></option> </options> <options> <option name="id" value="prefix"></option> <option name="title" value="{Префикс}"></option> <option name="text" value="Краткое обозначение нашей организации"></option> <option name="hint" value=\'Префиксы используются для того, чтобы исключить дублирование номеров в документах, выписанных от разных наших организаций. Например, указав для одной организации префикс &quot;Ф&quot;, а для другой &quot;Т&quot;, номера документов будут &quot;Ф123&quot;, &quot;Т123&quot;.\'></option> </options> </options> <options name="itemsActions" type="array"> </options> <option name="itemsDragNDrop" value=""></option> <option name="editArrow">false</option> <option name="allowEnterToFolder">false</option> <option name="ignoreLocalPageSize">true</option> <option name="expand">false</option> <option name="multiselect">false</option> <option name="showHead">false</option> <option name="pageSize">25</option> <option name="showPaging">false</option> <option name="infiniteScroll">down</option> <option name="tabindex">2</option> <options name="handlers"> <option name="onItemActivate" type="function">js!SBIS3.EDO.ConfigDocNumberTemplate:prototype.onItemActivateFunctionWords</option> </options> </component> </div> </div> <div> <component data-component="SBIS3.CONTROLS/Link" name="linkAddPrefix" class="edo-ConfigDocNumberTemplate_prefix_add" data-access="Регламенты"> <option name="caption">Указать префиксы...</option> <options name="handlers"> <option name="onActivated" type="function">js!SBIS3.EDO.ConfigDocNumberTemplate:prototype.linkAddPrefix</option> </options> <option name="visible">true</option> </component> </div> <div> <component data-component="SBIS3.CONTROLS/Tree/DataGridView" name="tdPrefixList" class="ws-hidden edo-ConfigDocNumberTemplate_prefix_list controls-ListView__bottomStyle" data-access="Регламенты"> <option name="displayField">Название</option> <option name="keyField">@Лицо</option> <option name="hierField">Раздел</option> <option name="emptyHTML">Нет записей</option> <options name="filter"> <option name="Действующие">true</option> <option name="Префикс">true</option> <option name="ShowInnerCompany">true</option> </options> <options name="columns" type="array"> <options> <option name="cellTemplate">html!SBIS3.EDO.ConfigDocNumberTemplate/resources/prefixCellTemplate</option> </options> </options> <option name="editMode">click|toolbar</option> <option name="editingTemplate"> <div> <component data-component="SBIS3.CONTROLS/TextBox" name="tbPrefix" class="edo-ConfigDocNumberTemplate_prefix_editor" data-access="Регламенты"> <option name="text" bind="НашаОрганизация.Префикс"></option> <option name="maxLength">256</option> </component> </div> </option> <options name="itemsActions" type="array"> </options> <option name="itemsDragNDrop" value=""></option> <option name="editArrow">false</option> <option name="allowEnterToFolder">false</option> <option name="ignoreLocalPageSize">true</option> <option name="expand">false</option> <option name="multiselect">false</option> <option name="showHead">false</option> <option name="pageSize">3</option> <option name="showPaging">false</option> <option name="infiniteScroll"></option> <option name="tabindex">2</option> <option name="visible">false</option> <option name="footerTpl">html!SBIS3.EDO.ConfigDocNumberTemplate/resources/footerTemplate</option> <options name="handlers"> <option name="onDataLoad" type="function">js!SBIS3.EDO.ConfigDocNumberTemplate:prototype.onDataLoadPrefixList</option> <option name="onEndEdit" type="function">js!SBIS3.EDO.ConfigDocNumberTemplate:prototype.onEndEditPrefixList</option> </options> </component> </div> </div> </div>',(a=n(a))+(p&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.ConfigDocNumberTemplate"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.ConfigDocNumberTemplate", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-ConfigDocNumberTemplate{color:#000;font-size:14px;margin-top:3px}.edo-ConfigDocNumberTemplate_div_content{margin:0 282px 0 0}.edo-ConfigDocNumberTemplate_captionText{color:#313e78;font-size:18px;font-weight:700}.edo-ConfigDocNumberTemplate_infoText{color:#999;font-size:12px}.edo-ConfigDocNumberTemplate_prefix_addFooter{margin-left:28px;font-size:12px}.edo-ConfigDocNumberTemplate_margin{margin-left:8px}.edo-ConfigDocNumberTemplate_upMargin{margin-top:8px}.edo-ConfigDocNumberTemplate_words_list{padding-bottom:0!important}.edo-ConfigDocNumberTemplate_rowWords{width:100%}.edo-ConfigDocNumberTemplate_rowWords_link{float:left;width:79px;vertical-align:top;margin-left:5px;color:#05b;line-height:24px}.edo-ConfigDocNumberTemplate_rowWords_content{margin:0 0 0 86px}.edo-ConfigDocNumberTemplate_rowWords_text{float:left;line-height:24px}.edo-ConfigDocNumberTemplate_rowWords_menu{float:left;margin-left:4px}.edo-ConfigDocNumberTemplate_rowWords_hint{color:#999;font-size:12px;clear:both;line-height:15px}.edo-ConfigDocNumberTemplate_prefix_add{margin-left:93px}.edo-ConfigDocNumberTemplate_line{height:24px;line-height:24px;width:100%}.edo-ConfigDocNumberTemplate_line_preview{float:right}.edo-ConfigDocNumberTemplate_float{float:left}.edo-ConfigDocNumberTemplate_line_preview_field{float:right}.edo-ConfigDocNumberTemplate_line_field{height:24px}.edo-ConfigDocNumberTemplate_symbolNumber{color:#999;font-size:14px;float:right;margin:0 8px 0 4px;height:24px;line-height:24px}.edo-ConfigDocNumberTemplate_arrow{height:24px;line-height:24px!important;float:right;margin-left:8px}.edo-ConfigDocNumberTemplate_div_help{float:right}.edo-ConfigDocNumberTemplate_help{background-color:#f9f9f9;padding:16px;width:234px;margin:0 8px 8px 8px}.edo-ConfigDocNumberTemplate_helpLink{color:#05b;font-size:13px}.edo-ConfigDocNumberTemplate_prefix_list{margin:8px 0 0 93px;padding-bottom:16px!important}.edo-ConfigDocNumberTemplate_rowPrefix{width:100%;height:24px;line-height:24px}.edo-ConfigDocNumberTemplate_rowPrefix_prefix{float:left;width:74px;padding-right:4px}.edo-ConfigDocNumberTemplate_rowPrefix_name{margin:0 0 0 82px}.edo-ConfigDocNumberTemplate_rowPrefix_nowrap_main{overflow:hidden;white-space:nowrap;padding-left:4px;font-size:14px}.edo-ConfigDocNumberTemplate_rowPrefix_nowrap_main_node{overflow:hidden;white-space:nowrap;padding-left:4px;font-size:14px}.edo-ConfigDocNumberTemplate_prefix_editor{width:78px;margin-top:1px;margin-left:5px}.edo-ConfigDocNumberTemplate_rowPrefix_nowrap{overflow:hidden;white-space:nowrap;padding-left:4px;font-size:14px}.controls-ListView__hoveredItem .edo-ConfigDocNumberTemplate_rowPrefix_nowrap{padding-left:3px}.controls-ListView__hoveredItem .edo-ConfigDocNumberTemplate_rowPrefix_prefix{border-width:1px;border-style:solid;border-color:#ccc;background:#fff;height:22px;line-height:22px;width:72px}.controls-ItemActions__activeItem .edo-ConfigDocNumberTemplate_rowPrefix_prefix:after,.controls-ListView__hoveredItem .edo-ConfigDocNumberTemplate_rowPrefix_prefix:after{background:-moz-linear-gradient(left,rgba(255,255,255,0) 0,#f0f5fb 100%);background:-webkit-gradient(linear,left top,right top,color-stop(0,rgba(255,255,255,0)),color-stop(100%,#f0f5fb));background:-webkit-linear-gradient(left,rgba(255,255,255,0) 0,#f0f5fb 100%);background:-o-linear-gradient(left,rgba(255,255,255,0) 0,#f0f5fb 100%);background:-ms-linear-gradient(left,rgba(255,255,255,0) 0,rgba(240,245,251,1) 100%);background:linear-gradient(to right,rgba(255,255,255,0) 0,rgba(240,245,251,1) 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#00ffffff', endColorstr='#F0F5FB', GradientType=1)}.edo-ConfigDocNumberTemplate_gradient{float:right;position:relative}.controls-ItemActions__activeItem .edo-ConfigDocNumberTemplate_gradient:after,.controls-editInPlace__editing .edo-ConfigDocNumberTemplate_gradient:after{background:-moz-linear-gradient(left,rgba(255,255,255,0) 0,#f3f3f3 100%);background:-webkit-gradient(linear,left top,right top,color-stop(0,rgba(255,255,255,0)),color-stop(100%,#f3f3f3));background:-webkit-linear-gradient(left,rgba(255,255,255,0) 0,#f3f3f3 100%);background:-o-linear-gradient(left,rgba(255,255,255,0) 0,#f3f3f3 100%);background:-ms-linear-gradient(left,rgba(255,255,255,0) 0,rgba(243,243,243,1) 100%);background:linear-gradient(to right,rgba(255,255,255,0) 0,rgba(243,243,243,1) 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#00ffffff', endColorstr='#F3F3F3', GradientType=1)}.controls-ItemActions__activeItem .edo-ConfigDocNumberTemplate_gradient:after,.controls-ListView__hoveredItem .edo-ConfigDocNumberTemplate_gradient:after{background:-moz-linear-gradient(left,rgba(255,255,255,0) 0,#f0f5fb 100%);background:-webkit-gradient(linear,left top,right top,color-stop(0,rgba(255,255,255,0)),color-stop(100%,#f0f5fb));background:-webkit-linear-gradient(left,rgba(255,255,255,0) 0,#f0f5fb 100%);background:-o-linear-gradient(left,rgba(255,255,255,0) 0,#f0f5fb 100%);background:-ms-linear-gradient(left,rgba(255,255,255,0) 0,rgba(240,245,251,1) 100%);background:linear-gradient(to right,rgba(255,255,255,0) 0,rgba(240,245,251,1) 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#00ffffff', endColorstr='#F0F5FB', GradientType=1)}.edo-ConfigDocNumberTemplate_gradient:after{content:\"\\00a0\";box-sizing:content-box;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;position:absolute;width:48px;right:0;z-index:1;text-align:right;background-size:100% 100%;background:-moz-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,1) 100%);background:-webkit-gradient(linear,left top,right top,color-stop(0,rgba(255,255,255,0)),color-stop(100%,rgba(255,255,255,1)));background:-webkit-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,1) 100%);background:-o-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,1) 100%);background:-ms-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,1) 100%);background:linear-gradient(to right,rgba(255,255,255,0) 0,rgba(255,255,255,1) 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#00ffffff', endColorstr='#ffffff', GradientType=1)}.edo-ConfigDocNumberTemplate_gradient_edit{float:right;position:relative}.controls-ItemActions__activeItem .edo-ConfigDocNumberTemplate_gradient_edit:after,.controls-editInPlace__editing .edo-ConfigDocNumberTemplate_gradient_edit:after{display:none}.controls-ItemActions__activeItem .edo-ConfigDocNumberTemplate_gradient_edit:after,.controls-ListView__hoveredItem .edo-ConfigDocNumberTemplate_gradient_edit:after{display:none}.edo-ConfigDocNumberTemplate_gradient_edit:after{content:\"\\00a0\";box-sizing:content-box;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;position:absolute;width:32px;right:0;z-index:1;text-align:right;background-size:100% 100%;background:-moz-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,1) 100%);background:-webkit-gradient(linear,left top,right top,color-stop(0,rgba(255,255,255,0)),color-stop(100%,rgba(255,255,255,1)));background:-webkit-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,1) 100%);background:-o-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,1) 100%);background:-ms-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,1) 100%);background:linear-gradient(to right,rgba(255,255,255,0) 0,rgba(255,255,255,1) 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#00ffffff', endColorstr='#ffffff', GradientType=1)}.edo-ConfigDocNumberTemplate_typeTemplate_title{width:200px}.edo-ConfigDocNumberTemplate_typeTemplate_help{font-size:12px;color:#999;padding:3px 0}"));head.appendChild(style);});}
define("tmpl!SBIS3.EDO.NumberTemplateRichArea",["Core/tmpl/js/tclosure"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={},a=function e(a,i,l,s,n){function o(){}var c=0,d=void 0!==t&&t?t:arguments[arguments.length-1];void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure"));var p={};n&&n.isSetts&&(p=n.fullContext||{});var g="string"==typeof l?l:"",h=void 0===r?void 0:r,m={id:[],def:void 0},u=d.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,a),v=this&&this.includedTemplates?this.includedTemplates:{},f=d.getMarkupGenerator(s);try{var x=f.joinElements([f.createTag("div",{class:"controls-RichEditor"},[f.createTag("div",{class:"edo-NumberTemplateRichArea_dataReview controls-RichEditor__dataReview ws-basic-style"+d.wrapUndef(d.utils.escape(d.getter(a,["enabled"])?" ws-hidden":"")),tabindex:"1",style:d.wrapUndef(d.utils.escape(d.getter(a,["autoHeight"])&&d.getter(a,["minimalHeight"])?"min-height:"+d.getter(a,["minimalHeight"])+"px;":""))+" "+d.wrapUndef(d.utils.escape(d.getter(a,["autoHeight"])&&d.getter(a,["maximalHeight"])?"max-height:"+d.getter(a,["maximalHeight"])+"px;":""))},[f.createText(""+d.wrapUndef(d.Sanitize.apply(void 0,[!d.getter(a,["enabled"])&&d.getter(a,["text"])?d.getDecorators().sanitize.apply(void 0,[d.getter(a,["_prepareReviewContent"]).apply(a,[d.getter(a,["text"])])]):""])))],{},m,this),f.createTag("div",{class:"controls-RichEditor__placeholder"},[f.createText(""+d.wrapUndef(d.utils.escape(d.getter(a,["placeholder"]))))],{},m,this),f.createTag("h6",{class:"edo-NumberTemplateRichArea_editorFrame controls-RichEditor__editorFrame ws-basic-style "+d.wrapUndef(d.utils.escape(d.getter(a,["enabled"])?"":" ws-hidden")),style:d.wrapUndef(d.utils.escape(d.getter(a,["autoHeight"])&&d.getter(a,["minimalHeight"])?"min-height:"+d.getter(a,["minimalHeight"])+"px;":""))+" "+d.wrapUndef(d.utils.escape(d.getter(a,["autoHeight"])&&d.getter(a,["maximalHeight"])?"max-height:"+d.getter(a,["maximalHeight"])+"px;":""))},[f.createText(""+d.wrapUndef(d.Sanitize.apply(void 0,[d.getter(a,["enabled"])&&d.getter(a,["text"])?d.getDecorators().sanitize.apply(void 0,[d.getter(a,["_prepareContent"]).apply(a,[d.getter(a,["_prepareReviewContent"]).apply(a,[d.getter(a,["text"])])])]):""])))],{},m,this),f.createTag("textarea",{class:"controls-RichEditor__fakeArea",tabindex:"0"},[],{},m,this),f.createTag("div",{class:"controls-RichEditor__sourceContainer ws-hidden"},[f.createTag("textarea",{class:"controls-RichEditor__sourceArea"},[],{},m,this)],{},m,this)],i,m,this)],g,m);m.def&&(x=f.chain(x,m,i),m=void 0)}catch(e){d.templateError("resources/Reglamenty/Tipy_dokumentov/ConfigDocNumberTemplate/NumberTemplateRichArea/NumberTemplateRichArea.tmpl",e,a)}return x||""};return a.includedFunctions={},a.stable=!0,a.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.NumberTemplateRichArea"}},a});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.NumberTemplateRichArea", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-NumberTemplateRichArea_editorFrame{white-space:nowrap!important;overflow:hidden!important;font-size:14px;font-weight:400;font-style:normal;color:#000;padding:0 4px!important;line-height:20px!important;height:24px!important}.edo-NumberTemplateRichArea_dataReview{height:24px!important}.edo-NumberTemplateRichArea_dataReview p{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;margin-right:0!important}"));head.appendChild(style);});}
define('js!SBIS3.EDO.NumberTemplateRichArea',['SBIS3.CONTROLS/RichEditor/Components/RichTextArea','tmpl!SBIS3.EDO.NumberTemplateRichArea','css!SBIS3.CORE.RichContentStyles','css!SBIS3.EDO.NumberTemplateRichArea','Reglamenty_localization'],function(t,e){var s=t.extend({_dotTplFn:e,$protected:{_options:{editorConfig:{plugins:'paste',entity_encoding:'raw'}}},_lastCursorPosition:0,$constructor:function(){},init:function(){s.superclass.init.call(this);},getLastCursorPosition:function(){return this._lastCursorPosition;},setLastCursorPosition:function(t){this._lastCursorPosition=t;},setCursorPosition:function(t){var e=this.getTinyEditor(),s=e.getContent({format:'html'}),n=s.substr(0,t),i=s.substr(t),o=e.selection.getBookmark(0),r=n+('<span data-mce-type="bookmark" id="'+o.id+'_start" data-mce-style="overflow:hidden;line-height:0px" style="overflow:hidden;line-height:0px">&#65279;</span>')+i;return e.setContent(r,{format:'raw'}),e.selection.moveToBookmark(o),o;},getCursorPosition:function(t){var e=this.getTinyEditor(),s='[data-mce-type=bookmark]',n=e.dom.select(s),i='######cursor######',o='<span id="'+i+'"></span>',r=-1;if(n.length>0)e.selection.select(n[0]),e.selection.collapse(),e.selection.setContent(o),r=e.getContent({format:'html'}).indexOf(o),e.dom.remove(i,false);else r=this.getLastCursorPosition();return e.selection.moveToBookmark(t),r;},convertSpecialPhrases:function(t){var e=this,s=e.getTinyEditor(),n=s.getContent(),i=s.selection.getBookmark(0),o=e.getCursorPosition(i)||0,r=n.substring(0,o),a=e.getContentOrValueWithoutTags(r).length,l=e.getContentOrValueWithoutTags(n),u='',g=a,c='<span data-mce-type="bookmark" id="'+i.id+'_start" data-mce-style="overflow:hidden;line-height:0px" style="overflow:hidden;line-height:0px">&#65279;</span>',h=t.length,f=37,d=30;u=l;for(var p=0;p<h;p++){var m=0,C=true;while(C){var b=t[p],v=b.length,k=u.indexOf(b,m);if(-1===k)break;else{if(u=u.substr(0,k)+'<span style="color: #0055bb;">'+b+'</span>'+u.substr(k+v),k+v<g)g+=f;else if(k<=g)g+=d;m=k+f+v;}}}var u=u.substr(0,g)+c+u.substr(g);if(e.setLastCursorPosition(g),s.setContent(u,{format:'raw'}),g>=s.getContent().length)s.selection.select(s.getBody(),true),s.selection.collapse(false);else s.selection.moveToBookmark(i);},htmlUnescape:function(t){return t.replace(/&quot;/g,'"').replace(/&#39;/g,'\'').replace(/&lt;/g,'<').replace(/&gt;/g,'>').replace(/&amp;/g,'&');},getContentOrValueWithoutTags:function(t){if(void 0===t)return this.getTinyEditor().getContent().replace(/(\<(\/?[^>]+)>)/g,'');else return t.replace(/(\<(\/?[^>]+)>)/g,'');},dominationSelectedWord:function(t,e,s){var n=this.getContentOrValueWithoutTags();if(n&&t){var i=t.length,o=0;if(void 0!==e&&null!==e)o=e;else{var r=this.getTinyEditor(),a=r.selection.getBookmark(0),e=this.getCursorPosition(a)||0,l=r.getContent().substring(0,e);o=this.getContentOrValueWithoutTags(l).length;}if(s){var u=s.length;while(-1!==n.indexOf(s)){var g=n.indexOf(s);if(g>=o)n=n.substring(0,g)+n.substring(g+u);else if(g+u<=o)n=n.substring(0,g)+n.substring(g+u),o-=u;else if(g<o&&o<g+u)n=n.substring(0,g)+n.substring(g+u),o-=o-g;}}while(-1!==n.indexOf(t)){var c=n.indexOf(t);if(c>=o)n=n.substring(0,c)+n.substring(c+i);else if(c+i<=o)n=n.substring(0,c)+n.substring(c+i),o-=i;else if(c<o&&o<c+i)n=n.substring(0,c)+n.substring(c+i),o-=o-c;}n=n.substring(0,o)+t+n.substring(o),r.setContent(n),this.convertSpecialPhrases(['{Номер}','{День}','{Месяц}','{Год}','{ГодКратко}','{Префикс}']);var h=7,f=r.getContent().indexOf(t)+i+h;this.setCursorPosition(f);}}});return s;});
define("html!SBIS3.EDO.ConfigDocNumberTemplate/resources/functionWordsCellTemplate",function(){var e=function(e){var o=function(){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},o=/&(?!#?\w+;)|<|>|"|'|\//g;return function(r){return r?r.toString().replace(o,function(o){return e[o]||o}):r}}(),r=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(o){for(;e.test(o);)o=o.replace(e,"&#123;&#123;$1&#125;&#125;");return o}}(),t=function(e){return e.join?e.join(""):e.toString()},n=function(e){return void 0===e?"":e&&"object"==typeof e?t(e):""+e},i="undefined"!=typeof process,d=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="edo-ConfigDocNumberTemplate_rowWords"> <div class="edo-ConfigDocNumberTemplate_rowWords_link"> '+r(n(o(e.item.get("title"))))+' </div> <div class="edo-ConfigDocNumberTemplate_rowWords_content"> <div> <div class="edo-ConfigDocNumberTemplate_rowWords_text"> '+r(n(o(e.item.get("text"))))+" </div> "),u=e.item.get("content");d+=" ",u&&(d+=' <div class="edo-ConfigDocNumberTemplate_rowWords_menu"> '+r(n(u))+" </div> "),d+=" </div> ";var s=e.item.get("hint");return d+=" ",s&&(d+=' <div class="edo-ConfigDocNumberTemplate_rowWords_hint"> '+r(n(o(s)))+" </div> "),d+=" </div> </div>",(d=r(d))+(i&&-1!==d.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.ConfigDocNumberTemplate/resources/functionWordsCellTemplate"}},e});
define("html!SBIS3.EDO.ConfigDocNumberTemplate/resources/prefixCellTemplate",function(){var e=function(e){var r=function(){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},r=/&(?!#?\w+;)|<|>|"|'|\//g;return function(o){return o?o.toString().replace(r,function(r){return e[r]||r}):o}}(),o=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(r){for(;e.test(r);)r=r.replace(e,"&#123;&#123;$1&#125;&#125;");return r}}(),i=function(e){return e.join?e.join(""):e.toString()},n=function(e){return void 0===e?"":e&&"object"==typeof e?i(e):""+e},t="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="edo-ConfigDocNumberTemplate_rowPrefix"> '),d=e.item.get("НашаОрганизация.Префикс")||"",f=e.item.get("Название")||"";return a+=' <div class="edo-ConfigDocNumberTemplate_rowPrefix_prefix"> <div class="edo-ConfigDocNumberTemplate_gradient_edit"></div> <div class="edo-ConfigDocNumberTemplate_rowPrefix_nowrap"> '+o(n(r(d)))+' </div> </div> <div class="edo-ConfigDocNumberTemplate_rowPrefix_name" title="'+o(n(f))+'"> <div class="edo-ConfigDocNumberTemplate_gradient"></div> <div class="',e.isNode?a+="edo-ConfigDocNumberTemplate_rowPrefix_nowrap_main_node":a+="edo-ConfigDocNumberTemplate_rowPrefix_nowrap_main",a+='"> '+o(n(r(f)))+" </div> </div> </div>",(a=o(a))+(t&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.ConfigDocNumberTemplate/resources/prefixCellTemplate"}},e});
define("html!SBIS3.EDO.ConfigDocNumberTemplate/resources/footerTemplate",function(){var e=function(e){var o=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(o){for(;e.test(o);)o=o.replace(e,"&#123;&#123;$1&#125;&#125;");return o}}(),n="undefined"!=typeof process,r=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div> <component data-component="SBIS3.CONTROLS/Link" name="linkAddPrefixInFooter" class="edo-ConfigDocNumberTemplate_prefix_addFooter"> <option name="caption">Еще...</option> <options name="handlers"> <option name="onActivated" type="function">js!SBIS3.EDO.ConfigDocNumberTemplate:prototype.linkAddPrefix</option> </options> </component> </div>');return(r=o(r))+(n&&-1!==r.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.ConfigDocNumberTemplate/resources/footerTemplate"}},e});
define("html!SBIS3.EDO.ConfigDocNumberTemplate/resources/typeTemplate",function(){var e=function(e){var t=function(){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},t=/&(?!#?\w+;)|<|>|"|'|\//g;return function(r){return r?r.toString().replace(t,function(t){return e[t]||t}):r}}(),r=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;e.test(t);)t=t.replace(e,"&#123;&#123;$1&#125;&#125;");return t}}(),o=function(e){return e.join?e.join(""):e.toString()},n=function(e){return void 0===e?"":e&&"object"==typeof e?o(e):""+e},i="undefined"!=typeof process,l=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="edo-ConfigDocNumberTemplate_typeTemplate_title controls-DropdownList__item');return e.multiselect&&(l+=" controls-DropdownList__multiselect"),e.item.get("isEmptyValue")&&(l+=" controls-DropdownList__defaultItem"),e.item.get(e.hierField)&&(l+=" controls-DropdownList__child"),e.item.getId()===e.defaultId&&(l+=" controls-ListView__defaultItem"),l+='" data-hash="'+r(n(e.projItem.getHash()))+'" data-id="'+r(n(e.item.getId()))+'"> '+r(n(t(e.item.get(e.displayField))))+' <div class="edo-ConfigDocNumberTemplate_typeTemplate_help"> '+r(n(t(e.item.get("helpTextType"))))+" </div> </div>",(l=r(l))+(i&&-1!==l.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.ConfigDocNumberTemplate/resources/typeTemplate"}},e});
define('js!SBIS3.EDO.ConfigDocNumberTemplate',['Deprecated/BLObject','Deprecated/SerializatorSBIS','Deprecated/Record','Core/Indicator','Core/RightsManager','Deprecated/Enum','SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.ConfigDocNumberTemplate','SBIS3.CONTROLS/Utils/InformationPopupManager','Lib/Control/FloatArea/FloatArea','WS.Data/Source/Memory','WS.Data/Source/SbisService','WS.Data/Entity/Record','css!SBIS3.EDO.ConfigDocNumberTemplate','SBIS3.CONTROLS/DropdownList','SBIS3.CONTROLS/DataGridView','SBIS3.CONTROLS/Tree/DataGridView','SBIS3.CONTROLS/TextBox','SBIS3.CONTROLS/Link','SBIS3.CONTROLS/Panel','js!SBIS3.EDO.NumberTemplateRichArea','html!SBIS3.EDO.ConfigDocNumberTemplate/resources/functionWordsCellTemplate','html!SBIS3.EDO.ConfigDocNumberTemplate/resources/prefixCellTemplate','html!SBIS3.EDO.ConfigDocNumberTemplate/resources/footerTemplate','html!SBIS3.EDO.ConfigDocNumberTemplate/resources/typeTemplate','Reglamenty_localization'],function(e,t,i,a,o,n,r,l,s,u,m,d,c){var p={number:'{Номер}',day:'{День}',month:'{Месяц}',year:'{Год}',yearbrief:'{ГодКратко}',prefix:'{Префикс}'},g=[];for(var T in p)if(p.hasOwnProperty(T))g.push(p[T]);var f=r.extend({_dotTplFn:l,$protected:{_options:{autoHeight:true,autoWidth:true,docType:'',docSubType:'',docTypeID:null,templateID:null,templatePeriod:0,templatePattern:'',templateType:null}},_timeoutSave:null,_editTimeout:null,_maxPeriod:1,_prevTemplate:'',$constructor:function(){var e=this.getContext(),t=this._options;e.setValue('docNumberTemplate_ID',t.templateID),e.setValue('docNumberTemplate_Template',t.templatePattern),e.setValue('docNumberTemplate_Period',t.templatePeriod),e.setValue('docNumberTemplate_Type',t.templateType),e.setValue('docNumberTemplate_Preview',''),this._prevTemplate=t.templatePattern,this.setMaxPeriod(t.templatePattern);},init:function(){f.superclass.init.call(this);var e=this;e.subscribeTo(e,'onDestroy',function(t){clearTimeout(e._editTimeout),e.clearTimeoutSaveTemplate();}),e.calculateAndSetPageSize(),e.getChildControlByName('tdPrefixList').setDataSource(new d({endpoint:'НашаОрганизация',binding:{query:'ListWithPrefix',update:'Сохранить'}}),false);},calculateAndSetPageSize:function(){var e=this,t=e.getChildControlByName('tdPrefixList'),i=e.getContainer().find('.edo-ConfigDocNumberTemplate_div_content'),a=window.innerHeight,o=i.height()+24+16+44+12+8,n=a>=o?(a-o)/32|0:3;t.setPageSize(n&&n>3?n:3,true),t.subscribeOnceTo(t,'onDataLoad',function(e){t.setPageSize(15,true);});},setTimeoutSaveTemplate:function(){this.clearTimeoutSaveTemplate(),this._timeoutSave=setTimeout(function(){a.setMessage(rk('Сохранение'));},1000);},clearTimeoutSaveTemplate:function(){if(this._timeoutSave)clearTimeout(this._timeoutSave),a.hide();},getPreview:function(){var e=this.getChildControlByName('tbTemplate'),t=e.getContentOrValueWithoutTags(),i='';if(t)i=(i=(i=(i=(i=(i=(t=e.htmlUnescape(t)).replace(new RegExp('{Номер}','g'),'123')).replace(new RegExp('{День}','g'),'14')).replace(new RegExp('{Месяц}','g'),'08')).replace(new RegExp('{Год}','g'),'2016')).replace(new RegExp('{ГодКратко}','g'),'16')).replace(new RegExp('{Префикс}','g'),'Т');return i;},onInitDdType:function(e){var t=this,i=t.getParentByClass('SBIS3.EDO.ConfigDocNumberTemplate'),a=t.getLinkedContext(),o=a.getValue('docNumberTemplate_Type/ТекущееСостояние')||0,n=t.getParent()._options.docType,r=[{key:0,title:'независимая',helpTextType:a.getValue('docNumberTemplate_Type/ТекстДляОтображения/0')||''},{key:1,title:'с общим шаблоном',helpTextType:a.getValue('docNumberTemplate_Type/ТекстДляОтображения/1')||''},{key:2,title:'с общей нумерацией',helpTextType:a.getValue('docNumberTemplate_Type/ТекстДляОтображения/2')||''}],l=new m({data:r,idProperty:'key'});t.setDataSource(l),t.setSelectedKeys([o]),t._prevValue=o,t.subscribe('onSelectedItemsChange',function(e,o,r){var l=o[0],u;if(t._prevValue!==l)i.setTimeoutSaveTemplate(),(u=new c({adapter:'adapter.sbis',format:[{name:'@ШаблонНомера',type:'integer'},{name:'ТипРеестра',type:'string'},{name:'ТипыДокументов',type:'array',kind:'integer'}]})).set({'@ШаблонНомера':a.getValue('docNumberTemplate_ID'),'ТипРеестра':(0===l?n:'')+'__'+l,'ТипыДокументов':a.getValue('docNumberTemplate_Type/ТипыДокументов')}),new d({endpoint:'ШаблонНомера'}).call('Записать',{'Запись':u}).addCallback(function(e){t._prevValue=l,i.clearTimeoutSaveTemplate();}).addErrback(function(e){i.clearTimeoutSaveTemplate(),s.showMessageDialog({message:e,status:'error'});});});},onInitRichArea:function(e){var t=this,i=t.getParent(),a=i.getLinkedContext().getValue('docNumberTemplate_Template');t._prevPattern='',t._performByReady(function(){var e=t.getTinyEditor();e.focus(),t.insertHtml(a),e.on('blur',function(i){var a=e.selection.getBookmark(0),o=t.getCursorPosition(a);if(-1===t.getLastCursorPosition())t.setLastCursorPosition(e.getContent().length);else t.setLastCursorPosition(o);}.bind(t)),t.setEnabled(i.checkAccessToRegulations());}.bind(t,a));},onTextChangeRichArea:function(e,t){var i=this.getParent(),a=i.getChildControlByName('tbTemplate');if(this._prevPattern!==a.getContentOrValueWithoutTags())this._prevPattern=a.getContentOrValueWithoutTags(),clearTimeout(i._editTimeout),i._editTimeout=setTimeout(function(){var e=function(){a.convertSpecialPhrases(g),i.getLinkedContext().setValue('docNumberTemplate_Preview',i.getPreview());};if(a.getTinyEditor())e();else a.subscribeTo(a,'onInitEditor',function(t){e();});i.setMaxPeriod(a.getContentOrValueWithoutTags()),i.setPeriodItems();},250);},onFocusOutRichArea:function(a,o,n){if(!o){var r=this.getContentOrValueWithoutTags();if(n?!n._options.notSaveTemplate:true){this.setLastCursorPosition(-1);var l=this.getParent();if(this.validate()&&l._prevTemplate!==r){l.setTimeoutSaveTemplate(),r=this.htmlUnescape(r);var u=new i();u.addColumn('@ШаблонНомера',i.FIELD_TYPE_INTEGER),u.addColumn('Шаблон',i.FIELD_TYPE_STRING),u.set('@ШаблонНомера',l.getLinkedContext().getValue('docNumberTemplate_ID')),u.set('Шаблон',r),new e('ШаблонНомера').call('Записать',{'Запись':t.serialize(u)},e.RETURN_TYPE_ASIS).addCallback(function(e){l._prevTemplate=r,l.clearTimeoutSaveTemplate();}).addErrback(function(e){l.clearTimeoutSaveTemplate(),s.showMessageDialog({message:e,status:'error'});});}}}},validatorTemplate:function(){if(-1===this.getContentOrValueWithoutTags().indexOf('{Номер}'))return'Шаблон должен содержать служебное слово {Номер}';else return true;},onItemActivateFunctionWords:function(e,t){var i=this.getParent(),a,o,n,r,l,s,u,m,d;if(i.checkAccessToRegulations()){if(m=i.getChildControlByName('tbTemplate'),u=m.getTinyEditor(),d=t.id,l=p[d],o=m.getContentOrValueWithoutTags(),n=-1===o.indexOf(l),'year'===d&&n)n=-1===o.indexOf(p['yearbrief']);if('yearbrief'===d&&n)n=-1===o.indexOf(p['year']);if(n){if(a=m.getLastCursorPosition(),s=u.getContent(),a<0)a=s.length;if(s.length===a)u.setContent(s+l),m.convertSpecialPhrases(g),i.getLinkedContext().setValue('docNumberTemplate_Preview',i.getPreview()),m.setCursorPosition(u.getContent().length),i.setMaxPeriod(m.getContentOrValueWithoutTags()),i.setPeriodItems();else u.focus(),m.setCursorPosition(a),i.removeAndInsertFuncWord(),u.insertContent(l);}else{if(r=null,'year'===d)r=p['yearbrief'];if('yearbrief'===d)r=p['year'];i.removeAndInsertFuncWord(),m.dominationSelectedWord(l,null,r),i.getLinkedContext().setValue('docNumberTemplate_Preview',i.getPreview()),i.setMaxPeriod(m.getContentOrValueWithoutTags()),i.setPeriodItems();}}},removeAndInsertFuncWord:function(){var e=this.getChildControlByName('tbTemplate').getTinyEditor(),t=e.selection.selectedRange,i,a;if(!t)e.focus(),e.selection.select(e.getBody(),true),e.selection.collapse(false),t=e.selection.selectedRange;if(i=t.commonAncestorContainer,a=i.textContent,-1!==g.indexOf(a))e.dom.remove(i,false),e.insertContent(a);},linkAddPrefix:function(){var e=this,t=e.getParentByClass('SBIS3.EDO.ConfigDocNumberTemplate'),i=t.getChildControlByName('tdPrefixList');new u({opener:e,template:'js!SBIS3.EDO.EditPrefixDialog',isStack:true,handlers:{onAfterClose:function(){t.calculateAndSetPageSize(),i.reload();}}});},setMaxPeriod:function(e){if(-1!==e.indexOf('{День}'))this._maxPeriod=4;else if(-1!==e.indexOf('{Месяц}'))this._maxPeriod=3;else if(-1!==e.indexOf('{Год}')||-1!==e.indexOf('{ГодКратко}'))this._maxPeriod=1;else this._maxPeriod=1;},setPeriodItems:function(){var e=this.getChildControlByName('ddPeriod'),t=e.getItems(),i=this.getPeriodItems();if(t.getCount()!==i.length){var a=this._maxPeriod,o=e.getSelectedKeys()[0],n=o<a?a:o;e.setItems(i),e.setSelectedKeys([n]),e.setEnabled(4!==a);}},getPeriodItems:function(){for(var e=[{key:0,title:'никогда'},{key:1,title:'каждый год'},{key:2,title:'каждый квартал'},{key:3,title:'каждый месяц'},{key:4,title:'каждый день'}],t=[],i=this._maxPeriod;i<e.length;i++)t.push(e[i]);return t;},onInitDdPeriod:function(a){var o=this.getParentByClass('SBIS3.EDO.ConfigDocNumberTemplate'),r=o.getPeriodItems(),l=o._maxPeriod,u=this.getLinkedContext().getValue('docNumberTemplate_Period'),m=u<l?l:u;this.setItems(r),this.setSelectedKeys([m]),this._prevValue=m,this.setEnabled(4!==l),this.subscribe('onSelectedItemsChange',function(a,r,l){var u=r[0];if(this.getLinkedContext().getValue('docNumberTemplate_ID')&&this._prevValue!==r[0]){var m=this,d=new i(),c={0:'Никогда',1:'Каждый год',2:'Каждый квартал',3:'Каждый месяц',4:'Каждый день'};o.setTimeoutSaveTemplate(),d.addColumn('@ШаблонНомера',i.FIELD_TYPE_INTEGER),d.addColumn('НачинатьСначала',i.FIELD_TYPE_ENUM,c),d.set('@ШаблонНомера',m.getLinkedContext().getValue('docNumberTemplate_ID')),d.set('НачинатьСначала',new n({availableValues:c,currentValue:u})),new e('ШаблонНомера').call('Записать',{'Запись':t.serialize(d)},e.RETURN_TYPE_ASIS).addCallback(function(e){m._prevValue=u,o.clearTimeoutSaveTemplate();}).addErrback(function(e){o.clearTimeoutSaveTemplate(),s.showMessageDialog({message:e,status:'error'});});}});},onDataLoadPrefixList:function(e,t){this.getParentByClass('SBIS3.EDO.ConfigDocNumberTemplate').getChildControlByName('linkAddPrefix').toggle(!t.getCount()),this.toggle(t.getCount());},onEndEditPrefixList:function(e,t){if(t.has('Раздел'))t.removeField('Раздел');if(t.has('Раздел$'))t.removeField('Раздел$');if(t.has('Раздел@'))t.removeField('Раздел@');},checkAccessToRegulations:function(){return o.getRights(['Регламенты'])['Регламенты']&o.WRITE_MASK;}});return f;});
define("html!SBIS3.EDO.EditPrefixDialog",function(){var o=function(o){var n=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;o.test(n);)n=n.replace(o,"&#123;&#123;$1&#125;&#125;");return n}}(),e=function(o){return o.join?o.join(""):o.toString()},t=function(o){return void 0===o?"":o&&"object"==typeof o?e(o):""+o},i="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="edo-EditPrefixDialog"> <div class="edo-EditPrefixDialog_caption ws-sticky-header__block ws-float-area__close-button-wrapper"> <div class="edo-EditPrefixDialog_title"> '+n(t(rk("Префиксы наших организаций")))+' </div> <component data-component="SBIS3.CONTROLS/SearchForm" name="sfFilter" class="edo-TrustSignList_search_field"> <option name="tabindex">1</option> <option name="placeholder">'+n(t(rk("Укажите название или ИНН")))+'</option> <option name="maxLength">256</option> </component> </div> <component data-component="SBIS3.CONTROLS/Tree/DataGridView" name="dgPrefixes" class="edo-EditPrefixDialog_list_prefixes controls-ListView__bottomStyle"> <option name="displayField">Название</option> <option name="keyField">@Лицо</option> <option name="hierField">Раздел</option> <option name="emptyHTML">'+n(t(rk("Нет записей")))+'</option> <options name="filter"> <option name="Действующие">true</option> <option name="Префикс">false</option> <option name="ShowInnerCompany">true</option> </options> <options name="dataSource"> <option name="module">WS.Data/Source/SbisService</option> <options name="options"> <option name="endpoint">НашаОрганизация</option> <options name="binding"> <option name="query">ListWithPrefix</option> <option name="update">Сохранить</option> </options> </options> </options> <options name="columns" type="array"> <options> <option name="cellTemplate">html!SBIS3.EDO.EditPrefixDialog/resources/mainCellTemplate</option> <option name="title">'+n(t(rk("ИНН")))+'</option> </options> </options> <option name="editMode">click|toolbar</option> <option name="editingTemplate"> <div> <component data-component="SBIS3.CONTROLS/TextBox" name="tbPrefix" class="edo-ConfigDocNumberTemplate_prefix_editor"> <option name="text" bind="НашаОрганизация.Префикс"></option> <option name="maxLength">256</option> </component> </div> </option> <options name="itemsActions" type="array"> </options> <option name="itemsDragNDrop" value=""></option> <option name="editArrow">false</option> <option name="allowEnterToFolder">false</option> <option name="ignoreLocalPageSize">true</option> <option name="expand">false</option> <option name="multiselect">false</option> <option name="showHead">true</option> <option name="pageSize">25</option> <option name="showPaging">false</option> <option name="infiniteScroll">down</option> <option name="stickyHeader">true</option> <option name="tabindex">2</option> <options name="handlers"> <option name="onEndEdit" type="function">js!SBIS3.EDO.EditPrefixDialog:prototype.onEndEditPrefixes</option> </options> </component> </div>');return(a=n(a))+(i&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.EditPrefixDialog"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.EditPrefixDialog", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-EditPrefixDialog{height:100%}.edo-EditPrefixDialog_caption{width:100%;height:70px}.edo-EditPrefixDialog_title{padding:8px 0 0 8px;height:24px;font-size:18px;font-weight:700}.edo-TrustSignList_search_field{margin:4px 0 0 8px;width:300px;float:left}.edo-EditPrefixDialog_list_prefixes{width:100%}.edo-EditPrefixDialog_list_prefixes .controls-DataGridView__th .controls-DataGridView__th-content{float:right;width:100px}.edo-EditPrefixDialog_list_prefixes .controls-DataGridView__th{clear:both}.edo-EditPrefixDialog_rowMain{width:100%}.edo-EditPrefixDialog_rowMain_prefix{float:left;width:78px}.edo-EditPrefixDialog_leftFloat{float:left}.edo-EditPrefixDialog_rowMain_inn{float:right;width:100px;color:#999}.edo-EditPrefixDialog_rowMain_name{margin:0 104px 0 84px}.edo-EditPrefixDialog_nowrap{overflow:hidden;white-space:nowrap}"));head.appendChild(style);});}
define("html!SBIS3.EDO.EditPrefixDialog/resources/mainCellTemplate",function(){var e=function(e){var i=function(){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=/&(?!#?\w+;)|<|>|"|'|\//g;return function(r){return r?r.toString().replace(i,function(i){return e[i]||i}):r}}(),r=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(i){for(;e.test(i);)i=i.replace(e,"&#123;&#123;$1&#125;&#125;");return i}}(),o=function(e){return e.join?e.join(""):e.toString()},n=function(e){return void 0===e?"":e&&"object"==typeof e?o(e):""+e},t="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="edo-ConfigDocNumberTemplate_rowPrefix"> '),d=e.item.get("НашаОрганизация.Префикс")||"",l=e.item.get("ИНН")||"",f=e.item.get("Название")||"";return a+=' <div class="edo-ConfigDocNumberTemplate_row_editPrefix_area"></div> <div class="edo-ConfigDocNumberTemplate_row_editPrefix_main"> <div class="edo-ConfigDocNumberTemplate_rowPrefix_prefix"> <div class="edo-ConfigDocNumberTemplate_gradient_edit"></div> <div class="edo-ConfigDocNumberTemplate_rowPrefix_nowrap"> '+r(n(i(d)))+' </div> </div> <div class="edo-EditPrefixDialog_rowMain_inn"> '+r(n(i(l)))+' </div> <div class="edo-EditPrefixDialog_rowMain_name" title="'+r(n(f))+'"> <div class="edo-ConfigDocNumberTemplate_gradient"></div> <div class="',e.isNode?a+="edo-ConfigDocNumberTemplate_rowPrefix_nowrap_main_node":a+="edo-ConfigDocNumberTemplate_rowPrefix_nowrap_main",a+='"> '+r(n(i(f)))+" </div> </div> </div> </div>",(a=r(a))+(t&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.EditPrefixDialog/resources/mainCellTemplate"}},e});
define('js!SBIS3.EDO.EditPrefixDialog',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.EditPrefixDialog','SBIS3.CONTROLS/ComponentBinder','css!SBIS3.EDO.EditPrefixDialog','SBIS3.CONTROLS/SearchForm','SBIS3.CONTROLS/Tree/DataGridView','SBIS3.CONTROLS/TextBox','html!SBIS3.EDO.EditPrefixDialog/resources/mainCellTemplate','Reglamenty_localization'],function(i,e,t){var o=i.extend({_dotTplFn:e,$protected:{_options:{autoHeight:true}},$constructor:function(){},init:function(){o.superclass.init.call(this);var i=this,e=i.getChildControlByName('dgPrefixes'),n=i.getChildControlByName('sfFilter');new t({view:e}).bindSearchComposite('СтрокаПоиска',void 0,n);},onEndEditPrefixes:function(i,e){if(e.has('Раздел'))e.removeField('Раздел');if(e.has('Раздел$'))e.removeField('Раздел$');if(e.has('Раздел@'))e.removeField('Раздел@');}});return o.dimensions={minWidth:'500px',width:'500px',height:'auto'},o;});
define("html!SBIS3.EDO.CD.AccessRestricted",function(){var r=function(r){var e=function(){var r=/\{\{([\s\S]+?)\}\}/g;return function(e){for(;r.test(e);)e=e.replace(r,"&#123;&#123;$1&#125;&#125;");return e}}(),i=function(r){return r.join?r.join(""):r.toString()},d=function(r){return void 0===r?"":r&&"object"==typeof r?i(r):""+r},n="undefined"!=typeof process,o=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="cd-ra"> <div class="cd-ra__head-logo"> <div class="cd-ra__sbis-logo"></div> <div class="cd-ra__doc-descr"></div> </div> <div class="cd-ra__body"> <div class="icon-SelfPin icon-primary cd-ra__big-icon"></div> <div class="cd-ra__error-title">'+e(d(rk("Доступ к документу ограничен")))+'</div> <div class="cd-ra__error-description">'+e(d(rk("Возможно, после")))+' <a class="cd-ra__link" href="/auth/?ret='+e(d(r.openedFile))+'">'+e(d(rk("авторизации")))+"</a> "+e(d(rk("документ станет для вас доступен.")))+"</div> </div> </div>");return(o=e(o))+(n&&-1!==o.indexOf("{{")?String.fromCharCode(8203,8203):"")};return r.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.CD.AccessRestricted"}},r});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.CD.AccessRestricted", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".cd-ra{max-width:910px;min-width:600px;margin:0 auto}.cd-ra__head-logo{padding-top:24px;height:70px;border-bottom:#81cbfc 1px solid}.cd-ra__sbis-logo{background-image:url(/resources/SbisDiskBase/Routes/Page/images/sbis_logo.v1516270649826335cf4508dd597be4bfc9caa3e08b901.png);width:107px;height:44px;display:inline-block;float:left}.cd-ra__doc-descr{background-image:url(/resources/SbisDiskBase/Routes/Page/images/doc_description.v1516270649826335cf4508dd597be4bfc9caa3e08b901.png);width:183px;height:44px;display:inline-block;float:right}.cd-ra__body{padding-top:150px;text-align:center}.cd-ra__big-icon{font-size:150px;font-family:cbuc-icons!important;display:inline-block;width:150px;height:150px}.cd-ra__error-title{color:#999;font-size:32px;font-weight:400;padding-top:32px}.cd-ra__error-description{color:#999}.cd-ra__link{color:#05b;outline:0;text-decoration:none}.cd-ra__link:hover{text-decoration:underline}"));head.appendChild(style);});}
define('js!SBIS3.EDO.CD.AccessRestricted',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.CD.AccessRestricted','css!SBIS3.EDO.CD.AccessRestricted','SbisDiskBase_localization'],function(t,e){'use strict';var s=t.extend({_dotTplFn:e,$protected:{_options:{openedFile:null}},$constructor:function(){},init:function(){s.superclass.init.call(this);}});return s;});
define('js!SBIS3.EDO.CD.UploadLongOperationsProducer',['Core/Deferred','Core/UserInfo','SBIS3.CONTROLS/LongOperations/Const','SBIS3.CONTROLS/LongOperations/TabKey','SBIS3.CONTROLS/LongOperations/Entry','SBIS3.CONTROLS/LongOperations/AbstractProducer','js!SBIS3.EDO.CD.CommonDocsHelpers','SbisDiskBase_localization'],function(e,t,r,n,s,o,a){'use strict';var i='SBIS3.EDO.CD.UploadLongOperationsProducer',u='wslop-upl',d,l=o.extend({_moduleName:i,$constructor:function e(t){if(d)return d;d=this;},init:function(){this._eventListener_b=p.bind(null,this),['start','progress','complete','error'].forEach(function(e){a.uploader.subscribe(e,this._eventListener_b);}.bind(this)),l.superclass.init.apply(this,arguments);},destroy:function(){if(!this._isDestroyed){this._isDestroyed=true,['start','progress','complete','error'].forEach(function(e){a.uploader.unsubscribe(e,this._eventListener_b);}.bind(this));for(var e=s.STATUSES,t=s.DEFAULTS.status,o=r.ERR_UNLOAD,u=this._list(false),l=[],p=0;p<u.length;p++){var c=u[p],f='status'in c?c.status:t,g=f===e.running;if((g||f===e.suspended)&&c.tabKey===n){var h=c.id;a.uploader.cancel(h),c.status=e.ended,c.isFailed=true,c.resultMessage=o,c[g?'timeSpent':'timeIdle']=new Date().getTime()-c.startedAt-(c[g?'timeIdle':'timeSpent']||0),this._put(c),l.push(h);}}if(l.length)d._notify('onlongoperationended',{producer:i,operationIds:l,error:o});d=null;}},getName:function(){return i;},hasCrossTabEvents:function(){return false;},hasCrossTabData:function(){return true;},fetch:function(e){return l.superclass.fetch.apply(this,arguments).addCallback(function(e){for(var t=0;t<e.length;t++){var r=e[t];if(r.title===r.id){var n=r.extra;r.title=n&&n.name?rk(n.isFolder?'Загрузка папки':'Загрузка файла','ДлительныеОперации')+' '+n.name:rk('Загрузка','ДлительныеОперации')+'...';}}return e;});},callAction:function(t,n){if(!t||'string'!==typeof t)throw new TypeError('Argument "action" must be a string');if(!n||'string'!==typeof n)throw new TypeError('Argument "operationId" must be a string');if(this._isDestroyed)return e.fail(r.ERR_UNLOAD);var o={suspend:'canSuspend',resume:'canSuspend',delete:'canDelete'};if(!(t in o))throw new Error('Unknown action');try{var u=s.STATUSES,d=s.DEFAULTS,l=this._get(false,n);if(!l)throw new Error('Operation not found');var p=o[t];if(!(p in l?l[p]:d[p]))throw new Error('Action is not allowed');var f='status'in l?l.status:d.status,g,h;switch(t){case'suspend':if(f===u.running)a.uploader.cancel(n),l.status=u.suspended,l.progressCurrent=0,l.timeIdle=new Date().getTime()-l.startedAt,l.timeSpent=0,this._put(l),g='onlongoperationchanged',h={changed:'status',status:u.suspended};break;case'resume':if(f===u.suspended){if(a.uploader.reupload(n),d.status===u.running)delete l.status;else l.status=u.running;l.timeIdle=new Date().getTime()-l.startedAt,this._put(l),g='onlongoperationchanged',h={changed:'status',status:u.running};}break;case'delete':if(f===u.running)a.uploader.cancel(n);a.uploader._queue.remove(n),this._remove(n),g='onlongoperationdeleted';}if(g){var S={producer:i,operationId:n};this._notify(g,h?c(S,h):S);}return e.success();}catch(t){return e.fail(t);}},canDestroySafely:function(){if(!this._isDestroyed){var e=this._list(false);if(e.length)for(var t=s.STATUSES,r=s.DEFAULTS.status,o=0;o<e.length;o++){var a=e[o],i='status'in a?a.status:r;if((i===t.running||i===t.suspended)&&a.tabKey===n)return false;}return true;}},_getStorageNS:function(){return u;}}),p=function(e,r,o,a){if(e._isDestroyed)return;var u=s.STATUSES,d,l,p='start'===r.name,c;if(!p)c=e._get(false,o);if(!c)c={id:p?o.id:o,title:p?o.id:o,producer:i,status:u.running,startedAt:new Date().getTime(),userId:t.get('Пользователь'),userUuId:t.get('ИдентификаторСервисаПрофилей')||$.cookie('CpsUserId'),progressTotal:1,progressCurrent:0,resumeAsRepeat:true,tabKey:p?n:null,extra:p?o.isFolder?{name:o.name,isFolder:true,root:o.rootFolder}:{name:o.name}:null};var f;switch(r.name){case'start':d='onlongoperationstarted',l={progress:{value:0,total:1}};break;case'progress':d='onlongoperationchanged';var g=a/100;l={changed:'progress',progress:{value:g,total:1}},f=true,c.progressCurrent=g;break;case'complete':d='onlongoperationended',l={progress:{value:1,total:1}},f=true,c.progressCurrent=1,c.status=u.ended,c.tabKey=null;var h=c.extra,S=h&&h.isFolder;c.resultWayOfUse='Показать',c.resultHandler='js!SBIS3.EDO.CD.DiskOperations:'+(S?'openFolder':'openDocument'),c.resultHandlerArgs=S?{openFromLink:true,folderId:h.root,fileId:a.id}:a.id;break;case'error':d='onlongoperationended';var m=a&&'object'===typeof a?a.message:a;if(!m||'string'!==typeof m)m='Upload error';l={error:m},f=c.status=u.running,c.status=u.ended,c.isFailed=true,c.resultMessage=m,c.tabKey=null;}c[f?'timeSpent':'timeIdle']=new Date().getTime()-c.startedAt-(c[f?'timeIdle':'timeSpent']||0),e._put(c),l.producer=i,l.operationId=c.id,e._notify(d,l);},c=Object.assign||function(e){return[].slice.call(arguments,1).reduce(function(e,t){return Object.keys(t).reduce(function(e,r){return e[r]=t[r],e;},e);},e);};return l.getInstance=function(e){return d||new l(e);},l;});
define('js!SBIS3.EDO.CD.SharedHelpers',['Transport/BLObject','Transport/Record','Core/helpers/string-helpers','SbisDiskBase_localization'],function(e,A,r){'use strict';var a={_getErrorHTML:function(e,A,r){return'<div style=\'color:#999999;font-family: Tahoma; width: 370px;height: 100px;position: absolute;top:0;right: 0;bottom: 100px;left: 0;margin: auto;\'><div style=\'float: left;\'><img src=\'data:image/jpeg;base64,/9j/4AAQSkZJRgABAgAAZABkAAD/7AARRHVja3kAAQAEAAAAZAAA/+4AJkFkb2JlAGTAAAAAAQMAFQQDBgoNAAACqwAABKoAAAXiAAAHL//bAIQAAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQICAgICAgICAgICAwMDAwMDAwMDAwEBAQEBAQECAQECAgIBAgIDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMD/8IAEQgAIAAgAwERAAIRAQMRAf/EANkAAAMAAwAAAAAAAAAAAAAAAAMHCAAGCQEAAwEBAQAAAAAAAAAAAAAAAQUGBAADEAACAgIBBAIDAAAAAAAAAAADBAIGAAUTEBQVFgE0EjYHEQAABQEGAwQIBwAAAAAAAAABAgMEBREhEhMUFQYAMUEQcSIyUWIjM9MWpjckRGQltYYHEgAABQEEBgcJAAAAAAAAAAAAARECAxIQITEEQVFhsSIz8IHBMqKjNHGRofFSgrITgxMBAQACAQMDBAMBAAAAAAAAAREhMQAQQVHwYXGBkaHRscHx4f/aAAwDAQACEQMRAAAB6HXM0rWeJ+oWdBIGrBwaojtJy3IujTDhfsWf1XbDJRM+2nagUmBCRncYH//aAAgBAQABBQK+MbKy3i1aSX8u2n9Ssm3qj9asustOsyu06w7W55pNs+3b9lv/AB+/oNB9H6Vv9/uCG9837Jf89kv+U9De+b//2gAIAQIAAQUCRiNdJU3kxaxcTUGFyKkxhtcSeGFCKgwcgHnu96MfQUmDh7dDO3QxuYOH/9oACAEDAAEFAmfmRWDD7ObhZhkIsDQwQCzYwc5fJ5E/Eqy3b9BfaPEnJytZytYCJOT/2gAIAQICBj8CfnnNqkW7cHtzTW3aRLFJjwpr0j9cnzsLK5M1XvHf2691kMjS43Vr1HcJJl5dPWpoG8NNK6VxTYWqzLf0/ISwTOorpvRcDHqfLcPU+W4RQQuroqvRMTH/2gAIAQMCBj8CbliNGBpwmd+gMe3C/sFbLDmzBezpsskYfdKlPcGR/UvwB3qtkv27gyWMqqV2YjleIhyvEQfLIVNSbcB//9oACAEBAQY/AobYTeQWjo1duDh8ZARKZwbBdPFb90QxSkaNqJlN4cQajWzjb7rastKKHfqq40a4WTUFzlztguHTbIoJrIusW5QydQMFg+jactG3jIFNMIP0DXso6TU0oxG64hYRQwJmFM3mKIDTqHCclGqVKPgcNz0zDNxSpkFyhyMHQeRgtDsebr3q0MgDQ5VYVmd0zcplNiHypSgzdOSpJxqZa0Gl9UwGtG92b3i3C+IxiPlrTkMJEuX1CMVcO/aETKsrirFr4zGp0pxtqDymL8w6x+Kx7mU0lkR37nBPmMxfu+Yl3nbxK/uup6nkfyOSwMlnP1jvExM36tLvWvZ/pX9O/hV+NpT8HElmjQJpwrhhqDaNOcJVii0TOVw6qmBU7oiNgjy7w+2v1jC/A4+2v1jC/A43bPzkSWFNPGgyt2GoNpI5AimKzRQ5nDWiYlUvAIWAPPvH/9oACAEBAwE/ISIcZgfgA4KpxAlRiujIvmlC057IWR2SO46FRbAvqwAF5zaeuiPQu7DduKCDutCufY9sM/GdsyWOejXO59Avs89D8PRn4HQxLztGYZUmi2Ai9QwwJztGYZUmo2EgcP/aAAgBAgMBPyEmgxXbIPjLl3OCWwkJJb5WJLv59/PRLs8z8X/OPTz2ew8nrHSo8JAfOhX8RPHSWzOVzEw0Q8T35pd2J9UuJ8N5+/g6A9R7OY32Km86Oep+znqfs5jfZqazp5//2gAIAQMDAT8hboxX32/wY9+Nb627yeJv457+4dnwf6599B3Hw9JpJrR+NL/1novH4S08xze9dRfrefH/ALTV93z09X7ueaslNE289X9XPV/VzxVkpomzn//aAAwDAQACEQMRAAAQCeHC7Drd/9oACAEBAwE/EDr5oWJrZhtCudeGtbenBTLzwkbMWErczSGj4fcXiGTegBvRlZ6WXa2TMqXfT/ttOtFhjSr1O7j/AOy4nqfL+DufCMzcKH4B1V++78IzNwofgHFf/9oACAECAwE/EIZNeQcJdm5aYJW1EnEJ5i3ZCUYJxNcYFKkvmCg6RBjRMAMn8VPHk2sOehskgNSFqtDKWiQY53fhR3yLQTCt05594csrsNd+BjfPWPD2J8re0z0gEjI54XRz1oGQ23APSCBSMjnlNDPSI5TTcof/2gAIAQMDAT8Qw8wvsW+QgHFVuI7UqoOTBAEqRqlG6uyhLWDR4HCrZFMU4YTGk+UH8OkydFjB1RDWDEBmYqKW3ll2MgZWQK1zlZ2hz7YWYekdk2Teefr5/v1+Ene9ao4p5MYh0Yiu3WO50qqjinkwqnRmiad47v8A/9k=\' style=\'width:32px;height:32px; padding-top: 6px;\'/></div><div><p style=\'font-size: 32px; margin: 0px;padding-left:48px;\'>'+(A=A||rk('Документ не найден!'))+'</p><p style=\'font-size: 13px; margin: 0px;padding-left:48px;padding-top: 8px;\'>'+(r=r||rk('Возможно, он был удален или вы открыли некорректную ссылку'))+'</p><!--<p>'+e+'</p>--></div></div>';},_checkDateExpire:function(e){var A=new Date(),r=true;if(e){var a=new Date();r=A<(a=a.setTime(Date.parse(e)));}return r;},_readInfoPublic:function(A,r,t,n,i){return new e({name:'PublicFileSD',serviceUrl:'/shared/service/'}).call(A,r,e.RETURN_TYPE_RECORD).addErrback(function(e){if(4===e.error_code)if(!i){var A={openedFile:n.originalUrl};t.render('SBIS3.SBISDISK.ErrorSharedPage',{windowTitle:'Доступ ограничен',componentOptions:A},['js!SBIS3.EDO.CD.AccessRestricted']);}else t.send(a._getErrorHTML(e&&e.message?e.message:rk('Неизвестная ошибка при запросе PublicFileSD'),rk('Доступ к документу запрещен!'),rk('Истекло время действия ссылки или сейчас к нему ограничен доступ')));else t.send(a._getErrorHTML(e&&e.message?e.message:rk('Неизвестная ошибка при запросе PublicFileSD')));return e;});},_openObject:function(e,A,r,t,n,i){var s=t.get('Type');if(0!==s&&2!=s)a._openFile(e,A,r,t,n,i);else a._openFolder(e,A,t,n,i);},_openFile:function(e,A,r,a,t,n){require(['js!SBIS3.DOCVIEW.Funcs'],function(i){var s=t&&n,o=a.get('Version');o=o?o.getRecords():null;var d={objId:a.get('Id'),objectName:!s?'PublicFileSD':'FileSD',serviceUrl:!s?'/shared/':'/disk/api/v1/',attachId:a.get('Id'),justAttach:true,fileName:a.get('Name'),mainOptions:{_isAuth:s,_useMainService:t,originalURL:e.originalUrl,serviceBLName:s?'СБИСДиск.Приватный':'shared',commands:{saveToPdf:false,deleteDoc:false,sendMessage:t,rights:t,toCommonDocs:t,toMyDocs:t,findInCommonDocs:t,findInMyDocs:t,copyToBuffer:t,signDocument:t,encrypt:t,decrypt:t}},viewOptions:{canEditFED:false}};if(!t)d.mainOptions.userCommands=[{name:'enterButton',tooltip:rk('Войти'),caption:rk('Войти'),weight:298,inInline:true,inList:false,inMas:false,typeCmd:'r',inDisk:true,cmdClass:'js!SBIS3.DOCVIEW.enterButton'}];if(o&&o[0])d.lastRedaction={redactionId:o[0].get('Id'),hash:o[0].get('hash')};i.showAttachment(e,A,d,r);});},_openFolder:function(e,A,a,t,n){var i={folderName:a.get('Name'),folderObject:a.get('Object'),canEdit:a.get('canEdit'),folderRoot:a.get('Id'),openedFile:e.originalUrl,isAuthorized:t,hasAccessRight:n};A.render('SBIS3.EDO.CD.SharedPage',{windowTitle:r.escapeHtml(a.get('Name')),componentOptions:i});},showObject:function(r,t,n){var i=r.params.objId,s=new A();if(r.query&&!a._checkDateExpire(r.query['expires']))return void t.send(a._getErrorHTML(rk('Ссылка устарела по дате'),rk('Доступ к документу запрещен!'),rk('Истекло время действия ссылки')));var o=!!r.header('X-SBISSessionID')&&1!=r.header('X-Guest'),d=false;s.addColumn('ReadLinkedObjects',A.FIELD_TYPE_BOOLEAN),s.set('ReadLinkedObjects',false),s.addColumn('ReadVersions',A.FIELD_TYPE_INTEGER),s.set('ReadVersions',1),s.addColumn('ReadServiceFiles',A.FIELD_TYPE_BOOLEAN),s.set('ReadServiceFiles',true);var c={Id:i,ExtraParams:s};new e({name:o?'FileSD':'PublicFileSD',serviceUrl:o?'/disk/api/v1/service/':'/shared/service/'}).call('ReadByObject',c,e.RETURN_TYPE_RECORD).addCallbacks(function(e){d=o,a._openObject(r,t,n,e,o,d);},function(e){if(401==e.httpError)o=false,a._readInfoPublic('ReadByObject',c,t,r,o).addCallback(function(e){a._openObject(r,t,n,e,o,d);});else if(4===e.error_code)d=false,a._readInfoPublic('ReadByObject',c,t,r,o).addCallback(function(e){a._openObject(r,t,n,e,o,d);});else t.send(a._getErrorHTML(e&&e.message?e.message:rk('Неизвестная ошибка при получении информации по объекту')));});},showRedaction:function(r,t,n){var i=r.params.redactionId,s=!!r.header('X-SBISSessionID'),o=false,d={'ИдО':i},c=function(e){var r=new A();return r.addColumn('Version',A.FIELD_TYPE_STRING),r.addColumn('Id',A.FIELD_TYPE_STRING),r.set('Id',i),r.addColumn('Name',A.FIELD_TYPE_STRING),r.set('Name',e.get('fileName')),r;};new e({name:s?'FileSD':'PublicFileSD',serviceUrl:s?'/disk/api/v1/service/':'/shared/service/'}).call('ReadAttachmentInfo',d,e.RETURN_TYPE_RECORD).addCallbacks(function(e){o=s,a._openFile(r,t,n,c(e),s,o);},function(e){if(401==e.httpError)s=false,a._readInfoPublic('ReadAttachmentInfo',d,t,r,s).addCallback(function(e){a._openFile(r,t,n,c(e),s,o);});else if(4===e.error_code)o=false,a._readInfoPublic('ReadAttachmentInfo',d,t,r,s).addCallback(function(e){a._openFile(r,t,n,c(e),s,o);});else t.send(a._getErrorHTML(e&&e.message?e.message:rk('Неизвестная ошибка при получении информации по редакции')));});}};return a;});
define("tmpl!SBIS3.EDO.CD.DragAndDropArea",["Core/tmpl/js/tclosure"],function(){var e=Array.prototype.slice.call(arguments),a=e[0],r={},t=function e(t,d,c,o,s){function l(){}var i=0,n=void 0!==a&&a?a:arguments[arguments.length-1];void 0===n&&(eval("var thelpers = null;"),n=global.requirejs("View/Runner/tclosure"));var u={};s&&s.isSetts&&(u=s.fullContext||{});var p="string"==typeof c?c:"",g=void 0===r?void 0:r,v={id:[],def:void 0},h=n.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,t),f=this&&this.includedTemplates?this.includedTemplates:{},m=n.getMarkupGenerator(o);try{var A=m.joinElements([m.createTag("div",{class:"cd-dnd"},[m.createTag("div",{class:"cd-cdArea__drag-and-drop-upload-back"},[m.createTag("div",{class:"cd-cdArea__drag-and-drop-upload-border"},[],{},v,this),m.createTag("div",{class:"textCont"},[m.createTag("div",{class:"cd-cdArea__dnd-upload-main-text"},[m.createText(global.rk("Загрузить файлы в")+' "'),m.createTag("span",{class:"cd-cdArea__drag-and-drop-upload-dest-folder"},[],{},v,this),m.createText(""+global.rk('"'))],{},v,this),m.createTag("div",{class:"cd-cdArea__dnd-upload-dop-text"},[m.createText(""+global.rk("для файлов размером не более 100МБ"))],{},v,this)],{},v,this)],{},v,this),m.createTag("div",{class:"cd-cdArea__drag-and-drop-upload"},[],{},v,this)],d,v,this)],p,v);v.def&&(A=m.chain(A,v,d),v=void 0)}catch(e){n.templateError("resources/SbisDiskDocuments/Base/DragAndDropArea.tmpl",e,t)}return A||""};return t.includedFunctions={},t.stable=!0,t.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.CD.DragAndDropArea"}},t});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.CD.DragAndDropArea", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".cd-dnd{width:100%!important;height:100%!important}.cd-cdArea__dnd-upload-main-text{color:#fff;font-size:60px}.cd-cdArea__dnd-upload-dop-text{color:#fff;font-size:20px}.cd-cdArea__dnd-upload-text-cont{text-align:center;padding-top:250px}.cd-cdArea__drag-and-drop-upload{position:fixed;width:100%;height:100%;display:none;top:0;left:0}.textCont{text-align:center;margin-top:40px;color:#fff;font-size:32px;opacity:1}.cd-cdArea__drag-and-drop-upload-back{background-color:rgba(0,0,0,.5);position:fixed;width:100%;height:100%;top:0;left:0;display:none}.cd-cdArea__drag-and-drop-upload-border{position:fixed;top:0;left:0;bottom:0;right:0;border:6px #fff dashed;border-radius:40px;margin:10px}.show_zone{display:block}"));head.appendChild(style);});}
define('js!SBIS3.EDO.CD.DragAndDropArea',['Lib/Control/Window/Window','tmpl!SBIS3.EDO.CD.DragAndDropArea','css!SBIS3.EDO.CD.DragAndDropArea','SbisDiskDocuments_localization'],function(t,e){'use strict';var r=t.extend({_dotTplFn:e,$protected:{_options:{resizable:false,modal:true,autoHeight:false,autoWidth:false},_startDrag:true},$constructor:function(){},init:function(){r.superclass.init.call(this);var t=this;this.subscribe('onBeforeClose',function(e){e.setResult(false),t.hide();});},destroy:function(){r.superclass.destroy.call(this);},_createTitleBar:function(){}});return r;});
define("html!SBIS3.EDO.CD.CommonDocsArea",function(){var e=function(e){var o=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(o){for(;e.test(o);)o=o.replace(e,"&#123;&#123;$1&#125;&#125;");return o}}(),t=function(e){return e.join?e.join(""):e.toString()},n=function(e){return void 0===e?"":e&&"object"==typeof e?t(e):""+e},i="undefined"!=typeof process,a=("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),p=function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,r='<div class="cd-cdArea"> <div class="cd-cdArea__main-content ';return e.recentOptions.visible&&(r+="with-recent"),r+='"> <div class="',e.stickyHeader&&(r+="ws-sticky-header__block"),r+='"> <component data-component="SBIS3.DOCVIEW.OperationPanel" name="ПанельМассовыхОперацийОбщихДокументов" class="cd-buttons__operations-panel"> <options name="items" type="array"> <options> <option name="name">markOperations</option> <option name="componentType">SBIS3.CONTROLS/OperationsPanel/Mark</option> <options name="type"> <option name="mark">true</option> </options> </options> </options> <options name="mainOptions"> <option name="objectName">FileSD</option> <option name="serviceBLName">СБИСДиск.Приватный</option> <option name="serviceUrl">/disk/api/v1/</option> <option name="_isAuth">true</option> <option name="useOnlyCtx">false</option> <option name="multiPage">false</option> <option name="isDisk">true</option> <option name="commands" bind="visibleCommands"></option> <option name="filter" bind="listFilters"></option> <option name="withoutNotification">false</option> </options> <option name="folderRecord" bind="currentFolderForMassPanel"></option> <option name="panelFloatDirection" value="horizontal"></option> <option name="hasItemsMenu" value="'+o(n(e.mainOptions.operationsPanelHasItemsMenu))+'"></option> </component> </div> <div class="cd-cdArea__table cd-cdArea__head-container ',e.stickyHeader&&(r+="ws-sticky-header__block"),r+='"> <div class="cd-cdArea__tableRow"> <div class="cd-cdArea__tableCell cd-cdArea__search-cell"> <component data-component="SBIS3.CONTROLS/SearchForm" name="СтрокаПоискаХД" class="cd-cdArea__search-string"> <option name="placeholder" bind="searchStringPlaceholder"></option> <option name="maxLength" value="200"></option> </component> </div> <div class="cd-cdArea__tableCell cd-cdArea__filter-cell"> <component data-component="SBIS3.CONTROLS/Filter/Button" class="cd-cdArea__filter-controller"> <opt name="name" value="ПанельФильтровХД"/> <opt name="filter"></opt> <opt name="filterLineComponent" value="js!SBIS3.EDO.CD.CommonDocsFilter.CommonDocsFilterLine"></opt> <opt name="resetLinkText"></opt> <opts name="filterStructure" type="array"> <opts> <opt name="internalValueField">OnlyDeletedFilter</opt> <opt name="internalCaptionField">OnlyDeletedText</opt> <opt name="caption"></opt> <opt name="value" bind="filters/OnlyDeleted"></opt> <opt name="resetValue" type="string">Все</opt> </opts> <opts> <opt name="internalValueField">ФильтрДатаПериод</opt> <opt name="internalCaptionField">ФильтрДатаПериодТекст</opt> <opt name="caption" bind="ФильтрДатаПериодТекст"></opt> <opt name="value" bind="listFilters/ФильтрДатаПериод"></opt> <opt name="resetValue" type="string">Все</opt> </opts> <opts> <opt name="internalValueField">ФильтрДатаС</opt> <opt name="internalCaptionField">ФильтрДатаС</opt> <opt name="caption" bind="listFilters/ФильтрДатаС"></opt> <opt name="value" bind="listFilters/ФильтрДатаС"></opt> <opt name="resetValue" type="string"></opt> </opts> <opts> <opt name="internalValueField">ФильтрДатаП</opt> <opt name="internalCaptionField">ФильтрДатаП</opt> <opt name="caption" bind="listFilters/ФильтрДатаП"></opt> <opt name="value" bind="listFilters/ФильтрДатаП"></opt> <opt name="resetValue" type="string"></opt> </opts> </opts> <opt name="template"> <component data-component="SBIS3.EDO.CD.CommonDocsFilter"> <opt name="visibleDeleted" type="boolean" value="'+o(n(e.mainOptions.filterDeleted))+'"></opt> </component> </opt> </component> </div> </div> </div> <component data-component="SBIS3.CONTROLS/SwitchableArea" name="SwitchableArea" class="cd-cdArea__switchable-area"> <option name="defaultArea">documents</option> <options name="items" type="array"> <options> <option name="content"> <component data-component="SBIS3.EDO.CD.CommonDocsReestr" class="cd-cdArea__cd-reestr" name="cdReestr"> <option name="fromPublicLink" value="false" type="boolean"></option> <option name="saveBrowserState" value="'+o(n(e.mainOptions.saveBrowserState))+'" type="boolean"></option> <option name="stickyHeader" value="'+o(n(e.stickyHeader))+'"></option> <option name="subscribeFileEvents" value="'+o(n(e.subscribeFileEvents))+'"></option> <option name="multiselect" value="'+o(n(e.buttonsOptions.visible))+'" type="boolean"></option> </component> </option> <option name="id">documents</option> </options> <options> <option name="content"> <div class="cd-cdArea__no-access-docs ws-browser-empty listView ws-hidden"></div> <component data-component="SBIS3.EDO.CD.CommonDocsSearchBlock" name="ListFindResults"> <option name="visible" value="false" type="boolean"></option> </component> </option> <option name="id">searchDocuments</option> </options> </options> </component> </div> <div class="cd-cdArea__recent-content cd-cdArea__td-stiker-height cd-cdArea__td-stiker ',e.recentOptions.visible||(r+="cd-cdArea__td-stiker-not-show"),r+=' cd-cdArea__td-stiker-decoration"> ',e.recentOptions.visible&&(r+=' <component data-component="SBIS3.EDO.CD.FolderStiker" class="cd-cdArea__folder-stiker" name="Sticker"> <option name="recentVisible" value="'+o(n(e.recentOptions.visible))+'" type="boolean"></option> <option name="withFavorite" value="'+o(n(e.recentOptions.withFavorite))+'" type="boolean"></option> <option name="listRoot" value="recent"></option> <option name="recents" value="'+o(n(function(e,o){var t=a.randomId();return e[t]=o,t}(p,e.recents)))+'" type="ref"></option> <options name="listCommands"> <option name="addPage">false</option> <option name="fullScreen">false</option> <option name="saveToPdf">false</option> <option name="restore">false</option> <option name="editGroup">true</option> <option name="sendMessage">true</option> <option name="rename">true</option> <option name="edit">true</option> <option name="editInApp">true</option> <option name="print">true</option> <option name="deleteDoc">false</option> <option name="deletePermanentlyDoc">false</option> <option name="move">false</option> <option name="deleteFromRecent">true</option> <option name="links">true</option> <option name="editPdf">false</option> <option name="linksGroup">false</option> </options> </component> '),r+=" </div> ",e.fromFloatArea||(r+=' <component data-component="SBIS3.EDO.CD.DragAndDropArea" name="CDDragAndDropArea"> </component> '),r+=" </div>",(r=o(r))+(i&&-1!==r.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.CD.CommonDocsArea"}},e});
define("html!SBIS3.EDO.CD.CommonDocsReestr",function(){var o=function(o){var e=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(e){for(;o.test(e);)e=e.replace(o,"&#123;&#123;$1&#125;&#125;");return e}}(),n=function(o){return o.join?o.join(""):o.toString()},t=function(o){return void 0===o?"":o&&"object"==typeof o?n(o):""+o},i="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="cd-commonDocsReestr"> <component data-component="SBIS3.DOCVIEW.List" name="РеестрСписокОбщих" class="cd-commonDocsReestr__list ws-bootup-autofocus"> <option name="_privateMegaFixOption">true</option> <option name="_gotozip">true</option> <options name="mainOptions"> ');return o.useSharedService?a+=' <option name="objectName">PublicFileSD</option> ':a+=' <option name="objectName">FileSD</option> ',a+=" ",o.useSharedService?a+=' <option name="serviceUrl">/shared/</option> ':a+=' <option name="serviceUrl">/disk/api/v1/</option> ',a+=" ",o.useSharedService&&(a+=' <option name="_isAuth">false</option> '),a+=" ",o.useSharedService?a+=' <option name="serviceBLName">shared</option> ':a+=' <option name="serviceBLName">СБИСДиск.Приватный</option> ',a+=' <option name="useOnlyCtx">false</option> <option name="multiPage">false</option> <option name="isDisk">true</option> <option name="filter" bind="listFilters"></option> <option name="commands" bind="visibleCommands"></option> <option name="withoutNotification">false</option> </options> <options name="listOptions"> <option name="multiselect" value="'+e(t(o.multiselect))+'"></option> <option name="countDocWithoutScroll">0</option> <option name="root" bind="listRoot"></option> <option name="defaultRecordPK" bind="rowForSelect"></option> <option name="autoQuery">false</option> <option name="pageSize" bind="pageSizeForSelect"></option> <option name="itemsSortMethod" value="'+e(t(o.itemsSortMethod))+'" type="function"></option> ',o.useSharedService?a+=' <option name="itemsDragNDrop">false</option> ':a+=' <option name="itemsDragNDrop" bind="canDragNDropItems"></option> ',a+=' <option name="saveState">'+e(t(o.saveBrowserState))+'</option> <option name="hideEmptyBackButton">false</option> <options name="visibilityMode"> <option name="defaultMode">diskClassic</option> <option name="setFromCookie">true</option> <option name="autoSelect">true</option> <option name="savedModeField">currentFolderId</option> <option name="changedId">commondocsId</option> </options> <option name="pathPlaceholderTemplate"> <component data-component="SBIS3.DOCVIEW.SwitchVisibilityMode"> <option name="className">cd-commonDocsReestr__visibility-mode-switcher</option> <options name="hasSwitch"> <option name="classic" value="false" type="boolean"></option> <option name="diskClassic" value="true" type="boolean"></option> </options> <options name="listOptions"> <options name="visibilityMode"> <option name="defaultMode">diskClassic</option> <option name="setFromCookie">true</option> ',o.fromPublicLink&&(a+=' <option name="autoSelect">true</option> '),a+=' <option name="savedModeField">currentFolderId</option> <option name="changedId">commondocsId</option> </options> </options> </component> <div class="cd-commonDocsReestr__vertical-separator"></div> <component data-component="SBIS3.EDO.CD.CommonDocsSorter" name="cdSorter"> <option name="className">cd-commonDocsReestr__cd-sorter</option> <option name="dropdownFieldName" value="CDSorterField"></option> </component> </option> <option name="stickyPath">'+e(t(o.stickyHeader))+'</option> <option name="wrapInScrollContainer">true</option> <option name="loadItemsStrategy">append</option> </options> <options name="viewOptions"> <option name="canEditFED">false</option> </options> </component> </div>',(a=e(a))+(i&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.CD.CommonDocsReestr"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.CD.CommonDocsReestr", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".cd-commonDocsReestr{height:100%;width:100%;position:relative}.cd__file-icon{font-family:cbuc-icons;font-size:22px!important;width:24px;line-height:21px;font-weight:400}.cd-commonDocsReestr__list .dv-diskClassic-item{width:100%}.cd-commonDocsReestr__cd-sorter{float:right;z-index:100;padding-right:8px}.cd-commonDocsReestr__list .cd-commonDocsReestr__vertical-separator{height:20px;width:1px;background-color:#ccc;float:right;margin:2px 6px 2px 3px}.cd-commonDocsReestr__visibility-mode-switcher{float:right;width:24px;z-index:100;height:24px;padding-top:3px;padding-right:4px}.cd-commonDocsReestr__list .cd-CDSorter__text-title{height:24px;line-height:24px;padding-top:1px}.ws-is-ie .cd-commonDocsReestr__list .cd-CDSorter__text-title{padding-top:0}.cd-commonDocsReestr__list .cd-CDSorter__icon-title{height:24px;line-height:24px!important;padding-top:0}.cd-commonDocsReestr__list .dv-bigpreview-folder.controls-ListView__item__selected,.cd-commonDocsReestr__list .dv-bigpreview-item.controls-ListView__item__selected .dv-bigpreview-vis,.cd-commonDocsReestr__list .dv-bigpreview-item.controls-ListView__item__selected .dv-forEmptyLink-icon{outline:1px solid #ff9c6c}.cd-commonDocsReestr__list .dv-bigpreview-item.dv-bigpreview-folder.controls-ListView__item__selected.controls-ListView__item__multiSelected:not(.controls-ListView__hoveredItem):not(.controls-ItemActions__activeItem){z-index:1}.cd-commonDocsReestr__list .controls-ListView__item__selected:not(.controls-ListView__hoveredItem):not(.controls-ItemActions__activeItem) .dv-bigpreview-title{outline:0;border-top:solid 1px #e4e4e4;box-sizing:border-box}.dv-diskClassic__sign-td .signs-count{margin-top:-30px;margin-left:12px;background:#fff;padding-left:1px;height:17px}.controls-ListView__hoveredItem .dv-diskClassic__sign-td .signs-count{background-color:#f0f5fb!important}.controls-ItemActions__activeItem .dv-diskClassic__sign-td .signs-count{background-color:#f0f5fb!important}.cd-commonDocsReestr__list.with-sign-column .dv-diskClassic__title .docview-Signature{display:none}.cd-commonDocsReestr__list.with-sign-column .dv-diskClassic__title .dv-diskClassic__title-text{max-width:100%!important}.cd-commonDocsReestr__list.with-sign-column .dv-diskClassic__title{padding-right:0!important}.cd-commonDocsReestr .docview-list{height:100%;width:100%}.cd-commonDocsReestr .docview-list .docview-list__container{height:calc(100% - 16px);box-sizing:border-box;overflow-y:hidden!important}.cd-commonDocsReestr .docview-list .docview-list__container .controls-ListView{padding-bottom:24px}.cd-area__opened-operations-panel .cd-commonDocsReestr .docview-list .docview-list__container{padding-bottom:54px}.cd-commonDocsReestr .docview-list_mode-bigpreview .controls-DataGridView:not(.controls-DataGridView__emptyTable) .controls-CompositeView__itemsContainer{padding:0 10px 28px 10px}.cd-commonDocsReestr .docview-list_mode-bigpreview.dv-folder-as-preview .controls-DataGridView:not(.controls-DataGridView__emptyTable) .controls-CompositeView__itemsContainer{padding:12px 10px 28px 10px}.cd-commonDocsReestr .docview-list_mode-bigpreview .controls-DataGridView:not(.controls-DataGridView__emptyTable) .controls-CompositeView__foldersContainer{padding-top:12px}"));head.appendChild(style);});}
define("tmpl!SBIS3.EDO.CD.CommonDocsSorter",["Core/tmpl/js/tclosure","js!SBIS3.CONTROLS/DropdownList"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.CONTROLS/DropdownList"]=e[1];var o=function e(o,i,n,a,l){function s(){}var d=0,p=void 0!==t&&t?t:arguments[arguments.length-1];void 0===p&&(eval("var thelpers = null;"),p=global.requirejs("View/Runner/tclosure"));var c={};l&&l.isSetts&&(c=l.fullContext||{});var m="string"==typeof n?n:"",u=void 0===r?void 0:r,S={id:[],def:void 0},y=p.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),N=this&&this.includedTemplates?this.includedTemplates:{},f=p.getMarkupGenerator(a);try{var v=f.joinElements([f.createTag("div",{class:"cd-CDSorter"},[f.createControl("wsControl","ws:SBIS3.CONTROLS/DropdownList",{name:p.getter(o,["dropdownFieldName"]),className:"controls-DropdownList__withoutArrow controls-DropdownList__linkStyle controls-DropdownList__withoutCross",mode:"click",displayProperty:"value",idProperty:"key",multiselect:!1,type:"titleHeader",title:global.rk("Сортировать"),allowEmptySelection:!1,pickerClassName:"cd-sorter__dropdown-head",bindings:[{fieldName:""+p.getter(o,["sorterDataField"]),propName:"items",propPath:[],fullPropName:"items",propPathStr:"",oneWay:!0,direction:"fromContext",bindNonExistent:!0},{fieldName:"sortBy",propName:"selectedKeys",propPath:[],fullPropName:"selectedKeys",propPathStr:"",oneWay:!1,direction:"fromContext",bindNonExistent:!0}],items:[],selectedKeys:["SortByName"],headTemplate:p.getter(o,["headSorterTemplate"]),itemTpl:p.getter(o,["itemSorterTemplate"])},{name:p.getter(o,["dropdownFieldName"]),sbisname:p.getter(o,["dropdownFieldName"])},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:y},n,u,N,p.config,c)],i,S,this)],m,S);S.def&&(v=f.chain(v,S,i),S=void 0)}catch(e){p.templateError("resources/SbisDiskDocuments/Base/PageComponent/Sorter.tmpl",e,o)}return v||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.CD.CommonDocsSorter"}},o});
define("html!SBIS3.EDO.CD.CommonDocsSorter/templates/itemSorterTemplate",function(){var e=function(e){var t=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;e.test(t);)t=t.replace(e,"&#123;&#123;$1&#125;&#125;");return t}}(),r=function(e){return e.join?e.join(""):e.toString()},o=function(e){return void 0===e?"":e&&"object"==typeof e?r(e):""+e},n="undefined"!=typeof process,i=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="controls-DropdownList__item" data-hash="'+t(o(e.projItem.getHash()))+'" data-id="'+t(o(e.item.getId()))+'"> ');return"SortByName"===e.item.get("key")?i+=' <div class="icon-16 icon-TrendUp icon-primary cd-sorter__icon-item"></div> ':i+=' <div class="icon-16 icon-TrendDown icon-primary cd-sorter__icon-item"></div> ',i+=' <div class="cd-sorter__text-item">'+t(o(e.item.get("value")))+"</div> </div>",(i=t(i))+(n&&-1!==i.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.CD.CommonDocsSorter/templates/itemSorterTemplate"}},e});
define("html!SBIS3.EDO.CD.CommonDocsSorter/templates/headSorterTemplate",function(){var e=function(e){var r=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(r){for(;e.test(r);)r=r.replace(e,"&#123;&#123;$1&#125;&#125;");return r}}(),t=function(e){return e.join?e.join(""):e.toString()},o=function(e){return void 0===e?"":e&&"object"==typeof e?t(e):""+e},n="undefined"!=typeof process,i=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,"<div> ");if(e.selectedItems&&e.selectedItems.at(0)){i+=" ";var d=e.selectedItems.at(0);i+=" ","SortByName"===d.get("key")?i+=' <div class="icon-16 icon-TrendUp icon-primary cd-sorter__icon-head"></div> ':i+=' <div class="icon-16 icon-TrendDown icon-primary cd-sorter__icon-head"></div> ',i+=' <div class="cd-sorter__text-item controls-DropdownList__textWrapper">'+r(o(d.get("value")))+"</div> "}return i+=" </div>",(i=r(i))+(n&&-1!==i.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.CD.CommonDocsSorter/templates/headSorterTemplate"}},e});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.CD.CommonDocsSorter", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".cd-CDSorter__icon-title{float:right;padding-top:3px}.cd-CDSorter__text-title{float:right}.cd-CDSorter__dropdown-head{display:inline-block;width:100%}.cd-CDSorter__dropdown-head-title{color:#999;padding:4px 0 2px 8px;float:left}.cd-CDSorter__dropdown-head-ico-close{float:right;padding-top:3px}.cd-CDSorter__dropdown-head-ico-close:hover .icon-Close{color:#999!important}.cd-CDSorter__title{height:22px}.cd-sorter__icon-head{display:inline-block;height:24px;line-height:24px!important;float:left}.cd-sorter__icon-item{display:inline-block;height:24px;line-height:24px!important;float:left}.cd-sorter__text-item{display:inline-block;padding-left:6px}.cd-sorter__dropdown-head .controls-DropdownList__pickerHead-text{padding-left:22px}.cd-CDSorter .controls-DropdownList.ws-disabled .controls-DropdownList__selectedItem .cd-sorter__icon-head{color:#ccc!important}"));head.appendChild(style);});}
define('js!SBIS3.EDO.CD.CommonDocsSorter',['Core/EventBus','SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.CD.CommonDocsSorter','html!SBIS3.EDO.CD.CommonDocsSorter/templates/itemSorterTemplate','html!SBIS3.EDO.CD.CommonDocsSorter/templates/headSorterTemplate','css!SBIS3.EDO.CD.CommonDocsSorter','SBIS3.CONTROLS/DropdownList','SbisDiskDocuments_localization'],function(o,t,e,n,r){var i=t.extend({_dotTplFn:e,$protected:{_options:{currentMode:'classic',dropdownFieldName:'CDSorterField',sorterDataField:'sorterData',itemSorterTemplate:n,headSorterTemplate:r},_currentValue:'sortByName'},$constructor:function(){this._publish('onChangeSort');},init:function(){i.superclass.init.call(this);var t=this;this._container=this.getContainer(),this._sorter_dropdown=this.getChildControlByName(this._options.dropdownFieldName),this.subscribeTo(this._sorter_dropdown,'onSelectedItemsChange',this._onSortingChange.bind(this)),this.subscribeTo(o.channel('SbisDiskEvents'),'onGoToZip',this._onGoToZip.bind(this));},_onSortingChange:function(o,t){this._notify('onChangeSort',t[0]),this._changeTooltip(t[0]);},_changeTooltip:function(o){var t='SortByName'===o?rk('Отсортировано по имени по возрастанию'):rk('Отсортировано по дате по убыванию');this.setTooltip(t);},_onGoToZip:function(o,t){this._sorter_dropdown.setEnabled(!t);}});return i;});
define('js!SBIS3.EDO.CD.CommonDocsReestr',['Core/core-functions','Core/EventBus','SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.CD.CommonDocsReestr','js!SBIS3.EDO.CD.CommonDocsHelpers','js!SBIS3.EDO.CD.DiskOperations','js!SBIS3.DOCVIEW.Funcs','js!SBIS3.SBISDISK.FileEventsHandlerMixin','css!SBIS3.EDO.CD.CommonDocsReestr','js!SBIS3.DOCVIEW.List','js!SBIS3.DOCVIEW.SwitchVisibilityMode','js!SBIS3.EDO.CD.CommonDocsSorter','SbisDiskDocuments_localization'],function(e,t,n,o,i,s,r,a){'use strict';var l=n.extend([a],{_dotTplFn:o,$protected:{_options:{resizable:false,autoHeight:true,autoWidth:true,stickyHeader:false,subscribeFileEvents:false,multiselect:true,itemsSortMethod:null},_browser:null,_docviewList:null},$constructor:function(){this._publish('onChangeSort','onChangeRecent');},init:function(){l.superclass.init.call(this);var n=this,o=n.getChildControlByName('РеестрСписокОбщих'),r=o.getTreeView();if(n._browser=r,n._docviewList=o,n._options.subscribeFileEvents)n.initFileEventHandlers();this.subscribeTo(t.channel('SbisDiskCommands'),'OpenDocument',function(t,n){s.openDocument(n,e.clone(o._options));}),this.subscribeTo(t.channel('SbisDiskCommands'),'onGetFolderForUpload',function(e){e.setResult(i.getFolderForUpload(n._browser));});var a;this.subscribeTo(t.channel('DragAndDropEvents'),'onStartDrag',function(e){if(!a)a=$('.cd-cdArea__drag-and-drop-upload-dest-folder');var t=i.getFolderForUpload(n._browser),o=t&&t.Name?t.Name:null;if(!o){var s=n.getLinkedContext().getValue('currentFolder');o=s?s.name:null;}if(o)a.html(o);e.setResult(o||rk('Документы'));}),this.subscribeTo(t.channel('SbisDiskEvents'),'onUpdateRow',this.onUpdateRow.bind(this)),this.subscribeTo(t.channel('SbisDiskEvents'),'onCancelOperation',this._onCancelOperationHandler.bind(this)),o.waitChildControlByName('cdSorter').addCallback(function(e){return n.subscribeTo(e,'onChangeSort',function(e,t){n._notify('onChangeSort',t);}),e;}),this.subscribeTo(this._docviewList,'onAfterChangeHoverItem',this._onAfterChangeHoverItem.bind(this)),n.once('onDestroy',function(){n._browser=null,n._docviewList=null;});},onUpdateRow:function(e,t){var n=this.getChildControlByName('РеестрСписокОбщих'),o=n.getTreeView().getItems().getRecordById(t);if(o)(0===o.get('Type')?r.readFolderInfo:r.readAttachmentInfo)({objectName:'FileSD',serviceUrl:i.getDiskServiceURL(),id:t}).addCallback(function(e){n.redrawItemDocview(t,e);});},_onCancelOperationHandler:function(e,n){if('TakeAwayHardLink'===n.operationName||'Copy'===n.operationName)if(n.ids&&n.ids[0]&&n.ids[0].SourceId)t.channel('SbisDiskEvents').notify('onUpdateRow',n.ids[0].SourceId);},_onAfterChangeHoverItem:function(e,t,n){var o=t&&t.record,i=o&&!o.get('canDelete'),s=o&&o.get('Flags')&&o.get('Flags').get('Shared');if(n['links']&&n['links'].isVisible())n['links'].getContainer().toggleClass('ws-hidden',!i);if(n['rights'])n['rights'].setTooltip(s?rk('В публичном доступе'):rk('Права доступа'));},onChangeInRecent:function(e){this._notify('onChangeRecent',e);}});return l;});
define("html!SBIS3.EDO.CD.CommonDocsFilter",function(){var o=function(o){var n=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;o.test(n);)n=n.replace(o,"&#123;&#123;$1&#125;&#125;");return n}}(),t=function(o){return o.join?o.join(""):o.toString()},e=function(o){return void 0===o?"":o&&"object"==typeof o?t(o):""+o},i="undefined"!=typeof process,p=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="cd-commonDocsFilter"> <div class="cd-commonDocsFilter__period-row"> <component data-component="SBIS3.CONTROLS/DropdownList" name="ФильтрДатаПериод" class="cd-commonDocsFilter__FilterDataPeriod controls-DropdownList__withoutArrow controls-DropdownList__linkStyle controls-DropdownList__withoutCross"> <options name="items" type="array"> <options> <option name="key" value="Все"></option> <option name="title" value="'+n(e(rk("За весь период")))+'"></option> </options> <options> <option name="key" value="Сегодня"></option> <option name="title" value="'+n(e(rk("За сегодня")))+'"></option> </options> <options> <option name="key" value="Месяц"></option> <option name="title" value="'+n(e(rk("За последний месяц")))+'"></option> </options> <options> <option name="key" value="Полгода"></option> <option name="title" value="'+n(e(rk("За последние полгода")))+'"></option> </options> <options> <option name="key" value="Год"></option> <option name="title" value="'+n(e(rk("За последний год")))+'"></option> </options> <options> <option name="key" value="Период"></option> <option name="title" value="'+n(e(rk("За период")))+'"></option> </options> </options> <option name="idProperty">key</option> <option name="displayProperty">title</option> <option name="editable">false</option> <option name="mode">click</option> <option name="multiselect">false</option> <options name="selectedKeys" type="array"> <option bind="ФильтрДатаПериод" nonexistent="none" value="Все"></option> </options> <option name="text" bind="ФильтрДатаПериодТекст" direction="fromProperty" oneWay="true"/> <options name="handlers"> <option name="onSelectedItemsChange" value="js!SBIS3.EDO.CD.CommonDocsFilter:prototype.onChangeFilterPeriod" type="function"></option> </options> </component> <div class="cd-commonDocsFilter__period-text" data-bind="html: periodText"></div> <component data-component="SBIS3.CONTROLS/Date/Range" name="ФильтрДат"> <option name="tabindex" value="3"></option> <option name="visible" value="false"></option> <option name="name" value="ФильтрДат"></option> <option name="serializationMode" value="datetime"></option> <option name="dateFromName" value="ФильтрДатаС"></option> <option name="dateToName" value="ФильтрДатаП"></option> <option name="extendedTooltip" value="false" type="boolean"></option> <option name="startDate" value="Все" bind="ФильтрДатаС" nonexistent="none"/> <option name="endDate" value="Все" bind="ФильтрДатаП" nonexistent="none"/> <options name="validators" type="array"> <options> <option name="validator" value="js!SBIS3.EDO.CD.CommonDocsFilter:prototype.periodAndDateValidation" type="function"></option> </options> </options> </component> </div> <component data-component="SBIS3.CONTROLS/DropdownList" name="OnlyDeleted" class="cd-commonDocsFilter__FilterDeleted controls-DropdownList__withoutArrow controls-DropdownList__linkStyle controls-DropdownList__withoutCross"> <options name="items" type="array"> <options> <option name="key" value="Все"></option> <option name="title" value="'+n(e(rk("Все")))+'"></option> </options> <options> <option name="key" value="True"></option> <option name="title" value="'+n(e(rk("Удаленные")))+'"></option> </options> </options> <option name="idProperty">key</option> <option name="displayProperty">title</option> <option name="editable">false</option> <option name="mode">click</option> <option name="multiselect">false</option> <options name="selectedKeys" type="array"> <option bind="OnlyDeletedFilter" nonexistent="none" value="Все"></option> </options> <option name="text" bind="OnlyDeletedText" direction="fromProperty" oneWay="true"/> <option name="visible" bind="visibleDeletedFilter">'+n(e(o.visibleDeleted))+"</option> </component> </div>");return(p=n(p))+(i&&-1!==p.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.CD.CommonDocsFilter"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.CD.CommonDocsFilter", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".cd-commonDocsFilter{margin-left:8px;width:100%;min-height:26px}.cd-commonDocsFilter__label{float:left;text-align:right;margin-right:14px;font-size:11px;padding-top:2px}.cd-commonDocsFilter__label-big{float:left;padding-right:7px}.cd-commonDocsFilter__FilterDeleted{margin-top:8px}.cd-commonDocsFilter__order-filter{width:100%;max-height:24px}.cd-commonDocsFilter__FilterSorting .ws-field-dropdown{background-color:transparent}.cd-commonDocsFilter__filter_title{font-size:18px!important;color:#000!important;left:16px}.cd-commonDocsFilter__filterDat-block{margin-top:8px;display:inline-block}.cd-commonDocsFilter__period-text{display:inline-block;margin-left:8px;line-height:24px;color:#ccc}.cd-commonDocsFilter__period-row{width:100%;height:auto}"));head.appendChild(style);});}
define('js!SBIS3.EDO.CD.CommonDocsFilter',['Core/EventBus','SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.CD.CommonDocsFilter','css!SBIS3.EDO.CD.CommonDocsFilter','SBIS3.CONTROLS/DropdownList','SBIS3.CONTROLS/Date/Range','SbisDiskDocuments_localization'],function(e,t,i){var n=t.extend({_dotTplFn:i,$protected:{_options:{autoHeight:true,autoWidth:true}},$constructor:function(){this.getLinkedContext().setValue('periodText','');},init:function(){n.superclass.init.call(this);var t=this;this.subscribeTo(e.channel('CDFilterEvents'),'onChangeVisibleDeletedFilter',function(e,i){t.getLinkedContext().setValue('visibleDeletedFilter',i);}),this.waitChildControlByName('ФильтрДатаПериод').addCallback(function(e){var i=e.getSelectedKeys()[0];if('Период'===i)t.getChildControlByName('ФильтрДат').setVisible(true);return t._initPeriodText(i),e;});},onChangeFilterPeriod:function(){var e=this,t=e.getSelectedKeys()&&e.getSelectedKeys().length?e.getSelectedKeys()[0]:null;if(e.getParent()._initPeriodText(t),e.getParent().getChildControlByName('ФильтрДат').setVisible(false),'Период'===t&&e.getParent().hasChildControlByName('ФильтрДат'))e.getParent().getChildControlByName('ФильтрДат').setVisible(true);if('Период'!==t&&e.getParent().hasChildControlByName('ФильтрДат'))e.getParent().getChildControlByName('ФильтрДат').setStartDate(null),e.getParent().getChildControlByName('ФильтрДат').setEndDate(null);},periodAndDateValidation:function(){if(!this.getTopParent().hasChildControlByName('ФильтрДатаПериод'))return true;if('Период'===this.getTopParent().getChildControlByName('ФильтрДатаПериод').getSelectedKeys()[0]&&!this.getStartDate()&&!this.getEndDate())return rk('Заполните период!');return true;},_initPeriodText:function(e){var t='',i=new Date(),n=i.strftime('%d.%m.%y');if('Сегодня'===e)t=n;else if('Месяц'===e)t=new Date(i.getYear(),i.getMonth()-1,i.getDate()).strftime('%d.%m.%y')+' - '+n;else if('Полгода'===e)t=new Date(i.getYear(),i.getMonth()-6,i.getDate()).strftime('%d.%m.%y')+' - '+n;else if('Год'===e)t=new Date(i.getYear()-1,i.getMonth(),i.getDate()).strftime('%d.%m.%y')+' - '+n;this.getLinkedContext().setValue('periodText',t);}});return n;});
define("html!SBIS3.EDO.CD.CommonDocsSearchBlock",function(){var o=function(o){var n=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;o.test(n);)n=n.replace(o,"&#123;&#123;$1&#125;&#125;");return n}}(),i=function(o){return o.join?o.join(""):o.toString()},t=function(o){return void 0===o?"":o&&"object"==typeof o?i(o):""+o},e="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="cd-searchBlock"> <component data-component="SBIS3.CONTROLS/ScrollContainer"> <option name="content"> <div class="cd-searchBlock__controls"> <component data-component="SBIS3.DOCVIEW.SwitchVisibilityMode"> <option name="className">cd-searchBlock__visibility-mode-switcher</option> <options name="hasSwitch"> <option name="classic" value="false" type="boolean"></option> <option name="diskClassic" value="true" type="boolean"></option> </options> <options name="listOptions"> <options name="visibilityMode"> <option name="defaultMode">diskClassic</option> ');return o.fromPublicLink&&(a+=' <option name="autoSelect">true</option> '),a+=" </options> </options> </component> </div> <div class='cd-searchBlock__find-name-container'> <div class=\"cd-searchBlock__title\"> "+n(t(rk("Найдено в имени")))+' </div> <component data-component="SBIS3.DOCVIEW.List" name="СписокНайденоВНазвании" class="cd-searchBlock__without-back-button"> <option name="_privateMegaFixOption">true</option> <options name="mainOptions"> <option name="objectName">FileSD</option> <option name="serviceBLName">СБИСДиск.Приватный</option> <option name="serviceUrl">/disk/api/v1/</option> <option name="useOnlyCtx">false</option> <option name="multiPage">false</option> <option name="isDisk">true</option> <option name="filter" bind="listFiltersFindName"></option> <option name="commands" bind="visibleCommands"></option> </options> <options name="listOptions"> <option name="countDocWithoutScroll">0</option> <option name="root" bind="listRootFindName"></option> <option name="autoQuery">false</option> <option name="needMoreButton">true</option> <option name="pageSize">10</option> <option name="itemsDragNDrop">false</option> <option name="infiniteScroll">false</option> <option name="allowEmptySelection">true</option> <option name="multiselect">false</option> <option name="enableExpand">false</option> <options name="visibilityMode"> <option name="autoSelect">false</option> <option name="defaultMode">diskClassic</option> <option name="setFromCookie">false</option> </options> <option name="hideBreadCrumbs">true</option> </options> <options name="viewOptions"> <option name="canEditFED">false</option> </options> </component> </div> <div class=\'cd-searchBlock__find-body-container\'> <div class="cd-searchBlock__title"> '+n(t(rk("Найдено в тексте")))+' </div> <component data-component="SBIS3.DOCVIEW.List" name="СписокНайденоВСодержимом" class="cd-searchBlock__without-back-button"> <option name="_privateMegaFixOption">true</option> <options name="mainOptions"> <option name="objectName">FileSD</option> <option name="serviceBLName">СБИСДиск.Приватный</option> <option name="serviceUrl">/disk/api/v1/</option> <option name="useOnlyCtx">false</option> <option name="multiPage">false</option> <option name="isDisk">true</option> <option name="filter" bind="listFiltersFindBody"></option> <option name="commands" bind="visibleCommands"></option> </options> <options name="listOptions"> <option name="countDocWithoutScroll">0</option> <option name="root" bind="listRootFindBody"></option> <option name="autoQuery">false</option> <option name="needMoreButton">true</option> <option name="pageSize">10</option> <option name="itemsDragNDrop">false</option> <option name="infiniteScroll">false</option> <option name="allowEmptySelection">true</option> <option name="multiselect">false</option> <option name="enableExpand">false</option> <options name="visibilityMode"> <option name="autoSelect">false</option> <option name="defaultMode">diskClassic</option> <option name="setFromCookie">false</option> </options> <option name="hideBreadCrumbs">true</option> </options> <options name="viewOptions"> <option name="canEditFED">false</option> </options> </component> </div> <div class=\'cd-searchBlock__empty-search-container\'> '+n(t(rk("По данному запросу ничего не найдено")))+" </div> </option> </component> </div>",(a=n(a))+(e&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.CD.CommonDocsSearchBlock"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.CD.CommonDocsSearchBlock", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".cd-searchBlock{height:100%}.cd-searchBlock .controls-ScrollContainer{height:100%}.cd-searchBlock__without-back-button.docview-list .controls-BackButton,.cd-searchBlock__without-back-button.docview-list .controls-BreadCrumbs{display:none}.cd-searchBlock__without-back-button{padding-bottom:16px}.cd-searchBlock__title{font-size:15px;font-family:TensorFontBold,TensorFont;font-weight:700;color:#313e78;padding-left:8px;padding-bottom:6px;padding-top:2px;height:18px}.dv-diskClassic__parent-td{width:120px;text-align:right!important;padding-right:8px!important}.dv-diskClassic__parent{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.cd-searchBlock__empty-search-container{font-size:14px;color:#999;padding-left:8px}.dv-diskClassic__parent .controls-Link{display:inline;text-align:left}.cd-searchBlock__controls{float:right;height:24px}.cd-searchBlock__visibility-mode-switcher{float:right;display:inline-block;width:24px;z-index:100;height:24px;padding-top:5px;padding-right:8px}.cd-searchBlock__cd-sorter{float:right;z-index:100;padding-right:8px}.cd-searchBlock__vertical-separator{height:20px;width:1px;background-color:#ccc;float:right;margin:2px 6px 0 3px}"));head.appendChild(style);});}
define('js!SBIS3.EDO.CD.CommonDocsSearchBlock',['Core/Indicator','SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.CD.CommonDocsSearchBlock','css!SBIS3.EDO.CD.CommonDocsSearchBlock','js!SBIS3.DOCVIEW.List','js!SBIS3.DOCVIEW.SwitchVisibilityMode','SBIS3.CONTROLS/ScrollContainer','SbisDiskDocuments_localization'],function(t,o,e){'use strict';var i=o.extend({_dotTplFn:e,$protected:{_options:{}},$constructor:function(){},init:function(){i.superclass.init.call(this);var t=this.getChildControlByName('СписокНайденоВНазвании');this._findFromNameBrowser=t.getChildControlByName('attachments');var o=this.getChildControlByName('СписокНайденоВСодержимом');this._findFromBodyBrowser=o.getChildControlByName('attachments');var e=this.getContainer();this._findNameContainer=e.find('.cd-searchBlock__find-name-container'),this._findBodyContainer=e.find('.cd-searchBlock__find-body-container'),this._emptySearchContainer=e.find('.cd-searchBlock__empty-search-container'),this.subscribeTo(this._findFromNameBrowser,'onItemClick',this._onItemClickName.bind(this)),this.subscribeTo(this._findFromBodyBrowser,'onItemClick',this._onItemClickBody.bind(this)),this.subscribeTo(this._findFromNameBrowser,'onDataLoad',this.onDataLoadName.bind(this)),this.subscribeTo(this._findFromBodyBrowser,'onDataLoad',this.onDataLoadBody.bind(this)),this.subscribeTo(this._findFromNameBrowser,'onDrawItems',this.onDrawItems),this.subscribeTo(this._findFromBodyBrowser,'onDrawItems',this.onDrawItems);},_onItemClick:function(t,o,e){if(e.get('folder@')){var i=o.getFilter();this.sendCommand('onOpenFolderFromSearch',{folderId:e.get('attachId'),rootName:i.catalogId,clearPath:true}),t.setResult(false);}},_onItemClickName:function(t,o,e){this._onItemClick(t,this._findFromNameBrowser,e),this._findFromBodyBrowser.setSelectedKey(null);},_onItemClickBody:function(t,o,e){this._onItemClick(t,this._findFromBodyBrowser,e),this._findFromNameBrowser.setSelectedKey(null);},toggleIndicator:function(){this._findFromNameBrowser._toggleIndicator(true),this._findFromBodyBrowser._toggleIndicator(true);},_onDataLoad:function(t,o,e){if(e.setSelectedKey(null),e._toggleIndicator(false),!t||!t.getCount())o.hide();else o.show();if(this._findNameIsEmpty&&this._findBodyIsEmpty)this._emptySearchContainer.show();else this._emptySearchContainer.hide();},onDataLoadName:function(o,e){this._findNameIsEmpty=!e||!e.getCount(),t.hide(),this._onDataLoad(e,this._findNameContainer,this._findFromNameBrowser);},onDataLoadBody:function(t,o){this._findBodyIsEmpty=!o||!o.getCount(),this._onDataLoad(o,this._findBodyContainer,this._findFromBodyBrowser);},onDrawItems:function(){this.setSelectedKey(null);}});return i;});
define('js!SBIS3.EDO.CD.CommonDocsFilter.CommonDocsFilterLine',['Core/helpers/string-helpers','Core/helpers/collection-helpers','SBIS3.CONTROLS/CompoundControl','SBIS3.CONTROLS/Utils/TemplateUtil','tmpl!SBIS3.CONTROLS/Filter/Button/Line/FilterLine','SbisDiskDocuments_localization'],function(e,t,i,n,l){return i.extend({_dotTplFn:l,$constructor:function(){var i=this.getLinkedContext(),l=this,r=function(){var r,o,s,a;if(i.getValue('filterChanged')){var u=false;r=(o=t.reduce(i.getValue('filterStructure'),function(e,i){if(s=n.prepareTemplate(i.itemTemplate),s){if(a=s(i),a)e.push(s(i));return e;}else if(null===s)return e;if(i.caption&&!t.isEqualObject(i.value,i.resetValue)){if('ФильтрДатаПериод'==i.internalValueField&&'За период'==i.caption)u=true;if(i.caption instanceof Date){if(u){var l=i.caption.strftime('%e %q %Y');if('ФильтрДатаС'==i.internalValueField)l=rk('с','дата начала')+' '+l;else if('ФильтрДатаП'==i.internalValueField)l=rk('по','дата конца')+' '+l;e.push(l);}}else e.push(i.caption);}return e;},[])).join(' ');}else r=i.getValue('filterResetLinkText');i.setValueSelf({linkText:r,titleText:e.escapeTagsFromStr(r,'')}),l.toggle(!!r);};r(),i.subscribe('onFieldsChanged',r),this._container.on('click','.controls__filterButton__filterLine-cross',function(){this.sendCommand('reset-filter');}.bind(this)),this._container.on('click','.controls__filterButton__filterLine-items',function(){this.sendCommand('show-filter');}.bind(this));}});});
define('js!SBIS3.EDO.CD.CommonDocsArea',['Lib/Control/Infobox/Infobox','Core/helpers/collection-helpers','Core/EventBus','Core/constants','SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.CD.CommonDocsArea','js!SBIS3.EDO.CD.CommonDocsHelpers','js!SBIS3.BL.FileSD','js!SBIS3.SBISDISK.DragAndDropUploadMixin','js!SBIS3.SBISDISK.EmptyHtmlController','css!SBIS3.EDO.CD.CommonDocsArea','SBIS3.CONTROLS/SearchForm','js!SBIS3.EDO.CD.CommonDocsReestr','js!SBIS3.EDO.CD.FolderStiker','js!SBIS3.EDO.CD.DragAndDropArea','js!SBIS3.EDO.CD.CommonDocsFilter','js!SBIS3.DOCVIEW.SwitchVisibilityMode','js!SBIS3.DOCVIEW.OperationPanel','SBIS3.CONTROLS/Filter/Button','SBIS3.CONTROLS/Filter/FastData','js!SBIS3.EDO.CD.CommonDocsSearchBlock','js!SBIS3.EDO.CD.CommonDocsFilter.CommonDocsFilterLine','SBIS3.CONTROLS/SwitchableArea','SbisDiskDocuments_localization'],function(e,t,o,i,n,r,s,a,l,u){'use strict';var c=n.extend([l],{_dotTplFn:r,$protected:{_options:{recentOptions:null,mainOptions:null,buttonsOptions:null,stickyHeader:false,subscribeFileEvents:false,fromFloatArea:false,recents:null},_startDrag:true},$constructor:function(){var e=this;e.getLinkedContext().setValue('ФильтрДатаНачалоТекст',null),e.getLinkedContext().setValue('ФильтрДатаКонецТекст',null),this._publish('onChangeSort','onChangeCurrentFolder');},init:function(){c.superclass.init.call(this);var e=true,t=this,n=this.getLinkedContext(),r=this.getChildControlByName('РеестрСписокОбщих'),a=r.getChildControlByName('attachments'),l=null,d=this.getChildControlByName('СтрокаПоискаХД'),f=this.getChildControlByName('ПанельФильтровХД');if(this._options.recentOptions.visible)l=this.getChildControlByName('Sticker'),this._sticker=l,this.subscribeTo(l,'onDragFromRecent',this._onDragFromRecent.bind(this));var h=rk('Все');n.subscribe('onFieldsChanged',function(){if(s.currentFolderIsArchive(r))return;var e=this.getValue('filters');if(e&&e.OnlyDeleted!=h)h=e.OnlyDeleted,o.channel('CDFilterEvents').notify('onChangeFilter',{OnlyDeleted:e.OnlyDeleted});});var S=function(){t.updateRightPanel(l,true);};this.subscribeTo(o.channel('SbisDiskEvents'),'onUpdateRecentFiles',S);var g=function(){t.getContainer().find('.cd-cdArea__td-stiker').removeClass('cd-cdArea__td-stiker-height');};this.subscribeTo(o.channel('SbisDiskEvents'),'onInitRecentPanel',g),this.subscribeTo(o.channel('SbisDiskEvents'),'onGoToZip',function(e,t){f.setEnabled(!t),d.setEnabled(!t);});var C=this.getChildControlByName('cdReestr');this.subscribeTo(C,'onChangeSort',function(e,o){t._notify('onChangeSort',o);}),this.subscribeTo(C,'onChangeRecent',function(e,t){l&&l.onChangeRecent(t);});var D,_,m;if(this.subscribeTo(a,'onDataLoad',function(o,i){a.setActive(true);var n=s.currentFolderIsArchive(r),c=n?null:s.getCurrentFolderIdFromViewer(a),d=n?null:s.getRootNameFromViewer(a),f=n?null:s.getCurrentPathFromViewer(i),h=n?null:s.getCurrentFolderFromViewer(i);if(f)f=JSON.stringify(f.toJSON());m=n;var S={Id:c,rootName:d,catalogId:d,name:h?h.Name:s.getRootName(d),Name:h?h.Name:s.getRootName(d),Type:0,path:f,writeAccessRight:h?h.Rights>1:true,isArchive:n};t._notify('onChangeCurrentFolder',S);var g=t.getLinkedContext().getValue('listFilters');if(r.setFolderAsPreview(g&&false===g.FoldersFirst),D==c)return;if(!n&&t._options.mainOptions.showQuota&&_!==d)t._updateQuotaInfo.call(t,d);if(D=c,_=d,u.setEmptyHTML(a,S.writeAccessRight&&!n,!t._options.fromFloatArea),r.getContainer().toggleClass('with-sign-column',d==s.ROOT_FOLDER_SIGNED),e)l&&l.changeDataSource(),e=false;}),this.subscribeTo(a,'onDataLoadError',function(e,t){var i=a.getFilter(),n={folderId:i.catalogId,rootName:i.catalogId,folderIsDeleted:false,clearPath:true};if('Archive'===r._options.mainOptions.objectName)return;if(12==t.error_code)e.setResult(true),o.channel('SbisDiskEvents').notify('onOpenFolder',n);else if(4===t.error_code)if(e.setResult(true),_==i.catalogId)s.showErrorNotification(rk('Ошибка перехода')+'!',rk('У вас нет прав на данную папку'));else o.channel('SbisDiskEvents').notify('onOpenFolder',n);}),this.subscribeTo(a,'onItemClick',function(e,t,i){if(s.currentFolderIsArchive(r))return;if(a.getFilter().SearchString&&i.get('folder@'))o.channel('SbisDiskEvents').notify('onSetEmptySearchString');if(i.get('Deleted')&&0==i.get('Type')&&i.get('Flags')&&i.get('Flags').get('IsLink'))e.setResult(false);}),this.subscribeTo(a,'onEndDrag',function(e,t){if(t.getOwner()&&t.getTargetsControl()&&t.getOwner().getId()!==t.getTargetsControl().getId())e.setResult(false);}),!this._options.fromFloatArea)if(this.subscribeTo(o.channel('SbisDiskEvents'),'onReloadList',function(e,t){if(s.currentFolderIsArchive(r))return;if(t)r.mergeFromBL({deleteItems:true});else a.reload();}),this.subscribeTo(o.channel('SbisDiskEvents'),'onCheckCanUpload',function(e,o){e.setResult(!t._quotaInfo||o<t._quotaInfo.maxSize-t._quotaInfo.currentSize);}),this.subscribeTo(o.channel('SbisDiskEvents'),'onUpdateQuotaInfo',function(e){if(!m)t._updateQuotaInfo.call(t,_);}),this._dnd_area=this.getChildControlByName('CDDragAndDropArea'),this._dnd_area.hide(),!(i.browser.isIE8||i.browser.isIE9)&&!s.idUserIsEqualIdClient())this.initDragAndDrop();},destroy:function(){if(document.ondragover=null,i.browser.firefox||i.browser.isIE)document.ondragleave=null,document.ondrop=null;this._sticker=null,c.superclass.destroy.call(this);},updateRightPanel:function(e,t){if(t&&e)e.updateRecentList();},handleAddFavorites:function(e){this._sticker&&this._sticker.handleAddFavorites(e,'addFavorites');},_updateQuotaInfo:function(t){var o=this,i=t;if(t===s.ROOT_FOLDER_LOADS||t===s.ROOT_FOLDER_SHARED||t===s.ROOT_FOLDER_SIGNED||t===s.ROOT_FOLDER_MY_TRASH)i=s.ROOT_FOLDER_MY;else if(t===s.ROOT_FOLDER_COMMON_TRASH)i=s.ROOT_FOLDER_COMMON;o._rootNameForRequest=i,a.GetQuota(i).addCallback(function(t){if(!o._quotaContainer){var i=$('#headerLeftAppliedContainer');i.append('<div class="sbisDisk__qouta-container">'+'<div class="icon-16 icon-SbisDisk icon-primary sbisDisk__qouta-icon"></div>'+'<div class="sbisDisk__qouta-info"></div>'+'</div>'),o._quotaContainer=i.find('.sbisDisk__qouta-info'),o._showQuotaTimer=void 0;var n=function(){var t=o._quotaInfo.currentSize/o._quotaInfo.maxSize*100,i=rk('Занято')+': '+o._quotaInfo.busySizeText;e.show({control:o._quotaContainer,hideDelay:2000,message:'<div class="sbisDisk__qouta-title">'+s.getRootName(o._rootNameForRequest)+'</div>'+'<div class="sbisDisk__quota-progressbar-container" title="'+i+'">'+'<div class="sbisDisk__progressbar" style="width: '+Math.floor(234*t/100)+'px;"></div>'+'</div>'+'<div>'+rk('Свободно')+' '+'<span>'+o._quotaInfo.freeSizeText+'</span> '+rk('из','часть')+' '+'<span>'+o._quotaInfo.maxSizeText+'</span>'+'</div>'});};i.find('.sbisDisk__qouta-container').mouseover(function(){if(!o._showQuotaTimer)o._showQuotaTimer=setTimeout(n,500);}).mouseleave(function(){if(o._showQuotaTimer)clearTimeout(o._showQuotaTimer),o._showQuotaTimer=void 0;});}o._updateQuota(t.get('CurrentSize'),t.get('MaxSize'));});},_updateQuota:function(e,t){var o=this,i=e;if(!o._quotaContainer)return;if(e>t)e=t;var n=s.getPrettyFileSizeForQuota(i),r=s.getPrettyFileSizeForQuota(t),a=e?s.getPrettyFileSizeForQuota(t-e):r;if(e>0&&a==r)a=e?s.getPrettyFileSizeForQuota(t-100*1024*1024):'-';o._quotaContainer.text(rk('свободно')+' '+a+' '+rk('из','часть')+' '+r),o._quotaInfo={currentSize:e,maxSize:t,freeSizeText:a,maxSizeText:r,busySizeText:n};},_checkSize:function(e){var i=0;return t.forEach(e.files,function(e){i+=e.size;}),t.forEach(e.folders,function(e){i+=e.size;}),o.channel('SbisDiskEvents').notify('onCheckCanUpload',i);},_onDragFromRecent:function(e,t){var o=this.getChildControlByName('РеестрСписокОбщих').getTreeView();if(t.getTargetsControl()!==o)return;var i=o.getFilter();if(i['catalogId']!==s.ROOT_FOLDER_COMMON&&i['catalogId']!==s.ROOT_FOLDER_MY)return;var n=[];t.getSource().each(function(e){n.push(e.getModel().getId());});var r=i['folder'];a.Copy(n,r).addCallbacks(function(e){},function(e){s.showErrorNotification(rk('Ошибка при копировании'),e.message);});}});return c;});
define("html!SBIS3.EDO.CD.Buttons",function(){var t=function(t){var n=function(){var t={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},n=/&(?!#?\w+;)|<|>|"|'|\//g;return function(o){return o?o.toString().replace(n,function(n){return t[n]||n}):o}}(),o=function(){var t=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;t.test(n);)n=n.replace(t,"&#123;&#123;$1&#125;&#125;");return n}}(),e=function(t){return t.join?t.join(""):t.toString()},a=function(t){return void 0===t?"":t&&"object"==typeof t?e(t):""+t},i="undefined"!=typeof process,r=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="cd-buttons"> <table class="cd-buttons__table ');return t.onlyOperationsButton||(r+="cd-buttons__main-container"),r+='"> <tr> ',t.onlyOperationsButton?r+=' <td> <component data-component="SBIS3.CONTROLS/OperationsPanel/PanelButton/OperationsPanelButton" name="КнопкаПанелиМассовыхОперацийОбщихДокументов" class="cd-buttons__action-panel-btn"> <option name="panelFloatDirection" value="horizontal"></option> <option name="allowChangeEnable" value="true" type="boolean"></option> </component> </td> ':(r+=' <td> <component data-component="SBIS3.CONTROLS/Menu/MenuButton" name="LoadDocumentBtn" class="cd-buttons__load-btn"> <option name="caption">'+o(a(rk("Загрузить")))+'</option> <option name="primary" type="boolean">true</option> </component> </td> <td class="cd-buttons__td-padding-left"> <div class="cd-buttons__create-btn-container"> <component data-component="SBIS3.CONTROLS/Menu/MenuButton" name="CreateDocumentBtn"> <option name="caption">'+o(a(rk("Создать")))+'</option> </component> </div> </td> <td class="cd-buttons__td-padding-left ',t.addFolderButton.visible||(r+=" ws-hidden"),r+='"> <component data-component="SBIS3.CONTROLS/Button/IconButton" name="СоздатьПапку" class="cd-buttons__create-folder"> <option name="icon" value="sprite:icon-24 icon-CreateFolder icon-primary"></option> <option name="tooltip" value="'+o(a(n(t.addFolderButton.tooltip)))+'"></option> <option name="visible" value="'+o(a(t.addFolderButton.visible))+'"></option> <option name="clickThrottle" value="true"></option> </component> </td> <td class="cd-buttons__td-padding-left"> <div class="cd-buttons__vertical-separator"></div> </td> <td> <component data-component="SBIS3.CONTROLS/OperationsPanel/PanelButton/OperationsPanelButton" name="КнопкаПанелиМассовыхОперацийОбщихДокументов" class="cd-buttons__action-panel-btn"> <option name="panelFloatDirection" value="horizontal"></option> <option name="allowChangeEnable" value="true" type="boolean"></option> </component> </td> '),r+=" </tr> </table> </div>",(r=o(r))+(i&&-1!==r.indexOf("{{")?String.fromCharCode(8203,8203):"")};return t.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.CD.Buttons"}},t});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.CD.Buttons", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".cd-buttons{height:32px}.cd-buttons__main-container{padding-left:12px;margin-top:5px}.cd-cdPublicArea__buttons .cd-buttons__main-container{margin-top:6px}.cd-buttons__main-container-firefox{margin-top:4px}.cd-buttons__vertical-separator{height:24px;width:1px;background-color:#ccc}.cd-buttons__td-padding-left{padding-left:12px}.cd-buttons__pp-create-icon .controls-MenuItem__icon{color:#ef463a!important}"));head.appendChild(style);});}
define('js!SBIS3.EDO.CD.Buttons',['Core/Indicator','Core/EventBus','Core/Deferred','Core/constants','SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.CD.Buttons','js!SBIS3.EDO.CD.CommonDocsHelpers','js!SBIS3.EDO.CD.UploadLongOperationsProducer','SBIS3.CONTROLS/LongOperations/Manager','js!SBIS3.EDO.CD.Notification','js!SBIS3.BL.FileSD','js!SBIS3.DOCVIEW.SBISBufferMixin','js!SBIS3.DOCVIEW.ScanMixin','js!SBIS3.DOCVIEW.UploadMixin','js!SBIS3.DOCVIEW.Funcs','css!SBIS3.EDO.CD.Buttons','SBIS3.CONTROLS/Button/IconButton','SBIS3.CONTROLS/Menu/MenuLink','SBIS3.CONTROLS/Menu/MenuButton','SBIS3.CONTROLS/OperationsPanel/PanelButton/OperationsPanelButton','js!SBIS3.DOCVIEW.BufferList','SbisDiskDocuments_localization'],function(e,t,o,i,n,r,s,a,l,c,d,u,f,h,p){'use strict';var _=n.extend({_dotTplFn:r,$protected:{_options:{onlyOperationsButton:false,addFolderButton:{tooltip:rk('Создать папку'),visible:true},addWebLinkVisible:true,loadFromDocsVisible:false,canUploadFolder:true,mainOptions:{objectName:'FileSD',serviceUrl:'/disk/api/v1/',serviceBLName:'СБИСДиск.Приватный',useOnlyCtx:false,isDisk:true,fixId:null,filter:{catalogId:null},_isAuth:true},linkedList:null,hasClipboardLink:true,allowAttachFoldersFromSbisBuffer:true,readOnly:false,loadItems:[{id:'loadFromDisk',title:rk('С компьютера')},{id:'sbisbuffer',className:'docview-attachTo__buffer-menu-item',icon:'sprite:icon-24 icon-Paste icon-primary',title:'<component data-component="SBIS3.DOCVIEW.BufferList"></component>'},{id:'mobilebuffer',title:'<component data-component="SBIS3.DOCVIEW.BufferList">'+'<option name="typeBuffer">mobile</option>'+'<option name="isActiveButton">true</option>'+'</component>',icon:'icon-Paste icon-primary',className:'docview-attachTo__buffer-menu-item'},{id:'fromDocs',icon:'sprite:icon-24 icon-Unfavourite icon-primary',title:rk('Из документов'),visible:true},{id:'fromScan',icon:'sprite:icon-24 icon-Scan icon-primary',title:rk('Скан'),visible:true}],createItems:[{id:'docx',icon:'sprite:icon-24 icon-TFDocumentW icon-primary',title:rk('Документ Word'),visible:true},{id:'xlsx',icon:'sprite:icon-24 icon-TFDocumentX icon-done',title:rk('Таблицу Excel'),visible:true},{id:'pptx',icon:'sprite:icon-24 icon-TFDocumentP icon-hover',title:rk('Презентацию PowerPoint'),visible:true,className:'cd-buttons__pp-create-icon'},{id:'link',icon:'sprite:icon-24 icon-Link icon-primary',title:rk('Ссылку на Web-ресурс'),visible:true}]}},_currentFolder:null,_modifyOptions:function(e){if(e.loadItems[3].visible=e.loadFromDocsVisible,e.createItems[3].visible=e.addWebLinkVisible,i.browser.isMobilePlatform)e.loadItems[0].title=rk('С устройства'),e.loadItems[4].visible=false,e.loadItems[2].visible=false;var t=p.checkDeviceSupportOfficeOnline(true);if(!t.word)e.createItems[0].visible=false;if(!t.excel)e.createItems[1].visible=false;if(!t.powerpoint)e.createItems[2].visible=false;return e;},init:function(){_.superclass.init.call(this);var o=this;if(o._currentUploadSession=[],this._options.allowAttachFoldersFromSbisBuffer=true,!this._options.onlyOperationsButton)this._controls={loadMenuButton:this.getChildControlByName('LoadDocumentBtn'),createMenuButton:this.getChildControlByName('CreateDocumentBtn'),createFolderButton:this.getChildControlByName('СоздатьПапку'),mainContainer:this.getContainer(),folderSeparator:this.getContainer().find('.cd-buttons__vertical-separator')};else this._controls={mainContainer:this.getContainer(),folderSeparator:this.getContainer().find('.cd-buttons__vertical-separator')};if(this._controls.massPanelButton=this.getChildControlByName('КнопкаПанелиМассовыхОперацийОбщихДокументов'),i.browser.firefox)this._controls.mainContainer.find('.cd-buttons__main-container').addClass('cd-buttons__main-container-firefox');if(this._hasAccessWrite=true,i.browser.isIE8)this.getContainer().find('.cd-buttons__create-btn-container').addClass('ws-hidden');var n=p.checkDeviceSupportOfficeOnline(true);if(!n.word&&!n.excel&&!n.powerpoint)this.getContainer().find('.cd-buttons__create-btn-container').addClass('ws-hidden');if(this._initLongOperations(),this.subscribeTo(s.uploader,'Complete',function(e,i,n){if(n.versionId&&n.versionId.indexOf('_')>-1)d.NotifyRecentFileById(n.id);for(var r=0;r<o._currentUploadSession.length;r++)if(o._currentUploadSession[r].uploadId===i){o._currentUploadSession[r].attachId=n.id;break;}o._addUploadSession(),t.channel('SbisDiskEvents').notify('onChangeDocumentsList',{type:'upload',id:n.id});}),this.subscribeTo(s.uploader,'Error',function(e){o._addUploadSession();}),this.subscribeTo(s.uploader,'Start',function(e,t){o._currentUploadSession.push({uploadId:t.id,isFolder:t.isFolder});}),!this._options.onlyOperationsButton)this.subscribeTo(this._controls.createFolderButton,'onActivated',this.onCreateFolderButtonClick.bind(this));function r(){var e=o.getFolderForUpload().attachId||o._currentFolder.Id;s.uploadFile(void 0,e,{canUploadFolder:o._options.canUploadFolder});}function a(e,t,o,i,n){var r=n?n+'/':'',s=location.protocol.split(':')[0];return'//'+location.host+'/docview/create/'+e+'/'+i+'/'+encodeURIComponent(t)+'/'+encodeURIComponent(s+'/')+'/'+o+'/'+r;}if(!this._options.onlyOperationsButton)this.subscribeTo(this._controls.loadMenuButton,'onMenuItemActivate',function(e,t,i){if('sbisbuffer'===t||'mobilebuffer'===t)return;var n=o.getFolderForUpload();if(!o._checkRightsForUpload(n))return;if('loadFromDisk'===t)r();else if('fromDocs'===t)o._loadFromDocs.call(o);else if('fromScan'===t)o._scan();});if(!this._options.onlyOperationsButton)o.subscribeTo(o._controls.createMenuButton,'onMenuItemActivate',function(e,t,i){if('link'===t)o._createWebLink.call(o);else{var n=o.getFolderForUpload(),r=a(t,'FileSD',encodeURIComponent(n.attachId||o._currentFolder.Id),'disk');if(!o._checkRightsForUpload(n))return;window.open('about:blank','_blank').location.href=r;}});if(this.subscribeTo(t.channel('createOfficeDocument'),'onCreate',o.createOfficeDocHandler.bind(o)),this.subscribeTo(t.channel('SbisDiskEvents'),'onUploadObjects',this.onUploadFile.bind(this)),this.subscribeTo(t.channel('SbisBufferEvents'),'onInsertLink',function(i,n,r,a){if(o.getId()===a){var l=o.getFolderForUpload();s.createWebLinkFile(n,r,l.attachId||o._currentFolder.Id).addCallbacks(function(o){e.hide(),t.channel('SbisDiskEvents').notify('onChangeDocumentsList',{type:'create'});},function(t){e.hide(),s.showNotificationWithoutBody(rk('Не удалось создать ссылку'),'error',5000);});}}),!this._options.onlyOperationsButton)o.setSbisBufferEventHandlers(this._controls.loadMenuButton),this._controls.loadMenuButton.setItems(this._options.loadItems),this._controls.createMenuButton.setItems(this._options.createItems);},_initLongOperations:function(){l.register(a.getInstance());},onCreateFolderButtonClick:function(e){var o=this,i=o.getFolderForUpload();if(!o._checkRightsForUpload(i))return;if(i.attachId)d.GenerateFolderName(i.attachId,rk('Новая папка')).addBoth(function(e){require(['js!SBIS3.EDO.CD.FolderDialog'],function(n){n.createFolder(i.attachId,{objectName:'string'==typeof e?e:'',opener:o}).addCallback(function(e){if(e)t.channel('SbisDiskEvents').notify('onReloadList',true);});});});},createOfficeDocHandler:function(e,o){d.NotifyRecentFileById(o),t.channel('SbisDiskEvents').notify('onChangeDocumentsList',{type:'create',id:o});},_setStateControls:function(e,t){var o=this,i=[o._controls.loadMenuButton,o._controls.createMenuButton,o._controls.createFolderButton];o.setVisible(true),o.setEnabled(true),i.forEach(function(o){o.setEnabled(e),o.getContainer().attr('title',e?'':t);});},onCurrentFolderChange:function(e){var t=this;if(t._controls.massPanelButton.setEnabled(!e.isArchive),e.isArchive&&t._controls.massPanelButton&&t._controls.massPanelButton.getLinkedPanel())t._controls.massPanelButton.getLinkedPanel().toggle(false);if(e.isArchive)return t._setStateControls(false,rk('Невозможна загрузка в данную папку')),void(t._currentFolder=e);if(e.rootName==s.ROOT_FOLDER_COMMON_TRASH||e.rootName==s.ROOT_FOLDER_MY_TRASH||e.rootName==s.ROOT_FOLDER_LOADS||e.rootName==s.ROOT_FOLDER_SIGNED||e.rootName==s.ROOT_FOLDER_SHARED&&e.Id==s.ROOT_FOLDER_SHARED)return t._setStateControls(false,rk('Невозможна загрузка в данную папку')),void(t._currentFolder=e);var i=new o();if(i.addCallback(function(e){if(!t._options.onlyOperationsButton)t._setStateControls.call(t,e,rk('Недостаточно прав для выполнения действия'));}),t._options.readOnly)i.callback(false);else if(e.Id!==s.ROOT_FOLDER_COMMON&&null!==e.writeAccessRight)i.callback(e.writeAccessRight);else if(t._options.onlyOperationsButton)i.callback(false);else d.AccessRightData(e.Id).addCallbacks(function(e){e=e.getRecords()[0],i.callback(e.get('Rights')>=2);},function(e){i.callback(true);});t._currentFolder=e,t._options.mainOptions.fixId=e.Id,t._options.mainOptions.filter.catalogId=e.rootName;},_onFinish:function(e,o,i){if(!o&&Boolean(i&&i.isExternal))d.NotifyRecentFileById(e);t.channel('SbisDiskEvents').notify('onChangeDocumentsList',{type:'upload',id:e});},onUploadFile:function(e,t){if(this._options.readOnly||this.getLinkedContext().getValue('isSearch'))return void s.showNotificationWithoutBody(rk('Запрещена загрузка в данное расположение!'),'error',5000);var o=this;t&&t.forEach(function(e){o.uploadObject(e);});},_loadFromDocs:function(){var e=this,o=e.getFolderForUpload(),i={opener:this,destinationFolderId:encodeURIComponent(o.attachId||e._currentFolder.Id),selectedTabsId:'mydocs',defaultTypeSwitcher:'link',componentHandlers:{onAttachFiles:function(e,o){t.channel('SbisDiskEvents').notify('onChangeDocumentsList',{type:'create'});}}};require(['js!SBIS3.SBISDISK.AttachDocuments'],function(e){e.show(i);});},setReadOnly:function(e){this._options.readOnly=e,this._setStateControls(!e,rk('Невозможна загрузка в данную папку'));},_createWebLink:function(){var e=this,o=e.getFolderForUpload();if(!e._checkRightsForUpload(o))return;require(['Lib/Control/Dialog/Dialog'],function(i){new i({template:'js!SBIS3.DOCVIEW.AddLink',opener:e,autoHeight:true,resizeable:false,width:'400px',autoWidth:false,caption:rk('Web-ссылка'),handlers:{onBeforeClose:function(i,n,r,a){if(!n)return;var l=this,r=n.url,a=n.title,c=s.webLinkInfo(r);if(c.inDisk)d.ReadByObject(c.objectId).addCallbacks(function(i){d.CreateLink(i.get('Id'),o.attachId||e._currentFolder.Id).addCallbacks(function(e){var o=e.getRecords()[0];if(o.get('ErrorMsg'))s.showErrorNotification(rk('Не удалось создать ссылку'),o.get('ErrorMsg'));else d.NotifyRecentFileById(o.get('Id')),t.channel('SbisDiskEvents').notify('onChangeDocumentsList',{type:'create'});},function(e){s.showErrorNotification(rk('Не удалось создать ссылку'),e.message);});},function(e){s.showErrorNotification(rk('Не удалось создать ссылку'),e.message);});else{if('.url'!==a.substr(a.length-4))a=(a+='.url').replace('..','.');d.GenerateFolderName(o.attachId||e._currentFolder.Id,a).addBoth(function(i){a='string'==typeof i?i:a,s.createWebLinkFile(a,r,o.attachId||e._currentFolder.Id).addCallbacks(function(e){try{var o=JSON.parse(e);if(o.fileid)d.NotifyRecentFileById(o.fileid);}catch(e){}t.channel('SbisDiskEvents').notify('onChangeDocumentsList',{type:'create'});},function(e){var t;try{t=JSON.parse(e.message);}catch(e){t={message:rk('Неизвестная ошибка'),details:rk('Неизвестная ошибка')};}s.showErrorNotification(rk('Не удалось создать ссылку'),t.message);});});}}}});});},getFolderForUpload:function(){return t.channel('SbisDiskCommands').notify('onGetFolderForUpload')||{};},_checkRightsForUpload:function(e){if(e&&false===e.canEdit)return c.show(rk('Загрузка файлов запрещена'),rk('Недостаточно прав для выполнения действия'),{cancellable:false,style:'error'}),false;return true;},_createFiltersForAttachFile:function(){var e=this.getFolderForUpload().attachId||this._currentFolder.Id;this._options.mainOptions.fixId=e;},getDestinationFolder:function(){var e=this.getFolderForUpload();return this._options.destinationDir=e.attachId||this._currentFolder.Id,this._options.destinationDir;},_addUploadSession:function(){var e=this;if(1===s.uploader.getQueueCount())require(['js!SBIS3.BL.SbisBuffer'],function(t){var o=[],i=[];e._currentUploadSession.forEach(function(e){if(!e.attachId||-1!==i.indexOf(e.attachId))return;o.push({attachId:e.attachId,objectName:'FileSD',serviceUrl:s.getDiskServiceURL(),'folder@':e.isFolder}),i.push(e.attachId);}),t.AddObjects(o),e._currentUploadSession=[];});},uploadObject:function(e){var o=this,i=o.getFolderForUpload(),n=i.attachId||o._currentFolder.Id,r=o._currentFolder.rootName,a=!r||r===s.ROOT_FOLDER_MY||r===s.ROOT_FOLDER_COMMON||-1!=r.indexOf('socialnetwork');if(o._currentFolder.isArchive)a=false;if(!a)return void s.showErrorNotification(rk('Загрузка файлов запрещена'),rk('Не допускается загрузка файлов в текущую папку'));if(!o._checkRightsForUpload(i))return;if(!t.channel('SbisDiskEvents').notify('onCheckCanUpload',e.size))return void s.showErrorNotification(rk('Недостаточно свободного места для загрузки!'),e.name);if(e instanceof File)s.uploader.upload(e.size>104857600?'browser_big_file':'browser',e.name,e.size,{file:e,folder:n});else s.uploader.upload('browser',e.name,e.size,{file:e,path:e.path,folder:n,isFolder:e.isFolder,rootId:e.rootId});}});return _.mixin([u,f,h]);});
define("tmpl!SBIS3.EDO.CD.MyDocsTabs",["Core/tmpl/js/tclosure","js!SBIS3.CONTROLS/Tab/Buttons"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.CONTROLS/Tab/Buttons"]=e[1];var o=function e(o,s,n,a,i){function c(){}var l=0,u=void 0!==t&&t?t:arguments[arguments.length-1];void 0===u&&(eval("var thelpers = null;"),u=global.requirejs("View/Runner/tclosure"));var d={};i&&i.isSetts&&(d=i.fullContext||{});var m="string"==typeof n?n:"",p=void 0===r?void 0:r,y={id:[],def:void 0},v=u.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,o),b=this&&this.includedTemplates?this.includedTemplates:{},f=u.getMarkupGenerator(a);try{var S=f.joinElements([f.createTag("div",{class:"mydocsTabs"},[f.createControl("wsControl","ws:SBIS3.CONTROLS/Tab/Buttons",{name:"MyDocsTabButtons",className:"cdButtons__mydocs-tabs",displayProperty:"title",idProperty:"id",items:u.getter(o,["tabItems"])},{name:"MyDocsTabButtons",sbisname:"MyDocsTabButtons"},{data:o,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:v},n,p,b,u.config,d)],s,y,this)],m,y);y.def&&(S=f.chain(S,y,s),y=void 0)}catch(e){u.templateError("resources/SbisDiskDocuments/Base/PageComponent/MyDocsTabs.tmpl",e,o)}return S||""};return o.includedFunctions={},o.stable=!0,o.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.CD.MyDocsTabs"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.CD.MyDocsTabs", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(""));head.appendChild(style);});}
define('js!SBIS3.EDO.CD.MyDocsTabs',['SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.CD.MyDocsTabs','js!SBIS3.EDO.CD.CommonDocsHelpers','css!SBIS3.EDO.CD.MyDocsTabs','SBIS3.CONTROLS/Tab/Buttons','SbisDiskDocuments_localization'],function(t,s,e){var i=t.extend({_dotTplFn:s,$protected:{_options:{tabItems:[{title:rk('Со мной поделились'),id:'Входящие'},{title:rk('Я подписал'),id:'Подписанные'},{title:rk('Диск'),id:'Документы'},{title:rk('Диск'),id:'ОбщиеДокументы',visible:false}]}},$constructor:function(){this._publish('onChangeCDTab');},init:function(){i.superclass.init.call(this);var t=this;this.subscribeTo(this.getChildControlByName('MyDocsTabButtons'),'onSelectedItemChange',function(s,i){var o;switch(i){case'Документы':o=e.ROOT_FOLDER_MY;break;case'Входящие':o=e.ROOT_FOLDER_SHARED;break;case'Подписанные':o=e.ROOT_FOLDER_SIGNED;break;case'ОбщиеДокументы':o=e.ROOT_FOLDER_COMMON;break;default:o=e.ROOT_FOLDER_MY;}if(i)t._notify('onChangeCDTab',o);});},destroy:function(){i.superclass.destroy.call(this);}});return i;});
define("html!SBIS3.EDO.CD.PublicCommonDocs",function(){var o=function(o){var n=function(){var o={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},n=/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(n,function(n){return o[n]||n}):t}}(),t=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;o.test(n);)n=n.replace(o,"&#123;&#123;$1&#125;&#125;");return n}}(),e=function(o){return o.join?o.join(""):o.toString()},i=function(o){return void 0===o?"":o&&"object"==typeof o?e(o):""+o},p="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="cd-cdArea cd-cdPublicArea cdPageUnready"> <div class="cd-cdArea__header-container"> <div class="cd-cdArea__header-panel"> <div class="icon-24 icon-TFFolder icon-disabled cd-cdArea__folder-ico"></div> <div class="cd-cdArea__folder-name">'+t(i(n(o.folderName)))+"</div> ");return o.isAuthorized||(a+=' <component name="authBtn" data-component="Deprecated/Controls/LinkButton/LinkButton" class="cd-cdArea__auth-btn"> <option name="tooltip">'+t(i(rk("Авторизоваться в системе")))+'</option> <option name="caption">'+t(i(rk("Войти")))+'</option> <option name="id">authBtn</option> <option name="allowChangeEnable">false</option> <option name="enable">true</option> <option name="renderStyle">asLink</option> <option name="imageAlign">left</option> <option name="tabindex">1</option> </component> '),a+=' <component data-component="SBIS3.CONTROLS/Toolbar" name="FolderCommands" class="cd-cdArea__header-btn ',o.isAuthorized||(a+="hide-menu-button"),a+='"> <option name="idProperty">id</option> <option name="parentProperty">parent</option> <option name="displayProperty">caption</option> <options name="items" type="array"> <options> <option name="id">rightsFolder</option> <option name="componentType">SBIS3.CONTROLS/Button/IconButton</option> <option name="name">rightsFolder</option> <option name="caption">'+t(i(rk("Права доступа")))+'</option> <option name="tooltip">'+t(i(rk("Права доступа")))+'</option> <option name="icon">sprite:icon-24 icon-Groups icon-primary</option> <option name="visible">'+t(i(o.isAuthorized))+"</option> ",o.isAuthorized&&(a+=' <option name="showType">1</option> '),a+=' </options> <options> <option name="id">downloadBtn</option> <option name="componentType">SBIS3.CONTROLS/Button/IconButton</option> <option name="name">downloadBtn</option> <option name="caption">'+t(i(rk("Скачать")))+'</option> <option name="tooltip">'+t(i(rk("Скачать папку")))+'</option> <option name="showType">1</option> <option name="icon">sprite:icon-24 icon-Save icon-primary</option> </options> <options> <option name="id">getLinkBtn</option> <option name="componentType">SBIS3.CONTROLS/Button/IconButton</option> <option name="name">getLinkBtn</option> <option name="caption">'+t(i(rk("Ссылки")))+'</option> <option name="tooltip">'+t(i(rk("Ссылки")))+'</option> <option name="showType">1</option> <option name="icon">sprite:icon-24 icon-Link icon-primary</option> </options> <options> <option name="id">sendMessage</option> <option name="componentType">SBIS3.CONTROLS/Button/IconButton</option> <option name="name">sendMessage</option> <option name="caption">'+t(i(rk("Диалог")))+'</option> <option name="tooltip">'+t(i(rk("Диалог")))+'</option> <option name="icon">sprite:icon-24 icon-EmptyMessage icon-primary</option> <option name="visible">'+t(i(o.isAuthorized))+'</option> </options> <options> <option name="id">copyToBuffer</option> <option name="componentType">SBIS3.CONTROLS/Button/IconButton</option> <option name="name">copyToBuffer</option> <option name="caption">'+t(i(rk("Скопировать")))+'</option> <option name="tooltip">'+t(i(rk("Скопировать")))+'</option> <option name="visible">'+t(i(o.isAuthorized))+'</option> <option name="icon">sprite:icon-24 icon-Copy icon-primary</option> </options> <options> <option name="id">renameFolder</option> <option name="componentType">SBIS3.CONTROLS/Button/IconButton</option> <option name="name">renameFolder</option> <option name="caption">'+t(i(rk("Переименовать")))+'</option> <option name="tooltip">'+t(i(rk("Переименовать")))+'</option> <option name="visible">'+t(i(o.canEdit))+'</option> <option name="icon">sprite:icon-24 icon-Rename icon-primary</option> </options> </options> </component> <div class="cd-cdPublicArea__rights-count"></div> </div> <div class="cd-cdArea__controls-panel"> <component data-component="SBIS3.EDO.CD.Buttons" name="CDButtons" class="cd-cdPublicArea__buttons"> <option name="onlyOperationsButton" value="'+t(i(!o.hasAccessRight))+'"></option> <option name="visible" value="'+t(i(!o.hasAccessRight))+'"></option> <options name="mainOptions"> ',o.hasAccessRight?a+=' <option name="objectName">FileSD</option> ':a+=' <option name="objectName">PublicFileSD</option> ',a+=" ",o.hasAccessRight?a+=' <option name="serviceUrl">/disk/api/v1/</option> ':a+=' <option name="serviceUrl">/shared/service/</option> ',a+=" ",o.hasAccessRight||(a+=' <option name="_isAuth">false</option> '),a+=" ",o.hasAccessRight?a+=' <option name="serviceBLName">СБИСДиск.Приватный</option> ':a+=' <option name="serviceBLName">shared</option> ',a+=' </options> </component> <component data-component="SBIS3.CONTROLS/Filter/Button" class="cd-cdArea__filter-controller"> <opt name="name" value="ПанельФильтровХД"/> <opt name="filter"></opt> <opt name="filterLineComponent" value="js!SBIS3.EDO.CD.CommonDocsFilter.CommonDocsFilterLine"></opt> <opt name="resetLinkText"></opt> <opts name="filterStructure" type="array"> <opts> <opt name="internalValueField">ФильтрДатаПериод</opt> <opt name="internalCaptionField">ФильтрДатаПериодТекст</opt> <opt name="caption" bind="ФильтрДатаПериодТекст"></opt> <opt name="value" bind="listFilters/ФильтрДатаПериод"></opt> <opt name="resetValue" type="string">Все</opt> </opts> <opts> <opt name="internalValueField">ФильтрДатаС</opt> <opt name="internalCaptionField">ФильтрДатаС</opt> <opt name="caption" bind="listFilters/ФильтрДатаС"></opt> <opt name="value" bind="listFilters/ФильтрДатаС"></opt> <opt name="resetValue" type="string"></opt> </opts> <opts> <opt name="internalValueField">ФильтрДатаП</opt> <opt name="internalCaptionField">ФильтрДатаП</opt> <opt name="caption" bind="listFilters/ФильтрДатаП"></opt> <opt name="value" bind="listFilters/ФильтрДатаП"></opt> <opt name="resetValue" type="string"></opt> </opts> </opts> <opt name="template"> <component data-component="SBIS3.EDO.CD.CommonDocsFilter"> <opt name="visibleDeleted" type="boolean">false</opt> </component> </opt> </component> </div> </div> <component data-component="SBIS3.DOCVIEW.OperationPanel" name="ПанельМассовыхОперацийОбщихДокументов" class="cd-buttons__operations-panel"> <options name="items" type="array"> <options> <option name="name">markOperations</option> <option name="componentType">SBIS3.CONTROLS/OperationsPanel/Mark</option> <options name="type"> <option name="mark">true</option> </options> </options> </options> <options name="mainOptions"> ',o.hasAccessRight?a+=' <option name="objectName">FileSD</option> ':a+=' <option name="objectName">PublicFileSD</option> ',a+=" ",o.hasAccessRight?a+=' <option name="serviceUrl">/disk/api/v1/</option> ':a+=' <option name="serviceUrl">/shared/service/</option> ',a+=" ",o.hasAccessRight||(a+=' <option name="_isAuth">false</option> '),a+=" ",o.hasAccessRight?a+=' <option name="serviceBLName">СБИСДиск.Приватный</option> ':a+=' <option name="serviceBLName">shared</option> ',a+=' <option name="useOnlyCtx">false</option> <option name="multiPage">false</option> <option name="isDisk">true</option> <option name="commands" bind="visibleCommands"></option> <option name="filter" bind="listFilters"></option> <option name="withoutNotification">false</option> </options> <option name="folderRecord" bind="currentFolderForMassPanel"></option> <option name="panelFloatDirection" value="horizontal"></option> <option name="hasItemsMenu" value="false"></option> </component> <component data-component="SBIS3.EDO.CD.CommonDocsReestr" class="cd-cdArea__cd-reestr" name="cdReestr"> <option name="fromPublicLink" value="true" type="boolean"></option> ',o.hasAccessRight?a+=' <option name="useSharedService" value="false" type="boolean"></option> ':a+=' <option name="useSharedService" value="true" type="boolean"></option> ',a+=' <option name="subscribeFileEvents" value="'+t(i(o.hasAccessRight))+'"></option> </component> <component data-component="SBIS3.EDO.CD.DragAndDropArea" name="CDDragAndDropArea"> </component> </div>',(a=t(a))+(p&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.CD.PublicCommonDocs"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.CD.PublicCommonDocs", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode("#wrapper{margin-right:0}.height100{height:100%}.placeholder{background:#fff fixed;height:100%;width:100%;position:absolute;left:0;top:0;z-index:10}.cd-cdPublicArea{height:100%}.cd-cdPublicArea .cd-commonDocsReestr{height:calc(100% - 83px)}.cd-cdArea__header-container{height:83px;width:100%}.cd-cdArea__tr-controls{height:100%}.cd-cdArea__folder-ico{display:inline-block;float:left;padding-top:8px;padding-right:8px;padding-left:8px}.cd-cdArea__header-panel{background-color:#f8f7ef;display:inline-block;width:100%;height:40px;margin-bottom:6px;border-bottom:1px #ccc solid}.cd-cdArea__folder-name{font-weight:700;font-size:18px;display:inline-block;padding-top:10px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:700px}.cd-cdArea__auth-btn{float:right;margin-top:8px;padding-right:8px;padding-left:0;height:32px}.cd-cdArea__header-btn{float:right;display:inline-block;margin-top:8px!important;padding-left:0;padding-right:8px;height:32px}.cd-cdArea__header-btn.hide-menu-button .controls-ToolBar__menuIcon{display:none}.cd-cdArea__header-btn.controls-ToolBar .controls-ToolBar__item{margin-right:8px}.cd-cdArea__td-visibility-switcher-cont{width:30px}.cd-cdArea__search-string{width:250px;margin-left:8px}.cd-cdPublicArea__visibility-mode-switcher{float:right;z-index:10;padding-right:8px;padding-top:2px}.cd-cdArea__filter-controller{float:right;position:relative}.cd-cdArea__filter-controller.controls__filterButton{height:32px}.cd-cdArea__controls-panel{height:36px;width:100%}.cd-cdPublicArea__buttons{position:absolute;width:100%}.cdPageUnready .docview-list__path-placeholder{display:none}.cd-cdPublicArea__messages-count,.cd-cdPublicArea__rights-count{width:10px;position:absolute;float:right;font-size:11px;background:#f8f7ef;color:#4e6fa5;top:9px;line-height:11px}.cd-cdPublicArea__rights-count{right:100px}"));head.appendChild(style);});}
define('js!SBIS3.EDO.CD.PublicCommonDocs',['Transport/Record','Core/helpers/collection-helpers','Core/EventBus','Core/constants','SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.CD.PublicCommonDocs','js!SBIS3.EDO.CD.CommonDocsHelpers','js!SBIS3.EDO.CD.DiskOperations','SBIS3.CONTROLS/ComponentBinder','js!SBIS3.DOCVIEW.Funcs','js!SBIS3.SBISDISK.DragAndDropUploadMixin','js!SBIS3.SBISDISK.EmptyHtmlController','js!SBIS3.BL.SbisBuffer','SBIS3.CONTROLS/Utils/InformationPopupManager','js!SBIS3.DOCVIEW.List.DiskClassicColumns','js!SBIS3.EDO.CD.Buttons','css!SBIS3.EDO.CD.PublicCommonDocs','Deprecated/Controls/LinkButton/LinkButton','SBIS3.CONTROLS/Button/IconButton','js!SBIS3.DOCVIEW.SwitchVisibilityMode','SBIS3.CONTROLS/OperationsPanel/PanelButton/OperationsPanelButton','js!SBIS3.DOCVIEW.OperationPanel','SBIS3.CONTROLS/Filter/Button','SBIS3.CONTROLS/Filter/FastData','SBIS3.CONTROLS/SearchForm','js!SBIS3.EDO.CD.CommonDocsReestr','js!SBIS3.EDO.CD.CommonDocsFilter','js!SBIS3.EDO.CD.CommonDocsFilter.CommonDocsFilterLine','js!SBIS3.EDO.CD.DragAndDropArea','SBIS3.CONTROLS/Toolbar','SbisDiskDocuments_localization'],function(e,t,o,i,n,s,r,a,l,d,c,u,h,f,m){'use strict';var C=n.extend([c],{_dotTplFn:s,$protected:{_options:{folderName:null,folderRoot:null,folderObject:null,canEdit:null,openedFile:null,isAuthorized:null,hasAccessRight:null},_startDrag:true},$constructor:function(){var e=this;e.getLinkedContext().setValue('sorterData',[{key:'SortByName',value:rk('Имя')},{key:'SortByDateChange',value:rk('Дата изменения')}]),e.getLinkedContext().setValue('sortBy',['SortByName']),e.getLinkedContext().setValue('pageSizeForSelect',50);},init:function(){C.superclass.init.call(this),$('.main_hidden').removeClass('main_hidden');var e=this,n=this.getLinkedContext();n.setValue('hasAccessRight',this._options.hasAccessRight),n.setValue('isAuthorized',this._options.isAuthorized);var s=!(e._options.isAuthorized&&e._options.hasAccessRight);if(this.subscribeTo(this.getChildControlByName('cdReestr'),'onChangeSort',this.onChangeSort.bind(this)),r.setListFilter(n,{catalogId:void 0,folder:e._options.folderRoot,onlyDeleted:'Все','ФильтрДатаПериод':'Все',sortBy:'SortByName',InitialRootId:e._options.folderRoot,IsRootFolder:true}),e._changeVisibleOptions(e._options.isAuthorized),this._dnd_area=this.getChildControlByName('CDDragAndDropArea'),this._dnd_area.hide(),!(i.browser.isIE8||i.browser.isIE9)&&!r.idUserIsEqualIdClient())this.initDragAndDrop();this._initCommands();var a=e.getChildControlByName('CDButtons');this.subscribeTo(this,'onReady',function(){try{if('function'===typeof window.callPhantom)window.callPhantom({takeShot:true});}catch(e){}var o=e.getChildControlByName('attachments');e._browser=o,e.subscribeTo(o,'onDataLoad',function(t,i){var n=r.getCurrentFolderFromViewer(i),s={Id:n?n.attachId:e._options.folderRoot,attachId:n?n.attachId:e._options.folderRoot,'folder@':true,title:n?n.Name:e._options.folderName+'',fileName:n?n.Name:e._options.folderName+'',Type:0,writeAccessRight:n?n.Rights>1:null};e.getLinkedContext().setValue('currentFolder',s),e.getLinkedContext().setValue('currentFolderForMassPanel',s),u.setEmptyHTML(o,s.writeAccessRight,true),a.onCurrentFolderChange(s);});var i=e.getChildControlByName('ПанельМассовыхОперацийОбщихДокументов'),n=e.getChildControlByName('КнопкаПанелиМассовыхОперацийОбщихДокументов');new l({view:o,operationPanel:i}).bindOperationPanel(false,i),i.setLinkedView(o),n.setLinkedPanel(i),i.setCommandCfg('deleteDoc',{weight:233});var d=s?['upload','links']:['upload','rename','links'];t.forEach(d,function(e){i.setCommandCfg(e,{inSingle:true});}),e.subscribeTo(i,'onToggle',function(){e.getContainer().toggleClass('cd-area__opened-operations-panel');}),e.getContainer().removeClass('cdPageUnready'),e._initCounters();});var d=this.getChildControlByName('ПанельФильтровХД');o.channel('SbisDiskEvents').subscribe('onGoToZip',function(e,t){d.setEnabled(!t);}),this.subscribeTo(o.channel('SbisDiskEvents'),'onCancelOperation',this._onCancelOperationHandler.bind(this)),this.subscribeTo(o.channel('SbisDiskEvents'),'onUpdateRow',this.onUpdateRow.bind(this)),this.subscribeTo(o.channel('SbisDiskEvents'),'onChangeDocumentsList',this._onChangeDocumentsList.bind(this)),this.subscribeTo(o.channel('SbisDiskEvents'),'onOpenFolder',this.onOpenFolder.bind(this)),this.subscribeTo(o.channel('SbisDiskEvents'),'onCheckCanUpload',function(e,t){e.setResult(true);});var c=function(t){var o=r.getFolderForUpload(e._browser),i=o&&o.Name?o.Name:null;if(!i){var n=e.getLinkedContext().getValue('currentFolder');i=n?n.name:null;}if(i)$('.cd-cdArea__drag-and-drop-upload-dest-folder').html(i);t.setResult(i||rk('Документы'));};if(this.subscribeTo(o.channel('DragAndDropEvents'),'onStartDrag',c),this.waitChildControlByName('РеестрСписокОбщих').addCallback(function(t){if(e._docviewList=t,t.setUserTemplate('diskClassic',e._getColumnsForList()),e.getChildControlByName('CDButtons')._options.linkedList=t,e.subscribeTo(t,'onGoToZip',e._onGoToZip.bind(e)),e.subscribeTo(t,'onFinishCommand',e._onFinishCommand.bind(e)),e.subscribeTo(t,'onErrorCommand',e._onErrorCommand.bind(e)),e._options.isAuthorized)t.setMultiplyCommandCfg({deleteDoc:{isMainAction:true},links:{isMainAction:true},move:{isAvailable:function(e){return e.get('canDelete');}}});return t;}),this._options.hasAccessRight)n.setValue('canDragNDropItems','onlyChangeParent');r.loadFileChooser();},_isPublic:function(){return!(this._options.isAuthorized&&this._options.hasAccessRight);},_changeVisibleOptions:function(e){this.getLinkedContext().setValue('visibleCommands',{addPage:false,fullScreen:false,saveToPdf:false,restore:false,deletePermanentlyDoc:false,editGroup:true,move:e,findInMyDocs:e,sendMessage:e,edit:e,editInApp:e,imageEdit:e,print:true,deleteDoc:e,rights:e,links:true,editPdf:false,copyToBuffer:e,redactions:true,signDocument:e,encrypt:e,linksGroup:false});},onChangeSort:function(e,t){r.setListFilter(this.getLinkedContext(),{sortBy:t}),this.getLinkedContext().setValue('sortBy',[t]);},_onGoToZip:function(e,t){var i='Archive'===t.mainOptions.objectName;o.channel('SbisDiskEvents').notify('onGoToZip',i);},_onFinishCommand:function(e,t,o){if('deleteDoc'===t)a.onFinishDeleteObjects(o.records,this);else if('rights'===t){if(o&&o.finishParams&&!o.finishParams.withoutReload)this._browser&&this._browser.reload();}else if('moveDocuments'===t)a.onFinishMove(o.from,o.to,false,this);else if('saveChanges'==t)this.redrawRow(o.records[0].get('attachId'));},_onErrorCommand:function(e,t,o){if('deleteDoc'==t)if(o&&o.error&&o.error.message)r.showErrorNotification(rk('Ошибка при удалении'),o.error.message);else r.showNotificationWithoutBody(rk('Ошибка при удалении'),'error',15000);},onUpdateRow:function(e,t){this._browser.reload();},_onChangeDocumentsList:function(e,t){var o={};if(t.id)this._mergeFromBLWithTimeout(t.id);else this._browser.reload();},redrawRow:function(e){var t=this;t._mergeFromBLWithTimeout(null,function(){t._getObjectInfo(1,e).addCallback(function(o){t._docviewList.redrawItemDocview(e,o);});});},_mergeFromBLWithTimeout:function(e,t,o){var i=this;if(this.reloadTimeout)clearTimeout(this.reloadTimeout),this.reloadTimeout=null;if(!!e)this._additionalFileCount+=1;this.reloadTimeout=setTimeout(function(){i.reloadTimeout=null,i._docviewList.mergeFromBL({additionalCount:i._additionalFileCount,needSetCursor:!!e,selectedKey:e}).addCallback(function(){t&&t();}),i._additionalFileCount=0;},o||500);},_getObjectInfo:function(e,t){return(0===e?d.readFolderInfo:d.readAttachmentInfo)({objectName:'FileSD',serviceUrl:r.getDiskServiceURL(),id:t});},_onCancelOperationHandler:function(e,t){if('TakeAwayHardLink'===t.operationName||'Copy'===t.operationName)if(t.ids&&t.ids[0]&&t.ids[0].SourceId)o.channel('SbisDiskEvents').notify('onUpdateRow',t.ids[0].SourceId);},_checkSize:function(e){return true;},_initCommands:function(){var e=this;if(!e._options.isAuthorized)e.subscribeTo(e.getChildControlByName('authBtn'),'onActivated',this._authBtnHandler.bind(this));this.subscribeTo(this.getChildControlByName('FolderCommands'),'onToolbarItemActivate',this._onToolbarItemActivate.bind(this));},_initCounters:function(){if(!this._options.isAuthorized)return;var e=this;require(['js!SBIS3.BL.FileSD'],function(t){t.ReadFolderInfo(e._options.folderRoot).addCallback(function(t){e.getContainer().find('.cd-cdPublicArea__rights-count').text(t.get('countRights')>1?t.get('countRights'):'');});});},_authBtnHandler:function(){location.href=window.location.protocol+'//'+window.location.host+'/auth/?ret='+this._options.openedFile;},_getLinkBtnHandler:function(){var t=this,o=t.getChildControlByName('FolderCommands').getContainer().offset(),i=new e();i.addColumn('attachId',e.FIELD_TYPE_STRING),i.set('attachId',t._options.folderRoot),i.addColumn('title',e.FIELD_TYPE_STRING),i.set('title',t._options.folderName),i.addColumn('Deleted',e.FIELD_TYPE_BOOLEAN),i.set('Deleted',false),i.addColumn('folder@',e.FIELD_TYPE_BOOLEAN),i.set('folder@',true),i.addColumn('signs',e.FIELD_TYPE_BOOLEAN),i.set('signs',false),i.addColumn('encrypted',e.FIELD_TYPE_INTEGER),i.set('encrypted',0),require(['js!SBIS3.DOCVIEW.ObjectLinks'],function(e){e.show(t._options.folderRoot,{position:{top:o.top+30,left:o.left-480},name:t._options.folderName,record:i,isFolder:true,isPublic:t._isPublic.call(t)});});},_downloadBtnHandler:function(){(this._isPublic()?a.downloadPublicFolder:a.downloadFolder)(this._options.folderRoot);},_rightsFolderHandler:function(){var e=this;require(['js!SBIS3.SBISDISK.RightsPanel'],function(t){t.show(e._options.folderRoot,{isFolder:true,fileName:e._options.folderName,opener:e}).addCallback(function(t){if(!t)e._initCounters();});});},_sendMessageHandler:function(){var e=this;require(['js!SBIS3.Contacts.MessagePanel','js!SBIS3.EDO.CD.CommonDocsHelpers'],function(t,o){var i={docGUID:e._options.folderObject,isDocumentHistory:true,isModal:true,restrictedActions:{isHiddenVideoMessage:true,isHiddenAudioMessage:true,isHiddenDeleteDialog:true,isHiddenCreateTask:true}};o.isPersonalAccount().addCallback(function(){t.open(i);});});},_renameFolderHandler:function(){var e=this;require(['js!SBIS3.EDO.CD.FolderDialog'],function(t){t.renameFolder(e._options.folderRoot,{objectName:e._options.folderName,saveBtnName:rk('Сохранить')}).addCallback(function(t){e.getContainer().find('.cd-cdArea__folder-name').text(t),e._options.folderName=t;});});},_copyToBufferHandler:function(){var e=[];e.push({attachId:this._options.folderRoot,objectName:'FileSD',serviceUrl:r.getDiskServiceURL(),'folder@':true}),h.AddObjects(e).addCallback(function(){f.showNotification({caption:rk('Скопировано в буфер обмена'),status:'success'});});},_deleteFolderHandler:function(){var e=this;require(['SBIS3.CONTROLS/Utils/InformationPopupManager','js!SBIS3.BL.FileSD'],function(t,o){var i={message:'Удалить папку?',hasCancelButton:false,opener:e};t.showConfirmDialog(i,function i(){o.Delete(e._options.folderRoot).addCallbacks(function(){window.location.reload();},function(e){t.showNotification({caption:rk('Не удалось выполнить удаление: ')+e.message,status:'error'});});});});},_onToolbarItemActivate:function(e,t){if('downloadBtn'===t)this._downloadBtnHandler();else if('getLinkBtn'===t)this._getLinkBtnHandler();else if('rightsFolder'===t)this._rightsFolderHandler();else if('sendMessage'===t)this._sendMessageHandler();else if('renameFolder'===t)this._renameFolderHandler();else if('copyToBuffer'===t)this._copyToBufferHandler();else if('deleteFolder'===t)this._deleteFolderHandler();},onOpenFolder:function(e,t){var o=this,i=this.getLinkedContext(),n={catalogId:void 0,folder:t.folderId,onlyDeleted:'Все','ФильтрДатаПериод':'Все',clearPath:true},s=i.getValue('currentFolder');if(s&&s.Id==n.folder)o._browser.reload();else r.setListFilter(i,n),i.setValue('listRoot',o._options.folderRoot),o._browser.setCurrentRoot(t.folderId);i.setValue('rowForSelect',t.fileId);},_getColumnsForList:function(){var e=['title','responsible','link','size','flags','date'],t=m.getColumns(e);return t[t.length-2].width=48,t;}});return C;});
define("html!SBIS3.EDO.CD.PersonInfo",function(){var n=function(n){var o=function(){var n={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},o=/&(?!#?\w+;)|<|>|"|'|\//g;return function(e){return e?e.toString().replace(o,function(o){return n[o]||o}):e}}(),e=function(){var n=/\{\{([\s\S]+?)\}\}/g;return function(o){for(;n.test(o);)o=o.replace(n,"&#123;&#123;$1&#125;&#125;");return o}}(),t=function(n){return n.join?n.join(""):n.toString()},r=function(n){return void 0===n?"":n&&"object"==typeof n?t(n):""+n},i="undefined"!=typeof process,s=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="person-info"> <component data-component="SBIS3.Person.PersonPhoto" class="person-info__photo"> <options name="data"> <option name="personId">'+e(r(o(n.personId)))+'</option> <option name="photoId">'+e(r(o(n.personMiniPhotoId)))+'</option> </options> <options name="settings"> <option name="size">32</option> <option name="isSquarePhotos">true</option> </options> </component> <div class="person-info__name" title="'+e(r(o(n.needShowTitleForName?n.titleForName||"":"")))+'">');return n.personName&&(s+=e(r(o(n.personName)))),s+='</div> <div class="person-info__department" title="'+e(r(o(n.personDepartment)))+'"> ',n.personDepartment&&(s+=e(r(o(n.personDepartment)))),s+=" </div> </div>",(s=e(s))+(i&&-1!==s.indexOf("{{")?String.fromCharCode(8203,8203):"")};return n.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.CD.PersonInfo"}},n});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.CD.PersonInfo", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".person-info{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;height:32px}.person-info__photo{float:left}.person-info__photo img{border-radius:6px}.person-info__department,.person-info__name{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;margin-left:37px;max-width:220px}.person-info__name{line-height:18px}.person-info__department{line-height:16px;color:#999;font-size:12px}"));head.appendChild(style);});}
define('js!SBIS3.EDO.CD.PersonInfo',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.CD.PersonInfo','css!SBIS3.EDO.CD.PersonInfo','js!SBIS3.Person.PersonPhoto','SbisDiskDocuments_localization'],function(o,n){var e=o.extend({$protected:{_options:{personId:'',personName:'',personDepartment:'',personMiniPhotoId:'',titleForName:null,needShowTitleForName:true}},_dotTplFn:n,init:function(){e.superclass.init.call(this);},setInfo:function(o){this._options.personId=o.personId,this._options.personName=o.personName,this._options.personDepartment=o.personDepartment,this._options.personMiniPhotoId=o.personMiniPhotoId;},setNeedShowTitleForName:function(o){this.getContainer().find('.person-info__name').attr('title',o?this._options.titleForName||'':'');}});return e;});
define("html!SBIS3.EDO.CD.FolderDialog",function(){var o=function(o){var n=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;o.test(n);)n=n.replace(o,"&#123;&#123;$1&#125;&#125;");return n}}(),e=function(o){return o.join?o.join(""):o.toString()},t=function(o){return void 0===o?"":o&&"object"==typeof o?e(o):""+o},i="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="cd-folderDialog"> <div class="ws-window-titlebar-custom"> <component data-component="SBIS3.CONTROLS/Button" name="SaveButton" class="cd-folderDialog__save-btn"> <option name="caption">'+n(t(rk("Создать")))+'</option> <option name="tabindex">2</option> <option name="primary">true</option> </component> </div> <div class="cd-folderDialog__name-field"> <component data-component="SBIS3.CONTROLS/TextBox" name="NameDisplay" class="cd-folderDialog__name-input"> <option name="tabindex">1</option> <option name="inputRegExp">[^\\\\\\/:\\*\\?"<>\\|]</option> <option name="selectOnClick">true</option> <options name="validators" type="array"> <options> <option name="validator" type="function" value="js!SBIS3.EDO.CD.FolderDialog:prototype.checkFolder"></option> <option name="option">text</option> </options> </options> <options name="handlers"> <option name="onKeyPressed" type="function">SBIS3.CONTROLS/TextBox/TextBoxBase:runDefaultAction</option> </options> </component> </div> </div>');return(a=n(a))+(i&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.CD.FolderDialog"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.CD.FolderDialog", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".cd-folderDialog{width:425px;height:40px}.cd-folderDialog__save-btn{position:absolute;right:44px;top:8px}.cd-folderDialog__name-input{width:394px;margin-left:16px}"));head.appendChild(style);});}
define('js!SBIS3.EDO.CD.FolderDialog',['Core/Indicator','Core/EventBus','Core/Deferred','SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.CD.FolderDialog','js!SBIS3.EDO.CD.CommonDocsHelpers','js!SBIS3.BL.FileSD','css!SBIS3.EDO.CD.FolderDialog','SBIS3.CONTROLS/Button','SBIS3.CONTROLS/TextBox','SBIS3.CONTROLS/TextBox/TextBoxBase','SbisDiskDocuments_localization'],function(e,t,o,n,i,r,a){'use strict';var s=n.extend({_dotTplFn:i,$protected:{_options:{resizable:false,modal:true,autoHeight:true,autoWidth:true}},init:function(){s.superclass.init.call(this);var e=this.getChildControlByName('SaveButton');if(this.subscribeTo(e,'onActivated',this._onSaveButtonClick.bind(this)),this._options.saveBtnName)e.setCaption(this._options.saveBtnName);this.subscribeTo(this,'onReady',this._onReady.bind(this));},_onReady:function(){var e=this.getChildControlByName('NameDisplay');if(this._options.objectName)e.setText(this._options.objectName);},_onSaveButtonClick:function(){var o=this,n=this.getChildControlByName('NameDisplay'),i=n.getValue();if(!n.validate())return;if(!i||!i.length||-1===i.search(/\S/))return void n.markControl();var s=o._options.parentId,l=o._options.folderId;if(s)e.setMessage(rk('Создание')+'...'),a.CreateFolder(s,i).addCallbacks(function(n){t.channel('SbisDiskEvents').notify('onChangeDocumentsList',{type:'createFolder'}),o.sendCommand('close',true),e.hide();},function(t){e.hide();var o=t?t.message:rk('Неизвестная ошибка при создании папки!');r.showErrorNotification(rk('Ошибка при создании'),o),n.setActive(true);});else if(l)e.setMessage(rk('Сохранение')+'...'),a.Update(l,i).addCallbacks(function(t){o.sendCommand('close',i),e.hide();},function(t){e.hide();var o=t?t.message:rk('Неизвестная ошибка при переименовании!');r.showErrorNotification(rk('Ошибка при переименовании'),o),n.setActive(true);});},checkFolder:function(){var e=this.getValue();if(!e)return true;if(/[\\\/:\*\?"<>\|]/.test(e))return rk('Поле не может содержать символы')+': \\, /, :, *, ?, ", <, >, |';if(e.match(/\s|[.]/g)&&e.match(/\s|[.]/g).length===e.length)return rk('Название не может содержать только точки или пробелы');return true;}});return s.title=rk('Папка документов'),s.createFolder=function(e,t){var n=new o();return t=t||{},require(['Lib/Control/Dialog/Dialog'],function(o){new o({resizeable:false,title:t.title||rk('Папка документов'),opener:t.opener,template:'js!SBIS3.EDO.CD.FolderDialog',componentOptions:{parentId:e,objectName:t.objectName,handlers:{onAfterClose:function(e,t){n.callback(t);}}}});}),n;},s.renameFolder=function(e,t){var n=new o();return t=t||{},require(['Lib/Control/Dialog/Dialog'],function(o){new o({resizeable:false,title:t.title||rk('Папка документов'),template:'js!SBIS3.EDO.CD.FolderDialog',componentOptions:{folderId:e,objectName:t.objectName,saveBtnName:t.saveBtnName},handlers:{onAfterClose:function(e,t){n.callback(t);}}});}),n;},s;});
define("html!SBIS3.EDO.CD.MoveDialog",function(){var o=function(o){var e=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(e){for(;o.test(e);)e=e.replace(o,"&#123;&#123;$1&#125;&#125;");return e}}(),t=function(o){return o.join?o.join(""):o.toString()},n=function(o){return void 0===o?"":o&&"object"==typeof o?t(o):""+o},a="undefined"!=typeof process,i=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="cd-moveDialog"> <div class="ws-window-titlebar-custom cd-moveDialog_title"> <component data-component="SBIS3.CONTROLS/Button" name="SaveButton" class="cd-moveDialog__move-btn"> <option name="caption">'+e(n(rk("Переместить")))+'</option> <option name="tabindex">2</option> <option name="visible">'+e(n(!o.onlySelect))+'</option> <option name="primary" type="boolean">'+e(n(!o.onlySelect))+'</option> </component> <component data-component="SBIS3.CONTROLS/Button" name="SelectButton" class="cd-moveDialog__move-btn"> <option name="caption">'+e(n(rk("Выбрать")))+'</option> <option name="tabindex">2</option> <option name="visible">'+e(n(o.onlySelect))+'</option> <option name="primary" type="boolean">'+e(n(!!o.onlySelect))+'</option> </component> </div> <component data-component="SBIS3.CONTROLS/ScrollContainer" class="cd-moveDialog__scroll-container"> <option name="content"> <component data-component="SBIS3.CONTROLS/Tree/DataGridView" name="DestinationFoldersVeryNew" class="cd-moveDialog__destination-folders controls-DataGridView__overflow-ellipsis"> <opt name="idProperty" value="attachId"></opt> <opt name="parentProperty" value="folder"></opt> <opt name="partialyReload" value="false"></opt> <opts name="itemsActions" type="array"></opts> <opt name="itemsDragNDrop" value="false"></opt> <opt name="allowEnterToFolder" type="boolean">false</opt> <opt name="showHead" type="boolean">false</opt> <opts name="columns" type="array"> <opts> <opt name="field">title</opt> </opts> </opts> </component> </option> </component> </div>');return(i=e(i))+(a&&-1!==i.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.CD.MoveDialog"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.CD.MoveDialog", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".cd-moveDialog{width:510px;height:480px}.cd-moveDialog__move-btn{position:absolute;right:45px;top:8px}.cd-moveDialog__destination-folders{height:100%;overflow-y:auto}.ws-window-titlebar-custom.cd-moveDialog_title .ws-window-title{display:block;width:330px}.cd-moveDialog__scroll-container{height:100%}"));head.appendChild(style);});}
define('js!SBIS3.EDO.CD.MoveDialog',['Core/helpers/fast-control-helpers','Core/EventBus','SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.CD.MoveDialog','js!SBIS3.EDO.CD.CommonDocsHelpers','js!SBIS3.EDO.CD.DiskOperations','js!SBIS3.DOCVIEW.SbisDiskModel','WS.Data/Source/SbisService','WS.Data/Query/Query','css!SBIS3.EDO.CD.MoveDialog','SBIS3.CONTROLS/Button','SBIS3.CONTROLS/Tree/DataGridView','SBIS3.CONTROLS/ScrollContainer','SbisDiskDocuments_localization'],function(t,e,o,i,r,n,s,l,a){'use strict';var c=o.extend({_dotTplFn:i,$protected:{_options:{resizable:false,modal:true,autoHeight:false,autoWidth:true,rootFolder:'mydocs',InitialRootId:null,objectName:'FileSD',records:[],onlySelect:false,withoutNotification:false}},$constructor:function(){this._publish('onAfterMove'),this.subscribe('onReady',this._onReady.bind(this));},_onReady:function(){var t=this,o=this._options.filter||{};if(this._treeView=this.getChildControlByName('DestinationFoldersVeryNew'),o['ВидДерева']='Только узлы',o['Разворот']='С разворотом',this._options.rootFolder)o['catalogId']=this._options.rootFolder,o['folder']=o['catalogId'];else o['InitialRootId']=this._options.InitialRootId,o['folder']=o['InitialRootId'];o['OnlyDeleted']='Все';var i=e.channel('SbisDiskEvents').notify('onGetCurrentFolder');if(i=i?i.attachId:null,this._treeView.setRoot({attachId:this._options.rootFolder||this._options.InitialRootId,title:this._options.rootFolder?r.getRootName(this._options.rootFolder):rk('Корень'),'folder@':true}),this._treeView.setFilter(o,true),this._options.onlySelect||!i)t._treeView._options.partialyReload=true,t._treeView.setDataSource(t.getDataSource()),t._treeView.setSelectedKey(t._options.rootFolder||this._options.InitialRootId);else{this._treeView.setDataSource(this.getDataSource(),true),o['folder']=i;var n=new a();n.where(o),t.getDataSource().query(n).addCallback(function(e){var r=[];(e=e.getAll()).getMetaData().path.each(function(t){r.push(t.get('attachId'));}),r.push(o['catalogId']);var s=function(e){t._treeView.setItems(e),t._treeView.expandToItem(i),t._treeView.setSelectedKey(i),t._treeView._options.partialyReload=true;};if(1===r.length)s(e);else o['folder']=r,(n=new a()).where(o),t.getDataSource().query(n).addCallback(function(t){s(t.getAll());});});}},getDataSource:function(){var t='FileSD'===this._options.objectName?r.getDiskServiceURL():'';return new l({endpoint:{address:t,contract:this._options.objectName},binding:{format:'AttachList',query:'AttachList'},model:s,idProperty:'attachId'});},init:function(){c.superclass.init.call(this),this.subscribeTo(this.getChildControlByName('SaveButton'),'onActivated',this._moveBtnClick.bind(this)),this.subscribeTo(this.getChildControlByName('SelectButton'),'onActivated',this._selectBtnClick.bind(this)),this._rootFolderId=this._options.rootFolder||this._options.InitialRootId;},_moveBtnClick:function(){var t=this,o=this._treeView.getSelectedItem()||this._rootFolderId,i=this._treeView.getSelectedKey()||this._rootFolderId,r=this.getParent();function s(){e.channel('SbisDiskEvents').notify('onChangeDocumentsList',{type:'move'});}n.moveObjectWithOptions(this._options.records,o,{callback:function(){s(),t._notify('onAfterMove',i),r.close(i);},cancellationCallback:s,initialRoot:this._options.rootFolder||this._options.InitialRootId,withoutNotification:this._options.withoutNotification,objectName:this._options.objectName,toAsLink:!!this._options.rootFolder,opener:t._options.opener});},_selectBtnClick:function(){var t=this._treeView.getSelectedItem()||this._rootFolderId;this.getParent().close(t);},destroy:function(){this._treeView=null,c.superclass.destroy.call(this);}});return c.show=function(e){if(e=e||{},!e.opener)return void t.alert(rk('Не передан родитель диалога!'));var o=e.records;if(!o||!o.length)return void t.alert(rk('Не переданы записи, которые необходимо переместить!'));if(o&&1==o.length&&o[0].get('Deleted'))return;var i=rk('Переместить')+' '+o.length+r.getPluralForm(o.length,' '+rk('запись','в папке')+' ',' '+rk('записи','в папке')+' ',' '+rk('записей','в папке')+' ')+rk('в','в папке');if(1==o.length){var n=o[0].get('title')||o[0].get('Name');if(n&&n.toLowerCase().indexOf('.url')===n.length-4)n=n.substring(0,n.length-4);i=rk('Переместить')+' "'+n+'" '+rk('в','папке');}require(['Lib/Control/Dialog/Dialog'],function(t){new t({template:'js!SBIS3.EDO.CD.MoveDialog',resizeable:false,componentOptions:{opener:e.opener,records:o,rootFolder:e.rootFolder,InitialRootId:e.InitialRootId,objectName:e.objectName,onlySelect:false,withoutNotification:e.withoutNotification,handlers:e.componentHandlers},autoCloseOnHide:true,handlers:e.handlers,title:i});});},c.showForSelect=function(e,o){if(o=o||{},!e)return void t.alert(rk('Не передан родитель диалога!'));require(['Lib/Control/Dialog/Dialog'],function(t){new t({template:'js!SBIS3.EDO.CD.MoveDialog',resizeable:false,componentOptions:{opener:e,rootFolder:o.rootFolder,onlySelect:true},autoCloseOnHide:true,handlers:o.handlers,title:rk('Новое расположение')});});},c;});
define("html!SBIS3.EDO.CD.OpenParentButton",function(){var n=function(n){var e=function(){var n={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},e=/&(?!#?\w+;)|<|>|"|'|\//g;return function(o){return o?o.toString().replace(e,function(e){return n[e]||e}):o}}(),o=function(){var n=/\{\{([\s\S]+?)\}\}/g;return function(e){for(;n.test(e);)e=e.replace(n,"&#123;&#123;$1&#125;&#125;");return e}}(),t=function(n){return n.join?n.join(""):n.toString()},r=function(n){return void 0===n?"":n&&"object"==typeof n?t(n):""+n},i="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,'<div class="dv-diskClassic__parent"> <component name="openParentBtn" data-component="SBIS3.CONTROLS/Link"> <option name="tooltip">'+o(r(e(n.parentFolderName)))+"&#010;"+o(r(rk("Открыть папку, содержащую данный объект")))+'</option> <option name="caption">'+o(r(e(n.parentFolderName)))+'</option> <option name="id">docview_command_openParentButton</option> <option name="allowChangeEnable">true</option> <option name="enable">true</option> <option name="tabindex">1</option> </component> </div>');return(a=o(a))+(i&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return n.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.CD.OpenParentButton"}},n});
define('js!SBIS3.EDO.CD.OpenParentButton',['SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.CD.OpenParentButton','SBIS3.CONTROLS/Link','SbisDiskDocuments_localization'],function(n,t){var e=n.extend({$protected:{_options:{}},_dotTplFn:t,init:function(){e.superclass.init.call(this);var n=this;n.subscribeTo(n.getChildControlByName('openParentBtn'),'onActivated',n.onOpenParentBtnClick.bind(n));},onOpenParentBtnClick:function(n){this.sendCommand('onOpenFolderFromSearch',{folderId:this._options.parentFolderId,fileId:this._options.objectId,clearPath:true});}});return e;});
define("tmpl!SBIS3.EDO.CD.SbisDiskPage",["Core/tmpl/js/tclosure","js!SBIS3.EDO.CD.Buttons","js!SBIS3.EDO.CD.MyDocsTabs","js!SBIS3.EDO.CD.CommonDocsArea"],function(){var e=Array.prototype.slice.call(arguments),t=e[0],r={};r["js!SBIS3.EDO.CD.Buttons"]=e[1],r["js!SBIS3.EDO.CD.MyDocsTabs"]=e[2],r["js!SBIS3.EDO.CD.CommonDocsArea"]=e[3];var s=function e(s,n,o,a,i){function c(){}var l=0,d=void 0!==t&&t?t:arguments[arguments.length-1];void 0===d&&(eval("var thelpers = null;"),d=global.requirejs("View/Runner/tclosure"));var u={};i&&i.isSetts&&(u=i.fullContext||{});var m="string"==typeof o?o:"",D=void 0===r?void 0:r,p={id:[],def:void 0},b=d.configResolver.calcParent(this,"undefined"==typeof currentPropertyName?void 0:currentPropertyName,s),C=this&&this.includedTemplates?this.includedTemplates:{},g=d.getMarkupGenerator(a);try{var v=g.joinElements([g.createTag("div",{class:"cdPage cdPageUnready"},[g.createTag("div",{class:"cdPage__tabs-cont "+d.wrapUndef(d.utils.escape(d.getter(s,["buttonsContainerClass"])))},[g.createControl("wsControl","ws:SBIS3.EDO.CD.Buttons",{addFolderButton:{visible:d.getter(s,["buttonsOptions","createFolderVisible"])},name:"CDButtons",className:"cdPage__buttons",readOnly:d.getter(s,["mainOptions","readOnly"]),visible:!1,addWebLinkVisible:d.getter(s,["mainOptions","addWebLinkVisible"]),loadFromDocsVisible:d.getter(s,["mainOptions","loadFromDocsVisible"]),canUploadFolder:d.getter(s,["buttonsOptions","canUploadFolder"]),esc:!1},{name:"CDButtons",sbisname:"CDButtons"},{data:s,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:b,internal:{__dirtyCheckingVars_0:d.getter(s,["buttonsOptions","createFolderVisible"])}},o,D,C,d.config,u),g.createControl("wsControl","ws:SBIS3.EDO.CD.MyDocsTabs",{name:"CDTabs",className:"cdPage__tabs",visible:"mydocs"===d.getter(s,["catId"])},{name:"CDTabs",sbisname:"CDTabs"},{data:s,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:b},o,D,C,d.config,u)],{},p,this),g.createControl("wsControl","ws:SBIS3.EDO.CD.CommonDocsArea",{name:"CDArea",className:"cdPage__area",recentOptions:d.getter(s,["recentOptions"]),mainOptions:d.getter(s,["mainOptions"]),buttonsOptions:d.getter(s,["buttonsOptions"]),stickyHeader:d.getter(s,["stickyHeader"]),subscribeFileEvents:d.getter(s,["subscribeFileEvents"]),fromFloatArea:d.getter(s,["fromFloatArea"]),recents:d.getter(s,["recents"])},{name:"CDArea",sbisname:"CDArea"},{data:s,ctx:this,pName:"undefined"!=typeof currentPropertyName?currentPropertyName:void 0,viewController:b},o,D,C,d.config,u)],n,p,this)],m,p);p.def&&(v=g.chain(v,p,n),p=void 0)}catch(e){d.templateError("resources/SbisDiskDocuments/MainPage/DiskContent.tmpl",e,s)}return v||""};return s.includedFunctions={},s.stable=!0,s.toJSON=function(){return{$serialized$:"func",module:"tmpl!SBIS3.EDO.CD.SbisDiskPage"}},s});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.CD.SbisDiskPage", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".cdPage{height:100%;position:relative;box-sizing:border-box}.cdPage__tabs-cont{height:34px;border-bottom:1px solid #ccc;width:100%}.cdPage__tabs{float:right;display:inline-block;padding-top:4px;width:310px}.cdPage__area{height:calc(100% - 35px);position:relative}.cdPage__buttons{width:100%;position:absolute;top:3px}.cdPageUnready .docview-list__path-placeholder{display:none}.sbisDiskPage__cotent-area-height{height:100%}.sbisDiskPage__restrict-height.cdPage{height:calc(100% - 35px)}"));head.appendChild(style);});}
define('js!SBIS3.EDO.CD.SbisDiskPage',['Transport/Record','Core/UserConfig','Core/EventBus','Core/ParallelDeferred','Core/Deferred','Core/constants','Core/core-clone','Core/core-merge','Core/CommandDispatcher','SBIS3.CONTROLS/CompoundControl','tmpl!SBIS3.EDO.CD.SbisDiskPage','js!SBIS3.EDO.CD.CommonDocsHelpers','js!SBIS3.BL.FileSD','js!SBIS3.EDO.CD.DiskOperations','js!SBIS3.DOCVIEW.Funcs','js!SBIS3.DOCVIEW.List.DiskClassicColumns','js!SBIS3.SBISDISK.DiskPageColumns','Lib/StickyHeader/StickyHeaderManager/StickyHeaderManager','WS.Data/Chain','css!SBIS3.EDO.CD.SbisDiskPage','js!SBIS3.EDO.CD.CommonDocsArea','js!SBIS3.EDO.CD.MyDocsTabs','js!SBIS3.EDO.CD.Buttons','js!SBIS3.EDO.CD.OpenParentButton','SbisDiskDocuments_localization'],function(e,t,i,s,n,r,o,a,l,d,c,h,u,m,f,_,C,g,F){'use strict';function S(e,t,i){var s=['title'],n;if(!i&&e!==h.ROOT_FOLDER_MY&&e!==h.ROOT_FOLDER_MY_TRASH)n=s.length,s.push('responsible');if(i)s.push('folder','daysLeft');if(void 0===n)n=s.length;if(e!==h.ROOT_FOLDER_LOADS&&e!==h.ROOT_FOLDER_SHARED&&e!==h.ROOT_FOLDER_SIGNED)s.push('link');if(s.push('size'),s.push('flags'),!r.browser.isMobilePlatform)s.push('date');var o=_.getColumns(s);if(r.browser.isMobilePlatform)o[o.length-1].width=34;else o[o.length-2].width=46;if(t)o.splice(n,0,C.getColumn(['openParent']));if(e===h.ROOT_FOLDER_SIGNED&&!t)o.splice(1,0,C.getColumn(['sign']));return o;}var O=d.extend({_dotTplFn:c,$protected:{_options:{defaultSort:null,lastFolder:null,subscribeFileEvents:false,fromFloatArea:false,isGroupDocuments:false,recents:null,setContentAreaHeight:false,stickyHeader:false,recentOptions:{visible:true,withFavorite:false},buttonsOptions:{visible:true,createFolderVisible:true,canUploadFolder:true},mainOptions:{filterDeleted:true,showQuota:true,autoRefreshList:false,readOnly:false,addWebLinkVisible:true,loadFromDocsVisible:false,saveBrowserState:true,operationsPanelHasItemsMenu:true,additionalCommands:[]},buttonsContainerClass:''},_catalogName:'Документы'},$constructor:function(){var e=this,t=e.getLinkedContext();t.setValue('saveBrowserState',this._options.mainOptions.saveBrowserState),t.setValue('pageSizeForSelect',50),t.setValue('searchStringPlaceholder',''),t.setValue('currentFolderForMassPanel',{}),t.setValue('sorterData',[{key:'SortByName',value:rk('Имя')},{key:'SortByDateChange',value:rk('Дата изменения')}]),t.setValue('sortBy',['SortByName']),e._publish('onChangeDocviewCommands','onChangeColumns');},_modifyOptions:function(e){if(e.stickyHeader)e.buttonsContainerClass+=' ws-sticky-header__block';if(!e.buttonsOptions.visible)e.buttonsContainerClass+=' ws-hidden';if(e.recents&&h.idUserIsEqualIdClient())e.recents=null;return e;},init:function(){O.superclass.init.call(this);var e=this;if(this.subscribeTo(i.channel('CDFilterEvents'),'onChangeFilter',this.onChangeFilter.bind(this)),this.subscribeTo(i.channel('SbisDiskEvents'),'onSetEmptySearchString',this.onSetEmptySearchString.bind(this)),this.subscribeTo(i.channel('SbisDiskEvents'),'onUpdateRecentFilesLazy',this.onUpdateRecentFilesLazy.bind(this)),this.subscribeTo(i.channel('SbisDiskEvents'),'onUpdateObjectInSearch',this.onUpdateObjectInSearch.bind(this)),!this._options.fromFloatArea)this.subscribeTo(i.channel('SbisDiskEvents'),'onOpenFolder',this.onOpenFolder.bind(this)),this.subscribeTo(i.channel('SbisDiskEvents'),'onSetMarkedObject',this.onSetMarkedObject.bind(this)),this.subscribeTo(i.channel('SbisDiskEvents'),'onGetCurrentFolder',this.onGetCurrentFolder.bind(this)),this.subscribeTo(i.channel('SbisDiskEvents'),'onChangeDocumentsList',this.onChangeDocumentsList.bind(this));if(this.subscribeTo(this.getChildControlByName('CDTabs'),'onChangeCDTab',this.onChangeCDTab.bind(this)),this._cdArea=this.getChildControlByName('CDArea'),this.subscribeTo(this._cdArea,'onChangeSort',this.onChangeSort.bind(this)),this.subscribeTo(this._cdArea,'onChangeCurrentFolder',this.onChangeCurrentFolder.bind(this)),l.declareCommand(this,'onOpenFolderFromSearch',this._onOpenFolderFromSearch.bind(this)),this.getLinkedContext().setValue('filters',{OnlyDeleted:'Все'}),this._options.setContentAreaHeight)$('#contentArea').addClass('sbisDiskPage__cotent-area-height'),this.getContainer().addClass('sbisDiskPage__restrict-height');this.subscribeTo(this,'onReady',function(){if(e.initReestr.call(e,e.getChildControlByName('РеестрСписокОбщих')),e.initMassPanel.call(e,e.getChildControlByName('ПанельМассовыхОперацийОбщихДокументов')),e._initSearchString.call(e,e.getChildControlByName('СтрокаПоискаХД')),e.initMassPanelButton.call(e,e.getChildControlByName('КнопкаПанелиМассовыхОперацийОбщихДокументов')),e._options.recentOptions.visible)e.initRecentFiles.call(e,e.getChildControlByName('RecentFiles'));if(e.waitChildControlByName('СписокНайденоВНазвании').addCallback(e.initReestrFindName.bind(e)),e.waitChildControlByName('СписокНайденоВСодержимом').addCallback(e.initReestrFindBody.bind(e)),e.waitChildControlByName('ListFindResults').addCallback(e.initListFindResults.bind(e)),e.getContainer().removeClass('cdPageUnready'),!e._options.fromFloatArea&&!e._options.isGroupDocuments)i.channel('navigation').subscribe('onNavigate',function(t,i,s,n){if('left'===i&&('CommonDocs'==s||'MyDocs'==s)){if(e._is_common='CommonDocs'==s,e._tabsControl=e.getChildControlByName('CDTabs'),e._tabs=e.getChildControlByName('MyDocsTabButtons'),m.inCommonDocs=e._is_common,m.inMyDocs=!e._is_common,(e._is_common?'ОбщиеДокументы':'Документы')===e._tabs.getSelectedKey())e._tabs.setSelectedKey(-1);e._tabs.setSelectedKey(e._is_common?'ОбщиеДокументы':'Документы'),e.initPage();}});if(e._options.mainOptions.additionalCommands&&e._options.mainOptions.additionalCommands.length){var t=e._mainReestr._options.mainOptions.userCommands;t=t.concat(e._options.mainOptions.additionalCommands),e._mainReestr.setUserCommands(t),e._massPanel.setUserCommands(t);var s=function(e){e.setUserCommands(t);};e.waitChildControlByName('СписокНайденоВНазвании').addCallback(s),e.waitChildControlByName('СписокНайденоВСодержимом').addCallback(s);}e._mainReestr.setMultiplyCommandCfg({links:{isMainAction:true},move:{isAvailable:function(e){return e.get('canDelete');}},deletePermanentlyDoc:{isAvailable:function(e){return e.get('canDelete');}},restore:{isAvailable:function(e){return e.get('canDelete');}}});}),e._isFirstLoads=true,e._recentOpenedFiles=[],this._firstLoad(),!e._options.fromFloatArea&&h.loadFileChooser();var t=null,s=null,n=null,r=this.getLinkedContext();r.subscribe('onFieldsChanged',function(){if(h.currentFolderIsArchive(e._mainReestr))return;var i=this.getValue('listFilters');if(i&&(i['ФильтрДатаПериод']!=t||i['ФильтрДатаС']!=s||i['ФильтрДатаП']!=n))if(t=i['ФильтрДатаПериод'],s=i['ФильтрДатаС'],n=i['ФильтрДатаП'],this.getValue('isSearch')){var o=this.getValue('listFiltersFindName');h.setListFilterForFind(r,{'ФильтрДатаПериод':t,'ФильтрДатаС':s,'ФильтрДатаП':n,SearchString:o.SearchString});}});},destroy:function(){this._mainReestr=null,this._mainBrowser=null,this._searchString=null,this._reestrFindName=null,this._reestrFindBody=null,this._massPanel=null,this._cdArea=null,O.superclass.destroy.call(this);},initPage:function(){var e=this._is_common;this._tabsControl.setVisible(!e&&!h.idUserIsEqualIdClient());},initReestr:function(e){var t=this.getLinkedContext(),i=this;return this._mainReestr=e,this.subscribeTo(e,'onFinishCommand',this._onFinishCommand.bind(this)),this.subscribeTo(e,'onStartCommand',this._onStartCommand.bind(this)),this.subscribeTo(e,'onErrorCommand',this._onErrorCommand.bind(this)),this.subscribeTo(e,'onShowFile',this._onShowFile.bind(this)),this.subscribeTo(e,'onGoToZip',this._onGoToZip.bind(this)),this.getChildControlByName('CDButtons')._options.linkedList=e,this._mainBrowser=e.getChildControlByName('attachments'),this.subscribeTo(this._mainBrowser,'onDataLoad',function(){if(false===t.getValue('needShowSearch'))i._mainReestr&&i._mainReestr.show(),i._listFindResults&&i._listFindResults.setVisible(false),t.setValue('needShowSearch',void 0);}),this.subscribeTo(this._mainBrowser,'onItemClick',function(e,s,n){if(!n)return;if(h.currentFolderIsArchive(i._mainReestr))return;if(n.get('folder@')){var r=t.getValue('listFilters'),o=h.getFullPathFromTreeView(i._mainBrowser,n.get('attachId'));if(o)r.Path=JSON.stringify(o.toJSON()),t.setValue('listFilters',r),i._mainBrowser.setFilter(r,true);}}),e;},initReestrFindName:function(e){var t=this.getLinkedContext(),i=this;return this._reestrFindName=e,this.initSearchTemplate(e),this.subscribeTo(e.getTreeView(),'onDataLoad',function(){if(true===t.getValue('needShowSearch'))i._mainReestr&&i._mainReestr.hide(),i._listFindResults&&i._listFindResults.setVisible(true),t.setValue('needShowSearch',void 0);}),this.subscribeTo(e,'onStartCommand',this._onStartCommand.bind(this)),this.subscribeTo(e,'onErrorCommand',this._onErrorCommand.bind(this)),this.subscribeTo(e,'onFinishCommand',this._onFinishCommandInSearch),this.subscribeTo(e,'onShowFile',this._onShowFile.bind(this)),e.setMultiplyCommandCfg({}),e;},initReestrFindBody:function(e){return this._reestrFindBody=e,this.initSearchTemplate(e),this.subscribeTo(e,'onStartCommand',this._onStartCommand.bind(this)),this.subscribeTo(e,'onErrorCommand',this._onErrorCommand.bind(this)),this.subscribeTo(e,'onFinishCommand',this._onFinishCommandInSearch),this.subscribeTo(e,'onShowFile',this._onShowFile.bind(this)),e.setMultiplyCommandCfg({}),e;},initListFindResults:function(e){return this._listFindResults=e,e;},initMassPanel:function(e){var t=this;if(this.subscribeTo(e,'onErrorCommand',this._onErrorCommand.bind(this)),this._massPanel=e,this._mainBrowser)e.setLinkedView(this._mainBrowser);if(this._mainReestr)this._mainReestr.bindOperationPanel(false,e);var i=this.getChildControlByName('ПанельМассовыхОперацийОбщихДокументов');return this.getChildControlByName('КнопкаПанелиМассовыхОперацийОбщихДокументов').setLinkedPanel(i),t.subscribeTo(i,'onToggle',function(){t.getContainer().toggleClass('cd-area__opened-operations-panel'),g.checkStickyHeaderSize(t.getContainer());}),e.setCommandCfg('deleteDoc',{weight:233}),e;},initMassPanelButton:function(e){return this._massPanelButton=e,e;},initRecentFiles:function(e){return this.subscribeTo(e,'onStartCommand',this._onStartCommand.bind(this)),this.subscribeTo(e,'onShowFile',this._onShowFileFromRecent.bind(this)),e;},_initSearchString:function(e){var t=this,i=t.getLinkedContext();t._searchString=e;var s=null;return t.subscribeTo(e,'onSearch',function(e,n){if(n!==s){if(t.getChildControlByName('CDButtons')._setStateControls(false,rk('Невозможна загрузка в данную папку')),!t.getLinkedContext().getValue('isSearch'));t.getChildControlByName('SwitchableArea').setActiveArea('searchDocuments').addCallback(function(){s=n,t._searchString.setActive(true);var e=t.getLinkedContext().getValue('currentFolder'),r=t._mainBrowser.getFilter();if(i.setValue('needShowSearch',true),t._reestrFindName&&t._reestrFindName.setMultiplyCommandCfg({deleteDoc:{isMainAction:'True'!==r.OnlyDeleted},restore:{isMainAction:'True'===r.OnlyDeleted}}),t._reestrFindBody&&t._reestrFindBody.setMultiplyCommandCfg({deleteDoc:{isMainAction:'True'!==r.OnlyDeleted},restore:{isMainAction:'True'===r.OnlyDeleted}}),h.setListFilterForFind(t.getLinkedContext(),{folder:e.rootName,SearchString:n,SortBy:r.SortBy}),t._reestrFindName.getTreeView().setCurrentRoot(e.rootName),t._reestrFindBody.getTreeView().setCurrentRoot(e.rootName),t._mainReestr.hide(),t._listFindResults.setVisible(true),t._listFindResults.toggleIndicator(true),t.getLinkedContext().setValue('isSearch',true),t._massPanelButton)t._massPanelButton.setEnabled(false),t._massPanelButton.getLinkedPanel().toggle(false);});}}),t.subscribeTo(e,'onReset',function(){if(s=null,!t.getLinkedContext().getValue('isSearch'))return;t.getChildControlByName('SwitchableArea').setActiveArea('documents').addCallback(function(){i.setValue('needShowSearch',false),t._searchString.setActive(true);var e=t._reestrFindName.getTreeView().getItems();if(e)e.clear();var s=t._reestrFindBody.getTreeView().getItems();if(s)s.clear();if(h.setListFilter(t.getLinkedContext(),{clearSearch:true,SearchString:null}),h.setListFilterForFind(t.getLinkedContext(),{SearchString:null}),t.getLinkedContext().setValue('isSearch',false),t._massPanelButton)t._massPanelButton.setEnabled(true);});}),e;},setCatalogId:function(e,t,i){var s=this,n=this.getLinkedContext();if(i=i||{},s._catalogName=t,s._mainReestr._savedMode='diskClassic',s._mainReestr.setUserTemplate('diskClassic',s.getColumnsForList(e,false,false)),h.currentFolderIsArchive(s._mainReestr))s._mainReestr.goFromZip(e,false);var r=s._mainBrowser;if(r.removeItemsSelectionAll(),n.getValue('isSearch'))s.resetSearchBlock();var o=a({catalogId:e,folder:e,onlyDeleted:'Все','ФильтрДатаПериод':'Все',sortBy:'SortByName'},i);s._setSorterData(o.sortBy,e,false),h.setListFilter(s.getLinkedContext(),o),r.setCurrentRoot(e),s.getLinkedContext().setValue('canDragNDropItems','onlyChangeParent'),s._changeVisibleOptions(false,e);},setVisibleButtons:function(e){this.getContainer().find('.cdPage__tabs-cont').toggle(e),this._mainReestr.getTreeView().setMultiselect(e);},getDocviewList:function(){return this._mainReestr;},setReadOnly:function(e){this._options.mainOptions.readOnly=e,this.getChildControlByName('CDButtons').setReadOnly(e);var t=this.getLinkedContext().getValue('listFilters');this._changeVisibleOptions(false,t.catalogId);},onChangeCDTab:function(e,r){var o=this,a=o.getLinkedContext(),l=r==h.ROOT_FOLDER_LOADS,d=r==h.ROOT_FOLDER_SHARED,c=r==h.ROOT_FOLDER_SIGNED,u;if(!o._mainBrowser)u=o._mainReestr.getChildControlByName('attachments'),o._mainBrowser=u;else u=o._mainBrowser;if(h.idUserIsEqualIdClient())return u.setEmptyHTML(rk('Вам недоступны')+' '+h.getRootName(r).toLowerCase()),o.getContainer().find('.cd-cdArea__no-access-docs').text(rk('Вам недоступны')+' '+h.getRootName(r).toLowerCase()).removeClass('ws-hidden'),o.setEnabled(false),void o.getChildControlByName('ПанельФильтровХД').setVisible(false);if(this._options.catId=r,o._mainReestr._savedMode='diskClassic',h.currentFolderIsArchive(o._mainReestr))o._mainReestr.goFromZip(r,false);this._changeVisibleOptions(false,r);var m=false;u.removeItemsSelectionAll(),a.setValue('filters',{OnlyDeleted:'Все'});var f='SortFor'+r,_='SbisDiskLastFolder_'+r,C=new s();if(o._options.defaultSort)C.push(new n().callback(o._options.defaultSort),'sort');else C.push(t.getParam(f),'sort');if(!l&&!d&&!c)if(o._options.lastFolder)C.push(new n().callback(o._options.lastFolder),'lastFolder');else C.push(t.getParam(_),'lastFolder');C.done().getResult().addCallbacks(function(e){if(a.getValue('isSearch'))o.resetSearchBlock();o._options.defaultSort=null,o._options.lastFolder=null;var i='SortByName';if(r==h.ROOT_FOLDER_SIGNED||r==h.ROOT_FOLDER_SHARED||r==h.ROOT_FOLDER_LOADS)i='SortByDateCreate';var s=e['sort']||i,n=window&&window.sessionStorage&&window.sessionStorage.getItem('SbisDiskOpenFolder');if(n)try{n=JSON.parse(n);}catch(e){n=null;}var l=e['lastFolder'];if(l)try{l=JSON.parse(l);}catch(e){l=null;}if(n&&n.folderId&&(n.rootName===r||n.rootName===h.ROOT_FOLDER_MY_TRASH&&r===h.ROOT_FOLDER_MY||n.rootName===h.ROOT_FOLDER_COMMON_TRASH&&r===h.ROOT_FOLDER_COMMON)){if(o._openFolder(u,n,s),window&&window.sessionStorage)window.sessionStorage.removeItem('SbisDiskOpenFolder');}else if(l&&l.Id)h.setListFilter(a,{catalogId:r,root:r,folder:l.Id,Path:l.path,onlyDeleted:'Все','ФильтрДатаПериод':'Все',sortBy:s}),u.setCurrentRoot(l.Id),t.setParam(_,null);else h.setListFilter(a,{catalogId:r,folder:r,onlyDeleted:'Все','ФильтрДатаПериод':'Все',sortBy:s}),u.setCurrentRoot(r);o._setSorterData(s,r,m),o._mainReestr.setUserTemplate('diskClassic',o.getColumnsForList(r,false,false));var d=o.getColumnsForList(r,true,false);o._reestrFindName&&o._reestrFindName.setUserTemplate('diskClassic',d),o._reestrFindBody&&o._reestrFindBody.setUserTemplate('diskClassic',d);},function(e){h.showErrorDialog(rk('Ошибка получения пользовательских параметров')+': '+e.message,o);}),o._initRecentPanel(r);var g=r!=h.ROOT_FOLDER_LOADS&&r!=h.ROOT_FOLDER_SHARED;i.channel('CDFilterEvents').notify('onChangeVisibleDeletedFilter',g),o._isFirstLoads=false,a.setValue('canDragNDropItems',g?'onlyChangeParent':false);},_initRecentPanel:function(e){var t=this.getLinkedContext(),s=t.getValue('recentFilters');if(s&&s.MainHierarchyName!==h.ROOT_FOLDER_COMMON&&e!==h.ROOT_FOLDER_COMMON)return;i.channel('SbisDiskEvents').notify('onInitRecentPanel'),t.setValue('recentFilters',{catalogId:h.ROOT_FOLDER_RECENT,folder:h.ROOT_FOLDER_RECENT,OnlyDeleted:'Все',MainHierarchyName:'all',FoldersFirst:false}),t.setValue('recentCommands',{addPage:false,fullScreen:false,saveToPdf:false,restore:false,editGroup:true,sendMessage:true,rename:true,edit:true,editInApp:true,print:true,deleteDoc:false,deletePermanentlyDoc:false,move:false,deleteFromRecent:true,links:true,editPdf:false,linksGroup:false});},_setSorterData:function(e,t,i){var s=this.getLinkedContext(),n=rk('Дата изменения'),r='SortByDateChange';if(i)n=rk('Дата удаления'),r='SortByDateDelete';else if(t==h.ROOT_FOLDER_LOADS)n=rk('Дата загрузки'),r='SortByDateCreate';else if(t==h.ROOT_FOLDER_SHARED)n=rk('Дата предоставления доступа'),r='SortByDateCreate';else if(t==h.ROOT_FOLDER_SIGNED)n=rk('Дата подписания'),r='SortByDateCreate';var o=[{key:'SortByName',value:rk('Имя')},{key:r,value:n}],a=s.getValue('sorterData');if(a)if(a instanceof Array)a=a[1];else a=a.at(1).toObject();if(!a||o[1].key!==a.key||o[1].value!==a.value)s.setValue('sorterData',o);if(e!==o[0].key&&e!==o[1].key)e='SortByName';s.setValue('sortBy',[e]);},onChangeSort:function(e,i){if(!this.getLinkedContext().getValue('listFilters')||this.getLinkedContext().getValue('listFilters').SortBy===i)return;if(h.setListFilter(this.getLinkedContext(),{sortBy:i}),this.getLinkedContext().getValue('isSearch')){var s=this.getLinkedContext().getValue('listFiltersFindName');h.setListFilterForFind(this.getLinkedContext(),{sortBy:i,SearchString:s.SearchString});}this.getLinkedContext().setValue('sortBy',[i]);var n=this.getLinkedContext().getValue('currentFolder');if(n&&n.rootName)t.setParam('SortFor'+n.rootName,i);},onChangeFilter:function(e,t){var i='SortByName',s='True'===t.OnlyDeleted,n=this._mainBrowser&&this._mainBrowser.getFilter()['catalogId'],r=n===h.ROOT_FOLDER_COMMON_TRASH||n===h.ROOT_FOLDER_COMMON,a=s?r?h.ROOT_FOLDER_COMMON_TRASH:h.ROOT_FOLDER_MY_TRASH:r?h.ROOT_FOLDER_COMMON:h.ROOT_FOLDER_MY,l=this.getLinkedContext();if(s){i='SortByDateDelete';var d=o(l.getValue('currentFolder'));if(d)d.sortBy=l.getValue('sortBy')&&l.getValue('sortBy')[0]||'SortByName',l.setValue('folderBeforeEnterTrash',d);h.setListFilter(l,{catalogId:a,folder:a,sortBy:i,onlyDeleted:t.OnlyDeleted}),this._mainBrowser&&this._mainBrowser.setCurrentRoot(a);}else{var c=l.getValue('folderBeforeEnterTrash');i=c&&c.sortBy||'SortByName',h.setListFilter(l,{catalogId:c?c.catalogId:a,folder:c?c.Id:a,sortBy:i,onlyDeleted:t.OnlyDeleted,clearPath:true}),this._mainBrowser&&this._mainBrowser.setCurrentRoot(c?c.Id:a);}if(this._mainBrowser&&this._mainBrowser.removeItemsSelectionAll(),l.getValue('isSearch')){var u=this.getLinkedContext().getValue('listFiltersFindName');h.setListFilterForFind(this.getLinkedContext(),{catalogId:a,folder:a,sortBy:s?'SortByDateDelete':'SortByName',onlyDeleted:t.OnlyDeleted,SearchString:u.SearchString}),this._reestrFindName.getTreeView().setCurrentRoot(a),this._reestrFindBody.getTreeView().setCurrentRoot(a);}this._setSorterData(i,null,s),this._changeVisibleOptions(s,a),l.setValue('canDragNDropItems',!s?'onlyChangeParent':false),this._mainReestr&&this._mainReestr.setUserTemplate('diskClassic',this.getColumnsForList(a,false,s));var m=this.getColumnsForList(a,true,s);this._reestrFindName&&this._reestrFindName.setUserTemplate('diskClassic',m),this._reestrFindBody&&this._reestrFindBody.setUserTemplate('diskClassic',m);},_changeVisibleOptions:function(e,t){var i=!e;if(t&&(t===h.ROOT_FOLDER_LOADS||t===h.ROOT_FOLDER_SHARED||t===h.ROOT_FOLDER_SIGNED))i=false;var s=this._options.mainOptions.readOnly,n={addPage:false,fullScreen:false,saveToPdf:false,rights:!s,editGroup:!e,copyToBuffer:!e,restore:e,sendMessage:!e,rename:!e&&!s,edit:!e&&!s,editInApp:!e&&!s,imageEdit:!e&&!s,print:!e,deleteDoc:!e&&!s,deletePermanentlyDoc:e&&!s,move:i&&!s,links:!e,encrypt:!e&&!s,editPdf:false,redactions:!e,signDocument:!e&&!s,addFavorites:!e,linksGroup:false};this._notify('onChangeDocviewCommands',n),this.getLinkedContext().setValue('visibleCommands',n);},onChangeCurrentFolder:function(e,s){if(this.getChildControlByName('CDButtons').onCurrentFolderChange(s),s.isArchive)return;var n=this,r=this.getLinkedContext(),o=r.getValue('listFilters');if(i.channel('SbisDiskEvents').notify('onGoToZip',false),o&&o.folder&&o.folder.indexOf('_ZIP')>-1)r.getValue('listFilters').folder=s.Id;r.setValue('searchStringPlaceholder',h.getSearchStringPlaceholder(s.rootName)),r.setValue('currentFolder',s),r.setValue('currentFolderId',s.Id),o.Path=s.path||null,r.setValue('listFilters',o);var a=['upload','rename','links','copyToBuffer'],l=s.Id!=h.ROOT_FOLDER_COMMON;a.forEach(function(e){n._massPanel.setCommandCfg(e,{inSingle:l});});var d=s.rootName===h.ROOT_FOLDER_COMMON_TRASH||s.rootName===h.ROOT_FOLDER_MY_TRASH;if(n._mainReestr.setCommandCfg('deleteDoc',{isMainAction:!d}),n._mainReestr.setCommandCfg('restore',{isMainAction:d}),this._reestrFindName&&this._reestrFindName.setCommandCfg('deleteDoc',{isMainAction:!d}),this._reestrFindName&&this._reestrFindName.setCommandCfg('restore',{isMainAction:d}),this._reestrFindBody&&this._reestrFindBody.setCommandCfg('deleteDoc',{isMainAction:!d}),this._reestrFindBody&&this._reestrFindBody.setCommandCfg('restore',{isMainAction:d}),s.Id===s.rootName&&s.rootName!=h.ROOT_FOLDER_COMMON)r.setValue('currentFolderForMassPanel',null);else r.setValue('currentFolderForMassPanel',{attachId:s.Id,'folder@':true,title:s.Name,fileName:s.Name,Type:s.Type,canEdit:s.writeAccessRight});if(!n._options.fromFloatArea)try{var c=JSON.stringify(s);if(c)t.setParam('SbisDiskLastFolder_'+s.rootName,c);}catch(e){}},onOpenFolder:function(e,t){var i=this._mainReestr.getTreeView();if(!t.rootName){var s=this.getLinkedContext().getValue('currentFolder');t.rootName=s.rootName;}this._openFolder(i,t,null);},_onOpenFolderFromSearch:function(e){this.onOpenFolder(void 0,e);},onSetEmptySearchString:function(){this._searchString.resetSearch();},onSetMarkedObject:function(e,t){this.getLinkedContext().setValue('rowForSelect',t);},onUpdateRecentFilesLazy:function(){var e=this.getLinkedContext();if(e.getValue('isShowedFullScreen'))e.setValue('needUpdateRecentFiles',true);else i.channel('SbisDiskEvents').notify('onUpdateRecentFiles');},onGetCurrentFolder:function(e){var t=i.channel('SbisDiskCommands').notify('onGetFolderForUpload')||null;e.setResult(t||this.getLinkedContext().getValue('currentFolder'));},onChangeDocumentsList:function(e,t){if(this._options.mainOptions.autoRefreshList)i.channel('SbisDiskEvents').notify('onReloadList','upload'===t.type||'create'===t.type);},onUpdateObjectInSearch:function(e,t,i){var s=this,n=s._reestrFindName.getTreeView().getItems()?s._reestrFindName.getTreeView().getItems().getRecordById(t):null,r=s._reestrFindBody.getTreeView().getItems()?s._reestrFindBody.getTreeView().getItems().getRecordById(t):null;if(!n&&!r)return;var o=r?s._reestrFindBody:s._reestrFindName;(0===i?f.readFolderInfo:f.readAttachmentInfo)({objectName:'FileSD',serviceUrl:h.getDiskServiceURL(),id:t}).addCallback(function(e){o.redrawItemDocview(t,e);});},_onFinishCommand:function(e,t,s){var n=this;if('deleteDoc'===t){var r=function(){if(n._options.mainOptions.autoRefreshList)i.channel('SbisDiskEvents').notify('onReloadList',true);};if(m.onFinishDeleteObjects(s.records,n,r),this._options.mainOptions.autoRefreshList)i.channel('SbisDiskEvents').notify('onReloadList',true);}else if('rights'===t){if(this._mainBrowser&&s&&s.finishParams&&!s.finishParams.withoutReload)if(this.getLinkedContext().setValue('pageSizeForSelect',this._mainBrowser.getItems().getCount()),s.records&&1===s.records.length)this._mainBrowser.partialyReload([s.records[0].get('attachId')]);else this._mainBrowser.reload();}else if('moveDocuments'===t){if(m.onFinishMove(s.from,s.to,true,n),this._options.mainOptions.autoRefreshList)i.channel('SbisDiskEvents').notify('onReloadList',false);}else if('move'===t){if(s.records&&s.finishParams&&s.finishParams.destinationFolderId)new F(s.records).each(function(e){n._mainReestr.deleteItem(e.get('attachId'));});}else if('addFavorites'===t)this._cdArea.handleAddFavorites(s.finishParams.methodResult);},_onStartCommand:function(e,t,s){var n=this.getLinkedContext();if('fullScreen'===t&&s&&s.records[0]&&!s.records[0].get('folder@'))n.setValue('isShowedFullScreen',true);else if('closeFullScreen'===t){if(n.setValue('isShowedFullScreen',false),n.getValue('needUpdateRecentFiles'))n.setValue('needUpdateRecentFiles',false),i.channel('SbisDiskEvents').notify('onUpdateRecentFiles');}else if('startShowDocument'===t){var r=n.getValue('currentFolder');e.setResult(r.rootName==h.ROOT_FOLDER_LOADS);}else if(('edit'===t||'editInApp'===t||'imageEdit'===t)&&s&&s.records[0])u.NotifyRecentFileById(s.records[0].get('attachId')).addCallback(function(){i.channel('SbisDiskEvents').notify('onUpdateRecentFiles');});},_onErrorCommand:function(e,t,i){},_onFinishCommandInSearch:function(e,t,i){if('restore'===t)this.getTreeView().reload();},_onShowFile:function(e,t){if(h.currentFolderIsArchive(this._mainReestr))return;if(t&&!t.get('folder@'))u.NotifyRecentFileById(t.get('attachId')),this.onUpdateRecentFilesLazy();},_onShowFileFromRecent:function(e,t){if(t&&!t.get('folder@'))u.NotifyRecentFileById(t.get('attachId'));},_openFolder:function(t,i,s){var n=this,r=this.getLinkedContext();if(i.folderIsDeleted)r.setValue('filters',{OnlyDeleted:'True'});var o={catalogId:i.rootName,root:i.rootName,folder:i.folderId,onlyDeleted:i.folderIsDeleted?'True':'Все','ФильтрДатаПериод':'Все',sortBy:s};if(i.clearPath)o['clearPath']=true;if(r.getValue('isSearch'))n.resetSearchBlock();if(i.fileId){var a=new e();if(a=Object.keys(o).reduce(function(t,i){var s=i,n=o[i];if('sortBy'==i)s='SortBy';return t.addColumn(s,e.FIELD_TYPE_STRING),t.set(s,n),t;},a),h.currentFolderIsArchive(n._mainReestr)&&i.rootName)n._mainReestr.goFromZip(i.rootName,false);u.FilePosInList(i.fileId,a).addCallbacks(function(e){if(e>50)r.setValue('pageSizeForSelect',e+50);var s=r.getValue('currentFolder');if(n._mainReestr._options.listOptions.defaultRecordPK=i.fileId,s&&s.Id==o.folder)t.reload();else h.setListFilter(r,o),t.setCurrentRoot(i.folderId);},function(e){if(o.folder=o.catalogId,i.folderId=o.catalogId,4===e.error_code)h.showErrorNotification(rk('Ошибка перехода'),h.NOT_ACCESS_ERROR_MESSAGE);h.setListFilter(r,o),t.setCurrentRoot(i.folderId),r.setValue('rowForSelect',i.fileId);});}else h.setListFilter(r,o),t.setCurrentRoot(i.folderId);},_onGoToZip:function(e,t){var s='Archive'===t.mainOptions.objectName;if(i.channel('SbisDiskEvents').notify('onGoToZip',s),s){this.getLinkedContext().setValue('currentFolderId','archive');var n=t.listOptions.root.split('_')[0];if(n&&n.length>31)u.NotifyRecentFileById(n);}this._mainBrowser.setItemsDragNDrop(!s);},resetSearchBlock:function(){var e=this.getLinkedContext();if(this._searchString.resetSearch(),e.setValue('isSearch',false),e.setValue('needShowSearch',false),this._massPanelButton)this._massPanelButton.setEnabled(true);},initSearchTemplate:function(e){var t=this.getLinkedContext().getValue('listFilters');e.setUserTemplate('diskClassic',this.getColumnsForList(t.catalogId,true,'True'===t.OnlyDeleted));},getColumnsForList:function(e,t,i){return this._notify('onChangeColumns',e,t,i)||S(e,t,i);},_firstLoad:function(){}});return O;});
define('js!SBIS3.EDO.CD.AttachFromSbisDisk',['SBIS3.CONTROLS/CompoundControl','js!SBIS3.SBISDISK.AttachDocuments','Core/Deferred','SbisDiskDocuments_localization'],function(e,t,o){'use strict';var l=e.extend({$protected:{_options:{resizable:false,modal:true,autoHeight:true,autoWidth:true},_eventsChannel:null}});return l.show=function(e){var l=new o();return e=e||{},t.show({opener:e.opener,title:e.title||rk('Прикрепить как'),defaultTypeSwitcher:e.defaultTypeSwitcher,disableSwitcher:e.disableSwitcher,destinationFolderId:e.destinationFolderId,selectedTabsId:e.sourceFolderId,onlySelect:e.onlySelect,canSelectFolder:e.canSelectFolder,multiselect:e.multiselect,groupDocsCatalogId:e.groupDocsCatalogId,groupPhotoCatalogId:e.groupPhotoCatalogId,componentHandlers:{onAttachFiles:function(e,t){l.callback(t);}}}),l;},l;});
define("html!SBIS3.EDO.CD.SaveToSbisDisk",function(){var o=function(o){var t=function(){var o={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},t=/&(?!#?\w+;)|<|>|"|'|\//g;return function(n){return n?n.toString().replace(t,function(t){return o[t]||t}):n}}(),n=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;o.test(t);)t=t.replace(o,"&#123;&#123;$1&#125;&#125;");return t}}(),e=function(o){return o.join?o.join(""):o.toString()},i=function(o){return void 0===o?"":o&&"object"==typeof o?e(o):""+o},a="undefined"!=typeof process,p=("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),s=function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,r='<div class="cd-saveToSbisDisk"> <div class="ws-window-titlebar-custom"> <div class="cd-saveToSbisDisk__buttons"> <component data-component="SBIS3.CONTROLS/Switcher/Double" name="SaveAsSwitcher" class="cd-saveToSbisDisk__switcher"> <option name="stateOn">'+n(i(t(o.linkButton.caption)))+'</option> <option name="stateOff">'+n(i(t(o.copyButton.caption)))+'</option> <option name="state">'+n(i(t(o.linkButton.visible?"on":"off")))+'</option> <option name="visible" type="boolean">'+n(i(t(o.switcher.visible)))+'</option> <option name="enabled" type="boolean">'+n(i(t(o.switcher.enabled)))+'</option> </component> <component data-component="SBIS3.CONTROLS/Button" name="OkButton" class="cd-saveToSbisDisk__button"> <option name="caption">'+n(i(rk("Добавить")))+'</option> <option name="primary" type="boolean">true</option> <option name="visible" type="boolean">'+n(i(t(o.switcher.okButton)))+'</option> </component> <component data-component="SBIS3.CONTROLS/Button" name="SwapButton" class="cd-saveToSbisDisk__button"> <option name="tooltip">'+n(i(t(o.swapButton&&o.swapButton.caption||rk("Поместить оригинал"))))+'</option> <option name="caption">'+n(i(t(o.swapButton&&o.swapButton.caption||rk("Поместить оригинал"))))+'</option> <option name="primary" type="boolean">true</option> <option name="visible" type="boolean">'+n(i(t(o.swapButton&&o.swapButton.visible)))+"</option> </component> </div> </div> ";return o.rootFolderId||(r+=' <component data-component="SBIS3.CONTROLS/Tab/Buttons" name="Tabs"> <option name="displayProperty">title</option> <option name="idProperty">id</option> <options name="items" type="array"> <options> <option name="title">'+n(i(rk("Мои документы")))+'</option> <option name="id">mydocs</option> <option name="align">left</option> </options> <options> <option name="title">'+n(i(rk("Общие документы")))+'</option> <option name="id">commondocs</option> <option name="align">left</option> </options> </options> </component> '),r+=' <div class="cd-saveToSbisDisk__description ',o.swapButton&&!0===o.swapButton.visible||(r+="ws-hidden"),r+='"> '+n(i(rk("Оригинал будет помещен в общие документы, в исходном месте будет размещена ссылка")))+' </div> <div class="cd-saveToSbisDisk__folders-container"> <component data-component="SBIS3.CONTROLS/ScrollContainer" class="cd-saveToSbisDisk__scroll-container"> <option name="content"> <component data-component="SBIS3.CONTROLS/Tree/DataGridView" name="Folders" class="cd-saveToSbisDisk__folders controls-DataGridView__overflow-ellipsis"> <opt name="idProperty" value="attachId"></opt> <opt name="parentProperty" value="folder"></opt> <opt name="partialyReload" value="false"></opt> <opts name="itemsActions" type="array"></opts> <opt name="itemsDragNDrop" value="false"></opt> <opt name="allowEnterToFolder" type="boolean">false</opt> <opt name="showHead" type="boolean">false</opt> <opts name="columns" type="array"> <opts> <opt name="field">title</opt> </opts> <opts> <opt name="width">36</opt> <opt name="cellTemplate" type="ref">'+n(i(function(o,t){var n=p.randomId();return o[n]=t,n}(s,o.linkCellTemplate)))+"</opt> </opts> </opts> </component> </option> </component> </div> </div>",(r=n(r))+(a&&-1!==r.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.CD.SaveToSbisDisk"}},o});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.CD.SaveToSbisDisk", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".cd-saveToSbisDisk__icon-link{padding-top:4px}.cd-saveToSbisDisk{width:550px;height:100%}.cd-saveToSbisDisk .ws-float-area-title{float:left;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:250px;font-style:normal}.cd-saveToSbisDisk__buttons{margin-right:45px;margin-top:8px;float:right}.cd-saveToSbisDisk__switcher{font-weight:400}.cd-saveToSbisDisk__button{display:inline-block;margin-left:8px}.cd-saveToSbisDisk__description{font-size:12px;color:#ccc;margin-left:8px}.cd-saveToSbisDisk__folders-container{padding-top:12px;height:calc(100% - 40px)}.cd-saveToSbisDisk__scroll-container{height:calc(100% - 32px)}.cd-saveToSbisDisk__folders{padding-bottom:8px}"));head.appendChild(style);});}
define('js!SBIS3.EDO.CD.SaveToSbisDisk',['Core/core-merge','Core/helpers/String/escapeHtml','Core/helpers/fast-control-helpers','Core/helpers/collection-helpers','Core/Indicator','Core/Deferred','WS.Data/Source/SbisService','SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.CD.SaveToSbisDisk','js!SBIS3.BL.FileSD','js!SBIS3.EDO.CD.CommonDocsHelpers','Lib/ServerEvent/Bus','css!SBIS3.EDO.CD.SaveToSbisDisk','SBIS3.CONTROLS/Toolbar','SBIS3.CONTROLS/Tab/Buttons','SBIS3.CONTROLS/Switcher/Double','SBIS3.CONTROLS/ScrollContainer','SBIS3.CONTROLS/Tree/DataGridView','SbisDiskDocuments_localization'],function(e,t,o,i,s,n,r,l,a,c,d,u){'use strict';var h=l.extend({_dotTplFn:a,$protected:{_options:{resizable:false,modal:true,autoHeight:true,autoWidth:true,allowLink:true,linkCellTemplate:function(e){if(e.item.get('Flags')&&e.item.get('Flags').get('IsLink'))return'<i class="icon-16 icon-Linked icon-disabled cd-saveToSbisDisk__icon-link" title="'+rk('Ссылка на папку')+'&#010;'+rk('Эта папка не занимает места на вашем диске')+'"></i>';else return'';}},_eventsChannel:null},_modifyOptions:function(e){if(e.rootFolderId!==d.ROOT_FOLDER_COMMON&&e.rootFolderId!==d.ROOT_FOLDER_MY)e.rootFolderId=null;return e;},init:function(){h.superclass.init.call(this);var e=this,t=this._folders=this.getChildControlByName('Folders');this._initTabs(),this._initDataSource(t),this._initButtons();},destroy:function(){h.superclass.destroy.call(this),this._folders=this._tabs=null;},_initTabs:function(){var e=this;if(!this._options.rootFolderId)if(this._tabs=this.getChildControlByName('Tabs'),this.subscribeTo(this._tabs,'onSelectedItemChange',function(){e._updateFolders.call(e,false);}),d.isPersonalAccount().addCallback(function(t){if(e._tabs&&t)e._tabs.getItemInstance('commondocs').setVisible(false);}),!d.hasCommonDocsZoneRights())e._tabs.getItemInstance('commondocs').setVisible(false);},_initDataSource:function(e){var t=new r({endpoint:{address:d.getDiskServiceURL(),contract:'FileSD'},binding:{format:'AttachList',query:'AttachList'},idProperty:'attachId'});this._updateFolders(true),e.setDataSource(t);},_updateFolders:function(e){var t=this._folders.getFilter()||{};t['folder']=t['catalogId']=this._getRootId(),t['ВидДерева']='Только узлы',t['Разворот']='С разворотом',this._folders.setRoot({attachId:t['catalogId'],'folder@':true,title:d.getRootName(t['catalogId'])}),!e&&this._folders.setCurrentRoot(t['catalogId']),this._folders.setFilter(t,e),this._folders._options.partialyReload=true,this._folders.setSelectedKey(t['catalogId']);},_getRootId:function(){return this._tabs?this._tabs.getSelectedKey():this._options.rootFolderId;},_getDestinationFolderId:function(){var e=this,t=this._folders.getSelectedItem(),o=this._folders.getRoot();return e._selectedFolderName=t?t.get('title'):o.title,e._selectedFolderId=t?t.get('attachId'):o.attachId,e._selectedFolderId;},_getOperationType:function(){return'on'===this.getChildControlByName('SaveAsSwitcher').getState()?'link':'copy';},_initButtons:function(){this.subscribeTo(this.getChildControlByName('SwapButton'),'onActivated',this._onSwapButtonClick.bind(this)),this.subscribeTo(this.getChildControlByName('OkButton'),'onActivated',this._onOkButtonClick.bind(this));},_onSwapButtonClick:function(){var e=this;s.setMessage(rk('Перемещение оригинала')+'...'),c.TakeAwayHardLink(e._options.fileId,e._getDestinationFolderId()).addCallbacks(e._onSwapSuccess.bind(e),e._onError.bind(e));},_onOkButtonClick:function(){var e=this,t=e._getDestinationFolderId();if('link'===this._getOperationType())s.setMessage(rk('Создание ссылки')+'...'),c.CreateLink(e._options.fileId,t).addCallbacks(e._onLinkSuccess.bind(e),e._onError.bind(e));else s.setMessage(rk('Копирование')+'...'),c.Copy(e._options.fileId,t).addCallbacks(e._onCopySuccess.bind(e),e._onError.bind(e));},_onCopySuccess:function(e){this._onSuccess(e.get('Result'),false,e.get('Ticket'));},_onSwapSuccess:function(e){this._onSuccess(e,false,null,true);},_onLinkSuccess:function(e){this._onSuccess(e,true);},_onError:function(e){d.showErrorNotification(rk('Не удалось скопировать документы'),e.message),this._unlock();},_onSuccess:function(e,t,o,s){var n=this._parseResponseResult(e),r=this._parseResponseErrors(e),l;if(r.length)l=i.filter(r,function(e){return!!e;}).join('<br/>'),d.showErrorNotification(s?rk('Ошибка при перемещении'):rk('Ошибка при копировании'),l);if(this._unlock(),r.length<n.length)i.forEach(n,function(e){e['isLink']=t,e['isSwap']=s;}),this.getParent().close({files:n,ticket:o});},_parseResponseResult:function(e){return i.map(e.getRecords(),function(e){return{id:e.get('SourceId'),newObjectId:e.get('Id'),newVersionId:e.get('VersionId'),error:e.get('ErrorMsg'),destinationFolderName:this._selectedFolderName,destinationFolderId:this._selectedFolderId,destinationFolderRoot:this._getRootId()};},this);},_parseResponseErrors:function(e){var o=i.filter(e.getRecords(),function(e){return!e.get('Success');});return i.map(o,function(e){return t(e.get('ErrorMsg'));});},_lock:function(){this._folders.setEnabled(false);},_unlock:function(){this._folders.setEnabled(true),s.hide();},_linkIconRender:function(e){if(e.get('Flags')&&e.get('Flags').get('IsLink'))return'<i class="icon-16 icon-Linked icon-disabled cd-saveToSbisDisk__icon-link" title="'+rk('Ссылка на папку')+'&#010;'+rk('Эта папка не занимает места на вашем диске')+'"></i>';return'';}});return h.show=function(t,i){var s=new n();if(!t||t instanceof Array&&0===t.length)return s.errback();var r={fileId:t,rootFolderId:(i=i||{}).rootFolderId};return r.linkButton=e({caption:rk('Ссылку'),visible:true},i.linkButton||{}),r.copyButton=e({caption:rk('Копию'),visible:true},i.copyButton||{}),r.swapButton=e({caption:rk('Поместить оригинал'),visible:false},i.swapButton||{}),r.switcher={enabled:r.linkButton.visible&&r.copyButton.visible,visible:r.linkButton.visible&&r.copyButton.visible,okButton:r.linkButton.visible||r.copyButton.visible},o.showFloatArea({isStack:true,autoHide:true,autoShow:true,side:'right',modal:true,autoCloseOnHide:true,opener:i.opener,parent:i.opener,title:i.title||rk('Сохранить'),template:'js!SBIS3.EDO.CD.SaveToSbisDisk',className:'ws-float-area__block-layout',componentOptions:r,handlers:{onAfterClose:function(e,t){if(!t)s.callback();else if(t.ticket)u.serverChannel('sbisdisk.long-async-operations').subscribe('onMessage',o);else{if(i.onAfterClose)i.onAfterClose();s.callback(t.files);}function o(e,i){if(i===t.ticket)u.serverChannel('sbisdisk.long-async-operations').unsubscribe('onMessage',o),s.callback(t.files);}}}}),s;},h;});
define("html!SBIS3.EDO.CD.GroupMembersPanel",function(){var o=function(o){var n=function(){var o={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},n=/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(n,function(n){return o[n]||n}):t}}(),t=function(){var o=/\{\{([\s\S]+?)\}\}/g;return function(n){for(;o.test(n);)n=n.replace(o,"&#123;&#123;$1&#125;&#125;");return n}}(),e=function(o){return o.join?o.join(""):o.toString()},i=function(o){return void 0===o?"":o&&"object"==typeof o?e(o):""+o},r="undefined"!=typeof process,p=("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),a=function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,s='<div class="cd-groupMembers"> <div class="ws-window-titlebar-custom ws-caption"> <div class="ws-caption groupMembers_title">'+t(i(rk("Участники группы")))+' "'+t(i(n(o.groupName)))+'"</div> </div> <component data-component="SBIS3.CONTROLS/DataGridView" name="GroupMembers" class="controls-DataGridView__hasSeparator controls-ListView__hideCheckBoxes"> <options name="itemsActions" type="array"></options> <option name="itemTpl" type="ref" value="'+t(i(function(o,n){var t=p.randomId();return o[t]=n,t}(a,o.rowTpl)))+'"></option> <option name="idProperty">Person</option> <option name="autoHeight">true</option> <option name="showPaging" type="boolean">false</option> <option name="infiniteScroll" value="true"></option> <option name="ignoreLocalPageSize">true</option> <option name="paging">full</option> <option name="pageSize">50</option> <option name="itemsDragNDrop">false</option> <option name="multiselect">true</option> <options name="columns" type="array"> <options> <option name="title"></option> </options> <options> <option name="title">'+t(i(rk("Уровень доступа")))+'</option> <option name="width">120</option> </options> </options> <options name="filter"> <option name="Group">'+t(i(o.groupId))+'</option> <option name="Id">'+t(i(o.fileId))+'</option> <option name="Rights">'+t(i(o.rights))+"</option> </options> </component> </div>";return(s=t(s))+(r&&-1!==s.indexOf("{{")?String.fromCharCode(8203,8203):"")};return o.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.CD.GroupMembersPanel"}},o});
define("html!SBIS3.EDO.CD.GroupMembersPanel/templates/rowTpl",function(){var e=function(e){var t=function(){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},t=/&(?!#?\w+;)|<|>|"|'|\//g;return function(o){return o?o.toString().replace(t,function(t){return e[t]||t}):o}}(),o=function(){var e=/\{\{([\s\S]+?)\}\}/g;return function(t){for(;e.test(t);)t=t.replace(e,"&#123;&#123;$1&#125;&#125;");return t}}(),r=function(e){return e.join?e.join(""):e.toString()},n=function(e){return void 0===e?"":e&&"object"==typeof e?r(e):""+e},i="undefined"!=typeof process,a=(("undefined"!=typeof _randomHelpers?_randomHelpers:void 0)||global.requirejs("Core/helpers/random-helpers"),function(){return this||(0,eval)("this")}().wsDotVarStorage.storage,""),s=" - ";switch(e.item.get("Access")){case 0:s="Запрещен";break;case 1:s="Просмотр";break;case 2:s="Изменение+";break;case 3:s="Изменение";break;case 99:s="Полный"}return a+=' <tr class="controls-ListView__item js-controls-ListView__item" data-hash="'+o(n(e.projItem.getHash()))+'" data-id="'+o(n(e.item.getId()))+'"> <td class="controls-DataGridView__td controls-DataGridView__td__checkBox"></td> <td class="controls-DataGridView__td controls-DataGridView-cell-overflow-ellipsis"> <component data-component="SBIS3.EDO.CD.PersonInfo"> <option name="personId" value="'+o(n(t(e.item.get("Person"))))+'"></option> <option name="personDepartment" value="'+o(n(t(e.item.get("Department"))))+'"></option> <option name="personName" value="'+o(n(t(e.item.get("Name"))))+'"></option> <option name="personMiniPhotoId" value="'+o(n(t(e.item.get("PersonMiniPhotoId"))))+'"></option> </component> </td> <td class="controls-DataGridView__td controls-DataGridView-cell-overflow-ellipsis controls-DataGridView-cell-verticalAlignTop groupMembers__td-access"> <div class="groupMembers__td-access__value">'+o(n(s))+"</div> </td> </tr>",(a=o(a))+(i&&-1!==a.indexOf("{{")?String.fromCharCode(8203,8203):"")};return e.toJSON=function(){return{$serialized$:"func",module:"html!SBIS3.EDO.CD.GroupMembersPanel/templates/rowTpl"}},e});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.CD.GroupMembersPanel", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".groupMembers_title{padding-top:8px;margin-left:8px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:345px}.groupMembers__td-access__value{height:32px;line-height:16px}"));head.appendChild(style);});}
define('js!SBIS3.EDO.CD.GroupMembersPanel',['Core/helpers/fast-control-helpers','Core/Deferred','SBIS3.CONTROLS/CompoundControl','html!SBIS3.EDO.CD.GroupMembersPanel','html!SBIS3.EDO.CD.GroupMembersPanel/templates/rowTpl','WS.Data/Source/SbisService','js!SBIS3.EDO.CD.CommonDocsHelpers','css!SBIS3.EDO.CD.GroupMembersPanel','SBIS3.CONTROLS/DataGridView','js!SBIS3.EDO.CD.PersonInfo','SbisDiskDocuments_localization'],function(e,r,t,o,s,n,l){'use strict';var i=t.extend({_dotTplFn:o,$protected:{_options:{resizable:false,modal:true,autoHeight:true,autoWidth:true,allowLink:true,groupId:null,fileId:null,rights:null,groupName:null,rowTpl:s},_eventsChannel:null},$constructor:function(){},init:function(){i.superclass.init.call(this);var e=this,r=new n({endpoint:{address:l.getDiskServiceURL(),contract:'FileSD'},binding:{format:'ListOfGroupMembers',query:'ListOfGroupMembers'},idProperty:'Person'});this.getChildControlByName('GroupMembers').setDataSource(r);},destroy:function(){i.superclass.destroy.call(this);}});return i.show=function(t,o,s){var n=new r();return s=s||{},e.showFloatArea({isStack:true,autoHide:false,autoCloseOnHide:true,overlay:true,minWidth:400,opener:s.opener,template:'js!SBIS3.EDO.CD.GroupMembersPanel',componentOptions:{groupId:t,fileId:o,rights:s.rights,groupName:s.groupName}}),n;},i;});
define('js!SBIS3.EDO.CD.SharedPage',['SBIS3.CONTROLS/CompoundControl','js!SBIS3.EDO.CD.PublicCommonDocs','SbisDiskDocuments_localization'],function(n){var o=n.extend({$protected:{_options:{}},init:function(){o.superclass.init.call(this);}});return o;});
if(typeof window !== "undefined" && window.atob){define("css!SBIS3.EDO.CertificateTrust", function() {var style = document.createElement("style"),head = document.head || document.getElementsByTagName("head")[0];style.type = "text/css";style.appendChild(document.createTextNode(".edo-CertificateTrust_signatureText{cursor:pointer;color:#05b;font-size:12px;font-style:normal;font-weight:400;margin-left:5px;height:18px;line-height:18px}.edo-CertificateTrust_signatureName{display:inline}.edo-CertificateTrust_signatureIco{visibility:hidden}.edo-CertificateTrust_trustIco{position:relative;top:3px}.edo-CertificateTrust_trustIco_normal{display:inline}.edo-CertificateTrust_signatureText:hover .edo-CertificateTrust_trustIco_normal{display:none}.edo-CertificateTrust_trustIco_hover{display:none}.edo-CertificateTrust_signatureText:hover .edo-CertificateTrust_trustIco_hover{display:inline}.edo-CertificateTrust_trustName{margin-left:4px;text-decoration:none}.edo-CertificateTrust_signatureText:hover .edo-CertificateTrust_trustName{text-decoration:underline;color:#ff7a3e}.trustSignaturesTable tr:hover .edo-CertificateTrust_signatureIco{visibility:visible}"));head.appendChild(style);});}
define('js!SBIS3.EDO.FWorkspaceData',['js!SBIS3.Engine.RouteDataCollector','Core/Deferred','WS.Data/Source/SbisService','WS.Data/Chain','Core/moduleStubs','online.sbis.ru_localization'],function(t,e,a,i,o){'use strict';return t.extend({localTimeOut:2000,rootEndpoint:null,$protected:{meta:['getConfig','getData','getFoldersData','getGroupsData'],addDeps:[]},init:function(){var t=this.getQuery();if(t&&t.region_left&&t.region_left.split){var e=t.region_left.split('-')[1]||'Документ';if(e)this.rootEndpoint=new a({endpoint:e});}},extendDummy:function(t,e){return t['listData']=e['listData']||{},t['serverSideRendering']=e['serverSideRendering'],t['listData']['customData']=e['customData'],t;},getConfig:function(){var t=this,a=new e();if(t.rootEndpoint)t.rootEndpoint.call('Config',{}).addCallback(function(e){var i=e.getRow(),r='';if(i.has('Attributes'))r=i.get('Attributes')['registry'];else r=i.has('registry')?i.get('registry'):'';if(r)t.addDeps.push('js!'+r);o.require(['js!'+r]).addCallback(function(t){a.callback({compName:r,compModule:'js!'+r});}).addErrback(function(e){t.log('FRegistryRoutesController не удалось подключить компонент: '+e,0),a.callback({compName:'',compModule:''});});}).addErrback(function(e){t.log('FRegistryRoutesController не удалось вычислить компонент: '+e,0),a.callback({compName:'',compModule:''});});else if(t.log('FRegistryRoutesController не удалось определить объект',0),!a.isReady())a.callback({compName:'',compModule:''});return a;},getData:function(){var t=new e(),a=this,i=this.getUserAgent(),o=!!/(iPod|iPhone|iPad)/.test(i),r=!!(o&&i.match(/\bCriOS\b/)),s=o&&!r&&/AppleWebKit/.test(i)&&/Mobile\//.test(i),l={listData:void 0,url:a.getQuery(),className:'edoRegistry'+(s?' ws-is-mobile-safari':''),serverSideRendering:false};if(a.rootEndpoint)a.rootEndpoint.call('getListConfig',{params:this.getQuery()||null}).addCallback(function(e){var i=e.getRow();a.getListDataWithConfig(a,t,i,l,'list');}).addErrback(function(e){if(!t.isReady())a.log('FRegistryRoutesController: getListConfig завершился с ошибкой '+e,0),t.callback(l);});else if(a.log('FRegistryRoutesController: Невозможно вызвать getListConfig',0),!t.isReady())t.callback(l);return t;},getFoldersData:function(){var t=new e(),a=this,i={listData:void 0,serverSideRendering:false};if(a.rootEndpoint)a.rootEndpoint.call('getFoldersListConfig',{params:this.getQuery()||null}).addCallback(function(e){var o=e.getRow();a.getListDataWithConfig(a,t,o,i,'folders');}).addErrback(function(e){if(!t.isReady())a.log('FRegistryRoutesController folders: getFoldersListConfig завершился с ошибкой',0),t.callback(i);});else if(a.log('FRegistryRoutesController folders: Невозможно вызвать getFoldersListConfig',0),!t.isReady())t.callback(i);return t;},getGroupsData:function(){var t=new e(),a=this,i={listData:void 0,serverSideRendering:false};if(a.rootEndpoint)a.rootEndpoint.call('getGroupListConfig',{params:this.getQuery()||null}).addCallback(function(e){var o=e.getRow();a.getListDataWithConfig(a,t,o,i,'groups');}).addErrback(function(e){if(!t.isReady())a.log('FRegistryRoutesController groups: getGroupListConfig завершился с ошибкой',0),t.callback(i);});else if(a.log('FRegistryRoutesController groups: Невозможно вызвать getGroupListConfig',0),!t.isReady())t.callback(i);return t;},getListDataWithConfig:function(t,e,r,s,l){s=s||{};var n=r.has('customData')?r.get('customData'):null,g=r.has('navigationType')?r.get('navigationType'):void 0;switch(g){case'Position':g=a.prototype.NAVIGATION_TYPE.POSITION;break;case'Offset':g=a.prototype.NAVIGATION_TYPE.OFFSET;break;case'Page':g=a.prototype.NAVIGATION_TYPE.PAGE;break;default:g=a.prototype.NAVIGATION_TYPE.PAGE;}if(!r.get('skip')){var d=r.has('timeOut')?r.get('timeOut'):t.localTimeOut,c=r.has('pageSize')?r.get('pageSize'):21;setTimeout(function(){if(!e.isReady())t.log('FRegistryRoutesController: '+l+' завершился по timeout: '+d+'ms',0),e.callback(t.extendDummy(s,{customData:n}));},d);var u=new i(r.get('listFilter'));t.getListData({endpoint:r.get('objectName'),binding:{query:r.get('methodName')},options:{navigationType:g}},u.toObject(),0,c,void 0,r.get('historyId')).addCallback(function(a){if(!e.isReady())if(!!a.items){var i=r.get('modelName');if(t.log('FRegistryRoutesController '+l+': getListData завершился с получением данных, модель: '+(i||'default'),0),!!i)o.require(['js!'+i]).addCallback(function(i){a.items.setModel(i[0]),a.items=a.items.getAll(),e.callback(t.extendDummy(s,{listData:a,serverSideRendering:true,customData:n}));}).addErrback(function(o){t.log('FRegistryRoutesController '+l+': не удалось подключить модель: '+i,0),a.items=a.items.getAll(),e.callback(t.extendDummy(s,{listData:a,serverSideRendering:true,customData:n}));});else a.items=a.items.getAll(),e.callback(t.extendDummy(s,{listData:a,serverSideRendering:true,customData:n}));}else t.log('FRegistryRoutesController '+l+': getListData завершился с пустыми items',0),e.callback(t.extendDummy(s,{listData:a,serverSideRendering:false,customData:n}));}).addErrback(function(a){if(!e.isReady())t.log('FRegistryRoutesController '+l+': getListData завершился с ошибкой '+a,0),e.callback(t.extendDummy(s,{customData:n}));});}else if(t.log('FRegistryRoutesController '+l+': getListData вызывать не нужно (skip == true)',0),!e.isReady())e.callback(t.extendDummy(s,{customData:n}));}});});
define('js!SBIS3.EDO.FRegistryRoutesController',['js!SBIS3.Engine.MasterPageControllerMin','tmpl!online.sbis.ru/Registry/templates/EDOFWorkspace','js!SBIS3.EDO.FWorkspaceData','online.sbis.ru_localization'],function(e){return e.extend({$protected:{items:{workspace:{template:'tmpl!online.sbis.ru/Registry/templates/EDOFWorkspace',dataModule:'js!SBIS3.EDO.FWorkspaceData'}}}});});