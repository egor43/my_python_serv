(function() {
   var availableDict = {"en-US":true,"ru-RU":true},
      langMatch = String(typeof document === 'undefined' ? '' : document.cookie).match(/lang=([A-z-]+)/),
      langName = langMatch ? langMatch[1] : 'ru-RU',
      langModule = 'text!WS.Core/lang/' + langName + '/' + langName + '.json';
   if (langName in availableDict) {
      define('WS.Core_localization', ['Core/i18n', langModule], function(i18n, data) {
         if (data){
            i18n.setDict(JSON.parse(data), langModule, langName);
         }
      });
   } else {
      define('WS.Core_localization', function() {});
   }
})();

define("Core/vdom/Utils/Monad",["Core/IoC"],function(n){"use strict";function r(n,r,t,u){var e=t;if(null===n||void 0===n)n=[];for(var o in n)if(n.hasOwnProperty(o))e=r.call(u,e,n[o],o,n);return e}function t(r){n.resolve("ILogger").error("Monad Writer Error: ",r)}function u(n,r,t){return t.join(n,function(n){return t.join(r,function(r){return t.pure(r.concat(n))})})}function e(n,r,e){if(r.callback)return r.addCallbacks(function(r){return u(n,r,e)},t);return u(n,r,e)}function o(n,r,u){if(n.callback)return n.addCallbacks(function(n){return e(n,r,u)},t);return e(n,r,u)}function i(n,t,u,e){return r(n,function(n,r,i){return o(t.call(e,r,i),n,u)},u.pure([]))}function c(n){return{join:function(r,t){var u=t(r.value);return{value:u.value,memo:n.plus(u.memo,r.memo)}},pure:function(r){return{value:r,memo:n.zero}}}}return{createWriterMonad:c,ArrayWriterMonad:c({plus:function(n,r){return n.concat(r)},zero:[]}),ListMonad:{join:function(n,t){return r(n,function(n,r){return n.concat(t(r))},[])},pure:function(n){return[n]}},mapM:i}});
define("Core/vdom/Utils/Functional",[],function(){"use strict";function r(r){var n=r.length,t=new Array(n),o;if("number"!==typeof n)throw new Error("argumentsToArray - wrong arg");for(o=0;o!==n;o++)t[o]=r[o];return t}function n(n,t){var o=Array.isArray(n)?n:r(arguments),e=o.length;return function(){var r=o[e-1].apply(this,arguments),n;for(n=e-2;n>=0;n--)r=r instanceof Array?o[n].apply(this,r):o[n].call(this,r);return r}}function t(r,n,t,o){var e=r.prototype,u=o,i=[],c,s;while(e&&e.constructor){if(e.hasOwnProperty(n)&&"function"===typeof e[n])if(s=e[n],s)i.push(s);e=e.constructor.superclass}for(c=i.length-1;-1!==c;c--)u=t(u,i[c]);return u}function o(r,t){return n(e(r,t))}function e(r,n){return t(r,n,function(r,n){return r.unshift(n),r},[])}function u(r,n){var t;if(!r)throw t="function"==typeof n?n():n,new Error(t||"assert")}return{composeWithResultApply:n,argumentsToArray:r,getHierarchyFunctions:e,composeHierarchyFunctions:o,reduceHierarchyFunctions:t,assert:u}});
define("Core/vdom/vdomutils",["View/Runner/Vdom/third-party/dom","View/Runner/expressions/contextResolver"],function(e,t){"use strict";var o="inline",n="cfg-";function r(e){return e.replace(n,"").split(",")[0]}function i(e,o,n,r){var i=window[e];if(window[e])window[e]=void 0;var c=i?o._beforeMount(n.controlProperties,n.context,JSON.parse(i,r.deserialize)):o._beforeMount(n.controlProperties,n.context);return o._contextObj=t.resolveContext(n.controlClass,n.context),o.saveFullContext(t.wrapContext(o,n.context||{})),c}return{htmlNode:function(t,o,n,r){return new e.VNode(t,o,n,r)},textNode:function(t){return new e.VText(t)},controlNode:function(e,t,o){return{controlClass:e,controlProperties:t,key:o,controlNodeIdx:-1}},isVNodeType:function(e){return e&&"object"===typeof e&&"VirtualNode"===e.type},isTextNodeType:function(e){return e&&"object"===typeof e&&"VirtualText"===e.type},isControlVNodeType:function(e){return e&&"object"===typeof e&&"controlClass"in e},getReceivedState:function e(t,n,c){var u=t.control,d=u.getDataId&&u.getDataId()?o+r(u.getDataId()):"";if(u._beforeMount)return i(d,u,n,c)}}});
define("Core/vdom/Synchronizer/resources/VdomMarkup",["Core/core-debug","Core/vdom/vdomutils","Core/vdom/Utils/Monad","Core/vdom/Utils/Functional"],function(e,o,r){"use strict";function t(e){return o.isVNodeType(e)?e.children:[]}function n(e,r,t){if(o.isVNodeType(t)){var n=e(t.tagName,t.properties,t.children,t.key,r);return t.tagName===n[0]&&t.properties===n[1]&&t.children===n[2]&&t.key===n[3]?t:o.htmlNode.apply(o,n)}else return t}function i(e,o,n,i){function s(o){var l=i(o)?[n(o)]:[];return e?l.concat(r.ListMonad.join(t(o),s)):l}return r.ListMonad.join(t(o),s)}function s(e){return e}function l(e){return i(true,e,s,o.isControlVNodeType)}function a(r,n){var i={create:[],destroy:[],update:[]},s,u,d,f,c,p,y;function N(e,o){function r(e){for(var o=0,r=e.length;o!==r;o++)if(void 0!==e[o].key)return true;return false}function t(e){for(var o={},r=[],t=e.length,n=0;n<t;n++){var i=e[n].key;if(void 0!==i)o[i]=n;else r.push(n)}return{keys:o,free:r}}var n,i,s,l,a,u,d,f,c,p,N,h,k;if(r(e)&&r(o)){for(u=t(e),d=t(o),i=u.keys,N=e.length,s=d.keys,h=o.length,a=(l=d.free).length,c=0,n=new Array(length),f=0;f!==N;f++)if(k=e[f],void 0!==k.key)if(s.hasOwnProperty(k.key))n[f]=o[s[k.key]];else n[f]=null;else if(c!==a)n[f]=o[l[c]],c++;else n[f]=null;for(p=c!==a?l[c]:h,f=0;f!==h;f++)if(y=o[f],void 0!==y.key){if(!i.hasOwnProperty(y.key))n.push(y)}else if(f>=p)n.push(o[f])}else n=o;return n}function h(e,r){var t=e&&o.isControlVNodeType(e),n=t===(r&&o.isControlVNodeType(r));if(n)if(t)n=e.controlClass===r.controlClass&&e.key===r.key;else if(n=e.type===r.type,n&&o.isVNodeType(e))n=e.tagName===r.tagName&&e.namespace===r.namespace&&e.key===r.key;return n}function k(e,o,r){e[o]=e[o].concat(r)}if(r!==n)if(e.checkAssertion(!!n,"newNode !== null"),h(r,n))if(o.isControlVNodeType(n))i.update.push({oldNode:r,newNode:n});else for(d=N(u=t(r),t(n)),f=Math.max(u.length,d.length),c=0;c!==f;c++)if(p=u[c],y=d[c],p&&y)k(i,"create",(s=a(p,y)).create),k(i,"destroy",s.destroy),k(i,"update",s.update);else if(p)if(o.isControlVNodeType(p))k(i,"destroy",[p]);else k(i,"destroy",l(p));else if(o.isControlVNodeType(y))k(i,"create",[y]);else k(i,"create",l(y));else{if(o.isControlVNodeType(n))i.create.push(n);else k(i,"create",l(n));if(r)if(o.isControlVNodeType(r))i.destroy.push(r);else k(i,"destroy",l(r))}return i}function u(e,r){var n,i,s,l,a,d,f;if(o.isControlVNodeType(r))n=e[r.controlNodeIdx].fullMarkup;else if(!o.isVNodeType(r)||0===r.children.length)n=r;else{i=0,l=(s=t(r)).length;while(i!==l){if(a=u(e,s[i]),a!==s[i])break;i++}if(i===l)n=r;else f=s.slice(i+1).map(u.bind(void 0,e)),d=s.slice(0,i).concat([a]).concat(f),n=o.htmlNode(r.tagName,r.properties,d,r.key)}return n}function d(e){return o.htmlNode("span",{},[o.textNode(e)])}function f(e,r){var t=e.control._getMarkup(e.key,r,e.attributes),i;if(o.isVNodeType(t))i=n(e.markupDecorator,e,t);else if(o.isControlVNodeType(t))i=n(e.markupDecorator,e,t);else i=t;if(!o.isControlVNodeType(i)&&!o.isVNodeType(i))i=d("control._getMarkup должен отдавать dom-узел");return i}return{mapVNode:n,getVNodeChidlren:t,getMarkupDiff:a,getFullMarkup:u,getDecoratedMarkup:f}});
define("Core/vdom/Synchronizer/resources/DirtyChecking",["Core/helpers/Object/isEqual","Core/constants","Core/vdom/Utils/Monad","Core/vdom/Utils/Functional","View/Runner/expressions/subscriber","Core/vdom/Synchronizer/resources/VdomMarkup","View/Runner/common","Core/vdom/vdomutils","View/Runner/expressions/compatible","Core/helpers/Function/shallowClone","View/Runner/expressions/contextResolver","Core/helpers/Function/runDelayed","Core/Serializer","Core/Deferred","Core/ParallelDeferred"],function(e,o,t,r,n,i,d,s,a,l,c,u,p){"use strict";var f;if(o.compat)global.requirejs(["Core/vdom/Synchronizer/resources/DirtyCheckingCompatible"],function(e){f=e});function m(e){if(e.control&&e.control._getInternalOption("parent")){var o=n.getEventsListFromOptions(e.options);n.applyEvents(e.control,e.control._getInternalOption("parent"),o)}}function N(e,o,t){e.parent=e.parent||t&&t.control||o.parent||null,e.logicParent=e.logicParent||t&&t.control&&t.control.logicParent||o.logicParent||null}var _={NONE:0,DIRTY:1,CHILD_DIRTY:2};function h(e){return"function"===typeof e?e:e["constructor"]}var v=[],y={},C=t.mapM,g={plus:function(e,o){return{createdNodes:e.createdNodes.concat(o.createdNodes),destroyedNodes:e.destroyedNodes.concat(o.destroyedNodes),updatedNodes:e.updatedNodes.concat(o.updatedNodes),updatedChangedNodes:e.updatedChangedNodes.concat(o.updatedChangedNodes),updatedUnchangedNodes:e.updatedUnchangedNodes.concat(o.updatedUnchangedNodes),selfDirtyNodes:e.selfDirtyNodes.concat(o.selfDirtyNodes)}},zero:{createdNodes:[],destroyedNodes:[],updatedNodes:[],updatedUnchangedNodes:[],updatedChangedNodes:[],selfDirtyNodes:[]}},b=(0,t.createWriterMonad)(g);function O(e,o){var t;for(t in o)if(o.hasOwnProperty(t))e[t]=o[t];return e}function k(o,t,r){var n,i,d=false,s={},a,l;for(n in t){if(r&&n&&n.indexOf("__dirtyCheckingVars_")>-1)continue;if(a=t.hasOwnProperty(n),a)if(l=o.hasOwnProperty(n),l){if("function"===typeof o[n]&&"function"===typeof t[n]||"number"===typeof o[n]&&"number"===typeof t[n]&&isNaN(o[n])&&isNaN(t[n]))continue;if(o[n]===t[n])if("object"===typeof o[n]&&o[n]&&o[n].changed)o[n].changed=false,d=true,s[n]=o[n];else continue;else if(Array.isArray(o[n])&&o[n])d=true,s[n]=o[n];else if(!e(o[n],t[n]))d=true,s[n]=o[n]}}return d?s:null}function I(e){return e=e||[],e.reduce(function(e,o){return e.concat(Array.isArray(o)?I(o):o)},[])}function x(e,o,t){var n=I(r.getHierarchyFunctions(o,"_getMarkupDecorators").map(function(o){return o.call(e)}));return{markupDecorator:r.composeWithResultApply.apply(void 0,n.concat(t.getMarkupNodeDecorator())).bind(e),defaultOptions:{}}}function D(e,o,t,r,n,i,d){var l=h(e),c=d&&d.compound,u=i&&i.state||{vdomCORE:true},p=o.user,m=o.internal||{},_;if(N(m,p,n),!t)t="_";if(c){if(!f)f=global.requirejs("Core/vdom/Synchronizer/resources/DirtyCheckingCompatible");_=f.createCompoundControlNode(e,l,p,m,t,n,d)}else{var y=d&&d.invisible,C=u?O(p,u):p,g,b;if("function"===typeof e){var k=a.createInstanceCompatible(l,C,m);g=k.instance,C=k.resolvedOptions}else if(C=a.combineOptionsIfCompatible(l.prototype,C,m),g=e,g._setInternalOptions)g._options.doNotSetParent=true,g._setInternalOptions(m||{});b=x(g,l,r),_={attributes:o.attributes,control:g,errors:i&&i.errors,controlClass:l,options:C,internalOptions:m,id:g.getHash&&g.getHash(),parent:n,key:t,defaultOptions:b&&b.defaultOptions,markup:y?s.textNode(""):void 0,fullMarkup:void 0,childrenNodes:v,markupDecorator:b&&b.markupDecorator,serializedChildren:i&&i.childrenNodes,hasCompound:false,receivedState:void 0,invisible:y,context:d&&d.context||{}},r.setupControlNode(_)}return _}function P(e){return l(e)}function R(e,o,t,r,n){if(t.receivedState&&t.receivedState.callback)return t.receivedState.addCallback(function i(s){return t.receivedState=s,t.control=d.plainMerge(t.control,s),M(e,o,t,r,n)});else return M(e,o,t,r,n)}function M(e,o,t,r,n){var d=t.id,l,f=o[d]||_.NONE,N=f!==_.NONE||r,h=!!(f&_.DIRTY)||r,y=t.markup,I,x=new p,M,S,U,w,F,z,A,E,j,V,H,q,T,W,Y;if(N){if(M=t.markup?P(t):t,Y=t.context,!M.compound&&!M.invisible){if(h&&M.control._mounted)M.control._beforeUpdate(M.options,Y),I=M.control._shouldUpdate(M.options,Y),h=h&&I;if(h){if(S=M,M.control.saveFullContext(c.wrapContext(M.control,M.context)),M.markup=i.getDecoratedMarkup(M,n),U=i.getMarkupDiff(y,M.markup),j=U.destroy.map(function o(t){var r=t.controlNodeIdx,n=S.childrenNodes[r];try{if(e.setRebuildIgnoreId(n.id),n.compound){var i=n.options,d=i.__vdomOptions&&i.__vdomOptions.controlNode.instance;if(d)u(function(){d.destroy()})}else n.control.__$destroyFromDirtyChecking=true,n.control.destroy()}finally{e.setRebuildIgnoreId(n.id)}return n}),W=new Array(U.create.length+U.update.length),T=U.update.length,w=U.create.map(function o(t,r){var n=T+r,i=S.serializedChildren,d=i&&i[n],a,l,c;if(!t.compound){if(a=t.controlProperties,c=D(t.controlClass,{user:a,internal:t.controlInternalProperties,attributes:t.controlAttributes},t.key,e,S,d,t),!c.control._mounted){if(l=s.getReceivedState(c,t,x),l)c.receivedState=l;if(c.control.saveOptions)c.control.saveOptions(c.options,c);else c.control._options=c.options,c.control._setInternalOptions(t.controlInternalProperties||{}),c.control._container=$(c.element)}m(c)}else c=D(t.controlClass,{user:O(t.controlProperties,t.controlInternalProperties)},t.key,e,S,d,t);return t.controlNodeIdx=n,W[t.controlNodeIdx]=true,c}),F=U.update.map(function o(t,r){var n=t.newNode,i=t.oldNode.controlNodeIdx,d=S.childrenNodes[i],s=d.control,l=true,p=n.compound?a.createCombinedOptions(n.controlProperties,n.controlInternalProperties):n.controlProperties,f=d.options,m=n.context,N=d.context,_=k(p,f,n.compound),h=k(m,N,false),v=k(n.controlAttributes,d.controlAttributes,n.compound),y;if(n.compound){if(p.__vdomOptions=f.__vdomOptions,_){var C=f.__vdomOptions&&f.__vdomOptions.controlNode.instance;if(C&&!C.__$$blockSetProperties){if(!C.___$$realOptions)C.___$$realOptions=C._options;if(k(p,C.___$$realOptions||{},n.compound))C.__$$blockSetProperties=true,C.setProperties(_),C.___$$realOptions=_,u(function(){C.__$$blockSetProperties=false})}}}else if(y=k(n.controlInternalProperties,d.internalOptions),_||y||v||h)try{e.setRebuildIgnoreId(d.id),s._beforeUpdate&&s._beforeUpdate(p,m),s._options=p,l=(s._shouldUpdate?s._shouldUpdate(p,m):true)||y,s._setInternalOptions(y||{}),d.oldOptions=f,d.oldContext=N,s._contextObj=c.resolveContext(d.controlClass,m),s.saveFullContext(c.wrapContext(s,s._contextObj))}finally{var g=s._shouldUpdate?s._shouldUpdate(p,m)||y:true;if(s._setInternalOptions(y||{}),g)e.setRebuildIgnoreId(null)}if(W[r]=(!!_||!!y||!!h)&&l,n.controlNodeIdx=r,d.options=p,d.context=m,!n.compound)d.internalOptions=n.controlInternalProperties;return d}),q=F.concat(w),z=v,A=v,E=v,F.forEach(function(e,o){if(W[o]){if(A===v)A=[];A.push(e)}else{if(z===v)z=[];z.push(e)}}),-1===q.indexOf(M)){if(E===v)E=[];E.push(M)}}else q=t.childrenNodes,w=v,F=v,z=v,A=v,j=v,E=v}else q=t.childrenNodes,w=v,F=v,z=v,A=v,j=v,E=v,M.parent.hasCompound=true;if(H=C(q,function(t,r){return R(e,o,t,W&&W[r])},b),H.callback)return H.addCallback(function(o){return M.childrenNodes=o.value,M.fullMarkup=e.decorateFullMarkup(i.getFullMarkup(M.childrenNodes,M.markup),M),{value:M,memo:g.plus(o.memo,{createdNodes:w,updatedNodes:F,destroyedNodes:j,updatedChangedNodes:A,updatedUnchangedNodes:z,selfDirtyNodes:E})}});else M.childrenNodes=H.value,M.fullMarkup=e.decorateFullMarkup(i.getFullMarkup(M.childrenNodes,M.markup),M),V={value:M,memo:g.plus(H.memo,{createdNodes:w,updatedNodes:F,destroyedNodes:j,updatedChangedNodes:A,updatedUnchangedNodes:z,selfDirtyNodes:E})}}else V={value:t,memo:g.zero};return V}return{DirtyKind:_,rebuildNode:M,RebuildResultWriter:b,createNode:D}});
define("Core/vdom/Synchronizer/resources/Hooks",["Core/helpers/Function/shallowClone","Core/vdom/Utils/Functional","View/Runner/expressions/attr"],function(e,t,r){"use strict";function n(e){function t(t){var r=(t.nativeEvent&&t.nativeEvent.args||[]).concat(e.args);e.fn.apply(e.controlNode.control,[t].concat(r));var n=t.nativeEvent.result;if(n&&n.addCallback)n.addCallback(function(){e.controlNode.requestDirtyCheck()});else e.controlNode.requestDirtyCheck();return[e.controlNode.control,t]}if("event"===e.name)return t;else throw new Error("getEventHandlerBase: wrong event type")}var o=function(e){this.controlNode=e};function i(e){return function(t){return t[e]}}var s=function e(t,r){this.nameForNode=t,this.control=r};s.hookName="named-hook",s.attributeName="name",s.restrictedTags={component:true,option:true},s.prototype.hook=function e(t){if(this.control&&this.control._children)this.control._children[this.nameForNode]=t};function c(e,t,r,n){var o=e["controlNodes"]||[],s=o.indexOf(t),c=r&&r.id,a,h;n(o,s),e["controlNodes"]=o;for(var v=0;v<o.length;v++)o[v]["element"]=e,o[v].control.saveOptions(o[v].control._options,o[v]);if(c!==t.id)if(a=o.map(i("id")).join(","),e.cids!==a)e.cids=a,e.setAttribute("data-cids",a)}o.prototype.hook=function(e,t,r){if(r!==this&&(!r||r.controlNode!==this.controlNode))c(e,this.controlNode,r&&r.controlNode,function(e,t){if(-1!==t)throw new Error("Хук для контрола "+this.controlNode.id+" на узле уже есть");if(r&&r.type!==this.type)throw new Error("Хук для контрола: previousValue.type !== this.type");e.push(this.controlNode)}.bind(this))},o.prototype.unhook=function(e,t,r){if(r!==this&&(!r||r.controlNode!==this.controlNode))c(e,this.controlNode,r&&r.controlNode,function(e,t){if(!(-1!==t))throw new Error("Хук для контрола "+this.controlNode.id+" на узле должен быть");if(r&&r.type!==this.type)throw new Error("Хук для контрола: nextValue.type !== this.type");e.splice(t,1)}.bind(this))},o.prototype.type="ControlNodeHook";function a(t){return function(r,n,i,s){var c=e(n),a=t.id,h="control-"+a;if(c[h])throw new Error("На узле уже есть хук для контрола "+a);return c[h]=new o(t),[r,c,i,s]}}function h(e,t){var r=e.name===t.name&&e.value===t.value&&!!e.args===!!t.args,n,o;if(r&&e.args)if(r=e.args.length===t.args.length,r)for(n=0,o=e.args.length;r&&n!==o;n++)r=e.args[n]===t.args[n];return r}function v(e,t){if(l(e)&&l(t))r=!!e===!!t;else{var r=!!e===!!t,n,o;if(r&&e)if(r=e.length===t.length,r)for(n=0,o=e.length;n!==o&&r;n++)r=h(e[n],t[n])}return r}function l(e){return"[object Function]"===Object.prototype.toString.call(e)}function u(e){var t=(e=e.arguments||e).length,r=new Array(t),n=t-1,o;if("number"!==typeof t)throw new Error("reverseArray - wrong arg");for(o=0;o!==t;o++)r[n]=e[o],n--;return r}function f(e){var r=u(e).map(n),o=t.composeWithResultApply(r);return function(e){return o(e)}}function p(e,t){this.eventName=e,this.eventDescrArr=t,this.handlerFn=null}p.prototype.type="BubblingPhaseEventHook",p.prototype.hook=function(e,t,r){var n=r;if(n!==this&&(!n||!v(n.eventDescrArr,this.eventDescrArr)))this.handlerFn=f(this.eventDescrArr),e.addEventListener(this.eventName,this.handlerFn)},p.prototype.unhook=function(e,t,r){var n=r;if(n!==this&&(!n||!v(this.eventDescrArr,n.eventDescrArr)))e.removeEventListener(this.eventName,this.handlerFn)};function d(e,t,r,n){this.eventName=e,this.environment=r,this.eventDescrArr=t.map(function(e){return e.controlNode=n,e})}d.prototype.type="CapturePhaseEventHook",d.prototype.hook=function(e,t,r){var n=r;if(n!==this&&(!n||!v(n.eventDescrArr,this.eventDescrArr))){if(!e.eventProperties)e.eventProperties={},e.eventPropertiesCnt=0;if(l(this.eventDescrArr))e.eventProperties[this.eventName]=this.eventDescrArr;else e.eventProperties[this.eventName]=f(this.eventDescrArr);e.eventPropertiesCnt++,this.environment.addCaptureEventHandler(this.eventName,this.controlNode)}},d.prototype.unhook=function(e,t,r){var n=r;if(n!==this&&(!n||!v(this.eventDescrArr,n.eventDescrArr)))if(this.environment.removeCaptureEventHandler(this.eventName),e.eventProperties)if(delete e.eventProperties[this.eventName],e.eventPropertiesCnt--,0===e.eventPropertiesCnt)delete e.eventPropertiesCnt,delete e.eventProperties};function N(e){return function(t,n,o,i,s){var c={};if(Object.keys(n).some(r.isEvent)){for(var a in n)if(n.hasOwnProperty(a)){var h=n[a],v;if(r.isEvent(a))if(e.haveCapturePhase())v=new d(r.getEventName(a),h,e,s);else v=new p(r.getEventName(a),h,s);else v=h;c[a]=v}}else c=n;return[t,c,o,i]}}return{setControlNodeHook:a,setEventHooks:N,namedNodeHook:s}});
define("Core/vdom/Synchronizer/resources/SyntheticEvent",[],function(){"use strict";var e={blur:false,error:false,focus:false,load:false,mouseenter:false,mouseleave:false,resize:false,scroll:false,unload:false,click:true,compositionend:true,compositionstart:true,compositionupdate:true,dblclick:true,focusin:true,focusout:true,input:true,keydown:true,keypress:true,keyup:true,mousedown:true,mousemove:true,mouseout:true,mouseover:true,mouseup:true,select:true,wheel:true};function t(e,t){this.type=e,this.target=t.target,this.nativeEvent=t,this._isPropagationStopped=false,this._isDefaultPrevented=false}var o=t.prototype;return o.stopPropagation=function(){this._isPropagationStopped=true;var e=this.nativeEvent;e.stopPropagation?e.stopPropagation():e.cancelBubble=true},o.stopImmediatePropagation=function(){this._isPropagationStopped=true;var e=this.nativeEvent;e.stopImmediatePropagation&&e.stopImmediatePropagation()},o.isPropagationStopped=function(){var t=this._isPropagationStopped;if(false===e[this.type])this._isPropagationStopped=true;return t},o.preventDefault=function(){this._isDefaultPrevented=true;var e=this.nativeEvent;e.preventDefault?e.preventDefault():e.returnValue=false},o.isDefaultPrevented=function(){return this._isDefaultPrevented},t});
define("Core/vdom/Synchronizer/resources/TabIndex",["Core/vdom/Utils/Functional"],function(e){var n=e.assert,t=1;function i(e){return e.firstElementChild&&"vdom-focus-in"!==e.firstElementChild.className?e.firstElementChild:e.firstElementChild&&e.firstElementChild.nextElementSibling&&"vdom-focus-out"!==e.firstElementChild.nextElementSibling.className?e.firstElementChild.nextElementSibling:null}function l(e){return e.lastElementChild&&"vdom-focus-out"!==e.lastElementChild.className?e.lastElementChild:e.lastElementChild&&e.lastElementChild.previousElementSibling&&"vdom-focus-in"!==e.lastElementChild.previousElementSibling.className?e.lastElementChild.previousElementSibling:null}function r(e){return e.previousElementSibling&&"vdom-focus-in"!==e.previousElementSibling.className?e.previousElementSibling:null}function o(e){return e.nextElementSibling&&"vdom-focus-out"!==e.nextElementSibling.className?e.nextElementSibling:null}function f(e,t,u,a,m){n(e&&(t||void 0!==u)&&m&&e!==t);function s(e,t,i){var l;if(n("number"===typeof e&&"number"===typeof t),e=0===e?1/0:e>0?e:-1,t=0===t?1/0:t>0?t:-1,-1===t&&-1!==e)return 1;if(-1===e&&-1!==t)return-1;if(e>t)l=i?-1:1;else if(e<t)l=i?1:-1;else l=0;return l}function d(n,t,f){var u,a;if(t.enabled&&!t.createsContext)u=f?l(n):i(n);if(!u)if(u=f?r(n):o(n),!u){a=n.parentNode;while(a!==e&&!u)if(u=f?r(a):o(a),!u)a=a.parentNode}return u||e}function c(e){return a?l(e):i(e)}var E,b,x,v,h,C,p,g=null,S,I=null;if(t)u=(C=m(t)).tabIndex,E=d(t,C,a);else E=(E=a?l(e):i(e))||e;var w=false;for(x=0;2!==x&&!v;x++){while(E!==e&&E!==t&&!v){if(b=m(E),b.enabled&&b.tabStop)if(h=s(b.tabIndex,u,a),0===h&&0===x)v=E;else if(h>0)if(!v)if(0===x){if(null===g||s(b.tabIndex,g.tabIndex,a)<0)g=E,I=b.tabIndex,S=x}else if(null===g||s(b.tabIndex,g.tabIndex,a)<0||w&&s(b.tabIndex,g.tabIndex,a)<=0)g=E,I=b.tabIndex,S=x,w=false;if(-1===u&&g)v=g;if(!v)E=d(E,b,a)}if(E===e&&0===x)if(t&&(false===a&&u>0||true===a&&1!==u&&-1!==u))E=c(e);if(0===x)w=true}if(n(!!v||E===t||E===e),!v&&g)if(I>=0)v=g;if(v){C=m(p=v);while(p&&C.delegateFocusToChildren)if(p=f(p,void 0,a?0:1,a,m),p)v=p,C=m(p)}return v}function u(e,n,t){return f(e,void 0,n?0:1,n,t)}function a(e,n,i,l){function r(n){var t,i=null,r,o=n;while(o&&o!==e){if(!l(o).enabled)i=o;o=o.parentElement}if(!o)throw new Error("Узел fromElement должен лежать внутри узла rootElement");if(r=i||n,r!==e){o=r.parentElement;while(o!==e&&!l(o).createsContext)o=o.parentElement;t=o}return{element:n,context:t}}function o(e,n){if(!e||!e.ownerDocument||!e.parentElement||e.nodeType!==t)throw new Error("Плохой параметр "+n)}o(n,"fromElement"),o(e,"rootElement");var a=r(n),m=a.element;if(m!==e)do{if(m=f(a.context,a.element,void 0,i,l),!m)if(l(a.context).tabCycling)break;else a=r(a.context)}while(!m&&a.element!==e);if(m===e)m=u(e,i,l);if(!m&&l(a.context||e).tabCycling)if(m=u(a.context||e,i,l),void 0===m)m=n;return m}return{findWithContexts:a,findFirstInContext:u}});
define("Core/vdom/Utils/FocusHelper",[],function(){function e(e,t){while(e){if(e===t)return true;e=e.parentElement}return false}function t(e,t,r){if(!e)return;if(e["ws-creates-context"]="true",e["ws-delegates-tabfocus"]="true","true"===t["ws-tab-cycling"])e["ws-tab-cycling"]="true";if("true"===t["ws-autofocus"])e["ws-autofocus"]="true";if("true"===t["ws-no-focus"])e["ws-no-focus"]="true";var u=r||(t.tabindex?t.tabindex+"":"0");e["tabindex"]=u}return{closest:e,prepareAttrsForFocus:t}});
define("Core/vdom/Synchronizer/resources/Environment",["Core/core-extend"],function(e){"use strict";var t=e.extend({constructor:function(e,t){this._controlStateChangedCallback=e,this._rebuildIgnoreId=null}}),n=t.prototype;return n.forceRebuild=function(e){if(this._rebuildIgnoreId!==e)this._controlStateChangedCallback(e)},n.setRebuildIgnoreId=function(e){this._rebuildIgnoreId=e},n.needWaitAsyncInit=function(){return false},n.setupControlNode=function(e){e.environment=this,e.control._forceUpdate=this.forceRebuild.bind(this,e.id)},n.decorateRootNode=function(e){return this._rootMapper?this._rootMapper(e):e},t});
define("Core/vdom/Synchronizer/resources/DOMEnvironment",["Core/core-debug","Core/constants","Core/IoC","Core/helpers/Array/findIndex","Core/helpers/Function/runDelayed","Core/vdom/Synchronizer/resources/VdomMarkup","View/Runner/Vdom/third-party/dom","Core/vdom/Synchronizer/resources/Hooks","Core/vdom/Synchronizer/resources/SyntheticEvent","Core/vdom/Synchronizer/resources/TabIndex","Core/vdom/Utils/FocusHelper","Core/vdom/Synchronizer/resources/Environment","Core/core-extend"],function(e,t,o,r,n,i,s,a,u,d,c,l){"use strict";var f=e.checkAssertion,h={a:true,link:true,button:true,input:true,select:true,textarea:true},v=1,p=2,N=4,_=8,m=16,b={hidden:v,disabled:p,"delegates-tabfocus":N,"creates-context":_,"tab-cycling":m},g=9;function y(e){return function t(o,n,s,a,u){var d,c,l=e(o,n,s,a,u),f=l[2];if(d=r(f,function e(o){return o!==i.mapVNode(t,u,o)}),-1!==d&&void 0!==d)c=f.slice(d).map(i.mapVNode.bind(self,t,u)),f=f.slice(0,d).concat(c),l=[l[0],l[1],f,l[3]];return l}}function C(e){function t(e){var t,o,r,n,i;if(e)if(r=e.split(";"),i=r.length,i)for(n=0;n!==i;n++)if(o=r[n].split(":"),2===o.length){if(!t)t={};t[o[0].trim()]=o[1].trim()}return t}function o(e){var o=e.attributes,r,n=o.length,i,s,a,u,d,c=null;for(r=0;r!==n;r++)if(a=o[r],"key"===a.name)c=a.value;else if("style"===a.name)s=t(a.value);else{if(!i)i={};i[a.name]=a.value}if(d={},u={properties:d},i)d.attributes=i;if(s)d.style=s;if(u.key=c,"input"===e.tagName.toLowerCase()){if(!d.attributes)d.attributes={};if(!d.attributes.hasOwnProperty("value"))d.attributes.value=void 0;d.value=d.attributes.value}return u}function r(e){var t=e.nodeType;if(1===t)return i(e);if(3==t)return n(e)}function n(e){return new s.VText(e.nodeValue)}function i(e){var t=e.tagName,n="http://www.w3.org/1999/xhtml"==e.namespaceURI?null:e.namespaceURI,i=o(e),a=[],u,d=e.childNodes.length;for(u=0;u!==d;u++)a.push(r(e.childNodes[u]));return new s.VNode(t.toLowerCase(),i.properties,a,i.key,n)}return r(e)}function w(e,t){return window.getComputedStyle(e)[t]}function D(e){var t=/\bws-(hidden|disabled)\b/g,o=e.getAttribute("class"),r,n,i,s,a,u,d;a=0;while(r=o&&t.exec(o))a|=b[r[1]];if("true"===e.getAttribute("ws-creates-context"))a|=b["creates-context"];if("true"===e.getAttribute("ws-delegates-tabfocus"))a|=b["delegates-tabfocus"];if("true"===e.getAttribute("ws-tab-cycling"))a|=b["tab-cycling"];if(u=0===(a&(v|p)),u)u="none"!==w(e,"display")&&"invisible"!==w(e,"visibility");if(u)i=e.getAttribute("tabindex"),n=parseInt(i,10),d={enabled:true,tabStop:(s=!isNaN(n))&&n>=0||null===i&&h.hasOwnProperty(e.tagName.toLowerCase()),createsContext:0!==(a&_),tabIndex:n||0,delegateFocusToChildren:0!==(a&N),tabCycling:0!==(a&m)};else d={enabled:false,tabStop:false,createsContext:false,tabIndex:0,delegateFocusToChildren:false,tabCycling:false};return d}function O(e,t){return!(e&&t)}function M(e,t){return t.control}function E(e){return!e.reduce(O,true)}function T(e){return e.reduce(M,true)}function k(e){function t(e){return e===document.body||null===e.offsetParent?false:document.body.contains(e)}for(var o=[],r=0;r<e.length;r++)if(t(e[r]))o.push(e[r]);return o}function H(e,t){if(t.push(e.control),e.parent)H(e.parent,t)}function x(e,t){if(t.push(e),e.getParent())x(e.getParent(),t)}function P(e,o){if(e)if(t.compat&&e.wsControl)x(e.wsControl,o);else if(e.controlNodes&&e.controlNodes.length)for(var r=0;r<e.controlNodes.length;r++)H(e.controlNodes[r],o);else P(e.parentNode,o);return o}function A(e,t,o){if(t[e]&&t[e].count>=2)t[e].handler.call(this,o)}function I(e,t){if(e&&e.length>0)for(var o=0;o<e.length;o++)if(t.id===e[o].id)return true;return false}var V=l.extend({constructor:function(e,t,o){f(e!==document,"Корневой контрол нельзя монтировать на document"),this._savedFocusedElements=[],this._rootDOMNode=e,this._rootVNode=C(e),this._captureEventHandlers={},this._markupNodeDecorator=y(a.setEventHooks(this)),this.addCaptureFocusBlurHandler("focus",this._handleFocusEvent),this.addCaptureFocusBlurHandler("blur",this._handleBlurEvent),this.addCaptureFocusBlurHandler("mousedown",this._handleMouseDown),this._handleTabKey=this._handleTabKey.bind(this),l.call(this,t,o)},destroy:function(){this.removeTabListener(),this.removeCaptureEventHandler("focus"),this.removeCaptureEventHandler("blur"),this.removeCaptureEventHandler("mousedown"),this._rootDOMNode=void 0,this._rootVNode=void 0,this._captureEventHandlers={},this._handleTabKey=void 0}}),L=V.prototype;L.getElementProps=D;function F(e){e.control._afterMount&&e.control._afterMount(),e.control._mounted=true}function S(e,t){e.forEach(function(e){if(e.childrenNodes&&e.childrenNodes.length>0)S(e.childrenNodes,t);if(~t.indexOf(e.id))if(!e.control._mounted)if(e.hasCompound)n(function(){F(e)});else F(e);else e.control._afterUpdate&&e.control._afterUpdate(e.oldOptions||e.options,e.oldContext)})}L._handleTabKey=function(e){if(!this._rootDOMNode)return;var t,o;if(e.keyCode===g)if(t=d.findWithContexts(this._rootDOMNode,e.target,!!e.shiftKey,D),this._isTabPressed=true,setTimeout(function(){this._isTabPressed=false}.bind(this),0),t){if(t.wsControl&&t.wsControl.setActive)t.wsControl.setActive(true);else t.focus();e.preventDefault(),e.stopImmediatePropagation()}else{if(this._rootDOMNode.wsControl)o=this._rootDOMNode.wsControl._oldKeyboardHover(e);if(false!==o);else e.preventDefault(),e.stopImmediatePropagation()}},L.addTabListener=function(){if(this._rootDOMNode)this._rootDOMNode.addEventListener("keydown",this._handleTabKey,false)},L.removeTabListener=function(){if(this._rootDOMNode)this._rootDOMNode.removeEventListener("keydown",this._handleTabKey)},L.autofocusChanges=function e(t){function o(e,t){var r;if(I(e.controlNodes,t))return e;if(e.children&&e.children.length>0){r=e.children;for(var i=0;i<r.length;i++)if(r[i].controlNodes){if(I(r[i].controlNodes,t))return n=r[i],n;o(r[i],t)}}return n}function r(e){var o=t.environment.getElementProps(e);return o.tabStop="true"===e.getAttribute("ws-autofocus"),o}var n,i,s=t.control,a=t.environment,u;if(s.__$focusing&&a._rootDOMNode)if(n=o(a._rootDOMNode,t),n){if(i=d.findFirstInContext(n,void 0,r),i)i.focus();s.__$focusing=false}if(u=k(s._container)[0],u)u.focus()},L._handleFocusEvent=function e(o){if(!this._rootDOMNode)return;if(!o.relatedTarget)return;if(!c.closest(o.target,this._rootDOMNode))return;if(A("focus",this._captureEventHandlers,o),this._savedFocusedElements.push(o.target),K(o.target,o.relatedTarget,this._isTabPressed),t.compat&&this._rootDOMNode&&this._rootDOMNode.controlNodes)if(this._rootDOMNode.controlNodes[0].control.isActive())this._rootDOMNode.controlNodes[0].control._callOnFocusInside();else global.requirejs("Lib/Control/AreaAbstract/AreaAbstract.compatible")._storeActiveChildInner.apply(this._rootDOMNode.controlNodes[0].control);this._focused=true};function K(e,t,o){for(var r=P(e,[]),n=P(t,[]),i=0;i<r.length;i++)if(r[i]._active)r[i]._notify("focusInside",{from:n[0],to:r[0],isTabPressed:!!o});else r[i]._active=true,r[i]._notify("focusIn",{from:n[0],to:r[0],isTabPressed:!!o})}L._handleBlurEvent=function e(t){if(!t.relatedTarget)return;if(!c.closest(t.target,this._rootDOMNode))return;A("blur",this._captureEventHandlers,t),B(t.target,t.relatedTarget,this._isTabPressed)};function B(e,t,o){for(var r=P(e,[]),n=P(t,[]),i=0;i<r.length;i++){if(n.length&&-1!==n.indexOf(r[i]))break;r[i]._active=false,r[i]._notify("focusOut",{to:n[0],from:r[0],isTabPressed:!!o})}}L._handleMouseDown=function e(t){if(t.target.closest('[ws-no-focus="true"]'))t.preventDefault()};function z(e,t){while(e.parentElement)if(e=e.parentElement,e===t)return true;return false}function U(e){if(!this._rootDOMNode)return;var t=e.relatedTarget||document.body,o=e.target,r=document.createEvent("Events");r.initEvent("keydown",true,true);var n=false;if("vdom-focus-in"===o.className)if(z(t,this._rootDOMNode))n=true;if("vdom-focus-out"===o.className)if(!z(t,this._rootDOMNode))n=true;r.view=window,r.altKey=false,r.ctrlKey=false,r.shiftKey=n,r.metaKey=false,r.keyCode=9,o.dispatchEvent(r)}var R=function(e){this.fireTab=function(t){U.call(e,t)}};R.prototype.hook=function(e){e.addEventListener("focus",this.fireTab)},R.prototype.unhook=function(e){e.removeEventListener("focus",this.fireTab)};function j(e){if(!Array.isArray(e))return null;return e.find(function(e){return!!e})}L.applyNewVNode=function(e,t){if(!this._rootDOMNode)return;var o=this.decorateRootNode(e),r,i,a,u;document.createElement("a").classList.add("vdom-focus-in"),document.createElement("a").classList.add("vdom-focus-out");var d=j(o.children);if(d&&"vdom-focus-in"!==d.key){var c=new s.VNode("a",{attributes:{class:"vdom-focus-in",tabindex:"1"},focusHook:new R(this)},[],"vdom-focus-in"),l=new s.VNode("a",{attributes:{class:"vdom-focus-out",tabindex:"0"},focusHook:new R(this)},[],"vdom-focus-out");o.children=[].concat(c,o.children,l)}if(a=this._rootVNode?s.diff(this._rootVNode,o):null,null===a)u=s.createElement(o),this._rootDOMNode.parentNode.replaceChild(u,this._rootDOMNode);else u=s.patch(this._rootDOMNode,a);if(this._rootDOMNode=u,this._rootVNode=o,r=E(u.controlNodes),r)(i=T(u.controlNodes))._container=window.$?$(u):u,n(function(){i.reviveSuperOldControls&&i.reviveSuperOldControls(),S(u.controlNodes,t)});else S(u.controlNodes,t);return a},L.decorateFullMarkup=function(e,t){return i.mapVNode(a.setControlNodeHook(t),t,e)},L.getMarkupNodeDecorator=function(){return this._markupNodeDecorator},L.getDOMNode=function(){return this._rootDOMNode};function q(e){function t(e){while(e&&!e.controlNodes)e=e.parentNode;return e}if(1!==e.eventPhase)return;if(!this._rootDOMNode)return;var r=t(e.target);if(r);else return;var n=e.type,i=new u(n,e),s=e.target,a;if("focusout"===n||"focusin"===n)if(!e._createdByNotify)i.stopPropagation();while(!i.isPropagationStopped()&&s&&s!==this._rootDOMNode.parentNode){if(!r||r.parentNode===s)r=t(s);if(a=s.eventProperties&&s.eventProperties[n],a)try{a(i)}catch(e){o.resolve("ILogger").error("DOMEnvironment.captureEventHandler",e.message,e)}if(!this._rootDOMNode)i.stopPropagation();s=s.parentNode}}return L.addCaptureEventHandler=function(e){var t=this._captureEventHandlers;if(void 0===t[e]){if(this._rootDOMNode.parentNode)t[e]={handler:q.bind(this),count:1},this._rootDOMNode.parentNode.addEventListener(e,t[e].handler,true)}else t[e].count++},L.addCaptureFocusBlurHandler=function e(t,o){var r=this._captureEventHandlers;if(void 0===r[t]){if(this._rootDOMNode.parentNode)r[t]={handler:q.bind(this),count:1},this._rootDOMNode.parentNode.addEventListener(t,o.bind(this),true)}else r[t].count++},L.removeCaptureEventHandler=function(e){var t=this._captureEventHandlers;if(t[e].count--,0===t[e].count){if(this._rootDOMNode.parentNode)this._rootDOMNode.parentNode.removeEventListener(e,t[e].handler,true);delete t[e]}},L.haveCapturePhase=function(){return!t.browser.isIE||t.browser.IEVersion>8},V});
define("Core/vdom/Synchronizer/Synchronizer",["Core/vdom/Utils/Monad","Core/vdom/Synchronizer/resources/DirtyChecking","Core/vdom/Synchronizer/resources/DOMEnvironment","Core/helpers/Function/runDelayed","Core/helpers/Object/isEmpty","Core/helpers/Array/uniq","Core/Serializer","Core/vdom/vdomutils","View/Runner/common","js"],function(e,n,t,r,o,i,u,l,d){"use strict";var s,a=n.DirtyKind,c=n.rebuildNode,f=n.createNode,h=n.RebuildResultWriter,v=5,b=false;if(b)global.requirejs(["Core/vdom/Synchronizer/resources/Debug"],function(e){s=e});function m(e,n){var t=e.parent;while(t)n(t),t=t.parent}function p(e,n){if(e&&e.length>0)for(var t=0;t<e.length;t++)if(n.id===e[t].id)return true;return false}function g(e,n){var t,r;if(p(e.controlNodes,n))return e;if(e.children&&e.children.length>0){t=e.children;for(var o=0;o<t.length;o++)if(t[o].controlNodes){if(p(t[o].controlNodes,n))return r=t[o],r;r=g(t[o],n)}}return r}function y(e){if("[object String]"===Object.prototype.toString.call(e))return~e.indexOf("js!")?global.requirejs(e):global.requirejs.defined("js!"+e)?global.requirejs("js!"+e):global.requirejs(e);return e}function C(e){return e.map(function e(n){return n.id})}var R=[],D=[],N={},q={},M={_rebuild:function(){function n(n){var t=q;if(0===Object.keys(t).length)return{dirties:t,oldRoots:R,newRoots:R,rebuildChanges:null,applyResults:null};q={};var r=R,o=e.mapM(r,function e(n,r){return n.requestDirtyCheck=w.bind(n),c(D[r],t,n,void 0,true)},h,this);if(o.callback)o.addCallback(function(e){var o=e.value,u=e.memo,l=C(o),d={createdNodes:true,updatedChangedNodes:true,selfDirtyNodes:true},s;for(var a in d)if(u[a].length>0)l=l.concat(C(u[a]));l=i(l);var c=function(e,n){return e.applyNewVNode(o[n].fullMarkup,l)};if(n)c=n(c);return u.createdNodes.forEach(function(e){e.requestDirtyCheck=w.bind(e),N[e.id]=e},this),u.destroyedNodes.forEach(function(e){delete N[e.id]},this),s=D.map(c),R=o,{dirties:t,oldRoots:r,newRoots:o,rebuildChanges:u,applyResults:s}});else{var u=o.value,l=o.memo,d=C(u).map(function(e){return t[e]&a.DIRTY?e:void 0}),s={createdNodes:true,updatedChangedNodes:true,selfDirtyNodes:true},f;for(var v in s)if(l[v].length>0)d=d.concat(C(l[v]));d=i(d);var b=function(e,n){return u[n]&&u[n].fullMarkup?e.applyNewVNode(u[n].fullMarkup,d):null};if(n)b=n(b);return l.createdNodes.forEach(function(e){e.requestDirtyCheck=w.bind(e),N[e.id]=e},this),l.destroyedNodes.forEach(function(e){delete N[e.id]},this),f=D.map(b),R=u,{dirties:t,oldRoots:r,newRoots:u,rebuildChanges:l,applyResults:f}}}var t=b?s.withLogRebuild(n,{silent:true}):n,r;for(r=0;r!==v;r++)if(t.call(this),o(q))break;if(r===v)throw new Error("SBIS3.CORE.VDOM.Synchronizer: i === MAX_REBUILD")},controlStateChangedCallback:function(e){M.requestRebuild(e)},mountControlToDOM:function(e,n,r){var o,i={"data-component":(r=r[0]?r[0]:r).getAttribute("data-component")},s=r.getAttribute("data-component-root-id"),a=s&&window.vdomJsModules[s],e=y(e),c=function o(){var a,c,h,v=new u;c=new t(r,this.controlStateChangedCallback,i,s),(a=f(e,{user:n},void 0,c,null,h)).requestDirtyCheck=w.bind(a),N[a.id]=a,D.push(c),R.push(a),a.control.environment=c;var b=l.getReceivedState(a,{controlProperties:n},v);if(a["element"]=r,a.control.saveOptions)a.control.saveOptions(a.options,a);else a.control._options=a.options,a.control._container=$(a.element);if(b)b.addCallback(function(e){return a.receivedState=e,a.control=d.plainMerge(a.control,e),this.requestRebuild(a.id),e}.bind(this));else this.requestRebuild(a.id)}.bind(this);if(o=D.some(function(e){return e instanceof t&&e.getDOMNode()===r}),o)throw new Error("На этом DOM-элементе уже есть смонтированный корневой компонент");if(a&&a.length>0)require(a,c);else c()},unMountControlFromDOM:function e(n,t){var r,o,i=t[0]?t[0]:t;for(r=0;r<R.length;r++)if(i===R[r].environment._rootDOMNode){delete N[R[r].id];var u=D.splice(r,1);if(R.splice(r,1),!n.isDestroyed())n.destroy();u[0].destroy();break}},requestRebuild:function(e){var n=N[e],t=q,o=this;if(n)if(t[e]|=a.DIRTY,m(n,function(e){t[e.id]|=a.CHILD_DIRTY}),!n.environment._haveRebuildRequest)n.environment._haveRebuildRequest=true,r(function e(){var t;for(var r in N)if(N.hasOwnProperty(r)){var i=N[r];if(i&&i.environment&&!i.environment._rootDOMNode){delete N[r];continue}if(i.environment&&i.environment._rootDOMNode.contains(document.activeElement))t=i}if(o._rebuild(),n.environment._haveRebuildRequest=false,n.environment.addTabListener(),t&&document.activeElement===document.body||n.control.__$focusing)n.environment.autofocusChanges.call(this,n)}.bind(this))},setDebugMode:function(e){b=e}};function w(){M.requestRebuild(this.id)}return M});
define("Core/vdom/Synchronizer/resources/Debug",["Core/vdom/Synchronizer/resources/VdomMarkup","Core/vdom/vdomutils","Core/vdom/Synchronizer/resources/DirtyChecking","View/Runner/Text/markupGenerator"],function(e,r,o,t){"use strict";var n=o.DirtyKind,i=e.getVNodeChidlren,u=20,l={0:"NONE",1:"VTEXT",2:"VNODE",3:"WIDGET",4:"PROPS",5:"ORDER",6:"INSERT",7:"REMOVE",8:"THUNK",VirtualNode:"VirtualNode"};function a(e,o){var n=/["'&<>]/,i={area:true,base:true,br:true,col:true,embed:true,hr:true,img:true,input:true,keygen:true,link:true,meta:true,param:true,source:true,track:true,wbr:true};function u(e){var r=""+e,o=n.exec(r);if(!o)return r;var t,i="",u,l=0;for(u=o.index;u<r.length;u++){switch(r.charCodeAt(u)){case 34:t="&quot;";break;case 38:t="&amp;";break;case 39:t="&#39;";break;case 60:t="&lt;";break;case 62:t="&gt;";break;default:continue}if(l!==u)i+=r.substring(l,u);l=u+1,i+=t}return l!==u?i+r.substring(l,u):i}var l=c(function(e){return u(e)+'="'});function a(e){return e=e?e.toString():"",e.replace('"',"&quot;")}function s(e,r,o){if(o){if(null==r)return"";return l(e)+a(r)+'"'}return null}function c(e){var r={};return function(o){if(r.hasOwnProperty(o))return r[o];else return r[o]=e.call(this,o)}}function f(e,n){if(!e)return"";if(r.isControlVNodeType(e))return t.createWsControl(e.controlClass.prototype._moduleName,{user:e.controlProperties,internal:e.controlInternalProperties},e.controlAttributes,o);else if(r.isVNodeType(e))return d(e)+p(e)+g(e);else if(r.isTextNodeType(e))return String(e.text);else if(Array.isArray(e)){for(var i="",u=0;u<e.length;u++)i+=f(e[u]);return i}else if("string"===typeof e)return e;return""}function d(e){var r=e.properties,o="<"+e.tagName.toLowerCase(),t,n,i,u;t=r["attributes"];for(i in t)if(t.hasOwnProperty(i)&&null!==t[i])o+=" "+s(i,t[i],true);t=r["style"],n="";for(u in t)if(t.hasOwnProperty(u)&&null!==t[u])n+=u+": "+t[u]+";";if(""!==n)o+=" "+s("style",n,true);return o+">"}function p(e){var r=e.properties.innerHTML;if(r)return r;else{var o="",t=e.children,n=t&&t.length||0,i,u;for(i=0;i!==n;i++)o+=f(u=t[i],e);return o}}function g(e){var r=e.tagName.toLowerCase();return i[r]?"":"</"+r+">"}return f(e,null)}function s(e){return function(){var r=new Date;return{value:e.apply(this,arguments),time:new Date-r}}}function c(e,r){function o(r,o){if(o.length){console.group(r);try{o.forEach(function(r){d(e,false,r)})}finally{console.groupEnd(r)}}}var t=r.createdNodes.slice(0,u),n=r.updatedChangedNodes.slice(0,u),i=r.updatedUnchangedNodes.slice(0,u),l=r.destroyedNodes.slice(0,u);console.log("------------------"),o("Созданы",t),o("Обновлены - изменены по опциям",n),o("Обновлены - не изменены",i),o("Удалены",l)}function f(e,o,t){var n,u=[];if(r.isControlVNodeType(t))d(e,o,t.controlNode);else{if(n=[r.isVNodeType(t)?t.tagName:r.isTextNodeType(t)?t.text:"???"],void 0!==t.key)n.push[t.key];if(u=[n.join("/")],r.isVNodeType(t))u.push(Object.isEmpty(t.properties)?"":t.properties);if(o){console.group.apply(console,u);try{i(t).forEach(f.bind(void 0,e,o))}finally{console.groupEnd()}}else console.log.apply(console,u)}}function d(e,r,o){var t=o.control,i=t.get("name"),u=o.markup,l=e[o.id]||n.NONE,a=l===n.NONE?[]:l===n.DIRTY?["D"]:["C"],s;if(s=(i?[i]:[]).concat([t.describe()]),void 0!==o.key)s.push(o.key);if(s=s.concat(a),console.log(s.join("/"),o.id,t.getRawData()),false&&r)if(u)f(e,r,u);else console.log("Нет разметки")}function p(e,r,o,t,n,i){n=n||{};for(var u in n)if(n.hasOwnProperty(u)){var f=n[u],p=s(a.bind(void 0,f.value.a))(),g={};for(var y in f.value)if(f.value.hasOwnProperty(y)){var v=f.value[y],h="type"in v?l[v.type]:"????";if(h)g[h]=g.hasOwnProperty(h)?g[h]+1:1}console.group("PATCH: time = "+f.time,true),console.log(g,f.value),console.log("toHTML: time = ",p.time,p.value.length),console.groupEnd()}if(!i.silent&&r)r.forEach(function(r,t){var n=o[t];console.groupCollapsed("Старое",t);try{d(e,true,r)}finally{console.groupEnd()}console.groupCollapsed("Новое",t);try{d({},true,n)}finally{console.groupEnd()}}),c(e,t)}function g(e,r){return function(){var o=new Date,t,n;try{n=e.call(this,s)}finally{if(t=new Date-o,n)p(n.dirties,n.oldRoots,n.newRoots,n.rebuildChanges,n.applyResults,r);console.log("Время перестроения - ",t)}return n}}return{vdomToHTML:a,logRebuildChanges:c,logVNode:f,logControlNode:d,logRebuild:p,withLogRebuild:g}});
define("Core/vdom/Synchronizer/resources/DirtyCheckingCompatible",["View/Runner/expressions/compatible","View/Runner/Text/markupGenerator"],function(e,n){return{createCompoundControlNode:function o(r,t,i,u,c,C,a){return e.createCompoundControlNode(r,t,[],i,u,c,C,a,n)}}});