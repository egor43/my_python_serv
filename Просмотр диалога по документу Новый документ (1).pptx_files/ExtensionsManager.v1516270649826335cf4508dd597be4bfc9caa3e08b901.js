define("Core/ExtensionsManager",["Core/helpers/Object/isEmpty","Core/constants","Core/Deferred","Core/IoC","optional!WS.Data/Source/SbisService"],function(e,s,n,r,o){return{checkExtensions:function(n){var r;if(this.extensionsNeeded())if(s.isNodePlatform)r=process&&process.domain&&process.domain.req&&process.domain.req.systemExtensions;else if(s.isBrowserPlatform)if(window.systemExtensions&&!e(window.systemExtensions))r=window.systemExtensions;if(r=r||{},n){var o=!!Object.keys(r).length,t={};if(!(n instanceof Array))n=[n];for(var i in n)if(n.hasOwnProperty(i)){var a=n[i];if(o)t[a]=r&&r[a]||false;else t[a]=false}return t}return r},loadExtensions:function(){var e=new n;if(s.isBrowserPlatform)if((null===window.systemExtensions||void 0===window.systemExtensions)&&s.systemExtensions)this.getSystemExtensions().addCallback(function(s){window.systemExtensions=s,e.callback(s)});else e.callback(window.systemExtensions||{});else e.callback(null);return e},extensionsLoaded:function(){if(s.isBrowserPlatform)return!!window.systemExtensions;return true},getSystemExtensions:function(){if(!o)throw new Error("Для работы Core/ExtensionsManager нужен модуль WS.Data/Source/SbisService");var e=new n,s=new o({endpoint:"КонфигурацияИнтерфейса"});return e.addErrback(function(e){return e}),s.call("Extensions",{}).addCallback(function(s){e.callback(s.getScalar())}).addErrback(function(s){r.resolve("ILogger").error("System extensions","Transport error",s),e.errback(s)}),e},extensionsNeeded:function(){if(s.isNodePlatform){var n;try{n=process.application.getCurrentService()}catch(e){}return n&&n.extensionsNeeded()}else if(s.isBrowserPlatform)return window.systemExtensions&&!e(window.systemExtensions)||s.systemExtensions||false}}});
//# sourceMappingURL=ExtensionsManager.js.map