define("js!SBIS3.Staff.StaffBrowser.PositioningMixin",["Core/helpers/string-helpers","Core/helpers/functional-helpers"],function(t,o){"use strict";var i="-1";return{$protected:{_options:{needPosition:true,savePosition:true,currentRoot:void 0}},$constructor:function(){if(!this._options.needPosition||this._options.currentRoot||null===this._options.currentRoot)this._options.savePosition=false;if(this._options.needPosition&&void 0===this._options.currentRoot){var o=this.getPosition();if(o)this._options.currentRoot=t.parseComplexKey(o).objKey}},after:{init:function(){this.once("onInit",this.initPosition.bind(this))},getFilter:function(t){if(this._options.currentRoot)t["Позиционирование"]=this._options.currentRoot+",СтруктураПредприятия";return t},_onChangeCompanyId:function(){this.clearPosition()}},initPosition:function(){var t=this;if(t.subscribeTo(t._dataGridView,"onDataLoad",function(o,e){var n=e?e.getMetaData():null;if(n&&n.results){var s=n.results.get("Позиционирование"),r=s&&s!==i&&t._options.needPosition,a=n.results.get("Корень"),u=this._options.root;if(a=a?a+",СтруктураПредприятия":a,a!==u)if(this.setRoot(a),!r)this.setCurrentRoot(a);if(r)this.setCurrentRoot(s)}var c=this.getFilter();if(c.hasOwnProperty("Позиционирование"))delete c["Позиционирование"],t._dataGridView.setFilter(c,true)}),t._options.savePosition){var o=function(o,i){t.savePosition(i)};t._dataGridView.unsubscribe("onSetRoot",o),t.subscribeTo(t._dataGridView,"onSetRoot",o)}},savePosition:function(t){if(t)o.setLocalStorageValue("Персонал.Позиционирование",t);else this.clearPosition()},getPosition:function(){return o.getLocalStorageValue("Персонал.Позиционирование")},clearPosition:function(){if(this._options&&!this._options.savePosition)return;if("undefined"!==typeof localStorage)localStorage.removeItem("Персонал.Позиционирование")},getCurrentRoot:function(){return this._options.currentRoot}}});
//# sourceMappingURL=PositioningMixin.module.js.map